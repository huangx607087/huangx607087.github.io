

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="huangx607087">
  <meta name="keywords" content="">
  
    <meta name="description" content="huangx607087 11月的切题30.Introduction遇到了几个复杂的题目，对着题解看了2个小时也没有读懂，感觉再这么下去自己迟早得崩。 上一周几乎没看文献，前3天也就整理了一下之前上课学的内容，后面还有一堆pre得做&gt;  本篇博客由于题目很难，因此多数还是参考了wp做的，如果各位师傅们发现里面引用了你的wp，但没有做标注的话，请邮件联系我，注明博文的title,date以及给">
<meta property="og:type" content="article">
<meta property="og:title" content="24Nov3">
<meta property="og:url" content="http://example.com/2024/11/20/24Nov3/index.html">
<meta property="og:site_name" content="huangx607087&#39;s Blog">
<meta property="og:description" content="huangx607087 11月的切题30.Introduction遇到了几个复杂的题目，对着题解看了2个小时也没有读懂，感觉再这么下去自己迟早得崩。 上一周几乎没看文献，前3天也就整理了一下之前上课学的内容，后面还有一堆pre得做&gt;  本篇博客由于题目很难，因此多数还是参考了wp做的，如果各位师傅们发现里面引用了你的wp，但没有做标注的话，请邮件联系我，注明博文的title,date以及给">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2024/11/20/24Nov3/1.png">
<meta property="og:image" content="http://example.com/2024/11/20/24Nov3/2.png">
<meta property="og:image" content="http://example.com/2024/11/20/24Nov3/3.png">
<meta property="og:image" content="http://example.com/2024/11/20/24Nov3/4.png">
<meta property="og:image" content="http://example.com/2024/11/20/24Nov3/6.png">
<meta property="og:image" content="http://example.com/2024/11/20/24Nov3/7.png">
<meta property="og:image" content="http://example.com/2024/11/20/24Nov3/9.png">
<meta property="og:image" content="http://example.com/2024/11/20/24Nov3/10.png">
<meta property="article:published_time" content="2024-11-20T00:10:00.000Z">
<meta property="article:modified_time" content="2024-11-29T02:57:21.365Z">
<meta property="article:author" content="huangx607087">
<meta property="article:tag" content="ExpLog">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2024/11/20/24Nov3/1.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>24Nov3 - huangx607087&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 5.4.2"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>


<body>
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>huangx607087</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/friends/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/site/" target="_self">
                <i class="iconfont icon-bookmark-fill"></i>
                <span>更新日志</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="24Nov3"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-11-20 08:10" pubdate>
          2024/11/20 08:10:00 
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          8.9k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          74 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">24Nov3</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="huangx607087-11月的切题3"><a href="#huangx607087-11月的切题3" class="headerlink" title="huangx607087 11月的切题3"></a>huangx607087 11月的切题3</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>遇到了几个复杂的题目，对着题解看了2个小时也没有读懂，感觉再这么下去自己迟早得崩。</p>
<p>上一周几乎没看文献，前3天也就整理了一下之前上课学的内容，后面还有一堆pre得做&gt;</p>
<blockquote>
<p>本篇博客由于题目很难，因此多数还是参考了wp做的，如果各位师傅们发现里面引用了你的wp，但没有做标注的话，请邮件联系我，注明博文的title,date以及给出你的wp的地址，我会酌情加上引用（如果我当时确实没想出来的话，一些过于简单的知识不在此范围内），感谢。</p>
</blockquote>
<p>（12.2考密码学，无线数字通信技术估计也是12月初考试了，12.15CISCN初赛，期末又有一堆东西要背，也不知道后面会怎么样）</p>
<h2 id="1-2024强网杯-electronic-game"><a href="#1-2024强网杯-electronic-game" class="headerlink" title="1.[2024强网杯]electronic_game"></a>1.[2024强网杯]electronic_game</h2><h3 id="1x01-题目大意"><a href="#1x01-题目大意" class="headerlink" title="1x01 题目大意"></a>1x01 题目大意</h3><p>还是先看一下题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.rings.finite_rings.hom_finite_field <span class="hljs-keyword">import</span> FiniteFieldHomomorphism_generic<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> * <br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64encode<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> * <br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> signal<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_timeout</span>(<span class="hljs-params">signum, frame</span>):<br>    <span class="hljs-keyword">raise</span> TimeoutError(<span class="hljs-string">&#x27;function timeout&#x27;</span>)<br><br>timeout = <span class="hljs-number">66</span><br>signal.signal(signal.SIGALRM, _handle_timeout)<br>signal.alarm(timeout)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">qary_trans_to_int</span>(<span class="hljs-params">x, q</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sum</span>([<span class="hljs-built_in">int</span>(x[i]) * q**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(x))])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">f, q</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> b64encode(long_to_bytes(qary_trans_to_int(f.polynomial().coefficients(sparse = <span class="hljs-literal">False</span>), q)))<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> b64encode(long_to_bytes(qary_trans_to_int(f.coefficients(sparse = <span class="hljs-literal">False</span>), q)))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_irreducible_polynomial</span>(<span class="hljs-params">R, n</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>: <br>        f = R.random_element(degree=n) <br>        <span class="hljs-keyword">while</span> f.degree() != n:<br>            f = R.random_element(degree=n) <br>        <span class="hljs-keyword">if</span> f.is_irreducible():<br>            <span class="hljs-keyword">return</span> f<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_sparse_irreducible_polynomial</span>(<span class="hljs-params">R, n</span>): <br>    x = R.gen()<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        g = <span class="hljs-built_in">sum</span>(choice([-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]) * x**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(randint(<span class="hljs-number">1</span>, n//<span class="hljs-number">2</span> + <span class="hljs-number">1</span>)))<br>        <span class="hljs-keyword">if</span> (x**n + g + <span class="hljs-number">1</span>).is_irreducible():<br>            <span class="hljs-keyword">return</span> x**n + g + <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">random_polynomial</span>(<span class="hljs-params">R, n, beta</span>):  <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sum</span>(randrange(-beta, beta) * R.gen()**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(randint(<span class="hljs-number">0</span>, n))) + R.gen()**n  <br><br>q = <span class="hljs-number">333337</span><br>n = <span class="hljs-number">128</span><br>beta = <span class="hljs-number">333</span> <br>chance = <span class="hljs-number">111</span><br>polyns = beta//chance<br>bound  = <span class="hljs-number">106</span><br>R = PolynomialRing(GF(q),<span class="hljs-string">&#x27;x&#x27;</span>)<br><br>F = generate_irreducible_polynomial(R,n).monic()<br><br>k1 = GF(q**n, name = <span class="hljs-string">&#x27;a&#x27;</span>, modulus = generate_sparse_irreducible_polynomial(R,n).monic())<br>k2 = GF(q**n, name = <span class="hljs-string">&#x27;b&#x27;</span>, modulus = F)<br><br>phi = FiniteFieldHomomorphism_generic(Hom(k1, k2)) <br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;F:&quot;</span>, encode(F,q).decode())<br><br>win_count = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(chance):<br>    opt = randint(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">if</span> opt:<br>        As = [phi(random_polynomial(k1,n,beta)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(polyns)] <br>    <span class="hljs-keyword">else</span>:<br>        As = [k2.random_element() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(polyns)]<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(polyns):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;As[<span class="hljs-subst">&#123;i&#125;</span>]: <span class="hljs-subst">&#123;encode(As[i],q).decode()&#125;</span>&quot;</span>)<br><br>    opt_guess = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Guess the option[0/1]: &quot;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(opt_guess) != opt:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wrong guess!&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        win_count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct guess!&quot;</span>)<br><br><span class="hljs-keyword">if</span> win_count &gt;= bound:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You are so smart! Here is your flag:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No flag for you!&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<p>题目给出了两个有限域 $K_1$ 和 $K_2$，均为 $GF(333337^{128})$，只是选择的模多项式不同。其中 $K_1$ 的模多项式系数均为 $0,1,-1$，且除了 $x^{128}$ 项之外，所有的项次数不超过 $64$。而 $K_2$ 的模多项式为随机的。</p>
<p>此外，这里还生成了一个域同态 $\phi$ ，也就是 $K_1$ 到 $K_2$ 上的映射方式。很显然，因为这两个域的元素个数一样，群元素的阶一样，那么一定是存在同态的。然后要求你区分一个结果 $W(x)$ 是在 $K_1$ 上小系数多项式 $A(X)$ 同态到 $K_2$ 得到的 $\phi(A(x))$ ，还是仅仅在 $K_2$ 上随机取的一个多项式。</p>
<p>参考了一下<a target="_blank" rel="noopener" href="https://tangcuxiaojikuai.xyz/post/df3f7032.html#more">糖醋小鸡块的blog</a>，发现正解是和多项式元素的迹有关。速速地补基础知识。</p>
<h3 id="1x02-基础知识"><a href="#1x02-基础知识" class="headerlink" title="1x02 基础知识"></a>1x02 基础知识</h3><h4 id="1x02o01-不同模多项式下的-GF-q-n-之间的同态是什么？"><a href="#1x02o01-不同模多项式下的-GF-q-n-之间的同态是什么？" class="headerlink" title="1x02o01 不同模多项式下的 $GF(q^n)$ 之间的同态是什么？"></a>1x02o01 不同模多项式下的 $GF(q^n)$ 之间的同态是什么？</h4><p>由于有限域的模多项式肯定是不可约多项式，类比素数 $p$ 有原根 $g$，不可约多项式 $p(x)$ 也有原根 $g(x)$，其原根 $g(x)$ 满足 $g^{p^n-1}(x)\equiv 1\pmod {p(x)}$，且对于任意 $k|p^{n}-1$，$g^{k}(x)\not \equiv 1 \pmod {p(x)}$，也就是指数必须到达 $p^n-1$ 才等于 $1$，达不到 $p^{n}-1$ 一定不等于 $1$。</p>
<p>举个简单的例子： $B_1&#x3D;GF(2^{8},x^8+x^4+x^3+x^2+1)$ 和 $B_2&#x3D;GF(2^8,x^8+x^4+x^3+x+1)$。对于 $B_1$ 中的模多项式 $x^8+x^4+x^3+x^2+1$，可以发现该多项式的一个原根为 $x$，因为 $2^{8}-1&#x3D;255&#x3D;3\times5\times17$。而 $x$ 不是 $x^8+x^4+x^3+x+1$ 的原根，因为 $x^{51}\equiv 1\pmod {x^8+x^4+x^3+x+1}$，指数还没达到 $255$ ，结果已经等于 $1$ 了。</p>
<p>但经过验证，$x+1$ 是 $x^8+x^4+x^3+x+1$ 的原根，因此，如果能把 $B_1$ 上的 $x$ 看作 $B_2$ 上的 $x+1$，呃，我们这里还是用 $u$ 和 $v$ 来区分 $B_1$ 和 $B_2$ 上的元素吧。也就是，如果把 $B_1$ 中的 $u$，看作 $B_2$ 上的 $v+1$，那么会产生什么效果？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: B1.&lt;u&gt;=GF(<span class="hljs-number">2</span>**<span class="hljs-number">8</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>sage: B2.&lt;v&gt;=GF(<span class="hljs-number">2</span>**<span class="hljs-number">8</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>sage: <span class="hljs-keyword">from</span> sage.rings.finite_rings.hom_finite_field <span class="hljs-keyword">import</span> FiniteFieldHomomorphism_generic<br>sage: phi=FiniteFieldHomomorphism_generic(Hom(B1,B2))<br>sage: phi<br>Ring morphism:<br>  From: Finite Field <span class="hljs-keyword">in</span> u of size <span class="hljs-number">2</span>^<span class="hljs-number">8</span><br>  To:   Finite Field <span class="hljs-keyword">in</span> v of size <span class="hljs-number">2</span>^<span class="hljs-number">8</span><br>  Defn: u |--&gt; v + <span class="hljs-number">1</span><br>sage: u**<span class="hljs-number">116</span><br>u^<span class="hljs-number">7</span> + u^<span class="hljs-number">6</span> + u^<span class="hljs-number">5</span> + u^<span class="hljs-number">4</span> + u^<span class="hljs-number">3</span><br>sage: (v+<span class="hljs-number">1</span>)**<span class="hljs-number">116</span><br>v^<span class="hljs-number">7</span> + v^<span class="hljs-number">2</span> + v + <span class="hljs-number">1</span><br>sage: R.&lt;x&gt;=PolynomialRing(GF(<span class="hljs-number">2</span>)) <span class="hljs-comment">#构造复合函数x^7+x^6+x^5+x^4+x^3</span><br>sage: ((x+<span class="hljs-number">1</span>)**<span class="hljs-number">7</span>+(x+<span class="hljs-number">1</span>)**<span class="hljs-number">6</span>+(x+<span class="hljs-number">1</span>)**<span class="hljs-number">5</span>+(x+<span class="hljs-number">1</span>)**<span class="hljs-number">4</span>+(x+<span class="hljs-number">1</span>)**<span class="hljs-number">3</span>)%(x^<span class="hljs-number">8</span>+x^<span class="hljs-number">4</span>+x^<span class="hljs-number">3</span>+x+<span class="hljs-number">1</span>)<br>x^<span class="hljs-number">7</span> + x^<span class="hljs-number">2</span> + x + <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>也就是说， $B_1$ 中的 $u$ 等价于 $B_2$ 中的 $v+1$。不仅仅是原根的关系，如果我们随机取 $u^{116}$，结果为 $u^7+u^6+u^5+u^4+u^3$，那么如果我们把 $u$ 全部替换成 $v+1$，那么在 $B_2$ 的意义下，结果为 $v^7+v^2+v+1$ （具体看上面代码），即 $B_1$ 中的 $u$ 和在 $B_2$ 中的 $v+1$ 是 <strong>等价的</strong> 。因此同态也就这么产生了（域的性质应该都懂吧）。</p>
<p>当然，也可以这么反过来同态，也就是 $B_2$ 中的 $v$ 等价于 $B_1$ 中的 $u+1$，可以看到这两个的阶都是 $51$，相当于 $B_2$ 的一个 $51$ 个元素的子域也可以同态到 $B_1$ 上的一个 $51$ 元素的子域。 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: phinv=FiniteFieldHomomorphism_generic(Hom(B2,B1))<br>sage: phinv<br>Ring morphism:<br>  From: Finite Field <span class="hljs-keyword">in</span> v of size <span class="hljs-number">2</span>^<span class="hljs-number">8</span><br>  To:   Finite Field <span class="hljs-keyword">in</span> u of size <span class="hljs-number">2</span>^<span class="hljs-number">8</span><br>  Defn: v |--&gt; u + <span class="hljs-number">1</span><br>sage: (u+<span class="hljs-number">1</span>)**<span class="hljs-number">51</span><br><span class="hljs-number">1</span><br>sage: v**<span class="hljs-number">51</span><br><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>当然，并不是原根都是 $x$，就可以从 $x$ 同态到 $x$ 的，比如下面这个例子 （你自己想想，下面这个 $C$ 中的 $u$ 能和 $D$ 中的 $v$ 等价吗，假如 $C([0,1])\equiv D([0,1])$，你构造个复合函数试试看，模多项式都不一样，直接放过去还能一样？）</p>
<p>注： $\mathbb F_7[x]$ 中，$x^3+x+1$ 和 $x^3+2x^2+4x+2$ 都是不可约多项式，且 $x$ 都是它们的原根。</p>
<p>为啥这个同态过去是 $5v^2+6v+6$ 呢？随机取 $u^{100}&#x3D;4u^2+3u+3$，你构造 $f(x)&#x3D;4x^2+3x+3$，然后计算 $f(5v^2+6v+6) \bmod (x^3+2x^2+4x+2)$，计算结果肯定和预想的一样，这样才是有意义的同态。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: C.&lt;u&gt;=GF(<span class="hljs-number">7</span>**<span class="hljs-number">3</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>sage: D.&lt;v&gt;=GF(<span class="hljs-number">7</span>**<span class="hljs-number">3</span>,modulus=[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>])<br>sage: <span class="hljs-keyword">from</span> sage.rings.finite_rings.hom_finite_field <span class="hljs-keyword">import</span> FiniteFieldHomomorphism_generic<br>sage: phi=FiniteFieldHomomorphism_generic(Hom(C,D))<br>sage: phi<br>Ring morphism:<br>  From: Finite Field <span class="hljs-keyword">in</span> u of size <span class="hljs-number">7</span>^<span class="hljs-number">3</span><br>  To:   Finite Field <span class="hljs-keyword">in</span> v of size <span class="hljs-number">7</span>^<span class="hljs-number">3</span><br>  Defn: u |--&gt; <span class="hljs-number">5</span>*v^<span class="hljs-number">2</span> + <span class="hljs-number">6</span>*v + <span class="hljs-number">6</span><br>sage: u**<span class="hljs-number">100</span><br><span class="hljs-number">4</span>*u^<span class="hljs-number">2</span> + <span class="hljs-number">3</span>*u + <span class="hljs-number">3</span><br>sage: R.&lt;x&gt;=PolynomialRing(GF(<span class="hljs-number">7</span>))<br>sage: f=<span class="hljs-number">4</span>*x^<span class="hljs-number">2</span>+<span class="hljs-number">3</span>*x+<span class="hljs-number">3</span><br>sage: phi(u**<span class="hljs-number">100</span>)<br><span class="hljs-number">3</span>*v^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>*v + <span class="hljs-number">1</span><br>sage: (<span class="hljs-number">5</span>*v^<span class="hljs-number">2</span>+<span class="hljs-number">6</span>*v+<span class="hljs-number">6</span>)**<span class="hljs-number">100</span><br><span class="hljs-number">3</span>*v^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>*v + <span class="hljs-number">1</span><br>sage: f(<span class="hljs-number">5</span>*x^<span class="hljs-number">2</span>+<span class="hljs-number">6</span>*x+<span class="hljs-number">6</span>)%(x^<span class="hljs-number">3</span>+<span class="hljs-number">2</span>*x^<span class="hljs-number">2</span>+<span class="hljs-number">4</span>*x+<span class="hljs-number">2</span>)<br><span class="hljs-number">3</span>*x^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>*x + <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h4 id="1x02o02-什么是域中元素的共轭，迹和极小多项式。"><a href="#1x02o02-什么是域中元素的共轭，迹和极小多项式。" class="headerlink" title="1x02o02 什么是域中元素的共轭，迹和极小多项式。"></a>1x02o02 什么是域中元素的共轭，迹和极小多项式。</h4><p>上次你听到共轭这个说法，还是在复数域中的共轭复数那一块。也就是 $a+b\mathrm i$ 的共轭复数是 $a-b\mathrm i$。而域 $\mathbb F_{p^n}$ 中某元素 $\alpha$ 的共轭一共有 $n-1$ 个，为 $\alpha^q,\alpha^{q^2},\alpha^{q^{3}},…,\alpha^{q^{n-1}}$，这又是为什么呢？</p>
<p>还是从复数域开始： 在 $\mathbb C_7$ 中 $3+2\mathrm i$ 的共轭复数是 $3+5\mathrm i$，这个能理解。并且你会发现，在 $\mathbb C$ 中，两个共轭复数相加之后，只剩下了实部，虚部清零</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: C7.&lt;img&gt;=GF(<span class="hljs-number">49</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>sage: <span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>+<span class="hljs-number">2</span>*img,<span class="hljs-number">7</span>)<br><span class="hljs-number">5</span>*img + <span class="hljs-number">3</span><br>sage: (<span class="hljs-number">3</span>+<span class="hljs-number">2</span>*img)+(<span class="hljs-number">3</span>+<span class="hljs-number">5</span>*img)<br><span class="hljs-number">6</span><br></code></pre></td></tr></table></figure>

<p>然后扩展到三阶，任意元素 $a$ 和其两个共轭 $a^{p},a^{p^2}$ 相加，也得到了一个数值，$u,u^2$ 清零。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: D13.&lt;u&gt;=GF(<span class="hljs-number">11</span>**<span class="hljs-number">3</span>)<br>sage: D13.modulus()<br>x^<span class="hljs-number">3</span> + <span class="hljs-number">2</span>*x + <span class="hljs-number">9</span><br>sage: a=D13.random_element()<br>sage: a<br><span class="hljs-number">10</span>*u^<span class="hljs-number">2</span> + <span class="hljs-number">3</span>*u + <span class="hljs-number">4</span><br>sage: a+(a**<span class="hljs-number">11</span>)+(a**<span class="hljs-number">121</span>)<br><span class="hljs-number">5</span><br>sage: a.trace()<br><span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>

<p>这也就是 $\alpha $  的迹的定义。</p>
<p>当然，$\alpha$ 和它的 $n$ 个共轭可以成为一个一元 $n$ 次方程 $(x-\alpha)(x-\alpha^{p^2})\cdots(x-\alpha^{p^{n-1}})&#x3D;0$ 的所有根。计等号左边为 $f$，通过根与系数的比较关系可以发现，$-f[n-1]$ 为 $n$ 个根之和，也就是 $x^{n-1}$ 次系数的相反数为 $\alpha$ 的迹。</p>
<h4 id="1x02o03-同态前后迹不变的原因、-K-1-中小系数多项式迹很小的原因。"><a href="#1x02o03-同态前后迹不变的原因、-K-1-中小系数多项式迹很小的原因。" class="headerlink" title="1x02o03 同态前后迹不变的原因、$K_1$ 中小系数多项式迹很小的原因。"></a>1x02o03 同态前后迹不变的原因、$K_1$ 中小系数多项式迹很小的原因。</h4><p>这边有两个域 $F,G$，换个大点的数字，看看实验结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p=<span class="hljs-number">1435756429</span><br>R.&lt;x&gt;=PolynomialRing(GF(p))<br>fp2=[<span class="hljs-number">1281051561</span>, <span class="hljs-number">325824623</span>, <span class="hljs-number">587085269</span>, <span class="hljs-number">519016661</span>, <span class="hljs-number">607488613</span>, <span class="hljs-number">349057141</span>, <span class="hljs-number">1328077096</span>, <span class="hljs-number">1307270920</span>, <span class="hljs-number">561010408</span>, <span class="hljs-number">1114525395</span>, <span class="hljs-number">117794890</span>, <span class="hljs-number">713439535</span>, <span class="hljs-number">696507390</span>, <span class="hljs-number">529855506</span>, <span class="hljs-number">773150011</span>, <span class="hljs-number">251203247</span>, <span class="hljs-number">1</span>]<br>fp1=[<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]<br>F.&lt;u&gt;=GF(p**<span class="hljs-number">16</span>,modulus=fp1)<br>G.&lt;v&gt;=GF(p**<span class="hljs-number">16</span>,modulus=fp2)<br><span class="hljs-keyword">from</span> sage.rings.finite_rings.hom_finite_field <span class="hljs-keyword">import</span> FiniteFieldHomomorphism_generic<br>phi = FiniteFieldHomomorphism_generic(Hom(F, G)) <br>listAx=[randint(-<span class="hljs-number">607</span>,<span class="hljs-number">607</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br><span class="hljs-built_in">print</span>(listAx)<br><span class="hljs-comment">#[-133, 543, 547, -416, -20, -228, 340, 578, 460, -394, 147, 153, -237, -589, 521, 117]</span><br>Axf=F(listAx)<br>Axg=phi(F(listAx))<br>Bx=G.random_element()<br><span class="hljs-built_in">print</span>(Axf.trace(),Axg.trace(),Bx.trace())<br><span class="hljs-comment">#[-133, 543, 547, -416, -20, -228, 340, 578, 460, -394, 147, 153, -237, -589, 521, 117]</span><br><span class="hljs-comment">#8967 8967 965643423</span><br><span class="hljs-built_in">print</span>(Axf)<br><span class="hljs-comment">#117*u^15 + 521*u^14 + 1435755840*u^13 + 1435756192*u^12 + 153*u^11 + 147*u^10 + 1435756035*u^9 + 460*u^8 + 578*u^7 + 340*u^6 + 1435756201*u^5 + 1435756409*u^4 + 1435756013*u^3 + 547*u^2 + 543*u + 1435756296</span><br><span class="hljs-built_in">print</span>(Axg)<br><span class="hljs-comment">#426045453*v^15 + 1095853004*v^14 + 1027534429*v^13 + 199604488*v^12 + 1245066406*v^11 + 491522381*v^10 + 319187049*v^9 + 793800632*v^8 + 179486685*v^7 + 1344029075*v^6 + 926473343*v^5 + 484211635*v^4 + 1047468414*v^3 + 157075129*v^2 + 610169781*v + 917898386</span><br><span class="hljs-built_in">print</span>(Bx)<br><span class="hljs-comment">#779249508*v^15 + 297567236*v^14 + 378700571*v^13 + 1081381084*v^12 + 307273340*v^11 + 64314112*v^10 + 112350563*v^9 + 649766190*v^8 + 424903042*v^7 + 223527316*v^6 + 1393065653*v^5 + 1322430432*v^4 + 457302712*v^3 + 807713883*v^2 + 1191352294*v + 461422786</span><br></code></pre></td></tr></table></figure>

<p>假设 $F$ 到 $G$ 的同态为 $\phi$。设 $A_F$ 的极小多项式为 $f(x)$，那么 $f(A_F)&#x3D;0$，由同态可以得到 $\phi(f(A_F))&#x3D;f(\phi(A_F))&#x3D;f(A_G)$，因此同态前后，极小多项式不变，迹也不变。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(Axf.minimal_polynomial())<br><span class="hljs-comment">#x^16 + 1435747462*x^15 + 33455366*x^14 + 1037842702*x^13 + 11109617*x^12 + 832067022*x^11 + 138214583*x^10 + 565542262*x^9 + 1176957343*x^8 + 1394076824*x^7 + 797026202*x^6 + 1386837332*x^5 + 948171790*x^4 + 593354364*x^3 + 495207351*x^2 + 1341667046*x + 1086432282</span><br><span class="hljs-built_in">print</span>(Axg.minimal_polynomial())<br><span class="hljs-comment">#x^16 + 1435747462*x^15 + 33455366*x^14 + 1037842702*x^13 + 11109617*x^12 + 832067022*x^11 + 138214583*x^10 + 565542262*x^9 + 1176957343*x^8 + 1394076824*x^7 + 797026202*x^6 + 1386837332*x^5 + 948171790*x^4 + 593354364*x^3 + 495207351*x^2 + 1341667046*x + 1086432282</span><br>Axg.minimal_polynomial()==Axf.minimal_polynomial()<br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure>

<p>至于为何同态前的迹也很小，我大概的猜测如下：</p>
<blockquote>
<p>1.原来生成的的多项式是小系数多项式</p>
<p>2.因为 $K_1$ 中的取模多项式只有低位有 $0$ 和 $\pm1$，那么 $x^{n}$ 会被分散到低一半的位中去，且变动只有可能是 $x^n$ 的系数。因此对于特定阶数的变换 $q,q^2,q^3,…,q^{n-1}$ 下，多次乘方后的效果会被抵消掉（对应元素的共轭），然后全部加起来，得到的迹也就很小了。</p>
</blockquote>
<p>闲得无聊看了一下这个</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(Hom(F,G))) <span class="hljs-comment">#length:16</span><br></code></pre></td></tr></table></figure>

<p>然后又调了一下这个</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">phi(u**(p**<span class="hljs-number">3</span>)) <span class="hljs-comment">#1,2,3,4,5,...,15</span><br></code></pre></td></tr></table></figure>

<p>发现这些刚好对应 <code>(list(Hom(F,G)))</code> 中出现的所有表达式，有点意思。</p>
<h3 id="1x03-解题"><a href="#1x03-解题" class="headerlink" title="1x03 解题"></a>1x03 解题</h3><p>既然在 $K_1$ 上取小多项式之后，得到的迹很小，那怎么样个迹才算小呢？随机取样之后，可以看到明显的差距：</p>
<p><img src="/2024/11/20/24Nov3/1.png" srcset="/img/loading.gif" lazyload alt="1"></p>
<p><img src="/2024/11/20/24Nov3/2.png" srcset="/img/loading.gif" lazyload alt="2"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">T=[<span class="hljs-number">3765</span>, <span class="hljs-number">7362</span>, <span class="hljs-number">7440</span>, <span class="hljs-number">7259</span>, <span class="hljs-number">7343</span>, <span class="hljs-number">6932</span>, <span class="hljs-number">1174</span>, <span class="hljs-number">1072</span>, <span class="hljs-number">976</span>, <span class="hljs-number">821</span>, <span class="hljs-number">707</span>, <span class="hljs-number">668</span>, <span class="hljs-number">598</span>, <span class="hljs-number">540</span>, <span class="hljs-number">422</span>, <span class="hljs-number">409</span>, <span class="hljs-number">382</span>, <span class="hljs-number">367</span>, <span class="hljs-number">351</span>, <span class="hljs-number">306</span>, <span class="hljs-number">308</span>, <span class="hljs-number">290</span>, <span class="hljs-number">306</span>, <span class="hljs-number">316</span>, <span class="hljs-number">357</span>, <span class="hljs-number">365</span>, <span class="hljs-number">356</span>, <span class="hljs-number">369</span>, <span class="hljs-number">395</span>, <span class="hljs-number">495</span>, <span class="hljs-number">549</span>, <span class="hljs-number">583</span>, <span class="hljs-number">637</span>, <span class="hljs-number">738</span>, <span class="hljs-number">802</span>, <span class="hljs-number">981</span>, <span class="hljs-number">1060</span>, <span class="hljs-number">1364</span>, <span class="hljs-number">7058</span>, <span class="hljs-number">7249</span>, <span class="hljs-number">7249</span>, <span class="hljs-number">7421</span>, <span class="hljs-number">7434</span>, <span class="hljs-number">4424</span>, <span class="hljs-number">0</span>]<br>S=[<span class="hljs-number">1189</span>, <span class="hljs-number">2334</span>, <span class="hljs-number">2362</span>, <span class="hljs-number">2395</span>, <span class="hljs-number">2329</span>, <span class="hljs-number">2269</span>, <span class="hljs-number">2359</span>, <span class="hljs-number">2378</span>, <span class="hljs-number">2341</span>, <span class="hljs-number">2276</span>, <span class="hljs-number">2333</span>, <span class="hljs-number">2387</span>, <span class="hljs-number">2300</span>, <span class="hljs-number">2265</span>, <span class="hljs-number">2347</span>, <span class="hljs-number">2307</span>, <span class="hljs-number">2236</span>, <span class="hljs-number">2272</span>, <span class="hljs-number">2282</span>, <span class="hljs-number">2339</span>, <span class="hljs-number">2285</span>, <span class="hljs-number">2331</span>, <span class="hljs-number">2353</span>, <span class="hljs-number">2308</span>, <span class="hljs-number">2295</span>, <span class="hljs-number">2342</span>, <span class="hljs-number">2308</span>, <span class="hljs-number">2254</span>, <span class="hljs-number">2323</span>, <span class="hljs-number">2275</span>, <span class="hljs-number">2249</span>, <span class="hljs-number">2283</span>, <span class="hljs-number">2306</span>, <span class="hljs-number">2357</span>, <span class="hljs-number">2371</span>, <span class="hljs-number">2375</span>, <span class="hljs-number">2339</span>, <span class="hljs-number">2344</span>, <span class="hljs-number">2411</span>, <span class="hljs-number">2375</span>, <span class="hljs-number">2323</span>, <span class="hljs-number">2327</span>, <span class="hljs-number">2363</span>, <span class="hljs-number">1203</span>, <span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure>

<p>然后你会发现，第一个取样耗时接近第二个的四倍（所以要是在对面服务器上打的话，是不是能直接根据时间去判断(bushi)</p>
<p>最后主要就是靠trace区分了，因为原题环境没了，所以进行了本地复现。一开始Bound调 $50000$ 和 $60000$ 都没成功，$70000$ 调了一次，成功了，但好像真的比较看脸。。。因为后续我又尝试了几次都没成功。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>sh=remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">60733</span>)<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b642poly</span>(<span class="hljs-params">fb64</span>):<br>	flist=[<span class="hljs-number">0</span>]*<span class="hljs-number">129</span><br>	fi=bytes_to_long(b64decode(fb64))<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">129</span>):<br>		flist[i]=fi%<span class="hljs-number">333337</span><br>		fi//=<span class="hljs-number">333337</span><br>	<span class="hljs-keyword">return</span> flist<br>sh.recvuntil(<span class="hljs-string">b&#x27;F:&#x27;</span>)<br>Px=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip().decode()<br>Px=(b642poly(Px))<br>K=GF(<span class="hljs-number">333337</span>**<span class="hljs-number">128</span>,modulus=Px,names=(<span class="hljs-string">&#x27;t&#x27;</span>,))<br>BOUND=<span class="hljs-number">70000</span><br>score=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">111</span>):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;score=&#125;</span>,round=<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>)<br>	sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>	Fx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>	sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>	Gx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>	sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>	Hx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>	Fx,Gx,Hx=b642poly(Fx),b642poly(Gx),b642poly(Hx)<br>	Fx,Gx,Hx=K(Fx),K(Gx),K(Hx)<br>	a,b,c=(Fx.trace(),Gx.trace(),Hx.trace())<br>	judg=<span class="hljs-built_in">sum</span>([a&lt;BOUND,a&gt;<span class="hljs-number">333337</span>-BOUND,b&lt;BOUND,b&gt;<span class="hljs-number">333337</span>-BOUND,c&lt;BOUND,c&gt;<span class="hljs-number">333337</span>-BOUND])<br>	<span class="hljs-keyword">if</span>(judg&gt;<span class="hljs-number">2</span>):<br>		sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>	<span class="hljs-keyword">else</span>:<br>		sh.sendline(<span class="hljs-string">b&#x27;0&#x27;</span>)<br>	jres=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>	<span class="hljs-keyword">if</span>(<span class="hljs-string">b&#x27;Correct&#x27;</span> <span class="hljs-keyword">in</span> jres):<br>		score+=<span class="hljs-number">1</span><br>sh.interactive()<br></code></pre></td></tr></table></figure>


<p>运行结果，卡线出了一次：</p>
<img src="/2024/11/20/24Nov3/3.png" srcset="/img/loading.gif" lazyload alt="3" style="zoom:87%;">

<p>然后BOUND调成 $65000$，写了个自动化多次连接多次运行的脚本，反正能出，平均下来有十几分之一的概率。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b642poly</span>(<span class="hljs-params">fb64</span>):<br>	flist=[<span class="hljs-number">0</span>]*<span class="hljs-number">129</span><br>	fi=bytes_to_long(b64decode(fb64))<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">129</span>):<br>		flist[i]=fi%<span class="hljs-number">333337</span><br>		fi//=<span class="hljs-number">333337</span><br>	<span class="hljs-keyword">return</span> flist<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Solveeee</span>():<br>	sh=remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">60733</span>)<br>	sh.recvuntil(<span class="hljs-string">b&#x27;F:&#x27;</span>)<br>	Px=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip().decode()<br>	Px=(b642poly(Px))<br>	K=GF(<span class="hljs-number">333337</span>**<span class="hljs-number">128</span>,modulus=Px,names=(<span class="hljs-string">&#x27;t&#x27;</span>,))<br>	BOUND=<span class="hljs-number">65000</span><br>	score=<span class="hljs-number">0</span><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">111</span>):<br>		<span class="hljs-comment">#print(f&#x27;&#123;score=&#125;,round=&#123;i&#125;&#x27;)</span><br>		sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>		Fx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>		sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>		Gx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>		sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>		Hx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>		Fx,Gx,Hx=b642poly(Fx),b642poly(Gx),b642poly(Hx)<br>		Fx,Gx,Hx=K(Fx),K(Gx),K(Hx)<br>		a,b,c=(Fx.trace(),Gx.trace(),Hx.trace())<br>		judg=<span class="hljs-built_in">sum</span>([a&lt;BOUND,a&gt;<span class="hljs-number">333337</span>-BOUND,b&lt;BOUND,b&gt;<span class="hljs-number">333337</span>-BOUND,c&lt;BOUND,c&gt;<span class="hljs-number">333337</span>-BOUND])<br>		<span class="hljs-keyword">if</span>(judg&gt;<span class="hljs-number">2</span>):<br>			sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>		<span class="hljs-keyword">else</span>:<br>			sh.sendline(<span class="hljs-string">b&#x27;0&#x27;</span>)<br>		jres=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>		<span class="hljs-keyword">if</span>(<span class="hljs-string">b&#x27;Correct&#x27;</span> <span class="hljs-keyword">in</span> jres):<br>			score+=<span class="hljs-number">1</span><br>	C=(sh.recvall())<br>	sh.close()<br>	<span class="hljs-keyword">return</span> score,C<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (<span class="hljs-built_in">range</span>(<span class="hljs-number">300</span>)):<br>	<span class="hljs-built_in">print</span>(i+<span class="hljs-number">1</span>,Solveeee())<br><span class="hljs-comment">#sh.interactive()</span><br></code></pre></td></tr></table></figure>

<p>运行结果：（服务器端删除了from secret import flag，改成了自定义flag格式，其他方法等效于原服务器）。</p>
<p><img src="/2024/11/20/24Nov3/4.png" srcset="/img/loading.gif" lazyload alt="4"></p>
<h2 id="2-numbers2"><a href="#2-numbers2" class="headerlink" title="2.numbers2"></a>2.numbers2</h2><h3 id="2x01-题目大意"><a href="#2x01-题目大意" class="headerlink" title="2x01 题目大意"></a>2x01 题目大意</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n  = p*q<br>m = bytes_to_long(os.urandom(<span class="hljs-number">20</span>))<br>x = <span class="hljs-built_in">pow</span>(m,p,n)<br>y = <span class="hljs-built_in">pow</span>(m,q,n)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <br>    file.write(<span class="hljs-string">&#x27;n = &#x27;</span> + <span class="hljs-built_in">str</span>(n) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-string">&#x27;x = &#x27;</span> + <span class="hljs-built_in">str</span>(x) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-string">&#x27;y = &#x27;</span> + <span class="hljs-built_in">str</span>(y) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br><br>iv = sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()[:<span class="hljs-number">16</span>]<br><br><br>n = <span class="hljs-number">17</span><br>q = getPrime(<span class="hljs-number">1024</span>)<br>x = randint(q//<span class="hljs-number">2</span>,q-<span class="hljs-number">1</span>)<br>S = <span class="hljs-number">2</span>**<span class="hljs-number">544</span><br>K = <span class="hljs-number">2</span>**<span class="hljs-number">480</span><br><br>s = [randint(S//<span class="hljs-number">2</span>,S-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>t = [randint(S//<span class="hljs-number">2</span>,S-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br><br>k = [randint(K//<span class="hljs-number">2</span>,K-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>b = [randint(K//<span class="hljs-number">2</span>,K-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br>r = [(s[i]*k[i] - b[i]*t[i]) * inverse(x,q) % q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-string">f&quot;s = <span class="hljs-subst">&#123;s&#125;</span>\n&quot;</span>)<br>    file.write(<span class="hljs-string">f&quot;t = <span class="hljs-subst">&#123;t&#125;</span>\n&quot;</span>)<br>    file.write(<span class="hljs-string">f&quot;r = <span class="hljs-subst">&#123;r&#125;</span>\n&quot;</span>)<br>    file.write(<span class="hljs-string">&#x27;q = &#x27;</span> + <span class="hljs-built_in">str</span>(q) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <br>key = sha256(<span class="hljs-built_in">str</span>(<span class="hljs-number">2024</span>*b[<span class="hljs-number">0</span>]+<span class="hljs-number">2023</span>*k[<span class="hljs-number">0</span>] + x).encode()).digest()[:<span class="hljs-number">16</span>]<br><br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br>aes = AES.new(key,AES.MODE_CBC,iv)<br>cipher = aes.encrypt(pad(flag.encode(),<span class="hljs-number">16</span>))<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-string">f&quot;cipher = <span class="hljs-subst">&#123;cipher&#125;</span>&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<p>题目的flag使用了AES-CBC加密。分为两部分，对iv的加密和对密钥的加密。下面分别阐述</p>
<h3 id="2x02-Part-1"><a href="#2x02-Part-1" class="headerlink" title="2x02 Part 1"></a>2x02 Part 1</h3><p>第一部分给出了一个RSA的加密过程加密 iv。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n  = p*q<br>m = bytes_to_long(os.urandom(<span class="hljs-number">20</span>))<br>x = <span class="hljs-built_in">pow</span>(m,p,n)<br>y = <span class="hljs-built_in">pow</span>(m,q,n)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <br>    file.write(<span class="hljs-string">&#x27;n = &#x27;</span> + <span class="hljs-built_in">str</span>(n) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-string">&#x27;x = &#x27;</span> + <span class="hljs-built_in">str</span>(x) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-string">&#x27;y = &#x27;</span> + <span class="hljs-built_in">str</span>(y) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>iv = sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()[:<span class="hljs-number">16</span>]<br></code></pre></td></tr></table></figure>

<p>这一问和鹏城杯的那个题一样，CRT化简之后，还是 $g\equiv m\pmod p,h\equiv m \pmod q$ 的形式，完全一样的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-number">133693649727082259107041662011720823458571250895054242259170170354175642242128965748915759548206594541801234255878757661771526775311636655859201668702890990745739241126384729560433907755687614698569613585182786544165812027959219789602655976970715100245966545577285355634247363922810553139003838578363660449109</span><br>g=<span class="hljs-number">92401219014364912794053160070309527007771356043695463515571328726676546494869270394623052969651083009651771857467561945521106625547418406188430774969043958102947805651169010188202688119325462398122519423459244079993702953589811689050017122705616315531462047800685314554111273134721614734430443067361639605720</span><br>h=<span class="hljs-number">27444123601022148160097636168019280219400389861288181193988463940073215353205764735090720106313510456714820401995714013971697413924167047690200030265762984461900122475812718262941762361406314725034408660419186620573774598548615986428700226735633115570424145980543054306673862989672645266476994517440508647839</span><br><br>K=<span class="hljs-number">2</span>**<span class="hljs-number">1600</span><br>M=Matrix(ZZ,[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,g*h*K],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-(g+h)*K],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>*K],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,K*n]])<br><span class="hljs-built_in">print</span>(M.LLL()[<span class="hljs-number">0</span>])<br><span class="hljs-comment">#(-1, -220100243352092218129491119040565723833151607139, -48444117123650214661388931601686039991652705643026455075715408364262521400552593472298595765321, 0)</span><br></code></pre></td></tr></table></figure>

<p>只是需要多做一步，计算 $g-m$ 和 $n$ 的最大公约数，因为 $g\equiv m\pmod p$，也就是 $g&#x3D;kp+m$，因此 $g-m&#x3D;kp$，这样就可以得到 $n$ 的分解了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">p=GCD(g-m,n)<br>q=n//p<br><span class="hljs-keyword">assert</span> p*q==n<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>iv1= sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()[:<span class="hljs-number">16</span>]<br>iv2= sha256(<span class="hljs-built_in">str</span>(q).encode()).digest()[:<span class="hljs-number">16</span>]<br><span class="hljs-built_in">print</span>(iv1.<span class="hljs-built_in">hex</span>())<br><span class="hljs-built_in">print</span>(iv2.<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#8076dd87467b159231123921f92dd39b</span><br><span class="hljs-comment">#313f3a43636d41db93278863b3d50e73</span><br></code></pre></td></tr></table></figure>

<p>这样我们就得到了两个IV，先保存着，不确定哪个是对的。</p>
<h3 id="2x03-Part-2"><a href="#2x03-Part-2" class="headerlink" title="2x03 Part 2"></a>2x03 Part 2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-number">17</span><br>q = getPrime(<span class="hljs-number">1024</span>)<br>x = randint(q//<span class="hljs-number">2</span>,q-<span class="hljs-number">1</span>)<br>S = <span class="hljs-number">2</span>**<span class="hljs-number">544</span><br>K = <span class="hljs-number">2</span>**<span class="hljs-number">480</span><br><br>s = [randint(S//<span class="hljs-number">2</span>,S-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>t = [randint(S//<span class="hljs-number">2</span>,S-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br><br>k = [randint(K//<span class="hljs-number">2</span>,K-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>b = [randint(K//<span class="hljs-number">2</span>,K-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br>r = [(s[i]*k[i] - b[i]*t[i]) * inverse(x,q) % q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br></code></pre></td></tr></table></figure>

<p>这一部分给出了 $18$ 组数据、模数 $q$，数组 $s,t,r$。但未知量为 $x$ 和数组 $b$。其中 $q,x$ 均为 $1024$ 比特，$s,t$ 均为 $544$ 比特， $k,b$ 均为 $480$ 比特。很明显一个HNP问题，并且这个式子是一眼看出来的：<br>$$<br>s_ik_i-t_ib_i\equiv r_ix \pmod q<br>$$<br>很明显的线性关系，但这个矩阵属实不好构造。我一开始把所有的 $s_i$ 和 $b_i$ 都放在一起，消 $x$，构造了一个 $37\times37$ 的矩阵，但对角线上全是 $1$，加上 $k,b$ 同阶，不需要平衡因子，矩阵的行列式完全达不到要求。</p>
<p>最后参考了<a target="_blank" rel="noopener" href="https://blog.csdn.net/qwerzbc66">striving</a>✌的构造方法：保留 $x$，化简式子：<br>$$<br>s’_ik_i-r_i’x\equiv b_i \pmod q<br>$$<br>也就是<br>$$<br>s’_ik_i-r_i’x-u_iq&#x3D; b_i<br>$$</p>
<p>其中 $s_i’&#x3D;\frac{s_i}{t_i},r_i’&#x3D;\frac{r_i}{t_i}$。构造矩阵如下（以三个为例）：</p>
<p><img src="/2024/11/20/24Nov3/6.png" srcset="/img/loading.gif" lazyload alt="6"></p>
<p>根据striving的提醒：根据对角线算界：$\log_2 q^3&#x3D;3072$，$\log_2\vec v_1&#x3D;(k_1,k_2,k_3,b_1,b_2,b_3)&#x3D;480+\log_2 6&#x3D;482$，$6\log_2 \vec v_1&#x3D;2892&lt;3072$，因此算法是可行的。</p>
<p>打印一下每一行的nbits，可以看到第二行清一色的 $480$，说明这就是所求的值，对应下标为1</p>
<p><img src="/2024/11/20/24Nov3/7.png" srcset="/img/loading.gif" lazyload alt="7"></p>
<p>代码也放一下，方便复现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>sdivt=[s[i]*inverse(t[i],q)%q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s))]<br>rdivt=[r[i]*inverse(t[i],q)%q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(r))]<br>M=block_matrix([[identity_matrix(<span class="hljs-built_in">len</span>(s)),diagonal_matrix(ZZ,sdivt)],<br>                [zero_matrix(<span class="hljs-built_in">len</span>(s)),q*identity_matrix(<span class="hljs-built_in">len</span>(s))],<br>                [zero_matrix(<span class="hljs-number">1</span>,<span class="hljs-number">18</span>),Matrix(ZZ,rdivt)]])<br>MLLL=M.LLL()<br></code></pre></td></tr></table></figure>



<p>有了 $k$ 和 $b$，就可以求出 AES 的密钥了。两个IV分别试一下，第一个是对的，因此原题得解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">v=MLLL[<span class="hljs-number">1</span>]<br>v=v*sgn(v[<span class="hljs-number">0</span>])<br>listv=<span class="hljs-built_in">list</span>(v)<br>k=listv[:<span class="hljs-built_in">len</span>(s)]<br>b=listv[<span class="hljs-built_in">len</span>(s):]<br>x=(k[<span class="hljs-number">0</span>]*s[<span class="hljs-number">0</span>]-b[<span class="hljs-number">0</span>]*t[<span class="hljs-number">0</span>])*inverse(r[<span class="hljs-number">0</span>],q)%q <br><span class="hljs-built_in">print</span>(x,k[<span class="hljs-number">0</span>],b[<span class="hljs-number">0</span>])<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>key=sha256(<span class="hljs-built_in">str</span>(<span class="hljs-number">2024</span>*b[<span class="hljs-number">0</span>]+<span class="hljs-number">2023</span>*k[<span class="hljs-number">0</span>]+x).encode()).digest()[:<span class="hljs-number">16</span>]<br>key<br><span class="hljs-comment">#b&#x27;\xe0\x14\x00\x84\xb9\xcd\xa1\t\xec\xa9\x86\x91g\xcb\x8d\x16&#x27;</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>aes = AES.new(key,AES.MODE_CBC,iv=<span class="hljs-string">b&#x27;\x80v\xdd\x87F&#123;\x15\x921\x129!\xf9-\xd3\x9b&#x27;</span>)<br>m=aes.decrypt(cipher)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-comment">#DASCTF&#123;b157059c-2871-421f-8cec-332b617de4d5&#125;\x04\x04\x04\x04</span><br></code></pre></td></tr></table></figure>

<h3 id="2x04-Part-2-消-x-做法"><a href="#2x04-Part-2-消-x-做法" class="headerlink" title="2x04 Part 2 消 $x$ 做法"></a>2x04 Part 2 消 $x$ 做法</h3><p>当然，我一开始的思路还是想消 $x$，在 striving✌的指点下，我尝试了一下这个矩阵：</p>
<p>由于<br>$$<br>s_{18}k_{18}-t_{18}b_{18}\equiv r_{18}x\pmod q<br>$$<br>和<br>$$<br>s_2k_2-t_2b_2\equiv r_2x\pmod q<br>$$<br>因此消 $x$，有<br>$$<br>r_2s_{18}k_{18}-r_{18}s_2k_2-r_2t_{18}b_{18}+r_{18}t_2b_{2}\equiv 0\pmod q<br>$$<br>那么可以有<br>$$<br>b_2&#x3D;\frac{r_2s_{18}k_{18}-r_{18}s_2k_2-r_2t_{18}b_{18}}{r_{18}t_2}-u_2q<br>$$<br>固定第一组数据，将上面的 $x$ 换为 $b_{18}$，然后右边向量从 $b_2$ 开始也是可以的。算了一下界，也没有问题。但考虑到他第一组数据与密钥有关，因此这里固定最后一组数据。</p>
<p>设 $A_i&#x3D;\dfrac{r_is_{18}} {r_{18}t_i},B_i&#x3D;\dfrac{r_{18}s_i} {r_{18}t_i},C_i&#x3D;\dfrac{r_it_{18}} {r_{18}t_i}$，最后构造的矩阵为（两组数据的情况）</p>
<p><img src="/2024/11/20/24Nov3/9.png" srcset="/img/loading.gif" lazyload alt="9"></p>
<p>这边的代码放一下，不知道为啥不需要加负号，很奇怪。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>A=[r[i]*s[-<span class="hljs-number">1</span>]*inverse(r[-<span class="hljs-number">1</span>]*t[i],q)%q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>)]<br>B=[r[-<span class="hljs-number">1</span>]*s[i]*inverse(r[-<span class="hljs-number">1</span>]*t[i],q)%q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>)]<br>C=[r[i]*t[-<span class="hljs-number">1</span>]*inverse(r[-<span class="hljs-number">1</span>]*t[i],q)%q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>)]<br>M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">35</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">35</span>):<br>    M[i][i]=<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">18</span> <span class="hljs-keyword">else</span> q<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[i][i+<span class="hljs-number">18</span>]=B[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[<span class="hljs-number">17</span>][<span class="hljs-number">18</span>+i]=A[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[-<span class="hljs-number">1</span>][<span class="hljs-number">18</span>+i]=C[i]<br>M=Matrix(ZZ,M)<br>MLLL=M.LLL()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;  &#x27;</span>,end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">35</span>):<br>    <span class="hljs-built_in">print</span>(i%<span class="hljs-number">10</span>,end=<span class="hljs-string">&#x27; &#x27;</span>)<br><span class="hljs-built_in">print</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M.nrows()):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i%<span class="hljs-number">10</span>&#125;</span> &#x27;</span>,end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M.ncols()):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;X&#x27;</span><span class="hljs-keyword">if</span> M[i][j] <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;.&#x27;</span>,end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(MLLL.nrows()):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(MLLL.ncols()):<br>        <span class="hljs-built_in">print</span>(MLLL[i][j].nbits(),end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br>v=MLLL[<span class="hljs-number">3</span>]<br>v=v*sgn(v[<span class="hljs-number">0</span>])<br>listv=<span class="hljs-built_in">list</span>(v)<br>k=listv[:<span class="hljs-number">18</span>]<br>b=listv[<span class="hljs-number">18</span>:]<br>x=(k[<span class="hljs-number">0</span>]*s[<span class="hljs-number">0</span>]-b[<span class="hljs-number">0</span>]*t[<span class="hljs-number">0</span>])*inverse(r[<span class="hljs-number">0</span>],q)%q<br><span class="hljs-built_in">print</span>(x,k[<span class="hljs-number">0</span>],b[<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure>

<p>最后第 4 个向量（下标为3）为答案，很奇怪。striving师傅使用的第一组数据，解出来第一个向量就是答案。。</p>
<p>得到了striving✌的解答：构建对角+方阵这样会好一点，也就是我上面的那个最后一行被移到了第一行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>):<br>    M[i][i]=<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> i&lt;=<span class="hljs-number">18</span> <span class="hljs-keyword">else</span> q<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[i+<span class="hljs-number">1</span>][i+<span class="hljs-number">19</span>]=B[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[<span class="hljs-number">18</span>][<span class="hljs-number">19</span>+i]=A[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[<span class="hljs-number">0</span>][<span class="hljs-number">19</span>+i]=C[i]<br></code></pre></td></tr></table></figure>



<h2 id="3-N1CTF2021-n1token-1"><a href="#3-N1CTF2021-n1token-1" class="headerlink" title="3.[N1CTF2021]n1token-1"></a>3.[N1CTF2021]n1token-1</h2><h3 id="3x01-题目大意"><a href="#3x01-题目大意" class="headerlink" title="3x01 题目大意"></a>3x01 题目大意</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gettoken</span>(<span class="hljs-params">c</span>):<br>    X = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> ((<span class="hljs-built_in">pow</span>(X, (p-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>, p)!=<span class="hljs-number">1</span>) <span class="hljs-keyword">or</span> (<span class="hljs-built_in">pow</span>(X, (q-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>, q)!=<span class="hljs-number">1</span>)):<br>        X = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> X.bit_length() &lt; <span class="hljs-number">920</span>:<br>            X *= random.choice(primes)<br>    xp = <span class="hljs-built_in">pow</span>(X, (p + <span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, p)<br>    xq = <span class="hljs-built_in">pow</span>(X, (q + <span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, q)<br>    xp = random.choice([xp,-xp%p])<br>    xq = random.choice([xq,-xq%q])<br>    x = c * (xp*inverse(q,p)*q + xq*inverse(p,q)*p) % n<br>    <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getmyPrime</span>(<span class="hljs-params">nbits</span>):<br>    p = getPrime(nbits)<br>    <span class="hljs-keyword">while</span>(p%<span class="hljs-number">4</span>==<span class="hljs-number">1</span>):<br>        p = getPrime(nbits)<br>    <span class="hljs-keyword">return</span> p<br><br>primes = random.sample(sieve_base, <span class="hljs-number">920</span>)<br>p = getmyPrime(<span class="hljs-number">512</span>)<br>q = getmyPrime(<span class="hljs-number">512</span>)<br>e = <span class="hljs-number">65537</span><br>n = p*q<br>c = <span class="hljs-built_in">pow</span>(bytes_to_long(flag), e, n)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-string">&quot;n = &quot;</span> + <span class="hljs-built_in">str</span>(n) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>):<br>        f.write(<span class="hljs-string">&quot;Token #&quot;</span>+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;: &#x27;</span>+<span class="hljs-built_in">str</span>(gettoken(c))+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-comment">#最后给出了920组数据</span><br></code></pre></td></tr></table></figure>

<h3 id="3x02-Easy的Part-1"><a href="#3x02-Easy的Part-1" class="headerlink" title="3x02 Easy的Part 1"></a>3x02 Easy的Part 1</h3><p>题目只给出了 $n,e$，$c$ 没有给出。但题目给出了 $t_i&#x3D;cx_i$ 值，其中 $X&#x3D;x^2\pmod n$，且 $X$ 为 $920$ 位光滑数字。因此可以得到<br>$$<br>t_i^2c^{-2}-k_in&#x3D;X_i<br>$$<br>很明显的LLL，直接一把梭，求出了所有 $X$，并得到了 $c^2$。这个我很容易看出来了，那个看着复杂的式子，只不过是在知道 $n$ 分解时，通过CRT求 $\sqrt x\pmod n$，$p\equiv 3\pmod 4$ 的素数可以用公式开平方。</p>
<p>矩阵构造在这里，这个其实很简单，wp用了 $64$ 组，我用了 $50$ 组也能出。</p>
<p><img src="/2024/11/20/24Nov3/10.png" srcset="/img/loading.gif" lazyload alt="10"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>tokens=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).readlines()<br>tokens.pop(<span class="hljs-number">0</span>)<br>n=<span class="hljs-number">68512262030092235082955402685415541014208343583540436164257874839232436153071370815269154345614809159891073442197732980480807167946204103083844856370368201582809851941837996671056932696292853288793127100756079130455873788646267803515293475609923615566516458978625901881951403282617405981962778117066458607117</span><br>tokens=[<span class="hljs-built_in">int</span>(tokens[i].split(<span class="hljs-string">&#x27;:&#x27;</span>)[<span class="hljs-number">1</span>])<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>)]<br>tokens2=[i*i%n <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tokens]<br>M=block_matrix(ZZ,<br>[[Matrix(tokens2[:<span class="hljs-number">50</span>])],<br>[identity_matrix(<span class="hljs-number">50</span>)*n]])<br><br>MLLL=M.LLL()<br>lgMLLL=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>)]<span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">51</span>)]<br>Xarr=<span class="hljs-built_in">list</span>(MLLL[<span class="hljs-number">1</span>])<br><span class="hljs-comment">#print(Xarr)</span><br>C2=tokens2[<span class="hljs-number">0</span>]*inverse(Xarr[<span class="hljs-number">0</span>],n)%n<br><span class="hljs-comment">#print(C2)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>,<span class="hljs-number">920</span>):<br>    Xarr.append(tokens2[i]*inverse(C2,n)%n)<br></code></pre></td></tr></table></figure>

<p>然后呢？我们要求的是 $c$ 啊。</p>
<p>考虑到 $X$ 的光滑，我们打算分解每一个 $X$，并将其保存起来。因为素数是 $920$ 个，$X$ 也是 $920$ 个，可以直接factor，获取因子。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">FactXarr=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (<span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>)):<br>    FactXarr.append(<span class="hljs-built_in">list</span>(factor(Xarr[i])))<br>primeset=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>):<br>    <span class="hljs-keyword">for</span> j,_ <span class="hljs-keyword">in</span> FactXarr[i]:<br>        primeset.append(j)<br>primeset=<span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(primeset)))<br>indexdic=&#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>):<br>    indexdic[primeset[i]]=i<br></code></pre></td></tr></table></figure>

<p> 然后我就被卡住了。。</p>
<h3 id="3x03-Tough的Part-2"><a href="#3x03-Tough的Part-2" class="headerlink" title="3x03 Tough的Part 2"></a>3x03 Tough的Part 2</h3><p>瞄一下<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/261215#h2-9">wp</a>：</p>
<blockquote>
<p>WP:</p>
<p>若 $x^2\equiv y^2 \pmod n$，则 $x&#x3D;ky\pmod n$，其中 $k^2\equiv 1\pmod n$。</p>
<p>也就是 $(k+1)(k-1)\equiv 0\pmod n$，即 $(k+1)(k-1)&#x3D;gn$。如果 $k$ 不为 $1$，那么就有可能通过公因数分解 $n$，这里 $\gcd(k+1,n)&#x3D;p,\gcd(k-1,n)&#x3D;q$。</p>
<p>因此，我们要求一个 $k$ 来分解 $n$。</p>
<p>如果我们从其中选取 $w$ 个表达式相乘，当$w$为偶数时，那么同余式左边由 $t_i^2$累乘得到的项可以看成$(t_0 * t_1 * … * t_w)^2$，同余式右边由$c^2$累乘得到的项可以看成$(c^w)^2$，当剩下的这$w$个$X_i$相乘得到的项也可以写为一个项的平方时，我们即构造出了一个上面所提到的分解$n$所需的表达式，由于这里$t_i$、$X_i$和$c^2$在模$n$下的值我们均已知，因此我们可以直接计算出$k$的值，继而按照上面的方法分解$n$，因此接下来我们只需从这920组数据当中找出符合条件的$w$组即可。</p>
<p>为了找到这样的$w$组数据，我们可以将每个$X_i$展开为若干素数$prime_i$乘积的形式，然后记录下每个$prime_i$的指数的奇偶性，这样一来可以将其看作一个GF(2)上的920维行向量，由于我们有920组数据，因此可以列出一个920 * 920的矩阵，这样一来寻找若干$X_i$相乘的结果其指数为偶数的问题就转化为了寻找若干$prime_i$其指数之和在GF(2)下为0的问题，因此我们直接对该矩阵求left kernel matrix即可，这样一来我们可以得到若干组$res$向量，其中每一个$res$向量中值为1的下标对应着我们的920组数据当中应当选取的$X_i$的下标，同时为了保证$w$为偶数，我们还需要选择$res$向量中1的个数为偶数的向量，在本题的数据中，我们一共得到了两组$res$向量，其中一组中1的个数为奇数、一组中1的个数为偶数，我们选择偶数这组即可，然后按照上述过程计算出$k$，既而即可分解$N$求出私钥$d$。</p>
</blockquote>
<p>貌似有道理，但这是啥意思呢？</p>
<p>算了，先根据wp做一下。啊？被分解出来了吗？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">PM=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>)):<br>    cpm=[<span class="hljs-number">0</span>]*<span class="hljs-number">920</span><br>    <span class="hljs-keyword">for</span> j,k <span class="hljs-keyword">in</span> FactXarr[i]:<br>        cpm[indexdic[j]]=k<br>    PM.append(cpm)<br>PM2=Matrix(GF(<span class="hljs-number">2</span>),PM)<br>PM=Matrix(ZZ,PM)<br><span class="hljs-built_in">print</span>(PM2.rank())<br><span class="hljs-comment">#918</span><br>PM2K=PM2.left_kernel()<br>judgvec=<span class="hljs-built_in">list</span>(PM2K[<span class="hljs-number">2</span>])<br>cnt=judgvec.count(<span class="hljs-number">1</span>)<br>Xpro,Tpro=<span class="hljs-number">1</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>):<br>    <span class="hljs-keyword">if</span>(judgvec[i]):<br>        Xpro=Xpro*Xarr[i]<br>        Tpro=Tpro*tokens[i]<br><span class="hljs-keyword">assert</span> Xpro.is_square()<br>Xprosq=Xpro.nth_root(<span class="hljs-number">2</span>)<br>k = (((Tpro * inverse_mod(Xprosq, n)) % n) * <span class="hljs-built_in">pow</span>(C2, -(cnt // <span class="hljs-number">2</span>), n)) % n<br><span class="hljs-built_in">print</span>(GCD(<span class="hljs-built_in">int</span>(k-<span class="hljs-number">1</span>),n))<br><span class="hljs-comment">#7066689880579369785256516192953365235434055150846536631329529038878914448897380081597992569628631985623841078424106593028009177867365917709699457885163883</span><br></code></pre></td></tr></table></figure>

<p>两个平方相等，哪两个相等啊？一个小时的乱搞后，我得到了答案：<br>$$<br>\prod_{\mathrm{judgvec}[i]&#x3D;1} t_i^2\equiv \prod_{\mathrm{judgvec}[i]&#x3D;1}X_ic^{2\sum\mathrm{judgvec}} \pmod n<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">Tpro**<span class="hljs-number">2</span>%n==(Xpro*<span class="hljs-built_in">pow</span>(C2,cnt,n))%n <span class="hljs-comment">#cnt=judgvec.count(1)</span><br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure>

<p>再回顾过程：矩阵 <code>PM</code> 中存放的是每个 $X$ 对应的素数的指数，<code>PM[i][j]</code> 表示 $X_i$ 的分解中第 $j$ 个素数的指数，对 <code>PM</code> 矩阵全体模 $2$，就可以有每个指数是奇数还是偶数。在 <code>PM2=GF(2)(PM)</code> 下求left kernel，就是求满足条件的 $\vec v&#x3D;(v_0,v_1,…,v_{919})$，使得 $\pi_{i&#x3D;0}^{919}  X_i^{v_i}$ 是一个平方数。然后就回到了 WP 中的这句话：</p>
<blockquote>
<p>如果我们从其中选取 $w$ 个表达式相乘，当$w$为偶数时，那么同余式左边由 $t_i^2$累乘得到的项可以看成$(t_0 * t_1 * … * t_w)^2$，同余式右边由$c^2$累乘得到的项可以看成$(c^w)^2$，当剩下的这$w$个$X_i$相乘得到的项也可以写为一个项的平方时，我们即构造出了一个上面所提到的分解$n$所需的表达式，由于这里$t_i$、$X_i$和$c^2$在模$n$下的值我们均已知，因此我们可以直接计算出$k$的值，继而按照上面的方法分解$n$，因此接下来我们只需从这920组数据当中找出符合条件的$w$组即可。</p>
</blockquote>
<p>验证一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">Xpro.is_square()<br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure>

<p>看来没问题了。设这个 $X_{pro}&#x3D;a^2$，这边left kernel保证 $X$ 的分解的指数都是偶数（因为取模原因，$X$ 是模 $n$ 的二次剩余，但 $X$ 的分解指数不全为偶数，是因为部分奇数可以为二次剩余）。又因为 $t^2\equiv Xc^2\pmod n$，因此 $T_{pro}^2&#x3D;X_{pro}c^{2w}$。因此我们可以两边开根：<br>$$<br>T_{pro}&#x3D;ac^{w}<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">Xprosq.is_square()<br><span class="hljs-comment">#False</span><br></code></pre></td></tr></table></figure>

<p>OK，这下看看，我们找到了什么？<br>$$<br>T^2_{pro}&#x3D;a^2c^{2w}<br>$$<br>两个平方相等！</p>
<p>开根测一下：两个平方模 $n$ 相等，但开方后不等。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">Tpro**<span class="hljs-number">2</span>%n==(Xpro*<span class="hljs-built_in">pow</span>(C2,cnt,n))%n <span class="hljs-comment">#cnt=judgvec.count(1)</span><br><span class="hljs-comment">#True</span><br>Tpro%n==Xprosq*<span class="hljs-built_in">pow</span>(C2,cnt//<span class="hljs-number">2</span>,n)%n<br><span class="hljs-comment">#False</span><br></code></pre></td></tr></table></figure>

<p>因此，我们找到了所需要的 $k\equiv \dfrac{a}{c^{2(w&#x2F;2)}}$。因为 $c^2$ 是一个整体，所以 $w$ 要保证是偶数才可行。这样思路终于和WP闭环了。。。</p>
<h3 id="3x04-完结撒花"><a href="#3x04-完结撒花" class="headerlink" title="3x04 完结撒花"></a>3x04 完结撒花</h3><p>分解 $n$ 之后，先用CRT对 $c^2$ 开根，得到四个可能的结果。然后分别RSA解密，找到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">p,q=GCD(<span class="hljs-built_in">int</span>(k-<span class="hljs-number">1</span>),n),GCD(<span class="hljs-built_in">int</span>(k+<span class="hljs-number">1</span>),n)<br><span class="hljs-keyword">assert</span> p <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,n] <span class="hljs-keyword">and</span> q <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,n] <span class="hljs-keyword">and</span> p!=q<br>carr=[]<br>cp=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(C2,(p+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,p))<br>cq=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(C2,(q+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,q))<br><span class="hljs-keyword">for</span> sp <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]:<br>    <span class="hljs-keyword">for</span> sq <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]:<br>        carr.append(crt([cp*sp,cq*sq],[p,q]))<br><span class="hljs-built_in">print</span>(carr)<br>d=inverse(<span class="hljs-number">65537</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> carr:<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">[46630614291745334334152762312676921133624051168940817865903892997090214159501097997241603185344424810227360569767886901658508914717819387760635901824660947938796941642460399170111143796793156856634009422349818143947262685178807938549388138287681555995508698977295037594135656538624892517735216104401235804978, 19703989276128579847076476848899002659695039512136459426637790674933329268053509523645116022627877355721599775333883095285751759221736313984198660551863329947412556215691527518951119591197450423277438733191151653085195488305757310694499293449100108574981362635828059309918833297115589471736564051849673468541, 48808272753963655235878925836516538354513304071403976737620084164299106885017861291624038322986931804169473666863849885195055408724467789099646195818504871635397295726146469152105813105095402865515688367564927477370678300340510492820794182160823506991535096342797842572032569985501816510226214065216785138576, 21881647738346900748802640372738619880584292414599618298353981842142221993570272818027551160270384349663712872429846078822298253228384715323208954545707253644012910299377597500945788899499696432159117678406260986508611103467459864965905337322242059571007760001330864287815746743992513464227562012665222802139]</span><br><span class="hljs-string">b&#x27;2v\xa7F0aU\xdaJK\x1e\xff\r!&gt;\x84\xf3\xe3\xe5sC\xd6\xa2\x8a-vJ\xe15g\xf0\xcb-^g\xaeJ\x05o.N\xd2\xb1\x12\x06\xe0\x05\xf9\xcc\x0f\xcf\xac(\x1d\x9c\\\xfcz\xe9\xf4\x04\x99V[\x98\xc7\xeb(\xfe\xa1X\x1a\x89\xaa\x17,\xf7\xc9d\x069\xb3\x1d\x0chd\x9d6Z\xdaT\xf8\xba1\x16\xf8&#123;Z\xb3D\xd9\x05\xf8\xb8E\xb8\xd75V\xcc-\x80al\xc3\xf2\xd6.\xcaNt\xfa\xed\x83\x14T\xb3\xe1&#x27;</span><br><span class="hljs-string">b&#x27;n1ctf&#123;b9e7d419-0df8-438a-9120-efdf3ddf155f&#125;&#x27;</span><br><span class="hljs-string">b&quot;a\x90\x90(K\xa8\x92&amp;\x82\x8f6\xdf\x86^\xa8p\x94\xf9^@wR\x08-g\xc19\x90\xae\x02\xfdQ\x1a\xb21U^(\xe0]9\n\xba\x86\xc1z!\xf1M\xc1\xa1\xcc\xb9~m:w\x0e\xf5\xe2s-\x83\xb0\xb0H^\xed\xe1H\xd5\x83yHp\xcf\x15\xed\xc6\xd8\xf1S\xf1B\xb2\xc1\xce!\xc0\x01\xbc\x82:0\xdd\xdfLy\xe3\xedJ\x9b\x0b\x14\xa0t\xef \x15\x02\xd8O\xfe\x8a&#x27;&#125;3\x96\xc1\xbf\xef\x01\xcf\xf4\xb4\xa1\xc7\x90&quot;</span><br><span class="hljs-string">b&#x27;/\x19\xe8\xe2\x1bG&lt;L8D\x17\xe0y=i\xeb\xa1\x15x\xcd3&#123;e\xa3:J\xee\xafx\x9b\x0c\x85\xedS\xc9\xa7\x14#q.\xea8\tt\xba\x9a\x1b\xf7\x81\xb1\xd2 \x91`\xd0\xddz\x94\x0b\xeen\x94-U\x17\x80s\xc4\xe2\xa7&#125;h\xef\x9eY\xa2\x1e$b\xd2\xb7\xa0\xd46J\xcbbN\xd9\x8d\xe2\xeb\xb9d\xfeK\x05Pi\xd5\xa1\xf9x\x94\x87\xf0K#\x1fc\xe4\x00\xcfM\x90\xef\xc3\xcc]\xa4\xdekH\xa2\xd5\x82z,&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<p>flag：<code>n1ctf&#123;b9e7d419-0df8-438a-9120-efdf3ddf155f&#125;</code></p>
<h2 id="4-强网杯2024-traditional-game"><a href="#4-强网杯2024-traditional-game" class="headerlink" title="4.[强网杯2024]traditional game"></a>4.[强网杯2024]traditional game</h2><h3 id="4x01-题目大意"><a href="#4x01-题目大意" class="headerlink" title="4x01 题目大意"></a>4x01 题目大意</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime,bytes_to_long<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> secret,flag<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> signal<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_timeout</span>(<span class="hljs-params">signum, frame</span>):<br>    <span class="hljs-keyword">raise</span> TimeoutError(<span class="hljs-string">&#x27;function timeout&#x27;</span>)<br><br>timeout = <span class="hljs-number">300</span><br>signal.signal(signal.SIGALRM, _handle_timeout)<br>signal.alarm(timeout)<br><br>random.seed(secret + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time())).encode())<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RSA</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.p = getPrime(<span class="hljs-number">512</span>)<br>        <span class="hljs-variable language_">self</span>.q = getPrime(<span class="hljs-number">512</span>)<br>        <span class="hljs-variable language_">self</span>.e = getPrime(<span class="hljs-number">128</span>)<br>        <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.p * <span class="hljs-variable language_">self</span>.q<br>        <span class="hljs-variable language_">self</span>.phi = (<span class="hljs-variable language_">self</span>.p - <span class="hljs-number">1</span>) * (<span class="hljs-variable language_">self</span>.q - <span class="hljs-number">1</span>)<br>        <span class="hljs-variable language_">self</span>.d = <span class="hljs-built_in">pow</span>(<span class="hljs-variable language_">self</span>.e, -<span class="hljs-number">1</span>, <span class="hljs-variable language_">self</span>.phi)  <br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_pub</span> lic_key(<span class="hljs-variable language_">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">self</span>.n, <span class="hljs-variable language_">self</span>.e)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_private_key</span>(<span class="hljs-params">self, blind_bit=<span class="hljs-literal">None</span>, unknown_bit=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-keyword">if</span> blind_bit <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> unknown_bit <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            blind = getPrime(blind_bit)<br>            d_ = ((<span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.d &gt;&gt; unknown_bit) // blind * blind) &lt;&lt; unknown_bit) + <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.d % blind)<br>            <span class="hljs-keyword">return</span> (d_, blind)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">self</span>.d, <span class="hljs-number">0</span>)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self, m</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(m) == <span class="hljs-built_in">bytes</span>:<br>            m = bytes_to_long(m)<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(m) == <span class="hljs-built_in">str</span>:<br>            m = bytes_to_long(m.encode())<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(m, <span class="hljs-variable language_">self</span>.e, <span class="hljs-variable language_">self</span>.n)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">game</span>(<span class="hljs-params">self,m0,m1,b</span>):   <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.encrypt([m0,m1][b]) <br><br><br>rsa = RSA()<br>token = os.urandom(<span class="hljs-number">66</span>) <br><br><span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;[+] Welcome to the game!&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] rsa public key: <span class="hljs-subst">&#123;rsa.get_public_key()&#125;</span>&quot;</span>)<br><br>coins = <span class="hljs-number">100</span><br>price = <span class="hljs-number">100</span><br><span class="hljs-keyword">while</span> coins &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=================================&quot;</span>)<br>    b = random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)<br>    c = rsa.game(<br>        <span class="hljs-string">b&#x27;bit 0:&#x27;</span> + os.urandom(<span class="hljs-number">114</span>), <br>        <span class="hljs-string">b&#x27;bit 1:&#x27;</span> + os.urandom(<span class="hljs-number">114</span>), <br>        b)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] c:&quot;</span>,c)<br>    guessb = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[-] b:&quot;</span>))<br>    coins -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> guessb == b:<br>        price -= <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] correct!&quot;</span>) <br>    <span class="hljs-keyword">else</span>: <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] wrong!&quot;</span>) <br><br><span class="hljs-keyword">if</span> price != <span class="hljs-number">0</span>: <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] game over!&quot;</span>)<br>    exit()<br><br>blind_bit = <span class="hljs-number">40</span><br>unknown_bit = <span class="hljs-number">365</span><br><br>d_,blind = rsa.get_private_key(blind_bit, unknown_bit)<br><br><span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;[+] Now, you have permission to access the privkey!&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] privkey is: (<span class="hljs-subst">&#123;d_&#125;</span>,<span class="hljs-subst">&#123;blind&#125;</span>).&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] encrypt token is: <span class="hljs-subst">&#123;rsa.encrypt(bytes_to_long(token))&#125;</span>&quot;</span>)<br><br>guess_token = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[-] guess token:&quot;</span>))<br><span class="hljs-keyword">if</span> guess_token == token:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] correct token, here is your flag:&quot;</span>,flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] wrong token&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<p>题目还是分为两部分，后面一步一步地来看。</p>
<h3 id="4x02-Part-1"><a href="#4x02-Part-1" class="headerlink" title="4x02 Part 1"></a>4x02 Part 1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">coins = <span class="hljs-number">100</span><br>price = <span class="hljs-number">100</span><br><span class="hljs-keyword">while</span> coins &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=================================&quot;</span>)<br>    b = random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)<br>    c = rsa.game(<br>        <span class="hljs-string">b&#x27;bit 0:&#x27;</span> + os.urandom(<span class="hljs-number">114</span>), <br>        <span class="hljs-string">b&#x27;bit 1:&#x27;</span> + os.urandom(<span class="hljs-number">114</span>), <br>        b)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] c:&quot;</span>,c)<br>    guessb = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[-] b:&quot;</span>))<br>    coins -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> guessb == b:<br>        price -= <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] correct!&quot;</span>) <br>    <span class="hljs-keyword">else</span>: <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] wrong!&quot;</span>) <br><br><span class="hljs-keyword">if</span> price != <span class="hljs-number">0</span>: <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] game over!&quot;</span>)<br>    exit()<br><br>blind_bit = <span class="hljs-number">40</span><br>unknown_bit = <span class="hljs-number">365</span><br></code></pre></td></tr></table></figure>

<p>这一部分是区分两个值的特定比特。不是，就前面两个一样，后面 $912$ 位都不一样，这还能区分？</p>
<p>然后当时在那边想了半天，比赛的时候实在没想出来怎么搞这个。赛后问了其他的师傅：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs dns">Dialog huangx607087-DeeBaTo<br><br>huangx6<span class="hljs-number">07087 2024</span>/<span class="hljs-number">11/7 17:29</span>:<span class="hljs-number">09</span><br>师傅在吗？想问问你那边有无前几天强网杯的wp，之前看了rec师傅对那个traditional game的第一问也是开两个进程，同时连接容器，去获得同样的随机数种子做的，我很好奇那个题第一问的正确做法。<br><br>DeeBaTo <span class="hljs-number">2024/11/7</span> <span class="hljs-number">17</span>:<span class="hljs-number">29</span>:<span class="hljs-number">22</span><br>就是这个<br><br>DeeBaTo <span class="hljs-number">2024/11/7</span> <span class="hljs-number">17</span>:<span class="hljs-number">29</span>:<span class="hljs-number">34</span><br>网络协议里的反射攻击<br><br>Dialog huangx607087-rec<br><br>rec <span class="hljs-number">2024/11/7</span> <span class="hljs-number">17</span>:<span class="hljs-number">32</span>:<span class="hljs-number">39</span><br>上个月blackhat我和他一起打的<br><br>rec <span class="hljs-number">2024/11/7</span> <span class="hljs-number">17</span>:<span class="hljs-number">32</span>:<span class="hljs-number">43</span><br>有个题就是这样<br><br></code></pre></td></tr></table></figure>

<p>？？？好家伙，奇怪的知识增加了。所以开两个进程，然后同时连接。真会玩啊。。</p>
<p>大概代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solve</span>:<br>    <span class="hljs-variable language_">self</span>.sh=remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">60716</span>) <span class="hljs-comment"># for solve 2</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>():<br>        <span class="hljs-keyword">pass</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">solve1</span>():<br>        th=remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">60716</span>) <span class="hljs-comment">#only used in solve1</span><br>        A=[]<br>        <span class="hljs-comment">#solve code,collect results</span><br>        <span class="hljs-keyword">return</span> A<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">solve2</span>(<span class="hljs-params">resultarr</span>):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">solveall</span>():<br>        resultarr=solve1()<br>        solve2(resultarr)<br>    <br></code></pre></td></tr></table></figure>

<p>参考网址：<a target="_blank" rel="noopener" href="https://blog.s1um4i.com/2024-QWBCTF/#traditional_game">2024 强网杯 部分题解 - S1uM4i</a></p>
<h3 id="4x03-Part-2"><a href="#4x03-Part-2" class="headerlink" title="4x03 Part 2"></a>4x03 Part 2</h3><p>参考：<a target="_blank" rel="noopener" href="https://tangcuxiaojikuai.xyz/post/df3f7032.html#more">糖醋小鸡块的blog </a></p>
<p>通过Part1之后，我们可以获得 $d_x$ 的值，其值为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_private_key</span>(<span class="hljs-params">self, blind_bit=<span class="hljs-literal">None</span>, unknown_bit=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> blind_bit <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> unknown_bit <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        blind = getPrime(blind_bit)<br>        d_ = ((<span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.d &gt;&gt; unknown_bit) // blind * blind) &lt;&lt; unknown_bit) + <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.d % blind)<br>        <span class="hljs-keyword">return</span> (d_, blind)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">self</span>.d, <span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>

<p>这边 <code>unknown_bit=365,blind_bit=40</code>。</p>
<p>根据 $d_x$ 的表达式，如果化成十六进制，最低 40 位就是 $d \bmod b$ 的值，同时，题目中也告诉了我们 $b$ 的值。此时，我们知道了  $d$ 的高位和低位。</p>
<p>因此可以得到<br>$$<br>C&#x3D;e(bd_h+bd_m+d_l)&#x3D;1+k\varphi<br>$$<br>其中，$ed-1&#x3D;k\varphi&#x3D;k(n-(p+q)+1)\equiv k-k(p+q)\pmod n$。</p>
<p>但是这边 $k$ 不知道啊，看了参考的wp，然后自己动手实验了一下，因为 $d$ 高位知道了很多，$n$ 和 $\varphi$ 的高 $511$ 位是相同的，所以有<br>$$<br>\left \lfloor \frac{ebd_h}{n}\right \rfloor+1&#x3D;k<br>$$<br>设<br>$$<br>C&#x3D;e(bd_h+d_l-k(n+1)-1)<br>$$<br>到这一步，LLL就很简单了。我们期待求出 $(p+q,d_m)$，根据上面的式子，有<br>$$<br>ebd_m+k(p+q)\equiv n \pmod C<br>$$<br>其中：$d_m$ 预期为 $365$ 位，$(p+q)$ 预期为 $513$ 位。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">dh=(((dx&gt;&gt;<span class="hljs-number">365</span>)//b)*<span class="hljs-number">2</span>**<span class="hljs-number">365</span>)<br>dl=(dx&amp;<span class="hljs-number">0xffffffffff</span>)<br><span class="hljs-built_in">print</span>(dh,dl)<br>k=<span class="hljs-number">1</span>+(e*dh*b//n)<br>C=e*(b*dh+dl)-k*(n+<span class="hljs-number">1</span>)-<span class="hljs-number">1</span><br>M=[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,k],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,e*b],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,C]]<br>M=Matrix(ZZ,M)<br>M=M*diagonal_matrix(ZZ,[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">148</span>,C]) <span class="hljs-comment">#148=513-365</span><br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M3L:<br>    <span class="hljs-built_in">print</span>(v)<br><span class="hljs-comment">#(-165382578491530217740294945789051327054550730412409, 6069854417684843869781185345814449921057599813490779103392444182843066433073577984, 0)</span><br><span class="hljs-comment">#(24253655408554923753657477074063654465943861814895829354859517611675085695676047250571909835358720051039798073116052933831237123986406228006920402560817446, 660828381258241436840092787866586880655656505125224479398221243621629860031648793514091179644037262606768135285755491647488, 0)</span><br><span class="hljs-comment">#(13265834046843137898321312630162668582611515930035, -486881279321864056104093205528514024155683530545938397465394105939234142703058944, 412587550651454677464807044872817944212261052389482413806028317495998064325432106958378875349983999689868802166640436956611193538891106166781061387911779019238685876501201863206243588919056176)</span><br></code></pre></td></tr></table></figure>

<p>然后解出来一看：第二个向量是 $513$ 位，貌似成功了吗？</p>
<p>拿进去试一下，发现不对。。并且第一个向量非常短，经过测试，里面的结果是 $(-k,2^{148}eb,0)$，是一个非常非常trivial的解。如果令 $p+q&#x3D;x,d_m&#x3D;y$，那么有 $kx+eby$，那么 $(x,y)&#x3D;(-eb,k)$ 当然也是一组解咯。</p>
<p>设第二组数据为 $(x_2,y_2,0)$，由于 $x_2,y_2$ 大小符合预期，参考wp中的提示，可以认为 $p+q&#x3D;x_2+teb$，也就是<br>$$<br>p+q\equiv x_2\pmod {eb}<br>$$</p>
<p>因为我是本地数据测试，所以可以有 $p,q$，测一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">x2=<span class="hljs-built_in">abs</span>(M3L[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])<br>paddqL=(x2%(e*b))<br>paddqH=(x2//(e*b))*(e*b)<br><span class="hljs-built_in">print</span>(paddqL,paddqH)<br><span class="hljs-built_in">print</span>((p+q)%(e*b)==paddqL)<br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure>

<p>然后再测一下 $eb$ 进制下，$p+q$ 和 $x_2$ 的差别：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getradixb</span>(<span class="hljs-params">x,bb</span>):<br>    arr=[<span class="hljs-number">0</span>]*<span class="hljs-number">30</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>        arr[i]=x%bb<br>        x//=bb<br>    <span class="hljs-keyword">return</span> arr<br>A=<span class="hljs-built_in">print</span>(getradixb((dh*b)+dl,e*b))<br>B=<span class="hljs-built_in">print</span>(getradixb(d,e*b))<br><span class="hljs-built_in">print</span>(A)<br><span class="hljs-built_in">print</span>(B)<br><span class="hljs-comment">#[104668899241649537541186210781987061154261026601556, 92109567048793027288125736075569023185167845386074, 62813493539693390648778685609015503369769016471552, 80689223742648360656616346585665194908177979489243, 70805628792722422704735895621626856114034836989125, 41818883498127627092744577886150813128254101231100, 711081, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span><br><span class="hljs-comment">#[157342616402321470506410965081459618389668038679383, 105869422956878578854817467532416606067687308116443, 62813493539693390648778685611216892179500683590388, 80689223742648360656616346585665194908177979489243, 70805628792722422704735895621626856114034836989125, 41818883498127627092744577886150813128254101231100, 711081, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span><br></code></pre></td></tr></table></figure>

<p> 好像差的不多，不是吗（</p>
<p>然后就似乎已知 $d$ 部分位求解了，这一部分完全参考了鸡块佬的，下你求一个大概解，然后使用CRT求 $p$ 低位模 $eb$ 的值，可以发现这个题界卡得非常紧。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python">PR.&lt;x&gt; = PolynomialRing(RealField(<span class="hljs-number">2000</span>))<br>f = x*(paddqH-x) - n <br>ph = <span class="hljs-built_in">int</span>(f.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]) // (e*b) * (e*b)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>(f.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]))<br>R.&lt;x&gt; = PolynomialRing(Zmod(e))<br>fe = x*(paddqL-x) - n<br>rese = fe.roots()<br>R.&lt;x&gt; = PolynomialRing(Zmod(b))<br>fb = x*(paddqL-x) - n<br>resb = fb.roots()<br>rese=[rese[i][<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(rese))]<br>resb=[resb[i][<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(resb))]<br><span class="hljs-built_in">print</span>(rese,resb)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rese:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> resb:<br>        pl=crt([<span class="hljs-built_in">int</span>(i),<span class="hljs-built_in">int</span>(j)],[e,b])<br>        PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>        f = ph + e*b*x + pl<br>        f = f.monic()<br>        res = f.small_roots(X=<span class="hljs-number">2</span>**<span class="hljs-number">245</span>,beta=<span class="hljs-number">0.496</span>,epsilon=<span class="hljs-number">0.015</span>)<br>        <span class="hljs-keyword">if</span>(res!=[]):<br>            pg=ph+e*b*res[<span class="hljs-number">0</span>]+pl<br>            <span class="hljs-keyword">assert</span> (n%<span class="hljs-built_in">int</span>(pg)==<span class="hljs-number">0</span>)<br>            <span class="hljs-built_in">print</span>(pg)<br>            qg=<span class="hljs-built_in">int</span>(n)//<span class="hljs-built_in">int</span>(pg)<br>            dg=inverse(<span class="hljs-built_in">int</span>(e),<span class="hljs-built_in">int</span>((pg-<span class="hljs-number">1</span>)*(qg-<span class="hljs-number">1</span>)))<br>            <span class="hljs-built_in">print</span>(pg,qg)<br></code></pre></td></tr></table></figure>

<p>some situation.</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">rec <span class="hljs-number">2024</span><span class="hljs-regexp">/11/</span><span class="hljs-number">3</span> <span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">01</span><br>这个我和鸡块搞了一天。。<br><br>rec <span class="hljs-number">2024</span><span class="hljs-regexp">/11/</span><span class="hljs-number">3</span> <span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">10</span><br>我一个朋友出的，毫不留情<br></code></pre></td></tr></table></figure>

<p>麻了。</p>
<h2 id="9-总结"><a href="#9-总结" class="headerlink" title="9.总结"></a>9.总结</h2><p>好难啊，不过好在自己学到了很多，也算是挺有收获的了吧。</p>
<p>计划11月24日从贵阳回来之后，停一段时间CTF，预计12月5日恢复，12月15日打个国赛，后面考试和pre太多了，整个人要爆炸了:(</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTFSeason4/" class="category-chain-item">CTFSeason4</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/ExpLog/" class="print-no-link">#ExpLog</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>24Nov3</div>
      <div>http://example.com/2024/11/20/24Nov3/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>huangx607087</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年11月20日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/12/06/24Nov4/" title="24Nov4">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">24Nov4</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/11/15/24Nov2/" title="24Nov2">
                        <span class="hidden-mobile">24Nov2</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div style="font-size: 0.85rem"> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
