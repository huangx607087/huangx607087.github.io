<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>25Mar1-MTArchive</title>
    <link href="/2025/03/21/25Mar1-MTArchive/"/>
    <url>/2025/03/21/25Mar1-MTArchive/</url>
    
    <content type="html"><![CDATA[<h1 id="25å¹´3æœˆä¸“é¢˜1-MT19937"><a href="#25å¹´3æœˆä¸“é¢˜1-MT19937" class="headerlink" title="25å¹´3æœˆä¸“é¢˜1 MT19937"></a>25å¹´3æœˆä¸“é¢˜1 MT19937</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>æœ€è¿‘ä¸çŸ¥ä¸ºä½•ï¼Œå‘ç°MT19937å‡ºç°åœ°è¶Šæ¥è¶Šå¤šäº†ï¼Œé‚£å°±å†™ä¸€ä¸ªBlogè®°å½•ä¸€ä¸‹è¿™äº›é¢˜ç›®å§ï¼</p><p>å…¶å®è‡ªå·±åœ¨Explort MT19937ä¸­ï¼Œå·²ç»åœ¨2æœˆæ›´æ–°äº†ç›¸å…³å†…å®¹ï¼Œå°±æ˜¯åœ¨çŸ¥é“ä»»æ„19968ä¸ªbitæ—¶ï¼Œå¯ä»¥æ„é€  $19968\times19968$ çš„çŸ©é˜µï¼Œç„¶åè§£çº¿æ€§æ–¹ç¨‹ç»„å°±OKäº†ã€‚å½“ç„¶ï¼Œæ„é€ çŸ©é˜µæ—¶ï¼Œéœ€è¦ç¡®ä¿ä½ çš„MT19937æ¯”ç‰¹è·å–è¿‡ç¨‹åŒæ­¥ï¼Œä¹Ÿå°±æ˜¯éœ€è¦æ›´æ”¹ <code>getRows</code> å‡½æ•°ä¸­è·å–å†…å®¹ã€‚è¿™ä¸ªä»£ç æ˜¯è®°å½•çš„ $1250$ ç»„ <code>getrandbits(16)</code> çš„ç»“æœã€‚ï¼ˆå…¶å® $1248$ ç»„å°±OKäº†ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python">Dall=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;data3.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).readlines()))<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>n=<span class="hljs-number">1250</span><br>D=Dall[:n]<br>rng=Random()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    <span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†æ ¹æ®é¢˜ç›®å®é™…ç¼–å†™ï¼Œå¿…é¡»å’Œé¢˜ç›®å®é™…æ¯”ç‰¹è·å–é¡ºåºå’Œæ–¹å¼å®Œå…¨ä¸€è‡´ï¼Œä¸”ç¡®ä¿æ¯”ç‰¹æ•°å¤§äº19937ï¼Œå¹¶ä¸”è¯·æ³¨æ„zfillã€‚</span><br>    row=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(rng.getrandbits(<span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">16</span>))))<br>    <span class="hljs-keyword">return</span> row<br>M=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†ä¸ºå›ºå®šå¥—è·¯</span><br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <span class="hljs-comment">#è¿™ä¸ªsetstateä¹Ÿæ˜¯å›ºå®šæ ¼å¼ï¼Œå·²äº2025.1.21æµ‹è¯•</span><br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br>y=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    y+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(D[i])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">16</span>))))<br>y=vector(GF(<span class="hljs-number">2</span>),y)<br>s=M.solve_left(y)<br><span class="hljs-comment">#print(s)</span><br>G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    C=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        C&lt;&lt;=<span class="hljs-number">1</span><br>        C|=<span class="hljs-built_in">int</span>(s[<span class="hljs-number">32</span>*i+j])<br>    G.append(C)<br><span class="hljs-keyword">import</span> random<br>RNG1 = random.Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<br><br><span class="hljs-built_in">print</span>([RNG1.getrandbits(<span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">75</span>)])<br><span class="hljs-built_in">print</span>(D[:<span class="hljs-number">75</span>])<br></code></pre></td></tr></table></figure><h2 id="1-TPCTF-RandomlizedRandom"><a href="#1-TPCTF-RandomlizedRandom" class="headerlink" title="1.[TPCTF]RandomlizedRandom"></a>1.[TPCTF]RandomlizedRandom</h2><p>å…ˆçœ‹çœ‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># FROM python:3</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    flag=f.read()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">64</span>):<br>    <span class="hljs-built_in">print</span>(random.getrandbits(<span class="hljs-number">32</span>)+flag[random.getrandbits(<span class="hljs-number">32</span>)%<span class="hljs-built_in">len</span>(flag)])<br>    <span class="hljs-built_in">input</span>()<br>    <br></code></pre></td></tr></table></figure><p>äº¤äº’æ¬¡æ•°å¾ˆå¤šï¼Œå¹¶ä¸”å°±æ˜¯ç®€å•çš„ <code>getrandbits(32)</code>ï¼Œå¾ˆæ˜æ˜¾çš„MTç‰¹å¾ã€‚</p><p>ä½†è¿™è¾¹æ˜¯ <code>getrandbits(32)+flag[getrandbits(32)%len(flag)]</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™è¾¹ <code>getrandbits(32)</code> çš„ç»“æœæ˜¯å¸¦è¯¯å·®çš„ï¼Œå…¶è¯¯å·®å°±æ˜¯flagçš„å€¼ã€‚ä½†ç”±äºflagæ¯ä¸ªå­—ç¬¦ä¸è¶…è¿‡ $127$ï¼Œå› æ­¤å¯ä»¥è®¤ä¸ºå¾—åˆ°çš„æ‰€æœ‰ $32$ ä½æ•°å­—ä¸­ï¼Œå…¶é«˜ $8$ bit æ˜¯å‡†ç¡®çš„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å…ˆæ”¶é›†ä¸€æ³¢æ•°æ®ã€‚è¿™è¾¹ä¸ºäº†ä¿é™©ï¼Œæ”¶é›†äº† $10000$ ä¸ªã€‚ä½†å…¶å®ç”¨ä¸äº†é‚£ä¹ˆå¤šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>sh=remote(<span class="hljs-string">&#x27;1.95.57.127&#x27;</span>,<span class="hljs-number">3001</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;datarecv002.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>)):<br>        x=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>        f.write(<span class="hljs-built_in">str</span>(x)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>        sh.sendline(<span class="hljs-string">b&#x27;A&#x27;</span>)<br></code></pre></td></tr></table></figure><p>æ¥ç€æ„é€ çŸ©é˜µï¼Œç”±äºé¢˜ç›®ä¸­ç»™å‡ºçš„æ•°å­—æ˜¯å…ˆå–ä¸€ä¸ªï¼Œå†ä¸¢ä¸€ä¸ªçš„ï¼Œå› æ­¤æˆ‘ä»¬è¿™è¾¹ä¹Ÿè¦æŒ‰ç…§é¢˜ç›®çš„è¿‡ç¨‹æ¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>n=<span class="hljs-number">4992</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    <span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†æ ¹æ®é¢˜ç›®å®é™…ç¼–å†™ï¼Œå¿…é¡»å’Œé¢˜ç›®å®é™…æ¯”ç‰¹è·å–é¡ºåºå’Œæ–¹å¼å®Œå…¨ä¸€è‡´ï¼Œä¸”ç¡®ä¿æ¯”ç‰¹æ•°å¤§äº19937ï¼Œå¹¶ä¸”è¯·æ³¨æ„zfillã€‚</span><br>    row=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(rng.getrandbits(<span class="hljs-number">32</span>)&gt;&gt;<span class="hljs-number">24</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>))))<br>        _=rng.getrandbits(<span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">return</span> row<br>M=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†ä¸ºå›ºå®šå¥—è·¯</span><br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <span class="hljs-comment">#è¿™ä¸ªsetstateä¹Ÿæ˜¯å›ºå®šæ ¼å¼ï¼Œå·²äº2025.1.21æµ‹è¯•</span><br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br>save(M,<span class="hljs-string">&#x27;matrix308&#x27;</span>)<br></code></pre></td></tr></table></figure><p>æ„é€ çŸ©é˜µåï¼Œå°±æ˜¯å¤„ç†æ•°æ®ç„¶åè®¾ç½®stateäº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">D=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;datarecv001.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).readlines()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>):<br>    D[i]=<span class="hljs-built_in">int</span>(D[i])<br>n=<span class="hljs-number">4992</span><br>M=load(<span class="hljs-string">&#x27;matrix308.sobj&#x27;</span>)<br>y=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    y+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(D[i]&gt;&gt;<span class="hljs-number">24</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>))))<br>y=vector(GF(<span class="hljs-number">2</span>),y)<br>s=M.solve_left(y)<br>G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    C=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        C&lt;&lt;=<span class="hljs-number">1</span><br>        C|=<span class="hljs-built_in">int</span>(s[<span class="hljs-number">32</span>*i+j])<br>    G.append(C)<br><span class="hljs-keyword">import</span> random<br>RNG1 = random.Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¿™è¾¹è¿˜éœ€è¦ç®€å•çˆ†ç ´ä¸€ä¸‹flagçš„é•¿åº¦ï¼Œæœ€åå‘ç°æ˜¯ $29$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python">A=[]<br>B=[]<br>F=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>):<br>    a=RNG1.getrandbits(<span class="hljs-number">32</span>)<br>    b=RNG1.getrandbits(<span class="hljs-number">32</span>)<br>    f=D[i]-a<br>    A.append(a)<br>    B.append(b)<br>    F.append(f)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">L</span>):<br>    arr=[<span class="hljs-number">0</span>]*L<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>):<br>        cur=arr[B[i]%L]<br>        <span class="hljs-keyword">if</span>(cur-F[i] <span class="hljs-keyword">and</span> cur):<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>        <span class="hljs-keyword">elif</span>(<span class="hljs-keyword">not</span> cur):<br>            arr[B[i]%L]=F[i]<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">23</span>,<span class="hljs-number">99</span>):<br>    <span class="hljs-keyword">if</span>(check(i)):<br>        <span class="hljs-built_in">print</span>(i)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">make</span>(<span class="hljs-params">L</span>):<br>    arr=[<span class="hljs-number">0</span>]*L<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>):<br>            arr[B[i]%L]=F[i]<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(arr)<br><span class="hljs-built_in">print</span>(make(<span class="hljs-number">29</span>))<br><span class="hljs-comment">#b&#x27;TPCTF&#123;Ez_MTI9937_pr3d1cTi0n&#125;\n&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="2-SUCTF2025-SUPoly"><a href="#2-SUCTF2025-SUPoly" class="headerlink" title="2.[SUCTF2025]SUPoly"></a>2.[SUCTF2025]SUPoly</h2><p>é¢˜ç›®çœ‹ç€å¾ˆç®€å•ï¼Œå¹¶ä¸”é¸¡å—Blogä¸­ä¹Ÿå·²ç»æœ‰äº†WPï¼Œè¿™è¾¹å¤ç°ä¸€ä¸‹ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> signal<br><br>PR.&lt;x&gt; = PolynomialRing(Zmod(<span class="hljs-number">0xfffffffffffffffffffffffffffffffe</span>))<br>SUPOLY = PR.random_element(<span class="hljs-number">10</span>)<br>gift = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bytes_to_long(<span class="hljs-string">b&quot;SU&quot;</span>)):<br>    f = PR.random_element(<span class="hljs-number">10</span>)<br>    gift.append([<span class="hljs-built_in">int</span>((f*SUPOLY)(j)) &amp; <span class="hljs-number">0xff</span> <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ :&quot;</span>, gift)<br><br>signal.alarm(<span class="hljs-number">10</span>)<br><span class="hljs-keyword">if</span>(md5(<span class="hljs-built_in">str</span>(SUPOLY.<span class="hljs-built_in">list</span>()).encode()).hexdigest() == <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Show me :)&quot;</span>)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸš© :&quot;</span>, flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ³ï¸ :&quot;</span>, <span class="hljs-string">&quot;flag&quot;</span>)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜åœ¨è·å–Flagåæ—¶é—´åªæœ‰10ç§’ï¼Œæä¾›äº† $21333$ ç»„æ•°æ®ã€‚å¤šé¡¹å¼ä½¿ç”¨çš„æ¨¡æ•°ä¸º $2^{128}-2$ã€‚</p><p>è¿™è¾¹è§£é¢˜çš„æ¼æ´å°±æ˜¯ï¼šSagemathä¸­ï¼Œ<code>random_element</code> å‡½æ•°æ˜¯é€šè¿‡ <code>randrange()</code> è·å–çš„ï¼Œè¿™åŸºæœ¬ç­‰ä»·äº<code>getrandbits()</code>å–æ¨¡ï¼Œè¿™å°±ä¼šå¯¼è‡´åœ¨æ¨¡ $2^{32k}-1$ ä¸‹ï¼Œå…¶ç”Ÿæˆçš„æ•°å€¼ä¸MT19937ä¸­ <code>getrandbits(32*k)</code> ç”Ÿæˆçš„æ•°å€¼ä¸€è‡´ï¼Œè™½ç„¶åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¯èƒ½ä¼šåŠ ä¸Šæ¨¡æ•°ï¼Œä½†è¿™è¾¹æ¨¡æ•°ä¸º $2^{128}-2$ï¼Œäº§ç”Ÿå–æ¨¡çš„æ¦‚ç‡å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚å› æ­¤ä¹Ÿå°±æ˜¯è¯´ï¼Œå¤šé¡¹å¼ $s$ å’Œ $f$ çš„æ‰€æœ‰ç³»æ•°å‡å¯ä»¥çœ‹ä½œ MT19937 ç”Ÿæˆçš„åŸå§‹æ•°æ®ã€‚</p><p>é¢˜ç›®æœ€ç»ˆä¼šç»™å‡º $f_i\times s$ å– $0\sim9$ çš„å‡½æ•°å€¼ã€‚ä¸è¿‡è€ƒè™‘åˆ°æ•°æ®ç»„æ•°ä¸º $21333$ï¼Œå¹¶ä¸” $f\times s$ ä¼šå¯¼è‡´å¸¸æ•°é¡¹äº§ç”Ÿå˜åŒ–ã€‚ä½†é¢˜ç›®ä¸­çš„æ¨¡æ•°å–çš„æ˜¯ $2^{128}-2$ï¼Œå°±æ˜¯å› ä¸ºæ¨¡ $2$ ä¹‹åï¼Œ$(f_is(0))$ çš„æœ€åä¸€æ¯”ç‰¹æ˜¯ä¼šæš´éœ²çš„ã€‚å› æ­¤æˆ‘ä»¬å°±åªéœ€è¦è€ƒå¯Ÿ $(f_is)(0)$ å¯¹ $2$ å–æ¨¡çš„ç»“æœå°±OKã€‚å¦‚æœ $s$ çš„å¸¸æ•°é¡¹æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆå°±å¯èƒ½æš´éœ² $f_i$ çš„å¸¸æ•°é¡¹çš„æœ€ä½æ¯”ç‰¹ã€‚$21333&gt;19937$ï¼Œæ‰€ä»¥æ•°æ®æ˜¯è¶³å¤Ÿçš„äº†ã€‚</p><p>ä¸è¿‡ç”±äºé¢˜ç›®åªæœ‰10ç§’æ—¶é—´ï¼Œæˆ‘ä»¬å°±éœ€è¦é¢„å…ˆæ„é€ çŸ©é˜µï¼Œç„¶åå†è€ƒè™‘æ±‚é€†ã€‚</p><p>è¿™è¾¹éœ€è¦ä¸€ä¸ªå°ç»†èŠ‚ï¼šæ„é€ çš„æ—¶å€™ï¼Œæœ€å¥½ä½¿ç”¨<code>np.array</code>æ„é€ ï¼Œå› ä¸ºæˆ‘ä»¬è¿™è¾¹æ‰€æœ‰çš„æ•°å­—éƒ½æ˜¯ $(0,1)$ï¼Œæ‰€ä»¥<code>uint8</code> å°±å¤Ÿäº†ï¼Œè¿™æ ·ä¸€ä¸ªå€¼åªå  $1$ å­—èŠ‚ã€‚å¦åˆ™ä¸€ä¸ªå€¼è¦å  $28$ å­—èŠ‚ã€‚(ä½†è¿™ä¹ˆåšè¿˜æ˜¯æ²¡å•¥ç”¨ï¼Œå› ä¸ºä½ é€ çŸ©é˜µæ—¶ï¼Œå†…å­˜è¿˜æ˜¯ä¼šç‚¸ï¼Œä½†è‡³å°‘ä¸ä¼šç»™ä½ ç‚¸åˆ°ä¸¤å€å†…å­˜ã€‚)</p><p><del>å¥½å®¶ä¼™ï¼Œè¦æ˜¯CTFå†å‡ºè¿™ç§å¡16G+å†…å­˜çš„é¢˜çš„è¯ï¼Œç ”äºŒå°±æ¢64Gå†…å­˜çš„ç”µè„‘äº†ã€‚</del></p><p>$\mathsf{14min,16.6GB}$ï¼Œä½†æµ‹äº†å®˜æ–¹wpï¼Œå…¶æ¶ˆè€—ä¸º $\mathsf{12min,8.8GB}$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    row=np.zeros(<span class="hljs-number">21333</span>,dtype=<span class="hljs-string">&#x27;uint8&#x27;</span>)<br>    rng.getrandbits(<span class="hljs-number">128</span>*<span class="hljs-number">11</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">21333</span>):<br>        _a=rng.getrandbits(<span class="hljs-number">128</span>*<span class="hljs-number">10</span>)<br>        row[i]=(rng.getrandbits(<span class="hljs-number">128</span>)&amp;<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> row<br>M=[]<br>rng=Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†ä¸ºå›ºå®šå¥—è·¯ï¼Œå…·ä½“åŸå› å·²ç»å†™åœ¨æ³¨é‡Šä¸­äº†</span><br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>): <br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <span class="hljs-comment">#è¿™ä¸ªsetstateä¹Ÿæ˜¯å›ºå®šæ ¼å¼ï¼Œå·²äº2025.1.21æµ‹è¯•</span><br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br>save(M,<span class="hljs-string">&#x27;mat111&#x27;</span>)<br>save(M[[<span class="hljs-number">0</span>]+<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">19968</span>)),:<span class="hljs-number">19937</span>]**-<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;Minv&#x27;</span>)<br></code></pre></td></tr></table></figure><p>è¿™è¾¹ï¼Œ<code>M.rank()</code> ä¸º $19937$ï¼Œç¬¦åˆé¢„æœŸã€‚ä½†æˆ‘ä»¬åé¢è¦å¯¹å®ƒè¿›è¡Œé€†å‘ï¼Œå› æ­¤æˆ‘ä»¬è¦æ‰¾ä¸€ä¸ªæ–¹é˜µå¯¹å…¶æ±‚é€†ã€‚</p><p>ç»è¿‡æµ‹è¯•ï¼Œå¯¹äºè¿™ä¸ª $19968\times21333$ çš„çŸ©é˜µè€Œè¨€ï¼Œå– $19968\times19937$ çš„å­çŸ©é˜µï¼Œå…¶rankä»ç„¶æ˜¯ $19937$ã€‚ä½†å–å‰ $19937$ è¡Œï¼Œå…¶rankä¸º $19906$ï¼Œå–å $19937$ è¡Œï¼Œå…¶ rank ä¸º$19936$ã€‚å› æ­¤æœ€ç»ˆå–ç¬¬ä¸€è¡Œå’Œæœ€å $19936$ è¡Œï¼Œæ‰èƒ½å¤Ÿæ„æˆ $19937\times19937$ çš„çŸ©é˜µã€‚</p><p>æ³¨æ„åˆ°ä¹‹å‰è§£æ–¹ç¨‹ç”¨çš„æ˜¯ <code>solve_left</code>ï¼Œå› æ­¤å¯ä»¥åœ¨è¿™è¾¹ç»™ä»–æ¥ä¸ªè½¬ç½®ï¼Œç„¶åå†å¯¹è¿™ä¸ªå­çŸ©é˜µæ±‚é€†ï¼Œåé¢æ‹¿åˆ°æ•°æ®åï¼Œå°±å¯ä»¥å³ä¹˜å‘é‡äº†ã€‚</p><p>æ‹¿åˆ° $M^{-1}$ ä¹‹åï¼Œå°±å¯ä»¥æ¥æ”¶æ•°æ®ï¼Œè§£æ–¹ç¨‹ï¼Œæ„å»ºçŠ¶æ€äº†ã€‚æ³¨æ„åˆ°æˆ‘ä»¬è¿™è¾¹ $19968$ ä¸ªæ•°å€¼å–çš„æ˜¯ $0$ å’Œ $32\sim19967$ï¼Œå› æ­¤ $(M^{-1})^T\vec v$ å¾—åˆ°çš„ç¬¬ä¸€ä¸ªåˆ†é‡çš„ä¸‹æ ‡ä¸º $0$ï¼Œç¬¬äºŒä¸ªåˆ†é‡çš„ä¸‹æ ‡ä¸º $32$ï¼Œå› æ­¤ä¸­é—´è¿˜éœ€è¦å¡«å…… $31$ ä¸ª $0$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python">Minv=load(<span class="hljs-string">&#x27;Minv.sobj&#x27;</span>).T<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br>sh=remote(<span class="hljs-string">&#x27;node6.anna.nssctf.cn&#x27;</span>,<span class="hljs-number">21966</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>D=<span class="hljs-built_in">eval</span>(sh.recvline())<br>v=[D[i][<span class="hljs-number">0</span>]&amp;<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">21333</span>)]<br><br><span class="hljs-keyword">if</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">in</span> v):<br>    v = vector(GF(<span class="hljs-number">2</span>), v[:<span class="hljs-number">19937</span>])<br>    v=Minv*v<br>    v=<span class="hljs-built_in">list</span>(v)<br>    v=[v[<span class="hljs-number">0</span>]]+[<span class="hljs-number">0</span>]*<span class="hljs-number">31</span>+v[<span class="hljs-number">1</span>:]<br>    vstr = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, v)))<br>    state = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state.append(<span class="hljs-built_in">int</span>(vstr[<span class="hljs-number">32</span>*i:<span class="hljs-number">32</span>*i+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>))<br>    RNG1 = random.Random()<br>    RNG1.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>))<br>    s = [RNG1.getrandbits(<span class="hljs-number">128</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>)][::-<span class="hljs-number">1</span>]<br>    sh.recvuntil(<span class="hljs-string">b&quot;Show me :)&quot;</span>)<br>    sh.sendline(<span class="hljs-built_in">str</span>(md5(<span class="hljs-built_in">str</span>(s).encode()).hexdigest()).encode())<br>    <span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">7</span>))<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;fail&#x27;</span>)<br>sh.close()<br><span class="hljs-comment">#b&#x27;\xf0\x9f\x9a\xa9 : NSSCTF&#123;f614f081-ddec-4579-88e2-fdc29183bdc3&#125;\n&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="3-CATCTF-Random-game"><a href="#3-CATCTF-Random-game" class="headerlink" title="3.[CATCTF]Random_game"></a>3.[CATCTF]Random_game</h2><p>åˆæ˜¯å¾ˆçŸ­çš„é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>gift = <span class="hljs-string">b&quot;&quot;</span>.join(long_to_bytes((<span class="hljs-built_in">pow</span>(getrandbits(<span class="hljs-number">4</span>), <span class="hljs-number">2</span>*i, <span class="hljs-number">17</span>) &amp; <span class="hljs-number">0xf</span>) ^ getrandbits(<span class="hljs-number">8</span>), <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4567</span>))<br>m = <span class="hljs-built_in">list</span>(flag)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2024</span>):<br>    shuffle(m)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;gift =&quot;</span>, bytes_to_long(gift))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = &#x27;&quot;</span> +  <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">chr</span>,m))) + <span class="hljs-string">&quot;&#x27;&quot;</span>)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®åªç»™å‡ºäº†giftå’Œcï¼Œå¹¶ä¸”è¿™ä¸ªä¸Šé¢å‡ºç°äº† <code>getrandbits</code>ï¼Œé‚£è‚¯å®šè¿˜æ˜¯è¦ä» MT å»æ€è€ƒã€‚</p><p>ç”±äºé¢˜ç›®æ¯æ¬¡ç»™å‡ºçš„å†…å®¹æ˜¯ï¼š<br>$$<br>r_4^{2i}\mod 17 \mod 16 \oplus r_8<br>$$<br>å› æ­¤ï¼Œ$r_8$ çš„é«˜ $4$ ä½æ˜¯ä¿æŒä½äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç›´æ¥å¾—åˆ°äº† $4\times4567&#x3D;18268$ ä¸ªå†…éƒ¨çŠ¶æ€ï¼Œä½†è²Œä¼¼è¿˜ä¸å¤Ÿã€‚ã€‚ã€‚</p><p>ä¸è¿‡æˆ‘ä»¬å¯ä»¥å‘ç°è¿™è¾¹çš„æ¨¡æ•°æ˜¯ $17$ï¼Œè€Œ $a^{16}\equiv 1 \pmod {17}$ï¼Œå› ä¸ºæ¯ $8$ è½®ï¼Œ$r_8$ å¼‚æˆ–çš„å€¼å°±ä¸€å®šä¸º $1$ï¼Œé‚£ä¹ˆè½®æ•°ï¼ˆä» $0$ è®¡æ•°ï¼‰æ˜¯ $8$ çš„å€æ•°çš„è½®æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ä½ $4$ ä½ï¼Œè¿™åˆæ˜¯ $2284$ ä¸ªæ¯”ç‰¹ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±ä¸€å…±å¾—åˆ°äº† $20552$ ä¸ªçŠ¶æ€äº†ã€‚</p><p>è¿™ä¼¼ä¹æ˜¯ä¸€ä»¶å¾ˆç¾å¦™çš„äº‹æƒ…ï¼Œç»“æœã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>D=long_to_bytes(gift)<br>y=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4567</span>):<br>    x=D[i]<br>    <span class="hljs-keyword">if</span>(i%<span class="hljs-number">8</span>==<span class="hljs-number">0</span>):<br>        y+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(x^^<span class="hljs-number">1</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>))))<br>    <span class="hljs-keyword">else</span>:<br>        y+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(x&gt;&gt;<span class="hljs-number">4</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">4</span>))))<br>y=vector(GF(<span class="hljs-number">2</span>),y)<br>s=M.solve_left(y)<br>G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    C=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        C&lt;&lt;=<span class="hljs-number">1</span><br>        C|=<span class="hljs-built_in">int</span>(s[<span class="hljs-number">32</span>*i+j])<br>    G.append(C)<br>RNG1 = Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<br><span class="hljs-comment">#ValueError: matrix equation has no solutions</span><br></code></pre></td></tr></table></figure><p>ä»€ä¹ˆé¬¼ï¼Ÿæˆ‘éƒ½æ˜¯æŒ‰ç…§æµç¨‹æ¥çš„ï¼Œä¸ºå•¥æ²¡è§£ï¼Ÿï¼ï¼ï¼</p><p>ç®€å•æ€è€ƒäº†ä¸€ä¸‹å‘ç°ï¼šå› ä¸º <code>getrandbits(4)</code> çš„ç»“æœå¯èƒ½æ˜¯ $0$ï¼Œ$0^{16}\equiv 0\pmod {17}$ï¼Œè€Œæˆ‘å‰é¢é”™è¯¯åœ°å°†å…¶è®¤ä¸ºæ˜¯ $1$ äº†ï¼Œç¬‘æ­»ã€‚</p><p>é‚£å¦‚æœå¹²è„†æŠŠè¿™ä¸€ä½ä¸¢æ‰å‘¢ï¼Ÿé‚£å°±è¿˜çŸ¥é“ $3\times 571&#x3D;19981$ ä½ï¼Œä¹Ÿç®—å‹‰å¼ºå¤Ÿï¼Œé‚£å°±æŠŠè¿™ä½å»äº†é‡æ–°æ„é€ çŸ©é˜µå§ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    row=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4567</span>):<br>        x=rng.getrandbits(<span class="hljs-number">4</span>)<br>        x=rng.getrandbits(<span class="hljs-number">8</span>)<br>        <span class="hljs-keyword">if</span>(i%<span class="hljs-number">8</span>==<span class="hljs-number">0</span>):<br>            row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(x&gt;&gt;<span class="hljs-number">1</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">7</span>))))<br>        <span class="hljs-keyword">else</span>:<br>            row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(x&gt;&gt;<span class="hljs-number">4</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">4</span>))))<br>    <span class="hljs-keyword">return</span> row<br>rng=Random()<br>M=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†ä¸ºå›ºå®šå¥—è·¯</span><br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <span class="hljs-comment">#è¿™ä¸ªsetstateä¹Ÿæ˜¯å›ºå®šæ ¼å¼ï¼Œå·²äº2025.1.21æµ‹è¯•</span><br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br>save(M,<span class="hljs-string">&#x27;catrandom3&#x27;</span>)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°æ–°çš„çŸ©é˜µåï¼Œç„¶åé‡æ–°èµ°æµç¨‹å°±OKäº†ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python">M=load(<span class="hljs-string">&#x27;catrandom3.sobj&#x27;</span>)<br>gift=<br>c=<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>D=long_to_bytes(gift)<br>y=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4567</span>):<br>    x=D[i]<br>    <span class="hljs-keyword">if</span>(i%<span class="hljs-number">8</span>==<span class="hljs-number">0</span>):<br>        y+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(x&gt;&gt;<span class="hljs-number">1</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">7</span>))))<br>    <span class="hljs-keyword">else</span>:<br>        y+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(x&gt;&gt;<span class="hljs-number">4</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">4</span>))))<br>y=vector(GF(<span class="hljs-number">2</span>),y)<br>s=M.solve_left(y)<br>G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    C=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        C&lt;&lt;=<span class="hljs-number">1</span><br>        C|=<span class="hljs-built_in">int</span>(s[<span class="hljs-number">32</span>*i+j])<br>    G.append(C)<br>RNG1 = Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4567</span>):<br>    RNG1.getrandbits(<span class="hljs-number">4</span>)<br>    RNG1.getrandbits(<span class="hljs-number">8</span>)<br>x = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c))]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2024</span>):<br>    RNG1.shuffle(x)<br>s=[<span class="hljs-literal">None</span>]*<span class="hljs-built_in">len</span>(c)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)):<br>    s[x[i]]=c[i]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(s))<br><span class="hljs-comment">#catctf&#123;_Shuf|fl3_s|hUFf1e_UnsHUff|L3_unsH|ufF1E_&#125;</span><br></code></pre></td></tr></table></figure><p>åˆå›é¡¾äº†ä¸€ä¸‹wpï¼Œwpæ˜¯åˆ©ç”¨äº†æ›´å¤šç»„æ•°æ®ï¼šå› ä¸º $x^8\equiv Â±1\pmod {17}$ï¼Œå› æ­¤å½“è½®æ•°æ˜¯ $4$ çš„å€æ•°æ—¶ï¼Œè¿™ä¸€è½®æˆ‘ä»¬å¯ä»¥çŸ¥é“ $7$ ä¸ªä½ï¼æ‰€ä»¥æœ€åæˆ‘ä»¬å®é™…èƒ½çŸ¥é“çš„ä½æ•°æ˜¯è¿˜èƒ½å¤Ÿæ›´å¤šã€‚</p><h2 id="4-N1CTF-junior-BabyAES"><a href="#4-N1CTF-junior-BabyAES" class="headerlink" title="4.[N1CTF_junior]BabyAES"></a>4.[N1CTF_junior]BabyAES</h2><p>è¿˜æ˜¯çœ‹çœ‹é¢˜å…ˆï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randbytes<br><span class="hljs-keyword">import</span> os<br><br><br>pad = <span class="hljs-keyword">lambda</span> x: x+randbytes(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(x)%<span class="hljs-number">16</span>)<br>cipher = AES.new(os.urandom(<span class="hljs-number">16</span>), AES.MODE_CBC, iv=randbytes(<span class="hljs-number">16</span>))<br><br><span class="hljs-keyword">for</span> ROUND <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>    msg = pad(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;msg: &quot;</span>)))<br>    cts = [cipher.encrypt(msg), randbytes(<span class="hljs-built_in">len</span>(msg))]<br>    decision = os.urandom(<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]&amp;<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ct:&quot;</span>, cts[decision].<span class="hljs-built_in">hex</span>())<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[+] &quot;</span>) == <span class="hljs-built_in">str</span>(decision)<br><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> uuid4<br>FLAG = <span class="hljs-string">&quot;flag&#123;&quot;</span>+<span class="hljs-built_in">str</span>(uuid4())+<span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Congrats! ğŸš© <span class="hljs-subst">&#123;FLAG&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>ä»£ç ä»ç„¶å¾ˆçŸ­ã€‚é¢˜ç›®è¦æ±‚ä½ è¿ç»­ $128$ è½®çŒœæµ‹ï¼Œæ¯æ¬¡è¾“å…¥ä¸€ä¸ªæ˜æ–‡ $m$ï¼Œé—®ä½ è¾“å‡ºç»“æœæ˜¯ $m$ å¯¹åº”çš„å¯†æ–‡è¿˜æ˜¯éšæœºå­—ç¬¦ä¸²ã€‚</p><p>æµ‹äº†ä¸€ä¸‹è¿™è¾¹çš„ <code>randbytes</code>ï¼Œçœ‹æ¥å’Œ <code>getrandbits</code> çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚ä¸è¿‡å…³æ³¨é¡ºåºå¯ä»¥å‘ç° <code>randbytes</code> å¾—åˆ°çš„å­—ç¬¦ä¸²çš„æ•°æ®æ˜¯å€’ç€æ¥çš„ã€‚ è€Œ <code>os.urandom</code> ä¸ä¼šå½±å“ <code>randbytes</code> çš„ç”Ÿæˆé¡ºåºï¼ˆå› ä¸ºä¸æ˜¯randomåŒ…ä¸­çš„å†…å®¹ï¼‰ã€‚</p><p><img src="/2025/03/21/25Mar1-MTArchive/1.png" alt="1"></p><p>æœ‰äº†è¿™ä¸ªä¿¡æ¯åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œè§£é¢˜äº†ï¼šæ³¨æ„åˆ°é¢˜ç›®ä¸­çš„è¿™å¥è¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">cts = [cipher.encrypt(msg), randbytes(<span class="hljs-built_in">len</span>(msg))]<br></code></pre></td></tr></table></figure><p>å› æ­¤æˆ‘ä»¬ç¬¬ä¸€æ¬¡å¯ä»¥å‘ä¸€ä¸ªå¾ˆé•¿å¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œç„¶åçŒœ $1$ ï¼Œè¿™ä¸ªæœ‰ä¸€åŠçš„æ¦‚ç‡æˆåŠŸã€‚å¦‚æœè¿™æˆåŠŸäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾—åˆ°äº†éå¸¸å¤šçš„stateã€‚</p><p>é‚£è¿™ä¸ªå­—ç¬¦ä¸²å‘å¤šé•¿å‘¢ï¼Ÿå› ä¸ºä¸€ä¸ª bytes æ˜¯ 8 ä½ï¼Œä¹Ÿå°±æ˜¯ <code>getrandbits(32)</code> çš„å››åˆ†ä¹‹ä¸€ã€‚ä½¿ç”¨ <code>getrandbits(32)</code> éœ€è¦ $624$ ä¸ª stateã€‚é‚£ä¹ˆè¿™è¾¹å°±æ˜¯ $2496$ ä¸ªå­—èŠ‚é•¿åº¦ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¢˜ç›®ä¸­ä¼šæœ‰ä¸€ä¸ªpadæˆ $16$ çš„å€æ•°çš„é•¿åº¦ï¼Œè¿™ä¼šå½±å“è¾“å‡ºç»“æœï¼Œå› æ­¤ä¹Ÿéœ€è¦è€ƒè™‘è¿›å»ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å‘é€ $2480$ å­—èŠ‚ï¼ŒåŠ ä¸Š $16$ å­—èŠ‚å¡«å……ï¼Œé‚£æœ€åå°±æ˜¯ $2496$ å­—èŠ‚äº†ã€‚</p><p>å¦‚æœä¸Šä¸€ä¸ªæ­¥éª¤æˆåŠŸäº†ã€‚è€ƒè™‘åˆ° MT19937 è¾“å‡ºæ¯”ç‰¹æ•°æœ€å¥½ä¸º 32 çš„å€æ•°ï¼Œå› æ­¤åé¢ $127$ è½®æˆ‘ä»¬å¯ä»¥ä¸€æ¬¡å‘é€ $4$ å­—èŠ‚ï¼Œç„¶åæœåŠ¡å™¨ä¼šç”¨ <code>randbytes</code> å¡«å…… $12$ å­—èŠ‚å‡‘å¤Ÿ $16$ å­—èŠ‚ï¼Œè¿™ä¹Ÿåˆšå¥½æ˜¯ $4$ ä¸ª 32bit-state çš„çŠ¶æ€ã€‚å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬ä¸€æ¬¡å‘ $4$ å­—èŠ‚ï¼Œ<code>cts=[cipher.encrypt(msg), randbytes(len(msg))]</code>  è¿˜ä¼šè°ƒç”¨ä¸€æ¬¡<code>randbytes</code>ï¼Œå› æ­¤æˆ‘ä»¬è¿˜è¦å†è®¡ç®— $16$ å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯ $4$ ä¸ªçŠ¶æ€çš„å€¼ã€‚</p><p>æœ€ç»ˆæœ¬åœ°æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼Œè¿™è¾¹ <code>mttools</code> è¿˜æ˜¯æˆ‘ä¹‹å‰åœ¨ Explore MT19937 ä¸­ç¬¬äºŒç« æœ€åå†™çš„æ¨¡æ¿ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> mttools <span class="hljs-keyword">import</span> *<br>sh=process([<span class="hljs-string">&#x27;python3&#x27;</span>,<span class="hljs-string">&#x27;localtest.py&#x27;</span>])<br>sh.recvuntil(<span class="hljs-string">b&#x27;msg:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;00&#x27;</span>*<span class="hljs-number">2480</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;ct:&#x27;</span>)<br>recv=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br><span class="hljs-built_in">print</span>(recv)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(recv)//<span class="hljs-number">2</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>F=MT19937()<br>D=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>di=recv[i*<span class="hljs-number">8</span>:i*<span class="hljs-number">8</span>+<span class="hljs-number">8</span>]<br>di=(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">24</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">4</span>:<span class="hljs-number">6</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">16</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">8</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>],<span class="hljs-number">16</span>))<br>D.append(di)<br>F.setstate(D)<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">for</span> T <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">127</span>)):<br>sh.recvuntil(<span class="hljs-string">b&#x27;msg:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;00&#x27;</span>*<span class="hljs-number">4</span>)<br>test=[F.getstate()<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>)][<span class="hljs-number">3</span>:]<br><span class="hljs-comment">#print(test)</span><br>sh.recvuntil(<span class="hljs-string">b&#x27;ct:&#x27;</span>)<br>D=[]<br>recv=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>di=recv[i*<span class="hljs-number">8</span>:i*<span class="hljs-number">8</span>+<span class="hljs-number">8</span>]<br>di=(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">24</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">4</span>:<span class="hljs-number">6</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">16</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">8</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>],<span class="hljs-number">16</span>))<br>D.append(di)<br><span class="hljs-comment">#print(D)</span><br><span class="hljs-keyword">if</span>(D==test):<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>sh.sendline(<span class="hljs-string">b&#x27;0&#x27;</span>)<br><span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">6</span>))<br><span class="hljs-comment">#b&#x27;[+] Congrats! \xf0\x9f\x9a\xa9 flag&#123;71e3453c-5edb-4ef2-bb51-6c9a5f3b782b&#125;\n&#x27;</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶æ®è¯´maple3142å¤§ä½¬åœ¨githubä¸Šç»™å‡ºäº†[æ¿å­](<a href="https://github.com/maple3142/gf2bv">maple3142&#x2F;gf2bv: Solving linear systems over GF(2) by manipulating bitvectors (github.com)</a>)ã€‚è¿™ä¸ªå°å·¥å…·å¯ä»¥é¢„æµ‹è¿ç»­çš„  <code>getrandbits(X)</code> ï¼Œä¸è¿‡éœ€è¦å®‰è£…ä¸€äº›ä¾èµ–åº“ã€‚å¥½åœ¨è¿™ç©æ„å¯ä»¥åœ¨ 2GB çš„æœåŠ¡å™¨ä¸Šæµç•…è¿è¡Œï¼ˆå ç”¨å†…å­˜ä»… $\mathsf{250MB}$ï¼‰ï¼Œä¸ç”¨æ„é€ çŸ©é˜µã€‚ä½†ä¸çŸ¥ä¸ºä½•ï¼Œè²Œä¼¼å¾ˆå¤šæ—¶å€™é¢„æµ‹ä¼šæœ‰æ— è§£çš„æƒ…å†µï¼ˆå®é™…æœ‰è§£ï¼‰ï¼Œå› æ­¤æœ€å¥½è®©ä»–å¤šè¿è¡Œå‡ æ¬¡ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random, time<br><span class="hljs-keyword">from</span> gf2bv <span class="hljs-keyword">import</span> LinearSystem<br><span class="hljs-keyword">from</span> gf2bv.crypto.mt <span class="hljs-keyword">import</span> MT19937<br><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> perf_counter<br><span class="hljs-keyword">from</span> contextlib <span class="hljs-keyword">import</span> contextmanager<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">RUN</span>():<br>    <span class="hljs-keyword">try</span>:<br>        sh=process([<span class="hljs-string">&#x27;python3&#x27;</span>,<span class="hljs-string">&#x27;localtest.py&#x27;</span>])<br>        sh.recvuntil(<span class="hljs-string">b&#x27;msg:&#x27;</span>)<br>        sh.sendline(<span class="hljs-string">b&#x27;00&#x27;</span>*<span class="hljs-number">2480</span>)<br>        sh.recvuntil(<span class="hljs-string">b&#x27;ct:&#x27;</span>)<br>        recv=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>        <span class="hljs-comment">#sh.recvuntil(b&#x27;] &#x27;)</span><br>        sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">mt19937</span>(<span class="hljs-params">bs, out</span>):<br>            <span class="hljs-built_in">print</span>(out)<br>            lin = LinearSystem([<span class="hljs-number">32</span>] * <span class="hljs-number">624</span>)<br>            mt = lin.gens()<br>            rng = MT19937(mt)<br>            zeros = [rng.getrandbits(bs) ^ <span class="hljs-built_in">int</span>(o) <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> out] + [mt[<span class="hljs-number">0</span>] ^ <span class="hljs-built_in">int</span>(<span class="hljs-number">0x80000000</span>)]<br>            sol = lin.solve_one(zeros)<br>            <span class="hljs-comment">#print(sol)</span><br>            rng = MT19937(sol)<br>            pyrand = rng.to_python_random()<br>            <span class="hljs-keyword">return</span> pyrand<br>        D=[]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        di=recv[i*<span class="hljs-number">8</span>:i*<span class="hljs-number">8</span>+<span class="hljs-number">8</span>]<br>        di=(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">24</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">4</span>:<span class="hljs-number">6</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">16</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">8</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>],<span class="hljs-number">16</span>))<br>        D.append(di)<br>        rng10=mt19937(<span class="hljs-number">32</span>,D[:])<br>        <br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>            <span class="hljs-keyword">assert</span> (rng10.getrandbits(<span class="hljs-number">32</span>)==D[i])<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;assert pass&#x27;</span>)<br>        <br>        <span class="hljs-keyword">for</span> T <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">127</span>):<br>            sh.recvuntil(<span class="hljs-string">b&#x27;msg:&#x27;</span>)<br>            sh.sendline(<span class="hljs-string">b&#x27;00&#x27;</span>*<span class="hljs-number">4</span>)<br>            test=[rng10.getrandbits(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>)][<span class="hljs-number">3</span>:]<br>            sh.recvuntil(<span class="hljs-string">b&#x27;ct:&#x27;</span>)<br>            D=[]<br>            recv=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                di=recv[i*<span class="hljs-number">8</span>:i*<span class="hljs-number">8</span>+<span class="hljs-number">8</span>]<br>                di=(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">24</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">4</span>:<span class="hljs-number">6</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">16</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>],<span class="hljs-number">16</span>)&lt;&lt;<span class="hljs-number">8</span>)+(<span class="hljs-built_in">int</span>(di[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>],<span class="hljs-number">16</span>))<br>                D.append(di)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;T=&#125;</span>&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;D=&#125;</span>&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;test=&#125;</span>&#x27;</span>)<br>            <span class="hljs-keyword">if</span>(D==test):<br>                sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                sh.sendline(<span class="hljs-string">b&#x27;0&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">6</span>))<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">except</span>:<br>        sh.close()<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span>(RUN()):<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-comment">#b&#x27;[+] Congrats! \xf0\x9f\x9a\xa9 flag&#123;ad75507a-c187-4675-8498-f465d5532b7d&#125;\n&#x27;</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶è¿™è¾¹è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å·¥å…·ï¼šæ¯”å¦‚ExtendMT19937Predictorï¼ˆåŠŸèƒ½æ›´å¤šï¼Œå¯é¢„æµ‹randint,randrangeï¼Œä½†stateåªèƒ½è®¾ç½®æˆ $32$ æ¯”ç‰¹çš„å€æ•°ï¼‰å’ŒMT19937Predictor-masterï¼ˆå¯ä»¥é¢„æµ‹ <code>getrandbits(X)</code>ï¼Œ$X$ ä¸ºä»»æ„å€¼ï¼Œå…¶åŸç†ä¹Ÿæ˜¯æ„é€ çŸ©é˜µï¼‰ã€‚ã€‚</p><h2 id="5-NSSr3-MT"><a href="#5-NSSr3-MT" class="headerlink" title="5.[NSSr3] MT"></a>5.[NSSr3] MT</h2><p>è¿™æ˜¯ä¸¤ä¸ªé¢˜ç›®ï¼Œä¸€èµ·çœ‹ï¼</p><h3 id="5x01-MT-N"><a href="#5x01-MT-N" class="headerlink" title="5x01 MT-N"></a>5x01 MT-N</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">N</span>(<span class="hljs-params">k</span>):<br>    <span class="hljs-keyword">return</span> getrandbits(<span class="hljs-number">1</span>) &amp; <span class="hljs-number">0</span> <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> getrandbits(k)<br><br>gift = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100000</span>):<br>    gift.append(N(N(N(<span class="hljs-number">1</span>))))<br><br>key = getrandbits(<span class="hljs-number">500</span>)<br>c = bytes_to_long(flag)^key<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-string">f&quot;gift = <span class="hljs-subst">&#123;gift&#125;</span>\n&quot;</span>)<br>    f.write(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;long_to_bytes(c)&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº† $100,000$ ç»„ <code>N(N(N(1)))</code> çš„ç»“æœï¼Œè€Œå‡½æ•° $N$ å°±æ˜¯è°ƒç”¨ä¸€æ¬¡ <code>getrandbits(1)</code> ã€‚ç”±äº $N$ æ—¶ä¸‰å±‚åµŒå¥—ï¼Œè€Œåªè¦æœ‰ä¸€å±‚çš„ç»“æœä¸º $0$ï¼Œåˆ™æœ€ç»ˆçš„ç»“æœä¸º $0$ï¼Œåªæœ‰ä¸‰æ¬¡ <code>getrandbits(1)</code> éƒ½æ˜¯ $1$ï¼Œæœ€ç»ˆç»“æœæ‰ä¼šè¿”å› $1$ã€‚</p><p>æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç° $1$ çš„ä¸ªæ•°ç¡®å®æ¥è¿‘ $1&#x2F;8$ æ€»æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">sum</span>(gift)<br><span class="hljs-comment">#12602</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆå°±æŒ‰å¥—è·¯ä¸Šexpï¼ˆ$\mathsf{9min,5.9GB}$ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python">gift=<br>c=<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>n=<span class="hljs-number">100000</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    <span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†æ ¹æ®é¢˜ç›®å®é™…ç¼–å†™ï¼Œå¿…é¡»å’Œé¢˜ç›®å®é™…æ¯”ç‰¹è·å–é¡ºåºå’Œæ–¹å¼å®Œå…¨ä¸€è‡´ï¼Œä¸”ç¡®ä¿æ¯”ç‰¹æ•°å¤§äº19937ï¼Œå¹¶ä¸”è¯·æ³¨æ„zfillã€‚</span><br>    row=[]<br>    s=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        a1=rng.getrandbits(<span class="hljs-number">1</span>)<br>        a2=rng.getrandbits(<span class="hljs-number">1</span>)<br>        a3=rng.getrandbits(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span>(gift[i]):<br>            s+=<span class="hljs-number">1</span><br>            row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(a1)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">1</span>))))<br>            row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(a2)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">1</span>))))<br>            row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(a3)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">1</span>))))<br>        <span class="hljs-keyword">if</span>(s&gt;=<span class="hljs-number">7000</span>):<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> row<br>M=[]<br>rng=random.Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†ä¸ºå›ºå®šå¥—è·¯</span><br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <span class="hljs-comment">#è¿™ä¸ªsetstateä¹Ÿæ˜¯å›ºå®šæ ¼å¼ï¼Œå·²äº2025.1.21æµ‹è¯•</span><br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br>y=[]<br>tot=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    <span class="hljs-keyword">if</span>(gift[i]):<br>        y+=[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]<br>        tot+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span>(tot&gt;=<span class="hljs-number">7000</span>):<br>        <span class="hljs-keyword">break</span><br>y=vector(GF(<span class="hljs-number">2</span>),y)<br>s=M.solve_left(y)<br><span class="hljs-comment">#print(s)</span><br>G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    C=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        C&lt;&lt;=<span class="hljs-number">1</span><br>        C|=<span class="hljs-built_in">int</span>(s[<span class="hljs-number">32</span>*i+j])<br>    G.append(C)<br><span class="hljs-keyword">import</span> random<br>RNG1 = random.Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">300000</span>):<br>    RNG1.getrandbits(<span class="hljs-number">1</span>)<br>K=RNG1.getrandbits(<span class="hljs-number">500</span>)<br>C=bytes_to_long(c)<br><span class="hljs-built_in">print</span>(long_to_bytes(C^^K))<br></code></pre></td></tr></table></figure><h3 id="5x02-MT-SS"><a href="#5x02-MT-SS" class="headerlink" title="5x02 MT-SS"></a>5x02 MT-SS</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">SS</span>(<span class="hljs-params">k</span>):<br>    <span class="hljs-keyword">return</span> getrandbits(<span class="hljs-number">1</span>) &amp; <span class="hljs-number">0</span> <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> getrandbits(k)<br><br>gift = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50000</span>):<br>    gift.append(SS(SS(<span class="hljs-number">5</span>)))<br><br>key = getrandbits(<span class="hljs-number">500</span>)<br>c = bytes_to_long(flag)^key<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-string">f&quot;gift = <span class="hljs-subst">&#123;gift&#125;</span>\n&quot;</span>)<br>    f.write(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;long_to_bytes(c)&#125;</span>&quot;</span>)<br><span class="hljs-comment">#NSSCTF&#123;1st_year_2nd_year_And_now_is_3rd_not_4th_Do_U_know_why?&#125;</span><br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶è¿™ä¸ª SS å°±æ˜¯ä¸Šä¸ªé¢˜çš„ Nã€‚ä½†è¿™è¾¹æ˜¯ä¸¤æ¬¡åµŒå¥— SSï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨å¾—åˆ° <code>getrandbits(5)</code>ï¼Œè¿™æ˜¯ä¸€ä¸ª $0\sim31$ çš„æ•°å­—ã€‚ç¬¬äºŒæ¬¡è°ƒç”¨ <code>getrandbits()</code> ç›¸å½“äºå–çš„ä½æ•°ä¸ºéšæœºå€¼ã€‚ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š <code>getrandbits()</code> äº§ç”Ÿçš„æ˜¯ $0\sim2^x-1$ çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å¦‚æœæŸä¸ª <code>getrandbits()</code> è¿”å›äº†ä¸€ä¸ª $n$ bit çš„æ•°ï¼Œæˆ‘ä»¬åªçŸ¥é“å‚æ•°å€¼ä¸€å®šå¤§äºç­‰äº $n$ï¼Œä½†å…·ä½“å€¼æˆ‘ä»¬å´ä¸çŸ¥é“ã€‚ç”±äºè¿™è¾¹ <code>getrandbits()</code> çš„å‚æ•°å‡ä¸è¶…è¿‡ $32$ï¼Œå› æ­¤æ¯æ¬¡è°ƒç”¨åªæ¶ˆè€—ä¸€ä¸ªå†…éƒ¨çš„ $32$ ä½ <code>state</code>ã€‚</p><p>è™½ç„¶æˆ‘ä»¬ä¸æ¸…æ¥šæ¯ä¸€è½®å¤–ä¾§ <code>getrandbits()</code> çš„å‚æ•°ï¼Œä½†è¯¥å‚æ•°ä¸€å®šåœ¨ $0\sim 31$ ä¸­ã€‚å› æ­¤çœ‹åˆ° $31$ æ¯”ç‰¹çš„æ•°å€¼ï¼Œå°±è¯´æ˜å‚æ•°æ˜¯ $31$ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¸€æ¬¡å¾—åˆ° $5+31&#x3D;36$ ä¸ªå‡†ç¡®çš„æ¯”ç‰¹ã€‚æµ‹äº†ä¸€ä¸‹ï¼Œåº”è¯¥å¤Ÿç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">s=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(gift)):<br>    s+=(gift[i]&gt;=<span class="hljs-number">0x40000000</span>)<br>s<br><span class="hljs-comment">#794</span><br><span class="hljs-comment">#794*36=28584</span><br></code></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯ç”¨ä¸Šé¢çš„å¥—è·¯è§£é¢˜äº†ã€‚ã€‚ã€‚ ï¼ˆ$\mathsf{9min,9GB}$ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python">gift=<br>c=<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>n=<span class="hljs-number">50000</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    <span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†æ ¹æ®é¢˜ç›®å®é™…ç¼–å†™ï¼Œå¿…é¡»å’Œé¢˜ç›®å®é™…æ¯”ç‰¹è·å–é¡ºåºå’Œæ–¹å¼å®Œå…¨ä¸€è‡´ï¼Œä¸”ç¡®ä¿æ¯”ç‰¹æ•°å¤§äº19937ï¼Œå¹¶ä¸”è¯·æ³¨æ„zfillã€‚</span><br>    row=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        a=rng.getrandbits(<span class="hljs-number">5</span>)<br>        b=rng.getrandbits(<span class="hljs-number">31</span>)<br>        <span class="hljs-keyword">if</span>(gift[i]&amp;<span class="hljs-number">0x40000000</span>):<br>            row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(<span class="hljs-number">31</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">5</span>))))<br>            row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(b)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">31</span>))))<br>    <span class="hljs-keyword">return</span> row<br>M=[]<br>rng=random.Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†ä¸ºå›ºå®šå¥—è·¯</span><br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <span class="hljs-comment">#è¿™ä¸ªsetstateä¹Ÿæ˜¯å›ºå®šæ ¼å¼ï¼Œå·²äº2025.1.21æµ‹è¯•</span><br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br>y=[]<br>tot=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    <span class="hljs-keyword">if</span>(gift[i]&amp;<span class="hljs-number">0x40000000</span>):<br>        y+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(<span class="hljs-number">31</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">5</span>))))<br>        y+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(gift[i])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">31</span>))))<br>        tot+=<span class="hljs-number">1</span><br>y=vector(GF(<span class="hljs-number">2</span>),y)<br>s=M.solve_left(y)<br><span class="hljs-comment">#print(s)</span><br>G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    C=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        C&lt;&lt;=<span class="hljs-number">1</span><br>        C|=<span class="hljs-built_in">int</span>(s[<span class="hljs-number">32</span>*i+j])<br>    G.append(C)<br><span class="hljs-keyword">import</span> random<br>RNG1 = random.Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50000</span>):<br>    RNG1.getrandbits(<span class="hljs-number">5</span>)<br>    RNG1.getrandbits(<span class="hljs-number">31</span>)<br>K=RNG1.getrandbits(<span class="hljs-number">500</span>)<br>C=bytes_to_long(c)<br><span class="hljs-built_in">print</span>(long_to_bytes(C^^K))<br><span class="hljs-comment">#b&#x27;NSSCTF&#123;Bec4us3_0f_LinearXD!!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="6-å¼ºç½‘æ‹Ÿæ€2024-notiv"><a href="#6-å¼ºç½‘æ‹Ÿæ€2024-notiv" class="headerlink" title="6.[å¼ºç½‘æ‹Ÿæ€2024]notiv"></a>6.[å¼ºç½‘æ‹Ÿæ€2024]notiv</h2><p>ç„ä¸€çœ¼é¢˜ç›®ï¼ˆæ³¨ï¼šé¢˜ç›®<strong>éæ ¸å¿ƒéƒ¨åˆ†</strong>ä¸åŸé¢˜ç•¥æœ‰æ”¹åŠ¨ï¼Œæ¯”å¦‚å–æ¶ˆäº†proof_of_workï¼Œå¹¶æ”¹äº†ä¸€ä¸‹flagçš„å½¢å¼ï¼Œä½†ä¸å½±å“é¢˜ç›®åŸæœ¬éš¾åº¦å’Œè§£é¢˜åšæ³•ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># !/usr/bin/env python</span><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> mypad <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;&gt; &#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">close</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.request.close()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            signal.alarm(<span class="hljs-number">120</span>)<br>            count = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):<br>                seed(os.urandom(<span class="hljs-number">8</span>))<br>                key = pad_x923(<span class="hljs-string">b&quot;&quot;</span>)<br>                <span class="hljs-built_in">print</span>(key.<span class="hljs-built_in">hex</span>())<br>                chal = <span class="hljs-built_in">hex</span>(getrandbits(<span class="hljs-number">64</span>*<span class="hljs-number">3</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">16</span>*<span class="hljs-number">3</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(datetime.now()),chal)<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">200</span>):<br>                    iv = long_to_bytes(getrandbits(<span class="hljs-number">128</span>)).rjust(<span class="hljs-number">16</span>, <span class="hljs-string">b&quot;\00&quot;</span>)<br>                    cipher = AES.new(key, AES.MODE_CBC, iv)<br>                    test = <span class="hljs-variable language_">self</span>.recv(<span class="hljs-string">b&quot;:&gt; &quot;</span>).decode()<br>                    tb = <span class="hljs-built_in">bytes</span>.fromhex(test)<br>                    ret = cipher.encrypt(pad_x923(tb))<br>                    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(ret) &gt; <span class="hljs-number">16</span>:<br>                        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;forbid&quot;</span>)<br>                        <span class="hljs-keyword">continue</span><br>                    <span class="hljs-variable language_">self</span>.send((iv+ret).<span class="hljs-built_in">hex</span>().encode())<br><br>                s = <span class="hljs-variable language_">self</span>.recv(<span class="hljs-string">b&quot;&gt;&gt; &quot;</span>).decode()<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;s=&#x27;</span>,s)<br>                iv = <span class="hljs-built_in">bytes</span>.fromhex(s[:<span class="hljs-number">32</span>])<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;iv=&#x27;</span>,iv)<br>                ans = <span class="hljs-built_in">bytes</span>.fromhex(s[<span class="hljs-number">32</span>:])<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ans=&#x27;</span>,ans)<br>                cipher = AES.new(key, AES.MODE_CBC, iv)<br>                att = cipher.decrypt(ans)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;attpad=&#x27;</span>,att)<br>                att = unpad_x923(att)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;att=&#x27;</span>,att,<span class="hljs-string">&#x27;chalEncode=&#x27;</span>,chal.encode())<br>                <span class="hljs-keyword">if</span> att == chal.encode():<br>                    count += <span class="hljs-number">1</span><br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;you got %d score&quot;</span> % count)<br>            <span class="hljs-keyword">if</span> count &gt;= <span class="hljs-number">20</span>:<br>                FLAG=<span class="hljs-string">&quot;flag&#123;Success at &quot;</span>+<span class="hljs-built_in">str</span>(datetime.now())+<span class="hljs-string">&quot;&#125;&quot;</span><br>                FLAG=FLAG.replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;-&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;cong!your flag is &quot;</span>+FLAG.encode())<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;sorry,plz try again&quot;</span>)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;something wrong! plz try again!&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.close()<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">60717</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;running on <span class="hljs-subst">&#123;HOST&#125;</span>:<span class="hljs-subst">&#123;PORT&#125;</span>&#x27;</span>)<br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br><br></code></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Random <span class="hljs-keyword">import</span> get_random_bytes<br><br>pad_x923=<span class="hljs-keyword">lambda</span> x,block_size=<span class="hljs-number">16</span>:x+get_random_bytes((block_size-(<span class="hljs-built_in">len</span>(x)%block_size)-<span class="hljs-number">1</span>))+<span class="hljs-built_in">bytes</span>([(block_size-<span class="hljs-built_in">len</span>(x)%block_size)])<br>unpad_x923=<span class="hljs-keyword">lambda</span> x,block_size=<span class="hljs-number">16</span>:x[:-((x[-<span class="hljs-number">1</span>]-<span class="hljs-number">1</span>)%block_size)-<span class="hljs-number">1</span>]<br><br></code></pre></td></tr></table></figure><p>æ³¨ï¼š<code>get_random_bytyes</code> è°ƒç”¨çš„æ˜¯ <code>os.urandom</code>ï¼Œä¸å¯é¢„æµ‹ã€‚</p><p>é¢˜ç›®æ‹¿åˆ°ç¬¬ä¸€çœ¼ï¼š<code>getrandbits(128)</code>ï¼Œè¿™å¦¥å¦¥çš„MTéšæœºæ•°é¢„æµ‹ï¼Œ200æ¬¡æœºä¼šï¼Œè¯´æ˜156æ¬¡å°±å¯ä»¥é¢„æµ‹åé¢çš„éšæœºæ•°äº†ã€‚ç„¶åå‘ç°ï¼Œé¢˜ç›®è¦æ±‚æ˜¯æ„é€ ä¸€ä¸ªç»™å®šçš„ 48 å­—èŠ‚çš„ä¸²çš„å¯†æ–‡ï¼ˆè¿™ä¸ªå¯ä»¥æ±‚å‡ºæ¥ï¼Œå› ä¸ºè¿™ä¸ªä¸²æ˜¯ <code>getrandbits(64*3)</code> ç”Ÿæˆçš„ï¼Œå‰å‘åæ¨ä¸€æ¬¡å°±è¡Œï¼‰ã€‚</p><p>ä½†åœ¨é¢˜ç›®ä¸­ï¼Œæ¯æ¬¡åªèƒ½å¯¹è‡³å¤š 15 å­—èŠ‚å†…å®¹è¿›è¡ŒåŠ å¯†ï¼Œä¸”åŠ å¯†å¡«å……æ–¹å¼ä¸ºï¼šå¡«å…… $n-1$ ä¸ªéšæœºå­—ç¬¦ï¼Œç„¶åå†æ”¾å…¥ 1 å­—èŠ‚å¡«å……é•¿åº¦æ¥ä¿è¯åˆ†ç»„ã€‚å½“æ˜æ–‡é•¿åº¦ä¸º 48  æ—¶ï¼Œæ„å‘³ç€å¯†æ–‡é•¿åº¦ä¸º 64ï¼ˆå› ä¸ºè¦å¡«å……ä¸€æ•´ç»„ï¼‰ã€‚ä¸”é¢˜ç›®ä½¿ç”¨äº† CBC æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯å‰ä¸€ç»„å¯†æ–‡å’Œåä¸€ç»„æ˜æ–‡å¼‚æˆ–åæ‰æ˜¯çœŸæ­£çš„åŠ å¯†å†…å®¹ï¼Œå³ï¼š$IV&#x3D;C_0$ï¼Œ$C_i&#x3D;E(C_{i-1}\oplus M_i),i&#x3D;1,2,3,4$ã€‚</p><p>ç»è¿‡åˆ†æåï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´åœ°å¾—åˆ°è¿™äº›äº‹å®ï¼š</p><blockquote><ol><li>ç”±äºå¡«å……çš„éšæœºæ€§ï¼Œå› æ­¤ï¼Œ<strong>å¿…é¡»æ„é€  15 å­—èŠ‚çš„å¯†æ–‡</strong>ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯ å¡«å……åå­—ç¬¦ä¸²çš„ç¡®å®šæ€§ï¼ˆåªä¼šå¡«å……ä¸€ä¸ª<code>\x01</code>ï¼‰</li><li>ä½¿ç”¨çš„IVæ˜¯å¯ä»¥é¢„æµ‹çš„ï¼Œå¯ä»¥ä»è¿™ä¸ªåœ°æ–¹å‡ºå‘è€ƒè™‘ã€‚</li><li>æ„é€ å¯†æ–‡æ—¶ï¼ŒIVæ˜¯å¯æŒ‡å®šçš„ï¼Œå› æ­¤ $C_1$ å¯ä»¥ç›´æ¥æ„é€ ã€‚åŒæ—¶ï¼Œå¯¹ $C_4$ çš„è¦æ±‚æ˜¯ï¼šä¿è¯æœ€åå››ä¸ªæ¯”ç‰¹ä¸º $0$ å°±è¡Œï¼Œå¯¹åº” $1&#x2F;16$ çš„æ¦‚ç‡ã€‚</li><li>å› æ­¤æœ¬é¢˜é‡ç‚¹æ˜¯ä¸»è¦è€ƒè™‘ $C_2$ å’Œ $C_3$ï¼Œä¸”è¦ä¿è¯èƒ½è¾¾åˆ°çº¦ 40 percent çš„æ„é€ æˆåŠŸç‡ã€‚</li></ol></blockquote><p>è®¾ $\mathrm{chal}&#x3D;H_1,H_2,H_3,H_4$ï¼Œå…¶ä¸­å¯ä»¥å‡è®¾ $H_4$ ä¸ºå…¨é›¶ï¼ˆæ ¹æ®ç¬¬ä¸‰æ¡ååŠéƒ¨åˆ†ï¼‰ã€‚è€ƒè™‘ç›´æ¥æ„é€ ï¼šç”±äº $C_2&#x3D;E_K(H_2\oplus C_1)$ã€‚è€Œåœ¨ä¹‹å‰é€‰æ‹©æ˜æ–‡çš„è¿‡ç¨‹ä¸­ï¼š$C_2&#x3D;E_K(M_2\oplus IV_2)$ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æ„é€ å‡ºæ¥çš„ $M_2$ åº”è¯¥ä¸º $M_2&#x3D;IV_2\oplus C_1\oplus H_2$ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä¿è¯ $M_2$ çš„æœ€åä¸€å­—èŠ‚çš„åå…­è¿›åˆ¶ä¸º $\mathtt{01H}$ï¼Œè¿™ä¸ªæ¦‚ç‡ä¸º $1&#x2F;256$ã€‚</p><p>è€ŒåŒç†ï¼Œ$M_3$ ä¹Ÿæ˜¯ $1&#x2F;256$ çš„æ¦‚ç‡æ„é€ ã€‚é‚£è¿™æ ·æˆåŠŸç‡ç®—ä¸‹æ¥å°±æ˜¯ $1&#x2F;65536$ï¼Œæ•…æœŸæœ›å¾—åˆ†ä¸ºï¼š<br>$$<br>E(\mathrm{Point})&#x3D;\frac{50\times200}{65536}&#x3D;0.1526<br>$$<br>ä¹Ÿå°±æ˜¯å¹³å‡å°è¯•å…­æ¬¡ï¼Œæ‰åªèƒ½å¾— $1$ åˆ†ã€‚</p><p>å€Ÿé‰´çš„MaPlå¤§å“¥çš„EXPï¼Œå…¶ä¸­ï¼Œmttoolè§æœ¬äººåšå®¢ä¸­2021å¹´7æœˆçš„Explore MT19937æ–‡ç« ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> mttool <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># è®°å½•æ‰€æœ‰AESåŠ è§£å¯†å¯¹</span><br>AES_P, AES_C = [], []<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">turn</span>(<span class="hljs-params">sh, data: <span class="hljs-built_in">bytes</span></span>):<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(data) == <span class="hljs-number">15</span><br>sh.recvuntil(<span class="hljs-string">b&#x27;:&gt; &#x27;</span>)<br>sh.sendline(data.<span class="hljs-built_in">hex</span>().encode())<br>ret = sh.recvline().decode().strip()<br>iv = <span class="hljs-built_in">bytes</span>.fromhex(ret[:<span class="hljs-number">32</span>])<br>ciph = <span class="hljs-built_in">bytes</span>.fromhex(ret[<span class="hljs-number">32</span>:])<br>AES_P.append(xor(data + <span class="hljs-string">b&quot;\1&quot;</span>, iv))<br>AES_C.append(ciph)<br><span class="hljs-keyword">return</span> iv, ciph<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getrandbits</span>(<span class="hljs-params">F, bits</span>):<br><span class="hljs-keyword">assert</span> bits % <span class="hljs-number">8</span> == <span class="hljs-number">0</span><br>state = [F.getstate() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//<span class="hljs-number">32</span>)][::-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">return</span> <span class="hljs-string">b&quot;&quot;</span>.join(w.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;big&quot;</span>) <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> state)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">skip_state</span>(<span class="hljs-params">F, state_count</span>):<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(state_count):<br>F.getstate()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(a[i] ^ b[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">min</span>(<span class="hljs-built_in">len</span>(a), <span class="hljs-built_in">len</span>(b))))<br><br>sh = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">60717</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):<br>AES_P, AES_C = [], []<br><span class="hljs-comment"># æ¢å¤éšæœºæ•°çŠ¶æ€</span><br>D = []<br>F = MT19937()<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>//<span class="hljs-number">4</span>):<br>my_plain = <span class="hljs-string">b&quot;0&quot;</span>*<span class="hljs-number">15</span> + <span class="hljs-string">b&quot;\x01&quot;</span><br>iv, ciph = turn(sh, my_plain[:<span class="hljs-number">15</span>])<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> [<span class="hljs-number">12</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>]:<br>D.append(<span class="hljs-built_in">int</span>.from_bytes(iv[j:j+<span class="hljs-number">4</span>], <span class="hljs-string">&#x27;big&#x27;</span>))<br>F.setstate(D)<br>F.invtwist()<br>F.invtwist()<br><br><span class="hljs-comment"># å¾—åˆ° chal</span><br>skip_state(F, <span class="hljs-number">624</span>-<span class="hljs-number">6</span>)<br>chal = getrandbits(F, <span class="hljs-number">24</span>*<span class="hljs-number">8</span>).<span class="hljs-built_in">hex</span>().encode()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;chal: <span class="hljs-subst">&#123;chal&#125;</span>&quot;</span>)<br>P1 = chal[:<span class="hljs-number">16</span>]<br>P2 = chal[<span class="hljs-number">16</span>:<span class="hljs-number">32</span>]<br>P3 = chal[<span class="hljs-number">32</span>:]<br><br><span class="hljs-comment"># å°†éšæœºæ•°ç½®ä¸ºå½“å‰çŠ¶æ€</span><br>skip_state(F, <span class="hljs-number">624</span>)<br><br><span class="hljs-comment"># æœç´¢åŠ è§£å¯†å¯¹ï¼Œæ„é€ C2</span><br>times = <span class="hljs-number">200</span> - <span class="hljs-number">624</span>//<span class="hljs-number">4</span><br>solve = []<br>next_iv = getrandbits(F, <span class="hljs-number">128</span>)<br><br><span class="hljs-keyword">while</span> times &gt; <span class="hljs-number">2</span>:<br><span class="hljs-keyword">for</span> P, C <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(AES_P, AES_C):<br><span class="hljs-keyword">if</span> (C[-<span class="hljs-number">1</span>] ^ P2[-<span class="hljs-number">1</span>] ^ next_iv[-<span class="hljs-number">1</span>]) == <span class="hljs-number">1</span>:<br>payload = xor(P2, next_iv)<br>payload = xor(C, payload)<br><span class="hljs-keyword">assert</span> payload[-<span class="hljs-number">1</span>] == <span class="hljs-number">1</span><br>iv, ciph = turn(sh, payload[:<span class="hljs-number">15</span>])<br><span class="hljs-keyword">assert</span> iv == next_iv<br>next_iv = getrandbits(F, <span class="hljs-number">128</span>)<br>IV, C1, C2 = xor(P, P1), C, ciph<br><span class="hljs-keyword">if</span> (C2[-<span class="hljs-number">1</span>] ^ P3[-<span class="hljs-number">1</span>] ^ next_iv[-<span class="hljs-number">1</span>]) == <span class="hljs-number">1</span>: <span class="hljs-comment"># ä»å·²æœ‰ç»“æœæ„é€  C3 (ä½æ¦‚ç‡)</span><br>payload = xor(P3, next_iv)<br>payload = xor(C2, payload)<br>iv, ciph = turn(sh, payload[:<span class="hljs-number">15</span>])<br><span class="hljs-keyword">assert</span> iv == next_iv<br>next_iv = getrandbits(F, <span class="hljs-number">128</span>)<br>times -= <span class="hljs-number">1</span><br>C3 = ciph<br><span class="hljs-keyword">for</span> P, C <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(AES_P, AES_C): <span class="hljs-comment"># ç­›é€‰å‡ºæœ€åä¸€ç»„å¡«å……</span><br><span class="hljs-keyword">if</span> (P[-<span class="hljs-number">1</span>] ^ C3[-<span class="hljs-number">1</span>]) % <span class="hljs-number">16</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> (C[-<span class="hljs-number">1</span>] ^ next_iv[-<span class="hljs-number">1</span>]) == <span class="hljs-number">1</span>:<br>C4 = Cs<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] get solve:&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\tIV: <span class="hljs-subst">&#123;IV.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\tC1: <span class="hljs-subst">&#123;C1.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\tC2: <span class="hljs-subst">&#123;C2.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\tC3: <span class="hljs-subst">&#123;C3.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\tC4: <span class="hljs-subst">&#123;C4.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br>solve.append((IV, C1, C2, C3, C4))<br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>turn(sh, <span class="hljs-string">b&quot;0&quot;</span>*<span class="hljs-number">15</span>)<br>next_iv = getrandbits(F, <span class="hljs-number">128</span>)<br>times -= <span class="hljs-number">1</span><br><br><span class="hljs-comment"># context.log_level = &quot;debug&quot; </span><br><span class="hljs-keyword">while</span> times:<br>turn(sh, <span class="hljs-string">b&quot;0&quot;</span>*<span class="hljs-number">15</span>)<br>times -= <span class="hljs-number">1</span><br><br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&gt; &#x27;</span>)<br><span class="hljs-keyword">if</span> solve:<br>sh.sendline(<span class="hljs-string">b&quot;&quot;</span>.join(solve[<span class="hljs-number">0</span>]).<span class="hljs-built_in">hex</span>().encode())<br><span class="hljs-keyword">else</span>:<br>sh.send(<span class="hljs-string">b&quot;00&quot;</span>*<span class="hljs-number">32</span>)<br><span class="hljs-built_in">print</span>(sh.readline())<br></code></pre></td></tr></table></figure><p>å› ä¸ºè¿™ä¸ªç®—æ³•åªæ±‚ä¸€ä¸ª $C_2$ï¼Œç„¶åå¯¹è¿™ä¸ª $C_2$ æ ¹æ®å½“å‰çš„IVå»æ±‚ $C_3$ï¼Œè¿™æ ·æ¥çš„è¯æ¦‚ç‡å½“ç„¶ä¼šå¾ˆä½äº†ã€‚çœ‹äº†wpä¹‹åå‘ç°ï¼Œ wpçš„æ€è·¯æ˜¯å­˜å‚¨æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ $C_2$ åŠå…¶å¯¹åº”çš„ $C_1,IV$ï¼Œç„¶åå¯¹æ¯ä¸ª $C_2$ å»ç”¨å½“å‰IVçŒœ $C_3$ã€‚ç”±äºä¸€å¼€å§‹ $C_2$ çš„æ•°é‡å°‘ï¼Œå› æ­¤å¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ $C_3$ï¼Œåˆ™å†è·å–ä¸€ç»„å¯è¡Œçš„ $C_2$ ã€‚ </p><p>æµ‹äº†ä¸€ä¸‹ï¼Œä¸€æ¬¡è¿è¡Œå¤§æ¦‚å¯ä»¥è·å– $19$ ä¸ª $C_2$ï¼Œå°è¯•æ¬¡æ•°ä¸º $19\times9&#x3D;171$ æ¬¡ã€‚è·å–å¯è¡Œçš„ $C_3$ çš„æ¦‚ç‡ä¸º $1&#x2F;256$ï¼Œå› æ­¤å½“è·å¾— $19$ ä¸ªå¯è¡Œçš„ $C_2$ åï¼Œå°±æœ‰å¾ˆå¤§çš„æ¦‚ç‡è·å–ä¸€ä¸ª $C_3$ã€‚</p><p>è‡³äºå½“å‰IVï¼ŸIVæ˜¯åœ¨è·å– $156$ ç»„æ•°æ®ä¹‹åå°±å¯ä»¥é¢„æµ‹å‡ºæ¥ï¼Œå› æ­¤å¯ä»¥å…ˆè¿›è¡Œæµ‹è¯•ï¼Œå¦‚æœæ²¡æœ‰ $C_2$ æˆ–è€…æ ¹æ®å½“å‰çš„ $C_2$ æ‰¾ä¸åˆ°å¯è¡Œçš„ $C_3$ï¼Œå°±å¯ä»¥å†æ‰¾ä¸€ç»„ $C_2$ã€‚å†æœ¬åœ°è¿›è¡Œæšä¸¾ï¼Œæ‰¾ä¸åˆ°åˆé€‚çš„å°±ä¸äº¤ï¼Œä¸ä¼šæµªè´¹æŸ¥è¯¢æ¬¡æ•°ã€‚</p><p>è‡³äº $C_4$ ï¼Œå¯ä»¥è®¤ä¸º $H_4$ ä¸ºå…¨ $0$ï¼Œå› æ­¤ $C_4$ å¯ä»¥æ ¹æ® $C_3$ æ„é€ å‡ºæ¥ï¼Œæ¦‚ç‡ä¸º $1&#x2F;16$ã€‚</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> mttool <span class="hljs-keyword">import</span> *<br><br>sh=remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">60717</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sendMyMsg</span>(<span class="hljs-params">msg</span>):<br>msghex=msg.<span class="hljs-built_in">hex</span>()<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(msghex),msghex)<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&gt; &#x27;</span>)<br>sh.sendline(msghex.encode())<br>recvline=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>recvline=recvline.strip()<br><span class="hljs-built_in">print</span>(recvline)<br><span class="hljs-keyword">assert</span>(<span class="hljs-built_in">len</span>(recvline)==<span class="hljs-number">64</span>)<br>iv,ciph=recvline[:<span class="hljs-number">32</span>],recvline[<span class="hljs-number">32</span>:]<br>iv,ciph=<span class="hljs-built_in">int</span>(iv,<span class="hljs-number">16</span>),<span class="hljs-built_in">int</span>(ciph,<span class="hljs-number">16</span>)<br>plain=iv^ciph<br>state4=[]<br>iv00=iv<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>state4.append(iv&amp;<span class="hljs-number">0xffffffff</span>)<br>iv&gt;&gt;=<span class="hljs-number">32</span><br><span class="hljs-keyword">return</span> plain,ciph,state4,iv00<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>)):<br>V,M,C,D=[],[],[],[]<span class="hljs-comment">#IV,realencmsg,cipher,32bitdata(iv)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">156</span>): <span class="hljs-comment">#è·å–156ç»„æ•°æ®ï¼Œ624ä¸ªstateé¢„æµ‹åç»­æ•°å€¼</span><br>recvline=sendMyMsg(<span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>]*<span class="hljs-number">15</span>))<br>M.append(recvline[<span class="hljs-number">0</span>])<br>C.append(recvline[<span class="hljs-number">1</span>])<br>D=D+recvline[<span class="hljs-number">2</span>]<br>V.append(recvline[<span class="hljs-number">3</span>])<br>F=MT19937()<br>F.setstate(D)<br>F.invtwist()<br>F.invtwist()<br>Ha=[F.getstate() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>)]<br>Ha=Ha[-<span class="hljs-number">6</span>:]<br>H=<span class="hljs-built_in">sum</span>([Ha[i]&lt;&lt;(<span class="hljs-number">32</span>*i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>)]) <span class="hljs-comment">#è·å–chal</span><br>H=(<span class="hljs-built_in">hex</span>(H)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">48</span>))<br><span class="hljs-built_in">print</span>(H)<br>H1,H2,H3=[bytes_to_long(H[<span class="hljs-number">16</span>*i:<span class="hljs-number">16</span>*i+<span class="hljs-number">16</span>].encode()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>F.setstate(D)<br>Fv=[<span class="hljs-built_in">sum</span>([F.getstate()&lt;&lt;(<span class="hljs-number">32</span>*_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]) <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>)] <span class="hljs-comment">#è·å–åç»­IV</span><br>V=V+Fv<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(V)==<span class="hljs-number">200</span><br>C0,C1,C2,C3,C4=<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span> <span class="hljs-comment">#C0å°±æ˜¯IV</span><br>possC2=[]<br>possC1ind=[]<br>T=<span class="hljs-number">156</span><br><span class="hljs-keyword">while</span>(T&lt;<span class="hljs-number">200</span>):<br><span class="hljs-built_in">print</span>(possC2)<br>ivT=V[T]<br>foundC3=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(possC2)):<span class="hljs-comment">#æ ¹æ®å·²æœ‰çš„ C2 å»æ‰¾ C3,å¦‚æœæ‰¾åˆ°äº†ï¼Œå°±ç»“æŸè¿™ä¸€éƒ¨åˆ†äº†</span><br>X=ivT^possC2[i]^H3<br><span class="hljs-keyword">if</span>(X%<span class="hljs-number">256</span>==<span class="hljs-number">1</span>): <span class="hljs-comment">#åªæœ‰æ„é€ å‡ºæ¥çš„Xæ»¡è¶³æœ«å­—èŠ‚æ˜¯01æ‰å¯ä»¥</span><br>msgX=(<span class="hljs-built_in">hex</span>(X)[<span class="hljs-number">2</span>:]).zfill(<span class="hljs-number">32</span>)<br>msgX=(<span class="hljs-built_in">hex</span>(X)[<span class="hljs-number">2</span>:]).zfill(<span class="hljs-number">32</span>)<br>msgX=<span class="hljs-built_in">bytes</span>.fromhex(msgX) <span class="hljs-comment">#å¦‚æœæ˜æ–‡Xç¬¦åˆæ¡ä»¶ï¼Œå°±æ‰¾å‘è¿‡å»ï¼Œè·å–è¿™ç»„C3å¹¶å‡†å¤‡ç»“æŸ</span><br><span class="hljs-built_in">print</span>(msgX)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;C3&#x27;</span>)<br>recvline=sendMyMsg(msgX[:-<span class="hljs-number">1</span>])<br>T+=<span class="hljs-number">1</span><br>C3=recvline[<span class="hljs-number">1</span>]<br>C2=possC2[i]<br>C1=C[possC1ind[i]]<br>C0=V[possC1ind[i]]^H1^<span class="hljs-number">1</span><br>foundC3=<span class="hljs-number">1</span><br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">if</span>(foundC3): <span class="hljs-comment">#æ‰¾åˆ°C3ç«‹åˆ»é€€å‡ºè¿™ä¸ªå¾ªç¯</span><br><span class="hljs-keyword">break</span><br>        <span class="hljs-comment">#å¦‚æœæ²¡æœ‰æ‰¾åˆ°C3ï¼Œé‚£å°±å¯»æ‰¾å¯¹åº”çš„ C2</span><br>foundC2=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(C)):<br>X=ivT^C[i]^H2 <span class="hljs-comment">#é€šè¿‡æ‰€æœ‰çš„C[i]ï¼Œæ„é€ å¯èƒ½çš„C2ï¼Œè¿™è¾¹çš„C[i]ä¼šè¢«ç”¨ä½œC1ï¼Œå› ä¸ºC1æ„é€ å¾ˆç®€å•ã€‚</span><br><span class="hljs-keyword">if</span>(X%<span class="hljs-number">256</span>==<span class="hljs-number">1</span>):<br>msgX=(<span class="hljs-built_in">hex</span>(X)[<span class="hljs-number">2</span>:]).zfill(<span class="hljs-number">32</span>)<br>msgX=<span class="hljs-built_in">bytes</span>.fromhex(msgX)<br><span class="hljs-built_in">print</span>(msgX)<br>recvline=sendMyMsg(msgX[:-<span class="hljs-number">1</span>]) <span class="hljs-comment">#å¦‚æœæ˜æ–‡Xç¬¦åˆæ¡ä»¶ï¼Œå°±æ‰¾å‘è¿‡å»ï¼Œè·å–è¿™ç»„C2</span><br>T+=<span class="hljs-number">1</span><br>possC2.append(recvline[<span class="hljs-number">1</span>])<br>C.append(recvline[<span class="hljs-number">1</span>])<br>possC1ind.append(i)<br>foundC2=<span class="hljs-number">1</span><br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">if</span>(foundC2): <span class="hljs-comment">#æ‰¾åˆ°C2å°±çœ‹ä¸‹ä¸€ç»„æ•°æ®</span><br><span class="hljs-keyword">continue</span><br><span class="hljs-keyword">else</span>:<br>recvline=sendMyMsg(<span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>]*<span class="hljs-number">15</span>)) <span class="hljs-comment">#æ‰¾ä¸åˆ°C2ï¼Œå°±å†å‘ä¸€ç»„00000...001è¿‡å»å‡‘æ•°</span><br>T+=<span class="hljs-number">1</span><br>M.append(recvline[<span class="hljs-number">0</span>])<br>C.append(recvline[<span class="hljs-number">1</span>])<br><span class="hljs-keyword">if</span>(C0*C1*C2*C3):<span class="hljs-comment">#å¦‚æœC0,C1,C2,C3éƒ½æ‰¾åˆ°äº†ï¼Œå°±é€šè¿‡H4(H4=0) å»æ„é€ C4</span><br><span class="hljs-keyword">while</span>(T&lt;<span class="hljs-number">200</span>):<br>X=V[T]^C3^<span class="hljs-number">0</span> <span class="hljs-comment">#è¿™ä¸ªå¼‚æˆ–H4=0å¯ä»¥ä¸å†™ï¼Œä½†ä¸ºäº†æ˜æ˜¾èµ·è§ï¼Œè¿˜æ˜¯å†™å‡ºæ¥</span><br><span class="hljs-keyword">if</span>(X%<span class="hljs-number">16</span>==<span class="hljs-number">1</span>):<br>X^=(X&amp;<span class="hljs-number">0xf0</span>)<br>msgX=<span class="hljs-string">&#x27;&#123;:032X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(X)<br>msgX=<span class="hljs-built_in">bytes</span>.fromhex(msgX)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(msgX)==<span class="hljs-number">16</span><br>recvline=sendMyMsg(msgX[:-<span class="hljs-number">1</span>])<br>C4=recvline[<span class="hljs-number">1</span>]<br>T+=<span class="hljs-number">1</span><br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>T+=<span class="hljs-number">1</span><br>recvline=sendMyMsg(msgX[:-<span class="hljs-number">1</span>])<br>M.append(recvline[<span class="hljs-number">0</span>])<br>C.append(recvline[<span class="hljs-number">1</span>])<br><span class="hljs-keyword">while</span>(T&lt;<span class="hljs-number">200</span>):<br>T+=<span class="hljs-number">1</span><br>recvline=sendMyMsg(msgX[:-<span class="hljs-number">1</span>])<br>M.append(recvline[<span class="hljs-number">0</span>])<br>C.append(recvline[<span class="hljs-number">1</span>])<br>s=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [C0,C1,C2,C3,C4]:<br>s+=<span class="hljs-string">&#x27;&#123;:032X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i)<br><span class="hljs-built_in">print</span>(s)<br>sh.sendline(s.encode())<br><span class="hljs-keyword">else</span>:<span class="hljs-comment">#å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼Œä¹Ÿè¦æŠŠæ¬¡æ•°ç”¨å®Œï¼Œç„¶åå‘ä¸€ç»„å…¨0è·³æ‰è¿™ç»„æ•°æ®ã€‚</span><br><span class="hljs-keyword">while</span>(T&lt;<span class="hljs-number">200</span>):<br>T+=<span class="hljs-number">1</span><br>recvline=sendMyMsg(msgX[:-<span class="hljs-number">1</span>])<br>M.append(recvline[<span class="hljs-number">0</span>])<br>C.append(recvline[<span class="hljs-number">1</span>])<br>sh.sendline(<span class="hljs-built_in">bytes</span>([<span class="hljs-number">48</span>]*<span class="hljs-number">96</span>))<br>sh.interactive()<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼Œæœ€åè¿è¡Œæ—¶é—´ä¸º $41$ ç§’ï¼Œç¬¦åˆé¢˜ç›®ä¸¤åˆ†é’Ÿçš„é™æ—¶ã€‚</p><p><img src="/2025/03/21/25Mar1-MTArchive/4.png" alt="4"></p><h2 id="7-å¼ºç½‘æ¯2024-ECRandom-Game"><a href="#7-å¼ºç½‘æ¯2024-ECRandom-Game" class="headerlink" title="7.[å¼ºç½‘æ¯2024]ECRandom_Game"></a>7.[å¼ºç½‘æ¯2024]ECRandom_Game</h2><h3 id="7x01-é¢˜ç›®ä»£ç "><a href="#7x01-é¢˜ç›®ä»£ç " class="headerlink" title="7x01 é¢˜ç›®ä»£ç "></a>7x01 é¢˜ç›®ä»£ç </h3><p>æ—¢ç„¶çœ‹äº†è¿™ä¹ˆå¤šäº†ï¼Œé‚£å°±æ¥ä¸ªå¤§çš„ï¼è¿™é¢˜ç›®å¯çœŸTMé•¿ã€‚ã€‚ã€‚å½“æ—¶ç›´æ¥æ”¾å¼ƒäº†ã€‚ã€‚ã€‚ç»“æœç°åœ¨å›æ¥çœ‹ï¼Œå› ä¸ºåˆ·äº†CryptoHackå’Œç³»ç»Ÿåœ°é‡æ–°æ•´ç†äº†ä¸€ä¸‹MTçš„çŸ¥è¯†ï¼Œå½“ç„¶æ›´é‡è¦åœ°æ˜¯æœ‰äº†WPï¼Œæ„Ÿè§‰ã€‚å¥½åƒä¹Ÿå°±é‚£æ ·ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> M, q, a, b, select<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> ecdsa<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad, unpad<br><span class="hljs-keyword">from</span> ecdsa.ellipticcurve <span class="hljs-keyword">import</span> CurveFp,Point<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> ceil<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><br>flag = <span class="hljs-string">b&#x27;qwb&#123;kLeMjJw_HBPtoHsVhnnxZdvtGjomivNDUI_vMRhZHrfKlCZ6HlGAeXRV_gQ8i117nGhzEMr0Zk_YTl1wftSskpX4JLnryE9Mhl96cPTWorGCl_R6nD33bcx1AYflag_leak&#125;&#x27;</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">136</span><br><br>BANNER = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"> GGGGG   OOOOO   DDDDD   DDDDD    GGGGG    AAA    MM    MM EEEEEEE </span><br><span class="hljs-string">GG      OO   OO  DD   D  DD   D  GG       AAAAA   MMM  MMM EE      </span><br><span class="hljs-string">GG  GGG OO   OO  DD   D  DD   D  GG  GGG  A   A   MM MM MM EEEEE   </span><br><span class="hljs-string">GG   GG OO   OO  DD   D  DD   D  GG   GG  AAAAA   MM    MM EE      </span><br><span class="hljs-string">GGGGGGG  OOOOO   DDDDD   DDDDD   GGGGGGG  A   A   MM    MM EEEEEEE </span><br><span class="hljs-string"> &#x27;&#x27;&#x27;</span><br><br>NNN = []<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">die</span>(<span class="hljs-params">*args</span>):<br>    pr(*args)<br>    quit()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>(<span class="hljs-params">*args</span>):<br>    s = <span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, args))<br>    sys.stdout.write(s + <span class="hljs-string">&quot;\n&quot;</span>)<br>    sys.stdout.flush()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sc</span>():<br>    <span class="hljs-keyword">return</span> sys.stdin.buffer.readline()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Rng</span>(<span class="hljs-params">k</span>):<br>    ran = random.getrandbits(k)<br>    NNN.append(ran)<br>    <span class="hljs-keyword">return</span> ran<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ADD</span>(<span class="hljs-params">num</span>):<br>    NUM = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num):<br>        NUM += Rng(<span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">return</span> NUM<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">secure_choice</span>(<span class="hljs-params">sequence</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> sequence:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    randbelow = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i, x <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(sequence):<br>        randbelow += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> os.urandom(<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>] &lt; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>) * randbelow // <span class="hljs-built_in">len</span>(sequence):<br>            <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xDBLADD</span>(<span class="hljs-params">P, Q, PQ, q, a, b</span>):<br>    (X1, Z1), (X2, Z2), (X3, Z3) = PQ, P, Q<br>    X4 = (X2**<span class="hljs-number">2</span> - a * Z2**<span class="hljs-number">2</span>) ** <span class="hljs-number">2</span> - <span class="hljs-number">8</span> * b * X2 * Z2**<span class="hljs-number">3</span><br>    Z4 = <span class="hljs-number">4</span> * (X2 * Z2 * (X2**<span class="hljs-number">2</span> + a * Z2**<span class="hljs-number">2</span>) + b * Z2**<span class="hljs-number">4</span>)<br>    X5 = Z1 * ((X2 * X3 - a * Z2 * Z3) ** <span class="hljs-number">2</span> - <span class="hljs-number">4</span> * b * Z2 * Z3 * (X2 * Z3 + X3 * Z2))<br>    Z5 = X1 * (X2 * Z3 - X3 * Z2) ** <span class="hljs-number">2</span><br>    X4, Z4, X5, Z5 = (c % q <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> (X4, Z4, X5, Z5))<br>    <span class="hljs-keyword">return</span> (X4, Z4), (X5, Z5)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xMUL</span>(<span class="hljs-params">P, k, q, a, b</span>):<br>    Q, R = (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), P<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(k.bit_length() + <span class="hljs-number">1</span>)):<br>        <span class="hljs-keyword">if</span> k &gt;&gt; i &amp; <span class="hljs-number">1</span>:<br>            R, Q = Q, R<br>        Q, R = xDBLADD(Q, R, P, q, a, b)<br>        <span class="hljs-keyword">if</span> k &gt;&gt; i &amp; <span class="hljs-number">1</span>:<br>            R, Q = Q, R<br>    <span class="hljs-keyword">return</span> Q<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shout</span>(<span class="hljs-params">x, d, q, a, b</span>):<br>    P = (x,<span class="hljs-number">1</span>)<br>    Q = xMUL(P, d, q, a, b)<br>    <span class="hljs-keyword">return</span> Q[<span class="hljs-number">0</span>] * <span class="hljs-built_in">pow</span>(Q[<span class="hljs-number">1</span>], -<span class="hljs-number">1</span>, q) % q<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_random_string</span>(<span class="hljs-params">length</span>):<br>    characters = string.ascii_letters + string.digits<br>    random_string = <span class="hljs-string">&#x27;&#x27;</span>.join(secure_choice(characters) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length))<br>    <span class="hljs-keyword">return</span> random_string<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ECCDu</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,curve,G</span>):<br>        <span class="hljs-variable language_">self</span>.state = getRandomNBitInteger(<span class="hljs-number">512</span>)<br>        <span class="hljs-variable language_">self</span>.Curve = curve<br>        <span class="hljs-variable language_">self</span>.g = G<br><br>        <span class="hljs-variable language_">self</span>.num = Rng(<span class="hljs-number">32</span>)<br>        d = <span class="hljs-number">65537</span><br>        <span class="hljs-variable language_">self</span>.Q = <span class="hljs-variable language_">self</span>.num*<span class="hljs-variable language_">self</span>.g<br>        <span class="hljs-variable language_">self</span>.P = d * <span class="hljs-variable language_">self</span>.Q<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">ingetkey</span>(<span class="hljs-params">self</span>):<br>        t = <span class="hljs-built_in">int</span>((<span class="hljs-variable language_">self</span>.state * <span class="hljs-variable language_">self</span>.Q).x())<br>        <span class="hljs-variable language_">self</span>.updade()<br>        <span class="hljs-keyword">return</span> t%(<span class="hljs-number">2</span>**<span class="hljs-number">250</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">updade</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.state = <span class="hljs-built_in">int</span>((<span class="hljs-variable language_">self</span>.state * <span class="hljs-variable language_">self</span>.P).x())<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Random_key</span>(<span class="hljs-params">self, n:<span class="hljs-built_in">int</span></span>):<br>        out = <span class="hljs-number">0</span><br>        number = ceil(n/<span class="hljs-number">250</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(number):<br>            out = (out&lt;&lt;<span class="hljs-number">250</span>) + <span class="hljs-variable language_">self</span>.ingetkey()<br>        <span class="hljs-keyword">return</span> out % (<span class="hljs-number">2</span>**n)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>():<br>    random.seed(os.urandom(<span class="hljs-number">8</span>))<br>    proof = <span class="hljs-string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters + string.digits) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)])<br>    _hexdigest = sha256(proof.encode()).hexdigest()<br>    pr(<span class="hljs-string">f&quot;sha256(XXXX+<span class="hljs-subst">&#123;proof[<span class="hljs-number">4</span>:]&#125;</span>) == <span class="hljs-subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())<br>    pr(<span class="hljs-string">&#x27;Give me XXXX: &#x27;</span>)<br>    x = sc().rstrip(<span class="hljs-string">b&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(x) != <span class="hljs-number">4</span> <span class="hljs-keyword">or</span> sha256(x + proof[<span class="hljs-number">4</span>:].encode()).hexdigest() != _hexdigest:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    pr(BANNER)<br>    pr(<span class="hljs-string">&#x27;WELCOME TO THIS SIMPLE GAME!!!&#x27;</span>)<br>    ASSERT = <span class="hljs-number">1</span><span class="hljs-comment">#( proof_of_work() ) #Simplified for local test.</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ASSERT:<br>        die(<span class="hljs-string">&quot;Not right proof of work&quot;</span>)<br><br>    pr(<span class="hljs-string">&#x27;Now we will start our formal GAME!!!&#x27;</span>)<br>    pr(<span class="hljs-string">&#x27;===== First 1ğŸ’ª: =====&#x27;</span>)<br>    pr(<span class="hljs-string">&#x27;Enter an integer as the parameter p for Curve: y^2 = x^3+12x+17 (mod p) and 250&lt;p.bit_length()&#x27;</span>)<br>    p1 = <span class="hljs-built_in">int</span>(sc())<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-number">250</span>&lt;=p1.bit_length():<br>        die(<span class="hljs-string">&#x27;Wrong length!&#x27;</span>)<br>    curve = CurveFp(p1, <span class="hljs-number">12</span>, <span class="hljs-number">17</span>,<span class="hljs-number">1</span>)<br>    pr(curve)<br>    pr(<span class="hljs-string">&#x27;Please Enter a random_point G:&#x27;</span>)<br>    G_t = sc().split(<span class="hljs-string">b&#x27; &#x27;</span>)<br>    Gx,Gy = <span class="hljs-built_in">int</span>(G_t[<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(G_t[<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> curve.contains_point(Gx,Gy):<br>        die(<span class="hljs-string">&#x27;This point is outside the curve&#x27;</span>)<br>    G = Point(curve,Gx,Gy)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">500</span>):<br>        ECDU = ECCDu(curve,G)<br>        m  = <span class="hljs-string">&#x27;My secret is a random saying of phrase,As below :&#x27;</span> + generate_random_string(<span class="hljs-number">119</span>)<br>        Number = ECDU.Random_key(<span class="hljs-number">1344</span>)<br>        c = Number^bytes_to_long(m.encode())<br>        pr(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br>        pr(<span class="hljs-string">f&#x27;P = <span class="hljs-subst">&#123;<span class="hljs-built_in">int</span>(ECDU.P.x()), <span class="hljs-built_in">int</span>(ECDU.P.y())&#125;</span>&#x27;</span>)<br>        pr(<span class="hljs-string">f&#x27;Q = <span class="hljs-subst">&#123;<span class="hljs-built_in">int</span>(ECDU.Q.x()), <span class="hljs-built_in">int</span>(ECDU.Q.y())&#125;</span>&#x27;</span>)<br><br>        pr(<span class="hljs-string">&#x27;Enter m:&#x27;</span>)<br>        m_en = sc().rstrip(<span class="hljs-string">b&#x27;\n&#x27;</span>)<br>        <span class="hljs-keyword">if</span> m_en != m.encode():<br>            die(<span class="hljs-string">&#x27;This is not the right m,Please try again&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            pr(<span class="hljs-string">&#x27;Right m!!!&#x27;</span>)<br>    pr(<span class="hljs-string">&#x27;Bingo!&#x27;</span>)<br>    new_state,new_state1 = ADD(<span class="hljs-number">136</span>),ADD(<span class="hljs-number">50</span>)<br>    <br>    random.seed(new_state)<br><br>    pr(<span class="hljs-string">&#x27;===== Second 2ğŸ’ª: =====&#x27;</span>)<br>    curve1 = CurveFp(q,a,b,<span class="hljs-number">1</span>)<br>    pr(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;<span class="hljs-built_in">int</span>(curve1.p()),<span class="hljs-built_in">int</span>(curve1.a()),<span class="hljs-built_in">int</span>(curve1.b())&#125;</span>&#x27;</span>)<br><br>    pr(<span class="hljs-string">&quot;Enter a number that does not exceed 1500&quot;</span>)<br>    number = <span class="hljs-built_in">int</span>(sc())<br><br>    pr(<span class="hljs-string">f&#x27;You only have <span class="hljs-subst">&#123;number&#125;</span> chances to try&#x27;</span>)<br>    success = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(number):<br>        Gx = secure_choice(select)<br>        R = Rng(<span class="hljs-number">25</span>)<br>        pr(<span class="hljs-string">&#x27;Gx = &#x27;</span>,Gx)<br>        pr(<span class="hljs-string">&#x27;Px = &#x27;</span>,shout(Gx, R, q, a, b))<br>        R_n = <span class="hljs-built_in">int</span>(sc().rstrip(<span class="hljs-string">b&#x27;\n&#x27;</span>))<br>        <span class="hljs-keyword">if</span> R_n != R:<br>            pr(<span class="hljs-string">f&#x27;Wrong number!!!,Here is your right number <span class="hljs-subst">&#123;R&#125;</span>&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            pr(<span class="hljs-string">&#x27;GGood!&#x27;</span>)<br>            success += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(success)/<span class="hljs-built_in">int</span>(number) &lt;= <span class="hljs-number">0.262</span>:<br>        die(<span class="hljs-string">&#x27;Please Try more...&#x27;</span>)<br><br>    random.seed(new_state)<br>    iv_num = ADD(<span class="hljs-number">2000</span>)<br><br>    iv = hashlib.sha256(<span class="hljs-built_in">str</span>(iv_num).encode()).digest()[:<span class="hljs-number">16</span>]<br>    key = hashlib.sha256(<span class="hljs-built_in">str</span>(new_state1).encode()).digest()[:<span class="hljs-number">16</span>]<br>    Aes = AES.new(key,AES.MODE_CBC, iv)<br>    C = Aes.encrypt(pad(flag,<span class="hljs-number">16</span>))<br><br>    key_n, iv_n = <span class="hljs-built_in">int</span>(sc()), <span class="hljs-built_in">int</span>(sc())<br>    iv1 = hashlib.sha256(<span class="hljs-built_in">str</span>(iv_n).encode()).digest()[:<span class="hljs-number">16</span>]<br>    key1 = hashlib.sha256(<span class="hljs-built_in">str</span>(key_n).encode()).digest()[:<span class="hljs-number">16</span>]<br>    Aes_verify = AES.new(key1,AES.MODE_CBC, iv1)<br>    C_verify = unpad(Aes_verify.decrypt(C),<span class="hljs-number">16</span>)<br><br>    <span class="hljs-keyword">if</span> C_verify == flag:<br>        pr(<span class="hljs-string">&#x27;CongratulationsğŸ‡ğŸ‡ğŸ‡!!!!&#x27;</span>)<br>        pr(<span class="hljs-string">&#x27;Here is your flagğŸ˜Šï¼š&#x27;</span>, M)<br>    <span class="hljs-keyword">else</span>:<br>        pr(<span class="hljs-string">&#x27;Maybe you could get the right flag!&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure><p>å¤§è‡´çœ‹äº†ä¸€ä¸‹ï¼Œé¢˜ç›®è²Œä¼¼åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œé‚£å°±ä¸€ä¸ªä¸€ä¸ªçœ‹ï¼</p><h3 id="7x02-Part-1"><a href="#7x02-Part-1" class="headerlink" title="7x02 Part 1"></a>7x02 Part 1</h3><p>å…ˆçœ‹çœ‹ç¬¬ä¸€éƒ¨åˆ†ï¼šè¿™ä¸€éƒ¨åˆ†é¦–å…ˆè¦ä½ è¾“å…¥ä¸€ä¸ªè¶…è¿‡ $250$ ä½çš„ç´ æ•° $p$ ï¼Œç”¨äºé¡¶iæœ‰æ¤­åœ†æ›²çº¿ $y^2&#x3D;x^3+12x+17$ã€‚ç„¶åè®©ä½ ç»™å‡ºæ›²çº¿ä¸Šé¢çš„ä¸€ä¸ªç‚¹ $G$ å¹¶å¸¦æœ‰åˆ¤æ–­ $G$ æ˜¯å¦åœ¨çº¿ä¸Šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python">pr(<span class="hljs-string">&#x27;Now we will start our formal GAME!!!&#x27;</span>)<br>pr(<span class="hljs-string">&#x27;===== First 1ğŸ’ª: =====&#x27;</span>)<br>pr(<span class="hljs-string">&#x27;Enter an integer as the parameter p for Curve: y^2 = x^3+12x+17 (mod p) and 250&lt;p.bit_length()&#x27;</span>)<br>p1 = <span class="hljs-built_in">int</span>(sc())<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-number">250</span>&lt;=p1.bit_length():<br>    die(<span class="hljs-string">&#x27;Wrong length!&#x27;</span>)<br>curve = CurveFp(p1, <span class="hljs-number">12</span>, <span class="hljs-number">17</span>,<span class="hljs-number">1</span>)<br>pr(curve)<br>pr(<span class="hljs-string">&#x27;Please Enter a random_point G:&#x27;</span>)<br>G_t = sc().split(<span class="hljs-string">b&#x27; &#x27;</span>)<br>Gx,Gy = <span class="hljs-built_in">int</span>(G_t[<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(G_t[<span class="hljs-number">1</span>])<br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> curve.contains_point(Gx,Gy):<br>    die(<span class="hljs-string">&#x27;This point is outside the curve&#x27;</span>)<br>G = Point(curve,Gx,Gy)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">500</span>):<br>    ECDU = ECCDu(curve,G)<br>    m  = <span class="hljs-string">&#x27;My secret is a random saying of phrase,As below :&#x27;</span> + generate_random_string(<span class="hljs-number">119</span>)<br>    Number = ECDU.Random_key(<span class="hljs-number">1344</span>)<br>    c = Number^bytes_to_long(m.encode())<br>    pr(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br>    pr(<span class="hljs-string">f&#x27;P = <span class="hljs-subst">&#123;<span class="hljs-built_in">int</span>(ECDU.P.x()), <span class="hljs-built_in">int</span>(ECDU.P.y())&#125;</span>&#x27;</span>)<br>    pr(<span class="hljs-string">f&#x27;Q = <span class="hljs-subst">&#123;<span class="hljs-built_in">int</span>(ECDU.Q.x()), <span class="hljs-built_in">int</span>(ECDU.Q.y())&#125;</span>&#x27;</span>)<br><br>    pr(<span class="hljs-string">&#x27;Enter m:&#x27;</span>)<br>    m_en = sc().rstrip(<span class="hljs-string">b&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">if</span> m_en != m.encode():<br>        die(<span class="hljs-string">&#x27;This is not the right m,Please try again&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        pr(<span class="hljs-string">&#x27;Right m!!!&#x27;</span>)<br>pr(<span class="hljs-string">&#x27;Bingo!&#x27;</span>)<br>new_state,new_state1 = ADD(<span class="hljs-number">136</span>),ADD(<span class="hljs-number">50</span>)<br><br>random.seed(new_state)<br></code></pre></td></tr></table></figure><p>ç„¶åéœ€è¦è¿›è¡Œ $500$ è½®ï¼šæ¯ä¸€è½®ç»™å‡ºä¸€ä¸ª $c$ï¼Œ ç„¶å $Q&#x3D;r_{32}G$ï¼Œ$P&#x3D;65537Q$ã€‚å¹¶ä¸”ç»è¿‡æµ‹è¯•ï¼Œ <code>secure_choice</code>ã€<code>generate_random_string</code> å’Œ <code>getRandomNBitInteger</code> éƒ½ä¸ä¼šæ”¹å˜ <code>getrandbits</code> çš„å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">secure_choice</span>(<span class="hljs-params">sequence</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> sequence:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    randbelow = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i, x <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(sequence):<br>        randbelow += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> os.urandom(<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>] &lt; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>) * randbelow // <span class="hljs-built_in">len</span>(sequence):<br>            <span class="hljs-keyword">return</span> x<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_random_string</span>(<span class="hljs-params">length</span>):<br>    characters = string.ascii_letters + string.digits<br>    random_string = <span class="hljs-string">&#x27;&#x27;</span>.join(secure_choice(characters) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length))<br>    <span class="hljs-keyword">return</span> random_string<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä»–è¿™ä¸ª ECCDU çš„ç”Ÿæˆæ–¹å¼éå¸¸è¯¡å¼‚ï¼Œæ„Ÿè§‰è¿™ä¸ªä¼¼ä¹ä¸æ˜¯å¾ˆå¥½é¢„æµ‹ã€‚ä½†ä¸ºå•¥ä»–è¿™ä¸ªæ˜¯ $P&#x3D;dQ&#x3D;65537Q$ å‘¢ï¼Œè¿™ä¹ˆæ˜æ˜¾çš„ $P,Q$ å…³ç³»æœ‰å•¥æ„ä¹‰å—ï¼Ÿç›²çŒœè¿™ä¸ª $d$ å¤§æ¦‚ç‡æ˜¯æŸä¸ªç§é’¥è¢«æ³„éœ²äº†ã€‚</p><p>æŸ¥äº†ä¸€ä¸‹ï¼Œè¿™ç©æ„è™½ç„¶ä¸æ˜¯ç§é’¥æ³„éœ²ï¼Œä½†å±äºåé—¨ä¸€ç±»çš„ä¸œè¥¿ã€‚ECCDU å®é™…ä¸Šæ˜¯ DUAL ECC éšæœºæ•°ç”Ÿæˆå™¨ã€‚å½“çŸ¥é“äº† $P,Q$ ä¹‹é—´çš„ç¦»æ•£å¯¹æ•°å…³ç³»ä¹‹åï¼Œåªéœ€è¦å¾ˆç®€å•çš„æ“ä½œå°±å¯ä»¥æ¢å¤å¯†é’¥ï¼šåœ¨è¿™ä¸ªé¢˜ç›®ä¸­æ˜¯è¿™æ ·çš„ï¼š</p><blockquote><p>1.è®¾ç½®åˆå§‹çŠ¶æ€ $s_0$ã€‚<br>2.è®¡ç®— $t&#x3D;(s_0Q)_x$<br>3.è®¡ç®— $s_1&#x3D;(s_0P)_x$<br>4.è¿”å› $t \mod 2^{250}$ çš„å€¼</p></blockquote><p>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“äº†ç¬¬ä¸€æ¬¡è¾“å‡ºçš„å†…å®¹ã€‚é‚£å°±å¯ä»¥æ±‚å‡º $t\mod 2^{250}$ çš„å€¼ã€‚å¹¶ä¸”å¦‚æœä¸¢æ‰çš„ä½æ•°å°‘çš„è¯ï¼Œ$t$ çš„å®é™…å€¼æ˜¯å¯ä»¥æšä¸¾çš„ã€‚å‡å¦‚æˆ‘ä»¬æšä¸¾åˆ°äº†æ­£ç¡®çš„ $t$ã€‚é‚£ä¹ˆæœ‰ï¼š<code>E.lift_x(t)</code> å¯æ‰§è¡Œï¼Œé‚£æˆ‘ä»¬å°±å¾—åˆ°äº† $s_0Q$ æ¨ªåæ ‡çš„çœŸå®å€¼ã€‚åˆå› ä¸ºæˆ‘ä»¬çŸ¥é“ $P&#x3D;dQ$é‚£ä¹ˆ $s_1$ å°±å¯ä»¥é€šè¿‡ä¸‹é¢çš„å¼å­å¾—åˆ°ï¼Œå…¶æˆªæ–­å€¼å°±æ˜¯ $t_1$ çš„å€¼ã€‚<br>$$<br>s_1&#x3D;(s_0P)_x&#x3D;(s_0dP)_x<br>$$</p><p>ç„¶è€Œï¼Œåœ¨åŸé¢˜ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°çš„æ¯”ç‰¹æ˜¯æ•°æ˜¯ $1344$ï¼ˆä¹Ÿå°±æ˜¯ $168$å­—èŠ‚ï¼‰ï¼Œå·²çŸ¥çš„é•¿åº¦ä¸º $49$ å­—èŠ‚ï¼ŒæœªçŸ¥çš„é•¿åº¦ä¸º $119$ å­—èŠ‚ã€‚é‚£ä¹ˆåˆ’åˆ†ä¸€ä¸‹ï¼š$6$ ä¸ªéšæœºæ•°ä¸­ï¼Œ $t_0,t_1,t_2$ æˆ‘ä»¬åˆ†åˆ«çŸ¥é“ $94,250,48$ ä½ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ $t_1$ çš„å®Œæ•´å€¼ï¼Œæšä¸¾ $s_1$ï¼Œè¿›è€Œç»“åˆ $t_2$ çš„é«˜ä½æ‹¿åˆ° $t_2$ çš„å®Œæ•´å€¼ï¼Œé‚£ä¹ˆåé¢çš„æ•°å€¼ä¹Ÿå°±éƒ½èƒ½æ±‚å‡ºæ¥äº†ï¼ˆå½“ç„¶æˆ‘ä¸ºäº†ä¿é™©ï¼Œåªåˆ¤æ–­é«˜ $46$ ä½ï¼‰ã€‚ã€‚</p><p>ä¸‹é¢å°±æ˜¯æ‰¾ä¸€ä¸ªç´ æ•° $p$ ä½¿å¾— $y^2&#x3D;x^3+12x+17$ ä¸Šæœ‰å…‰æ»‘ç‚¹äº†ã€‚è¿™é‡Œè‡ªå·±æ‰¾äº†ä¸‹ï¼Œå¯ä»¥é€‰ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">10966580842619877820066146550592605243948059864235950049184301493326519904217</span><br>n=<span class="hljs-number">10966580842619877820066146550592605243884930330463142198655617377280752484140</span> <br>order = <span class="hljs-number">2</span>**<span class="hljs-number">2</span> Â· <span class="hljs-number">5</span> Â· <span class="hljs-number">7</span> Â· <span class="hljs-number">31</span> Â· <span class="hljs-number">103</span> Â· <span class="hljs-number">127</span> Â· <span class="hljs-number">65537</span><br><span class="hljs-comment">#65537 * 5 * 103 * 127</span><br></code></pre></td></tr></table></figure><p> é‚£ä¹ˆç¬¬ä¸€éƒ¨åˆ†çš„solution å°±è¿™ä¹ˆå®Œæˆäº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">10966580842619877820066146550592605243948059864235950049184301493326519904217</span><br>n=<span class="hljs-number">10966580842619877820066146550592605243884930330463142198655617377280752484140</span><br>order=<span class="hljs-number">65537</span> * <span class="hljs-number">127</span> * <span class="hljs-number">103</span> * <span class="hljs-number">5</span><br>E=EllipticCurve(GF(p),[<span class="hljs-number">12</span>,<span class="hljs-number">17</span>])<br>Gx=<span class="hljs-number">9902877122724401288649251020980593854891741191216834612223927570106136389588</span><br>Gy=<span class="hljs-number">5145046550562502488367834786527673957133862042253512817925201451928791986047</span><br>G=E(Gx,Gy)<br><span class="hljs-keyword">assert</span> n%order==<span class="hljs-number">0</span><br>sh.sendline(<span class="hljs-built_in">str</span>(p).encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;Gx&#125;</span> <span class="hljs-subst">&#123;Gy&#125;</span>&#x27;</span>.encode())<br><br>msg=<span class="hljs-string">b&#x27;My secret is a random saying of phrase,As below :&#x27;</span><br>vmsg=bytes_to_long(msg)&lt;&lt;<span class="hljs-number">952</span><br><br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>R32s=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">500</span>)):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;c =&#x27;</span>)<br>    c=<span class="hljs-built_in">eval</span>(sh.recvline())<br>    sh.recvuntil(<span class="hljs-string">b&#x27;P =&#x27;</span>)<br>    P=<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;E &#x27;</span>+sh.recvline().strip().decode())<br>    sh.recvuntil(<span class="hljs-string">b&#x27;Q =&#x27;</span>)<br>    Q=<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;E&#x27;</span>+sh.recvline().strip().decode())<br>    R32s.append(discrete_log(Q,G,operation=<span class="hljs-string">&#x27;+&#x27;</span>))<br>    ctmp=c^vmsg<br>    tarr=[<span class="hljs-number">0</span>]*<span class="hljs-number">6</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>        tarr[<span class="hljs-number">5</span>-i]=ctmp%(<span class="hljs-number">2</span>**<span class="hljs-number">250</span>)<br>        ctmp&gt;&gt;=<span class="hljs-number">250</span><br>    tarr[<span class="hljs-number">3</span>]=tarr[<span class="hljs-number">4</span>]=tarr[<span class="hljs-number">5</span>]=<span class="hljs-number">0</span><br>    tarr[<span class="hljs-number">2</span>]=tarr[<span class="hljs-number">2</span>]&gt;&gt;(<span class="hljs-number">204</span>)&lt;&lt;(<span class="hljs-number">204</span>)<br>    <span class="hljs-comment"># print(tarr)</span><br>    <span class="hljs-comment"># print(R32)</span><br>    <span class="hljs-comment"># print(c)</span><br>    <span class="hljs-comment"># print(P)</span><br>    <span class="hljs-comment"># print(Q)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        <span class="hljs-keyword">try</span>:<br>            s1=Integer((i&lt;&lt;<span class="hljs-number">250</span>)|tarr[<span class="hljs-number">1</span>])<br>            sQ=E.lift_x(s1)<br>            s2=Integer((<span class="hljs-number">65537</span>*sQ)[<span class="hljs-number">0</span>])<br>            t2all=Integer((s2*Q)[<span class="hljs-number">0</span>])<br>            t2=t2all%(<span class="hljs-number">2</span>**<span class="hljs-number">250</span>)<br>            <span class="hljs-keyword">if</span>(((t2&gt;&gt;<span class="hljs-number">204</span>)&lt;&lt;<span class="hljs-number">204</span>)==tarr[<span class="hljs-number">2</span>]):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;found:&#x27;</span>,i)<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;not found&#x27;</span>)<br>    <span class="hljs-comment"># sh.interactive()</span><br>    s0=s2<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]:<br>        ti=(s0*Q)[<span class="hljs-number">0</span>]<br>        s0=Integer((s0*P)[<span class="hljs-number">0</span>])<br>        tarr[i]=Integer(ti)%<span class="hljs-number">2</span>**<span class="hljs-number">250</span><br>    <span class="hljs-comment"># print(tarr)</span><br>    t1344=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>        t1344&lt;&lt;=<span class="hljs-number">250</span><br>        t1344|=tarr[i]<br>    msgans=(long_to_bytes(c^t1344))<br>    sh.sendline(msgans)<br><span class="hljs-built_in">print</span>(R32s)<br></code></pre></td></tr></table></figure><p>åœ¨ç¬¬ä¸€éƒ¨åˆ†ç»“æŸåï¼Œç³»ç»Ÿä¼šè®¾ç½® <code>new_state</code> å’Œ <code>new_state1</code>ã€‚åˆ†åˆ«æ˜¯ $136$ ä¸ª <code>getrandbits(32)</code> å’Œ $50$ ä¸ª <code>getrandbits(32)</code> çš„ç»“æœã€‚å¦‚æœå›é¡¾MT19937çš„æºç çš„è¯ï¼Œå¯ä»¥å‘ç°æ¯ä¸ªçŠ¶æ€ $r_{i+624}$ åªå’Œ $r_{i},r_{i+1},r_{i+397}$ ä¸‰ä¸ªæ•°å­—æœ‰å…³ã€‚ è™½ç„¶æˆ‘ä»¬åªæœ‰ $500$ ä¸ªçŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯ $r_{0\sim499}$ï¼Œå¹¶ä¸” $r_{500\sim623}$ æ˜¯æœªçŸ¥çš„ï¼Œè€Œ $r_{624\sim 726}$ æˆ‘ä»¬æ˜¯å¯ä»¥çŸ¥é“çš„ï¼Œå› ä¸ºè¿™ä¸€éƒ¨åˆ†åªå’Œ $r_{0\sim499}$ æœ‰å…³ã€‚ è¿™é‡Œ <code>new_state</code> ä¸ $r_{500\sim 635}$ æœ‰å…³ï¼Œè€Œ <code>new_state1</code> ä¸ $r_{636\sim685}$ æœ‰å…³ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ° <code>new_state1</code>ï¼Œä¹Ÿå°±æ˜¯æœ€åçš„è§£å¯†å¯†é’¥ã€‚</p><h3 id="7x03-Part-2"><a href="#7x03-Part-2" class="headerlink" title="7x03 Part 2"></a>7x03 Part 2</h3><p>å‡è®¾æˆ‘ä»¬å·²ç»è·å¾—äº† <code>new_state1</code>ï¼Œä¸‹é¢æ¥çœ‹çœ‹ç¬¬äºŒéƒ¨åˆ†ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">pr(<span class="hljs-string">&#x27;===== Second 2ğŸ’ª: =====&#x27;</span>)<br>curve1 = CurveFp(q,a,b,<span class="hljs-number">1</span>)<br>pr(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;<span class="hljs-built_in">int</span>(curve1.p()),<span class="hljs-built_in">int</span>(curve1.a()),<span class="hljs-built_in">int</span>(curve1.b())&#125;</span>&#x27;</span>)<br><br>pr(<span class="hljs-string">&quot;Enter a number that does not exceed 1500&quot;</span>)<br>number = <span class="hljs-built_in">int</span>(sc())<br><br>pr(<span class="hljs-string">f&#x27;You only have <span class="hljs-subst">&#123;number&#125;</span> chances to try&#x27;</span>)<br>success = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(number):<br>    Gx = secure_choice(select)<br>    R = Rng(<span class="hljs-number">25</span>)<br>    pr(<span class="hljs-string">&#x27;Gx = &#x27;</span>,Gx)<br>    pr(<span class="hljs-string">&#x27;Px = &#x27;</span>,shout(Gx, R, q, a, b))<br>    R_n = <span class="hljs-built_in">int</span>(sc().rstrip(<span class="hljs-string">b&#x27;\n&#x27;</span>))<br>    <span class="hljs-keyword">if</span> R_n != R:<br>        pr(<span class="hljs-string">f&#x27;Wrong number!!!,Here is your right number <span class="hljs-subst">&#123;R&#125;</span>&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        pr(<span class="hljs-string">&#x27;GGood!&#x27;</span>)<br>        success += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(success)/<span class="hljs-built_in">int</span>(number) &lt;= <span class="hljs-number">0.262</span>:<br>    die(<span class="hljs-string">&#x27;Please Try more...&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒè½®ä¸€å¼€å§‹ä¼šç»™ä½  $q,a,b$ ä¸‰ä¸ªå€¼ï¼Œå…¶ä¸­ $q$ æ˜¯ $64$ ä½ç´ æ•°ï¼Œä½ æœ‰è‡³å¤š $1500$ æ¬¡æœºä¼šï¼Œå¦‚æœåšè¿‡CryptoHackå¯ä»¥çŸ¥é“ï¼Œè¿™è¾¹çš„ <code>shout</code> æ˜¯æ ¹æ®ç‚¹ $P$ çš„æ¨ªåæ ‡æ±‚å‡º $dP$ çš„æ¨ªåæ ‡ã€‚ç”±äºè¿™è¾¹çš„ $d$ æ˜¯ <code>getrandbits(25)</code> äº§ç”Ÿçš„ï¼Œä¸” $q$ æ¯”è¾ƒå°ï¼Œå› æ­¤æ±‚ECDLPæ˜¯ç›¸å¯¹å®¹æ˜“çš„ã€‚å¦‚æœä¸æ”¾å¿ƒå¤æ‚åº¦ï¼Œå¯ä»¥è‡ªå·±å†™ä¸ªBSGSï¼Œè®¡ç®—é‡ä¹Ÿå°± $13$ ä½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">xDBLADD</span>(<span class="hljs-params">P, Q, PQ, q, a, b</span>):<br>    (X1, Z1), (X2, Z2), (X3, Z3) = PQ, P, Q<br>    X4 = (X2**<span class="hljs-number">2</span> - a * Z2**<span class="hljs-number">2</span>) ** <span class="hljs-number">2</span> - <span class="hljs-number">8</span> * b * X2 * Z2**<span class="hljs-number">3</span><br>    Z4 = <span class="hljs-number">4</span> * (X2 * Z2 * (X2**<span class="hljs-number">2</span> + a * Z2**<span class="hljs-number">2</span>) + b * Z2**<span class="hljs-number">4</span>)<br>    X5 = Z1 * ((X2 * X3 - a * Z2 * Z3) ** <span class="hljs-number">2</span> - <span class="hljs-number">4</span> * b * Z2 * Z3 * (X2 * Z3 + X3 * Z2))<br>    Z5 = X1 * (X2 * Z3 - X3 * Z2) ** <span class="hljs-number">2</span><br>    X4, Z4, X5, Z5 = (c % q <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> (X4, Z4, X5, Z5))<br>    <span class="hljs-keyword">return</span> (X4, Z4), (X5, Z5)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xMUL</span>(<span class="hljs-params">P, k, q, a, b</span>):<br>    Q, R = (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), P<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(k.bit_length() + <span class="hljs-number">1</span>)):<br>        <span class="hljs-keyword">if</span> k &gt;&gt; i &amp; <span class="hljs-number">1</span>:<br>            R, Q = Q, R<br>        Q, R = xDBLADD(Q, R, P, q, a, b)<br>        <span class="hljs-keyword">if</span> k &gt;&gt; i &amp; <span class="hljs-number">1</span>:<br>            R, Q = Q, R<br>    <span class="hljs-keyword">return</span> Q<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shout</span>(<span class="hljs-params">x, d, q, a, b</span>):<br>    P = (x,<span class="hljs-number">1</span>)<br>    Q = xMUL(P, d, q, a, b)<br>    <span class="hljs-keyword">return</span> Q[<span class="hljs-number">0</span>] * <span class="hljs-built_in">pow</span>(Q[<span class="hljs-number">1</span>], -<span class="hljs-number">1</span>, q) % q<br></code></pre></td></tr></table></figure><p>è®¡ç®—å¾—åˆ°ï¼š$\dfrac{624\times32}{25}&#x3D;798.72$ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åªéœ€è¦ $799$ ç»„éšæœºæ•°ï¼Œå°±å¯ä»¥é¢„æµ‹åé¢çš„æ•°å€¼äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬åé¢å¯ä»¥æœ‰ $700$ ç»„æ­£ç¡®é¢„æµ‹ï¼Œæ­£ç¡®æ¦‚ç‡ä¹Ÿè¾¾åˆ°äº† $0.4669$ï¼Œè¿œå¤§äº $0.262$ï¼Œå› æ­¤è¿™ä¸€éƒ¨åˆ†ä¹Ÿå°±è¿™ä¹ˆè¿‡äº†ã€‚</p><p>ä½†è¿™æ ·è¿˜æ˜¯ä¼šæœ‰é—®é¢˜ï¼šè¿™æ ·æ„é€ å‡ºçš„çŸ©é˜µå°ºå¯¸ä¸º $19968\times19975$ï¼Œä½†å…¶ç§©åªæœ‰ $16808$ï¼Œå› ä¸ºè¿™é‡Œé¢å¾ˆå¤šæ¯”ç‰¹æ˜¯çº¿æ€§ç›¸å…³çš„ã€‚ç»è¿‡æµ‹è¯•ï¼Œè²Œä¼¼åˆ° $1250$ ç»„çš„æ—¶å€™ï¼ŒçŸ©é˜µçš„ç§©æ‰è¾¾åˆ° $19937$ï¼Œé¢„æµ‹æ‰èƒ½å¤Ÿç™¾åˆ†ç™¾æˆåŠŸã€‚</p><p>å› æ­¤ï¼Œå¯ä»¥é€‰æ‹©å‘é€ $1266$ ç»„æ•°æ®ï¼Œå‰ $342$ ï¼ˆ$1266\times0.27&#x3D;341.82$ï¼‰ç»„æ­£å¸¸BSGSï¼ˆå¤§çº¦ååˆ†é’Ÿï¼‰ï¼Œåé¢ççŒœï¼Œè¿™æ ·ä¹Ÿèƒ½å¤Ÿæ»¡è¶³æˆåŠŸç‡çš„è¦æ±‚ã€‚ã€‚</p><p>è¿™è¾¹è¿˜æœ‰ä¸ªå¾ˆå‘çš„ç‚¹ï¼šé¢˜ç›®ä¸­ $q,a,b&#x3D;18446744073709550537,12,19$ ä¸ºå›ºå®šå€¼ã€‚ä½†ç»™çš„ $x$ åæ ‡ä¸ä¸€å®šåœ¨åŸæ›²çº¿ä¸Šï¼Œå› æ­¤éœ€è¦åœ¨ $\mathbb F_{q^2}$ ä¸Šå®šä¹‰æ›²çº¿ï¼Œæ¨¡æ•° $q$ çš„äºŒæ¬¡éå‰©ä½™ä¸º $-3$ã€‚</p><p>é‚£ä¹ˆè¿™ä¸€éƒ¨åˆ†å°±è¿™ä¹ˆä¸‹æ¥äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python">sh.recvuntil(<span class="hljs-string">b&#x27;(&#x27;</span>)<br>q,a,b=<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;(&#x27;</span>+sh.recvline().decode())<br><span class="hljs-built_in">print</span>(q,a,b)<br>sh.recvline()<br><br>nSample=<span class="hljs-number">1266</span><br>sh.sendline(<span class="hljs-built_in">str</span>(nSample).encode())<br>sh.recvline()<br><span class="hljs-keyword">import</span> mttools<br>F=mttools.MT19937()<br>F.setstate(R32s[:<span class="hljs-number">500</span>]+[<span class="hljs-number">0</span>]*<span class="hljs-number">124</span>)<br>newstate1=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>):<br>    F.getstate()<br>newstate1=<span class="hljs-built_in">sum</span>([F.getstate() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>)])<br><br><span class="hljs-comment"># with open(&#x27;debugclient&#x27;,&#x27;w&#x27;) as fffp:</span><br><span class="hljs-comment">#     fffp.write(str(newstate1)+&#x27;\n&#x27;)</span><br><span class="hljs-comment">#     fffp.write(str(R32s))</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ecBSGS</span>(<span class="hljs-params">G,H</span>):<br>    D=<span class="hljs-built_in">dict</span>()<br>    P=E(<span class="hljs-number">0</span>)<br>    G2=G*<span class="hljs-number">5793</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5793</span>):<br>        D[P]=i<br>        P+=G2<br>    Htmp=H<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5793</span>):<br>        u=D.get(Htmp,<span class="hljs-literal">None</span>)<br>        <span class="hljs-keyword">if</span>(u):<br>            <span class="hljs-keyword">return</span> u*<span class="hljs-number">5793</span>+i<br>        Htmp-=G<br>    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><br>Fq2=GF((q,<span class="hljs-number">2</span>),name=<span class="hljs-string">&#x27;sq3i&#x27;</span>,modulus=[<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(GF(q*q),[a,b])<br>D=[]<br>realSample=<span class="hljs-built_in">int</span>(<span class="hljs-number">1</span>+<span class="hljs-number">0.27</span>*nSample)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(realSample)):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    Gx=<span class="hljs-built_in">int</span>(sh.recvline())<br>    sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    Px=<span class="hljs-built_in">int</span>(sh.recvline())<br>    G=E.lift_x(ZZ(Gx))<br>    P=E.lift_x(ZZ(Px))<br>    d=ecBSGS(G,P)<br>    <span class="hljs-keyword">if</span>(d+<span class="hljs-number">1</span>):<br>        sh.sendline(<span class="hljs-built_in">str</span>(d).encode())<br>        D.append(<span class="hljs-built_in">int</span>(d))<br>    <span class="hljs-keyword">else</span>:<br>        P=-P<br>        d=ecBSGS(G,P)<br>        <span class="hljs-keyword">if</span>(d+<span class="hljs-number">1</span>):<br>            sh.sendline(<span class="hljs-built_in">str</span>(d).encode())<br>            D.append(<span class="hljs-built_in">int</span>(d))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;fail&#x27;</span>)<br>            exit(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(realSample,nSample)):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    Gx=<span class="hljs-built_in">int</span>(sh.recvline())<br>    sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    Px=<span class="hljs-built_in">int</span>(sh.recvline())<br>    sh.sendline(<span class="hljs-string">b&#x27;99999999999999&#x27;</span>)<br>    sh.recvuntil(<span class="hljs-string">b&#x27;right number&#x27;</span>)<br>    v=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    D.append(<span class="hljs-built_in">int</span>(v))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(D))<br></code></pre></td></tr></table></figure><p>ä¸è¿‡é¸¡å—åšå®¢ä¸­æåˆ°ï¼Œè¿™è¾¹ç³»ç»Ÿæ²¡æœ‰åˆ¤æ–­è¾“å…¥æ˜¯å¦å¤§äº $1500$ï¼Œå› æ­¤å‘ $2000$ è¿‡å»ä¹Ÿæ²¡å•¥äº‹ï¼Œ$1300$ ç»„æ‹¿æ•°æ®ï¼Œ$700$ ç»„é¢„æµ‹ã€‚å¯ä»¥çœå»äº†BSGSçš„æ—¶é—´ã€‚</p><h3 id="7x04-Part-3"><a href="#7x04-Part-3" class="headerlink" title="7x04 Part 3"></a>7x04 Part 3</h3><p>æœ€åè¿™ä¸€éƒ¨åˆ†ï¼Œéšæœºæ•°ç”Ÿæˆå™¨åˆå†²æ´—ä½ è®¾ç½®æˆäº†<code>new_state</code>ï¼Œç„¶å <code>iv</code> å°±æ˜¯ $2000$ ä¸ª <code>getrandbits(32)</code> çš„å’Œï¼Œå¯†é’¥å°±æ˜¯ <code>new_state1</code>ï¼Œä¼ è¿‡å»å°±è¡Œäº†ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">random.seed(new_state)<br>iv_num = ADD(<span class="hljs-number">2000</span>)<br><br>iv = hashlib.sha256(<span class="hljs-built_in">str</span>(iv_num).encode()).digest()[:<span class="hljs-number">16</span>]<br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(new_state1).encode()).digest()[:<span class="hljs-number">16</span>]<br>Aes = AES.new(key,AES.MODE_CBC, iv)<br>C = Aes.encrypt(pad(flag,<span class="hljs-number">16</span>))<br><br>key_n, iv_n = <span class="hljs-built_in">int</span>(sc()), <span class="hljs-built_in">int</span>(sc())<br>iv1 = hashlib.sha256(<span class="hljs-built_in">str</span>(iv_n).encode()).digest()[:<span class="hljs-number">16</span>]<br>key1 = hashlib.sha256(<span class="hljs-built_in">str</span>(key_n).encode()).digest()[:<span class="hljs-number">16</span>]<br>Aes_verify = AES.new(key1,AES.MODE_CBC, iv1)<br>C_verify = unpad(Aes_verify.decrypt(C),<span class="hljs-number">16</span>)<br><br><span class="hljs-keyword">if</span> C_verify == flag:<br>    pr(<span class="hljs-string">&#x27;CongratulationsğŸ‡ğŸ‡ğŸ‡!!!!&#x27;</span>)<br>    pr(<span class="hljs-string">&#x27;Here is your flagğŸ˜Šï¼š&#x27;</span>, M)<br><span class="hljs-keyword">else</span>:<br>    pr(<span class="hljs-string">&#x27;Maybe you could get the right flag!&#x27;</span>)<br></code></pre></td></tr></table></figure><p>è¿™è¾¹EXPå°±å¾ˆç®€å•äº†ï¼Œå¯ä»¥ç›´æ¥ç”¨gf2bvåšï¼ˆ$\mathsf{34s,373MB}$ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gf2bv <span class="hljs-keyword">import</span> LinearSystem<br><span class="hljs-keyword">from</span> gf2bv.crypto.mt <span class="hljs-keyword">import</span> MT19937<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gf2bv_mt19937</span>(<span class="hljs-params">bs, out</span>):<br>    lin = LinearSystem([<span class="hljs-number">32</span>] * <span class="hljs-number">624</span>)<br>    mt = lin.gens()<br><br>    rng = MT19937(mt)<br>    zeros = [rng.getrandbits(bs) ^ <span class="hljs-built_in">int</span>(o) <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> out] + [mt[<span class="hljs-number">0</span>] ^ <span class="hljs-built_in">int</span>(<span class="hljs-number">0x80000000</span>)]<br>    sol = lin.solve_one(zeros)<br><br>    rng = MT19937(sol)<br>    pyrand = rng.to_python_random()<br>    <span class="hljs-keyword">return</span> pyrand<br>rng2=gf2bv_mt19937(<span class="hljs-number">25</span>,D)<br>A32=[rng2.getrandbits(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2000</span>)]<br>A=<span class="hljs-built_in">sum</span>(A32)<br>sh.sendline(<span class="hljs-built_in">str</span>(newstate1).encode())<br>sh.sendline(<span class="hljs-built_in">str</span>(A).encode())<br><span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">6</span>))<br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œæ„é€ çŸ©é˜µä¹Ÿæ˜¯å¯ä»¥çš„ï¼ˆ$\mathsf{112s,6.9GB}$ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    row=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nSample):<br>        row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(rng.getrandbits(<span class="hljs-number">25</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">25</span>))))<br>    <span class="hljs-keyword">return</span> row<br>rng=random.Random()<br>M=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†ä¸ºå›ºå®šå¥—è·¯ï¼Œå…·ä½“åŸå› å·²ç»å†™åœ¨æ³¨é‡Šä¸­äº†</span><br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <span class="hljs-comment">#è¿™ä¸ªsetstateä¹Ÿæ˜¯å›ºå®šæ ¼å¼ï¼Œå·²äº2025.1.21æµ‹è¯•</span><br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;r(M)=&quot;</span>,M.rank())<br>y=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nSample):<br>    y+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(D[i])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">25</span>))))<br>y=vector(GF(<span class="hljs-number">2</span>),y)<br>s=M.solve_left(y)<br>G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    C=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        C&lt;&lt;=<span class="hljs-number">1</span><br>        C|=<span class="hljs-built_in">int</span>(s[<span class="hljs-number">32</span>*i+j])<br>    G.append(C)<br>RNG1 = random.Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<br>A32=[RNG1.getrandbits(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2000</span>)]<br>A=<span class="hljs-built_in">sum</span>(A32)<br><br>sh.sendline(<span class="hljs-built_in">str</span>(newstate1).encode())<br>sh.sendline(<span class="hljs-built_in">str</span>(A).encode())<br><span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">6</span>))<br></code></pre></td></tr></table></figure><h3 id="7x05-å®Œæ•´exp"><a href="#7x05-å®Œæ•´exp" class="headerlink" title="7x05 å®Œæ•´exp"></a>7x05 å®Œæ•´exp</h3><p>é‚£ä¹ˆæœ€ç»ˆå®Œæ•´çš„expå°±æ˜¯è¿™äº›äº†ï¼ˆç›´æ¥è°ƒäº†æˆ‘ä¸¤å¤©åŠæ‰è°ƒå‡ºæ¥ã€‚ã€‚ã€‚ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python 3</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyanzhengma</span>(<span class="hljs-params">s16,s64</span>):<br>    table=<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890&#x27;</span><br>    <span class="hljs-keyword">for</span> ch1 <span class="hljs-keyword">in</span> table:<br>        <span class="hljs-keyword">for</span> ch2 <span class="hljs-keyword">in</span> table:<br>            <span class="hljs-keyword">for</span> ch3 <span class="hljs-keyword">in</span> table:<br>                <span class="hljs-keyword">for</span> ch4 <span class="hljs-keyword">in</span> table:<br>                    <span class="hljs-keyword">if</span>(sha256((ch1+ch2+ch3+ch4+s16).encode()).hexdigest()==s64):<br>                        <span class="hljs-keyword">return</span> ch1+ch2+ch3+ch4<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;aaaa&#x27;</span><br><span class="hljs-comment"># sh=process([&#x27;python3&#x27;,&#x27;task37.py&#x27;])</span><br>sh=remote(<span class="hljs-string">&quot;node7.anna.nssctf.cn&quot;</span>,<span class="hljs-number">23842</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;+&#x27;</span>)<br>recv=sh.recvline().decode().strip().split(<span class="hljs-string">&#x27;==&#x27;</span>)<br>s16=recv[<span class="hljs-number">0</span>][:-<span class="hljs-number">2</span>]<br>s64=recv[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(s16,s64)<br>yanzhengma=getyanzhengma(s16,s64)<br>sh.sendline(yanzhengma.encode())<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    sh.recvline()<br><br><br>p=<span class="hljs-number">10966580842619877820066146550592605243948059864235950049184301493326519904217</span><br>n=<span class="hljs-number">10966580842619877820066146550592605243884930330463142198655617377280752484140</span><br>order=<span class="hljs-number">65537</span> * <span class="hljs-number">127</span> * <span class="hljs-number">103</span> * <span class="hljs-number">5</span><br>E=EllipticCurve(GF(p),[<span class="hljs-number">12</span>,<span class="hljs-number">17</span>])<br>Gx=<span class="hljs-number">9902877122724401288649251020980593854891741191216834612223927570106136389588</span><br>Gy=<span class="hljs-number">5145046550562502488367834786527673957133862042253512817925201451928791986047</span><br>G=E(Gx,Gy)<br><span class="hljs-keyword">assert</span> n%order==<span class="hljs-number">0</span><br>sh.sendline(<span class="hljs-built_in">str</span>(p).encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;Gx&#125;</span> <span class="hljs-subst">&#123;Gy&#125;</span>&#x27;</span>.encode())<br><br>msg=<span class="hljs-string">b&#x27;My secret is a random saying of phrase,As below :&#x27;</span><br>vmsg=bytes_to_long(msg)&lt;&lt;<span class="hljs-number">952</span><br><br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>R32s=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">500</span>)):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;c =&#x27;</span>)<br>    c=<span class="hljs-built_in">eval</span>(sh.recvline())<br>    sh.recvuntil(<span class="hljs-string">b&#x27;P =&#x27;</span>)<br>    P=<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;E &#x27;</span>+sh.recvline().strip().decode())<br>    sh.recvuntil(<span class="hljs-string">b&#x27;Q =&#x27;</span>)<br>    Q=<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;E&#x27;</span>+sh.recvline().strip().decode())<br>    R32s.append(<span class="hljs-built_in">int</span>(discrete_log(Q,G,operation=<span class="hljs-string">&#x27;+&#x27;</span>)))<br>    ctmp=c^vmsg<br>    tarr=[<span class="hljs-number">0</span>]*<span class="hljs-number">6</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>        tarr[<span class="hljs-number">5</span>-i]=ctmp%(<span class="hljs-number">2</span>**<span class="hljs-number">250</span>)<br>        ctmp&gt;&gt;=<span class="hljs-number">250</span><br>    tarr[<span class="hljs-number">3</span>]=tarr[<span class="hljs-number">4</span>]=tarr[<span class="hljs-number">5</span>]=<span class="hljs-number">0</span><br>    tarr[<span class="hljs-number">2</span>]=tarr[<span class="hljs-number">2</span>]&gt;&gt;(<span class="hljs-number">204</span>)&lt;&lt;(<span class="hljs-number">204</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        <span class="hljs-keyword">try</span>:<br>            s1=Integer((i&lt;&lt;<span class="hljs-number">250</span>)|tarr[<span class="hljs-number">1</span>])<br>            sQ=E.lift_x(s1)<br>            s2=Integer((<span class="hljs-number">65537</span>*sQ)[<span class="hljs-number">0</span>])<br>            t2all=Integer((s2*Q)[<span class="hljs-number">0</span>])<br>            t2=t2all%(<span class="hljs-number">2</span>**<span class="hljs-number">250</span>)<br>            <span class="hljs-keyword">if</span>(((t2&gt;&gt;<span class="hljs-number">204</span>)&lt;&lt;<span class="hljs-number">204</span>)==tarr[<span class="hljs-number">2</span>]):<br>                <span class="hljs-comment">#print(&#x27;found:&#x27;,i)</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;not found&#x27;</span>)<br>    <span class="hljs-comment"># sh.interactive()</span><br>    s0=s2<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]:<br>        ti=(s0*Q)[<span class="hljs-number">0</span>]<br>        s0=Integer((s0*P)[<span class="hljs-number">0</span>])<br>        tarr[i]=Integer(ti)%<span class="hljs-number">2</span>**<span class="hljs-number">250</span><br>    <span class="hljs-comment"># print(tarr)</span><br>    t1344=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>        t1344&lt;&lt;=<span class="hljs-number">250</span><br>        t1344|=tarr[i]<br>    msgans=(long_to_bytes(c^t1344))<br>    sh.sendline(msgans)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(R32s))<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;(&#x27;</span>)<br>q,a,b=<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;(&#x27;</span>+sh.recvline().decode())<br><span class="hljs-built_in">print</span>(q,a,b)<br>sh.recvline()<br><br>nSample=<span class="hljs-number">1266</span><br>sh.sendline(<span class="hljs-built_in">str</span>(nSample).encode())<br>sh.recvline()<br><span class="hljs-keyword">import</span> mttools<br>F=mttools.MT19937()<br>F.setstate(R32s[:<span class="hljs-number">500</span>]+[<span class="hljs-number">0</span>]*<span class="hljs-number">124</span>)<br>newstate1=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>):<br>    F.getstate()<br>newstate1=<span class="hljs-built_in">sum</span>([F.getstate() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>)])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ecBSGS</span>(<span class="hljs-params">G,H</span>):<br>    D=<span class="hljs-built_in">dict</span>()<br>    P=E(<span class="hljs-number">0</span>)<br>    G2=G*<span class="hljs-number">5793</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5793</span>):<br>        D[P]=i<br>        P+=G2<br>    Htmp=H<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5793</span>):<br>        u=D.get(Htmp,<span class="hljs-literal">None</span>)<br>        <span class="hljs-keyword">if</span>(u):<br>            <span class="hljs-keyword">return</span> u*<span class="hljs-number">5793</span>+i<br>        Htmp-=G<br>    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><br>Fq2=GF((q,<span class="hljs-number">2</span>),name=<span class="hljs-string">&#x27;sq3i&#x27;</span>,modulus=[<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(GF(q*q),[a,b])<br>D=[]<br>realSample=<span class="hljs-built_in">int</span>(<span class="hljs-number">1</span>+<span class="hljs-number">0.27</span>*nSample)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(realSample)):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    Gx=<span class="hljs-built_in">int</span>(sh.recvline())<br>    sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    Px=<span class="hljs-built_in">int</span>(sh.recvline())<br>    G=E.lift_x(ZZ(Gx))<br>    P=E.lift_x(ZZ(Px))<br>    d=ecBSGS(G,P)<br>    <span class="hljs-keyword">if</span>(d+<span class="hljs-number">1</span>):<br>        sh.sendline(<span class="hljs-built_in">str</span>(d).encode())<br>        D.append(<span class="hljs-built_in">int</span>(d))<br>    <span class="hljs-keyword">else</span>:<br>        P=-P<br>        d=ecBSGS(G,P)<br>        <span class="hljs-keyword">if</span>(d+<span class="hljs-number">1</span>):<br>            sh.sendline(<span class="hljs-built_in">str</span>(d).encode())<br>            D.append(<span class="hljs-built_in">int</span>(d))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;fail&#x27;</span>)<br>            exit(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(realSample,nSample)):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    Gx=<span class="hljs-built_in">int</span>(sh.recvline())<br>    sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    Px=<span class="hljs-built_in">int</span>(sh.recvline())<br>    sh.sendline(<span class="hljs-string">b&#x27;99999999999999&#x27;</span>)<br>    sh.recvuntil(<span class="hljs-string">b&#x27;right number&#x27;</span>)<br>    v=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    D.append(<span class="hljs-built_in">int</span>(v))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(D))<br><br><span class="hljs-comment">#=========IF YOU DO NOT HAVE GF2BV, REPLACE THE CODE BELOW TO THE LAST CODE BLOCK IN 7x04 CHAPTER.</span><br><span class="hljs-keyword">from</span> gf2bv <span class="hljs-keyword">import</span> LinearSystem<br><span class="hljs-keyword">from</span> gf2bv.crypto.mt <span class="hljs-keyword">import</span> MT19937<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gf2bv_mt19937</span>(<span class="hljs-params">bs, out</span>):<br>    lin = LinearSystem([<span class="hljs-number">32</span>] * <span class="hljs-number">624</span>)<br>    mt = lin.gens()<br><br>    rng = MT19937(mt)<br>    zeros = [rng.getrandbits(bs) ^ <span class="hljs-built_in">int</span>(o) <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> out] + [mt[<span class="hljs-number">0</span>] ^ <span class="hljs-built_in">int</span>(<span class="hljs-number">0x80000000</span>)]<br>    sol = lin.solve_one(zeros)<br><br>    rng = MT19937(sol)<br>    pyrand = rng.to_python_random()<br>    <span class="hljs-keyword">return</span> pyrand<br>rng2=gf2bv_mt19937(<span class="hljs-number">25</span>,D)<br>A32=[rng2.getrandbits(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2000</span>)]<br>A=<span class="hljs-built_in">sum</span>(A32)<br><br>sh.sendline(<span class="hljs-built_in">str</span>(newstate1).encode())<br>sh.sendline(<span class="hljs-built_in">str</span>(A).encode())<br><span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">6</span>))<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆè¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/03/21/25Mar1-MTArchive/2.png" alt="2"></p><h3 id="7x09-å’Œå»å¹´11æœˆå¯¹æ¯”ï¼Ÿ"><a href="#7x09-å’Œå»å¹´11æœˆå¯¹æ¯”ï¼Ÿ" class="headerlink" title="7x09 å’Œå»å¹´11æœˆå¯¹æ¯”ï¼Ÿ"></a>7x09 å’Œå»å¹´11æœˆå¯¹æ¯”ï¼Ÿ</h3><p>ç›¸æ¯”è¾ƒäºå»å¹´ 11 æœˆï¼Œå¯’å‡ä»CryptoHacké‚£è¾¹çŸ¥é“äº† $X,Z$ çš„è¡¨ç¤ºï¼Œä»¥åŠå€¼ç”¨ $X$ åæ ‡è®¡ç®—å€ç‚¹çš„æ–¹å¼ã€‚ç„¶åä¸­é€”åšäº†äº›é¢˜ï¼ŒçŸ¥é“äº† <code>getrandbits(X)</code> çš„å®Œæ•´è§£æ³•ï¼ˆXä¸ä¸€å®šä¸º $32$ çš„å€æ•°ï¼‰ã€‚å½“ç„¶ï¼Œä¹Ÿä»æœ¬é¢˜ä¸­ï¼ŒçŸ¥é“äº†DUAL ECéšæœºæ•°å‘ç”Ÿå™¨çš„åé—¨ã€‚å› ä¸ºå½“æ—¶ä¸çŸ¥é“è¿™äº›ï¼ŒåŠ ä¸Šè¿™ä¸ªé¢˜solæ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥ç›´æ¥æ”¾å¼ƒäº†ã€‚æ²¡æƒ³åˆ° $20$ ä¸ªæ˜ŸæœŸåï¼Œç§¯ç´¯äº†ä¸€äº›çŸ¥è¯†ï¼Œç«Ÿç„¶è¿˜åšå‡ºæ¥äº†ã€‚ã€‚</p><h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9.æ€»ç»“"></a>9.æ€»ç»“</h2><p>è²Œä¼¼MT19937çš„é¢˜å‹çš„è§£æ³•ç›¸å¯¹æ¯”è¾ƒå›ºå®šï¼ŒåŸºæœ¬å°±æ˜¯å»ºçŸ©é˜µç„¶åè§£stateï¼Œå¹¶ä¸”ä¹Ÿæœ‰å¾ˆå¤šå·¥å…·èƒ½å¤Ÿç›´æ¥ä¸€æŠŠæ¢­ã€‚ã€‚ã€‚</p><blockquote><p>rec:å½“ä½ å‘ç°æŸä¸ªé¢˜å‹å‡ºé¢˜æ€è·¯å’Œè§£é¢˜æ€è·¯ç›¸å¯¹æ¯”è¾ƒå›ºå®šçš„æ—¶å€™ï¼Œé‚£å°±è¯´æ˜ä½ å˜å¼ºäº†ã€‚</p></blockquote><p>ç¿»äº†çœ¼QQç©ºé—´ï¼Œä»Šå¤©æ˜¯ 3 æœˆ 21 æ—¥ã€‚ï¼ˆå› ä¸ºæœ€è¿‘å¿™å¯¼å¸ˆé¡¹ç›®å’ŒCISCNæ‰€ä»¥è¿™ç¯‡blogåŸè®¡åˆ’æ˜¯ 3 æœˆ 10 æ—¥å‰åå‘å¸ƒçš„ï¼Œè¿˜æ˜¯æ‹–åˆ°äº†ç°åœ¨æ‰å‘å¸ƒï¼‰ã€‚2021 å¹´ 3 æœˆ 21 æ—¥ä¸‹åˆ 4 ç‚¹ï¼Œæˆ‘åšå‡ºäº† Am4 å¸ˆå‚…ç»™æˆ‘å‘çš„ x1c è€ƒæ ¸é¢˜ï¼Œæ„Ÿè§‰é‚£ä¼¼ä¹è¿˜æ˜¯æ˜¨å¤©ï¼Œä½†å®é™…ä¸Šå·²ç» 4 å¹´äº†ã€‚ã€‚ã€‚</p><p><img src="/2025/03/21/25Mar1-MTArchive/5.png" alt="5"></p><p>è¿˜æœ‰ä¸‰ä¸ªæœˆå°±ç ”äºŒäº†ï¼Œæ„Ÿè§‰åŠå¹´æ¥ï¼Œè‡ªå·±CTFæ°´å¹³ç¡®å®ä¹Ÿæ˜¯æœ‰æ‰€æå‡çš„ï¼Œçœ‹åé¢ä¸‰ä¸ªæœˆä¼šä¸ä¼šè¿˜æœ‰å•¥ç»§ç»­è¿›æ­¥å§ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">Nep</span><span class="hljs-template-variable">&#123;LOoK_aT_th3_sT4R-Lo0k_h0w_tH3y_5h1N3_fOr_Y0u&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hgame25</title>
    <link href="/2025/02/21/Hgame25/"/>
    <url>/2025/02/21/Hgame25/</url>
    
    <content type="html"><![CDATA[<h1 id="Hgame-2025-Writeup"><a href="#Hgame-2025-Writeup" class="headerlink" title="Hgame 2025 Writeup"></a>Hgame 2025 Writeup</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0. Introduction"></a>0. Introduction</h2><p>ä¹‹å‰é‚£ä¸¤å‘¨å­¦åŒæºç›¸å…³å†…å®¹ + ç»ƒè½¦ï¼Œå¯¼è‡´Hgameæ²¡æ€ä¹ˆçœ‹ï¼Œç„¶åå¼€å­¦åHgameåˆšå¥½ç»“æŸï¼Œ2æœˆ18æ—¥ç”¨ä¸€å¤©åŠåšäº†ä¸€ä¸‹é¢˜ï¼Œåªèƒ½è¯´è·Ÿ21å¹´22å¹´ç›¸æ¯”ï¼Œè²Œä¼¼ç¡®å®éš¾äº†å¾ˆå¤šã€‚ã€‚ã€‚ã€‚</p><p>å› ä¸ºé¢˜ç›®æ˜¯18æ—¥åšçš„ï¼Œæ‰€ä»¥å°±ä¸åŒºåˆ†ç¬¬ä¸€å‘¨ç¬¬äºŒå‘¨äº†ï¼Œç›´æ¥æŒ‰é¢˜ç›®åˆ†æ•°æ’åºäº†ã€‚</p><h2 id="1-Ancient-Recall-4pts-144sol"><a href="#1-Ancient-Recall-4pts-144sol" class="headerlink" title="1.Ancient Recall(4pts,144sol)"></a>1.Ancient Recall(4pts,144sol)</h2><p>å…ˆçœ‹çœ‹é¢˜ç›®ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><br>Major_Arcana = [<span class="hljs-string">&quot;The Fool&quot;</span>, <span class="hljs-string">&quot;The Magician&quot;</span>, <span class="hljs-string">&quot;The High Priestess&quot;</span>,<span class="hljs-string">&quot;The Empress&quot;</span>, <span class="hljs-string">&quot;The Emperor&quot;</span>, <span class="hljs-string">&quot;The Hierophant&quot;</span>,<span class="hljs-string">&quot;The Lovers&quot;</span>, <span class="hljs-string">&quot;The Chariot&quot;</span>, <span class="hljs-string">&quot;Strength&quot;</span>,<span class="hljs-string">&quot;The Hermit&quot;</span>, <span class="hljs-string">&quot;Wheel of Fortune&quot;</span>, <span class="hljs-string">&quot;Justice&quot;</span>,<span class="hljs-string">&quot;The Hanged Man&quot;</span>, <span class="hljs-string">&quot;Death&quot;</span>, <span class="hljs-string">&quot;Temperance&quot;</span>,<span class="hljs-string">&quot;The Devil&quot;</span>, <span class="hljs-string">&quot;The Tower&quot;</span>, <span class="hljs-string">&quot;The Star&quot;</span>,<span class="hljs-string">&quot;The Moon&quot;</span>, <span class="hljs-string">&quot;The Sun&quot;</span>, <span class="hljs-string">&quot;Judgement&quot;</span>,<span class="hljs-string">&quot;The World&quot;</span>]<br>wands = [<span class="hljs-string">&quot;Ace of Wands&quot;</span>, <span class="hljs-string">&quot;Two of Wands&quot;</span>, <span class="hljs-string">&quot;Three of Wands&quot;</span>, <span class="hljs-string">&quot;Four of Wands&quot;</span>, <span class="hljs-string">&quot;Five of Wands&quot;</span>, <span class="hljs-string">&quot;Six of Wands&quot;</span>, <span class="hljs-string">&quot;Seven of Wands&quot;</span>, <span class="hljs-string">&quot;Eight of Wands&quot;</span>, <span class="hljs-string">&quot;Nine of Wands&quot;</span>, <span class="hljs-string">&quot;Ten of Wands&quot;</span>, <span class="hljs-string">&quot;Page of Wands&quot;</span>, <span class="hljs-string">&quot;Knight of Wands&quot;</span>, <span class="hljs-string">&quot;Queen of Wands&quot;</span>, <span class="hljs-string">&quot;King of Wands&quot;</span>]<br>cups = [<span class="hljs-string">&quot;Ace of Cups&quot;</span>, <span class="hljs-string">&quot;Two of Cups&quot;</span>, <span class="hljs-string">&quot;Three of Cups&quot;</span>, <span class="hljs-string">&quot;Four of Cups&quot;</span>, <span class="hljs-string">&quot;Five of Cups&quot;</span>, <span class="hljs-string">&quot;Six of Cups&quot;</span>, <span class="hljs-string">&quot;Seven of Cups&quot;</span>, <span class="hljs-string">&quot;Eight of Cups&quot;</span>, <span class="hljs-string">&quot;Nine of Cups&quot;</span>, <span class="hljs-string">&quot;Ten of Cups&quot;</span>, <span class="hljs-string">&quot;Page of Cups&quot;</span>, <span class="hljs-string">&quot;Knight of Cups&quot;</span>, <span class="hljs-string">&quot;Queen of Cups&quot;</span>, <span class="hljs-string">&quot;King of Cups&quot;</span>]<br>swords = [<span class="hljs-string">&quot;Ace of Swords&quot;</span>, <span class="hljs-string">&quot;Two of Swords&quot;</span>, <span class="hljs-string">&quot;Three of Swords&quot;</span>, <span class="hljs-string">&quot;Four of Swords&quot;</span>, <span class="hljs-string">&quot;Five of Swords&quot;</span>, <span class="hljs-string">&quot;Six of Swords&quot;</span>, <span class="hljs-string">&quot;Seven of Swords&quot;</span>, <span class="hljs-string">&quot;Eight of Swords&quot;</span>, <span class="hljs-string">&quot;Nine of Swords&quot;</span>, <span class="hljs-string">&quot;Ten of Swords&quot;</span>, <span class="hljs-string">&quot;Page of Swords&quot;</span>, <span class="hljs-string">&quot;Knight of Swords&quot;</span>, <span class="hljs-string">&quot;Queen of Swords&quot;</span>, <span class="hljs-string">&quot;King of Swords&quot;</span>]<br>pentacles = [<span class="hljs-string">&quot;Ace of Pentacles&quot;</span>, <span class="hljs-string">&quot;Two of Pentacles&quot;</span>, <span class="hljs-string">&quot;Three of Pentacles&quot;</span>, <span class="hljs-string">&quot;Four of Pentacles&quot;</span>, <span class="hljs-string">&quot;Five of Pentacles&quot;</span>, <span class="hljs-string">&quot;Six of Pentacles&quot;</span>, <span class="hljs-string">&quot;Seven of Pentacles&quot;</span>, <span class="hljs-string">&quot;Eight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Nine of Pentacles&quot;</span>, <span class="hljs-string">&quot;Ten of Pentacles&quot;</span>, <span class="hljs-string">&quot;Page of Pentacles&quot;</span>, <span class="hljs-string">&quot;Knight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Queen of Pentacles&quot;</span>, <span class="hljs-string">&quot;King of Pentacles&quot;</span>]<br>Minor_Arcana = wands + cups + swords + pentacles<br>tarot = Major_Arcana + Minor_Arcana<br>reversals = [<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>]<br><br>Value = []<br>cards = []<br>YOUR_initial_FATE = []<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(YOUR_initial_FATE)&lt;<span class="hljs-number">5</span>:<br>    card = random.choice(tarot)<br>    <span class="hljs-keyword">if</span> card <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> cards:<br>        cards.append(card)<br>        <span class="hljs-keyword">if</span> card <span class="hljs-keyword">in</span> Major_Arcana:<br>            k = random.choice(reversals)<br>            Value.append(tarot.index(card)^k)<br>            <span class="hljs-keyword">if</span> k == -<span class="hljs-number">1</span>:<br>                YOUR_initial_FATE.append(<span class="hljs-string">&quot;re-&quot;</span>+card)<br>            <span class="hljs-keyword">else</span>:<br>                YOUR_initial_FATE.append(card)<br>        <span class="hljs-keyword">else</span>:<br>            Value.append(tarot.index(card))<br>            YOUR_initial_FATE.append(card)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">continue</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Oops!lets reverse 1T!&quot;</span>)<br><br>FLAG=(<span class="hljs-string">&quot;hgame&#123;&quot;</span>+<span class="hljs-string">&quot;&amp;&quot;</span>.join(YOUR_initial_FATE)+<span class="hljs-string">&quot;&#125;&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;_&quot;</span>)<br><br>YOUR_final_Value = Value<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Fortune_wheel</span>(<span class="hljs-params">FATE</span>):<br>    FATEd = [FATE[i]+FATE[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">5</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(FATE))]<br>    <span class="hljs-keyword">return</span> FATEd<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>):<br>    YOUR_final_Value = Fortune_wheel(YOUR_final_Value)<br><span class="hljs-built_in">print</span>(YOUR_final_Value)<br>YOUR_final_FATE = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> YOUR_final_Value:<br>    YOUR_final_FATE.append(tarot[i%<span class="hljs-number">78</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your destiny changed!\n&quot;</span>,<span class="hljs-string">&quot;,&quot;</span>.join(YOUR_final_FATE))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;oh,now you GET th3 GOOd lU&gt;k,^^&quot;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Oops!lets reverse 1T!</span><br><span class="hljs-string">[2532951952066291774890498369114195917240794704918210520571067085311474675019, 2532951952066291774890327666074100357898023013105443178881294700381509795270, 2532951952066291774890554459287276604903130315859258544173068376967072335730, 2532951952066291774890865328241532885391510162611534514014409174284299139015, 2532951952066291774890830662608134156017946376309989934175833913921142609334]</span><br><span class="hljs-string">Your destiny changed!</span><br><span class="hljs-string"> Eight of Cups,Ace of Cups,Strength,The Chariot,Five of Swords</span><br><span class="hljs-string">oh,now you GET th3 GOOd lU&gt;k,^^</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å…¶å®è¿™ä¸ªé¢˜è™½ç„¶å†™äº†ä¸€å¤§å †ï¼Œä½†å…¶æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯è¦æ ¹æ®æœ€ç»ˆæ‹¿åˆ°Valueï¼Œæ±‚å‡ºåŸå§‹çš„Valueï¼Œæœ€ç»ˆå¯ä»¥ç›´æ¥å¾—åˆ°flagã€‚</p><p>æ³¨æ„åˆ°è¿™æ ·çš„é€’æ¨å¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">Fortune_wheel</span>(<span class="hljs-params">FATE</span>):<br>    FATEd = [FATE[i]+FATE[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">5</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(FATE))]<br>    <span class="hljs-keyword">return</span> FATEd<br></code></pre></td></tr></table></figure><p>è¯¥é€’æ¨å¼æ‰§è¡Œäº†250æ¬¡å¾—åˆ°äº†æœ€ç»ˆçš„ç»“æœã€‚å¯ä»¥å‘ç°è¿™å°±æ˜¯ä¸€ä¸ªçº¿æ€§é€’æ¨ï¼Œå°è¯•æ„å»ºï¼š</p><p><img src="/2025/02/21/Hgame25/1.png" alt="1"></p><p>é‚£ä¹ˆæ±‚åŸå§‹å€¼å°±æ˜¯æ±‚å·¦è¾¹çŸ©é˜µçš„è´Ÿ250æ¬¡å¹‚ä¹˜ä¸Šæœ€ç»ˆçš„Valueå‘é‡ï¼Œç„¶åæ ¹æ®é¢˜ç›®ç»„flagçš„æ–¹å¼ç»„æˆflagå°±OKäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br>arr=[<span class="hljs-number">2532951952066291774890498369114195917240794704918210520571067085311474675019</span>, <span class="hljs-number">2532951952066291774890327666074100357898023013105443178881294700381509795270</span>, <span class="hljs-number">2532951952066291774890554459287276604903130315859258544173068376967072335730</span>, <span class="hljs-number">2532951952066291774890865328241532885391510162611534514014409174284299139015</span>, <span class="hljs-number">2532951952066291774890830662608134156017946376309989934175833913921142609334</span>]<br><br>M=matrix([<br>    [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],<br>    [<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]<br>])<br><br>v=vector(arr)<br>ans=(M**-<span class="hljs-number">250</span>)*v<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-comment"># (-19, -20, 20, -15, 41)</span><br>Major_Arcana = [<span class="hljs-string">&quot;The Fool&quot;</span>, <span class="hljs-string">&quot;The Magician&quot;</span>, <span class="hljs-string">&quot;The High Priestess&quot;</span>,<span class="hljs-string">&quot;The Empress&quot;</span>, <span class="hljs-string">&quot;The Emperor&quot;</span>, <span class="hljs-string">&quot;The Hierophant&quot;</span>,<span class="hljs-string">&quot;The Lovers&quot;</span>, <span class="hljs-string">&quot;The Chariot&quot;</span>, <span class="hljs-string">&quot;Strength&quot;</span>,<span class="hljs-string">&quot;The Hermit&quot;</span>, <span class="hljs-string">&quot;Wheel of Fortune&quot;</span>, <span class="hljs-string">&quot;Justice&quot;</span>,<span class="hljs-string">&quot;The Hanged Man&quot;</span>, <span class="hljs-string">&quot;Death&quot;</span>, <span class="hljs-string">&quot;Temperance&quot;</span>,<span class="hljs-string">&quot;The Devil&quot;</span>, <span class="hljs-string">&quot;The Tower&quot;</span>, <span class="hljs-string">&quot;The Star&quot;</span>,<span class="hljs-string">&quot;The Moon&quot;</span>, <span class="hljs-string">&quot;The Sun&quot;</span>, <span class="hljs-string">&quot;Judgement&quot;</span>,<span class="hljs-string">&quot;The World&quot;</span>]<br>wands = [<span class="hljs-string">&quot;Ace of Wands&quot;</span>, <span class="hljs-string">&quot;Two of Wands&quot;</span>, <span class="hljs-string">&quot;Three of Wands&quot;</span>, <span class="hljs-string">&quot;Four of Wands&quot;</span>, <span class="hljs-string">&quot;Five of Wands&quot;</span>, <span class="hljs-string">&quot;Six of Wands&quot;</span>, <span class="hljs-string">&quot;Seven of Wands&quot;</span>, <span class="hljs-string">&quot;Eight of Wands&quot;</span>, <span class="hljs-string">&quot;Nine of Wands&quot;</span>, <span class="hljs-string">&quot;Ten of Wands&quot;</span>, <span class="hljs-string">&quot;Page of Wands&quot;</span>, <span class="hljs-string">&quot;Knight of Wands&quot;</span>, <span class="hljs-string">&quot;Queen of Wands&quot;</span>, <span class="hljs-string">&quot;King of Wands&quot;</span>]<br>cups = [<span class="hljs-string">&quot;Ace of Cups&quot;</span>, <span class="hljs-string">&quot;Two of Cups&quot;</span>, <span class="hljs-string">&quot;Three of Cups&quot;</span>, <span class="hljs-string">&quot;Four of Cups&quot;</span>, <span class="hljs-string">&quot;Five of Cups&quot;</span>, <span class="hljs-string">&quot;Six of Cups&quot;</span>, <span class="hljs-string">&quot;Seven of Cups&quot;</span>, <span class="hljs-string">&quot;Eight of Cups&quot;</span>, <span class="hljs-string">&quot;Nine of Cups&quot;</span>, <span class="hljs-string">&quot;Ten of Cups&quot;</span>, <span class="hljs-string">&quot;Page of Cups&quot;</span>, <span class="hljs-string">&quot;Knight of Cups&quot;</span>, <span class="hljs-string">&quot;Queen of Cups&quot;</span>, <span class="hljs-string">&quot;King of Cups&quot;</span>]<br>swords = [<span class="hljs-string">&quot;Ace of Swords&quot;</span>, <span class="hljs-string">&quot;Two of Swords&quot;</span>, <span class="hljs-string">&quot;Three of Swords&quot;</span>, <span class="hljs-string">&quot;Four of Swords&quot;</span>, <span class="hljs-string">&quot;Five of Swords&quot;</span>, <span class="hljs-string">&quot;Six of Swords&quot;</span>, <span class="hljs-string">&quot;Seven of Swords&quot;</span>, <span class="hljs-string">&quot;Eight of Swords&quot;</span>, <span class="hljs-string">&quot;Nine of Swords&quot;</span>, <span class="hljs-string">&quot;Ten of Swords&quot;</span>, <span class="hljs-string">&quot;Page of Swords&quot;</span>, <span class="hljs-string">&quot;Knight of Swords&quot;</span>, <span class="hljs-string">&quot;Queen of Swords&quot;</span>, <span class="hljs-string">&quot;King of Swords&quot;</span>]<br>pentacles = [<span class="hljs-string">&quot;Ace of Pentacles&quot;</span>, <span class="hljs-string">&quot;Two of Pentacles&quot;</span>, <span class="hljs-string">&quot;Three of Pentacles&quot;</span>, <span class="hljs-string">&quot;Four of Pentacles&quot;</span>, <span class="hljs-string">&quot;Five of Pentacles&quot;</span>, <span class="hljs-string">&quot;Six of Pentacles&quot;</span>, <span class="hljs-string">&quot;Seven of Pentacles&quot;</span>, <span class="hljs-string">&quot;Eight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Nine of Pentacles&quot;</span>, <span class="hljs-string">&quot;Ten of Pentacles&quot;</span>, <span class="hljs-string">&quot;Page of Pentacles&quot;</span>, <span class="hljs-string">&quot;Knight of Pentacles&quot;</span>, <span class="hljs-string">&quot;Queen of Pentacles&quot;</span>, <span class="hljs-string">&quot;King of Pentacles&quot;</span>]<br>Minor_Arcana = wands + cups + swords + pentacles<br>tarot = Major_Arcana + Minor_Arcana<br><br>cards=[]<br>ans=<span class="hljs-built_in">list</span>(ans)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    <span class="hljs-keyword">if</span>(ans[i]&lt;<span class="hljs-number">0</span>):<br>        ans[i]=<span class="hljs-built_in">int</span>(ans[i])^-<span class="hljs-number">1</span><br>        cards.append(<span class="hljs-string">&#x27;re-&#x27;</span>+tarot[ans[i]])<br>    <span class="hljs-keyword">else</span>:<br>        cards.append(tarot[ans[i]])<br>FLAG=(<span class="hljs-string">&quot;hgame&#123;&quot;</span>+<span class="hljs-string">&quot;&amp;&quot;</span>.join(cards)+<span class="hljs-string">&quot;&#125;&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;_&quot;</span>)<br><span class="hljs-built_in">print</span>(FLAG)<br><span class="hljs-comment">#hgame&#123;re-The_Moon&amp;re-The_Sun&amp;Judgement&amp;re-Temperance&amp;Six_of_Cups&#125;</span><br></code></pre></td></tr></table></figure><h2 id="2-SuprimeRSA-6pts-61sol"><a href="#2-SuprimeRSA-6pts-61sol" class="headerlink" title="2.SuprimeRSA(6pts,61sol)"></a>2.SuprimeRSA(6pts,61sol)</h2><p>å¥½å®¶ä¼™ï¼Œè¿™ç«Ÿç„¶æ˜¯ä¸ªæ²¡è§è¿‡çš„ç©æ„ï¼Œå…ˆçœ‹çœ‹é¢˜ç›®ä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> prime<br><br>FLAG=<span class="hljs-string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxx&#125;&#x27;</span><br>e=<span class="hljs-number">0x10001</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">primorial</span>(<span class="hljs-params">num</span>):<br>    result = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, num + <span class="hljs-number">1</span>):<br>        result *= prime(i)<br>    <span class="hljs-keyword">return</span> result<br>M=primorial(random.choice([<span class="hljs-number">39</span>,<span class="hljs-number">71</span>,<span class="hljs-number">126</span>]))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        k = getPrime(random.randint(<span class="hljs-number">20</span>,<span class="hljs-number">40</span>))<br>        a = getPrime(random.randint(<span class="hljs-number">20</span>,<span class="hljs-number">60</span>))<br>        p = k * M + <span class="hljs-built_in">pow</span>(e, a, M)<br>        <span class="hljs-keyword">if</span> isPrime(p):<br>            <span class="hljs-keyword">return</span> p<br><br>p,q=gen_key(),gen_key()<br>n=p*q<br>m=bytes_to_long(FLAG)<br>enc=<span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;n=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">n=787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241</span><br><span class="hljs-string">enc=365164788284364079752299551355267634718233656769290285760796137651769990253028664857272749598268110892426683253579840758552222893644373690398408</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>é¢˜ç›®çš„ç´ æ•°ç”Ÿæˆæ–¹å¼æœ‰ç‚¹ç‰¹æ®Šï¼Œä½†ä½ å¯ä»¥çœ‹å‡ºæ˜æ˜¾çš„å°é‡ $k,a$ï¼Œä»¥åŠ $n&#x3D;(k_1M+e^{a_1})(k_2M+e^{a_2})$ï¼Œå¹¶ä¸”æ ¹æ® $n$ çš„è§„æ¨¡ï¼Œå¯ä»¥å¾ˆå¿«åœ°ç¡®å®šä¸‰ä¸ªé€‰é¡¹ä¸­å–çš„æ˜¯ $39$ ã€‚</p><p>å½“æ—¶å…ˆæŠŠ $e^{a_1}e^{a_2}$ çœ‹ä½œä¸€ä¸ªæ•´ä½“ï¼Œç„¶åæŠŠä¸Šé¢éƒ½å¼å­å±•å¼€ $n$ å†™æˆ $M$ è¿›åˆ¶çš„å½¢å¼è¿›è¡Œå¤šé¡¹å¼å¤„ç†ã€‚ä½†å‘ç° $e^{a_1}e^{a_2}$ ä¼šè¶…è¿‡ $M$ï¼Œå› æ­¤å¤šé¡¹å¼çš„æ–¹å¼ä¸ç®¡ç”¨ã€‚ï¼ˆè™½ç„¶ä½†æ˜¯ <code>n%M</code> çš„å€¼è¿˜çœŸèƒ½åˆ†è§£æˆä¸¤ä¸ªç´ æ•°çš„ä¹˜ç§¯ï¼‰ã€‚ã€‚ã€‚</p><p>ç„¶åç„äº†ä¸€çœ¼week 1çš„WPï¼Œç»“æœå‘ç°ç«Ÿç„¶æ˜¯ROCA Attackã€‚ã€‚ã€‚å¥½å®¶ä¼™ï¼Œä¸Šæ¥å°±æ¥è®ºæ–‡é¢˜æ˜¯å§ï¼Ÿ</p><p>é‚£å°±ç‚¹å‡» <a href="https://github.com/FlorianPicca/ROCA">è¿™ä¸ªé“¾æ¥</a> ä¸‹è½½githubæ”»å‡»ä»£ç ï¼Œæ”¹æ”¹æ”»å‡»å‚æ•°ï¼Œ$n$ å°±è¢«åˆ†è§£äº†ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.all_cmdline <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">coppersmith_howgrave_univariate</span>(<span class="hljs-params">pol, modulus, beta, mm, tt, XX</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Taken from https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/coppersmith.sage</span><br><span class="hljs-string">    Coppersmith revisited by Howgrave-Graham</span><br><span class="hljs-string"></span><br><span class="hljs-string">    finds a solution if:</span><br><span class="hljs-string">    * b|modulus, b &gt;= modulus^beta , 0 &lt; beta &lt;= 1</span><br><span class="hljs-string">    * |x| &lt; XX</span><br><span class="hljs-string">    More tunable than sage&#x27;s builtin coppersmith method, pol.small_roots()</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># init</span><br>    <span class="hljs-comment">#</span><br>    dd = pol.degree()<br>    nn = dd * mm + tt<br><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># checks</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-number">0</span> &lt; beta &lt;= <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;beta should belongs in [0, 1]&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> pol.is_monic():<br>        <span class="hljs-keyword">raise</span> ArithmeticError(<span class="hljs-string">&quot;Polynomial must be monic.&quot;</span>)<br><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># calculate bounds and display them</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    * we want to find g(x) such that ||g(xX)|| &lt;= b^m / sqrt(n)</span><br><span class="hljs-string"></span><br><span class="hljs-string">    * we know LLL will give us a short vector v such that:</span><br><span class="hljs-string">    ||v|| &lt;= 2^((n - 1)/4) * det(L)^(1/n)</span><br><span class="hljs-string"></span><br><span class="hljs-string">    * we will use that vector as a coefficient vector for our g(x)</span><br><span class="hljs-string"></span><br><span class="hljs-string">    * so we want to satisfy:</span><br><span class="hljs-string">    2^((n - 1)/4) * det(L)^(1/n) &lt; N^(beta*m) / sqrt(n)</span><br><span class="hljs-string"></span><br><span class="hljs-string">    so we can obtain ||v|| &lt; N^(beta*m) / sqrt(n) &lt;= b^m / sqrt(n)</span><br><span class="hljs-string">    (it&#x27;s important to use N because we might not know b)</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># Coppersmith revisited algo for univariate</span><br>    <span class="hljs-comment">#</span><br><br>    <span class="hljs-comment"># change ring of pol and x</span><br>    polZ = pol.change_ring(ZZ)<br>    x = polZ.parent().gen()<br><br>    <span class="hljs-comment"># compute polynomials</span><br>    gg = []<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm):<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(dd):<br>            gg.append((x * XX) ** jj * modulus ** (mm - ii) * polZ(x * XX) ** ii)<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(tt):<br>        gg.append((x * XX) ** ii * polZ(x * XX) ** mm)<br><br>    <span class="hljs-comment"># construct lattice B</span><br>    BB = Matrix(ZZ, nn)<br><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ii + <span class="hljs-number">1</span>):<br>            BB[ii, jj] = gg[ii][jj]<br><br>    BB = BB.LLL()<br><br>    <span class="hljs-comment"># transform shortest vector in polynomial</span><br>    new_pol = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>        new_pol += x ** ii * BB[<span class="hljs-number">0</span>, ii] / XX ** ii<br><br>    <span class="hljs-comment"># factor polynomial</span><br>    potential_roots = new_pol.roots()<br><br>    <span class="hljs-comment"># test roots</span><br>    roots = []<br>    <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> potential_roots:<br>        <span class="hljs-keyword">if</span> root[<span class="hljs-number">0</span>].is_integer():<br>            result = polZ(ZZ(root[<span class="hljs-number">0</span>]))<br>            <span class="hljs-keyword">if</span> gcd(modulus, result) &gt;= modulus ** beta:<br>                roots.append(ZZ(root[<span class="hljs-number">0</span>]))<br>    <span class="hljs-keyword">return</span> roots<br><br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">M, n, a, m</span>):<br>    <span class="hljs-comment"># I need to import it in the function otherwise multiprocessing doesn&#x27;t find it in its context</span><br>    base = <span class="hljs-built_in">int</span>(<span class="hljs-number">65537</span>)<br>    <span class="hljs-comment"># the known part of p: 65537^a * M^-1 (mod N)</span><br>    known = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(base, a, M) * inverse_mod(M, n))<br>    <span class="hljs-comment"># Create the polynom f(x)</span><br>    F = PolynomialRing(Zmod(n), implementation=<span class="hljs-string">&#x27;NTL&#x27;</span>, names=(<span class="hljs-string">&#x27;x&#x27;</span>,))<br>    (x,) = F._first_ngens(<span class="hljs-number">1</span>)<br>    pol = x + known<br>    beta = <span class="hljs-number">0.1</span><br>    t = m+<span class="hljs-number">1</span><br>    <span class="hljs-comment"># Upper bound for the small root x0</span><br>    XX = floor(<span class="hljs-number">2</span> * n**<span class="hljs-number">0.5</span> / M)<br>    <span class="hljs-comment"># Find a small root (x0 = k) using Coppersmith&#x27;s algorithm</span><br>    roots = coppersmith_howgrave_univariate(pol, n, beta, m, t, XX)<br>    <span class="hljs-comment"># There will be no roots for an incorrect guess of a.</span><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> roots:<br>        <span class="hljs-comment"># reconstruct p from the recovered k</span><br>        p = <span class="hljs-built_in">int</span>(k*M + <span class="hljs-built_in">pow</span>(base, a, M))<br>        <span class="hljs-keyword">if</span> n%p == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> p, n//p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">roca</span>(<span class="hljs-params">n</span>):<br>    keySize = n.bit_length()<br>    <span class="hljs-keyword">if</span> keySize &lt;= <span class="hljs-number">960</span>:<br>        M_prime = <span class="hljs-number">0x1b3e6c9433a7735fa5fc479ffe4027e13bea</span><br>        m = <span class="hljs-number">5</span><br><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">992</span> &lt;= keySize &lt;= <span class="hljs-number">1952</span>:<br>        M_prime = <span class="hljs-number">0x24683144f41188c2b1d6a217f81f12888e4e6513c43f3f60e72af8bd9728807483425d1e</span><br>        m = <span class="hljs-number">4</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Have you several days/months to spend on this ?&quot;</span>)<br><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">1984</span> &lt;= keySize &lt;= <span class="hljs-number">3936</span>:<br>        M_prime = <span class="hljs-number">0x16928dc3e47b44daf289a60e80e1fc6bd7648d7ef60d1890f3e0a9455efe0abdb7a748131413cebd2e36a76a355c1b664be462e115ac330f9c13344f8f3d1034a02c23396e6</span><br>        m = <span class="hljs-number">7</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You&#x27;ll change computer before this scripts ends...&quot;</span>)<br><br>    <span class="hljs-keyword">elif</span> <span class="hljs-number">3968</span> &lt;= keySize &lt;= <span class="hljs-number">4096</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Just no.&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Invalid key size: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(keySize))<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>    a3 = Zmod(M_prime)(n).log(<span class="hljs-number">65537</span>)<br>    order = Zmod(M_prime)(<span class="hljs-number">65537</span>).multiplicative_order()<br>    inf = a3 // <span class="hljs-number">2</span><br>    sup = (a3 + order) // <span class="hljs-number">2</span><br><br>    <span class="hljs-comment"># Search 10 000 values at a time, using multiprocess</span><br>    <span class="hljs-comment"># too big chunks is slower, too small chunks also</span><br>    chunk_size = <span class="hljs-number">10000</span><br>    <span class="hljs-keyword">for</span> inf_a <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(inf, sup, chunk_size):<br>        <span class="hljs-comment"># create an array with the parameter for the solve function</span><br>        inputs = [((M_prime, n, a, m), &#123;&#125;) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(inf_a, inf_a+chunk_size)]<br>        <span class="hljs-comment"># the sage builtin multiprocessing stuff</span><br>        <span class="hljs-keyword">from</span> sage.parallel.multiprocessing_sage <span class="hljs-keyword">import</span> parallel_iter<br>        <span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> cpu_count<br><br>        <span class="hljs-keyword">for</span> k, val <span class="hljs-keyword">in</span> parallel_iter(cpu_count(), solve, inputs):<br>            <span class="hljs-keyword">if</span> val:<br>                p = val[<span class="hljs-number">0</span>]<br>                q = val[<span class="hljs-number">1</span>]<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;found factorization:\np=&#123;&#125;\nq=&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(p, q))<br>                <span class="hljs-keyword">return</span> val<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    n = <span class="hljs-number">787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241</span><br>    roca(n)<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š<img src="/2025/02/21/Hgame25/2.png" alt="2"></p><p>flagï¼š<code>hgame&#123;ROCA_ROCK_and_ROll!&#125;</code></p><p>çœ‹å®Œç¬¬äºŒä¸ªå¼€å§‹é¢„æ„Ÿæƒ…å†µä¸å¦™äº†</p><h2 id="3-Intergalactic-Bound-7pts-45sol"><a href="#3-Intergalactic-Bound-7pts-45sol" class="headerlink" title="3.Intergalactic Bound(7pts,45sol)"></a>3.Intergalactic Bound(7pts,45sol)</h2><p>å¥½å®¶ä¼™ï¼Œè¿™åˆæ˜¯ä¸ªå•¥é¢˜ï¼ŸTHCurveåˆæ˜¯å•¥ï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_THCurve</span>(<span class="hljs-params">P, Q</span>):<br>    <span class="hljs-keyword">if</span> P == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> Q<br>    <span class="hljs-keyword">if</span> Q == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> P<br>    x1, y1 = P<br>    x2, y2 = Q<br>    x3 = (x1 - y1 ** <span class="hljs-number">2</span> * x2 * y2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    y3 = (y1 * y2 ** <span class="hljs-number">2</span> - a * x1 ** <span class="hljs-number">2</span> * x2) * <span class="hljs-built_in">pow</span>(a * x1 * y1 * x2 ** <span class="hljs-number">2</span> - y2, -<span class="hljs-number">1</span>, p) % p<br>    <span class="hljs-keyword">return</span> x3, y3<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_THCurve</span>(<span class="hljs-params">n, P</span>):<br>    R = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">while</span> n &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            R = add_THCurve(R, P)<br>        P = add_THCurve(P, P)<br>        n = n // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> R<br><br><br>p = getPrime(<span class="hljs-number">96</span>)<br>a = randint(<span class="hljs-number">1</span>, p)<br>G = (randint(<span class="hljs-number">1</span>,p), randint(<span class="hljs-number">1</span>,p))<br>d = (a*G[<span class="hljs-number">0</span>]^<span class="hljs-number">3</span>+G[<span class="hljs-number">1</span>]^<span class="hljs-number">3</span>+<span class="hljs-number">1</span>)%p*inverse(G[<span class="hljs-number">0</span>]*G[<span class="hljs-number">1</span>],p)%p<br>x = randint(<span class="hljs-number">1</span>, p)<br>Q = mul_THCurve(x, G)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;G = <span class="hljs-subst">&#123;G&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Q = <span class="hljs-subst">&#123;Q&#125;</span>&quot;</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(x).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = pad(flag,<span class="hljs-number">16</span>)<br>ciphertext = cipher.encrypt(flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext=<span class="hljs-subst">&#123;ciphertext&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p = 55099055368053948610276786301</span><br><span class="hljs-string">G = (19663446762962927633037926740, 35074412430915656071777015320)</span><br><span class="hljs-string">Q = (26805137673536635825884330180, 26376833112609309475951186883)</span><br><span class="hljs-string">ciphertext=b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ç„¶åè‡ªå·±å»æŸ¥äº†ä¸€ä¸‹ï¼ŒåŸæ¥è¿™ç§Curveçš„å½¢å¼æ˜¯ï¼š<br>$$<br>ax^3+y^3+1&#x3D;dxy<br>$$<br>å‘ƒï¼Œå¥‡æ€ªçš„çŸ¥è¯†åˆå¢åŠ äº†ã€‚</p><p>ç„¶åæœTHCurveï¼Œæœåˆ°äº†ç¾ŠåŸæ¯æœ‰è¿‡ç±»ä¼¼çš„é¢˜ç›®ï¼Œå°±æ˜¯æŠŠè¿™ä¸ªæ›²çº¿è½¬æˆæ¤­åœ†æ›²çº¿çš„å½¢å¼ï¼Œç„¶ååšç¦»æ•£å¯¹æ•°å°±OKäº†ã€‚</p><p><del>æ‰€ä»¥è¿™ä¸ªé¢˜æœ€éš¾çš„è¿˜æ˜¯ææ‡‚è¿™æ˜¯ä¸ªå•¥æ›²çº¿ï¼Œç„¶åæ€ä¹ˆè½¬æˆæ¤­åœ†æ›²çº¿</del>ã€‚</p><p>ä»£ç å°±ç›´æ¥å·ç½‘ä¸Šç¾ŠåŸæ¯é‚£ä¸ªé¢˜çš„wpäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <span class="hljs-number">55099055368053948610276786301</span><br>G = (<span class="hljs-number">19663446762962927633037926740</span>, <span class="hljs-number">35074412430915656071777015320</span>)<br>Q = (<span class="hljs-number">26805137673536635825884330180</span>, <span class="hljs-number">26376833112609309475951186883</span>)<br>ciphertext=<span class="hljs-string">b&quot;k\xe8\xbe\x94\x9e\xfc\xe2\x9e\x97\xe5\xf3\x04&#x27;\x8f\xb2\x01T\x06\x88\x04\xeb3Jl\xdd Pk$\x00:\xf5&quot;</span><br>Gx,Gy=G<br>Qx,Qy=Q<br>M=matrix(GF(p),[[-Gx**<span class="hljs-number">3</span>,Gx*Gy],[-Qx**<span class="hljs-number">3</span>,Qx*Qy]])<br>y=vector(GF(p),[Gy**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>,Qy**<span class="hljs-number">3</span>+<span class="hljs-number">1</span>])<br>a,d=M.solve_right(y)<br><span class="hljs-built_in">print</span>(a,d)<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_coefficients</span>(<span class="hljs-params">a, d</span>):<br>    d_3 = d*inverse(<span class="hljs-number">3</span>, p)%p             <span class="hljs-comment"># d / 3</span><br>    tmp = a - d_3**<span class="hljs-number">3</span>                    <span class="hljs-comment"># a - d^3/27</span><br>    a0 = <span class="hljs-number">1</span><br>    a1 = (-<span class="hljs-number">3</span> * d_3 * inverse(tmp, p))%p<br>    a3 = (-<span class="hljs-number">9</span> * inverse(tmp**<span class="hljs-number">2</span>, p)) % p<br>    a2 = (-<span class="hljs-number">9</span> * d_3**<span class="hljs-number">2</span> * inverse(tmp**<span class="hljs-number">2</span>, p))%p<br>    a4 = (-<span class="hljs-number">27</span> * d_3 * inverse(tmp**<span class="hljs-number">3</span>, p))%p<br>    a6 = (-<span class="hljs-number">27</span> * inverse(tmp**<span class="hljs-number">4</span>, p))%p<br>    <br>    <span class="hljs-keyword">return</span> [a1, a2, a3, a4, a6]<br><br>aa = calculate_coefficients(a, d)<br>E = EllipticCurve(GF(p), aa)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Herssian_to_Weierstrass</span>(<span class="hljs-params">Point</span>):<br>    x, y = Point<br>    u = ((-<span class="hljs-number">3</span> * inverse((a - d^<span class="hljs-number">3</span>*inverse(<span class="hljs-number">27</span>, p)), p)*x * inverse(d*x*inverse(<span class="hljs-number">3</span>,p) - (-y) + <span class="hljs-number">1</span>, p))) % p<br>    v = ((-<span class="hljs-number">9</span> * inverse((a - d^<span class="hljs-number">3</span>*inverse(<span class="hljs-number">27</span>, p))^<span class="hljs-number">2</span>, p) ) * (-y) * inverse(d*x*inverse(<span class="hljs-number">3</span>,p) - (-y) + <span class="hljs-number">1</span>, p))%p<br>    <span class="hljs-keyword">return</span> (u, v)<br><br><br>G = E(Herssian_to_Weierstrass(G))<br>Q = E(Herssian_to_Weierstrass(Q))<br>k = discrete_log(Q,G,operation=<span class="hljs-string">&#x27;+&#x27;</span>)<br><span class="hljs-built_in">print</span>(k)<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>key=sha256(<span class="hljs-built_in">str</span>(k).encode()).digest()<br>aes=AES.new(key,AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(aes.decrypt(ciphertext))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">39081810733380615260725035189 8569490478014112404683314361</span><br><span class="hljs-string">2633177798829352921583206736</span><br><span class="hljs-string">b&#x27;hgame&#123;N0th1ng_bu7_up_Up_UP!&#125;\x04\x04\x04\x04&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="4-ezBag-7pts-75sol"><a href="#4-ezBag-7pts-75sol" class="headerlink" title="4.ezBag(7pts,75sol)"></a>4.ezBag(7pts,75sol)</h2><p>ç»ˆäºè§åˆ°ä¸€ä¸ªè¿˜ç®—ç†Ÿæ‚‰çš„é¢˜äº†ï¼ŒèƒŒåŒ…é—®é¢˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-built_in">list</span> = []<br>bag = []<br>p=random.getrandbits(<span class="hljs-number">64</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:])==<span class="hljs-number">64</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    t = p<br>    a=[getPrime(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    b=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>        temp=t%<span class="hljs-number">2</span><br>        b+=temp*i<br>        t=t&gt;&gt;<span class="hljs-number">1</span><br>    <span class="hljs-built_in">list</span>.append(a)<br>    bag.append(b)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;list=<span class="hljs-subst">&#123;<span class="hljs-built_in">list</span>&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;bag=<span class="hljs-subst">&#123;bag&#125;</span>&#x27;</span>)<br><br>key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br>flag = pad(flag,<span class="hljs-number">16</span>)<br>ciphertext = cipher.encrypt(flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext=<span class="hljs-subst">&#123;ciphertext&#125;</span>&quot;</span>)<br><span class="hljs-built_in">list</span>=[[<span class="hljs-number">2826962231</span>, <span class="hljs-number">3385780583</span>, <span class="hljs-number">3492076631</span>, <span class="hljs-number">3387360133</span>, <span class="hljs-number">2955228863</span>, <span class="hljs-number">2289302839</span>, <span class="hljs-number">2243420737</span>, <span class="hljs-number">4129435549</span>, <span class="hljs-number">4249730059</span>, <span class="hljs-number">3553886213</span>, <span class="hljs-number">3506411549</span>, <span class="hljs-number">3658342997</span>, <span class="hljs-number">3701237861</span>, <span class="hljs-number">4279828309</span>, <span class="hljs-number">2791229339</span>, <span class="hljs-number">4234587439</span>, <span class="hljs-number">3870221273</span>, <span class="hljs-number">2989000187</span>, <span class="hljs-number">2638446521</span>, <span class="hljs-number">3589355327</span>, <span class="hljs-number">3480013811</span>, <span class="hljs-number">3581260537</span>, <span class="hljs-number">2347978027</span>, <span class="hljs-number">3160283047</span>, <span class="hljs-number">2416622491</span>, <span class="hljs-number">2349924443</span>, <span class="hljs-number">3505689469</span>, <span class="hljs-number">2641360481</span>, <span class="hljs-number">3832581799</span>, <span class="hljs-number">2977968451</span>, <span class="hljs-number">4014818999</span>, <span class="hljs-number">3989322037</span>, <span class="hljs-number">4129732829</span>, <span class="hljs-number">2339590901</span>, <span class="hljs-number">2342044303</span>, <span class="hljs-number">3001936603</span>, <span class="hljs-number">2280479471</span>, <span class="hljs-number">3957883273</span>, <span class="hljs-number">3883572877</span>, <span class="hljs-number">3337404269</span>, <span class="hljs-number">2665725899</span>, <span class="hljs-number">3705443933</span>, <span class="hljs-number">2588458577</span>, <span class="hljs-number">4003429009</span>, <span class="hljs-number">2251498177</span>, <span class="hljs-number">2781146657</span>, <span class="hljs-number">2654566039</span>, <span class="hljs-number">2426941147</span>, <span class="hljs-number">2266273523</span>, <span class="hljs-number">3210546259</span>, <span class="hljs-number">4225393481</span>, <span class="hljs-number">2304357101</span>, <span class="hljs-number">2707182253</span>, <span class="hljs-number">2552285221</span>, <span class="hljs-number">2337482071</span>, <span class="hljs-number">3096745679</span>, <span class="hljs-number">2391352387</span>, <span class="hljs-number">2437693507</span>, <span class="hljs-number">3004289807</span>, <span class="hljs-number">3857153537</span>, <span class="hljs-number">3278380013</span>, <span class="hljs-number">3953239151</span>, <span class="hljs-number">3486836107</span>, <span class="hljs-number">4053147071</span>], [<span class="hljs-number">2241199309</span>, <span class="hljs-number">3658417261</span>, <span class="hljs-number">3032816659</span>, <span class="hljs-number">3069112363</span>, <span class="hljs-number">4279647403</span>, <span class="hljs-number">3244237531</span>, <span class="hljs-number">2683855087</span>, <span class="hljs-number">2980525657</span>, <span class="hljs-number">3519354793</span>, <span class="hljs-number">3290544091</span>, <span class="hljs-number">2939387147</span>, <span class="hljs-number">3669562427</span>, <span class="hljs-number">2985644621</span>, <span class="hljs-number">2961261073</span>, <span class="hljs-number">2403815549</span>, <span class="hljs-number">3737348917</span>, <span class="hljs-number">2672190887</span>, <span class="hljs-number">2363609431</span>, <span class="hljs-number">3342906361</span>, <span class="hljs-number">3298900981</span>, <span class="hljs-number">3874372373</span>, <span class="hljs-number">4287595129</span>, <span class="hljs-number">2154181787</span>, <span class="hljs-number">3475235893</span>, <span class="hljs-number">2223142793</span>, <span class="hljs-number">2871366073</span>, <span class="hljs-number">3443274743</span>, <span class="hljs-number">3162062369</span>, <span class="hljs-number">2260958543</span>, <span class="hljs-number">3814269959</span>, <span class="hljs-number">2429223151</span>, <span class="hljs-number">3363270901</span>, <span class="hljs-number">2623150861</span>, <span class="hljs-number">2424081661</span>, <span class="hljs-number">2533866931</span>, <span class="hljs-number">4087230569</span>, <span class="hljs-number">2937330469</span>, <span class="hljs-number">3846105271</span>, <span class="hljs-number">3805499729</span>, <span class="hljs-number">4188683131</span>, <span class="hljs-number">2804029297</span>, <span class="hljs-number">2707569353</span>, <span class="hljs-number">4099160981</span>, <span class="hljs-number">3491097719</span>, <span class="hljs-number">3917272979</span>, <span class="hljs-number">2888646377</span>, <span class="hljs-number">3277908071</span>, <span class="hljs-number">2892072971</span>, <span class="hljs-number">2817846821</span>, <span class="hljs-number">2453222423</span>, <span class="hljs-number">3023690689</span>, <span class="hljs-number">3533440091</span>, <span class="hljs-number">3737441353</span>, <span class="hljs-number">3941979749</span>, <span class="hljs-number">2903000761</span>, <span class="hljs-number">3845768239</span>, <span class="hljs-number">2986446259</span>, <span class="hljs-number">3630291517</span>, <span class="hljs-number">3494430073</span>, <span class="hljs-number">2199813137</span>, <span class="hljs-number">2199875113</span>, <span class="hljs-number">3794307871</span>, <span class="hljs-number">2249222681</span>, <span class="hljs-number">2797072793</span>], [<span class="hljs-number">4263404657</span>, <span class="hljs-number">3176466407</span>, <span class="hljs-number">3364259291</span>, <span class="hljs-number">4201329877</span>, <span class="hljs-number">3092993861</span>, <span class="hljs-number">2771210963</span>, <span class="hljs-number">3662055773</span>, <span class="hljs-number">3124386037</span>, <span class="hljs-number">2719229677</span>, <span class="hljs-number">3049601453</span>, <span class="hljs-number">2441740487</span>, <span class="hljs-number">3404893109</span>, <span class="hljs-number">3327463897</span>, <span class="hljs-number">3742132553</span>, <span class="hljs-number">2833749769</span>, <span class="hljs-number">2661740833</span>, <span class="hljs-number">3676735241</span>, <span class="hljs-number">2612560213</span>, <span class="hljs-number">3863890813</span>, <span class="hljs-number">3792138377</span>, <span class="hljs-number">3317100499</span>, <span class="hljs-number">2967600989</span>, <span class="hljs-number">2256580343</span>, <span class="hljs-number">2471417173</span>, <span class="hljs-number">2855972923</span>, <span class="hljs-number">2335151887</span>, <span class="hljs-number">3942865523</span>, <span class="hljs-number">2521523309</span>, <span class="hljs-number">3183574087</span>, <span class="hljs-number">2956241693</span>, <span class="hljs-number">2969535607</span>, <span class="hljs-number">2867142053</span>, <span class="hljs-number">2792698229</span>, <span class="hljs-number">3058509043</span>, <span class="hljs-number">3359416111</span>, <span class="hljs-number">3375802039</span>, <span class="hljs-number">2859136043</span>, <span class="hljs-number">3453019013</span>, <span class="hljs-number">3817650721</span>, <span class="hljs-number">2357302273</span>, <span class="hljs-number">3522135839</span>, <span class="hljs-number">2997389687</span>, <span class="hljs-number">3344465713</span>, <span class="hljs-number">2223415097</span>, <span class="hljs-number">2327459153</span>, <span class="hljs-number">3383532121</span>, <span class="hljs-number">3960285331</span>, <span class="hljs-number">3287780827</span>, <span class="hljs-number">4227379109</span>, <span class="hljs-number">3679756219</span>, <span class="hljs-number">2501304959</span>, <span class="hljs-number">4184540251</span>, <span class="hljs-number">3918238627</span>, <span class="hljs-number">3253307467</span>, <span class="hljs-number">3543627671</span>, <span class="hljs-number">3975361669</span>, <span class="hljs-number">3910013423</span>, <span class="hljs-number">3283337633</span>, <span class="hljs-number">2796578957</span>, <span class="hljs-number">2724872291</span>, <span class="hljs-number">2876476727</span>, <span class="hljs-number">4095420767</span>, <span class="hljs-number">3011805113</span>, <span class="hljs-number">2620098961</span>], [<span class="hljs-number">2844773681</span>, <span class="hljs-number">3852689429</span>, <span class="hljs-number">4187117513</span>, <span class="hljs-number">3608448149</span>, <span class="hljs-number">2782221329</span>, <span class="hljs-number">4100198897</span>, <span class="hljs-number">3705084667</span>, <span class="hljs-number">2753126641</span>, <span class="hljs-number">3477472717</span>, <span class="hljs-number">3202664393</span>, <span class="hljs-number">3422548799</span>, <span class="hljs-number">3078632299</span>, <span class="hljs-number">3685474021</span>, <span class="hljs-number">3707208223</span>, <span class="hljs-number">2626532549</span>, <span class="hljs-number">3444664807</span>, <span class="hljs-number">4207188437</span>, <span class="hljs-number">3422586733</span>, <span class="hljs-number">2573008943</span>, <span class="hljs-number">2992551343</span>, <span class="hljs-number">3465105079</span>, <span class="hljs-number">4260210347</span>, <span class="hljs-number">3108329821</span>, <span class="hljs-number">3488033819</span>, <span class="hljs-number">4092543859</span>, <span class="hljs-number">4184505881</span>, <span class="hljs-number">3742701763</span>, <span class="hljs-number">3957436129</span>, <span class="hljs-number">4275123371</span>, <span class="hljs-number">3307261673</span>, <span class="hljs-number">2871806527</span>, <span class="hljs-number">3307283633</span>, <span class="hljs-number">2813167853</span>, <span class="hljs-number">2319911773</span>, <span class="hljs-number">3454612333</span>, <span class="hljs-number">4199830417</span>, <span class="hljs-number">3309047869</span>, <span class="hljs-number">2506520867</span>, <span class="hljs-number">3260706133</span>, <span class="hljs-number">2969837513</span>, <span class="hljs-number">4056392609</span>, <span class="hljs-number">3819612583</span>, <span class="hljs-number">3520501211</span>, <span class="hljs-number">2949984967</span>, <span class="hljs-number">4234928149</span>, <span class="hljs-number">2690359687</span>, <span class="hljs-number">3052841873</span>, <span class="hljs-number">4196264491</span>, <span class="hljs-number">3493099081</span>, <span class="hljs-number">3774594497</span>, <span class="hljs-number">4283835373</span>, <span class="hljs-number">2753384371</span>, <span class="hljs-number">2215041107</span>, <span class="hljs-number">4054564757</span>, <span class="hljs-number">4074850229</span>, <span class="hljs-number">2936529709</span>, <span class="hljs-number">2399732833</span>, <span class="hljs-number">3078232933</span>, <span class="hljs-number">2922467927</span>, <span class="hljs-number">3832061581</span>, <span class="hljs-number">3871240591</span>, <span class="hljs-number">3526620683</span>, <span class="hljs-number">2304071411</span>, <span class="hljs-number">3679560821</span>]]<br>bag=[<span class="hljs-number">123342809734</span>, <span class="hljs-number">118191282440</span>, <span class="hljs-number">119799979406</span>, <span class="hljs-number">128273451872</span>]<br>ciphertext=<span class="hljs-string">b&#x27;\x1d6\xcc&#125;\x07\xfa7G\xbd\x01\xf0P4^Q&quot;\x85\x9f\xac\x98\x8f#\xb2\x12\xf4+\x05`\x80\x1a\xfa !\x9b\xa5\xc7g\xa8b\x89\x93\x1e\xedz\xd2M;\xa2&#x27;</span><br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™äº† $4$ ç»„æ•°æ®ï¼Œæ„æˆäº†ä¸€ä¸ª $64$ ä½çš„èƒŒåŒ…é—®é¢˜ï¼Œè¦æ±‚å‡ºå¯†é’¥è§£å¾—flagã€‚</p><p>èƒŒåŒ…é—®é¢˜çš„æ ¼æ„é€ æ–¹æ³•åœ¨ 2021 å¹´çš„ LatticeNotes5 ä¸­å·²ç»æåˆ°è¿‡äº†ï¼Œå›é¡¾ä¸€ä¸‹ï¼š</p><p><img src="/2025/02/21/Hgame25/3.png" alt="3"></p><p>ä¸Šé¢çš„çŸ©é˜µä¸­ï¼š$E$ ä¸ºå•ä½çŸ©é˜µï¼Œ$\vec a$ ä¸ºæ¯ä¸ªç‰©å“é‡é‡çš„åˆ—å‘é‡ï¼Œ$\vec 1$ ä¸ºå…¨ $1$ å‘é‡ï¼Œ$b$ ä¸ºç‰©å“é‡é‡ä¹‹å’Œã€‚å¯¹ $M$ è¿›è¡ŒLLLï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªæœ€åä¸€ä¸ªåˆ†é‡ä¸º $0$ï¼Œå…¶ä»–åˆ†é‡åªæœ‰ $-1$ å’Œ $1$ çš„å‘é‡ï¼Œåˆ†åˆ«å¯¹åº”ç€ $1$ å’Œ $0$ã€‚</p><p>è¿™è¾¹æ’æ’­ä¸€å¥ï¼šå…¶å®ä¹Ÿå¯ä»¥å°† $2E$ æ¢æˆ $E$ï¼Œ$\vec 1$ æ¢æˆ $\vec 0$ï¼Œ$b$ æ¢ä¸º $-b$ï¼Œè¿™æ ·è§£å‡ºæ¥çš„å°±æ°å¥½æ˜¯å‘é‡ $0,1$ã€‚ä½†äº‹å®ä¸Šï¼Œè¿™ç§æ„é€ æ–¹æ³•å¹¶ä¸å¸¸ç”¨ï¼Œå› ä¸ºè¿™æ ·æ„é€ ä¼šå°†è¡Œåˆ—å¼çš„å€¼ç¼©å°ä¸ºåŸæ¥çš„ä¸€åŠï¼Œé™ä½è§£å‡ºç›®æ ‡å‘é‡çš„æ¦‚ç‡ï¼ˆè¿™ä¸ªæ€æƒ³åé¢ä¸€ä¸ªé¢˜ä¹Ÿä¼šç”¨åˆ°ï¼‰ã€‚</p><p>ç„¶è€Œï¼Œé¢˜ç›®ç»™äº† $4$ ç»„æ•°æ®ï¼Œé‚£ä¹ˆæ„é€ çš„çŸ©é˜µå°±æ˜¯</p><p><img src="/2025/02/21/Hgame25/4.png" alt="4"></p><p>ç„¶è€Œï¼Œå³ä½¿æ˜¯è¿™æ ·ï¼Œä»ç„¶è§£ä¸å‡ºæ­£ç¡®å‘é‡ã€‚è€ƒè™‘åˆ°æœ€å 4 åˆ—åœ¨ç›®æ ‡å‘é‡ä¸­çš„åˆ†é‡ä¸º $0$ã€‚å› æ­¤å¯ä»¥ç»™æœ€å 4 åˆ—ä¹˜ä¸Š $2^{2000}$ï¼Œå¼ºè¡Œå¢åŠ æœ€åå››åˆ—æƒé‡ï¼Œè§£å¾—æœ€çŸ­å‘é‡å³ä¸ºç›®æ ‡å‘é‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>a=<span class="hljs-comment">#é¢˜ç›®ä¸­ç»™å‡ºçš„list</span><br>bag=[<span class="hljs-number">123342809734</span>, <span class="hljs-number">118191282440</span>, <span class="hljs-number">119799979406</span>, <span class="hljs-number">128273451872</span>]<br>ciphertext=<span class="hljs-string">b&#x27;\x1d6\xcc&#125;\x07\xfa7G\xbd\x01\xf0P4^Q&quot;\x85\x9f\xac\x98\x8f#\xb2\x12\xf4+\x05`\x80\x1a\xfa !\x9b\xa5\xc7g\xa8b\x89\x93\x1e\xedz\xd2M;\xa2&#x27;</span><br>M=block_matrix(ZZ,[<br>    [<span class="hljs-number">2</span>*identity_matrix(<span class="hljs-number">64</span>),matrix(a).T],<br>    [matrix([<span class="hljs-number">1</span>]*<span class="hljs-number">64</span>),matrix(bag)]<br>])<br>B=diagonal_matrix([<span class="hljs-number">1</span>]*<span class="hljs-number">64</span>+[<span class="hljs-number">2</span>**<span class="hljs-number">2000</span>]*<span class="hljs-number">4</span>)<br>M3L=(M*B).LLL()*(B**-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> vec <span class="hljs-keyword">in</span> M3L:<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">max</span>(vec)==<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">min</span>(vec)==-<span class="hljs-number">1</span>):<br>        <span class="hljs-built_in">print</span>(vec)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-comment">#(-1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, 1, -1, 1, 1, -1, 1, 1, -1, -1, 1, -1, -1, 1, -1, 1, -1, -1, -1, 1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, -1, 0, 0, 0, 0)</span><br><br>mask=<span class="hljs-number">2</span>**<span class="hljs-number">64</span>-<span class="hljs-number">1</span><br>s=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>    s+=((vec[i]==-<span class="hljs-number">1</span>)&lt;&lt;i)<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br>key = sha256(<span class="hljs-built_in">str</span>(s).encode()).digest()<br>aes = AES.new(key, AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(aes.decrypt(ciphertext))<br><span class="hljs-comment">#17739748707559623655</span><br><span class="hljs-comment">#b&#x27;hgame&#123;A_S1mple_Modul@r_Subset_Sum_Problem&#125;\x06\x06\x06\x06\x06\x06&#x27;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªmaskè™½ç„¶æ²¡ç”¨åˆ°ï¼Œä½†å…¶å®æœ‰çš„æ—¶å€™ä¹Ÿæ˜¯ä¼šç”¨åˆ°çš„ï¼šå› ä¸ºç›®æ ‡å‘é‡æœ‰æ—¶ä¼šå¤šä¸ª $-1$ çš„ç³»æ•°ï¼Œå¯¼è‡´è§£å‡ºçš„æ¯”ç‰¹å…¨æ˜¯åçš„ï¼Œç¬¬ä¸€éå¾—ä¸åˆ°ç»“æœã€‚å¦‚æœå‡ºç°è¿™ç§æƒ…å½¢ï¼Œç›´æ¥å¼‚æˆ–ä¸€ä¸‹maskï¼Œå°±ç»™æ¯”ç‰¹å…¨ç¿»è½¬å›æ¥äº†ï¼</p><h2 id="5-sieve-7pts-140sol"><a href="#5-sieve-7pts-140sol" class="headerlink" title="5.sieve (7pts,140sol)"></a>5.sieve (7pts,140sol)</h2><p>ä¸€çœ‹å°±æ˜¯ä¸ªoiâœŒå‡ºçš„é¢˜ï¼Œå¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬è¦æ±‚å‡º $65537^2&#x2F;6$ å†…çš„ç´ æ•°ä¸ªæ•°å’Œæ‰€æœ‰æ•°å­—çš„ç´ æ•°ä¸ªæ•°å’Œæ¬§æ‹‰å‡½æ•°ä¹‹å’Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><br>FLAG = <span class="hljs-string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span><br>m = bytes_to_long(FLAG)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trick</span>(<span class="hljs-params">k</span>):<br>    <span class="hljs-keyword">if</span> k &gt; <span class="hljs-number">1</span>:<br>        mul = prod(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,k)) <br>        <span class="hljs-keyword">if</span> k - mul % k - <span class="hljs-number">1</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> euler_phi(k) + trick(k-<span class="hljs-number">1</span>) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> euler_phi(k) + trick(k-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><br>e = <span class="hljs-number">65537</span><br>p = q = nextprime(trick(e^<span class="hljs-number">2</span>//<span class="hljs-number">6</span>)&lt;&lt;<span class="hljs-number">128</span>)<br>n = p * q<br>enc = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br><span class="hljs-comment">#enc=2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span><br></code></pre></td></tr></table></figure><p>å› æ­¤æ­£è§£æ˜¯ç´ æ•°ç­›å’Œæœæ•™ç­›ï¼Œä½†åè€…æˆ‘ä¸ä¼šå†™ï¼Œè€ƒè™‘åˆ°è¿™ä¸ªå€¼ä¸º $715849728$ï¼Œå¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œå¯ä»¥ç”¨ $O(n\log n)$  çš„å¤æ‚åº¦é€ä¸ªæ±‚è§£ã€‚</p><p>ä¸è¿‡æ®è¯´sageä¸­å¯ä»¥ç›´æ¥æšä¸¾ <code>euler_phi</code> å¹¶æ±‚å’Œï¼Œåœ¨æœåŠ¡å™¨ä¸Šå•æ ¸è·‘çš„æ—¶é—´ä¸º 40 åˆ†é’Ÿå·¦å³ï¼Œåæ­£ä¹Ÿèƒ½å‡ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> N = <span class="hljs-number">715849728</span>;<br><span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> M = <span class="hljs-number">26760</span>;<br><span class="hljs-type">bool</span> isPrime[N + <span class="hljs-number">1</span>];<br><span class="hljs-type">unsigned</span> *eulerPhi = <span class="hljs-keyword">new</span> <span class="hljs-type">unsigned</span> [N + <span class="hljs-number">1</span>];<br><span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> S = <span class="hljs-number">0ULL</span>;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> T = <span class="hljs-number">0ULL</span>;<br><span class="hljs-type">unsigned</span> *primes = <span class="hljs-keyword">new</span> <span class="hljs-type">unsigned</span>[<span class="hljs-number">40000000</span>];  <br><span class="hljs-type">int</span> primeCount = <span class="hljs-number">0</span>;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(isPrime, <span class="hljs-number">1</span>, <span class="hljs-built_in">sizeof</span>(isPrime));<br>    isPrime[<span class="hljs-number">0</span>] = isPrime[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= M; i++) &#123;<br>        <span class="hljs-keyword">if</span> (isPrime[i]) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">2</span> * i; j &lt;= N; j += i) &#123;<br>                isPrime[j] = <span class="hljs-number">0</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= N; i++) &#123;<br>        <span class="hljs-keyword">if</span> (isPrime[i]) &#123;<br>            primes[primeCount++] = i;<br>        &#125;<br>    &#125;<br>    S = primeCount;  <span class="hljs-comment">// ç›´æ¥å­˜å‚¨è´¨æ•°æ•°é‡</span><br>    cout&lt;&lt;S&lt;&lt;endl;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= N; i++) &#123;<br>        eulerPhi[i] = i;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; S; i++) &#123;<br>        <span class="hljs-type">unsigned</span> p = primes[i];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">unsigned</span> j = p; j &lt;= N; j += p) &#123;<br>            <span class="hljs-keyword">if</span>(eulerPhi[j]%p!=<span class="hljs-number">0</span>) cout&lt;&lt;<span class="hljs-string">&quot;ERROR&quot;</span>&lt;&lt;endl;<br>            <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> tmp=eulerPhi[j]/p;<br>            <span class="hljs-keyword">if</span>(tmp*(p<span class="hljs-number">-1</span>)&gt;<span class="hljs-number">0xFFFFFFFFULL</span>) cout&lt;&lt;<span class="hljs-string">&quot;ERROR&quot;</span>&lt;&lt;endl;<br>            eulerPhi[j] = <span class="hljs-number">1ULL</span>*tmp*(p<span class="hljs-number">-1</span>);  <span class="hljs-comment">// é¿å…é‡å¤ä¹˜é™¤ï¼Œæé«˜ç²¾åº¦</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= N; i++) &#123;<br>        T += eulerPhi[i];<br>    &#125;<br><br>    cout &lt;&lt; T &lt;&lt; endl;<br><br>    <span class="hljs-keyword">delete</span>[] eulerPhi;<br>    <span class="hljs-keyword">delete</span>[] primes;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">37030583</span><br><span class="hljs-comment">155763335410704472</span><br><span class="hljs-comment">40s,3.5GB</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p>æ±‚å‡ºéœ€è¦çš„ä¸¤ä¸ªå€¼ä¹‹åï¼Œç›´æ¥è§£å°±OKäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>p = q = next_prime((<span class="hljs-number">155763335410704472</span>+<span class="hljs-number">37030583</span>)&lt;&lt;<span class="hljs-number">128</span>)<br>n=p*q<br>phi=(p*(p-<span class="hljs-number">1</span>))<br>d=inverse(e,phi)<br>c=<span class="hljs-number">2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br><span class="hljs-comment">#hgame&#123;sieve_is_n0t_that_HArd&#125;</span><br></code></pre></td></tr></table></figure><h2 id="6-SPiCa-8pts-21sol"><a href="#6-SPiCa-8pts-21sol" class="headerlink" title="6.SPiCa(8pts,21sol)"></a>6.SPiCa(8pts,21sol)</h2><p>çœ‹åˆ°é¢˜ç›®ä¸­ $0.035$ï¼Œ$A$ ä¸ºéšæœº $0,1$ çŸ©é˜µï¼Œå¤§æ¦‚ç‡èƒ½å¤ŸçŒœåˆ°æ˜¯æ­£äº¤æ ¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, long_to_bytes,bytes_to_long<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">derive_M</span>(<span class="hljs-params">n</span>):<br>    iota=<span class="hljs-number">0.035</span><br>    Mbits=<span class="hljs-built_in">int</span>(<span class="hljs-number">2</span> * iota * n^<span class="hljs-number">2</span> + n * log(n,<span class="hljs-number">2</span>))<br>    M = random_prime(<span class="hljs-number">2</span>^Mbits, proof = <span class="hljs-literal">False</span>, lbound = <span class="hljs-number">2</span>^(Mbits - <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">return</span> Integer(M)<br><br>m = bytes_to_long(flag).bit_length()<br>n = <span class="hljs-number">70</span><br>p = derive_M(n)<br><br><br>F = GF(p)<br>x = random_matrix(F, <span class="hljs-number">1</span>, n)<br>A = random_matrix(ZZ, n, m, x=<span class="hljs-number">0</span>, y=<span class="hljs-number">2</span>)<br>A[randint(<span class="hljs-number">0</span>, n-<span class="hljs-number">1</span>)] = vector(ZZ, <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bin</span>(bytes_to_long(flag))[<span class="hljs-number">2</span>:]))<br>h = x*A<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-built_in">str</span>(m) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    file.write(<span class="hljs-built_in">str</span>(p) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> h:<br>        file.write(<span class="hljs-built_in">str</span>(item) + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure><p>refï¼š<a href="https://0xffff.one/d/2077">HSSPä¸æ­£äº¤æ ¼å­¦ä¹ ç¬”è®° - 0xFFFF</a></p><p>æ­£äº¤æ ¼ä¸»è¦æ˜¯ç”¨äºè§£å†³ $A\vec x\equiv \vec b \pmod p$ çš„é—®é¢˜ï¼Œå…¶ä¸­ $A$ ä¸º $0,1$ çš„æœªçŸ¥ç½®çŸ©é˜µï¼Œ$\vec x$ ä¸ºç§˜å¯†å‘é‡ï¼Œæˆ‘ä»¬åªçŸ¥é“æœ€ç»ˆå‘é‡ $\vec b$ å’Œæ¨¡æ•° $p$ï¼Œå…¶ä½™å†…å®¹æˆ‘ä»¬å‡ä¸çŸ¥é“ã€‚</p><p>é¢˜ç›®ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°å‘é‡ $\vec h&#x3D;\vec xA$ ï¼Œ$A$ ç¬¦åˆä¸Šè¿°çš„ç‰¹ç‚¹ã€‚ç”±äº $\vec x$ ä¸ºè¡Œå‘é‡ï¼Œ$A$ å¯ä»¥çœ‹ä½œ $\vec a_0,\vec a_1,â€¦,\vec a_{m-1}$ è¿™ $m$ ä¸ªè¡Œå‘é‡ç»„æˆçš„çŸ©é˜µã€‚ </p><p>æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹çº¿æ€§ä»£æ•°çš„çŸ¥è¯†ï¼ˆçœŸå·§ï¼Œ18å·å†™è¿™ä¸ªï¼Œ19å·å°±è¦å­¦çŸ©é˜µè®ºï¼‰</p><p>å¯¹äºä¸€ä¸ª $m$ è¡Œ $n$ åˆ—çš„çŸ©é˜µï¼ˆå¦‚æœ $m\not&#x3D;n$ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªçŸ©é˜µçš„ç§©ä¸€å®šä¸è¶…è¿‡ $\min(m,n)$ã€‚æ ¹æ®é“¾æ¥ä¸­çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¡Œç©ºé—´ã€åˆ—ç©ºé—´ã€å·¦0ç©ºé—´ã€å³0ç©ºé—´çš„æ¦‚å¿µï¼š</p><blockquote><p>è¡Œç©ºé—´ï¼š$\vec xA&#x3D;\vec b$ ä¸­ï¼Œæ‰€æœ‰ $\vec b$ æ„æˆçš„ç©ºé—´ï¼Œæ­¤æ—¶ $A$ çš„æ¯ä¸€è¡Œæ„æˆç©ºé—´çš„åŸºåº•å‘é‡ã€‚</p><p>åˆ—ç©ºé—´ï¼š$A\vec x&#x3D;\vec b$ ä¸­ï¼Œæ‰€æœ‰ $\vec b$ æ„æˆçš„ç©ºé—´ï¼Œæ­¤æ—¶ $A$ çš„æ¯ä¸€åˆ—æ„æˆç©ºé—´çš„åŸºåº•å‘é‡ã€‚</p><p>å·¦0ç©ºé—´ï¼šæ»¡è¶³ $\vec xA&#x3D;\vec 0$ çš„æ‰€æœ‰ $\vec x$ æ„æˆçš„é›†åˆï¼Œåœ¨sagemathä¸­ä¸º <code>A.left_kernel().matrix()</code>ã€‚å…¶ä¸ªæ•°ä¸º $m-r+1$ï¼Œ$r$ ä¸º $A$ ä¸­äº’ç›¸çº¿æ€§æ— å…³çš„è¡Œå‘é‡ä¸ªæ•°ã€‚</p><p>å³0ç©ºé—´ï¼šæ»¡è¶³ $A\vec x&#x3D;\vec 0$ çš„æ‰€æœ‰ $\vec x$ æ„æˆçš„é›†åˆï¼Œåœ¨sagemathä¸­ä¸º <code>A.right_kernel().matrix()</code>ã€‚å…¶ä¸ªæ•°ä¸º $n-r+1$ï¼Œ$r$ ä¸º $A$ ä¸­äº’ç›¸çº¿æ€§æ— å…³çš„åˆ—å‘é‡ä¸ªæ•°ã€‚</p></blockquote><p>æ€§è´¨ï¼šè¡Œç©ºé—´å’Œå³0ç©ºé—´æ­£äº¤ï¼Œåˆ—ç©ºé—´ä¸å·¦0ç©ºé—´æ­£äº¤ã€‚</p><p>ç”±äºé¢˜ç›®ä¸­ $\vec xA&#x3D;\vec h$ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè®¾æ³•æ„é€  $\vec u$ï¼Œä½¿å¾— $\vec u\cdot\vec h&#x3D;0$ï¼Œä¹Ÿå°±æ˜¯ $\sum_{i&#x3D;0}^{m-1}u_ih_i\equiv 0\pmod p$ã€‚</p><p>å†™æˆçŸ©é˜µçš„å½¢å¼å°±æ˜¯ï¼ˆä¸ºæ–¹ä¾¿å±•ç¤ºï¼Œä»¥ä¸‰ä¸ªåˆ†é‡ä¸ºä¾‹ï¼‰ï¼š</p><p><img src="/2025/02/21/Hgame25/5.png" alt="5"></p><p>å¾ˆæ˜æ˜¾ï¼Œä¸ºäº†æ±‚å‡º $\vec u$ ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ä¸Šé¢çš„çŸ©é˜µLLLå¤„ç†ï¼Œè®¾ä¸Šé¢çš„çŸ©é˜µä¸º $M$ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ° $M_{3L}$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">n,m=<span class="hljs-number">70</span>,<span class="hljs-number">247</span><br>p=<span class="hljs-number">24727704801291912268835129736340977567569865784366882566681759917843647658060231409536848349518003784121914409876944135933654762801696486121844572452922377222301017649192408619831637530961997845860817966791811403512683444831050730277</span><br>h=<span class="hljs-comment">#é¢˜ç›®ä¸­ç»™å‡ºçš„æ•°æ®</span><br>M=block_matrix([<br>    [p,zero_matrix(<span class="hljs-number">1</span>,m)],<br>    [matrix(h).T,identity_matrix(m)]<br>])<br>M3L=M.LLL()<br></code></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†å‘é‡ $\vec u$ï¼Œæ»¡è¶³ $\vec u\cdot \vec h\equiv 0\pmod p$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">u=vector(GF(p),M3L[<span class="hljs-number">0</span>])<br>Mp=matrix(GF(p),M)<br>u*Mp==u<br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ $M_{3L}$ çš„å‰ $m-n$ åˆ—ï¼Œæ„é€ æ ¼ $L_x$ï¼Œç„¶åæ±‚ $L_x$ çš„å³ 0 ç©ºé—´ï¼ˆå› ä¸ºé¢˜ç›®ä¸­æ˜¯ $\vec xA$ å¾—åˆ°çš„æ˜¯è¡Œç©ºé—´ï¼Œå› æ­¤è¦æ±‚å³ 0 ç©ºé—´ï¼‰ï¼Œæ„é€  $L_c$ï¼Œç„¶åå¯¹ $L_c$ åšBKZå°±èƒ½å¤Ÿå¾—åˆ°åŸå§‹çŸ©é˜µ $A$ï¼ˆå¯¹äº $0&#x2F;1$ å†³ç­–ï¼Œä½¿ç”¨BKZç®—æ³•æ¯”LLLç®—æ³•æœ‰æ›´é«˜æ¦‚ç‡å¾—åˆ°æ­£ç¡®ç»“æœï¼‰ï¼Œè¿™ä¸€éƒ¨åˆ†å¯ä»¥å‚è€ƒç»™å‡ºçš„é“¾æ¥çš„å†…å®¹ï¼Œè¿™ä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">Lxo = matrix(ZZ, M3L[:m-n])<br>Lxc = Lxo.right_kernel(algorithm=<span class="hljs-string">&#x27;pari&#x27;</span>).matrix() <span class="hljs-comment"># faster</span><br>Lxc3L=Lxc.BKZ()<br><span class="hljs-keyword">for</span> vline inn Lxc3L:<br>    <span class="hljs-built_in">print</span>(vline)<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æœŸå¾…æ‰¾å‡ºä¸€ä¸ªä»…åŒ…å« $0,1$ çš„å‘é‡ï¼Œä½†å‘ç°å¾—åˆ°çš„å‘é‡åŸºæœ¬éƒ½ä¼šåŒ…å« $-1,0,1$ ä¸‰ä¸ªæ•°å­—ã€‚è¿™å’Œä¹‹å‰åšèƒŒåŒ…å¯†ç æ—¶äº§ç”Ÿçš„é—®é¢˜ç›¸åŒã€‚å› æ­¤ï¼Œå¯ä»¥å€Ÿé‰´å…¶æ–¹æ³•ï¼Œæ„é€ çŸ©é˜µ $\left[\dfrac{\vec 1}{2L_c}\right]$ï¼Œè¿™æ ·åŸçŸ©é˜µ $A$ å°±å˜æˆäº† $2A-1$ ï¼Œä½¿å¾—æ‰€æœ‰å‘é‡çš„åˆ†é‡å‡ä¸º $Â±1$ï¼ŒæŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œä¹Ÿç®—ä¸€ç§ç³»æ•°å¹³è¡¡æ–¹æ³•å§ã€‚</p><p>é‚£ä¹ˆæœ€åçš„expå¦‚ä¸‹ï¼ˆå½“ç„¶ï¼Œå¦‚æœè§£ä¸å‡ºæ¥ï¼Œå¯ä»¥å¯¹ $V_{3L}$ å–åå†å°è¯•ä¸€ä¸‹ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">n,m=<span class="hljs-number">70</span>,<span class="hljs-number">247</span><br>p=<span class="hljs-number">24727704801291912268835129736340977567569865784366882566681759917843647658060231409536848349518003784121914409876944135933654762801696486121844572452922377222301017649192408619831637530961997845860817966791811403512683444831050730277</span><br>h=<span class="hljs-comment">#é¢˜ç›®ä¸­ç»™å‡ºçš„æ•°å€¼</span><br>M=block_matrix([<br>    [p,zero_matrix(<span class="hljs-number">1</span>,m)],<br>    [matrix(h).T,identity_matrix(m)]<br>])<br>M3L=M.LLL()<br>Lxo = matrix(ZZ, M3L[:m-n])<br>Lxc = Lxo.right_kernel(algorithm=<span class="hljs-string">&#x27;pari&#x27;</span>).matrix() <span class="hljs-comment"># faster</span><br>V=block_matrix(ZZ,[[matrix([<span class="hljs-number">1</span>]*(m+<span class="hljs-number">1</span>))],[<span class="hljs-number">2</span>*Lxc]])<br>V3L=V.BKZ()<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,V3L.nrows()):<br>    vec=V3L[i]<br>    s=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>+m):<br>        s*=<span class="hljs-number">2</span><br>        s+=(vec[j]==<span class="hljs-number">1</span>)<br>    s=long_to_bytes(s)<br>    <span class="hljs-keyword">if</span>(<span class="hljs-string">b&#x27;hgame&#123;&#x27;</span> <span class="hljs-keyword">in</span> s):<br>        <span class="hljs-built_in">print</span>(s)<br></code></pre></td></tr></table></figure><h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9.æ€»ç»“"></a>9.æ€»ç»“</h2><p>ä»Šå¹´Hgameæ¯”21å¹´å’Œ22å¹´çš„éš¾å¤ªå¤šäº†ï¼Œ0xGame2024ä¹Ÿæ˜¯ï¼Œæ„Ÿè§‰éš¾åº¦å’Œ20ï¼Œ21å¹´ä¸æ˜¯ä¸€ä¸ªæ¡£æ¬¡çš„ï¼ˆå½“æ—¶21å¹´æˆ‘è¿˜æ€•å‡ºéš¾äº†ï¼ŒPredict1å’ŒPredict2å€Ÿé‰´äº†21å¹´Hgameçš„å¤ºå®å¤§å†’é™©ï¼Œ<del>å…¶å®å°±æ˜¯ç›´æ¥æŠ„çš„</del>ï¼Œä½†æœ€ç»ˆçœ‹æ¥é¢˜ç›®è¿˜æ˜¯æ¯”0xGame2020éš¾ï¼‰ã€‚</p><p>Hgame2022çš„é¢˜æˆ‘é™„ä»¶è¿˜åœ¨ï¼ˆå› ä¸ºé‚£ä¸ªæ—¶å€™æˆ‘CTFå·²ç»å¤„äºä¸€ä¸ªåŠé€€å½¹çš„çŠ¶æ€äº†ï¼‰ï¼Œå¹¶ä¸”æˆ‘æ‰‹ä¸­è¿˜ä¿å­˜äº†å½“å¹´SACCå¯’å‡æ‰“å¡çš„ææ–™ï¼Œçœ‹äº†çœ‹å­¦å¼ŸSchenäº¤ç»™æˆ‘çš„æ‰“å¡è®°å½•ï¼Œæ„Ÿè§‰é¢˜ç›®å’Œ21å¹´çš„ç›¸ä»¿ï¼Œå¹¶ä¸”22å¹´çš„é¢˜ç›®æˆ‘é‚£ä¸ªå¯’å‡ä¹Ÿåšäº†ä¸€äº›ï¼Œè²Œä¼¼å››å‘¨çš„é¢˜ç›®ä¹Ÿéƒ½æ˜¯ä¸€å¤©AKçš„ï¼ˆä½†å½“æ—¶å¥½åƒå°±æ²¡æ‰“ç†åšå®¢äº†ï¼Œæ‰€ä»¥æ‰¾ä¸åˆ°22å¹´çš„åšé¢˜è®°å½•ï¼Œåé¢æœ‰ç©ºè¡¥ä¸€ç¯‡ï¼‰ã€‚ã€‚ã€‚</p><p>ä¸è¿‡è¯è¯´å›æ¥ï¼Œè¿™å‡ å¹´CTFå’‹å‡ºäº†è¿™ä¹ˆå¤šä¸œè¥¿ï¼Œæˆ‘CTFä¸¤å¹´çš„ç©ºçª—æœŸç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>25Feb1</title>
    <link href="/2025/02/19/25Feb1/"/>
    <url>/2025/02/19/25Feb1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-2æœˆçš„åˆ‡é¢˜-1"><a href="#huangx607087-2æœˆçš„åˆ‡é¢˜-1" class="headerlink" title="huangx607087 2æœˆçš„åˆ‡é¢˜ 1"></a>huangx607087 2æœˆçš„åˆ‡é¢˜ 1</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>è¿‘æœŸé‡åˆ°äº†å‡ ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„é¢˜ç›®ï¼Œæ¥çœ‹ä¸€çœ‹ï¼</p><p><del>é¡ºä¾¿æŒ‚ä¸‰ä¸ªä»¤æˆ‘åºŸé€è„‘ç­‹çš„é¢˜ç›®</del></p><h2 id="1-DASCTF2408-ezSignin"><a href="#1-DASCTF2408-ezSignin" class="headerlink" title="1.DASCTF2408-ezSignin"></a>1.DASCTF2408-ezSignin</h2><h3 id="1x01-é¢˜ç›®ç®€å•åˆ†æ"><a href="#1x01-é¢˜ç›®ç®€å•åˆ†æ" class="headerlink" title="1x01 é¢˜ç›®ç®€å•åˆ†æ"></a>1x01 é¢˜ç›®ç®€å•åˆ†æ</h3><p>å…ˆæ¥çœ‹ä¸€ä¸‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> hashlib<br><br>p = <span class="hljs-number">174523845247570741054964008585718839267</span><br>E = EllipticCurve(GF(p), [<span class="hljs-number">0</span>, <span class="hljs-number">486662</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>])<br>G=E(<span class="hljs-number">2247961404505753398791635923994899528</span>, <span class="hljs-number">108711418033303501028455466081133667288</span>)<br>n=G.order()<br>Cofactor = E.order() // n<br>f = <span class="hljs-number">128</span>+<span class="hljs-number">1</span><br>lambda_ = <span class="hljs-number">100</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">retbar</span>(<span class="hljs-params">P</span>):<br>    index = (f + <span class="hljs-number">1</span>) // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(P[<span class="hljs-number">0</span>]) % (<span class="hljs-number">2</span> ^ index) + <span class="hljs-number">2</span> ^ index) % n<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genkey</span>():<br>    w = randint(<span class="hljs-number">1</span>, n - <span class="hljs-number">1</span>)<br>    W = w * G<br>    <span class="hljs-keyword">return</span> (w, W)<br><br>B_pri_w, B_pub_W = genkey()<br><span class="hljs-built_in">print</span>(B_pub_W[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>])<br><br>LS = []<br>LR = []<br>BR = []<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Exchange</span>(<span class="hljs-params">i</span>):<br>    A_pri_w, A_pub_W = genkey()<br>    A_pri_r, A_pub_R = genkey()<br>    B_pri_r, B_pub_R = genkey()<br><br>    sa = (A_pri_r + retbar(A_pub_R) * A_pri_w) % n<br>    sb = (B_pri_r + retbar(B_pub_R) * B_pri_w) % n<br><br>    Ka = Cofactor * (B_pub_R + retbar(B_pub_R) * B_pub_W) * sa<br>    Kb = Cofactor * (A_pub_R + retbar(A_pub_R) * A_pub_W) * sb<br><br>    <span class="hljs-keyword">assert</span> (Ka == Kb)<br><br>    leakageS = sb &gt;&gt; lambda_<br>    leakageR = B_pri_r &gt;&gt; lambda_<br><br>    LS.append(leakageS), LR.append(leakageR)<br>    BR.append(B_pub_R[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>): Exchange(i)<br>    <br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LS=&quot;</span>, LS)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LR=&quot;</span>, LR)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;BR=&quot;</span>, BR)<br>H=hashlib.md5()<br>H.update(long_to_bytes(B_pri_w))<br>key=H.hexdigest().encode()<br>aes = AES.new(key,AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(aes.encrypt(flag))<br><br></code></pre></td></tr></table></figure><p>ä¹ä¸€çœ‹ï¼Œæ˜¯ä¸€ä¸ªä¹‹å‰åšçƒ‚æ‰çš„ECDHçš„å¯†é’¥äº¤æ¢åè®®ï¼Œé¢˜ç›®ç»™å‡ºäº† B çš„å…¬é’¥ $xG$ï¼Œæ¯ä¸€æ¬¡å¯†é’¥äº¤æ¢çš„ <code>sb,B_pri_r</code> çš„é«˜ä½ï¼Œä»¥åŠå®Œæ•´çš„ <code>B_pub_R</code> çš„ç‚¹ï¼Œå¹¶ä¸”è¿™è¾¹çš„çº¿æ€§å…³ç³»å¼ä¹Ÿå¾ˆç®€å•ï¼Œ$B_{pub,r}$ ç»™å‡ºåï¼Œ$f(B_{pub,r})$ ä¹Ÿä¸‹èƒ½å½“ä¸ä½œä¸ºå®šå€¼ç»™å‡ºäº†ã€‚<br>$$<br>s_B&#x3D;B_{pri,r}+f(B_{pub,r})w_B<br>$$<br>ä¸ºäº†æ–¹ä¾¿å±•ç¤ºï¼Œæˆ‘ä»¬è®¾ <code>LS,LR,BR</code> åˆ†åˆ«è®°ä¸ºä¸º $S,R,P$ï¼Œå…¶ä¸­ $S_{i}&#x3D;2^{100}s_i+x_i,R_i&#x3D;2^{100}r_i+y_i$ï¼ŒB çš„å›ºå®šç§é’¥ä¸º $w$ã€‚ä½†å®é™…ä¸Šï¼Œ<code>LS,LR</code> ä¸­å­˜æ”¾çš„å…¶å®æ˜¯ $s_i$ å’Œ $r_i$ï¼Œ$x_i$ å’Œ $y_i$ æ˜¯å³ç§»è¢«çœç•¥çš„å†…å®¹ã€‚</p><p>é‚£ä¹ˆä¸Šé¢çš„ç­‰å¼å°±å¯ä»¥å†™ä¸ºï¼š<br>$$<br>2^{100}s_i+x_i\equiv 2^{100}r_i+y_i-f(P)w \pmod n<br>$$<br>æ•´ç†ä¸€ä¸‹ï¼š<br>$$<br>x_i-y_i&#x3D;2^{100}(r_i-s_i)-f(P_i)w-k_in<br>$$<br>å¦‚æœæŠŠ $x_i-y_i$ å½“ä½œæ•´ä½“ï¼Œé‚£å°±æ˜¯ï¼š<br>$$<br>z_i&#x3D;2^{100}(r_i-s_i)-f(P_i)w-k_in<br>$$<br>è®¾ $A_i&#x3D;r_i-s_i,B_i&#x3D;f(P_i)$ï¼Œé€»è¾‘å°±å‡ºæ¥äº†ï¼š<br>$$<br>z_i&#x3D;2^{100}A_i-wB_i-k_in<br>$$<br>æ‰€ä»¥æ„é€ çŸ©é˜µå¦‚ä¸‹ï¼š</p><p><img src="/2025/02/19/25Feb1/1.png" alt="1"></p><p>ç”±äº $w$ æ˜¯ $128$ ä½ï¼Œ$z$ æ˜¯ $100$ ä½ï¼Œé‚£ä¹ˆéœ€è¦ä¹˜å¹³è¡¡ç³»æ•°ä¸º $\mathrm{diag}(2^{128},1,2^{28},2^{28},2^{28})$ï¼Œç„¶åLLLæ±‚è§£ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><br>p = <span class="hljs-number">174523845247570741054964008585718839267</span><br>E = EllipticCurve(GF(p), [<span class="hljs-number">0</span>, <span class="hljs-number">486662</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>])<br>G=E(<span class="hljs-number">2247961404505753398791635923994899528</span>, <span class="hljs-number">108711418033303501028455466081133667288</span>)<br>n=G.order()<br>H=E(<span class="hljs-number">56142839234500040174315077324489019612</span>, <span class="hljs-number">143186177525574678948140963663687495447</span>)<br>LS= [<span class="hljs-number">12160779</span>, <span class="hljs-number">70634852</span>, <span class="hljs-number">136488679</span>, <span class="hljs-number">93279448</span>, <span class="hljs-number">51769705</span>, <span class="hljs-number">99408367</span>, <span class="hljs-number">94011238</span>, <span class="hljs-number">46255543</span>, <span class="hljs-number">136054320</span>, <span class="hljs-number">126842658</span>]<br>LR= [<span class="hljs-number">117789932</span>, <span class="hljs-number">85602320</span>, <span class="hljs-number">136131278</span>, <span class="hljs-number">85538539</span>, <span class="hljs-number">33115646</span>, <span class="hljs-number">15821127</span>, <span class="hljs-number">122073977</span>, <span class="hljs-number">40205177</span>, <span class="hljs-number">40509142</span>, <span class="hljs-number">121833940</span>]<br>BR= [(<span class="hljs-number">43128875586771925869851532015581155657</span>, <span class="hljs-number">108714366549720544283054523544596695631</span>), (<span class="hljs-number">166053844834143846221197595138208659402</span>, <span class="hljs-number">9389299139547698081250285594708260233</span>), (<span class="hljs-number">83160043610860066750778648875060399604</span>, <span class="hljs-number">160655466348101518011620435983302563358</span>), (<span class="hljs-number">18306927902958362110653472691194540502</span>, <span class="hljs-number">141566997533915037448387258113883793369</span>), (<span class="hljs-number">124719869188706449552550102421264489653</span>, <span class="hljs-number">111266021208672789646176095367638959348</span>), (<span class="hljs-number">62115794167524204331339724293036031704</span>, <span class="hljs-number">24476842210910012261000793337134128911</span>), (<span class="hljs-number">57017187772347635647835418540384524017</span>, <span class="hljs-number">149273114828279413180900590599119201032</span>), (<span class="hljs-number">141865913804035015431129030802262884043</span>, <span class="hljs-number">11219445710980991629921733217597739715</span>), (<span class="hljs-number">35994282847505215202392163277052083355</span>, <span class="hljs-number">5366425669461724819918825109516828913</span>), (<span class="hljs-number">72621299937996657982583201267406651177</span>, <span class="hljs-number">39297013522202608324989011761142875947</span>)]<br>C=<span class="hljs-string">b&#x27;\xd7\x8c\xf1Yx\x05W\x8ckq\xfdb\xd5\x81K&quot;\xe7q\x88\x18\xedq\x9f\xcap\x1cTB\xc9)\xe1c\xf4~\x7f\xccwh\xfe\t\xbf\xb2!\xde\x84\xeeO\x0f8\xd1\xac\xbc\x1c \xf0F\x0c\x00\xc9\xa7\x9e\x06\xdan&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">retbar</span>(<span class="hljs-params">P</span>):<br>    index = <span class="hljs-number">130</span>//<span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(P[<span class="hljs-number">0</span>]) % (<span class="hljs-number">2</span> ** index) + <span class="hljs-number">2</span> ** index) % n<br>A=[<span class="hljs-number">2</span>**<span class="hljs-number">100</span>*(LS[i]-LR[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]<br>B=[-retbar(BR[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]<br>M=block_matrix([<br>    [identity_matrix(<span class="hljs-number">2</span>),matrix([A,B])],<br>    [zero_matrix(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),n*identity_matrix(<span class="hljs-number">10</span>)]<br>])<br>B=diagonal_matrix([<span class="hljs-number">2</span>**<span class="hljs-number">128</span>,<span class="hljs-number">1</span>]+[<span class="hljs-number">2</span>**<span class="hljs-number">28</span>]*<span class="hljs-number">10</span>)<br>M3L=((M*B).LLL())*(B**-<span class="hljs-number">1</span>)<br>vec=<span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> vec <span class="hljs-keyword">in</span> M3L:<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(vec[<span class="hljs-number">0</span>])==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">break</span><br>x=<span class="hljs-built_in">int</span>(vec[<span class="hljs-number">0</span>]*vec[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(x))<br><span class="hljs-comment">#00e2e6517a7ca4a6fdeeacca2fa34781</span><br></code></pre></td></tr></table></figure><p>è¿™ä¹ˆåšè²Œä¼¼ç¡®å®æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘ä»¬å¾—åˆ°çš„å‚æ•°çš„æ•°é‡çº§ä¹Ÿå¯¹ï¼Œæ£€æŸ¥äº†ä¸€ä¸‹è¡Œåˆ—å¼çš„å€¼ï¼Œä¹ŸåŸºæœ¬ç¬¦åˆè¦æ±‚ã€‚ä½†å°è¯•ç”¨è§£å‡ºæ¥çš„ $w$ è§£å¯†flagï¼Œç«Ÿç„¶ä¸å¯¹ï¼Ÿï¼</p><h3 id="1x02-ç»™-wG-çš„ä½œç”¨"><a href="#1x02-ç»™-wG-çš„ä½œç”¨" class="headerlink" title="1x02 ç»™ $wG$ çš„ä½œç”¨"></a>1x02 ç»™ $wG$ çš„ä½œç”¨</h3><p>æ³¨æ„åˆ°é¢˜ç›®ç»™å‡ºäº† $wG$ çš„å€¼ï¼Œè¿™ä¸ªå€¼æˆ‘ä»¬è¿˜æ²¡æœ‰ç”¨åˆ°ã€‚</p><p>ä¸ç®¡äº†ï¼Œæµ‹ä¸€ä¸‹å®ƒçš„ä»£ç ï¼Œæœç„¶ï¼Œå‘ç°äº†ç„æœºï¼šæœ€ç»ˆè§£å‡ºæ¥çš„ $w$ å’Œå®é™…çš„ $w_B$ æœ‰ $Â±2^{33}$ æ•°é‡çº§çš„è¯¯å·®ï¼Œè¿™å°±å¯¼è‡´ç›®æ ‡å‘é‡å…¶å®å¹¶ä¸æ˜¯æˆ‘ä»¬è§£å‡ºæ¥çš„æœ€çŸ­å‘é‡ã€‚ï¼ˆè¿™ä¸ªæµ‹è¯•çš„ä»£ç å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªï¼Œè¿™ä¸ªé¢˜æˆ‘æ˜¯2æœˆ1æ—¥åšçš„ï¼Œæµ‹è¯•çš„ä»£ç ä¸¢äº†å°±ä¸å‘äº†ï¼Œè‡ªå·±è¿è¡Œå®ƒé¢˜ç›®ä¸­çš„ä»£ç ï¼Œè¾“å‡º $w_B$ï¼Œå†è¿è¡Œä¸Šé¢çš„è§£é¢˜ä»£ç ï¼Œè®¡ç®—é‚£ä¸¤ä¸ªå€¼çš„å·®å°±OKï¼‰ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œ$w_B$ çš„ä½ $34$ ä½æˆ‘ä»¬ä¸çŸ¥é“ï¼Œè¿™ä¸ªå€¼ç›´æ¥æšä¸¾å¤ªå¤§äº†ï¼Œè€ƒè™‘å¯¹æœªçŸ¥éƒ¨åˆ†è¿›è¡Œbsgsï¼Œè¿™æ ·æ‰èƒ½å¾—åˆ°flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python">xbar=(x&gt;&gt;<span class="hljs-number">34</span>)&lt;&lt;<span class="hljs-number">34</span><br>K=H-xbar*G<br>D=<span class="hljs-built_in">dict</span>()<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>P=E(<span class="hljs-number">0</span>)<br>G2=G*<span class="hljs-number">2</span>**<span class="hljs-number">17</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">17</span>)):<br>    D[P]=i<br>    P=P+G2<br>P=E(<span class="hljs-number">0</span>)<br>Ktmp=K<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">17</span>)):<br>    u=D.get(Ktmp,<span class="hljs-literal">None</span>)<br>    <span class="hljs-keyword">if</span>(u):<br>        v=i<br>        <span class="hljs-built_in">print</span>(u,v)<br>        <span class="hljs-keyword">break</span><br>    Ktmp-=G<br>x=xbar+(u&lt;&lt;<span class="hljs-number">17</span>)+v<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(xbar))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(x))<br><span class="hljs-comment">#60999 17385</span><br><span class="hljs-comment">#00e2e6517a7ca4a6fdeeacc800000000</span><br><span class="hljs-comment">#00e2e6517a7ca4a6fdeeacc9dc8e43e9</span><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br>key=md5(long_to_bytes(x)).hexdigest().encode()<br>aes = AES.new(key,AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(aes.decrypt(C))<br><span class="hljs-comment">#b&#x27;DASCTF&#123;C0ngRatul4tion5_On_y0ur_SuCc3ssfuL_S1gN_1n&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>çœ‹æ¥æœ‰çš„æ—¶å€™æµ‹ä¸€ä¸‹é¢˜ç›®ä»£ç è¿˜æ˜¯æœ‰å¿…è¦çš„:)ï¼Œç­¾ä¸ªåˆ°è¿˜çœŸä¸å®¹æ˜“å‘¢ã€‚ã€‚ã€‚</p><h2 id="2-VNCTF2025-sh1kaku-fw"><a href="#2-VNCTF2025-sh1kaku-fw" class="headerlink" title="2.[VNCTF2025]sh1kaku_fw"></a>2.[VNCTF2025]sh1kaku_fw</h2><h3 id="2x01-é¢˜ç›®ä»£ç "><a href="#2x01-é¢˜ç›®ä»£ç " class="headerlink" title="2x01 é¢˜ç›®ä»£ç "></a>2x01 é¢˜ç›®ä»£ç </h3><p>åˆæ˜¯ä¸€ä¸ªLWEçš„é¢˜ç›®ï¼Œæ¥çœ‹ä¸€ä¸‹ä»£ç ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime <br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> os<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_timeout</span>(<span class="hljs-params">signum, frame</span>):<br>    <span class="hljs-keyword">raise</span> TimeoutError(<span class="hljs-string">&#x27;function timeout&#x27;</span>)<br><br>timeout = <span class="hljs-number">450</span><br>signal.signal(signal.SIGALRM, _handle_timeout)<br>signal.alarm(timeout)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">uniform_sample</span>(<span class="hljs-params">n, bound, SecureRandom</span>):<br>    <span class="hljs-keyword">return</span> [SecureRandom.randrange(-bound, bound) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">choice_sample</span>(<span class="hljs-params">n, L, SecureRandom</span>):<br>    <span class="hljs-keyword">return</span> [SecureRandom.choice(L) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br><br>n = <span class="hljs-number">197</span><br>m = <span class="hljs-number">19700</span><br>q = getPrime(<span class="hljs-number">20</span>)<br><br>e_L = [random.randrange(<span class="hljs-number">0</span>, q-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>R_s = random.SystemRandom()<br>R_e = random.SystemRandom()<br><br>s = np.array(uniform_sample(n, q//<span class="hljs-number">2</span>, R_s))<br>e = np.array(choice_sample(m,  e_L, R_e))<br><br>seed = os.urandom(<span class="hljs-number">16</span>)<br>R_A = random<br>R_A.seed(seed)<br>A = np.array([uniform_sample(n, q, R_A) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m)])<br>b = (A.dot(s) + e) % q<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;q = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;e_L = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;seed.<span class="hljs-built_in">hex</span>() = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;b.tolist() = &#125;</span>&quot;</span>) <br>s_ = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Give me s: &quot;</span>)<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">if</span> s_ == <span class="hljs-built_in">str</span>(s.tolist()):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Congratulations! You have signed in successfully.&quot;</span>)<br>    <span class="hljs-built_in">print</span>((<span class="hljs-string">&#x27;flag&#123;success at_&#x27;</span>+<span class="hljs-built_in">str</span>(datetime.now())+<span class="hljs-string">&#x27;&#125;&#x27;</span>).replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;_&#x27;</span>))<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Sorry, you cannot sign in.&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="2x02-é¢˜ç›®åˆ†æ"><a href="#2x02-é¢˜ç›®åˆ†æ" class="headerlink" title="2x02 é¢˜ç›®åˆ†æ"></a>2x02 é¢˜ç›®åˆ†æ</h3><p>å¯ä»¥çœ‹åˆ°é¢˜ç›®ä¸­ç»™å‡ºäº†ä¸€ä¸ª $197\times19700$ çš„çŸ©é˜µ $A$ï¼Œæ¨¡æ•° $q$ï¼Œç›®æ ‡å‘é‡ $\vec b$ å’Œ è¯¯å·® $e$ å¯èƒ½çš„å–å€¼ã€‚</p><p>å¯¹äº $A\cdot \vec s+\vec e&#x3D;b$ï¼Œå¦‚æœæŠŠçŸ©é˜µ $A$ æ‹†æˆ $19700$ ä¸ªè¡Œå‘é‡ï¼Œé‚£ä¹ˆæ¯ä¸ªè¡Œå‘é‡éƒ½æœ‰ $\vec a_i\cdot \vec s+e_i&#x3D;b$ï¼Œä¹Ÿå°±æ˜¯ $b-\vec a_i\cdot \vec s-e_i&#x3D;0$ã€‚</p><p>ç”±äº $e_i$ åªæœ‰ä¸¤ç§å–å€¼ $e_1,e_2$ï¼Œé‚£ä¹ˆå¿…å®šæœ‰ $b-\vec a_i\cdot \vec s-e_1&#x3D;0$ æˆ–è€… $b-\vec a_i\cdot \vec s-e_2&#x3D;0$ã€‚æ—¢ç„¶ä¸¤ä¸ªæˆç«‹ä¸€ä¸ªï¼Œé‚£ä¹˜èµ·æ¥å°±ä¸€å®šæœ‰<br>$$<br>(b-\vec a_i\cdot \vec s-e_1)(b-\vec a_i\cdot \vec s-e_2)&#x3D;0<br>$$<br>è¿™ä¸ªæ–¹æ³•åœ¨25Jan1ä¸­è§£NTRUæ—¶ä¹Ÿç”¨åˆ°è¿‡ã€‚</p><p>æ—¢ç„¶è¿™æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯å±•å¼€ $\vec a_i\cdot \vec s$ï¼Œç„¶åè¿™é‡Œå¯ä»¥æ„æˆä¸€ä¸ªå…³äº $s_0,s_1,â€¦s_{196}$ çš„å¤šé¡¹å¼ã€‚ç”±äºæ˜¯ä¸¤ä¸ªç›¸ä¹˜ï¼Œé‚£å°±ä¼šæœ‰ $197$ ä¸ªä¸€æ¬¡é¡¹ $s_0\sim s_{196}$ï¼Œ$197$ ä¸ªå¹³æ–¹é¡¹ $s_0^2\sim s_{196}^2$ ä»¥åŠ $197\times98$ ä¸ªäº¤å‰é¡¹ $s_0s_1,â€¦,s_{195}s_{196}$ï¼Œå…± $19700$ é¡¹ï¼Œå°†è¿™äº›å˜é‡çº¿æ€§åŒ–ï¼Œçœ‹ä½œ $19700$ ä¸ªä¸€æ¬¡çš„æœªçŸ¥æ•°ï¼Œé‚£æˆ‘ä»¬åˆšå¥½å¯ä»¥åˆ©ç”¨é¢˜ç›®ç»™å‡ºçš„æ¡ä»¶ï¼Œæ„é€  $19700$ ä¸ªçº¿æ€§æ–¹ç¨‹ç»„è§£è¿™ $19700$ ä¸ªæœªçŸ¥æ•°ã€‚</p><p>æ ¹æ®æ¨å¯¼ï¼Œæ–¹ç¨‹å·¦è¾¹æ„é€ çš„å¯¹åº”çš„ç³»æ•°å¦‚ä¸‹ï¼š</p><table><thead><tr><th>æœªçŸ¥æ•°</th><th>ç³»æ•°</th></tr></thead><tbody><tr><td>$s_i,\space0\le i\lt197$</td><td>$F_i&#x3D;-2ba_i+(e_1+e_2)a_i-e_1e_2$</td></tr><tr><td>$s_i^2,\space0\le i\lt197$</td><td>$G_i&#x3D;a_i^2$</td></tr><tr><td>$s_is_j,\space0\le i\lt j\lt197$</td><td>$H_{(i,j)}&#x3D;2a_ia_j$</td></tr></tbody></table><p>è€Œæ–¹ç¨‹çš„å³è¾¹ï¼Œå°±æ˜¯æ²¡æœ‰ $s$ çš„éƒ¨åˆ†ï¼Œé‚£å°±æ˜¯ $-b^2+b(e_1+e_2)-e_1e_2$ã€‚</p><p>è¿™æ ·ï¼Œå¯¹äº $A$ ä¸­çš„æ¯ä¸ªè¡Œå‘é‡ï¼Œéƒ½å¯ä»¥æ„é€ ä¸€ä¸ªè¿™æ ·çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼š<br>$$<br>\sum_{i&#x3D;0}^{196}\left(F_is_i\right)+\sum_{i&#x3D;0}^{196}\left(G_is_i^2\right)+\sum_{i&#x3D;0}^{195}\sum_{j&#x3D;i+1}^{196}\left(H_{(i,j)}s_is_j\right)\equiv -b^2+b(e_1+e_2)-e_1e_2\pmod q<br>$$</p><h3 id="2x03-è§£é¢˜ç»†èŠ‚"><a href="#2x03-è§£é¢˜ç»†èŠ‚" class="headerlink" title="2x03 è§£é¢˜ç»†èŠ‚"></a>2x03 è§£é¢˜ç»†èŠ‚</h3><p>å› ä¸ºåˆ†æè¿‡ç¨‹è‡ªå·±å·²ç»æ¥è§¦è¿‡ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥å¾ˆé¡ºåˆ©ï¼Œä½†ä¸ºäº†ä¿è¯æ­£ç¡®æ€§ï¼Œå…ˆå†™ä¸ªä»£ç æµ‹ä¸€ä¸‹ï¼š</p><p>æ•°æ®ç”Ÿæˆä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime <br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">uniform_sample</span>(<span class="hljs-params">n, bound, SecureRandom</span>):<br>    <span class="hljs-keyword">return</span> [SecureRandom.randrange(-bound, bound) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">choice_sample</span>(<span class="hljs-params">n, L, SecureRandom</span>):<br>    <span class="hljs-keyword">return</span> [SecureRandom.choice(L) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br><br>n = <span class="hljs-number">8</span><br><span class="hljs-comment">#n=45</span><br><span class="hljs-comment">#n = 197</span><br>m = <span class="hljs-number">2</span>*n+((n-<span class="hljs-number">1</span>)*n)//<span class="hljs-number">2</span><br>q = getPrime(<span class="hljs-number">20</span>)<br><br>e_L = [random.randrange(<span class="hljs-number">0</span>, q-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>R_s = random.SystemRandom()<br>R_e = random.SystemRandom()<br><br>s = np.array(uniform_sample(n, q//<span class="hljs-number">2</span>, R_s))<br>e = np.array(choice_sample(m,  e_L, R_e))<br><br>seed = os.urandom(<span class="hljs-number">16</span>)<br>R_A = random<br>R_A.seed(seed)<br>A = np.array([uniform_sample(n, q, R_A) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m)])<br>b = (A.dot(s) + e) % q<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;q = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;e_L = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;seed.<span class="hljs-built_in">hex</span>() = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;b.tolist() = &#125;</span>&quot;</span>) <br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;s.tolist() =&#125;</span>&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">uniform_sample</span>(<span class="hljs-params">n, bound, SecureRandom</span>):<br>    <span class="hljs-keyword">return</span> [SecureRandom.randrange(-bound, bound) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br><br>n = <span class="hljs-number">8</span><br><span class="hljs-comment"># n = 197</span><br>m = <span class="hljs-number">2</span>*n+((n-<span class="hljs-number">1</span>)*n)//<span class="hljs-number">2</span><br><br>q = <span class="hljs-number">608383</span><br>eL = [<span class="hljs-number">98779</span>, <span class="hljs-number">155323</span>]<br>seed = <span class="hljs-number">0x73d8484f0895b86fc626b3d2a7c9ebd4</span><br>b = [<span class="hljs-number">28366</span>, <span class="hljs-number">263794</span>, <span class="hljs-number">516785</span>, <span class="hljs-number">140422</span>, <span class="hljs-number">94800</span>, <span class="hljs-number">135315</span>, <span class="hljs-number">574033</span>, <span class="hljs-number">522331</span>, <span class="hljs-number">292172</span>, <span class="hljs-number">341996</span>, <span class="hljs-number">601981</span>, <span class="hljs-number">546391</span>, <span class="hljs-number">85872</span>, <span class="hljs-number">492583</span>, <span class="hljs-number">30138</span>, <span class="hljs-number">3278</span>, <span class="hljs-number">301462</span>, <span class="hljs-number">411086</span>, <span class="hljs-number">151442</span>, <span class="hljs-number">247950</span>, <span class="hljs-number">580873</span>, <span class="hljs-number">468430</span>, <span class="hljs-number">132926</span>, <span class="hljs-number">247908</span>, <span class="hljs-number">174415</span>, <span class="hljs-number">465168</span>, <span class="hljs-number">382582</span>, <span class="hljs-number">16723</span>, <span class="hljs-number">540657</span>, <span class="hljs-number">158201</span>, <span class="hljs-number">259050</span>, <span class="hljs-number">350638</span>, <span class="hljs-number">193228</span>, <span class="hljs-number">521987</span>, <span class="hljs-number">429135</span>, <span class="hljs-number">554774</span>, <span class="hljs-number">273844</span>, <span class="hljs-number">281732</span>, <span class="hljs-number">591536</span>, <span class="hljs-number">267711</span>, <span class="hljs-number">605959</span>, <span class="hljs-number">582472</span>, <span class="hljs-number">491069</span>, <span class="hljs-number">140874</span>]<br>s_debug =[-<span class="hljs-number">63716</span>, -<span class="hljs-number">295937</span>, <span class="hljs-number">294401</span>, <span class="hljs-number">183923</span>, <span class="hljs-number">36465</span>, <span class="hljs-number">241521</span>, -<span class="hljs-number">43816</span>, <span class="hljs-number">217716</span>]<br>R_A = random<br>R_A.seed(long_to_bytes(seed))<br>A = np.array([uniform_sample(n, q, R_A) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m)]).tolist()<br>A=Matrix(GF(q),A)<br>vecb=vector(GF(q),b)<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br>STIME=datetime.now()<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(STIME))<br>M=[]<br>y=[]<br>e1,e2=eL<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(m)):<br>    veca=A[i]<br>    bi=vecb[i]<br>    y.append(bi*bi-bi*(e1+e2)+e1*e2)<br>    vecline=[]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        vecline.append(<span class="hljs-number">2</span>*bi*A[i][j]-(e1+e2)*A[i][j])<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        vecline.append(A[i][j]**<span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(j+<span class="hljs-number">1</span>,n):<br>            vecline.append(-<span class="hljs-number">2</span>*A[i][j]*A[i][k])<br>    M.append(vecline)<br>M=Matrix(GF(q),M)<br>y=vector(GF(q),y)<br>ans=M.solve_right(y)<br>s=(ans[:n])<br>s_debug=vector(GF(q),s_debug)<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-built_in">print</span>(s==s_debug)<br>TTIME=datetime.now()<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(TTIME))<br><span class="hljs-built_in">print</span>(TTIME-STIME)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">(544667, 312446, 294401, 183923, 36465, 241521, 564567, 217716)</span><br><span class="hljs-string">True</span><br><span class="hljs-string">2025-02-18 22:04:57.003973</span><br><span class="hljs-string">0:00:00.489371</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>åœ¨æœ¬æœºæµ‹äº†ä¸€ç»„ $n&#x3D;8$ å’Œ $n&#x3D;20$ éƒ½æ²¡æœ‰é—®é¢˜ï¼Œçœ‹æ¥ç®—æ³•æ˜¯å¯¹çš„ã€‚é‚£å°±ç›´æ¥ä¸Š $n&#x3D;197$ï¼Œä½†è¿™çœŸæ˜¯ç‚¸è£‚çš„å­˜åœ¨å•Šï¼</p><p><img src="/2025/02/19/25Feb1/2.png" alt="2"></p><p>å› ä¸ºè‡ªå·±windowsç”¨çš„æ˜¯sage9.3ï¼Œä¸å¦¨åœ¨è™šæ‹Ÿæœºä¸Šè·‘sage10.4ï¼šä¹Ÿå°±å¿«äº†ä¸€ä¸¢ä¸¢è€Œå·²ã€‚ã€‚ã€‚</p><p><img src="/2025/02/19/25Feb1/2b.png" alt="2b"></p><p>ç„¶åè‡ªå·±é—®äº†ä¸‹å‡ºé¢˜äººdbtï¼Œæœ€åä¸€å¥è¯å¼•èµ·äº†æˆ‘æ³¨æ„ï¼š</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dns">huangx6<span class="hljs-number">07087 2025</span>/<span class="hljs-number">2/10 17:47</span>:<span class="hljs-number">06</span><br>é‚£ä¸ªé¢˜å»ºçŸ©é˜µç”¨çš„å•¥ç‰ˆæœ¬sageï¼Ÿ<br><br>crypto-fwshikaku <span class="hljs-number">2025/2/10</span> <span class="hljs-number">17</span>:<span class="hljs-number">49</span>:<span class="hljs-number">51</span><br>ä½ è¿™å¤æ‚åº¦å“äºº<br><br>crypto-fwshikaku <span class="hljs-number">2025/2/10</span> <span class="hljs-number">17</span>:<span class="hljs-number">50</span>:<span class="hljs-number">06</span><br><span class="hljs-number">10</span>.<span class="hljs-number">5</span>æˆ‘æ„Ÿè§‰ç‰ˆæœ¬å…³ç³»ä¸å¤§å•Š<br><br>crypto-fwshikaku <span class="hljs-number">2025/2/10</span> <span class="hljs-number">17</span>:<span class="hljs-number">50</span>:<span class="hljs-number">12</span><br>å°±pythonå†…ç½®listå•Š<br><br></code></pre></td></tr></table></figure><p>ç»ˆäºï¼Œç½ªé­ç¥¸é¦–æ‰¾åˆ°äº†ï¼ŒåŸæ¥sageæ¨¡ $q$ æœ‰é™åŸŸå¤ªæ…¢äº†ï¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">R_A = random<br>R_A.seed(long_to_bytes(seed))<br>A = np.array([uniform_sample(n, q, R_A) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m)]).tolist()<br><span class="hljs-comment">#A=Matrix(GF(q),A)  #deleted</span><br><span class="hljs-comment">#vecb=vector(GF(q),b) #deleted</span><br>vecb=b.copy() <span class="hljs-comment">#new added</span><br></code></pre></td></tr></table></figure><p>é€Ÿåº¦æœç„¶å¿«èµ·æ¥äº†ï¼Œå¹¶ä¸”å¿«äº†50å€ï¼Œå¥½å®¶ä¼™ã€‚ã€‚ã€‚</p><p><img src="/2025/02/19/25Feb1/2c.png" alt="2c"></p><p>ç„¶è€Œè¿™ä¹ˆåšçˆ†å†…å­˜äº†ï¼ˆè™šæ‹Ÿæœºå†…å­˜å·²ç»è¢«æˆ‘è°ƒåˆ°äº† 16GBï¼‰ï¼Œç°åœ¨æ‰“CTFæ²¡é«˜é…è¿˜ä¸è¡Œäº†æ˜¯å§ï¼Œæ˜¯ä¸æ˜¯ä¸‹ä¸€å°ç”µè„‘å¾—ä¹° 64G çš„äº†ï¼Ÿ</p><p><img src="/2025/02/19/25Feb1/2d.png" alt="2d"></p><p>åŸæ¥ä¸€ä¸ªintåœ¨pythonä¸­å 28å­—èŠ‚ï¼Œé‚£è¿˜å¾—å†ä¼˜åŒ–ä¸€ä¸‹ï¼Œç”¨numpyä¼˜åŒ–æˆ 4 å­—èŠ‚ï¼Œè¿™æ ·å†…å­˜çˆ†å¾—æ€»ç®—ä¸é‚£ä¹ˆå¤¸å¼ äº†ã€‚ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">M=np.zeros((<span class="hljs-number">19700</span>,<span class="hljs-number">19700</span>),dtype=np.int32)<br>y=[<span class="hljs-number">0</span>]*m<br>e1,e2=eL<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(m)):<br>    veca=A[i]<br>    bi=vecb[i]<br>    y[i]=(bi*bi-bi*(e1+e2)+e1*e2)%q<br>    cur=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i][cur]=(<span class="hljs-number">2</span>*bi*A[i][j]-(e1+e2)*A[i][j])%q<br>        cur+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i][cur]=(A[i][j]**<span class="hljs-number">2</span>)%q<br>        cur+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(j+<span class="hljs-number">1</span>,n):<br>            M[i][cur]=(-<span class="hljs-number">2</span>*A[i][j]*A[i][k])%q<br>            cur+=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>ä¸è¿‡è¿™ä¸ªåœ¨æœ¬åœ°æµ‹è¯•çš„æ—¶å€™ï¼Œè¿˜æ˜¯è·‘äº† 15 åˆ†é’Ÿï¼Œæ—¶é—´è¿˜æ˜¯æœ‰ç‚¹åé•¿äº†ï¼ŒåŸé¢˜åªæœ‰7.5åˆ†é’Ÿï¼Œä½†è§£æ–¹ç¨‹ç»„ä½œä¸ºæ­£è§£ï¼Œè¿™è¿˜çœŸä¸å¥½ç®€åŒ–æ‰ã€‚</p><p><img src="/2025/02/19/25Feb1/3.png" alt="3"></p><p>æ³¨æ„åˆ°è¿™é‡Œæ„é€ çŸ©é˜µç”¨äº† 7 åˆ†é’Ÿï¼Œè€ƒè™‘å¤šè¿›ç¨‹åŠ é€Ÿï¼šå¼€ 4 ä¸ªè¿›ç¨‹åŒæ­¥å†™æ•°æ®æ„é€ çŸ©é˜µï¼Œè¿™æ ·æ„é€ çŸ©é˜µçš„æ—¶é—´å°±ç¼©çŸ­åˆ°äº† 2 åˆ† 20 ç§’ã€‚ï¼Œè€—æ—¶å¤§æ¦‚åäºŒåˆ†åŠï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜æœ‰ä¸‰åˆ†é’Ÿæ—¶é—´æ¥æ”¶å’Œå‘é€æ•°æ®ã€‚ç”±äºè¿™ä¸ªé¢˜çš„äº¤äº’é‡ä¸å¤§ï¼Œå› æ­¤è¿™ä¸ªæ—¶é—´ä¹Ÿç®—æ˜¯å¤Ÿäº†ã€‚</p><h3 id="2x04-exp"><a href="#2x04-exp" class="headerlink" title="2x04 exp"></a>2x04 exp</h3><p>æœ€ç»ˆå®Œæˆçš„ä»£ç å¦‚ä¸‹ï¼Œ4è¿›ç¨‹è€—æ—¶ 13 åˆ†é’Ÿï¼Œæœ¬åœ°æŠŠæ—¶é—´è°ƒæˆäº† 900 ç§’åšçš„ï¼Œå®åœ¨æƒ³ä¸å‡ºè¿˜æœ‰ä»€ä¹ˆä¼˜åŒ–æ–¹æ³•äº†ã€‚ã€‚ã€‚ï¼ˆä¹Ÿçœ‹ä¸åˆ°å‡ºé¢˜äººçš„expï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">uniform_sample</span>(<span class="hljs-params">n, bound, SecureRandom</span>):<br>    <span class="hljs-keyword">return</span> [SecureRandom.randrange(-bound, bound) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br><br>n = <span class="hljs-number">197</span><br>m = <span class="hljs-number">2</span>*n+((n-<span class="hljs-number">1</span>)*n)//<span class="hljs-number">2</span><br><span class="hljs-built_in">print</span>(m%<span class="hljs-number">4</span>)<br>sh=process([<span class="hljs-string">&#x27;sage&#x27;</span>,<span class="hljs-string">&#x27;sh1kaku_fw_server.sage&#x27;</span>])<br>sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>q = <span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>eL = <span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>seed=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>b=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-comment"># sh.recvuntil(b&#x27;=&#x27;)</span><br><span class="hljs-comment"># s_debug=eval(sh.recvline(keepends=False))</span><br>R_A = random<br>R_A.seed(<span class="hljs-built_in">bytes</span>.fromhex(seed))<br>A = np.array([uniform_sample(n, q, R_A) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m)]).tolist()<br>vecb=b.copy()<br>e1,e2=eL<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> multiprocessing <span class="hljs-keyword">as</span> mp<br><span class="hljs-keyword">from</span> multiprocessing.shared_memory <span class="hljs-keyword">import</span> SharedMemory<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(datetime.now())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">write_to_k</span>(<span class="hljs-params">start_row, end_row, shm_name, shm_name2,shape,shape2, dtype</span>):<br>    <span class="hljs-comment"># è¿æ¥åˆ°å…±äº«å†…å­˜</span><br>    existing_shm = SharedMemory(name=shm_name)<br>    existing_shm2 = SharedMemory(name=shm_name2)<br>    K = np.ndarray(shape, dtype=dtype, buffer=existing_shm.buf)<br>    B = np.ndarray(shape2, dtype=dtype, buffer=existing_shm2.buf)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(start_row,end_row)):<br>        bi=vecb[i]<br>        B[i]=(-bi*bi+bi*(e1+e2)-e1*e2)%q<br>        cur=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            K[i][cur]=(-<span class="hljs-number">2</span>*bi*A[i][j]+(e1+e2)*A[i][j])%q<br>            cur+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            K[i][cur]=(A[i][j]**<span class="hljs-number">2</span>)%q<br>            cur+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(j+<span class="hljs-number">1</span>,n):<br>                K[i][cur]=(<span class="hljs-number">2</span>*A[i][j]*A[i][k])%q<br>                cur+=<span class="hljs-number">1</span><br>    existing_shm.close() <br><br><br><span class="hljs-comment"># m=19700</span><br>num_processes = <span class="hljs-number">4</span><br>rows_per_process = m//<span class="hljs-number">4</span><br>shape = (m, m)<br>shape2= (m)<br>dtype = np.int32<br><br><span class="hljs-comment"># åˆ›å»ºå…±äº«å†…å­˜</span><br>shm = SharedMemory(create=<span class="hljs-literal">True</span>, size=np.prod(shape) * np.dtype(dtype).itemsize)<br>shm2 = SharedMemory(create=<span class="hljs-literal">True</span>, size=np.prod(shape2) * np.dtype(dtype).itemsize)<br>K = np.ndarray(shape, dtype=dtype, buffer=shm.buf)<br>B = np.ndarray(shape2,dtype=dtype, buffer=shm2.buf)<br>processes = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_processes):<br>    start_row = i * rows_per_process<br>    end_row = start_row + rows_per_process<br>    p = mp.Process(target=write_to_k, args=(start_row, end_row, shm.name,shm2.name , shape, shape2, dtype))<br>    processes.append(p)<br>    p.start()<br><br><span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:<br>    p.join()<br><span class="hljs-built_in">print</span>(datetime.now())<br><br><span class="hljs-comment"># K=Matrix(GF(q),K)</span><br>M=Matrix(GF(q),K)<br>y=vector(GF(q),B)<br><span class="hljs-built_in">print</span>(datetime.now())<br>ans=M.solve_right(y)<br><span class="hljs-built_in">print</span>(datetime.now())<br>s2=(ans[:n])<br><span class="hljs-comment"># s_debug=vector(GF(q),s_debug)</span><br><span class="hljs-built_in">print</span>(s2)<br><span class="hljs-built_in">print</span>(datetime.now())<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>s=[Integer(s2[i]) <span class="hljs-keyword">if</span> s2[i]&lt;(q//<span class="hljs-number">2</span>) <span class="hljs-keyword">else</span> Integer(s2[i])-Integer(q) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s2))]<br>sh.sendline(<span class="hljs-built_in">str</span>(s).encode())<br><span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">8</span>).decode())<br><span class="hljs-built_in">print</span>(datetime.now())<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">[x] Starting local process &#x27;/home/huangx607087/mambaforge/envs/sage/bin/sage&#x27;</span><br><span class="hljs-string">[+] Starting local process &#x27;/home/huangx607087/mambaforge/envs/sage/bin/sage&#x27;: pid 264101</span><br><span class="hljs-string">2025-02-19 09:15:47.298775</span><br><span class="hljs-string">2025-02-19 09:18:24.058344</span><br><span class="hljs-string">2025-02-19 09:22:58.562647</span><br><span class="hljs-string">2025-02-19 09:27:38.079743</span><br><span class="hljs-string">(413089, 182407, 281293, 514536, 416848, 162144, 111292, 567942, 105638, 320217, 597752, 148614, 475740, 104923, 168548, 419776, 331148, 480665, 27938, 144285, 536717, 23041, 407741, 535865, 292620, 296206, 263837, 411101, 178021, 459126, 582200, 356604, 260864, 107465, 198975, 603533, 614391, 399204, 281846, 656596, 336371, 43032, 469948, 485132, 292949, 551266, 481705, 627344, 294383, 16843, 351274, 499494, 400866, 16300, 397952, 418611, 329186, 171588, 126742, 35187, 227634, 47279, 558263, 274274, 176943, 213254, 136124, 458182, 207387, 110241, 561213, 643075, 37905, 81904, 541660, 591129, 252387, 442913, 59602, 291489, 16114, 33889, 42797, 178984, 170978, 125577, 44397, 84513, 42300, 190430, 131960, 171794, 438727, 575807, 132652, 483489, 537433, 148391, 295287, 611719, 433771, 511639, 429386, 96772, 149829, 391049, 203110, 134839, 614783, 116974, 563429, 625857, 583438, 296242, 287114, 567163, 311443, 300000, 319030, 157568, 340472, 574056, 58440, 504748, 659358, 158919, 513009, 450907, 372321, 505831, 160026, 450642, 598087, 385168, 351908, 608844, 282572, 345722, 528174, 464689, 476965, 642386, 235728, 498266, 341476, 84067, 177778, 590226, 41793, 286838, 98328, 123973, 354428, 101602, 362267, 6228, 519006, 43713, 314830, 37731, 479235, 46098, 147882, 455284, 472502, 508348, 408861, 509481, 50884, 609377, 5300, 625054, 139267, 436879, 7235, 344990, 388357, 645294, 314985, 497667, 663837, 527331, 13209, 457430, 574164, 460940, 171654, 38269, 124149, 583682, 216156, 356979, 571283, 665300, 411729, 172241, 320462)</span><br><span class="hljs-string">2025-02-19 09:27:38.080569</span><br><span class="hljs-string">[x] Receiving all data</span><br><span class="hljs-string">[x] Receiving all data: 1B</span><br><span class="hljs-string">[x] Receiving all data: 95B</span><br><span class="hljs-string">[+] Receiving all data: Done (95B)</span><br><span class="hljs-string">[*] Process &#x27;/home/huangx607087/mambaforge/envs/sage/bin/sage&#x27; stopped with exit code 0 (pid 264101)</span><br><span class="hljs-string"> Congratulations! You have signed in successfully.</span><br><span class="hljs-string">flag&#123;success_at_2025-02-19_09:27:38.082088&#125;</span><br><span class="hljs-string">2025-02-19 09:27:38.292391</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="3-N1CTF-junior-StrangeCurve"><a href="#3-N1CTF-junior-StrangeCurve" class="headerlink" title="3.[N1CTF_junior]StrangeCurve"></a>3.[N1CTF_junior]StrangeCurve</h2><h3 id="3x01-é¢˜ç›®ä»£ç "><a href="#3x01-é¢˜ç›®ä»£ç " class="headerlink" title="3x01 é¢˜ç›®ä»£ç "></a>3x01 é¢˜ç›®ä»£ç </h3><p>å…ˆçœ‹ä¸€çœ¼é¢˜ç›®ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br>FLAG = <span class="hljs-string">&#x27;flag&#123;&#x27;</span>+<span class="hljs-built_in">str</span>(uuid4())+<span class="hljs-string">&#x27;&#125;&#x27;</span><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(FLAG, <span class="hljs-built_in">str</span>):<br>    FLAG = FLAG.encode()<br><span class="hljs-comment"># print(FLAG)</span><br>ells = [*primes(<span class="hljs-number">3</span>, <span class="hljs-number">102</span>)] + [<span class="hljs-number">149</span>]<br>mxe = <span class="hljs-number">6</span><br>p = <span class="hljs-number">4</span> * prod(ells) - <span class="hljs-number">1</span><br>Fp = GF(p)<br>Fp2 = GF(p ** <span class="hljs-number">2</span>)<br>base = EllipticCurve(Fp2, [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>])<br>privkey = [randint(<span class="hljs-number">0</span>, mxe) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> ells]<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;testans&#x27;</span>+(<span class="hljs-built_in">str</span>(datetime.now())[<span class="hljs-number">11</span>:-<span class="hljs-number">7</span>]),<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-built_in">str</span>(FLAG)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    f.write(<span class="hljs-built_in">str</span>(privkey))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">to_montgomery</span>(<span class="hljs-params">E: EllipticCurve</span>) -&gt; <span class="hljs-built_in">int</span>:<br>    Ep = E.change_ring(Fp).short_weierstrass_model()<br>    a, b = Fp(Ep.a4()), Fp(Ep.a6())<br>    P.&lt;x&gt; = PolynomialRing(Fp)<br>    r = (x^<span class="hljs-number">3</span> + a*x + b).roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    s = sqrt(<span class="hljs-number">3</span> * r^<span class="hljs-number">2</span> + a)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_square(s):<br>        s = -s<br>    A = <span class="hljs-number">3</span> * r / s<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(Fp(A))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">action</span>(<span class="hljs-params">key: <span class="hljs-built_in">list</span>, r: <span class="hljs-built_in">int</span></span>) -&gt; EllipticCurve:<br>    E = base<br>    <span class="hljs-built_in">round</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">any</span>(key):<br>        E._order = (p + <span class="hljs-number">1</span>) ** <span class="hljs-number">2</span><br>        k = prod([l <span class="hljs-keyword">for</span> l, e <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ells, key) <span class="hljs-keyword">if</span> e &gt; <span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            P = E.lift_x(Fp.random_element())<br>            <span class="hljs-keyword">if</span> randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">round</span> == r) != (P.xy()[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> Fp):<br>                <span class="hljs-keyword">break</span><br>        P *= (p + <span class="hljs-number">1</span>) // k<br>        <span class="hljs-keyword">for</span> i, (l, e) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(ells, key)):<br>            <span class="hljs-keyword">if</span> e == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br>            Q = k // l * P<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Q:<br>                <span class="hljs-keyword">continue</span><br>            Q._order = l<br>            phi = E.isogeny(Q)<br>            E, P = phi.codomain(), phi(P)<br>            key[i] -= <span class="hljs-number">1</span><br>            k //= l<br>        <span class="hljs-built_in">round</span> += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> E<br><br>key = sha256(<span class="hljs-built_in">str</span>(privkey).encode()).digest()<br>cipher = AES.new(key = key, mode = AES.MODE_ECB)<br>ct = cipher.encrypt(pad(FLAG, <span class="hljs-number">16</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;This is your flag: <span class="hljs-subst">&#123;ct.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    r = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Get your Curve &gt;&quot;</span>).strip())<br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">0</span> &lt;= r &lt; <span class="hljs-number">16</span><br>    E = action(privkey.copy(), r)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(to_montgomery(E)))<br><br></code></pre></td></tr></table></figure><h3 id="3x02-é¢˜ç›®åˆ†æ"><a href="#3x02-é¢˜ç›®åˆ†æ" class="headerlink" title="3x02 é¢˜ç›®åˆ†æ"></a>3x02 é¢˜ç›®åˆ†æ</h3><p>è¿™ä¸ªé¢˜ç›®å®ç°çš„æ˜¯CSIDHçš„è¿‡ç¨‹ï¼Œä½†å¯¹CSIDHåšäº†æ”¹åŠ¨ï¼Œæˆ‘ä»¬æ³¨æ„actionå‡½æ•°ä¸­çš„è¿™ä¸€éƒ¨åˆ†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    P = E.lift_x(Fp.random_element())<br>    <span class="hljs-keyword">if</span> randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">round</span> == r) != (P.xy()[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> Fp):<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œåœ¨ç¬¬roundè½®ä¸­ï¼Œæœ‰ä¸€åŠæ¦‚ç‡ä½¿å¾—CISDHä¸­å–çš„ $P$ ç‚¹çš„ $y$ å€¼åœ¨ $\mathbb F_{p^2}$ è€Œä¸æ˜¯ $\mathbb F_{p}$ ä¸Šï¼Œå›é¡¾åˆšå­¦è¿‡çš„ CISDHï¼Œè¿™ä¼šå¯¼è‡´åœ¨ç¬¬roundè½®åŒæºçš„æ–¹å‘å˜ä¸ºåŸæ¥çš„åæ–¹å‘ã€‚å¦‚æœåŸæ¥çš„å¯†é’¥ä¸º $[3,0,3,2,1,4]$ï¼Œé‚£ä¹ˆç†æƒ³æƒ…å†µä¸‹ï¼Œå¯†é’¥çš„å˜åŒ–åº”å½“ä¸ºï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">round</span> <span class="hljs-number">0</span>:[+,<span class="hljs-number">0</span>,+,+,+,+]<br><span class="hljs-attribute">round</span> <span class="hljs-number">1</span>:[+,<span class="hljs-number">0</span>,+,+,<span class="hljs-number">0</span>,+]<br><span class="hljs-attribute">round</span> <span class="hljs-number">2</span>:[+,<span class="hljs-number">0</span>,+,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,+]<br><span class="hljs-attribute">round</span> <span class="hljs-number">3</span>:[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,+]<br><span class="hljs-attribute">sum</span>:   <span class="hljs-meta"> [3,0,3,2,1,4]</span><br></code></pre></td></tr></table></figure><p>å‡è®¾round&#x3D;2æ—¶å‘ç”Ÿäº†ç¿»è½¬ï¼Œé‚£ä¹ˆå®é™…æƒ…å†µå°±æ˜¯</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">round</span> <span class="hljs-number">0</span>:[+,<span class="hljs-number">0</span>,+,+,+,+]<br><span class="hljs-attribute">round</span> <span class="hljs-number">1</span>:[+,<span class="hljs-number">0</span>,+,+,<span class="hljs-number">0</span>,+]<br><span class="hljs-attribute">round</span> <span class="hljs-number">2</span>:[-,<span class="hljs-number">0</span>,-,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-]<br><span class="hljs-attribute">round</span> <span class="hljs-number">3</span>:[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,+]<br><span class="hljs-attribute">sum</span>:   <span class="hljs-meta"> [1,0,1,2,1,2]</span><br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå‘ç”Ÿç¿»è½¬ï¼Œé‚£ä¹ˆç¬¬ $2$ è½®ä¸­ï¼Œæ‰€æœ‰å¯†é’¥å€¼å¤§äº $2$ çš„ç§é’¥åˆ†é‡éƒ½ä¼šé€†ç€èµ°ä¸€æ­¥ï¼Œè¿™æ ·å’Œæ­£ç¡®çš„å¯†é’¥å°±ç›¸å·®äº† $2$ æ­¥ã€‚ç”¨æ›´åŠ ä¸¥è°¨çš„è¯´æ³•å°±æ˜¯ï¼šè®¾æ­£ç¡®çš„å…±äº«å€¼ä¸º $V$ï¼Œé‚£ä¹ˆç¬¬ $k$ è½®è‹¥å‘ç”Ÿç¿»è½¬ï¼Œåˆ™æœ€ç»ˆçš„å…±äº«å€¼ä¸º $[(\prod_{e_i&gt;k}\ell_i)^{-2}]V$ ã€‚</p><p>ä½†æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œç”±äºåœ¨CSIDHä¸­ï¼Œå¯¹äºä¸åŒçš„ $\ell$ï¼Œ$P$ æ˜¯éšæœºå–ä¸€ä¸ªé˜¶ä¸º $\ell$ çš„ç”µè„‘ç‚¹ï¼Œå› æ­¤å¯¹äºæ¯ä¸ª $\ell$ï¼Œå‡æœ‰ $1&#x2F;\ell$ çš„æ¦‚ç‡å–åˆ°æ— ç©·è¿œç‚¹ $\mathcal O$ï¼Œè¿™å°±ä¼šå¯¼è‡´è¿™ä¸€è½®æå‰ç»“æŸï¼Œä½†ä¸ä¼šå½±å“åˆ°æœ€ç»ˆç»“æœï¼ˆåœ¨ $\ell$ è¾ƒå°çš„æ—¶å€™è¯¥æƒ…å†µå‡ºç°è¾ƒå¤šï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">P *= (p + <span class="hljs-number">1</span>) // k<br><span class="hljs-keyword">for</span> i, (l, e) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(ells, key)):<br>    <span class="hljs-keyword">if</span> e == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">continue</span><br>    Q = k // l * P<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Q:<br>        <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„ç¤ºæ„å›¾è¡¨ç¤ºï¼Œè™½ç„¶æœ€ç»ˆç»“æœä¸€æ ·ï¼Œä½†è½®æ•°å¤šäº† 1 è½®ã€‚ä¸è¿‡è¿™ç§é”™è¯¯å¯ä»¥ç”¨å¤šæ¬¡å–æ ·è§„é¿ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">round</span> <span class="hljs-number">0</span>:[+,<span class="hljs-number">0</span>,+,+,+,+]<br><span class="hljs-attribute">round</span> <span class="hljs-number">1</span>:[+,<span class="hljs-number">0</span>,+,+,<span class="hljs-number">0</span>,+]<br><span class="hljs-attribute">round</span> <span class="hljs-number">2</span>:[+,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br><span class="hljs-attribute">not</span> Q,contiune!<br><span class="hljs-attribute">round</span> <span class="hljs-number">3</span>:[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,+,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,+]<br><span class="hljs-attribute">round</span> <span class="hljs-number">4</span>:[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,+]<br><span class="hljs-attribute">sum</span>:   <span class="hljs-meta"> [3,0,3,2,1,4]</span><br></code></pre></td></tr></table></figure><p>ä½†å°±ç®—å‡ºç°ä¸Šé¢è¿™ç§æƒ…å†µï¼Œç”±äºç§é’¥çš„æœ€å¤§å€¼ä¸º $6$ï¼Œè€Œé¢˜ç›®å…è®¸è¾“å…¥çš„æœ€å¤§å€¼ä¸º $15$ã€‚ç»è¿‡æµ‹è¯•å‘ç°ï¼Œroundçš„å€¼å‡ ä¹ä¸ä¼šè¶…è¿‡ $11$ï¼Œå› æ­¤å¯ä»¥å…ˆå‘é€ $15$ï¼Œè·å–æ­£ç¡®çš„å…±äº«ç§˜å¯†å€¼ ï¼ˆä¹Ÿå°±æ˜¯è’™å“¥é©¬åˆ©å‚æ•° $a_{15}$ï¼‰ï¼Œç„¶åå¤šæ¬¡æµ‹è¯• $5,4,3,2,1,0$ï¼Œå–æ¬¡æœ€å¤§æ¦‚ç‡ï¼ˆå› ä¸ºæœ€å¤§æ¦‚ç‡æ˜¯ $a_{15}$ï¼Œè¯¥æ¦‚ç‡å åˆ°ä¸€åŠï¼Œæµ‹äº†ä¸€ä¸‹ï¼Œå–æ · $600$ æ¬¡åŸºæœ¬å°±å¯ä»¥å¾—åˆ°ç†æƒ³çŠ¶æ€ä¸‹çš„ $a_5,â€¦,a_0$ å€¼ï¼‰ã€‚</p><p>ç„¶åçœ‹äº†ä¸€ä¸‹ <a href="https://wleukocytec.github.io/2025/02/11/2025-n1junior-crypto/">å‡ºé¢˜äººçš„åšå®¢</a>ï¼Œä»–ç»™å‡ºçš„åšæ³•æ˜¯MITMï¼Œä¹Ÿå°±æ˜¯ä¸­é—´ç›¸é‡æ”»å‡»ï¼Œä½†æ²¡æœ‰ç»™å‡ºè¿›ä¸€æ­¥çš„ç»†èŠ‚ã€‚ç„¶åæˆ‘å°±ä»¥ä¸ºæ˜¯ä» $a_{15},a_{5},a_{4},a_{3}$ èµ°ä¸€ä¸ªè¿‡ç¨‹ï¼Œç„¶åå†ä» $a_{0},a_1,a_2,a_3$ èµ°ä¸€ä¸ªè¿‡ç¨‹ï¼Œæ‰¾ç›¸åŒçš„ $a_3$ã€‚è€ƒè™‘åˆ°ç§é’¥æ˜¯ $0\sim6$ çš„å–å€¼ï¼Œä¸”ç§é’¥é•¿åº¦ä¸º $26$ï¼Œå› æ­¤å¯ä»¥èµŒæ¯ä¸ªå€¼å‡ºç°æ¬¡æ•°ä¸è¶…è¿‡ $5$ï¼Œæ¯ä¸€è½®éœ€è¦æšä¸¾ $83000$ å¤šæ¬¡ï¼Œè€—æ—¶ä¸‰å°æ—¶ï¼Œå³ä½¿å¼€å››è¿›ç¨‹ä¹Ÿè¦ 40 åˆ†é’Ÿä¸€è½®ï¼Œ$1000$ æ¬¡çš„æˆåŠŸæ¦‚ç‡çº¦ä¸º $180$ æ¬¡ã€‚</p><h3 id="3x03-æ­£ç¡®åšæ³•"><a href="#3x03-æ­£ç¡®åšæ³•" class="headerlink" title="3x03 æ­£ç¡®åšæ³•"></a>3x03 æ­£ç¡®åšæ³•</h3><p>ç„¶åæˆ‘é—®äº†ä¸€ä¸‹å‡ºé¢˜äººï¼Œç»“æœå‘ç°æ˜¯ä» $a_{15}$ å‡ºå‘ï¼Œæ¯æ¬¡åˆ†åˆ«åªè€ƒè™‘ä¸€ä¸ªå€¼ã€‚åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œè®¾ $e&#x3D;[6,0,6,2,5,4,6,3]$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰ï¼š<br>$$<br>a_{5}&#x3D;[-2,0,-2,0,0,0,-2,0]a_{15}<br>$$<br>æˆ‘ä»¬å¯ä»¥å¯¹åŠæ‰¾ä¸€ä¸ªä¸­é—´å€¼ $a_{5,15}$ï¼Œæ»¡è¶³ï¼š<br>$$<br>a_{5,15}&#x3D;[-2,0,-2,0,0,0,0,0]<br>$$<br>è¿™æ ·ï¼Œä» $a_{15}$ å»é€†æ¨ $a_{5,15}$ï¼Œåªéœ€è¦è€ƒè™‘ååŠéƒ¨åˆ†ï¼Œä» $a_5$ å»æ­£æ¨ $a_{5,15}$ï¼Œåªéœ€è¦å»æ¨å‰åŠéƒ¨åˆ†ï¼Œä¸¤è¾¹æšä¸¾çš„å¤æ‚åº¦å°±ä¼šé™ä½åˆ°åŸæ¥çš„ä¸€åŠã€‚</p><p>å¯ä»¥ç›´æ¥åˆ©ç”¨ä»–çš„actionï¼ŒæŠŠroundè®¾ç½®æˆ9999å»æ­£æ¨ã€‚è€Œé€†æ¨æ ¹æ®CSIDHçš„åŠ ä¸‰ç­‰ä»·æ€§ï¼Œä¹Ÿå°±æ˜¯ <code>[3+i for i in privkey]</code> ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠä¸éœ€è¦é€†æ¨çš„éƒ¨åˆ†è®¾ç½®æˆ3ï¼Œéœ€è¦é€†æ¨çš„éƒ¨åˆ†è®¾ç½®æˆ1ã€‚å¯¹åº”ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">action</span>(<span class="hljs-params">key: <span class="hljs-built_in">list</span>, r: <span class="hljs-built_in">int</span>,ma2:<span class="hljs-built_in">int</span></span>) -&gt; EllipticCurve:<br>    E = EllipticCurve(Fp2,[<span class="hljs-number">0</span>,ma2,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>    <span class="hljs-built_in">round</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">any</span>(key):<br>        E._order = (p + <span class="hljs-number">1</span>) ** <span class="hljs-number">2</span><br>        k = prod([l <span class="hljs-keyword">for</span> l, e <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ells, key) <span class="hljs-keyword">if</span> e &gt; <span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            P = E.lift_x(Fp.random_element())<br>            <span class="hljs-keyword">if</span> randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">round</span> == r) != (P.xy()[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> Fp):<br>                <span class="hljs-keyword">break</span><br>        P *= (p + <span class="hljs-number">1</span>) // k<br>        <span class="hljs-keyword">for</span> i, (l, e) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(ells, key)):<br>            <span class="hljs-keyword">if</span> e == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br>            Q = k // l * P<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Q:<br>                <span class="hljs-keyword">continue</span><br>            Q._order = l<br>            phi = E.isogeny(Q,algorithm=<span class="hljs-string">&#x27;factored&#x27;</span>)<br>            E, P = phi.codomain(), phi(P)<br>            key[i] -= <span class="hljs-number">1</span><br>            k //= l<br>        <span class="hljs-built_in">round</span> += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> E<br><span class="hljs-keyword">for</span> ai <span class="hljs-keyword">in</span> [a5,a4,a3,a2,a1,a0]:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Timestamp K:&#x27;</span>,<span class="hljs-built_in">str</span>(datetime.now()))<br>    D=<span class="hljs-built_in">dict</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">13</span>)):<br>        priv=[<span class="hljs-number">2</span>*<span class="hljs-built_in">bool</span>(i&amp;(<span class="hljs-number">1</span>&lt;&lt;j)) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>)]+[<span class="hljs-number">0</span>]*<span class="hljs-number">13</span><br>        Et=action(priv.copy(),<span class="hljs-number">9999</span>,ai)<br>        x=to_montgomery(Et)<br>        D[x]=i<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">13</span>)):<br>        priv=[<span class="hljs-number">3</span>]*<span class="hljs-number">13</span>+[<span class="hljs-number">3</span>-<span class="hljs-number">2</span>*(<span class="hljs-built_in">bool</span>(i&amp;(<span class="hljs-number">1</span>&lt;&lt;j))) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>)]<br>        Et=action(priv.copy(),<span class="hljs-number">9999</span>,a15)<br>        at=to_montgomery(Et)<br>        x=D.get(at,<span class="hljs-number">0</span>)+D.get(p-at,<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">if</span>(x):<br>            <span class="hljs-built_in">print</span>(i,x)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>ä½†è¿™æ ·ç¬¬äºŒä¸ªæ­¥éª¤ä¼šèµ°å¾—å¾ˆæ…¢ã€‚å› ä¸ºprivä¸­æœ‰å¾ˆå¤š $3$ï¼Œæ„å‘³ç€ç¨‹åºè‡³å°‘è¦èµ°ä¸‰è½®ã€‚</p><p>æ‰€ä»¥å¯ä»¥æŠŠactionè¿™ä¹ˆæ”¹ï¼Œè¿™æ ·å°±åè¿‡æ¥èµ°äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">actioninv</span>(<span class="hljs-params">key: <span class="hljs-built_in">list</span>, r: <span class="hljs-built_in">int</span>,ma2:<span class="hljs-built_in">int</span></span>) -&gt; EllipticCurve:<br>    E = EllipticCurve(Fp2,[<span class="hljs-number">0</span>,ma2,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>    <span class="hljs-built_in">round</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">any</span>(key):<br>        E._order = (p + <span class="hljs-number">1</span>) ** <span class="hljs-number">2</span><br>        k = prod([l <span class="hljs-keyword">for</span> l, e <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ells, key) <span class="hljs-keyword">if</span> e &gt; <span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            P = E.lift_x(Fp.random_element())<br>            <span class="hljs-keyword">if</span> randint(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) != (P.xy()[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> Fp): <span class="hljs-comment">#changed!</span><br>                <span class="hljs-keyword">break</span><br>        P *= (p + <span class="hljs-number">1</span>) // k<br>        <span class="hljs-comment">#complete the same as action below.</span><br></code></pre></td></tr></table></figure><h3 id="3x04-exp"><a href="#3x04-exp" class="headerlink" title="3x04 exp"></a>3x04 exp</h3><h4 id="3-4-1-åˆæ­¥exp"><a href="#3-4-1-åˆæ­¥exp" class="headerlink" title="3.4.1 åˆæ­¥exp"></a>3.4.1 åˆæ­¥exp</h4><p>æ ¹æ®3x03çš„åˆ†æï¼Œåˆæ­¥ç»™å‡ºexpã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Timestamp 1:&#x27;</span>,<span class="hljs-built_in">str</span>(datetime.now()))<br>sh=process([<span class="hljs-string">&#x27;sage&#x27;</span>,<span class="hljs-string">&#x27;task16.sage&#x27;</span>])<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>ciph=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br><span class="hljs-built_in">print</span>(ciph)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">x,tmz</span>):        <br>    D=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(tmz)):<br>        sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>        sh.sendline(<span class="hljs-built_in">str</span>(x).encode())<br>        res=sh.recvline(keepends=<span class="hljs-literal">False</span>).decode()<br>        D.append(<span class="hljs-built_in">eval</span>(res))<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">cmp</span>(<span class="hljs-params">arg</span>):<br>        <span class="hljs-keyword">return</span> -arg[<span class="hljs-number">1</span>]<br>    R=<span class="hljs-built_in">sorted</span>([(i,D.count(i)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span>(D)],key=cmp)<br>    <span class="hljs-keyword">return</span> R<br>D15=get(<span class="hljs-number">15</span>,<span class="hljs-number">50</span>)<br>D5=get(<span class="hljs-number">5</span>,<span class="hljs-number">600</span>)<br>D4=get(<span class="hljs-number">4</span>,<span class="hljs-number">600</span>)<br>D3=get(<span class="hljs-number">3</span>,<span class="hljs-number">600</span>)<br>D2=get(<span class="hljs-number">2</span>,<span class="hljs-number">600</span>)<br>D1=get(<span class="hljs-number">1</span>,<span class="hljs-number">600</span>)<br>D0=get(<span class="hljs-number">0</span>,<span class="hljs-number">600</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Timestamp 2:&#x27;</span>,<span class="hljs-built_in">str</span>(datetime.now()))<br><br>sh.close()<br>a15=D15[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>a5,a4,a3,a2,a1,a0=[arr[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> arr <span class="hljs-keyword">in</span> [D5,D4,D3,D2,D1,D0]]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a15=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a5=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a4=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a3=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a2=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a1=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a0=&#125;</span>&#x27;</span>)<br>ells = [*primes(<span class="hljs-number">3</span>, <span class="hljs-number">102</span>)] + [<span class="hljs-number">149</span>]<br>p = <span class="hljs-number">4</span> * prod(ells) - <span class="hljs-number">1</span><br>Fp=GF(p)<br>Fp2=GF(p**<span class="hljs-number">2</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">to_montgomery</span>(<span class="hljs-params">E: EllipticCurve</span>) -&gt; <span class="hljs-built_in">int</span>:<br>    Ep = E.change_ring(Fp).short_weierstrass_model()<br>    a, b = Fp(Ep.a4()), Fp(Ep.a6())<br>    P.&lt;x&gt; = PolynomialRing(Fp)<br>    r = (x^<span class="hljs-number">3</span> + a*x + b).roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    s = sqrt(<span class="hljs-number">3</span> * r^<span class="hljs-number">2</span> + a)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_square(s):<br>        s = -s<br>    A = <span class="hljs-number">3</span> * r / s<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(Fp(A))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">action</span>(<span class="hljs-params">key: <span class="hljs-built_in">list</span>, r: <span class="hljs-built_in">int</span>,ma2:<span class="hljs-built_in">int</span></span>) -&gt; EllipticCurve:<br>    E = EllipticCurve(Fp2,[<span class="hljs-number">0</span>,ma2,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>    <span class="hljs-built_in">round</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">any</span>(key):<br>        E._order = (p + <span class="hljs-number">1</span>) ** <span class="hljs-number">2</span><br>        k = prod([l <span class="hljs-keyword">for</span> l, e <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ells, key) <span class="hljs-keyword">if</span> e &gt; <span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            P = E.lift_x(Fp.random_element())<br>            <span class="hljs-keyword">if</span> randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">round</span> == r) != (P.xy()[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> Fp):<br>                <span class="hljs-keyword">break</span><br>        P *= (p + <span class="hljs-number">1</span>) // k<br>        <span class="hljs-keyword">for</span> i, (l, e) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(ells, key)):<br>            <span class="hljs-keyword">if</span> e == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br>            Q = k // l * P<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Q:<br>                <span class="hljs-keyword">continue</span><br>            Q._order = l<br>            phi = E.isogeny(Q,algorithm=<span class="hljs-string">&#x27;factored&#x27;</span>)<br>            E, P = phi.codomain(), phi(P)<br>            key[i] -= <span class="hljs-number">1</span><br>            k //= l<br>        <span class="hljs-built_in">round</span> += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> E<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">actioninv</span>(<span class="hljs-params">key: <span class="hljs-built_in">list</span>, r: <span class="hljs-built_in">int</span>,ma2:<span class="hljs-built_in">int</span></span>) -&gt; EllipticCurve:<br>    E = EllipticCurve(Fp2,[<span class="hljs-number">0</span>,ma2,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>    <span class="hljs-built_in">round</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">any</span>(key):<br>        E._order = (p + <span class="hljs-number">1</span>) ** <span class="hljs-number">2</span><br>        k = prod([l <span class="hljs-keyword">for</span> l, e <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ells, key) <span class="hljs-keyword">if</span> e &gt; <span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            P = E.lift_x(Fp.random_element())<br>            <span class="hljs-keyword">if</span> randint(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) != (P.xy()[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> Fp):<br>                <span class="hljs-keyword">break</span><br>        P *= (p + <span class="hljs-number">1</span>) // k<br>        <span class="hljs-keyword">for</span> i, (l, e) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(ells, key)):<br>            <span class="hljs-keyword">if</span> e == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br>            Q = k // l * P<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Q:<br>                <span class="hljs-keyword">continue</span><br>            Q._order = l<br>            phi = E.isogeny(Q,algorithm=<span class="hljs-string">&#x27;factored&#x27;</span>)<br>            E, P = phi.codomain(), phi(P)<br>            key[i] -= <span class="hljs-number">1</span><br>            k //= l<br>        <span class="hljs-built_in">round</span> += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> E<br><span class="hljs-keyword">for</span> ai <span class="hljs-keyword">in</span> [a5,a4,a3,a2,a1,a0]:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Timestamp K:&#x27;</span>,<span class="hljs-built_in">str</span>(datetime.now()))<br>    D=<span class="hljs-built_in">dict</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">13</span>)):<br>        priv=[<span class="hljs-number">2</span>*<span class="hljs-built_in">bool</span>(i&amp;(<span class="hljs-number">1</span>&lt;&lt;j)) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>)]+[<span class="hljs-number">0</span>]*<span class="hljs-number">13</span><br>        Et=action(priv.copy(),<span class="hljs-number">9999</span>,ai)<br>        x=to_montgomery(Et)<br>        D[x]=i<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">13</span>)):<br>        priv=[<span class="hljs-number">0</span>]*<span class="hljs-number">13</span>+[<span class="hljs-number">2</span>*(<span class="hljs-built_in">bool</span>(i&amp;(<span class="hljs-number">1</span>&lt;&lt;j))) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>)]<br>        Et=actioninv(priv.copy(),<span class="hljs-number">9999</span>,a15)<br>        at=to_montgomery(Et)<br>        x=D.get(at,<span class="hljs-number">0</span>)+D.get(p-at,<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">if</span>(x):<br>            <span class="hljs-built_in">print</span>(i,x)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Timestamp 3:&#x27;</span>,<span class="hljs-built_in">str</span>(datetime.now()))<br></code></pre></td></tr></table></figure><p> è¿è¡Œç»“æœï¼Œè€—æ—¶çº¦ 2hã€‚</p><p><img src="/2025/02/19/25Feb1/12.png" alt="12"></p><p>ç¨‹åºæ¯ä¸€è½®è¾“å‡ºç»“æœä¸ºï¼š$(2,1056),(166,5160),(174,5164),(702,5548),(1022,5565),(2046,6079)$ï¼Œé‚£ä¹ˆæ•´åˆè¿™äº›ç»“æœå’Œflagçš„å¯†æ–‡ï¼Œå°±å¯ä»¥è§£å¯†äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">L=[(<span class="hljs-number">2</span>,<span class="hljs-number">1056</span>),(<span class="hljs-number">166</span>,<span class="hljs-number">5160</span>),(<span class="hljs-number">174</span>,<span class="hljs-number">5164</span>),(<span class="hljs-number">702</span>,<span class="hljs-number">5548</span>),(<span class="hljs-number">1022</span>,<span class="hljs-number">5565</span>),(<span class="hljs-number">2046</span>,<span class="hljs-number">6079</span>)]<br>A=[<span class="hljs-number">0</span>]*<span class="hljs-number">26</span><br><span class="hljs-keyword">for</span> l,r <span class="hljs-keyword">in</span> L:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>):<br>        A[<span class="hljs-number">13</span>+i]+=<span class="hljs-built_in">bool</span>(l&amp;(<span class="hljs-number">1</span>&lt;&lt;i))<br>        A[i]+=<span class="hljs-built_in">bool</span>(r&amp;(<span class="hljs-number">1</span>&lt;&lt;i))<br><br><span class="hljs-built_in">print</span>(A)<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> *<br><br>key = sha256(<span class="hljs-built_in">str</span>(A).encode()).digest()<br>ciph=<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;999a830887d47267ddb021c16136d055ac729f8f689ba382d471aa6721ebf0380c381f66123cd4042bb561f9ad2f0cdf&#x27;</span>)<br>aes=AES.new(key,AES.MODE_ECB)<br>msg=aes.decrypt(ciph)<br><span class="hljs-built_in">print</span>(unpad(msg,<span class="hljs-number">16</span>))<br><span class="hljs-comment">#flag&#123;5a8f0629-d05c-441b-9b4c-17caf1b7b838&#125;</span><br></code></pre></td></tr></table></figure><p>ä½†æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„è¿›åº¦æ¡ï¼šè¿™ä¸€éƒ¨åˆ†é‚£æˆ‘ä»¬å»ºç«‹å­—å…¸è¿˜æ˜¯æ¶ˆè€—äº†éå¸¸é•¿çš„æ—¶é—´ã€‚</p><h4 id="3-4-2-exp"><a href="#3-4-2-exp" class="headerlink" title="3.4.2 exp++"></a>3.4.2 exp++</h4><p>å›é¡¾åˆšæ‰çš„æ€è·¯ä¸éš¾æ³¨æ„åˆ°ï¼š$a_{15}$ åˆ° $a_{5}$ çš„æšä¸¾ä¸­ï¼Œæˆ‘ä»¬æ‰€æœ‰ç§é’¥å€¼ $e_i&gt;5$ çš„éƒ¨åˆ†ä¼šè¢«æ ‡è®°å‡ºæ¥ï¼›è€Œ $a_{15}$ å’Œ $a_{4}$ çš„æšä¸¾ä¸­ï¼Œæ‰€æœ‰ç§é’¥å€¼ $e_i&gt;4$ çš„éƒ¨åˆ†ä¼šè¢«æ ‡è®°å‡ºæ¥ã€‚åè€…æ ‡è®°çš„å†…å®¹æ˜¯å®Œå…¨åŒ…å«å‰è€…çš„ã€‚å› æ­¤å¯ä»¥è¿›ä¸€æ­¥è®¾ç½®ä¸¤ä¸ªçŠ¶æ€æ ‡è®°ï¼Œæ¶ˆé™¤æ‰ä¸ç¬¦åˆçš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯ $a_4$ çš„æ ‡è®°æ²¡æœ‰åŒ…å« $a_5$ çš„æƒ…å†µï¼Œæˆ‘ä»¬åœ¨è¿™ç§æƒ…å†µä¸‹ç›´æ¥ <code>contiue</code> æ‰ï¼Œä¸åš <code>action</code> ä»¥åŠ é€Ÿè¿‡ç¨‹ã€‚</p><p>è¿™ä¸€éƒ¨åˆ†ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">Hpos,Hneg=<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>L=[]<br><span class="hljs-keyword">for</span> ai <span class="hljs-keyword">in</span> [a5,a4,a3,a2,a1,a0]:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Timestamp K:&#x27;</span>,<span class="hljs-built_in">str</span>(datetime.now()))<br>    D=<span class="hljs-built_in">dict</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">13</span>)):<br>        <span class="hljs-keyword">if</span>((Hpos&amp;i)!=Hpos):<br>            <span class="hljs-keyword">continue</span><br>        priv=[<span class="hljs-number">2</span>*<span class="hljs-built_in">bool</span>(i&amp;(<span class="hljs-number">1</span>&lt;&lt;j)) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>)]+[<span class="hljs-number">0</span>]*<span class="hljs-number">13</span><br>        Et=action(priv.copy(),<span class="hljs-number">9999</span>,ai)<br>        x=to_montgomery(Et)<br>        D[x]=i<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">13</span>)):<br>        <span class="hljs-keyword">if</span>((Hneg&amp;i)!=Hneg):<br>            <span class="hljs-keyword">continue</span><br>        priv=[<span class="hljs-number">0</span>]*<span class="hljs-number">13</span>+[<span class="hljs-number">2</span>*(<span class="hljs-built_in">bool</span>(i&amp;(<span class="hljs-number">1</span>&lt;&lt;j))) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>)]<br>        Et=actioninv(priv.copy(),<span class="hljs-number">9999</span>,a15)<br>        at=to_montgomery(Et)<br>        x=D.get(at,<span class="hljs-number">0</span>)+D.get(p-at,<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">if</span>(x):<br>            <span class="hljs-built_in">print</span>(i,x)<br>            L.append((i,x))<br>            Hneg,Hpos=i,x<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆå®Œæ•´çš„æ”¹å–„åçš„EXPå°±æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br>STIME=datetime.now()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Timestamp 1:&#x27;</span>,<span class="hljs-built_in">str</span>(datetime.now()))<br>sh=process([<span class="hljs-string">&#x27;sage&#x27;</span>,<span class="hljs-string">&#x27;task16.sage&#x27;</span>])<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>ciph=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip().decode()<br><span class="hljs-built_in">print</span>(ciph)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">x,tmz</span>):        <br>    D=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(tmz)):<br>        sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>        sh.sendline(<span class="hljs-built_in">str</span>(x).encode())<br>        res=sh.recvline(keepends=<span class="hljs-literal">False</span>).decode()<br>        D.append(<span class="hljs-built_in">eval</span>(res))<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">cmp</span>(<span class="hljs-params">arg</span>):<br>        <span class="hljs-keyword">return</span> -arg[<span class="hljs-number">1</span>]<br>    R=<span class="hljs-built_in">sorted</span>([(i,D.count(i)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span>(D)],key=cmp)<br>    <span class="hljs-keyword">return</span> R<br>D15=get(<span class="hljs-number">15</span>,<span class="hljs-number">50</span>)<br>D5=get(<span class="hljs-number">5</span>,<span class="hljs-number">600</span>)<br>D4=get(<span class="hljs-number">4</span>,<span class="hljs-number">600</span>)<br>D3=get(<span class="hljs-number">3</span>,<span class="hljs-number">600</span>)<br>D2=get(<span class="hljs-number">2</span>,<span class="hljs-number">600</span>)<br>D1=get(<span class="hljs-number">1</span>,<span class="hljs-number">600</span>)<br>D0=get(<span class="hljs-number">0</span>,<span class="hljs-number">600</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Timestamp 2:&#x27;</span>,<span class="hljs-built_in">str</span>(datetime.now()))<br><br>sh.close()<br>a15=D15[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>a5,a4,a3,a2,a1,a0=[arr[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> arr <span class="hljs-keyword">in</span> [D5,D4,D3,D2,D1,D0]]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a15=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a5=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a4=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a3=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a2=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a1=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a0=&#125;</span>&#x27;</span>)<br>ells = [*primes(<span class="hljs-number">3</span>, <span class="hljs-number">102</span>)] + [<span class="hljs-number">149</span>]<br>p = <span class="hljs-number">4</span> * prod(ells) - <span class="hljs-number">1</span><br>Fp=GF(p)<br>Fp2=GF(p**<span class="hljs-number">2</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">to_montgomery</span>(<span class="hljs-params">E: EllipticCurve</span>) -&gt; <span class="hljs-built_in">int</span>:<br>    Ep = E.change_ring(Fp).short_weierstrass_model()<br>    a, b = Fp(Ep.a4()), Fp(Ep.a6())<br>    P.&lt;x&gt; = PolynomialRing(Fp)<br>    r = (x^<span class="hljs-number">3</span> + a*x + b).roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    s = sqrt(<span class="hljs-number">3</span> * r^<span class="hljs-number">2</span> + a)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_square(s):<br>        s = -s<br>    A = <span class="hljs-number">3</span> * r / s<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(Fp(A))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">action</span>(<span class="hljs-params">key: <span class="hljs-built_in">list</span>, r: <span class="hljs-built_in">int</span>,ma2:<span class="hljs-built_in">int</span></span>) -&gt; EllipticCurve:<br>    E = EllipticCurve(Fp2,[<span class="hljs-number">0</span>,ma2,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>    <span class="hljs-built_in">round</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">any</span>(key):<br>        E._order = (p + <span class="hljs-number">1</span>) ** <span class="hljs-number">2</span><br>        k = prod([l <span class="hljs-keyword">for</span> l, e <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ells, key) <span class="hljs-keyword">if</span> e &gt; <span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            P = E.lift_x(Fp.random_element())<br>            <span class="hljs-keyword">if</span> randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">round</span> == r) != (P.xy()[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> Fp):<br>                <span class="hljs-keyword">break</span><br>        P *= (p + <span class="hljs-number">1</span>) // k<br>        <span class="hljs-keyword">for</span> i, (l, e) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(ells, key)):<br>            <span class="hljs-keyword">if</span> e == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br>            Q = k // l * P<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Q:<br>                <span class="hljs-keyword">continue</span><br>            Q._order = l<br>            phi = E.isogeny(Q,algorithm=<span class="hljs-string">&#x27;factored&#x27;</span>)<br>            E, P = phi.codomain(), phi(P)<br>            key[i] -= <span class="hljs-number">1</span><br>            k //= l<br>        <span class="hljs-built_in">round</span> += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> E<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">actioninv</span>(<span class="hljs-params">key: <span class="hljs-built_in">list</span>, r: <span class="hljs-built_in">int</span>,ma2:<span class="hljs-built_in">int</span></span>) -&gt; EllipticCurve:<br>    E = EllipticCurve(Fp2,[<span class="hljs-number">0</span>,ma2,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>    <span class="hljs-built_in">round</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">any</span>(key):<br>        E._order = (p + <span class="hljs-number">1</span>) ** <span class="hljs-number">2</span><br>        k = prod([l <span class="hljs-keyword">for</span> l, e <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ells, key) <span class="hljs-keyword">if</span> e &gt; <span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            P = E.lift_x(Fp.random_element())<br>            <span class="hljs-keyword">if</span> randint(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) != (P.xy()[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> Fp):<br>                <span class="hljs-keyword">break</span><br>        P *= (p + <span class="hljs-number">1</span>) // k<br>        <span class="hljs-keyword">for</span> i, (l, e) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(ells, key)):<br>            <span class="hljs-keyword">if</span> e == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br>            Q = k // l * P<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Q:<br>                <span class="hljs-keyword">continue</span><br>            Q._order = l<br>            phi = E.isogeny(Q,algorithm=<span class="hljs-string">&#x27;factored&#x27;</span>)<br>            E, P = phi.codomain(), phi(P)<br>            key[i] -= <span class="hljs-number">1</span><br>            k //= l<br>        <span class="hljs-built_in">round</span> += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> E<br>Hpos,Hneg=<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>L=[]<br><span class="hljs-keyword">for</span> ai <span class="hljs-keyword">in</span> [a5,a4,a3,a2,a1,a0]:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Timestamp K:&#x27;</span>,<span class="hljs-built_in">str</span>(datetime.now()))<br>    D=<span class="hljs-built_in">dict</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">13</span>)):<br>        <span class="hljs-keyword">if</span>((Hpos&amp;i)!=Hpos):<br>            <span class="hljs-keyword">continue</span><br>        priv=[<span class="hljs-number">2</span>*<span class="hljs-built_in">bool</span>(i&amp;(<span class="hljs-number">1</span>&lt;&lt;j)) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>)]+[<span class="hljs-number">0</span>]*<span class="hljs-number">13</span><br>        Et=action(priv.copy(),<span class="hljs-number">9999</span>,ai)<br>        x=to_montgomery(Et)<br>        D[x]=i<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">13</span>)):<br>        <span class="hljs-keyword">if</span>((Hneg&amp;i)!=Hneg):<br>            <span class="hljs-keyword">continue</span><br>        priv=[<span class="hljs-number">0</span>]*<span class="hljs-number">13</span>+[<span class="hljs-number">2</span>*(<span class="hljs-built_in">bool</span>(i&amp;(<span class="hljs-number">1</span>&lt;&lt;j))) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>)]<br>        Et=actioninv(priv.copy(),<span class="hljs-number">9999</span>,a15)<br>        at=to_montgomery(Et)<br>        x=D.get(at,<span class="hljs-number">0</span>)+D.get(p-at,<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">if</span>(x):<br>            <span class="hljs-built_in">print</span>(i,x)<br>            L.append((i,x))<br>            Hneg,Hpos=i,x<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(ciph)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Timestamp 3:&#x27;</span>,<span class="hljs-built_in">str</span>(datetime.now()))<br>A=[<span class="hljs-number">0</span>]*<span class="hljs-number">26</span><br><span class="hljs-keyword">for</span> l,r <span class="hljs-keyword">in</span> L:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>):<br>        A[<span class="hljs-number">13</span>+i]+=<span class="hljs-built_in">bool</span>(l&amp;(<span class="hljs-number">1</span>&lt;&lt;i))<br>        A[i]+=<span class="hljs-built_in">bool</span>(r&amp;(<span class="hljs-number">1</span>&lt;&lt;i))<br><span class="hljs-built_in">print</span>(A)<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> *<br>key = sha256(<span class="hljs-built_in">str</span>(A).encode()).digest()<br>ciph=<span class="hljs-built_in">bytes</span>.fromhex(ciph)<br>aes=AES.new(key,AES.MODE_ECB)<br>msg=aes.decrypt(ciph)<br><span class="hljs-built_in">print</span>(unpad(msg,<span class="hljs-number">16</span>))<br><span class="hljs-built_in">print</span>(datetime.now()-STIME)<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼Œè¿˜æ˜¯ç¼©çŸ­äº†ä¸€ç‚¹æ—¶é—´çš„ï¼š</p><p><img src="/2025/02/19/25Feb1/13.png" alt="13"></p><h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9.æ€»ç»“"></a>9.æ€»ç»“</h2><p>ä¸å¾—ä¸è¯´æœ‰çš„é¢˜æ˜¯çœŸçš„éš¾:(ï¼Œéœ€è¦çš„trickä¸€æ—¶åŠä¼šè¿˜çœŸæƒ³ä¸åˆ°ï¼Œå¾—å»å¤šç§¯ç´¯ã€‚ã€‚ã€‚</p><p>2ï¼Œ3ä¸¤ä¸ªé¢˜å®˜æ–¹åªç»™äº†æ€è·¯ï¼Œæ²¡æœ‰ç»™expï¼Œåœ¨è¿™é‡Œä¹Ÿç®—è‡ªå·±å†™äº†ä¸€ä¸‹expï¼Œæˆ–è®¸è®°å¿†æ›´æ·±åˆ»å§</p><p>åé¢å‡†å¤‡å†çœ‹çœ‹é¸¡å—ä½¬çš„é‚£ä¸ª New Year Ring 4ä¸­çš„trickï¼Œé‚£ä¹Ÿæ˜¯ä¸ªRLWEçš„å¤šé¡¹å¼æ„é€ ï¼Œè™½ç„¶ä»–åšå®¢é‡Œé¢è®²å¾—å¾ˆæ¸…æ¥šäº†ï¼Œä½†ä¸è‡ªå·±å†™ä»£ç å®ç°ä»¥ä¸‹ï¼Œæˆ–è€…æµ‹ä¸€ä¸‹ï¼Œå¯èƒ½è¿˜æ˜¯ä¸ä¼šå¤ªç†è§£ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ECCNotes4</title>
    <link href="/2025/02/01/ECCNotes4/"/>
    <url>/2025/02/01/ECCNotes4/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ ECCçš„ç¬”è®°4"><a href="#huangx607087å­¦ä¹ ECCçš„ç¬”è®°4" class="headerlink" title="huangx607087å­¦ä¹ ECCçš„ç¬”è®°4"></a>huangx607087å­¦ä¹ ECCçš„ç¬”è®°4</h1><blockquote><p>æœ€è¿‘æ›´æ–°æ—¶é—´ï¼š2025.2.8 16:00ï¼Œç¬¬ 5 æ¬¡æ›´æ–°</p></blockquote><p>Reference:<a href="https://tangcuxiaojikuai.xyz/post/e06139e7.html">é¸¡å—ä½¬çš„blog</a>ï¼Œ<a href="https://languag3.github.io/2025/02/04/isogeny/">awdaçš„blog</a></p><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>BlockCipher3ï¼š2021.09.04ï¼ŒBlockCiphser4ï¼š2024.11.06ï¼Œä¸­é—´38ä¸ªæœˆ</p><p>LatticeNotes7ï¼š2021.07.25ï¼ŒLatticeNotes8ï¼š2024.12.05ï¼Œä¸­é—´41ä¸ªæœˆ</p><p>ç„¶åï¼ŒECCNotesï¼Œç»è¿‡47ä¸ªæœˆï¼Œä¹Ÿè¦æ›´æ–°äº†ã€‚ã€‚ã€‚å›é¡¾äº†ä»¥ä¸‹ä¹‹å‰å†™çš„ï¼Œæ»¡å¤´é—®å·ï¼šæˆ‘ä¹‹å‰å†™äº†å•¥ï¼Ÿè¿˜å¥½ï¼Œçœ‹äº†2hï¼Œçœ‹æ‡‚äº†ã€‚ã€‚ã€‚</p><table><thead><tr><th align="center">ECCNotes</th><th align="center">å‘å¸ƒæ—¶é—´</th><th align="center">ä¸»è¦å†…å®¹</th></tr></thead><tbody><tr><td align="center">$1$</td><td align="center">$2021.02.21$</td><td align="center">æ¤­åœ†æ›²çº¿åŸºæœ¬çŸ¥è¯†</td></tr><tr><td align="center">$2$</td><td align="center">$2021.03.04$</td><td align="center">æ¤­åœ†æ›²çº¿çš„åŒçº¿æ€§å¯¹(1)</td></tr><tr><td align="center">$3$</td><td align="center">$2021.03.25$</td><td align="center">æ¤­åœ†æ›²çº¿ä¸Šçš„é™¤å¼ã€å¹¿æ’­æ”»å‡»å’Œç›¸å…³æ˜æ–‡æ”»å‡»</td></tr><tr><td align="center">$4$</td><td align="center">$2025.02.01$</td><td align="center">æ¤­åœ†æ›²çº¿ä¸Šçš„åŒæºï¼ŒSIDH</td></tr></tbody></table><p>ç©¶å…¶åŸå› ï¼Œæ˜¯å› ä¸ºä¹‹å‰0xGame2024 Week4å‡ºäº†ä¸ªSIDHï¼Œå½“æ—¶å®Œå…¨çœ‹ä¸æ‡‚ï¼Œé‚£è¾¹wpå†™å¾—ä¹ŸæŒºç®€é™‹çš„ã€‚å¹¶ä¸”æ„Ÿè§‰æœ€è¿‘å¤šé¡¹å¼ã€åŒæ€è¿™äº›ç©æ„åœ¨CTFä¸­å‡ºç°å¾—è¶Šæ¥è¶Šå¤š<del>ï¼ˆç›²çŒœdbtä½¬è¯»åšç ”ç©¶æ–¹å‘çš„å°±æ˜¯å¤šé¡¹å¼å•¥çš„ï¼Œç„¶åå‡ºäº†å¥½å¤šå¤šé¡¹å¼çš„é¢˜ï¼‰</del>ã€‚</p><blockquote><p>ç‰¹åˆ«æé†’ï¼šæœ¬æ–‡å†…å®¹å‡ä¸º â€œæµ‹ä»£ç æµ‹å‡ºæ¥â€ çš„ï¼Œæ²¡æœ‰ç»™å¤æ‚çš„è¯æ˜ï¼Œå› ä¸ºå¤æ‚åº¦è¯æ˜æˆ‘è‡ªå·±éƒ½çœ‹ä¸æ‡‚ã€‚ã€‚ã€‚SIDHå’ŒCSIDHçš„è®ºæ–‡æˆ‘å…¶å®éƒ½çœ‹äº†ä¸€ä¸‹ï¼Œä½†æœ‰äº›çŸ¥è¯†çœŸçš„å¾ˆæ™¦æ¶©éš¾æ‡‚ã€‚ã€‚å› æ­¤æœ€ç»ˆè¿˜æ˜¯é€‰æ‹©ä½¿ç”¨æµ‹ä»£ç çš„æ–¹å¼æ¥ç»™å‡ºç»“è®ºã€‚</p></blockquote><p>é‚£ä¹ˆä»Šå¤©è¿™ä¸ªå°±ä»¥SIDHå…¥æ‰‹ä»‹ç»åŒæºå§ï¼Œå…ˆç»™ä¸ª0xGame2024 Week4çš„é¢˜ç›®ä»£ç ï¼Œåé¢å°±å›´ç»•ç€è¿™ä¸ªä»£ç äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>ea, eb = <span class="hljs-number">110</span>, <span class="hljs-number">67</span><br>p = <span class="hljs-number">2</span>**ea*<span class="hljs-number">3</span>**eb - <span class="hljs-number">1</span><br>F.&lt;i&gt; = GF(p**<span class="hljs-number">2</span>, modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br><br>E0 = EllipticCurve(F, [<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br><br>PA = E0.random_point()<br>QA = E0.random_point()<br>sA = randint(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>**ea)<br>RA = PA + sA*QA<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;RA = <span class="hljs-subst">&#123;RA.xy()&#125;</span>&#x27;</span>)<br><br>RB_= [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>(<span class="hljs-string">f&#x27;[+] Give me RB:\n&gt;&#x27;</span>).split(<span class="hljs-string">&#x27;,&#x27;</span>)]<br><span class="hljs-comment">#Example: 1,2,3,4 </span><br><br>RB = E0(RB_[<span class="hljs-number">0</span>]*i + RB_[<span class="hljs-number">1</span>], RB_[<span class="hljs-number">2</span>]*i + RB_[<span class="hljs-number">3</span>])<br>phi_B =  E0.isogeny(RB, algorithm=<span class="hljs-string">&#x27;factored&#x27;</span>)<br>E_B = phi_B.codomain()<br><span class="hljs-keyword">assert</span> E_B.is_isogenous(E0)<br><br>R_share = phi_B(PA) + sA * phi_B(QA)<br>phi_share = E_B.isogeny(R_share, algorithm=<span class="hljs-string">&#x27;factored&#x27;</span>)<br>secret = phi_share.codomain().j_invariant()<br><br>secret_ = [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[+] Tell me the secret\n&gt;&#x27;</span>).split(<span class="hljs-string">&#x27;,&#x27;</span>)]<br>secret_ = secret_[<span class="hljs-number">0</span>] * i + secret_[<span class="hljs-number">1</span>]<br><span class="hljs-comment"># #Example: 1,2</span><br><br><span class="hljs-keyword">if</span> secret_ == secret:<br> <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;[+] flag:<span class="hljs-subst">&#123;flag&#125;</span>&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br> <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Wrong&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="1-SIDHé¢„å¤‡çŸ¥è¯†"><a href="#1-SIDHé¢„å¤‡çŸ¥è¯†" class="headerlink" title="1. SIDHé¢„å¤‡çŸ¥è¯†"></a>1. SIDHé¢„å¤‡çŸ¥è¯†</h2><h3 id="1-1-è¶…å¥‡å¼‚æ›²çº¿"><a href="#1-1-è¶…å¥‡å¼‚æ›²çº¿" class="headerlink" title="1.1 è¶…å¥‡å¼‚æ›²çº¿"></a>1.1 è¶…å¥‡å¼‚æ›²çº¿</h3><p>è¶…å¥‡å¼‚æ›²çº¿ï¼šè‹¥æ¨¡ $p$ ä¸‹çš„æ¤­åœ†æ›²çº¿ $E$ çš„é˜¶æ»¡è¶³ $\mathrm{ord}(E)\equiv 1\pmod p$ ï¼Œåˆ™ $E$ æ˜¯è¶…å¥‡å¼‚æ›²çº¿</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">71</span><br>C71.&lt;img&gt;=GF(<span class="hljs-number">71</span>**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E1=EllipticCurve(C71,[<span class="hljs-number">7</span>,<span class="hljs-number">2</span>])<br>E2=EllipticCurve(C71,[<span class="hljs-number">11</span>,<span class="hljs-number">9</span>])<br><span class="hljs-built_in">print</span>(E1.order() % p , E1.is_supersingular(),E1.j_invariant())<br><span class="hljs-comment">#1 True 66</span><br><span class="hljs-built_in">print</span>(E2.order() % p , E2.is_supersingular(),E2.j_invariant())<br><span class="hljs-comment">#62 False 30</span><br></code></pre></td></tr></table></figure><h3 id="1-2-j-ä¸å˜é‡"><a href="#1-2-j-ä¸å˜é‡" class="headerlink" title="1.2 j-ä¸å˜é‡"></a>1.2 j-ä¸å˜é‡</h3><h4 id="1-2-1-j-ä¸å˜é‡çš„å®šä¹‰"><a href="#1-2-1-j-ä¸å˜é‡çš„å®šä¹‰" class="headerlink" title="1.2.1 j-ä¸å˜é‡çš„å®šä¹‰"></a>1.2.1 j-ä¸å˜é‡çš„å®šä¹‰</h4><p>å¦‚æœ 2 ä¸ªæ›²çº¿ $E_1$ å’Œ $E_2$ å…·æœ‰ç›¸åŒçš„ j-ä¸å˜é‡ï¼Œåˆ™ä¸¤æ¡æ›²çº¿åŒæ„ã€‚</p><p>è®¾ $\mathbb C_{71}&#x3D;\mathbb Z_{71}+\mathrm i\mathbb Z_{71}$ ï¼Œå…¶ä¸­ $\mathrm i^2\equiv -1\pmod{71}$ï¼Œåˆ™å®šä¹‰åœ¨ $\mathbb C_{71}$ ä¸Šçš„è¶…å¥‡å¼‚æ›²çº¿æœ‰ ä»¥ä¸‹ $7$ ä¸ªj-ä¸å˜é‡ï¼Œæˆ–è€…è¯´ï¼Œè‹¥ $\mathbb C_{71}$ ä¸ŠæŸä¸ªæ¤­åœ†æ›²çº¿çš„j-ä¸å˜é‡ä¸ºä¸‹é¢çš„æ•°å€¼ä¸­çš„æŸä¸ªï¼Œåˆ™è¿™æ¡æ›²çº¿æ˜¯è¶…å¥‡å¼‚æ›²çº¿ã€‚</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[0, 17, 24, 40, 41, 48, 66]</span><br></code></pre></td></tr></table></figure><p>å¦‚æœ $p&#x3D;431$ï¼Œåˆ™å¯¹åº”çš„è¶…å¥‡å¼‚æ›²çº¿ä¸Šä¼šæœ‰ $37$ ä¸ª j-ä¸å˜é‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">[<span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">19</span>, <span class="hljs-number">61</span>, <span class="hljs-number">67</span>, <span class="hljs-number">102</span>, <span class="hljs-number">107</span>, <span class="hljs-number">125</span>, <span class="hljs-number">143</span>, <span class="hljs-number">150</span>, <span class="hljs-number">189</span>, <span class="hljs-number">234</span>, <span class="hljs-number">241</span>, <span class="hljs-number">242</span>, <span class="hljs-number">316</span>, <span class="hljs-number">319</span>, <span class="hljs-number">356</span>, <span class="hljs-number">358</span>, <span class="hljs-number">381</span>, <span class="hljs-number">419</span>, <span class="hljs-number">422</span>, <span class="hljs-number">81</span>*img + <span class="hljs-number">65</span>, <span class="hljs-number">350</span>*img + <span class="hljs-number">65</span>, <span class="hljs-number">209</span>*img + <span class="hljs-number">118</span>, <span class="hljs-number">222</span>*img + <span class="hljs-number">118</span>, <span class="hljs-number">42</span>*img + <span class="hljs-number">141</span>, <span class="hljs-number">389</span>*img + <span class="hljs-number">141</span>, <span class="hljs-number">87</span>*img + <span class="hljs-number">190</span>, <span class="hljs-number">344</span>*img + <span class="hljs-number">190</span>, <span class="hljs-number">67</span>*img + <span class="hljs-number">304</span>, <span class="hljs-number">364</span>*img + <span class="hljs-number">304</span>, <span class="hljs-number">132</span>*img + <span class="hljs-number">315</span>, <span class="hljs-number">299</span>*img + <span class="hljs-number">315</span>, <span class="hljs-number">106</span>*img + <span class="hljs-number">379</span>, <span class="hljs-number">325</span>*img + <span class="hljs-number">379</span>, <span class="hljs-number">125</span>*img + <span class="hljs-number">426</span>, <span class="hljs-number">306</span>*img + <span class="hljs-number">426</span>]<br></code></pre></td></tr></table></figure><p>æ‰©å±•åˆ°ä»»æ„ $p$ï¼Œåˆ™ j-ä¸å˜é‡çš„ä¸ªæ•°ä¸º $\left\lfloor\dfrac{p}{12}\right\rfloor+z$ ä¸ªï¼Œå…¶ä¸­ $z$ çš„å–å€¼ä¸º $0,1,2$ï¼Œä¸ $p$ çš„å€¼æœ‰å…³ã€‚</p><h4 id="1-2-2-j-ä¸å˜é‡ä¸åŒæ„"><a href="#1-2-2-j-ä¸å˜é‡ä¸åŒæ„" class="headerlink" title="1.2.2 j-ä¸å˜é‡ä¸åŒæ„"></a>1.2.2 j-ä¸å˜é‡ä¸åŒæ„</h4><p>æˆ‘ä»¬è®¾ï¼š $E_1:y^2\equiv x^3+7x+2\pmod{71}$ å’Œ $E_2:y^2\equiv x^3+11x+52\pmod {71}$ çš„ j-ä¸å˜é‡å‡ä¸º $66$ï¼Œå› æ­¤è¿™ä¸¤æ¡æ›²çº¿å‡ä¸º $\mathbb C_{71}$ ä¸Šçš„è¶…å¥‡å¼‚æ›²çº¿ï¼Œä¸”æ»¡è¶³åŒæ„æ€§è´¨ï¼ŒåŒæ„è¡¨è¾¾å¼ä¸ºï¼š<br>$$<br>\phi:E_1(x,y)\rightarrow E_2(23x,20\mathrm iy)<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs PYTHON">p=<span class="hljs-number">71</span><br>C71.&lt;img&gt;=GF(<span class="hljs-number">71</span>**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E1=EllipticCurve(C71,[<span class="hljs-number">7</span>,<span class="hljs-number">2</span>])<br>E2=EllipticCurve(C71,[<span class="hljs-number">11</span>,<span class="hljs-number">52</span>])<br>f = E1.torsion_polynomial(<span class="hljs-number">1</span>).monic()<br>phi=EllipticCurveIsogeny(E1,f,E2)<br>phi.rational_maps()<br><span class="hljs-comment">#(23*x, (20*img)*y)</span><br>k=randint(<span class="hljs-number">1</span>,p)<br>G=E1.random_element()<br>G2=G*k<br>x,y=G.xy()<br>x,y=<span class="hljs-number">23</span>*x,<span class="hljs-number">20</span>*img*y<br>H=E2(x,y)<br>H2=H*k<br>H2.x()/G2.x(),H2.y()/G2.y()<br><span class="hljs-comment">#23 20*img</span><br></code></pre></td></tr></table></figure><p>å†ä¸¾ä¸€ä¸ª $\mathbb C_{431}$ ä¸Šçš„ä¾‹å­ï¼Œä¸¤æ¡æ›²çº¿åˆ†åˆ«ä¸º $E_1:y^2&#x3D;x^3+(208\mathrm i+161)x^2+x$ å’Œ $E_2:y^2&#x3D;x^3+(172\mathrm i+162)x^2+x$ï¼Œå…¶æ˜ å°„ä¸ºï¼š<br>$$<br>\phi:E_1(x,y)\rightarrow E_2(\left(\left(66 \mathrm{i} + 182\right) x + 300 \mathrm{i} + 109, \left(122 \mathrm{i} + 159\right) y\right)<br>)<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p=<span class="hljs-number">431</span><br>C431.&lt;img&gt;=GF(p**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E1=EllipticCurve(C431,[<span class="hljs-number">0</span>,<span class="hljs-number">208</span>*img+<span class="hljs-number">161</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>E2=EllipticCurve(C431,[<span class="hljs-number">0</span>,<span class="hljs-number">172</span>*img+<span class="hljs-number">162</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>f = E1.torsion_polynomial(<span class="hljs-number">1</span>).monic()<br>phi=EllipticCurveIsogeny(E1,f,E2)<br>phi.rational_maps()<br><span class="hljs-comment">#((66*img + 182)*x + (-131*img + 109), (122*img + 159)*y)</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶adwaå‘Šè¯‰æˆ‘æœ‰æ›´ç®€å•çš„åŠæ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">71</span><br>C71.&lt;img&gt;=GF(<span class="hljs-number">71</span>**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E1=EllipticCurve(C71,[<span class="hljs-number">7</span>,<span class="hljs-number">2</span>])<br>E2=EllipticCurve(C71,[<span class="hljs-number">11</span>,<span class="hljs-number">52</span>])<br>phi=E1.isomorphism_to(E2)<br><span class="hljs-built_in">print</span>(phi.rational_maps())<br><span class="hljs-comment">#(23*x, (20*img)*y)</span><br><br></code></pre></td></tr></table></figure><h3 id="1-3-è’™å“¥é©¬åˆ©æ›²çº¿"><a href="#1-3-è’™å“¥é©¬åˆ©æ›²çº¿" class="headerlink" title="1.3 è’™å“¥é©¬åˆ©æ›²çº¿"></a>1.3 è’™å“¥é©¬åˆ©æ›²çº¿</h3><p>ä¹‹å‰æˆ‘ä»¬åœ¨å¯†ç å­¦ä¸­å¸¸ç”¨çš„æ›²çº¿å½¢å¼ä¸º $y^2&#x3D;x^3+ax+b$ï¼Œä½†å…¶å®æ¤­åœ†æ›²çº¿çš„å®Œæ•´è¡¨è¾¾å½¢å¼ä¸º $y^2+a_1xy+a_3y&#x3D;x^3+a_2x^2+a_4x+a_6$ã€‚è€Œè’™å“¥é©¬åˆ©æ›²çº¿çš„è¡¨è¾¾å¼ä¸º $y^2&#x3D;x^3+ux^2+x$ã€‚</p><blockquote><p>æ„Ÿè°¢@adwa çš„æŒ‡æ­£ï¼Œä¹‹å‰ä¸€ä¸ªç‰ˆæœ¬è¯¯å†™æˆäº† $x^3+ux+x$</p></blockquote><p>æ³¨æ„è¿™é‡Œ $x$ çš„ç³»æ•°ä¸º $1$ï¼Œè€Œæ–°å¢åŠ çš„ $x^2$ çš„ç³»æ•°å¯ä»¥å˜åŠ¨ï¼Œå’Œä¹‹å‰çš„æ›²çº¿ç›¸æ¯”ï¼Œå¯ä»¥å‘ç° $(0,0)$ ä¸€å®šåœ¨è’™å“¥é©¬åˆ©æ›²çº¿ä¸Šã€‚</p><p>å¯¹äºè’™å“¥é©¬åˆ©æ›²çº¿è€Œè¨€ï¼Œå…¶ j-ä¸å˜é‡å¯ä»¥å¿«é€Ÿè®¡ç®—ä¸º $j(Em)&#x3D;\dfrac{256(u^2-3)^3}{u^2-4}$ã€‚å¯¹äºä¸¤ä¸ªj-ä¸å˜é‡ç›¸åŒçš„è’™å“¥é©¬åˆ©æ›²çº¿ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒæ€æ˜ å°„ä¸­è¡¨è¾¾å¼ä¸­ä¸ä¼šå‡ºç°åˆ†æ¯ã€‚ï¼ˆ1.2.2çš„ä¸¤ä¸ªä¾‹å­ï¼‰ã€‚</p><p>å½“ç„¶ï¼Œå¸¸ç”¨æ›²çº¿å’Œè’™å“¥é©¬åˆ©æ›²çº¿ä¹‹é—´çš„äº¤é›†ä¸º $y^2&#x3D;x^3+x$ï¼Œè¿™å¯¹åº”çš„æ˜¯ $u&#x3D;0,b&#x3D;0$ çš„æƒ…å†µï¼Œè¯¥æ›²çº¿ä¹Ÿå¤šç”¨äºSIDHä¸­ã€‚å½“ç„¶ï¼Œä»»æ„å½¢å¼çš„æ¤­åœ†æ›²çº¿éƒ½å¯ä»¥è½¬åŒ–ä¸ºä¸å…¶j-ä¸å˜é‡ç›¸åŒçš„è’™å“¥é©¬åˆ©æ›²çº¿å½¢å¼ï¼Œåœ¨Sagemathä¸­ï¼Œå¯ä»¥è°ƒç”¨ <code>E.montgomery_model()</code> å®ç°ã€‚åœ¨1.9.4ä¸­çš„ä»£ç ä¸­ï¼Œå¯ä»¥éªŒè¯è¿™ä¸€æ€§è´¨ã€‚</p><p>ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬å®šä¹‰æ›²çº¿ $E$ çš„è’™å“¥é©¬åˆ©å‚æ•°ä¸º $E$ çš„è’™å“¥é©¬åˆ©å½¢å¼ä¸­å¹´çš„ $u$ å€¼ï¼ŒSageä¸­å¯ä»¥ä½¿ç”¨  <code>E.montgomery_model().a2()</code>  å®ç°ã€‚</p><h3 id="1-4-åŒæº"><a href="#1-4-åŒæº" class="headerlink" title="1.4 åŒæº"></a>1.4 åŒæº</h3><h4 id="1-4-1-å€ç‚¹åŒæ„æ˜ å°„"><a href="#1-4-1-å€ç‚¹åŒæ„æ˜ å°„" class="headerlink" title="1.4.1 å€ç‚¹åŒæ„æ˜ å°„"></a>1.4.1 å€ç‚¹åŒæ„æ˜ å°„</h4><p>åˆšæ‰æˆ‘ä»¬å…¶å®å·²ç»æ¥è§¦åˆ°äº†åŒæºçš„æ¦‚å¿µï¼Œä½†æˆ‘ä»¬ä»¥â€åŒæ„â€å»æè¿°çš„ï¼ˆå‘ƒï¼Œå› ä¸ºä¿¡å®‰æ•°åŸºä¸­è®²çš„æ˜¯åŒæ„ï¼‰ï¼Œä½†äº‹å®ä¸Šï¼ŒåŒæ„æ˜¯åŒæºçš„ç‰¹æ®Šæƒ…å†µã€‚åœ¨ä¹‹å‰çš„åŒæ„æ˜ å°„ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªçœ‹ä¼¼trivialçš„æ–¹æ³•ï¼Œè‡ªå·±è·Ÿè‡ªå·±çš„äºŒå€ç‚¹æ˜ å°„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p=<span class="hljs-number">71</span><br>Cp.&lt;img&gt;=GF(p**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(Cp,[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(E._multiple_x_numerator(<span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(E._multiple_x_denominator(<span class="hljs-number">2</span>))<br><span class="hljs-comment">#x^4 + 69*x^2 + 1</span><br><span class="hljs-comment">#4*x^3 + 4*x</span><br>phi = E.scalar_multiplication(<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(phi.rational_maps()[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(phi.rational_maps()[<span class="hljs-number">1</span>])<br><span class="hljs-comment">#(x^4 - 2*x^2 + 1)/(4*x^3 + 4*x)</span><br><span class="hljs-comment">#(8*x^6*y - 31*x^4*y + 31*x^2*y - 8*y)/(-7*x^6 - 14*x^4 - 7*x^2)</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„æ˜ å°„ç»“æœä¸ºï¼š</p><p>$$<br>\phi:(x,y)\rightarrow\left(\frac{x^{4} + 69 x^{2} + 1}{4 x^{3} + 4 x}, \frac{8 x^{6} y + 40 x^{4} y + 31 x^{2} y + 63 y}{64 x^{6} + 57 x^{4} + 64 x^{2}}\right)<br>$$</p><p>å¦‚æœæˆ‘ä»¬ä»¤ $x$ çš„åˆ†æ¯ $4x^3+4x&#x3D;0$ï¼Œä¹Ÿå°±æ˜¯  $x^3+x&#x3D;0$ï¼Œé‚£ä¹ˆå¯ä»¥å¾—åˆ° $x&#x3D;0,\mathrm i,-\mathrm i$ã€‚å¯ä»¥åˆ©ç”¨ <code>division_points</code> å»å®ç°ï¼Œç›¸å½“äºæœ‰é™åŸŸå¼€ $n$ æ¬¡æ ¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">L=(E(<span class="hljs-number">0</span>).division_points(<span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(L)<br><span class="hljs-comment">#[(0 : 1 : 0), (0 : 0 : 1), (img : 0 : 1), (70*img : 0 : 1)]</span><br></code></pre></td></tr></table></figure><p>ç”±äº $E$ çš„é˜¶ä¸º $72$ï¼Œé‚£ä¹ˆä¹Ÿä¸€å®šå­˜åœ¨é˜¶ä¸º $3$ çš„æƒ…å†µï¼ˆæ˜¾ç„¶ï¼Œå¦‚æœ $P$ çš„é˜¶ä¸º $3$ï¼Œé‚£ä¹ˆ $-P$ çš„é˜¶ä¹Ÿæ˜¯ $3$ï¼‰ï¼Œé‚£ä¹ˆä¹Ÿå­˜åœ¨æŸä¸ªç‚¹å’Œè‡ªå·±çš„ä¸‰å€ç‚¹æ˜ å°„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(E._multiple_x_denominator(<span class="hljs-number">3</span>).monic())<br><span class="hljs-comment">#x^8 + 4*x^6 + 27*x^4 + 46*x^2 + 8</span><br>L=(E(<span class="hljs-number">0</span>).division_points(<span class="hljs-number">3</span>))<br><span class="hljs-built_in">print</span>(L)<br><span class="hljs-comment">#[(0 : 1 : 0), (2 : 9 : 1), (2 : 62 : 1), (69 : 9*img : 1), (69 : 62*img : 1), (19*img : 15*img + 56 : 1), (19*img : 56*img + 15 : 1), (52*img : 15*img + 15 : 1), (52*img : 56*img + 56 : 1)]</span><br></code></pre></td></tr></table></figure><p>è§£æ–¹ç¨‹ $x^8 + 4x^6 + 27x^4 + 46x^2 + 8&#x3D;0$ï¼Œå¯ä»¥å¾—åˆ°å¯¹åº”çš„è§£ä¸º $Â±\sqrt{Â±\frac{1}{2}  \sqrt{Â±2  \sqrt{497} - 42} - 1}$ï¼Œè¿™ä¸ªè§£åœ¨ $\mathbb C_{71}$ ä¸­å°±å˜æˆäº† $2,69,19\mathrm i,52\mathrm i$ï¼Œæ­¤æ—¶çš„æ˜ å°„è¡¨è¾¾å¼å¦‚ä¸‹ï¼ˆå·²ç»å¼€å§‹å¤æ‚äº†ï¼ï¼‰<br>$$<br>\phi:(x,y)\rightarrow\left(\frac{x^{9} + 59 x^{7} + 30 x^{5} + 36 x^{3} + 9 x}{9 x^{8} + 36 x^{6} + 30 x^{4} + 59 x^{2} + 1}<br>,\frac{18 x^{12} y + 41 x^{10} y + 12 x^{8} y + 48 x^{6} y + 7 x^{4} y + 13 x^{2} y + 17 y}{60 x^{12} + 5 x^{10} + 21 x^{8} + 27 x^{6} + 64 x^{4} + 40 x^{2} + 53}<br>\right)<br>$$<br>å¯¹äºé˜¶ä¸º $l$ çš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯æ»¡è¶³ $lP&#x3D;\mathcal O$ çš„ç‚¹æ„æˆçš„é›†åˆï¼Œæˆ‘ä»¬å¯ä»¥å«åš $l$-torsionã€‚ä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªé›†åˆè®°ä¸º $\ker(l)$ï¼Œæœ‰ $\ker(l)$ ä¸ $\mathbb Z_{l+1}^2$ åŒæ„ã€‚è‹¥ $l$ ä¸ºç´ æ•°ï¼Œåˆ™å¯ä»¥æ„æˆ $l+1$ ä¸ªé˜¶ä¸º $l$ çš„å¾ªç¯å­ç¾¤ï¼Œä¸”ä¸¤ä¸ªä¸åŒå­ç¾¤ä¹‹é—´çš„å…ƒç´ æ˜¯çº¿æ€§æ— å…³çš„ã€‚</p><p>$\ker(2)$ å’Œ $\ker(3)$ çš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸­é—´æ˜¯æ— ç©·è¿œç‚¹ $\mathcal O$ã€‚è¿™ä¸ªèŠ±ç“£å½¢çš„ç»“æ„ï¼Œè²Œä¼¼åœ¨ä¹‹å‰å¯¼å¸ˆå‘ç»™æˆ‘çš„åŒçº¿æ€§å¯¹é‚£ä¸ªPPTä¸Šè§è¿‡ã€‚</p><p><img src="/2025/02/01/ECCNotes4/1.png" alt="1"></p><h4 id="1-4-2-åŒæºåœ¨Sageä¸­çš„å®ç°"><a href="#1-4-2-åŒæºåœ¨Sageä¸­çš„å®ç°" class="headerlink" title="1.4.2 åŒæºåœ¨Sageä¸­çš„å®ç°"></a>1.4.2 åŒæºåœ¨Sageä¸­çš„å®ç°</h4><p>å¯ä»¥ä½¿ç”¨Sageæ¥å®ç°åŒæºï¼Œè¿™é‡Œé€‰æ‹©äº† $(69,9\mathrm i)$ ä½œä¸ºåŒæºæ˜ å°„ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œ $E_1$ çš„ j-ä¸å˜é‡ä¸º $24$ï¼Œè€Œ $E_2$ çš„ j-ä¸å˜é‡ä¸º $66$ã€‚è¯´æ˜ $E_2$ ä¸ $E_1$ å¹¶ä¸æ˜¯åŒæ„çš„ã€‚è€Œæˆ‘ä»¬åˆšæ‰è¯´è¿‡ï¼ŒåŒæºçš„ä¸€ç§ç‰¹æ®Šæƒ…å†µæ˜¯åŒæ„ï¼ŒåŒæ„æ˜¯åªæœ‰ä¸€ä¸ªæ ¸å…ƒç´  $\mathcal O$ çš„åŒæºï¼Œå› æ­¤è¿™é‡Œåªæœ‰ $E_1$ å’Œ $E_2$ åŒæºï¼Œæ²¡æœ‰ $E_1$ å’Œ $E_2$ åŒæ„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p=<span class="hljs-number">71</span><br>Cp.&lt;img&gt;=GF(p**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E1=EllipticCurve(Cp,[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(E1.j_invariant())<br><span class="hljs-comment">#24</span><br>A = E1(<span class="hljs-number">69</span>,<span class="hljs-number">9</span>*img)<br>phi = E1.isogeny(A)<br><span class="hljs-comment">#Isogeny of degree 3 from Elliptic Curve defined by y^2 = x^3 + x over Finite Field in img of size 71^2 to Elliptic Curve defined by y^2 = x^3 + 13*x + 5 over Finite Field in img of size 71^2</span><br>E2 = phi.codomain()<br><span class="hljs-built_in">print</span>(E2)<br><span class="hljs-built_in">print</span>(E2.j_invariant())<br><span class="hljs-built_in">print</span>(phi.rational_maps()[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(phi.rational_maps()[<span class="hljs-number">1</span>])<br><span class="hljs-comment">#Elliptic Curve defined by y^2 = x^3 + 13*x + 5 over Finite Field in img of size 71^2</span><br><span class="hljs-comment">#66</span><br><span class="hljs-comment">#(x^3 + 4*x^2 + 30*x + 12)/(x^2 + 4*x + 4)</span><br><span class="hljs-comment">#(x^3*y + 6*x^2*y - 14*x*y - 35*y)/(x^3 + 6*x^2 + 12*x + 8)</span><br></code></pre></td></tr></table></figure><h4 id="1-4-3-åŒæºå›¾"><a href="#1-4-3-åŒæºå›¾" class="headerlink" title="1.4.3 åŒæºå›¾"></a>1.4.3 åŒæºå›¾</h4><p>å¦‚æœæˆ‘ä»¬æŠŠ $\mathbb C_{71}$ ä¸Šçš„ $7$ ä¸ª è¶…å¥‡å¼‚ j-ä¸å˜é‡å„æ„é€ ä¸€æ¡æ›²çº¿ï¼Œå¹¶å–æ¯æ¡æ›²çº¿ä¸Š $\ker (2)$ ä¸­çš„ä¸‰ä¸ªç‚¹ï¼ˆä¸åŒ…æ‹¬ $\mathcal O$ï¼‰è¿›è¡ŒåŒæºï¼Œå¯ä»¥å¾—åˆ°è¿™æ ·çš„ä¸€ä¸ªå›¾ã€‚åœ¨è¿™è¾¹ï¼ŒæŒ‰ç†è¯´æ¯ä¸ªç‚¹çš„åº¦éƒ½åº”è¯¥æ˜¯ $3$ï¼Œä½†ç”±äºå­˜åœ¨è‡ªç¯å’Œé‡è¾¹ï¼Œå½“ç„¶ä¹Ÿæœ‰ç‰¹æ®Šæƒ…å†µï¼Œå› æ­¤åªæœ‰ä¸€ä¸ªç‚¹çš„åº¦æ˜¯ $3$ã€‚æ¯”å¦‚ $40$ è¿æ¥çš„ä¸‰æ¡è¾¹ï¼Œè¯´æ˜ j-ä¸å˜é‡ä¸º $40$ çš„æ›²çº¿ä¸­ï¼Œ $\ker(2)$ ä¸­çš„ä¸‰ä¸ªéæ— ç©·è¿œç‚¹ç»è¿‡åŒæºï¼Œå¾—åˆ°çš„æ–°çš„åŒæºæ›²çº¿çš„ j-ä¸å˜é‡å¯èƒ½æ˜¯ $48,0,17$ã€‚</p><p>å½“ç„¶ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªæ— å‘å›¾ï¼Œå› ä¸ºåŒæºæ˜¯å¯¹å¶çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œj-ä¸å˜é‡ä¸º $40$ çš„æ›²çº¿å¯ä»¥åŒæºåˆ° j-ä¸å˜é‡ä¸º $48$ çš„æ›²çº¿ï¼Œåè¿‡æ¥ï¼Œä¹Ÿå­˜åœ¨ j-ä¸å˜é‡ä¸º $48$ çš„æ›²çº¿åŒæºåˆ° j-ä¸å˜é‡ä¸º $40$ çš„æ›²çº¿ä¸Šå»ã€‚è€Œå¯¹äºä¸€æ¡è·¯å¾„ $40\rightarrow48\rightarrow 66$ è€Œè¨€ï¼Œè¿™ç›¸å½“äºä¸¤æ¬¡åº¦ä¸º $2$ çš„çš„åŒæºï¼Œä¹Ÿå¯ä»¥è§†ä¸ºä¸€æ¬¡ åº¦ä¸º $4$ çš„åŒæºã€‚</p><p><img src="/2025/02/01/ECCNotes4/2.png" alt="2"></p><p>è¿™ä¸ªæ˜¯ $p&#x3D;431$ çš„ $\ker(2)$ åŒæºå›¾ï¼Œç”±äºè¿™é‡Œçš„j-ä¸å˜é‡æœ‰ $73$ ä¸ªï¼Œå› æ­¤åº¦ä¸º $3$ çš„ç‚¹å äº†å¤§å¤šæ•°ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€‰æ‹© $\ker(3)$ è¿›è¡Œåº¦ä¸º $3 $ çš„åŒæºï¼Œé‚£ä¹ˆæ¯ä¸ªç‚¹çš„åº¦å°±æ˜¯ $4$ äº†ï¼Œå¾—åˆ°çš„å›¾ä¹Ÿä¼šä¸ $\ker(2)$ å¾—åˆ°çš„å›¾ä¸ä¸€æ ·ã€‚</p><p><img src="/2025/02/01/ECCNotes4/3.png" alt="3"></p><h3 id="1-9-æ€»ç»“å’Œå›é¡¾"><a href="#1-9-æ€»ç»“å’Œå›é¡¾" class="headerlink" title="1.9 æ€»ç»“å’Œå›é¡¾"></a>1.9 æ€»ç»“å’Œå›é¡¾</h3><h4 id="1-9-1-Sageæ±‚jä¸å˜é‡çš„æ–¹æ³•"><a href="#1-9-1-Sageæ±‚jä¸å˜é‡çš„æ–¹æ³•" class="headerlink" title="1.9.1 Sageæ±‚jä¸å˜é‡çš„æ–¹æ³•"></a>1.9.1 Sageæ±‚jä¸å˜é‡çš„æ–¹æ³•</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">Fp2.&lt;img&gt;=GF(<span class="hljs-number">431</span>**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(Fp2,[<span class="hljs-number">26</span>,<span class="hljs-number">48</span>+<span class="hljs-number">33</span>*img])<br>E.j_invariant()<br><span class="hljs-comment">#51*img + 353</span><br></code></pre></td></tr></table></figure><h4 id="1-9-2-åˆ¤æ–­ä¸€ä¸ªæ›²çº¿æ˜¯ä¸æ˜¯è¶…å¥‡å¼‚æ›²çº¿"><a href="#1-9-2-åˆ¤æ–­ä¸€ä¸ªæ›²çº¿æ˜¯ä¸æ˜¯è¶…å¥‡å¼‚æ›²çº¿" class="headerlink" title="1.9.2 åˆ¤æ–­ä¸€ä¸ªæ›²çº¿æ˜¯ä¸æ˜¯è¶…å¥‡å¼‚æ›²çº¿"></a>1.9.2 åˆ¤æ–­ä¸€ä¸ªæ›²çº¿æ˜¯ä¸æ˜¯è¶…å¥‡å¼‚æ›²çº¿</h4><p>è¶…å¥‡å¼‚æ›²çº¿çš„å®šä¹‰ï¼šå¯¹äºå®šä¹‰åœ¨ $\mathbb F_{p^k}$ ä¸Šçš„æ›²çº¿$E$ ï¼Œæ»¡è¶³ $|E|\equiv 1 \pmod p$ çš„æ›²çº¿ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªç‚¹çš„é˜¶é™¤ä»¥ $p$ çš„ä½™æ•°å‡ä¸º $1$ çš„æ›²çº¿ã€‚</p><p>åˆ¤æ–­æ–¹æ³•ï¼š<code>E.is_supersingular()</code></p><p>CryptoHackä¸Šçš„ä¾‹é¢˜ï¼šåœ¨ä¸€å † $A$ ä¸­æ‰¾åˆ°æ»¡è¶³è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿çš„ $A$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">71</span><br>C71.&lt;img&gt;=GF(<span class="hljs-number">71</span>**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E1=EllipticCurve(C71,[<span class="hljs-number">7</span>,<span class="hljs-number">2</span>])<br>E2=EllipticCurve(C71,[<span class="hljs-number">11</span>,<span class="hljs-number">9</span>])<br><span class="hljs-built_in">print</span>(E1.is_supersingular(),E1.j_invariant())<br><span class="hljs-comment">#True 66</span><br><span class="hljs-built_in">print</span>(E2.is_supersingular(),E2.j_invariant())<br><span class="hljs-comment">#False 30</span><br></code></pre></td></tr></table></figure><h4 id="1-9-3-åŒæºçš„æ€§è´¨"><a href="#1-9-3-åŒæºçš„æ€§è´¨" class="headerlink" title="1.9.3 åŒæºçš„æ€§è´¨"></a>1.9.3 åŒæºçš„æ€§è´¨</h4><p>ç”±äºåŒæºæ€§ä¸ä»…æ˜¯æ›²çº¿ä¹‹é—´çš„æœ‰ç†æ˜ å°„ï¼Œè€Œä¸”è¿˜æ˜¯ä¿ç•™è¿™äº›æ›²çº¿ä¸Šçš„ç¾¤ç»“æ„çš„æ˜ å°„ã€‚å› æ­¤ï¼Œå³ä½¿ $\phi:E\rightarrow Eâ€™$ æœªçŸ¥ï¼Œå¦‚æœæˆ‘ä»¬å·²ç»çŸ¥é“äº† $Eâ€™$ ä¸Šçš„ä¸¤ä¸ªç‚¹ $\phi(P),\phi(Q)$ï¼Œä»ç„¶å¯ä»¥é«˜æ•ˆåœ°è®¡ç®— $\phi(P+Q)&#x3D;\phi(P)+\phi(Q)$ å’Œ $\phi(kP)&#x3D;k\phi(P)$ã€‚ </p><p>å‡è®¾æˆ‘ä»¬çŸ¥é“ $p&#x3D;62207$ï¼Œ$\phi(P)&#x3D;(6369\mathrm i+10044,1511\mathrm i+60746),\phi(Q)&#x3D;(35306\mathrm i+34293,7667\mathrm i+35815)$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥è§£å‡ºæ›²çº¿ $Eâ€™:y^2&#x3D;x^3+ax+b$ çš„å‚æ•° $a,b$ï¼Œéšåç›´æ¥è®¡ç®— $\phi(P+Q)&#x3D;\phi(P)+\phi(Q)$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">2</span>**<span class="hljs-number">8</span>*<span class="hljs-number">3</span>**<span class="hljs-number">5</span>-<span class="hljs-number">1</span><br>Cp.&lt;img&gt;=GF((p,<span class="hljs-number">2</span>),modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>Px,Py=(Cp([<span class="hljs-number">10044</span>,<span class="hljs-number">6369</span>]),Cp([<span class="hljs-number">60746</span>,<span class="hljs-number">1511</span>]))<br>Qx,Qy=(Cp([<span class="hljs-number">34293</span>,<span class="hljs-number">35306</span>]),Cp([<span class="hljs-number">35815</span>,<span class="hljs-number">7667</span>]))<br>M=Matrix(Cp,[[Px,<span class="hljs-number">1</span>],[Qx,<span class="hljs-number">1</span>]])<br>y=vector(Cp,[Py**<span class="hljs-number">2</span>-Px**<span class="hljs-number">3</span>,Qy**<span class="hljs-number">2</span>-Qx**<span class="hljs-number">3</span>])<br><span class="hljs-built_in">print</span>(M.solve_right(y))<br><span class="hljs-comment">#(4664*img + 27806, 309*img + 49495)</span><br>E=EllipticCurve(Cp,(<span class="hljs-number">4664</span>*img + <span class="hljs-number">27806</span>, <span class="hljs-number">309</span>*img + <span class="hljs-number">49495</span>))<br>G=E(Px,Py)<br>H=E(Qx,Qy)<br><span class="hljs-built_in">print</span>((G+H).xy())<br><span class="hljs-comment">#(59811*img + 19477, 25623*img + 59043)</span><br></code></pre></td></tr></table></figure><h4 id="1-9-4-æ±‚ä¸€ä¸ªæ›²çº¿çš„è’™å“¥é©¬åˆ©æ›²çº¿å½¢å¼"><a href="#1-9-4-æ±‚ä¸€ä¸ªæ›²çº¿çš„è’™å“¥é©¬åˆ©æ›²çº¿å½¢å¼" class="headerlink" title="1.9.4 æ±‚ä¸€ä¸ªæ›²çº¿çš„è’™å“¥é©¬åˆ©æ›²çº¿å½¢å¼"></a>1.9.4 æ±‚ä¸€ä¸ªæ›²çº¿çš„è’™å“¥é©¬åˆ©æ›²çº¿å½¢å¼</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">E=EllipticCurve(GF(<span class="hljs-number">419</span>),[<span class="hljs-number">33</span>,<span class="hljs-number">9</span>])<br>E.montgomery_model()<br><span class="hljs-built_in">print</span>(E.montgomery_model())<br><span class="hljs-built_in">print</span>(E.montgomery_model().a2())<br><span class="hljs-built_in">print</span>(E.j_invariant())<br><span class="hljs-built_in">print</span>(E.montgomery_model().j_invariant())<br><span class="hljs-comment">#Elliptic Curve defined by y^2 = x^3 + 173*x^2 + x over Finite Field of size 419</span><br><span class="hljs-comment">#173</span><br><span class="hljs-comment">#272</span><br><span class="hljs-comment">#272</span><br></code></pre></td></tr></table></figure><h4 id="1-9-5-åŒæºä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜"><a href="#1-9-5-åŒæºä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜" class="headerlink" title="1.9.5 åŒæºä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜"></a>1.9.5 åŒæºä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜</h4><p>ç”±äºåŒæºä¸­æ‰€ç”¨çš„æ¨¡æ•° $p$ æ»¡è¶³ $p-1$ å…‰æ»‘æˆ– $p+1$ å…‰æ»‘ï¼Œå› æ­¤å¯ä»¥åœ¨è¿™é‡Œè§£ç¦»æ•£å¯¹æ•°ï¼Œæ¥çœ‹è¿™æ ·ä¸€ä¸ªé¢˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>p=<span class="hljs-number">2</span>**<span class="hljs-number">110</span>*<span class="hljs-number">3</span>**<span class="hljs-number">67</span>-<span class="hljs-number">1</span><br>F.&lt;img&gt;=GF((p,<span class="hljs-number">2</span>), modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(F, [<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>P,Q = E.gens()<br>a,b,c,d=<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>    a,b=getPrime(p.nbits()-<span class="hljs-number">1</span>),getPrime(p.nbits()-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">if</span>(isPrime(a*b+<span class="hljs-number">2</span>)):<br>        pab=a*b+<span class="hljs-number">2</span><br>        <span class="hljs-keyword">break</span><br><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>    c,d=getPrime(p.nbits()-<span class="hljs-number">1</span>),getPrime(p.nbits()-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">if</span>(isPrime(c*d+<span class="hljs-number">2</span>)):<br>        pcd=c*d+<span class="hljs-number">2</span><br>        <span class="hljs-keyword">break</span><br>n=pab*pcd<br>m=bytes_to_long(flag)<br>enc=<span class="hljs-built_in">pow</span>(m,<span class="hljs-number">998244353</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;n=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;P=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;Q=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;a*P+b*Q=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c*P+d*Q=&#125;</span>&#x27;</span>)<br><span class="hljs-comment">#n=85339866424199254883523559880615666512135381522585732793528431470377062744274254649973052920620568928504698841752053780787873200084113130883908840908212945037412690974720035898852421861507580011712163085069539142027604357576603852989568568703518497258863875153</span><br><span class="hljs-comment">#enc=53196193209459904075636522116569983302576854763250689338898932442142670012786364854411445956198339404091802217781375861501894434580028683650559746806106285471896793278331422155924857505573872814397852509320854345311674565845751058899294650766501770021007913380</span><br><span class="hljs-comment">#P=(48078665342759973922737682036708423814190721092041844128027005717*img + 101453330026777115174150344369057670486666592516047972012938796665 : 106414280972661281085621154931449660232878796703063973273414757742*img + 39724328357561096793476627099678863783547841068613222678288745599 : 1)</span><br><span class="hljs-comment">#Q=(93500514099794038270009024277832755039609701103181802675798729052*img + 47897193222031858455386507623256296001957037047526619598509235406 : 54198645028294833136677496634472064101831735083974811027732624298*img + 75625331732228140758389762066194385021895005176305694866704994925 : 1)</span><br><span class="hljs-comment">#a*P+b*Q=(99438327946055727177889400304218359448668814328993888248956295877*img + 4968626040861611178418787464521937488397920200577632479183463224 : 105950216810563991098390220256849202423207554566800612407368235975*img + 3691834310963900683221595180172998514255729221504935470233846876 : 1)</span><br><span class="hljs-comment">#c*P+d*Q=(51107307256620573344750692242449535834731290150105231422519471003*img + 93155460640102509761079363280109781081212723193482509556965830289 : 55648112626812914269722588029837092719545646171682298767546807156*img + 76607528540202433402606873074289417539785602790560632206527541013 : 1)</span><br><br></code></pre></td></tr></table></figure><h5 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h5><p>å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬è¦æ±‚å‡º $a,b,c,d$ çš„å€¼ï¼Œæ‰èƒ½å¤Ÿè§£å‡ºflagã€‚ä½†è¿™ä¸ªæ¤­åœ†æ›²çº¿ä¸Šçš„ç”Ÿæˆå…ƒæœ‰ä¸¤ä¸ªï¼Œå› æ­¤ç›´æ¥è°ƒç”¨ç¦»æ•£å¯¹æ•°æ˜¯ä¸å¤ªç°å®çš„ï¼Œå¯ä»¥åˆ©ç”¨åŒæºï¼Œæ¯”å¦‚ <code>phi1=E.isogeny(P)</code> åï¼Œæœ‰ $\phi_1(P)-\mathcal O$ï¼Œç›¸å½“äºåŒæºä¹‹åï¼Œæ–°çš„æ›²çº¿ $E_1$ ä¸Šçš„ç‚¹ç»è¿‡ $\phi_1$ï¼Œå®ç°äº†å¯¹ $P$ è¿›è¡Œäº†â€å–æ¨¡â€æ“ä½œã€‚</p><p>ä¸è¿‡sagemathä¼¼ä¹ç›´æ¥è°ƒç”¨ä¼šæŠ¥é”™ï¼Œè€ƒè™‘åˆ°é˜¶æ˜¯å…‰æ»‘çš„ï¼Œå·ä¸€ä¸ªPoligHellmançš„ä»£ç ï¼Œæ”¹ä¸€ä¸‹å°±OKäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">PoligHellman</span>(<span class="hljs-params">G,Y,order</span>):<br>    factors, exponents = <span class="hljs-built_in">zip</span>(*factor(order))<br>    temp=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(factors)):<br>        q=factors[i]<br>        a=[]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,exponents[i]+<span class="hljs-number">1</span>):<br>            GG=G*(order//q**j)<br>            YY=Y*(order//q**j)<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(q):<br>                s=<span class="hljs-number">0</span><br>                <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>                    s+=a[t]*q^t<br>                s+=k*q^(<span class="hljs-built_in">len</span>(a))<br>                <span class="hljs-keyword">if</span> s*GG==YY:<br>                    a.append(k)<br>                    <span class="hljs-keyword">break</span><br>        x_q=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>            x_q+=a[j]*q^j<br>        temp.append(x_q)<br>    f=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(factors)):<br>        f.append(factors[i]**exponents[i])<br>    <span class="hljs-keyword">return</span> crt(temp,f)<br>phi1,phi2=E.isogeny(P,algorithm=<span class="hljs-string">&#x27;factored&#x27;</span>),E.isogeny(Q,algorithm=<span class="hljs-string">&#x27;factored&#x27;</span>)<br>E1,E2=phi1.codomain(),phi2.codomain()<br><span class="hljs-comment">#discrete_log(phi2(R),phi2(P)) #Error.</span><br>a=PoligHellman(phi2(P),phi2(G),p+<span class="hljs-number">1</span>)<br>b=PoligHellman(phi1(Q),phi1(G),p+<span class="hljs-number">1</span>)<br>c=PoligHellman(phi2(P),phi2(H),p+<span class="hljs-number">1</span>)<br>d=PoligHellman(phi1(Q),phi1(H),p+<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(a,b,c,d)<br><span class="hljs-keyword">assert</span>(a*P+b*Q==G <span class="hljs-keyword">and</span> c*P+d*Q==H)<br>pab=a*b+<span class="hljs-number">2</span><br>pcd=c*d+<span class="hljs-number">2</span><br>phi=(pab-<span class="hljs-number">1</span>)*(pcd-<span class="hljs-number">1</span>)<br>n=<span class="hljs-number">85339866424199254883523559880615666512135381522585732793528431470377062744274254649973052920620568928504698841752053780787873200084113130883908840908212945037412690974720035898852421861507580011712163085069539142027604357576603852989568568703518497258863875153</span><br>enc=<span class="hljs-number">53196193209459904075636522116569983302576854763250689338898932442142670012786364854411445956198339404091802217781375861501894434580028683650559746806106285471896793278331422155924857505573872814397852509320854345311674565845751058899294650766501770021007913380</span><br><br><span class="hljs-keyword">assert</span> n==pab*pcd<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>d=inverse(<span class="hljs-number">998244353</span>,phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(enc,d,n)))<br><span class="hljs-comment">#a=104387901776481921020491968026212561265236729786055540819430222523 </span><br><span class="hljs-comment">#b=103077386564589714869729922397059093530581882186115640326801660297 </span><br><span class="hljs-comment">#c=82858008941957494629539360515452860058651023741867958937507591339 </span><br><span class="hljs-comment">#d=95720266381793956333967392421282383472307483512312215027077560801</span><br><span class="hljs-comment">#b&#x27;flag&#123;781f9d8c-d318-4e31-9416-bec6e2cfa016&#125;&#x27;</span><br></code></pre></td></tr></table></figure><blockquote><p>updateï¼šè¿™ä¹ˆåšä¹Ÿå¯ä»¥ï¼Œä½†å¿…é¡»æŒ‡å®š <code>operation=&#39;+&#39;</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">discrete_log(phi1(G),phi1(Q),operation=<span class="hljs-string">&#x27;+&#x27;</span>)<br></code></pre></td></tr></table></figure></blockquote><h5 id="æ–¹æ³•2"><a href="#æ–¹æ³•2" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h5><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŒçº¿æ€§å¯¹çš„çŸ¥è¯†ï¼Œç”±äº $G&#x3D;aP+bQ$ï¼Œå¯ä»¥ä½¿ç”¨weil_pairingæ±‚è§£ï¼Œå¾—åˆ°ï¼š<br>$$<br>e(G,Q)&#x3D;e(aP+bQ,Q)&#x3D;e(aP,Q)e(bQ,Q)&#x3D;e(P,Q)^a<br>$$<br>åŒç†ï¼š<br>$$<br>e(P,G)&#x3D;e(P,aP+bQ)&#x3D;e(P,aP)e(P,bQ)&#x3D;e(P,Q)^b<br>$$<br>è¿™æ · $a,b$ å°±å¯ä»¥é€šè¿‡ç¦»æ•£å¯¹æ•°è§£å‡ºæ¥äº†ï¼ŒåŒç†è§£å¾— $c,d$ï¼Œè¿™æ ·å°±ä¸éœ€è¦ç”¨åŒæºçš„çŸ¥è¯†äº†ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p=<span class="hljs-number">2</span>**<span class="hljs-number">110</span>*<span class="hljs-number">3</span>**<span class="hljs-number">67</span>-<span class="hljs-number">1</span><br>F.&lt;img&gt;=GF((p,<span class="hljs-number">2</span>), modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(F, [<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>P=E(<span class="hljs-number">48078665342759973922737682036708423814190721092041844128027005717</span>*img + <span class="hljs-number">101453330026777115174150344369057670486666592516047972012938796665</span>,<br> <span class="hljs-number">106414280972661281085621154931449660232878796703063973273414757742</span>*img + <span class="hljs-number">39724328357561096793476627099678863783547841068613222678288745599</span>)<br>Q=E(<span class="hljs-number">93500514099794038270009024277832755039609701103181802675798729052</span>*img + <span class="hljs-number">47897193222031858455386507623256296001957037047526619598509235406</span>,<br> <span class="hljs-number">54198645028294833136677496634472064101831735083974811027732624298</span>*img + <span class="hljs-number">75625331732228140758389762066194385021895005176305694866704994925</span>)<br>G=E(<span class="hljs-number">99438327946055727177889400304218359448668814328993888248956295877</span>*img + <span class="hljs-number">4968626040861611178418787464521937488397920200577632479183463224</span>,<br> <span class="hljs-number">105950216810563991098390220256849202423207554566800612407368235975</span>*img + <span class="hljs-number">3691834310963900683221595180172998514255729221504935470233846876</span>)<br>H=E(<span class="hljs-number">51107307256620573344750692242449535834731290150105231422519471003</span>*img + <span class="hljs-number">93155460640102509761079363280109781081212723193482509556965830289</span>,<br> <span class="hljs-number">55648112626812914269722588029837092719545646171682298767546807156</span>*img + <span class="hljs-number">76607528540202433402606873074289417539785602790560632206527541013</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ee</span>(<span class="hljs-params">X,Y</span>):<br>    <span class="hljs-keyword">return</span> X.weil_pairing(Y,p+<span class="hljs-number">1</span>)<br>a=discrete_log(ee(G,Q),ee(P,Q))<br>b=discrete_log(ee(P,G),ee(P,Q))<br>c=discrete_log(ee(H,Q),ee(P,Q))<br>d=discrete_log(ee(P,H),ee(P,Q))<br><span class="hljs-built_in">print</span>(a,b,c,d)<br><span class="hljs-keyword">assert</span>(a*P+b*Q==G <span class="hljs-keyword">and</span> c*P+d*Q==H)<br><span class="hljs-comment">#104387901776481921020491968026212561265236729786055540819430222523 </span><br><span class="hljs-comment">#103077386564589714869729922397059093530581882186115640326801660297 </span><br><span class="hljs-comment">#82858008941957494629539360515452860058651023741867958937507591339 </span><br><span class="hljs-comment">#95720266381793956333967392421282383472307483512312215027077560801</span><br><br></code></pre></td></tr></table></figure><h2 id="2-SIDHç®—æ³•"><a href="#2-SIDHç®—æ³•" class="headerlink" title="2.SIDHç®—æ³•"></a>2.SIDHç®—æ³•</h2><h3 id="2-1-ç®—æ³•æµç¨‹"><a href="#2-1-ç®—æ³•æµç¨‹" class="headerlink" title="2.1 ç®—æ³•æµç¨‹"></a>2.1 ç®—æ³•æµç¨‹</h3><p>åœ¨ä¸Šé¢çš„åŸºç¡€çŸ¥è¯†ä¸‹ï¼Œæˆ‘ä»¬å¼€å§‹ä»‹ç»  SIDH ç®—æ³•</p><p>1.åŒæ–¹é€‰æ‹©æ¨¡æ•° $p&#x3D;2^\alpha3^\beta k-1$ï¼Œå…¶ä¸­å°½é‡ä½¿ $2^{\alpha}â‰ˆ3^{\beta}$ï¼Œ$k$ é€šå¸¸å– $1$ã€‚å’Œä¸€æ¡ $\mathbb C_{p}$ ä¸Šçš„è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ï¼ˆä¸€èˆ¬ä¸º $y^2&#x3D;x^3+x$ï¼‰ã€‚æ­¤å¤„æˆ‘ä»¬é€‰æ‹© $p&#x3D;71&#x3D;2^{3}3^{2}-1$ ï¼Œ$E:y^2&#x3D;x^3+x$ åœ¨ $\mathbb C_{p}$ ä¸Šçš„ j-ä¸å˜é‡ä¸º $24$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>ea,eb=<span class="hljs-number">3</span>,<span class="hljs-number">2</span><br>p=<span class="hljs-number">2</span>**ea*<span class="hljs-number">3</span>**eb-<span class="hljs-number">1</span><br>Cp.&lt;img&gt;=GF(p**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(Cp,[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure><p>2.Aé€‰æ‹© $E$ ä¸Šé˜¶ä¸º $2^\alpha$ çš„ä¸¤ä¸ªçº¿æ€§æ— å…³çš„ç‚¹ $P_A,Q_A$ ï¼ˆå¯ä»¥å‘ç° $E$ ä¸Šæœ‰ä¸¤ä¸ªé˜¶ä¸º $72$ çš„ç”Ÿæˆå…ƒï¼Œå› æ­¤ç›¸å¯¹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“å–åˆ°çš„ï¼‰ï¼ŒåŒç†ï¼ŒBé€‰æ‹© $E$ ä¸Šé˜¶ä¸º $3^\beta$ çš„ä¸¤ä¸ªçº¿æ€§æ— å…³çš„ç‚¹ $P_B,Q_B$ã€‚åˆ¤æ–­ $P,Q$ çº¿æ€§æ— å…³çš„æ–¹æ³•ï¼Œå°±æ˜¯åŒçº¿æ€§å¯¹ $e(P,Q)$ çš„å€¼ä¸ä¸º $1$ï¼Œä¹Ÿå°±æ˜¯ $Q$ æ— æ³•å†™æˆ $kP$ çš„å½¢å¼ã€‚åŒæ–¹åˆ†åˆ«å…¬å¼€ $P_A,Q_A,P_B,Q_B$ ä½œä¸ºå…¬å…±å‚æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genA</span>(<span class="hljs-params">Ec</span>):<br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>        Pa=Ec.random_element()*((p+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>**ea)<br>        <span class="hljs-keyword">if</span>(Pa!=E(<span class="hljs-number">0</span>) <span class="hljs-keyword">and</span> Pa.order()==<span class="hljs-number">2</span>**ea):<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>        Qa=Ec.random_element()*((p+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>**ea)<br>        <span class="hljs-keyword">if</span>(Qa.weil_pairing(Pa,<span class="hljs-number">2</span>**ea)!=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> Qa.order()==<span class="hljs-number">2</span>**ea):<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> Pa,Qa<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genB</span>(<span class="hljs-params">Ec</span>):<br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>        Pb=Ec.random_element()*((p+<span class="hljs-number">1</span>)//<span class="hljs-number">3</span>**eb)<br>        <span class="hljs-keyword">if</span>(Pb!=E(<span class="hljs-number">0</span>) <span class="hljs-keyword">and</span> Pb.order()==<span class="hljs-number">3</span>**eb):<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>        Qb=Ec.random_element()*((p+<span class="hljs-number">1</span>)//<span class="hljs-number">3</span>**eb)<br>        <span class="hljs-keyword">if</span>(Qb.weil_pairing(Pb,<span class="hljs-number">3</span>**eb)!=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> Qb.order()==<span class="hljs-number">3</span>**eb):<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> Pb,Qb<br>Pa,Qa=genA(E)<br>Pb,Qb=genB(E)<br><span class="hljs-built_in">print</span>(Pa.xy(),Qa.xy(),Pa.weil_pairing(Qa,<span class="hljs-number">2</span>**ea))<br><span class="hljs-built_in">print</span>(Pb.xy(),Qb.xy(),Pb.weil_pairing(Qb,<span class="hljs-number">3</span>**eb))<br><span class="hljs-comment">#(20*img + 13, 24*img + 45) (53*img + 32, 46*img + 7) 6*img + 65</span><br><span class="hljs-comment">#(36*img + 68, 15*img + 12) (62*img + 27, 21*img + 10) 29*img + 56</span><br></code></pre></td></tr></table></figure><p> 3.Aéšæœºé€‰æ‹©ç§˜å¯†å€¼ $x_A$ï¼Œè®¡ç®— $S_A&#x3D;P_A+x_AQ_A$ã€‚ç„¶åè®¡ç®—åŒæº $\phi_A:E\rightarrow E_A$ï¼Œå…¶ä¸­ $\phi_A$ ä¸º $\alpha-1$ ä¸ª $2$ æ¬¡åŒæºç»„åˆè€Œæˆï¼Œæœ€ç»ˆç»“æœä¸ $S_A$ ç›¸å…³ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ° A çš„å…¬é’¥ä¸º $E_A,\phi_A(P_B),\phi_A(Q_B)$ï¼Œç§é’¥ä¸º $x_A,S_A$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">xa=randint(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>**ea-<span class="hljs-number">1</span>)<br>Sa=Pa+xa*Qa<br><span class="hljs-built_in">print</span>(xa,Sa.xy())<br>Sa1=Sa<br>E1=E<br>Pas,Eas=[],[E]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ea-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>    Ta=Sa1*(<span class="hljs-number">2</span>**i)<br>    phi = E1.isogeny(Ta)<br>    Eai = phi.codomain()<br>    Sa1 = phi(Sa1)<br>    E1=Eai<br>    Pas.append(phi)<br>    Eas.append(Eai)<br>phiA=Pas[-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Pas)-<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    phiA*=Pas[i]<br><span class="hljs-built_in">print</span>(phiA)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Eas)):<br>    <span class="hljs-built_in">print</span>(Eas[i].j_invariant(),end=<span class="hljs-string">&#x27;  -&gt;  &#x27;</span> <span class="hljs-keyword">if</span> i!=<span class="hljs-built_in">len</span>(Eas)-<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">6 (20*img + 58, 45*img + 24)</span><br><span class="hljs-string">Composite morphism of degree 4 = 2^2:</span><br><span class="hljs-string">  From: Elliptic Curve defined by y^2 = x^3 + x over Finite Field in img of size 71^2</span><br><span class="hljs-string">  To:   Elliptic Curve defined by y^2 = x^3 + 27*x + 41 over Finite Field in img of size 71^2</span><br><span class="hljs-string">24  -&gt;  24  -&gt;  17</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>4.åŒç†ï¼ŒBéšæœºé€‰æ‹©ç§˜å¯†å€¼ $x_B$ï¼Œè®¡ç®— $S_B&#x3D;P_B+x_BQ_B$ã€‚ç„¶åè®¡ç®—åŒæº $\phi_B:E\rightarrow E_B$ï¼Œå…¶ä¸­ $\phi_B$ ä¸º $\beta-1$ä¸ª $3$ æ¬¡åŒæºç»„åˆè€Œæˆï¼Œæœ€ç»ˆç»“æœä¸ $S_B$ ç›¸å…³ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ° B çš„å…¬é’¥ä¸º $E_B,\phi_B(P_A),\phi_B(Q_A)$ï¼Œç§é’¥ä¸º $x_B,S_B$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">xb=randint(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>**eb-<span class="hljs-number">1</span>)<br>Sb=Pb+xb*Qb<br><span class="hljs-built_in">print</span>(xb,Sb.xy())<br>Sb1=Sb<br>E1=E<br>Pbs,Ebs=[],[E]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(eb-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>    Tb=Sb1*(<span class="hljs-number">3</span>**i)<br>    phi = E1.isogeny(Tb)<br>    Ebi = phi.codomain()<br>    Sb1 = phi(Sb1)<br>    E1=Ebi<br>    Pbs.append(phi)<br>    Ebs.append(Ebi)<br>phiB=Pbs[-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Pbs)-<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    phiB*=Pbs[i]<br><span class="hljs-built_in">print</span>(phiB)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Ebs)):<br>    <span class="hljs-built_in">print</span>(Ebs[i].j_invariant(),end=<span class="hljs-string">&#x27;  -&gt;  &#x27;</span> <span class="hljs-keyword">if</span> i!=<span class="hljs-built_in">len</span>(Ebs)-<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">6 (54, 18)</span><br><span class="hljs-string">Isogeny of degree 3 from Elliptic Curve defined by y^2 = x^3 + x over Finite Field in img of size 71^2 to Elliptic Curve defined by y^2 = x^3 + 13*x + 66 over Finite Field in img of size 71^2</span><br><span class="hljs-string">24  -&gt;  66</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>5.æ­¤æ—¶ï¼ŒåŒæ–¹çš„å…¬é’¥å¦‚ä¸‹ï¼Œå¹¶ä¸”åœ¨ä¸Šé¢çš„è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒA å…±å­˜å‚¨äº† $\alpha&#x3D;3$ æ¡æ›²çº¿ï¼Œè¿™ä¸‰æ¡æ›²çº¿çš„j-ä¸å˜é‡åˆ†åˆ«ä¸ºï¼š$24,24,17$ï¼ŒBå­˜å‚¨äº† $\beta&#x3D;2$ æ¡æ›²çº¿ï¼Œå…¶ j-ä¸å˜é‡åˆ†åˆ«ä¸º $24,66$ã€‚ï¼ˆåŒæ–¹ç¬¬ä¸€ä¸ª $24$ ä¸ºåŸå§‹æ›²çº¿ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">PKA=(phiA.codomain(),phiA(Pb),phiA(Qb))<br>PKB=(phiB.codomain(),phiB(Pa),phiB(Qa))<br><span class="hljs-built_in">print</span>(PKA)<br><span class="hljs-built_in">print</span>(PKB)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">PKA:</span><br><span class="hljs-string">(Elliptic Curve defined by y^2 = x^3 + 27*x + 41 over Finite Field in img of size 71^2, </span><br><span class="hljs-string">(19*img + 2 : 37*img + 67 : 1), </span><br><span class="hljs-string">(57*img + 11 : 4*img + 51 : 1))</span><br><span class="hljs-string">PKB:</span><br><span class="hljs-string">(Elliptic Curve defined by y^2 = x^3 + 13*x + 66 over Finite Field in img of size 71^2, </span><br><span class="hljs-string">(23*img + 44 : 32*img + 7 : 1), </span><br><span class="hljs-string">(46*img + 50 : 22*img + 43 : 1))</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>6.åœ¨å®Œæˆä¸Šè¿°çš„æ­¥éª¤åï¼ŒAä½¿ç”¨Bçš„å…¬é’¥ $E_B,\phi_B(P_A),\phi_B(Q_A)$ å’Œè‡ªå·±çš„ç§é’¥ $x_A$ï¼Œè®¡ç®— $S_{AB}&#x3D;\phi_B(P_A)+x_A\phi_B(Q_A)$ï¼Œç„¶åèµ°å’Œä¹‹å‰ç›¸åŒçš„æ­¥éª¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python">Eab=phiB.codomain()<br>Pab,Qab=phiB(Pa),phiB(Qa)<br>Sab=Pab+xa*Qab<br><span class="hljs-built_in">print</span>(Sab.xy())<br>Sab1=Sab<br>Eab1=Eab<br>Pabs,Eabs=[],[Eab]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ea-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>    Tab=Sab1*(<span class="hljs-number">2</span>**i)<br>    phi = Eab1.isogeny(Tab)<br>    Eabi = phi.codomain()<br>    Sab1 = phi(Sab1)<br>    Eab1=Eabi<br>    Pabs.append(phi)<br>    Eabs.append(Eabi)<br>phiAB=Pabs[-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Pabs)-<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    phiAB*=Pabs[i]<br><span class="hljs-built_in">print</span>(phiAB)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Eabs)):<br>    <span class="hljs-built_in">print</span>(Eabs[i].j_invariant(),end=<span class="hljs-string">&#x27;  -&gt;  &#x27;</span> <span class="hljs-keyword">if</span> i!=<span class="hljs-built_in">len</span>(Eabs)-<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">(26*img + 40, 3*img + 35)</span><br><span class="hljs-string">Composite morphism of degree 4 = 2^2:</span><br><span class="hljs-string">  From: Elliptic Curve defined by y^2 = x^3 + 13*x + 66 over Finite Field in img of size 71^2</span><br><span class="hljs-string">  To:   Elliptic Curve defined by y^2 = x^3 + 14*x + 56 over Finite Field in img of size 71^2</span><br><span class="hljs-string">66  -&gt;  48  -&gt;  40</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>7.åŒç†ï¼ŒBä½¿ç”¨Açš„å…¬é’¥ $E_A,\phi_A(P_B),\phi_A(Q_B)$ å’Œè‡ªå·±çš„ç§é’¥ $x_B$ï¼Œè®¡ç®— $S_{BA}&#x3D;\phi_A(P_B)+x_B\phi_A(Q_B)$ï¼Œç„¶åèµ°å’Œä¹‹å‰ç›¸åŒçš„æ­¥éª¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">Eba=phiA.codomain()<br>Pba,Qba=phiA(Pb),phiA(Qb)<br>Sba=Pba+xb*Qba<br><span class="hljs-built_in">print</span>(Sba.xy())<br>Sba1=Sba<br>Eba1=Eba<br>Pbas,Ebas=[],[Eba]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(eb-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>    Tba=Sba1*(<span class="hljs-number">3</span>**i)<br>    phi = Eba1.isogeny(Tba)<br>    Ebai = phi.codomain()<br>    Sba1 = phi(Sba1)<br>    Eba1=Ebai<br>    Pbas.append(phi)<br>    Ebas.append(Ebai)<br>phiBA=Pbas[-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Pbas)-<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    phiBA*=Pbas[i]<br><span class="hljs-built_in">print</span>(phiBA)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Ebas)):<br>    <span class="hljs-built_in">print</span>(Ebas[i].j_invariant(),end=<span class="hljs-string">&#x27;  -&gt;  &#x27;</span> <span class="hljs-keyword">if</span> i!=<span class="hljs-built_in">len</span>(Ebas)-<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">(23, 7)</span><br><span class="hljs-string">Isogeny of degree 3 from Elliptic Curve defined by y^2 = x^3 + 27*x + 41 over Finite Field in img of size 71^2 to Elliptic Curve defined by y^2 = x^3 + 14*x + 56 over Finite Field in img of size 71^2</span><br><span class="hljs-string">17  -&gt;  40</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>8.æœ€ç»ˆï¼ŒAåœ¨è®¡ç®—æ—¶ï¼Œå¾—åˆ°çš„æ›²çº¿çš„j-ä¸å˜é‡çš„å˜åŒ–è¿‡ç¨‹ä¸ºï¼š$66,48,40$ï¼Œè€ŒBå¾—åˆ°çš„æ›²çº¿çš„j-ä¸å˜é‡å˜åŒ–è¿‡ç¨‹ä¸º $17,40$ã€‚å› æ­¤ï¼ŒåŒæ–¹å…±äº«çš„ç§˜å¯†å€¼ä¸º $40$ã€‚</p><h3 id="2-2-ä»£ç å®ç°"><a href="#2-2-ä»£ç å®ç°" class="headerlink" title="2.2 ä»£ç å®ç°"></a>2.2 ä»£ç å®ç°</h3><p>é‡æ„ä¸€ä¸‹å‰é¢çš„ä»£ç ï¼š</p><h4 id="2-2-1-Init"><a href="#2-2-1-Init" class="headerlink" title="2.2.1 Init"></a>2.2.1 Init</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>alph,beta=<span class="hljs-number">8</span>,<span class="hljs-number">5</span><br>p=<span class="hljs-number">2</span>**alph*<span class="hljs-number">3</span>**beta-<span class="hljs-number">1</span><br>Cp.&lt;img&gt;=GF(p**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(Cp,[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure><h4 id="2-2-2-ParamGen"><a href="#2-2-2-ParamGen" class="headerlink" title="2.2.2 ParamGen"></a>2.2.2 ParamGen</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">paramGen</span>(<span class="hljs-params">Ec,K,eK,e5K</span>):<br>    <span class="hljs-keyword">assert</span> K <span class="hljs-keyword">in</span> [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]<br>    P=Ec(<span class="hljs-number">0</span>)<br>    J=<span class="hljs-number">5</span>-K<br>    <span class="hljs-keyword">while</span>(K**(eK-<span class="hljs-number">1</span>)*P==Ec(<span class="hljs-number">0</span>)):<br>        P=(J**e5K)*Ec.random_element()<br>    Q=Ec(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">while</span>(P.weil_pairing(Q,K**eK)**(K**(eK-<span class="hljs-number">1</span>))==<span class="hljs-number">1</span>):<br>        Q=(J**e5K)*Ec.random_element()<br>    <span class="hljs-keyword">return</span> P,Q<br><br>        <br>Pa,Qa=paramGen(E,<span class="hljs-number">2</span>,alph,beta)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Pa =&#x27;</span>,Pa.xy())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Qa =&#x27;</span>,Qa.xy())<br>Pb,Qb=paramGen(E,<span class="hljs-number">3</span>,beta,alph)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Pb =&#x27;</span>,Pb.xy())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Qb =&#x27;</span>,Qb.xy())<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Pa = (39380*i + 3466, 17196*i + 12226)</span><br><span class="hljs-string">Qa = (16683*i + 35698, 11691*i + 44683)</span><br><span class="hljs-string">Pb = (32011*i + 53204, 48668*i + 25851)</span><br><span class="hljs-string">Qb = (3742*i + 40029, 60467*i + 51431)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h4 id="2-2-3-KeyGen"><a href="#2-2-3-KeyGen" class="headerlink" title="2.2.3 KeyGen"></a>2.2.3 KeyGen</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pkGen</span>(<span class="hljs-params">P,Q,Po,Qo,x,Ec</span>):<br>    S = P+x*Q<br>    phi =  Ec.isogeny(S,algorithm=<span class="hljs-string">&quot;factored&quot;</span>)<br>    E1 = phi.codomain()<br>    <span class="hljs-keyword">return</span> E1,phi(Po),phi(Qo)<br>xa=randint(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>**alph-<span class="hljs-number">1</span>)<br>xb=randint(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>**beta-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;xa =&#x27;</span>,xa)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;xb =&#x27;</span>,xb)<br>Ea,Ga,Ha = pkGen(Pa,Qa,Pb,Qb,xa,E)<br>Eb,Gb,Hb = pkGen(Pb,Qb,Pa,Qa,xb,E)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Ea : <span class="hljs-subst">&#123;Ea&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Ga = <span class="hljs-subst">&#123;Ga.xy()&#125;</span>\nHa = <span class="hljs-subst">&#123;Ha.xy()&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Eb : <span class="hljs-subst">&#123;Eb&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Gb = <span class="hljs-subst">&#123;Gb.xy()&#125;</span>\nHb = <span class="hljs-subst">&#123;Hb.xy()&#125;</span>&#x27;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">xa = 72</span><br><span class="hljs-string">xb = 174</span><br><span class="hljs-string">Ea : Elliptic Curve defined by y^2 = x^3 + (10061*i+1875)*x + (44734*i+35632) over Finite Field in i of size 62207^2</span><br><span class="hljs-string">Ga = (2283*i + 47170, 34825*i + 48025)</span><br><span class="hljs-string">Ha = (40463*i + 37692, 51159*i + 38421)</span><br><span class="hljs-string">Eb : Elliptic Curve defined by y^2 = x^3 + (49242*i+18182)*x + (7897*i+49589) over Finite Field in i of size 62207^2</span><br><span class="hljs-string">Gb = (27311*i + 57671, 21378*i + 7288)</span><br><span class="hljs-string">Hb = (31852*i + 50453, 6044*i + 46259)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h4 id="2-2-4-Key-Exchange"><a href="#2-2-4-Key-Exchange" class="headerlink" title="2.2.4 + Key Exchange"></a>2.2.4 + Key Exchange</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSecret</span>(<span class="hljs-params">Ec,P,Q,x</span>):<br>    Key = P+x*Q<br>    phi =  Ec.isogeny(Key,algorithm=<span class="hljs-string">&quot;factored&quot;</span>)<br>    <span class="hljs-keyword">return</span> phi.codomain().j_invariant()<br><br>Keya = getSecret(Eb,Gb,Hb,xa)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Keya =&#x27;</span>,Keya)<br>Keyb = getSecret(Ea,Ga,Ha,xb)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Keyb =&#x27;</span>,Keyb)<br><span class="hljs-keyword">assert</span> Keya==Keyb<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Keya = 10325*i + 49607</span><br><span class="hljs-string">Keyb = 10325*i + 49607</span><br><span class="hljs-string">Assert Pass.</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h3 id="2-3-SIDHå®‰å…¨æ€§åˆ†æ"><a href="#2-3-SIDHå®‰å…¨æ€§åˆ†æ" class="headerlink" title="2.3 SIDHå®‰å…¨æ€§åˆ†æ"></a>2.3 SIDHå®‰å…¨æ€§åˆ†æ</h3><h4 id="2-3-1-è®ºæ–‡é“¾æ¥-è®ºæ–‡é™„ç€ä»£ç "><a href="#2-3-1-è®ºæ–‡é“¾æ¥-è®ºæ–‡é™„ç€ä»£ç " class="headerlink" title="2.3.1 è®ºæ–‡é“¾æ¥ &amp; è®ºæ–‡é™„ç€ä»£ç "></a>2.3.1 è®ºæ–‡é“¾æ¥ &amp; è®ºæ–‡é™„ç€ä»£ç </h4><p>SIDHç›®å‰å·²ç»è¢«ç ´è§£äº†ï¼ŒGitHubä¸Šç›®å‰ä¹Ÿæœ‰äº†å¾ˆå¤šSageMathçš„çš„ä»£ç ï¼ŒA å¯ä»¥åœ¨åªçŸ¥é“ B çš„å…¬é’¥çš„æƒ…å†µä¸‹ï¼Œç¡®å®š B çš„ç§é’¥ã€‚æœ€å¿«çš„æ–¹æ³•åªéœ€è¦å‡ åç§’å°±å¯ä»¥æ”»ç ´ 400 ä½æ ‡å‡†çš„å‚æ•°ã€‚</p><p><a href="https://eprint.iacr.org/2022/975.pdf">è®ºæ–‡é“¾æ¥2022-975</a><br><a href="https://github.com/GiacomoPope/Castryck-Decru-SageMath">æ”»å‡»SIDHçš„ä»£ç </a></p><p>è®ºæ–‡ä¸­ä»£ç çš„è¿è¡Œç»“æœï¼š</p><p><img src="/2025/02/01/ECCNotes4/5.png" alt="5"></p><h4 id="2-3-2-06010å‹æ›²çº¿çš„æ”»å‡»"><a href="#2-3-2-06010å‹æ›²çº¿çš„æ”»å‡»" class="headerlink" title="2.3.2 06010å‹æ›²çº¿çš„æ”»å‡»"></a>2.3.2 06010å‹æ›²çº¿çš„æ”»å‡»</h4><p>å½“ç„¶ä½œä¸ºä¸€ä¸ªCTFerï¼Œ<del>æ—¢ç„¶äººå®¶éƒ½å·²ç»ç ´è§£äº†SIDHäº†ï¼Œæˆ‘ä»¬å½“ç„¶è¦å­¦ä¼šç”¨ä»–çš„ä»£ç </del>ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¯¥ä»£ç ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ $y^2&#x3D;x^3+6x^2+x$ çš„æ›²çº¿ï¼Œè€ŒCTFé¢˜ç›®ä¸­ï¼Œå¸¸ç”¨çš„æ›²çº¿æ˜¯ $y^2&#x3D;x^3+x$ï¼Œå¾ˆæ˜æ˜¾ï¼Œä¸¤ä¸ªæ›²çº¿éƒ½æ˜¯è’™å“¥é©¬åˆ©æ›²çº¿ï¼Œä½†ä¸åŒæºï¼Œæ‰€ä»¥ä¸å­˜åœ¨åŒæ„æ˜ å°„ã€‚</p><p>åœ¨é˜…è¯»è®ºæ–‡ä¹‹åï¼Œå¯ä»¥å‘ç°ï¼Œè®ºæ–‡çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œæ˜¯è¦æ„é€ å‡ºä¸€ä¸ªæ›²çº¿ä¸Šçš„è‡ªåŒæ€ $\phi$ï¼Œæ»¡è¶³ $\phi(\phi(P))&#x3D;-4P$ã€‚è¿™ä¸ª $\phi$ åˆè¢«è®°ä½œ $\phi_{2\mathrm i}$ã€‚å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªæ”»å‡»ä»£ç ä¸­çš„ <code>public_values_aux.py</code> æ–‡ä»¶ä¸­ï¼Œæœ‰è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œä¼¼ä¹é™åˆ¶æ­»äº†æ›²çº¿çš„å½¢å¼ä¸º $y^2&#x3D;x^3+6x^2+x$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_distortion_map</span>(<span class="hljs-params">E</span>):<br>    <span class="hljs-keyword">if</span> E.a_invariants() != (<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">raise</span> NotImplementedError<br>    <span class="hljs-keyword">return</span> E.isogeny(E.lift_x(ZZ(<span class="hljs-number">1</span>)), codomain=E)<br></code></pre></td></tr></table></figure><p>è€Œé˜…è¯»å…¶æ”»å‡»ä»£ç <code>SIKEp434.sage</code>ï¼Œå¯ä»¥å‘ç°è¿™æ ·ä¸€è¡Œï¼Œæ°å¥½æ˜¯ä¸ºäº†æ±‚ $\phi_{2\mathrm i}$ ç”¨çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">two_i = generate_distortion_map(E_start)<br></code></pre></td></tr></table></figure><p>ç»è¿‡æµ‹è¯•ä¹Ÿçš„ç¡®å¦‚æ­¤ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_distortion_map</span>(<span class="hljs-params">E</span>):<br>    <span class="hljs-keyword">if</span> E.a_invariants() != (<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">raise</span> NotImplementedError<br>    <span class="hljs-keyword">return</span> E.isogeny(E.lift_x(<span class="hljs-number">1</span>), codomain=E)<br>p=<span class="hljs-number">2</span>**<span class="hljs-number">8</span>*<span class="hljs-number">3</span>**<span class="hljs-number">5</span>-<span class="hljs-number">1</span><br>F.&lt;i&gt;=GF((p,<span class="hljs-number">2</span>),modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E1=EllipticCurve(F,[<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>G=E1.random_element()<br>phi=generate_distortion_map(E1)<br><span class="hljs-built_in">print</span>(G.xy())<br><span class="hljs-built_in">print</span>((-<span class="hljs-number">4</span>*G).xy())<br><span class="hljs-built_in">print</span>(phi(phi(G)).xy())<br>(<span class="hljs-number">54868</span>*i + <span class="hljs-number">58756</span>, <span class="hljs-number">51614</span>*i + <span class="hljs-number">43751</span>)<br>(<span class="hljs-number">32804</span>*i + <span class="hljs-number">60579</span>, <span class="hljs-number">20634</span>*i + <span class="hljs-number">8371</span>)<br>(<span class="hljs-number">32804</span>*i + <span class="hljs-number">60579</span>, <span class="hljs-number">20634</span>*i + <span class="hljs-number">8371</span>)<br></code></pre></td></tr></table></figure><p>å› æ­¤ï¼Œåªè¦æˆ‘ä»¬æå‡ºäº† $\phi_{2\mathrm i}$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨å…¶ä»£ç äº†ã€‚æˆ‘ä»¬å¯ä»¥å…ˆä»Gitä¸Šä¸‹è½½è¿™ä¸ªä»£ç çš„zipï¼Œè§£å‹åˆ°æŸä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œç„¶åå†™å…¥è¿™æ ·çš„æµ‹è¯•ä»£ç ï¼ˆç­”æ¡ˆæ˜¯ $248011$ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> public_values_aux<br><span class="hljs-keyword">from</span> public_values_aux <span class="hljs-keyword">import</span> *<br><br>load(<span class="hljs-string">&#x27;castryck_decru_shortcut.sage&#x27;</span>)<br><br>a, b = <span class="hljs-number">18</span>,<span class="hljs-number">13</span><br><br>p = <span class="hljs-number">2</span>^a*<span class="hljs-number">3</span>^b - <span class="hljs-number">1</span> <span class="hljs-comment"># do not change</span><br><br>public_values_aux.p = p<br>Fp2.&lt;i&gt; = GF(p^<span class="hljs-number">2</span>, modulus=x^<span class="hljs-number">2</span>+<span class="hljs-number">1</span>)<br>R.&lt;x&gt; = PolynomialRing(Fp2)<br><br>E_start = EllipticCurve(Fp2, [<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>E_start.set_order((p+<span class="hljs-number">1</span>)^<span class="hljs-number">2</span>, num_checks=<span class="hljs-number">0</span>) <br><br><br>two_i = generate_distortion_map(E_start)<br><br>P2=E_start(<span class="hljs-number">220737745801</span>*i + <span class="hljs-number">50222311055</span>, <span class="hljs-number">190367540881</span>*i + <span class="hljs-number">54017057412</span>)<br>Q2=E_start(<span class="hljs-number">140405500965</span>*i + <span class="hljs-number">258042847301</span>, <span class="hljs-number">297210225013</span>*i + <span class="hljs-number">344888892331</span>)<br>P3=E_start(<span class="hljs-number">354749614347</span>*i + <span class="hljs-number">280322752628</span>, <span class="hljs-number">85255872295</span>*i + <span class="hljs-number">255093011257</span>)<br>Q3=E_start(<span class="hljs-number">187154306904</span>*i + <span class="hljs-number">79900133137</span>, <span class="hljs-number">220502934600</span>*i + <span class="hljs-number">334923255776</span>)<br>check_torsion_points(E_start, a, b, P2, Q2, P3, Q3)<br><br>a2=<span class="hljs-number">6</span><br>a4=(<span class="hljs-number">227348106349</span>*i+<span class="hljs-number">257259789242</span>)<br>a6=(<span class="hljs-number">4035550462</span>*i+<span class="hljs-number">119078416285</span>)<br>EB=EllipticCurve(Fp2,[<span class="hljs-number">0</span>,a2,<span class="hljs-number">0</span>,a4,a6])<br>PB=EB(<span class="hljs-number">91970188975</span>*i + <span class="hljs-number">124693845086</span>, <span class="hljs-number">377253313719</span>*i + <span class="hljs-number">322377957916</span>)<br>QB=EB(<span class="hljs-number">198072574684</span>*i + <span class="hljs-number">400866480110</span>, <span class="hljs-number">96532007619</span>*i + <span class="hljs-number">380763487262</span>)<br><br>recovered_key = CastryckDecruAttack(E_start, P2, Q2, EB, PB, QB, two_i, num_cores=<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(recovered_key)<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/02/01/ECCNotes4/6.png" alt="6"></p><p>æ¢ä¸€ç»„å‚æ•°è¯•è¯•ï¼Œè¿™æ¬¡ç­”æ¡ˆæ˜¯ $53361602935692906567490749144731$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> public_values_aux<br><span class="hljs-keyword">from</span> public_values_aux <span class="hljs-keyword">import</span> *<br><br>load(<span class="hljs-string">&#x27;castryck_decru_shortcut.sage&#x27;</span>)<br><br>a, b = <span class="hljs-number">110</span>,<span class="hljs-number">67</span><br><br>p = <span class="hljs-number">2</span>^a*<span class="hljs-number">3</span>^b - <span class="hljs-number">1</span><br><br>public_values_aux.p = p<br>Fp2.&lt;i&gt; = GF(p^<span class="hljs-number">2</span>, modulus=x^<span class="hljs-number">2</span>+<span class="hljs-number">1</span>)<br>R.&lt;x&gt; = PolynomialRing(Fp2)<br><br>E_start = EllipticCurve(Fp2, [<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>E_start.set_order((p+<span class="hljs-number">1</span>)^<span class="hljs-number">2</span>, num_checks=<span class="hljs-number">0</span>) <br><br><br>two_i = generate_distortion_map(E_start)<br><br>P2=E_start(<span class="hljs-number">56610319193701558658735766617880355615385547932040925880687156764</span>*i + <span class="hljs-number">42698419292581064688242589979397467965126090170436941878853866568</span>, <span class="hljs-number">35736771060022153096871481140526466092251776000496542458805572451</span>*i + <span class="hljs-number">1406713305674803984210143602460748242038256281655932542401586960</span>)<br>Q2=E_start(<span class="hljs-number">87385346712865167405378671004116905429368722879634257587922373265</span>*i + <span class="hljs-number">20868980497449673695168909270503567045204488768234841927361424254</span>, <span class="hljs-number">93809470233601384687277542711720615096979514120814893736747406702</span>*i + <span class="hljs-number">102071080287673632345798509543832980678489137189256701006149797955</span>)<br>P3=E_start(<span class="hljs-number">108340825021242044737371303329468146504320017600004306920882246903</span>*i + <span class="hljs-number">108396170192786465171102545295777043093136519196500623859843999594</span>, <span class="hljs-number">39510198811668974327487043561554886437520251439351004986533313590</span>*i + <span class="hljs-number">98384580631758549086105854565205076233552192646375463524786202427</span>)<br>Q3=E_start(<span class="hljs-number">117708790334138506086639601581650847896208982849168647458602305949</span>*i + <span class="hljs-number">60171539076219076100859521953631698080351790640949638221590204795</span>, <span class="hljs-number">108234927295372521953904890581286233187456939597045817923583613193</span>*i + <span class="hljs-number">17111981949141181871590974861722205288395470270406688160159342438</span>)<br>check_torsion_points(E_start, a, b, P2, Q2, P3, Q3)<br><br>a2=<span class="hljs-number">6</span> <span class="hljs-comment">#usually to be six.</span><br>a4=(<span class="hljs-number">33352492415821181878007294686911877407020167370184992026961189883</span>*i+<span class="hljs-number">360155498372969691801778829113065642920064704754943849117579719</span>)<br>a6=(<span class="hljs-number">71078007951164850613906284431026209801045803425464743236950552863</span>*i+<span class="hljs-number">60050844645541971863484821267140778695102640789034683181783646104</span>)<br>EB=EllipticCurve(Fp2,[<span class="hljs-number">0</span>,a2,<span class="hljs-number">0</span>,a4,a6])<br>PB=EB(<span class="hljs-number">44655967089538875652566632875838189177891417754246765262862174361</span>*i + <span class="hljs-number">95761508234935577002311855392466107543835007665570312539644748521</span>, <span class="hljs-number">85321383142345971885193090537643266036849312093691332425107553101</span>*i + <span class="hljs-number">113017953225856300262660175780097470661672131417143141502018264468</span>)<br>QB=EB (<span class="hljs-number">71214736694275496825585051349583527644008441002295381958581065547</span>*i + <span class="hljs-number">118100008118642712698371498755385508818364986084944574352354913594</span>, <span class="hljs-number">54703329181345516353291579273842096570542601384268943693078600755</span>*i + <span class="hljs-number">84401862403085750806051707190053760164677853749560631699068036990</span>)<br><br>recovered_key = CastryckDecruAttack(E_start, P2, Q2, EB, PB, QB, two_i, num_cores=<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(recovered_key)<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿå¾ˆå¿«</p><p><img src="/2025/02/01/ECCNotes4/7.png" alt="7"></p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨2.2èŠ‚çš„ä»£ç è¿›è¡Œæµ‹è¯•ã€‚å…¶ä¸­ï¼š <code>E_start</code> ä¸ºåŸå§‹æ›²çº¿ï¼Œ$P_2,Q_2,P_3,Q_3$ å¯¹åº”2.2èŠ‚ä»£ç ä¸­çš„ $P_A,Q_A,P_B,Q_B$ï¼Œè€Œè¿™ä¸ªä»£ç ä¸­çš„ $E_B,P_B,Q_B$ å¯¹åº”2.2èŠ‚ä»£ç ä¸­çš„ $E_B,G_B,H_B$ã€‚</p><h4 id="2-3-3-00010å‹æ›²çº¿çš„æ”»å‡»"><a href="#2-3-3-00010å‹æ›²çº¿çš„æ”»å‡»" class="headerlink" title="2.3.3 00010å‹æ›²çº¿çš„æ”»å‡»"></a>2.3.3 00010å‹æ›²çº¿çš„æ”»å‡»</h4><p>åœ¨è®ºæ–‡çš„ç¬¬ 5 ç« ï¼Œæˆ‘ä»¬å¾—åˆ°äº†è¿™æ ·çš„å†…å®¹ï¼Œè™½ç„¶ç¿»è¯‘æ˜¯æœºå™¨ç¿»è¯‘ï¼Œä½†å¯ä»¥çœ‹åˆ° $\phi_{2\mathrm i}$ çš„æ˜ å°„è¡¨è¾¾å¼ä¸ºï¼š<br>$$<br>\phi_{2\mathrm i}: E(x,y)\rightarrow 2E(-x,\mathrm iy)<br>$$<br><img src="/2025/02/01/ECCNotes4/8.png" alt="8"></p><p>å› æ­¤ï¼Œå¯¹äºæ›²çº¿ $y^2&#x3D;x^3+x$ï¼Œä¸Šé¢çš„ <code>two_i</code> å¯ä»¥è¿™æ ·å†™ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">two_i</span>(<span class="hljs-params">Point</span>):<br>    Ec=Point.curve()<br>    <span class="hljs-keyword">if</span>(Point==Ec(<span class="hljs-number">0</span>)):<br>        <span class="hljs-keyword">return</span> Ec(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">else</span>:<br>        xx,yy=Point[<span class="hljs-number">0</span>],Point[<span class="hljs-number">1</span>]<br>        xx=-xx<br>        yy=i*yy<br>        iPoint=Ec(xx,yy)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>*iPoint<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—åˆ°æ”»å‡»ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> public_values_aux<br><span class="hljs-keyword">from</span> public_values_aux <span class="hljs-keyword">import</span> *<br><br>load(<span class="hljs-string">&#x27;castryck_decru_shortcut.sage&#x27;</span>)<br><br>a, b = <span class="hljs-number">110</span>,<span class="hljs-number">67</span><br><br>p = <span class="hljs-number">2</span>^a*<span class="hljs-number">3</span>^b - <span class="hljs-number">1</span> <br><br>public_values_aux.p = p<br>Fp2.&lt;i&gt; = GF(p^<span class="hljs-number">2</span>, modulus=x^<span class="hljs-number">2</span>+<span class="hljs-number">1</span>)<br>R.&lt;x&gt; = PolynomialRing(Fp2)<br><br>E_start = EllipticCurve(Fp2, [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>E_start.set_order((p+<span class="hljs-number">1</span>)^<span class="hljs-number">2</span>, num_checks=<span class="hljs-number">0</span>) <br><br><span class="hljs-comment"># Generation of the endomorphism 2i</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">two_i</span>(<span class="hljs-params">Point</span>):<br>    Ec=Point.curve()<br>    <span class="hljs-keyword">if</span>(Point==Ec(<span class="hljs-number">0</span>)):<br>        <span class="hljs-keyword">return</span> Ec(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">else</span>:<br>        xx,yy=Point[<span class="hljs-number">0</span>],Point[<span class="hljs-number">1</span>]<br>        xx=-xx<br>        yy=i*yy<br>        iPoint=Ec(xx,yy)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>*iPoint<br><br><br>P2=E_start(<span class="hljs-number">17195814840046408112963036169949156976799365698953771024820414396</span>*i + <span class="hljs-number">102931389186229048337379830319785276552723380376115687557503025718</span>, <span class="hljs-number">75778504057793479951018813267308472337220743929059667604796986592</span>*i + <span class="hljs-number">47914122352720119988527881631858648853952573354238926350337613260</span>)<br>Q2=E_start(<span class="hljs-number">54540319919150579200374436040602436895070957026612529299060696661</span>*i + <span class="hljs-number">64225985661603535357333706579836161964656161457361578265449177285</span>, <span class="hljs-number">2267083341011364099622517802559653254244413235641444399445423098</span>*i + <span class="hljs-number">23770653458973066207606115403897464007836542603675434759121428748</span>)<br>P3=E_start(<span class="hljs-number">7989847351628672981078106697557859098767196162395305639242023745</span>*i + <span class="hljs-number">89231383320582491381266348351541796604215452931393417057299686215</span>, <span class="hljs-number">99238707995304975968036268582514064981961075071032579111594311603</span>*i + <span class="hljs-number">38199292319769952631065248630069261885287525329034800830358661747</span>)<br>Q3=E_start(<span class="hljs-number">4663695293244872101098475353375523205838970445774326103489210382</span>*i + <span class="hljs-number">32961768669728583913855961871446561181466638649804077352262661465</span>, <span class="hljs-number">52712260135577782637658195833849499206999684173146994531696493355</span>*i + <span class="hljs-number">90137853988314928573189276753486360557512526456632678305271362467</span>)<br>check_torsion_points(E_start, a, b, P2, Q2, P3, Q3)<br><br><br>a2=<span class="hljs-number">0</span><br>a4=(<span class="hljs-number">102418828187774457761879456577153513507915057359277718737712550111</span>*i+<span class="hljs-number">31532950820601891722920142855587562494984182810592253153908855275</span>)<br>a6=(<span class="hljs-number">81186662414448050665979201453065315156725879839182514894602516221</span>*i+<span class="hljs-number">114855290460797749422119777020804067441781626139255389813090673539</span>) <br>EB=EllipticCurve(Fp2,[<span class="hljs-number">0</span>,a2,<span class="hljs-number">0</span>,a4,a6])<br>PB=EB(<span class="hljs-number">41424643566869521367632949668986202694950053240719386036239671784</span>*i + <span class="hljs-number">97100535686874659598560862233789138506102606757930590165770050211</span>, <span class="hljs-number">28478553207476926857405639847764592248944426695136614829558619038</span>*i + <span class="hljs-number">57112427683516687662270959498666544806334396087049034869773482261</span>)<br>QB=EB(<span class="hljs-number">83903916904730001170172551063303069216164579013051205895824540388</span>*i + <span class="hljs-number">94290363880834426978339452165347196781962782250248107794345225206</span>, <span class="hljs-number">89180000462470351871791116928719101870428228473355925736419881028</span>*i + <span class="hljs-number">95407185118153375790239945730336656643579227622240889452855365824</span>)<br><br><span class="hljs-comment">#87743098015915833551591820276761</span><br><br>recovered_key = CastryckDecruAttack(E_start, P2, Q2, EB, PB, QB, two_i, num_cores=<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(recovered_key)<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/02/01/ECCNotes4/9.png" alt="9"></p><h3 id="2-9-æ€»ç»“ä¸å›é¡¾"><a href="#2-9-æ€»ç»“ä¸å›é¡¾" class="headerlink" title="2.9 æ€»ç»“ä¸å›é¡¾"></a>2.9 æ€»ç»“ä¸å›é¡¾</h3><h4 id="2-9-1-åŒæºæ›²çº¿çš„æ±‚æ³•"><a href="#2-9-1-åŒæºæ›²çº¿çš„æ±‚æ³•" class="headerlink" title="2.9.1 åŒæºæ›²çº¿çš„æ±‚æ³•"></a>2.9.1 åŒæºæ›²çº¿çš„æ±‚æ³•</h4><h5 id="2åŒæº"><a href="#2åŒæº" class="headerlink" title="2åŒæº"></a>2åŒæº</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">2</span>**<span class="hljs-number">8</span>*<span class="hljs-number">3</span>**<span class="hljs-number">5</span>-<span class="hljs-number">1</span><br>F.&lt;img&gt;=GF((p,<span class="hljs-number">2</span>),modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(F,[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>P=E(img,<span class="hljs-number">0</span>)<br>E.isogeny(P).codomain().j_invariant()<br></code></pre></td></tr></table></figure><h5 id="3åŒæº"><a href="#3åŒæº" class="headerlink" title="3åŒæº"></a>3åŒæº</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">2</span>**<span class="hljs-number">8</span>*<span class="hljs-number">3</span>**<span class="hljs-number">5</span>-<span class="hljs-number">1</span><br>F.&lt;img&gt;=GF((p,<span class="hljs-number">2</span>),modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(F,[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>P=E(<span class="hljs-number">54897</span>,<span class="hljs-number">40274</span>)<br>E.isogeny(P).codomain().j_invariant()<br></code></pre></td></tr></table></figure><h5 id="æ··åˆåŒæº"><a href="#æ··åˆåŒæº" class="headerlink" title="æ··åˆåŒæº"></a>æ··åˆåŒæº</h5><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ··åˆåŒæºå¿…é¡»åŠ  <code>algorithm=&#39;factored&#39;</code>ï¼Œå¦åˆ™ä¼šéå¸¸æ…¢ï¼Œå¹¶ä¸”å†…å­˜è¿˜ä¼šè¢«å¡çˆ†ã€‚ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">2</span>**<span class="hljs-number">8</span>*<span class="hljs-number">3</span>**<span class="hljs-number">5</span>-<span class="hljs-number">1</span><br>F.&lt;img&gt;=GF((p,<span class="hljs-number">2</span>),modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E=EllipticCurve(F,[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>P=E(<span class="hljs-number">42926</span>*img + <span class="hljs-number">1887</span>, <span class="hljs-number">60021</span>*img + <span class="hljs-number">14976</span>)<br>E.isogeny(P).codomain().j_invariant()<br><span class="hljs-comment">#4485*img + 58033</span><br></code></pre></td></tr></table></figure><h4 id="2-9-2-SIDHçš„åº”ç”¨"><a href="#2-9-2-SIDHçš„åº”ç”¨" class="headerlink" title="2.9.2 SIDHçš„åº”ç”¨"></a>2.9.2 SIDHçš„åº”ç”¨</h4><p>å·²çŸ¥é€šä¿¡åŒæ–¹çš„å‚æ•°å¦‚ä¸‹ï¼Œflagä¸ºåŒæ–¹å…±äº«ç§˜å¯†å€¼çš„å®éƒ¨çš„md5ï¼ŒåŒ…ä¸Šflagæäº¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">alph,beta = <span class="hljs-number">191</span>,<span class="hljs-number">118</span><br>p = <span class="hljs-number">2</span>**alph*<span class="hljs-number">3</span>**beta-<span class="hljs-number">1</span><br>Cp.&lt;img&gt; = GF(p**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E = EllipticCurve(Cp,[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>xa = <span class="hljs-number">584496555152977952263051187264513064651276067462422849897</span><br>xb = <span class="hljs-number">37682757929733147743730633501689839022920301898548500220</span><br>Pa = (<span class="hljs-number">3890173385494077585786113518802477300671812804735903208231728641198015042926576919967486058477584860965263321449</span>*img + <span class="hljs-number">584828209842877103640744000896095339777363670631877394059372721680411559677189054661820559515040199234170221817651</span>, <span class="hljs-number">410509288765605099029167660119172995772205248635741021443348197514620983285967575552293060720294469867982349678659</span>*img + <span class="hljs-number">548930165860799787670196445655670316785292043986372282652343383518446174454396640035137367946163853876973452753668</span>)<br>Qa = (<span class="hljs-number">421604690831879517745604871374938409034817312564753376151016104663541612478690914420681512561903274599781004629482</span>*img + <span class="hljs-number">86871671015996107147496820435983909507668991378550122772712016787149157410753495265887407752063557661771605943910</span>, <span class="hljs-number">180160609497005981465811172297833341634318706104256987203386737689308641065089877175010097208331147293242130238056</span>*img + <span class="hljs-number">197151342217785322710468346320690864703187559637211131744844465191227679295619198257889036196666751765532255326047</span>)<br>Pb = (<span class="hljs-number">432246268507304620615765479255840099513607930320042189132113053467777111887959352975167229337223218153317644975096</span>*img + <span class="hljs-number">258234009763233650750196421111785919206795442836176639412780414960329244931088103699224563002378692257321514631566</span>, <span class="hljs-number">433353153375662377686506321322284787451502853238565773205137821971198303160453015591068400935600894496365212830590</span>*img + <span class="hljs-number">292313742846902851874437028342611928684224606688812088787816579414266084838339385752295076820697862252252546861994</span>)<br>Qb = (<span class="hljs-number">272086612765181657253335814356130852004060861562928627633629971852828122421021509993471606010508380202640765560265</span>*img + <span class="hljs-number">46012656019163765219488619336710432956068583297368188950052950196080786770580284615473738417777040081328154808021</span>, <span class="hljs-number">608201375956852861960569561164278611354036955015273398439040772149007105116277599617924113376019067039282284399710</span>*img + <span class="hljs-number">315116752107370746379770489489641864422673846221948079905427534744354763665649013882058862200076096765012230361516</span>)<br></code></pre></td></tr></table></figure><p>æ—¢ç„¶ç§é’¥éƒ½ç»™ä½ äº†ï¼Œé‚£ç›´æ¥èµ°æµç¨‹å¾—äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>alph,beta = <span class="hljs-number">191</span>,<span class="hljs-number">118</span><br>p = <span class="hljs-number">2</span>**alph*<span class="hljs-number">3</span>**beta-<span class="hljs-number">1</span><br>Cp.&lt;img&gt; = GF(p**<span class="hljs-number">2</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>E = EllipticCurve(Cp,[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>xa = <span class="hljs-number">584496555152977952263051187264513064651276067462422849897</span><br>xb = <span class="hljs-number">37682757929733147743730633501689839022920301898548500220</span><br>Pa = E(<span class="hljs-number">3890173385494077585786113518802477300671812804735903208231728641198015042926576919967486058477584860965263321449</span>*img + <span class="hljs-number">584828209842877103640744000896095339777363670631877394059372721680411559677189054661820559515040199234170221817651</span>, <span class="hljs-number">410509288765605099029167660119172995772205248635741021443348197514620983285967575552293060720294469867982349678659</span>*img + <span class="hljs-number">548930165860799787670196445655670316785292043986372282652343383518446174454396640035137367946163853876973452753668</span>)<br>Qa = E(<span class="hljs-number">421604690831879517745604871374938409034817312564753376151016104663541612478690914420681512561903274599781004629482</span>*img + <span class="hljs-number">86871671015996107147496820435983909507668991378550122772712016787149157410753495265887407752063557661771605943910</span>, <span class="hljs-number">180160609497005981465811172297833341634318706104256987203386737689308641065089877175010097208331147293242130238056</span>*img + <span class="hljs-number">197151342217785322710468346320690864703187559637211131744844465191227679295619198257889036196666751765532255326047</span>)<br>Pb = E(<span class="hljs-number">432246268507304620615765479255840099513607930320042189132113053467777111887959352975167229337223218153317644975096</span>*img + <span class="hljs-number">258234009763233650750196421111785919206795442836176639412780414960329244931088103699224563002378692257321514631566</span>, <span class="hljs-number">433353153375662377686506321322284787451502853238565773205137821971198303160453015591068400935600894496365212830590</span>*img + <span class="hljs-number">292313742846902851874437028342611928684224606688812088787816579414266084838339385752295076820697862252252546861994</span>)<br>Qb = E(<span class="hljs-number">272086612765181657253335814356130852004060861562928627633629971852828122421021509993471606010508380202640765560265</span>*img + <span class="hljs-number">46012656019163765219488619336710432956068583297368188950052950196080786770580284615473738417777040081328154808021</span>, <span class="hljs-number">608201375956852861960569561164278611354036955015273398439040772149007105116277599617924113376019067039282284399710</span>*img + <span class="hljs-number">315116752107370746379770489489641864422673846221948079905427534744354763665649013882058862200076096765012230361516</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pkGen</span>(<span class="hljs-params">P,Q,Po,Qo,x,Ec</span>):<br>    S = P+x*Q<br>    phi =  Ec.isogeny(S,algorithm=<span class="hljs-string">&quot;factored&quot;</span>)<br>    E1 = phi.codomain()<br>    <span class="hljs-keyword">return</span> E1,phi(Po),phi(Qo)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSecret</span>(<span class="hljs-params">Ec,P,Q,x</span>):<br>    Key = P+x*Q<br>    phi =  Ec.isogeny(Key,algorithm=<span class="hljs-string">&quot;factored&quot;</span>)<br>    <span class="hljs-keyword">return</span> phi.codomain().j_invariant()<br><br>xa = <span class="hljs-number">225902606209514408534212339057054</span><br>xb = <span class="hljs-number">38410379124791756271891302485727</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;xa =&#x27;</span>,xa)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;xb =&#x27;</span>,xb)<br><br>Ea,Ga,Ha = pkGen(Pa,Qa,Pb,Qb,xa,E)<br>Eb,Gb,Hb = pkGen(Pb,Qb,Pa,Qa,xb,E)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Ea : <span class="hljs-subst">&#123;Ea&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Ga = <span class="hljs-subst">&#123;Ga.xy()&#125;</span>\nHa = <span class="hljs-subst">&#123;Ha.xy()&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Eb : <span class="hljs-subst">&#123;Eb&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Gb = <span class="hljs-subst">&#123;Gb.xy()&#125;</span>\nHb = <span class="hljs-subst">&#123;Hb.xy()&#125;</span>&#x27;</span>)<br><br>Keya = getSecret(Eb,Gb,Hb,xa)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Keya =&#x27;</span>,Keya)<br>Keyb = getSecret(Ea,Ga,Ha,xb)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Keyb =&#x27;</span>,Keyb)<br><span class="hljs-keyword">assert</span> Keya==Keyb<br><span class="hljs-comment">#Keyb = 600914791934031108627236809762877964673080416128475550460621517207409205713986769743394408671974542775613351353324*img + 491526678134851661327546821730369546969882065407965884271380638078279282963613533645664886114161991306616597283726</span><br><br></code></pre></td></tr></table></figure><p>å¾—åˆ°å®éƒ¨å’Œflagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">re_Key=<span class="hljs-number">491526678134851661327546821730369546969882065407965884271380638078279282963613533645664886114161991306616597283726</span><br><span class="hljs-comment">#flag&#123;009f92859d97ee0cc29fa04c53a2d228&#125;</span><br></code></pre></td></tr></table></figure><h4 id="2-9-3-SIDHçš„ç ´è§£"><a href="#2-9-3-SIDHçš„ç ´è§£" class="headerlink" title="2.9.3 SIDHçš„ç ´è§£"></a>2.9.3 SIDHçš„ç ´è§£</h4><p>å·²çŸ¥åŒæ–¹çš„å‚æ•°å¦‚ä¸‹ï¼Œflagä¸ºåŒæ–¹å…±äº«ç§˜å¯†å€¼çš„å®éƒ¨çš„md5ï¼Œæäº¤æ—¶è¯·åŒ…ä¸Šflagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">Pa = (<span class="hljs-number">232356258387014843308023791594194948039653666270340137835215927250973352859489298612585996169258523678050720878068</span>*img + <span class="hljs-number">538744669524057459396126178584247908817270647700116142476958188100924860869364698166826434756090268295618493824546</span>, <span class="hljs-number">76249308728653875112262060006464245936500586952836731644982931835700736654603945269238982425772488453412959020256</span>*img + <span class="hljs-number">422527598392474246465781364581068979648811682741474158269303182554106577514707994762230052567207331356617986793857</span>)<br>Qa = (<span class="hljs-number">461734419938992457897474506658120518854728597703342582171065611938696479104616816841422560219140242714052457098039</span>*img + <span class="hljs-number">428777625865071874615044976213650933847002825156453497653669798891114414242384057758719743544296087508587555797906</span>, <span class="hljs-number">10662506168648652077262377015475872318520888157151447996364468881456198789398711652111802781610471467541371693871</span>*img + <span class="hljs-number">290637079464465563854589563245667563508278272984878411820236219409522261330414289096025057004409258153467308935585</span>)<br>Pb = (<span class="hljs-number">136531171239478416253478572405792254497808491771514926079758453336517795761809532657725981910759601494892554255815</span>*img + <span class="hljs-number">547772446087952417016962537233369245145574866103039586455592266296446663680113698888179763744579786018164571857789</span>, <span class="hljs-number">457116649679592092763069582858437567765320891705891320551968559771374785456259433916225623550934992991299947284413</span>*img + <span class="hljs-number">220741477630185661756935255926737927348327841672351013800906282912811102990934707604736714895606762660312432200585</span>)<br>Qb = (<span class="hljs-number">68285232547217881547351504529947636670204344614106430836226815201213976201473256324305226432972069335362227146188</span>*img + <span class="hljs-number">536563314649157588596255866356195792762142377066728743466380118620513054320726201375156880198801968916974384042962</span>, <span class="hljs-number">363547187548222899213877620074284830292371238932649724761157743295775312969628273623976808527586196308395098178602</span>*img + <span class="hljs-number">272864944055789579262784896184113492423488480672733346446670727958326171151270072235303789238157891259626005445814</span>)<br>Eaa=<span class="hljs-number">553682304507170323694909479540159141417415955361357480550799039311002385510550740752642326777321790980623523493618</span>*img + <span class="hljs-number">617204275340906100098189128620612063894313851251833742088080508523155065989972960267092144352740575071678117964243</span><br>Eab=<span class="hljs-number">455319914313033939950132208386200653229055945097693853960296206618800901577191133231392650871295833537081485368870</span>*img + <span class="hljs-number">122442073359944268452731987876446768163247246045006139338145290536847351330281787685128240636078590905784113828395</span><br>Eba=<span class="hljs-number">325722253892019113276309344646772167140590893668313301180238023235229797514844218553269918097608427893375003138452</span>*img + <span class="hljs-number">364270281373947456485003876763533510032823702499784502493467975510883184423512855706767845689661428270907087419026</span><br>Ebb=<span class="hljs-number">368957767183452800630213316562881012761387625350286469658089964678523255885821818036490144483399922929140979711679</span>*img + <span class="hljs-number">359419267440966895576472888036339417074452010830491937875437874289887554146948963898485122900228028669459279474529</span><br>Ga = (<span class="hljs-number">153670688481774722286956654029987219016687216553982800489606486945669825176519237609374444750315392581331453200224</span>*img + <span class="hljs-number">623060232942591104056079987617666202027202833171675169068238715705747183738658800714190048981144792972700161906537</span>, <span class="hljs-number">587139501470612673184356690938039262515816479119557107398452643412923423690960896384919509254181855826626543517986</span>*img + <span class="hljs-number">615397222267594041179990468005784465011158277313570177564752638027537250079707783104979650283511075968620845092979</span>)<br>Ha = (<span class="hljs-number">572256162523445816598267038194968718644629027347119865886298198303092647830438487232425965009682510295148114056297</span>*img + <span class="hljs-number">347630821234807351437681064298041150986195714012763279973087493362352128919324539002908704100913234567613820995448</span>, <span class="hljs-number">168032604174726367019704754252432387372078869031615543238298628511922361054410486212916907158680156418555327562362</span>*img + <span class="hljs-number">195078545071409123139535697181234107195041739039568432194147323773165454434922400709340833348621727077039212579920</span>)<br>Gb = (<span class="hljs-number">356227378788641743509166000768130466712202970744409874232458742609596386253989869973740201630946581452040741428639</span>*img + <span class="hljs-number">558014234250449098056063541268876689941344717355915519165892535333619665322441592696609809029747124612249582373156</span>, <span class="hljs-number">284144268137151820525929014178749815068614681892333440370507567215815474226518660202916471160867182787574588170641</span>*img + <span class="hljs-number">212102089516189626564035487979707055529919235208811222451802967430628679346175546185728324374383815991910663869615</span>)<br>Hb = (<span class="hljs-number">601988875242491627127640698692267933775219799173095669566547148085539575370045236378970737028724933965940811427576</span>*img + <span class="hljs-number">436748337066570764146405402437969684420374112222582333951194222947651522571935238521748503214722377113959956040093</span>, <span class="hljs-number">10753745263084186335835932573522446169706265222930403707093876926454456847704756026904213851136493771042813451783</span>*img + <span class="hljs-number">60129011706640901710199282670283493071879841414421196718045933440982829728050225324274407299746630855119033164322</span>)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜ç»™äº†SIDHçš„å…¬å…±å‚æ•°ï¼Œä½†ç§é’¥æœªçŸ¥ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ±‚å‡ºæœ€ç»ˆèƒ½åŒæ–¹å…±äº«çš„ç§˜å¯†å€¼ã€‚ç›´æ¥ä¸€æŠŠæ¢­äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> public_values_aux<br><span class="hljs-keyword">from</span> public_values_aux <span class="hljs-keyword">import</span> *<br><br>load(<span class="hljs-string">&#x27;castryck_decru_shortcut.sage&#x27;</span>)<br><br>a, b = <span class="hljs-number">191</span>,<span class="hljs-number">118</span><br><br>p = <span class="hljs-number">2</span>^a*<span class="hljs-number">3</span>^b - <span class="hljs-number">1</span> <br><br>public_values_aux.p = p<br>Fp2.&lt;img&gt; = GF(p^<span class="hljs-number">2</span>, modulus=x^<span class="hljs-number">2</span>+<span class="hljs-number">1</span>)<br>R.&lt;x&gt; = PolynomialRing(Fp2)<br><br>E_start = EllipticCurve(Fp2, [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>E_start.set_order((p+<span class="hljs-number">1</span>)^<span class="hljs-number">2</span>, num_checks=<span class="hljs-number">0</span>) <br><br><span class="hljs-comment"># Generation of the endomorphism 2i</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">two_i</span>(<span class="hljs-params">Point</span>):<br>    Ec=Point.curve()<br>    <span class="hljs-keyword">if</span>(Point==Ec(<span class="hljs-number">0</span>)):<br>        <span class="hljs-keyword">return</span> Ec(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">else</span>:<br>        xx,yy=Point[<span class="hljs-number">0</span>],Point[<span class="hljs-number">1</span>]<br>        xx=-xx<br>        yy=Fp2([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])*yy<br>        iPoint=Ec(xx,yy)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>*iPoint<br><br>E0=E_start<br><br>P2 = E0(<span class="hljs-number">232356258387014843308023791594194948039653666270340137835215927250973352859489298612585996169258523678050720878068</span>*img + <span class="hljs-number">538744669524057459396126178584247908817270647700116142476958188100924860869364698166826434756090268295618493824546</span>, <span class="hljs-number">76249308728653875112262060006464245936500586952836731644982931835700736654603945269238982425772488453412959020256</span>*img + <span class="hljs-number">422527598392474246465781364581068979648811682741474158269303182554106577514707994762230052567207331356617986793857</span>)<br>Q2 = E0(<span class="hljs-number">461734419938992457897474506658120518854728597703342582171065611938696479104616816841422560219140242714052457098039</span>*img + <span class="hljs-number">428777625865071874615044976213650933847002825156453497653669798891114414242384057758719743544296087508587555797906</span>, <span class="hljs-number">10662506168648652077262377015475872318520888157151447996364468881456198789398711652111802781610471467541371693871</span>*img + <span class="hljs-number">290637079464465563854589563245667563508278272984878411820236219409522261330414289096025057004409258153467308935585</span>)<br>P3 = E0(<span class="hljs-number">136531171239478416253478572405792254497808491771514926079758453336517795761809532657725981910759601494892554255815</span>*img + <span class="hljs-number">547772446087952417016962537233369245145574866103039586455592266296446663680113698888179763744579786018164571857789</span>, <span class="hljs-number">457116649679592092763069582858437567765320891705891320551968559771374785456259433916225623550934992991299947284413</span>*img + <span class="hljs-number">220741477630185661756935255926737927348327841672351013800906282912811102990934707604736714895606762660312432200585</span>)<br>Q3 = E0(<span class="hljs-number">68285232547217881547351504529947636670204344614106430836226815201213976201473256324305226432972069335362227146188</span>*img + <span class="hljs-number">536563314649157588596255866356195792762142377066728743466380118620513054320726201375156880198801968916974384042962</span>, <span class="hljs-number">363547187548222899213877620074284830292371238932649724761157743295775312969628273623976808527586196308395098178602</span>*img + <span class="hljs-number">272864944055789579262784896184113492423488480672733346446670727958326171151270072235303789238157891259626005445814</span>)<br>check_torsion_points(E_start, a, b, P2, Q2, P3, Q3)<br><br>a4=<span class="hljs-number">325722253892019113276309344646772167140590893668313301180238023235229797514844218553269918097608427893375003138452</span>*img + <span class="hljs-number">364270281373947456485003876763533510032823702499784502493467975510883184423512855706767845689661428270907087419026</span><br>a6=<span class="hljs-number">368957767183452800630213316562881012761387625350286469658089964678523255885821818036490144483399922929140979711679</span>*img + <span class="hljs-number">359419267440966895576472888036339417074452010830491937875437874289887554146948963898485122900228028669459279474529</span><br><br>EB = EllipticCurve(Fp2, [a4, a6])<br>PB = EB(<span class="hljs-number">356227378788641743509166000768130466712202970744409874232458742609596386253989869973740201630946581452040741428639</span>*img + <span class="hljs-number">558014234250449098056063541268876689941344717355915519165892535333619665322441592696609809029747124612249582373156</span>, <span class="hljs-number">284144268137151820525929014178749815068614681892333440370507567215815474226518660202916471160867182787574588170641</span>*img + <span class="hljs-number">212102089516189626564035487979707055529919235208811222451802967430628679346175546185728324374383815991910663869615</span>)<br>QB = EB(<span class="hljs-number">601988875242491627127640698692267933775219799173095669566547148085539575370045236378970737028724933965940811427576</span>*img + <span class="hljs-number">436748337066570764146405402437969684420374112222582333951194222947651522571935238521748503214722377113959956040093</span>, <span class="hljs-number">10753745263084186335835932573522446169706265222930403707093876926454456847704756026904213851136493771042813451783</span>*img + <span class="hljs-number">60129011706640901710199282670283493071879841414421196718045933440982829728050225324274407299746630855119033164322</span>)<br><br>recovered_key = CastryckDecruAttack(E0, P2, Q2, EB, PB, QB, two_i, num_cores=<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(recovered_key)<br><br><span class="hljs-comment">#130137520256908336013846031813998340229884778157326738560</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°ç§é’¥åï¼Œå°±å¾ˆç®€å•äº†ï¼Œèµ°æµç¨‹å°±OK:)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSecret</span>(<span class="hljs-params">Ec,P,Q,x</span>):<br>    Key = P+x*Q<br>    phi =  Ec.isogeny(Key,algorithm=<span class="hljs-string">&quot;factored&quot;</span>)<br>    <span class="hljs-keyword">return</span> phi.codomain().j_invariant()<br>Keyb = getSecret(Ea,Ga,Ha,xb)<br><span class="hljs-comment">#286484023462990024388767738992220658539990531124243560958273105209745510296092203267044512042937339103529646662711*img + 463300547852541792624117140690457946141975681947394080567603424013510602721865680807115515306481798621521396935288</span><br><span class="hljs-comment">#Re(Keyb)=463300547852541792624117140690457946141975681947394080567603424013510602721865680807115515306481798621521396935288</span><br><span class="hljs-comment">#flag&#123;a8e4cc996fde401891f9a125412fdd76&#125;</span><br></code></pre></td></tr></table></figure><h2 id="3-CSIDHé¢„å¤‡çŸ¥è¯†"><a href="#3-CSIDHé¢„å¤‡çŸ¥è¯†" class="headerlink" title="3.CSIDHé¢„å¤‡çŸ¥è¯†"></a>3.CSIDHé¢„å¤‡çŸ¥è¯†</h2><p>å½“ç„¶ï¼ŒCSIDHçš„é¢„å¤‡çŸ¥è¯†è¿˜æ˜¯éœ€è¦çš„:)</p><blockquote><p>REFï¼šCSIDH çš„è®ºæ–‡ <a href="https://eprint.iacr.org/2018/383.pdf">383.pdf (iacr.org)</a></p></blockquote><h3 id="3-1-CISDHåŸºæœ¬æ€æƒ³"><a href="#3-1-CISDHåŸºæœ¬æ€æƒ³" class="headerlink" title="3.1 CISDHåŸºæœ¬æ€æƒ³"></a>3.1 CISDHåŸºæœ¬æ€æƒ³</h3><p>åœ¨SIDHä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ›²çº¿æ˜¯å®šä¹‰åœ¨äºŒæ¬¡æ‰©åŸŸ $\mathbb C_p&#x3D;\mathbb Z_{p}+\mathrm i\mathbb Z_{p}$ ä¸Šçš„è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ï¼Œå…¶ä¸­ $p&#x3D;2^\alpha3^\beta k-1$ï¼Œè¯¥æ›²çº¿æ€»æ˜¯æœ‰ä¸¤ä¸ªç”Ÿæˆå…ƒ $P_0,Q_0$ã€‚å› æ­¤é€šä¿¡åŒæ–¹å¯ä»¥åŸºäº $P_0,Q_0$ï¼Œé€‰æ‹©é˜¶ä¸º $2^\alpha$ å’Œ $3^{\beta}$ çš„åŸºç‚¹ $P_A,Q_A,P_B,Q_B$ å¹¶è¿›è¡Œå¯†é’¥äº¤æ¢è¿‡ç¨‹ã€‚</p><p>è€Œåœ¨CSIDHä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©çš„æ˜¯ä¸€æ¬¡åŸŸ $\mathbb F_p$ ä¸Šçš„è¶…å¥‡å¼‚æ›²çº¿ï¼Œå…¶ä¸­ $p+1$  æ˜¯å¾ˆå¤šå°ç´ æ•° $\ell_1,\ell_2,â€¦,\ell_n$ çš„ä¹˜ç§¯ã€‚è®¾ $E$ ä¸ºæ‰€é€‰å–çš„æ›²çº¿ï¼Œç”±äº $E$ çš„è¶…å¥‡å¼‚æ€§ï¼Œé‚£ä¹ˆ $E$ çš„é˜¶å°±æ˜¯ $p+1$ï¼Œå› æ­¤å¯¹äº $E$ ä¸Šçš„ä»»æ„ç‚¹ $P$ï¼Œå‡å­˜åœ¨ $\ell_1P,\ell_2P,â€¦,\ell_nP$ ï¼Œä½¿å¾— <code>E2=E.isogeny(ell[i]*P)</code> å­˜åœ¨ã€‚</p><p>å¾ˆæ˜¾ç„¶ï¼Œæ—¢ç„¶ $E$ æ˜¯è¶…å¥‡å¼‚çš„ï¼Œé‚£ä¹ˆ $E_2$ ä¹Ÿæ˜¯è¶…å¥‡å¼‚çš„ï¼Œæ‰€ä»¥ $E_2$ çš„é˜¶ä»ç„¶ä¸º $p+1$ï¼Œé‚£ä¹ˆè®¾ $P_2$ æ˜¯ $E_2$ çš„ç”Ÿæˆå…ƒï¼Œé‚£ä¹ˆè¿˜å¯ä»¥ç»§ç»­åš <code>E3=E2.isogeny(ell[i]*P2)</code>ï¼Œä»¥æ­¤ç±»æ¨ã€‚CSIDHå°±æ˜¯è¿™æ ·çš„æ€æƒ³ã€‚</p><h3 id="3-2-åŒæºå›¾-è’™å“¥é©¬åˆ©å‹"><a href="#3-2-åŒæºå›¾-è’™å“¥é©¬åˆ©å‹" class="headerlink" title="3.2 åŒæºå›¾(è’™å“¥é©¬åˆ©å‹)"></a>3.2 åŒæºå›¾(è’™å“¥é©¬åˆ©å‹)</h3><p>å¯¹äºä¸€ä¸ªåŸŸ $K$ å’Œç´ æ•° $\ell$ï¼Œå…¶ä¸­ $\ell$ ä¸æ˜¯ $K$ çš„ç‰¹å¾ï¼ˆ$\mathrm{char} K$ï¼‰çš„å› æ•°ï¼Œé‚£ä¹ˆ $K$ æœ‰ç† $\ell$ åŒæºå›¾ä¸­ï¼Œé¡¶ç‚¹æ‰€æœ‰åœ¨ $K$ ä¸Šå®šä¹‰çš„æ¤­åœ†æ›²çº¿ã€‚å¯¹äºä¸¤ä¸ªæ›²çº¿ $E_1,E_2$ ä¸­çš„æ¯ä¸ª $K$ æœ‰ç† $\ell$ åŒæºï¼Œéƒ½ä¼šæœ‰ä¸€æ¡æœ‰å‘è¾¹ $(E_1,E_2)$ã€‚</p><p><img src="/2025/02/01/ECCNotes4/11.png" alt="11"></p><blockquote><p>Sageç”»å›¾ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">E=EllipticCurve(GF(<span class="hljs-number">71</span>),[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>G=E.isogeny_ell_graph(<span class="hljs-number">3</span>)<br><br>D=&#123;<span class="hljs-string">&#x27;#ff9900&#x27;</span>:[],<span class="hljs-string">&#x27;#00ff66&#x27;</span>:[]&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> G.vertices():<br>    <span class="hljs-keyword">if</span>(i==<span class="hljs-string">&#x27;y^2 = x^3 + x&#x27;</span>):<br>        D[<span class="hljs-string">&#x27;#ff9900&#x27;</span>].append(i)<br>    <span class="hljs-keyword">else</span>:<br>        D[<span class="hljs-string">&#x27;#00ff66&#x27;</span>].append(i)<br>plot(E.isogeny_ell_graph(<span class="hljs-number">3</span>),vertex_labels=<span class="hljs-literal">True</span>,edge_labels=<span class="hljs-literal">True</span>,vertex_size=<span class="hljs-number">5000</span>,edge_thickness=<span class="hljs-number">4</span>,vertex_colors=D)<br></code></pre></td></tr></table></figure></blockquote><p>ä¸Šé¢é‚£å°±æ˜¯ä¸€ä¸ª $\mathbb Z_{71}$ ä¸Šçš„åº¦ä¸º $3$ åŒæºå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºå…¶æ„æˆäº†ä¸€ä¸ªå¾ªç¯ï¼Œ$y^2&#x3D;x^3+47x+45$ å…·æœ‰ä¸¤ä¸ª $3$ åŒæºï¼š $y^2&#x3D;x^3+13x+66$ å’Œ $y^2&#x3D;x^3+48$ï¼ŒSageä¸­ä¹Ÿæä¾›äº†å†…ç½®å‡½æ•°ä¾›æŸ¥è¯¢ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">E=EllipticCurve(GF(<span class="hljs-number">71</span>),[<span class="hljs-number">47</span>,<span class="hljs-number">45</span>])<br>E.isogenies_prime_degree(<span class="hljs-number">3</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">[Isogeny of degree 3 from Elliptic Curve defined by y^2 = x^3 + 47*x + 45 over Finite Field of size 71 to Elliptic Curve defined by y^2 = x^3 + 48 over Finite Field of size 71,</span><br><span class="hljs-string"> Isogeny of degree 3 from Elliptic Curve defined by y^2 = x^3 + 47*x + 45 over Finite Field of size 71 to Elliptic Curve defined by y^2 = x^3 + 59*x + 47 over Finite Field of size 71]</span><br><span class="hljs-string"> &quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¿™ä¸ªå›¾æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿå¾ˆæ˜¾ç„¶ï¼Œæ ¹æ®æˆ‘ä»¬ç°åœ¨å¥¶æ‰€è®²çš„å†…å®¹ï¼Œä¼¼ä¹ä¹Ÿä¸å¤ªå¥½è§£é‡Šã€‚ä½†æˆ‘ä»¬å¯ä»¥å…ˆå›é¡¾æˆ‘ä»¬ä¹‹å‰çš„å·¥ä½œï¼šå¯¹äºä¸€ä¸ªæ¤­åœ†æ›²çº¿è€Œè¨€ï¼Œæˆ‘ä»¬ä¼¼ä¹ä¸åœåœ°åœ¨å…³æ³¨å®ƒçš„ â€j-ä¸å˜é‡â€œ å’Œ â€è’™å“¥é©¬åˆ©æ›²çº¿å½¢å¼â€œï¼ˆé‡ç‚¹æ˜¯ <code>E.montgomery_model().a2()</code> çš„å€¼ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿæ¥å†™ä¸€ä¸ªå®éªŒä»£ç æµ‹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">Para=[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">13</span>,<span class="hljs-number">66</span>],[<span class="hljs-number">47</span>,<span class="hljs-number">45</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">48</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">23</span>],[<span class="hljs-number">47</span>,<span class="hljs-number">26</span>],[<span class="hljs-number">13</span>,<span class="hljs-number">5</span>]]<br>Es=[EllipticCurve(GF(<span class="hljs-number">71</span>),Para[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Es)):<br>    <span class="hljs-built_in">print</span>(Es[i].j_invariant(),Es[i].montgomery_model().a2())<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">24 0</span><br><span class="hljs-string">66 35</span><br><span class="hljs-string">41 58</span><br><span class="hljs-string">0 28</span><br><span class="hljs-string">0 43</span><br><span class="hljs-string">41 13</span><br><span class="hljs-string">66 36</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæˆ‘ä»¬ä» $y^2&#x3D;x^3+x$ æ›²çº¿å¯¹åº”çš„ç‚¹ä¸ºä¸­å¿ƒï¼Œä¼šå‘ç°ç›¸äº’å¯¹ç§°çš„ä¸¤æ¡æ›²çº¿çš„ j-ä¸å˜é‡ç›¸åŒï¼Œä½†è’™å“¥é©¬åˆ©æ›²çº¿å‚æ•°å´ä¸åŒã€‚å¹¶ä¸”ï¼Œå¦‚æœå†æ³¨æ„çœ‹è’™å“¥é©¬åˆ©æ›²çº¿å‚æ•°ï¼Œä¼šå‘ç°ä¸ $y^2&#x3D;x^3+x$ èŠ‚ç‚¹å¯¹ç§°çš„ä¸¤ç‚¹ï¼Œå…¶è’™å“¥é©¬åˆ©æ›²çº¿å‚æ•°äº’ä¸ºç›¸åæ•°ã€‚</p><h3 id="3-3-äºŒæ¬¡æ‰­æ›²"><a href="#3-3-äºŒæ¬¡æ‰­æ›²" class="headerlink" title="3.3 äºŒæ¬¡æ‰­æ›²"></a>3.3 äºŒæ¬¡æ‰­æ›²</h3><p>åœ¨ä»£æ•°å‡ ä½•çš„æ•°å­¦é¢†åŸŸä¸­ï¼Œç‰¹å¾ä¸ä¸º $2$ çš„åŸŸ $K$ ä¸Šçš„æ¤­åœ†æ›²çº¿ $E$ å…·æœ‰ç›¸å…³çš„äºŒæ¬¡æ‰­æ›²ï¼Œå³å¦ä¸€æ¡æ¤­åœ†æ›²çº¿ $E_2$ ä¸ $K$ çš„ä»£æ•°é—­åŒ…ä¸Šçš„ $E$ åŒæ„ã€‚å…·ä½“è€Œè¨€ï¼Œæ¤­åœ†æ›²çº¿ä¹‹é—´çš„åŒæ„æ˜¯ $1$ é˜¶åŒæºï¼Œå³å¯é€†åŒæºã€‚æ›²çº¿åŠå…¶æ‰­æ›²å…·æœ‰ç›¸åŒçš„ j-ä¸å˜é‡ã€‚ï¼ˆREFï¼šç»´åŸºç™¾ç§‘ï¼‰</p><p>è€Œæ‰€è°“äºŒæ¬¡æ‰­æ›²ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ $dâ‰ 0$ï¼Œä¸” $d$ æ˜¯ $p$ çš„éäºŒæ¬¡å‰©ä½™ï¼Œé‚£ä¹ˆæ›²çº¿ $E:y^2&#x3D;x^3+ux^2+ax+b$ çš„äºŒæ¬¡æ‰­æ›²çš„å½¢å¼ä¸º $E^d:dy^2&#x3D;x^3+ux^2+ax+b$ ï¼Œæˆ– $E^d:y^2&#x3D;x^3+dux^2+d^2ax+d^3b$ã€‚å› æ­¤ï¼Œä¸¤æ¡æ›²çº¿ä¸Šçš„æ˜ å°„æ»¡è¶³ï¼š<br>$$<br>\phi:E(x,y)\rightarrow E_2\left(\dfrac{x}{d},\dfrac{y}{d\sqrt d }\right)<br>$$</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä»£ç ï¼ˆ<code>E2.a_invariants()</code> æ˜¾ç¤º <code>[a1,a2,a3,a4,a6]</code> äº”ä¸ªå€¼ï¼Œç”¨äºç®€åŒ–æ¤­åœ†æ›²çº¿çš„æ˜¾ç¤ºï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">Para=[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">13</span>,<span class="hljs-number">66</span>],[<span class="hljs-number">47</span>,<span class="hljs-number">45</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">48</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">23</span>],[<span class="hljs-number">47</span>,<span class="hljs-number">26</span>],[<span class="hljs-number">13</span>,<span class="hljs-number">5</span>]]<br>Es=[EllipticCurve(GF(<span class="hljs-number">71</span>),Para[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>)]<br>E=Es[<span class="hljs-number">2</span>]<br><span class="hljs-built_in">print</span>(E.j_invariant())<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    E2=E.quadratic_twist()<br>    <span class="hljs-built_in">print</span>(E2.a_invariants(),E2.montgomery_model().a2(),E2.j_invariant(),E.is_isomorphic(E2))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">41</span><br><span class="hljs-string">(0, 0, 0, 52, 59) 13 41 False</span><br><span class="hljs-string">(0, 0, 0, 28, 52) 13 41 False</span><br><span class="hljs-string">(0, 0, 0, 21, 22) 13 41 False</span><br><span class="hljs-string">(0, 0, 0, 23, 56) 13 41 False</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-built_in">print</span>(E.change_ring(GF(<span class="hljs-number">71</span>**<span class="hljs-number">2</span>)).is_isomorphic(E2.change_ring(GF(<span class="hljs-number">71</span>**<span class="hljs-number">2</span>))))<br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬åªè¯´äº† $d$ æ˜¯ $p$ çš„äºŒæ¬¡éå‰©ä½™ä¸€ä¸ªæ¡ä»¶ï¼Œå› æ­¤æ¯æ¬¡Sageä¼šéšæœºé€‰å– $d$ï¼Œä½†è¿™äº›æ›²çº¿ä½ çš„è’™å“¥é©¬åˆ©å‚æ•°ç«Ÿç„¶å…¨æ˜¯ $13$ï¼Œè€Œæˆ‘ä»¬æ‰€é€‰å–çš„æ›²çº¿çš„è’™å“¥é©¬åˆ©å‚æ•°æ°å¥½ç›¸åï¼ä¼¼ä¹å°±æ˜¯å›¾ä¸­å…³äº $y^2&#x3D;x^3+x$ èŠ‚ç‚¹çš„å¯¹ç§°ç‚¹ï¼å¹¶ä¸”è¿™ä¸¤æ¡æ›²çº¿çš„j-ä¸å˜é‡ç›¸åŒã€‚ä½†è¿™ä¸¤æ¡æ›²çº¿å´ä¸åŒæ„ï¼Œéš¾é“ç†è®ºå‡ºé—®é¢˜äº†å—ï¼Ÿ</p><p>é‚£ä¸ºå•¥å«äºŒæ¬¡æ‰­æ›²å‘¢ï¼Ÿå› ä¸º $E$ å’Œ $E_2$ åœ¨ $\mathbb F_{p^2}$ ä¸ŠåŒæ„ï¼è¿™åŒæ—¶è¯´æ˜ j-ä¸å˜é‡ åˆ¤å®šåŒæ„çš„æ–¹æ³•ï¼Œåªåœ¨äºŒæ¬¡æ‰©åŸŸä¸­æœ‰ç”¨ï¼</p><p>å¦‚æœå¯¹ä¸€ä¸ªæ›²çº¿ <code>E</code> è®¡ç®—ä¸¤æ¬¡äºŒæ¬¡æ‰­æ›²ä¼šæ€æ ·å‘¢ï¼Œä¸‹é¢çš„ä»£ç å‘Šè¯‰äº†æˆ‘ä»¬ç­”æ¡ˆï¼šæˆ‘ä»¬åˆå›åˆ°äº†åŸæ¥çš„æ›²çº¿ä¸­å»äº†ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">Para=[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">13</span>,<span class="hljs-number">66</span>],[<span class="hljs-number">47</span>,<span class="hljs-number">45</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">48</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">23</span>],[<span class="hljs-number">47</span>,<span class="hljs-number">26</span>],[<span class="hljs-number">13</span>,<span class="hljs-number">5</span>]]<br>Es=[EllipticCurve(GF(<span class="hljs-number">71</span>),Para[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>)]<br>E=Es[<span class="hljs-number">2</span>]<br><span class="hljs-built_in">print</span>(E.j_invariant())<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    E2=E.quadratic_twist().quadratic_twist()<br>    <span class="hljs-built_in">print</span>(E2.a_invariants(),E2.montgomery_model().a2(),E2.j_invariant(),E.is_isomorphic(E2))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">41</span><br><span class="hljs-string">(0, 0, 0, 39, 16) 58 41 True</span><br><span class="hljs-string">(0, 0, 0, 46, 5) 58 41 True</span><br><span class="hljs-string">(0, 0, 0, 11, 27) 58 41 True</span><br><span class="hljs-string">(0, 0, 0, 62, 38) 58 41 True</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h3 id="3-4-mathbb-F-59-å’Œ-mathbb-F-419-ä¸Šçš„è¶…å¥‡å¼‚æ›²çº¿"><a href="#3-4-mathbb-F-59-å’Œ-mathbb-F-419-ä¸Šçš„è¶…å¥‡å¼‚æ›²çº¿" class="headerlink" title="3.4 $\mathbb F_{59}$ å’Œ $\mathbb F_{419}$ ä¸Šçš„è¶…å¥‡å¼‚æ›²çº¿"></a>3.4 $\mathbb F_{59}$ å’Œ $\mathbb F_{419}$ ä¸Šçš„è¶…å¥‡å¼‚æ›²çº¿</h3><p>è®©æˆ‘ä»¬å†å›é¡¾ä¸€ä¸‹æˆ‘ä»¬åˆšæ‰æåˆ°çš„å†…å®¹ï¼šæ—¢ç„¶CSIDHæ˜¯å¤šä¸ªç´ æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»¥ $\ell_1&#x3D;3,\ell_2&#x3D;5$ ä¸ºä¾‹ï¼Œå– $p&#x3D;59$ï¼Œæ¥çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p><p><img src="/2025/02/01/ECCNotes4/12.png" alt="12"></p><blockquote><p>Sageç”»å›¾ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">&gt;E=EllipticCurve(GF(<span class="hljs-number">59</span>),[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>&gt;G3=E.isogeny_ell_graph(<span class="hljs-number">3</span>)<br>&gt;G5=E.isogeny_ell_graph(<span class="hljs-number">5</span>)<br>&gt;D=&#123;<span class="hljs-string">&#x27;#ff9900&#x27;</span>:[],<span class="hljs-string">&#x27;#00ff66&#x27;</span>:[]&#125;<br>&gt;<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> G3.vertices():<br><span class="hljs-keyword">if</span>(i==<span class="hljs-string">&#x27;y^2 = x^3 + x&#x27;</span>):<br>    D[<span class="hljs-string">&#x27;#ff9900&#x27;</span>].append(i)<br><span class="hljs-keyword">else</span>:<br>    D[<span class="hljs-string">&#x27;#00ff66&#x27;</span>].append(i)<br>&gt;S3=plot(G3,title=<span class="hljs-string">r&#x27;3-isogeny fig on F59&#x27;</span>,vertex_labels=<span class="hljs-literal">True</span>,edge_labels=<span class="hljs-literal">True</span>,vertex_size=<span class="hljs-number">5000</span>,edge_thickness=<span class="hljs-number">4</span>,vertex_colors=D)<br>&gt;D=&#123;<span class="hljs-string">&#x27;#ff9900&#x27;</span>:[],<span class="hljs-string">&#x27;#00ff66&#x27;</span>:[]&#125;<br>&gt;<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> G5.vertices():<br><span class="hljs-keyword">if</span>(i==<span class="hljs-string">&#x27;y^2 = x^3 + x&#x27;</span>):<br>    D[<span class="hljs-string">&#x27;#ff9900&#x27;</span>].append(i)<br><span class="hljs-keyword">else</span>:<br>    D[<span class="hljs-string">&#x27;#00ff66&#x27;</span>].append(i)<br>&gt;S5=plot(G5,title=<span class="hljs-string">r&#x27;5-isogeny fig on F59&#x27;</span>,vertex_labels=<span class="hljs-literal">True</span>,edge_labels=<span class="hljs-literal">True</span>,vertex_size=<span class="hljs-number">5000</span>,edge_thickness=<span class="hljs-number">4</span>,vertex_colors=D)<br>&gt;S=graphics_array([S3,S5])<br>&gt;S.show(figsize=[<span class="hljs-number">12</span>,<span class="hljs-number">12</span>])<br></code></pre></td></tr></table></figure></blockquote><p>æˆ‘ä»¬éšåæ¥è®¡ç®—ä¸€ä¸‹ä¸Šé¢æ‰€æœ‰æ›²çº¿çš„è’™å“¥é©¬åˆ©å‚æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">59</span><br>E3s=[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">37</span>,<span class="hljs-number">42</span>],[<span class="hljs-number">25</span>,<span class="hljs-number">45</span>],[<span class="hljs-number">16</span>,<span class="hljs-number">55</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">57</span>],[<span class="hljs-number">16</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">25</span>,<span class="hljs-number">14</span>],[<span class="hljs-number">37</span>,<span class="hljs-number">17</span>]]<br>E5s=[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">30</span>],[<span class="hljs-number">39</span>,<span class="hljs-number">9</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">30</span>],[<span class="hljs-number">49</span>,<span class="hljs-number">37</span>],[<span class="hljs-number">49</span>,<span class="hljs-number">22</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">29</span>],[<span class="hljs-number">39</span>,<span class="hljs-number">50</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">29</span>]]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(E3s)):<br>    E3s[i]=EllipticCurve(GF(p),E3s[i])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(E5s)):<br>    E5s[i]=EllipticCurve(GF(p),E5s[i])<br>seq3,seq5=[],[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(E3s)):<br>    seq3.append(E3s[i].montgomery_model().a2())<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(E5s)):<br>    seq5.append(E5s[i].montgomery_model().a2())<br><span class="hljs-built_in">print</span>(seq3)<br><span class="hljs-built_in">print</span>(seq5)<br><span class="hljs-comment">#[0, 30, 28, 6, 48, 11, 53, 31, 29]</span><br><span class="hljs-comment">#[0, 48, 29, 6, 31, 28, 53, 30, 11]</span><br></code></pre></td></tr></table></figure><p>ä½ ä¼šå‘ç°ï¼Œä¸Šä¸‹ä¸¤æ’è¾“å‡ºçš„å†…å®¹ä¼¼ä¹æ˜¯ç›¸åŒçš„ï¼Œåªä¸è¿‡é¡ºåºä¸åŒï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä»èŠ‚ç‚¹ 0 å¼€å§‹å¼•çº¿ï¼Œçº¢çº¿æ˜¯ 3-åŒæºçš„é¡ºåºï¼Œè“çº¿æ˜¯ 5-åŒæºçš„é¡ºåºã€‚</p><p><img src="/2025/02/01/ECCNotes4/13.png" alt="13"></p><blockquote><p>æ³¨1ï¼šå‡ ä¹æ‰€æœ‰æƒ…å†µä¸‹ï¼ŒåŒæºå›¾æ˜¯åŒå‘æœ‰å‘å›¾ï¼Œä¹Ÿå°±æ˜¯ $0$ åˆ° $29$ æœ‰ä¸€æ¡è¾¹ï¼Œé‚£ä¹ˆ $29$ åˆ° $0$ ä¹Ÿæœ‰ä¸€æ¡è¾¹ï¼Œè¿™é‡Œæˆ‘ä»¬ç”»æˆå•é¡¹å˜ï¼Œæ˜¯ä¸ºåé¢è§„å®š æ­£æ–¹å‘ç”¨çš„ï¼Œç®­å¤´æ–¹å‘ä¸ºåŒæºè®¡ç®—çš„æ­£æ–¹å‘ï¼Œé€†ç€ç®­å¤´èµ°ä¸ºè´Ÿæ–¹å‘ã€‚</p><p>æ³¨2ï¼šä¸Šä¸€æ¡ä¹Ÿæœ‰2ç§ä¸æˆç«‹çš„æƒ…å†µï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ$0$ çš„å‡ºè¾¹å¤šäºå…¥è¾¹ã€‚è¿™2ç§æƒ…å†µä¸ºï¼šè®¾æ›²çº¿ $E$ åœ¨åŸŸ $K$ ä¸Šå®šä¹‰ï¼Œæ­¤æ—¶ </p><ol><li>$E$ çš„ j-ä¸å˜é‡ä¸º $0$ ä¸” $\sqrt{-3}\in K$ã€‚</li><li>$E$ çš„ j-ä¸å˜é‡ä¸º $1728$ ä¸” $\sqrt{-1} \in K$ã€‚</li></ol><p>å› æ­¤ï¼Œåœ¨è¿™ç§é™åˆ¶ä¸‹ï¼Œæ¨¡æ•°é€‰å–éœ€è¦æ»¡è¶³è¦æ±‚ï¼š$p\equiv 11\pmod{12}$ã€‚</p><p>Sage ç”»å›¾ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">59</span><br>E0=EllipticCurve(GF(p),[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">E,x</span>):<br> m = <span class="hljs-number">0</span><br> res=[E.montgomery_model().a2()]<br> <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>     G = choice(E(<span class="hljs-number">0</span>).division_points(x)[<span class="hljs-number">1</span>:])<br>     E = E.isogeny(G).codomain()<br>     <span class="hljs-keyword">if</span>(E.montgomery_model().a2()==res[<span class="hljs-number">0</span>]):<br>         <span class="hljs-keyword">return</span> res<br>     <span class="hljs-keyword">else</span>:<br>         res.append(E.montgomery_model().a2())<br>seq3=get(E0,<span class="hljs-number">3</span>)<br>seq5=get(E0,<span class="hljs-number">5</span>)<br>Gr = DiGraph(&#123;&#125;, loops=<span class="hljs-literal">True</span>, multiedges=<span class="hljs-literal">True</span>, sparse=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(seq3)):<br>    Gr.add_edges([(seq3[i],seq3[(i+<span class="hljs-number">1</span>)%<span class="hljs-built_in">len</span>(seq3)],<span class="hljs-string">&#x27;3&#x27;</span>)])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(seq5)):<br>    Gr.add_edges([(seq5[i],seq5[(i+<span class="hljs-number">1</span>)%<span class="hljs-built_in">len</span>(seq5)],<span class="hljs-string">&#x27;5&#x27;</span>)])<br>Col=&#123;<span class="hljs-string">&#x27;#ff9900&#x27;</span>:[<span class="hljs-number">0</span>],<span class="hljs-string">&#x27;#00ff66&#x27;</span>:seq3[<span class="hljs-number">1</span>:]&#125;<br>Dpos=&#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(seq3)):<br>    x = <span class="hljs-built_in">float</span>(cos(pi/<span class="hljs-number">2</span> + ((<span class="hljs-number">2</span>*pi)/<span class="hljs-built_in">len</span>(seq3))*i))<br>    y = <span class="hljs-built_in">float</span>(sin(pi/<span class="hljs-number">2</span> + ((<span class="hljs-number">2</span>*pi)/<span class="hljs-built_in">len</span>(seq3))*i))<br>    Dpos[seq3[i]]=(x,y)<br>Gr.graphplot(edge_labels=<span class="hljs-literal">False</span>,color_by_label=<span class="hljs-literal">True</span>,vertex_size=<span class="hljs-number">500</span>,vertex_colors=Col,pos=Dpos).plot()<br></code></pre></td></tr></table></figure></blockquote><p>ç„¶åä¹Ÿæœ‰ä¸€ä¸ª $419$ çš„ å›¾ä¹Ÿå¯ä»¥å‚è€ƒä¸€ä¸‹ï¼Œçº¢è‰²çš„çº¿ä¸º $3$-åŒæºï¼Œè“è‰²çš„çº¿ä¸º $5$-åŒæºï¼Œç»¿è‰²çš„çº¿ä¸º $7$-åŒæºã€‚å¯ä»¥å‘ç°ï¼Œ$3$-åŒæºå’Œ $7$-åŒæºçš„é˜¶å‡ä¸º $27$ï¼Œè€Œ $5$-åŒæºçš„é˜¶ä¸º $9$ã€‚</p><p><img src="/2025/02/01/ECCNotes4/14.png" alt="14"></p><blockquote><p>Sage ç”»å›¾ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">419</span><br>E0=EllipticCurve(GF(p),[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">E,x</span>):<br>    m = <span class="hljs-number">0</span><br>    res=[E.montgomery_model().a2()]<br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>        G = choice(E(<span class="hljs-number">0</span>).division_points(x)[<span class="hljs-number">1</span>:])<br>        E = E.isogeny(G).codomain()<br>        <span class="hljs-keyword">if</span>(E.montgomery_model().a2()==res[<span class="hljs-number">0</span>]):<br>            <span class="hljs-keyword">return</span> res<br>        <span class="hljs-keyword">else</span>:<br>            res.append(E.montgomery_model().a2())<br>seq3=get(E0,<span class="hljs-number">3</span>)<br>seq5=get(E0,<span class="hljs-number">5</span>)<br>seq52=get(EllipticCurve(GF(p),[<span class="hljs-number">0</span>,<span class="hljs-number">158</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>]),<span class="hljs-number">5</span>)<br>seq53=get(EllipticCurve(GF(p),[<span class="hljs-number">0</span>,<span class="hljs-number">261</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>]),<span class="hljs-number">5</span>)<br><br>seq7=get(E0,<span class="hljs-number">7</span>)<br>Gr = DiGraph(&#123;&#125;, loops=<span class="hljs-literal">True</span>, multiedges=<span class="hljs-literal">True</span>, sparse=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(seq3)):<br>       Gr.add_edges([(seq3[i],seq3[(i+<span class="hljs-number">1</span>)%<span class="hljs-built_in">len</span>(seq3)],<span class="hljs-string">&#x27;3&#x27;</span>)])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(seq5)):<br>       Gr.add_edges([(seq5[i],seq5[(i+<span class="hljs-number">1</span>)%<span class="hljs-built_in">len</span>(seq5)],<span class="hljs-string">&#x27;5&#x27;</span>)])<br>       Gr.add_edges([(seq52[i],seq52[(i+<span class="hljs-number">1</span>)%<span class="hljs-built_in">len</span>(seq52)],<span class="hljs-string">&#x27;5&#x27;</span>)])<br>       Gr.add_edges([(seq53[i],seq53[(i+<span class="hljs-number">1</span>)%<span class="hljs-built_in">len</span>(seq53)],<span class="hljs-string">&#x27;5&#x27;</span>)])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(seq7)):<br>       Gr.add_edges([(seq7[i],seq7[(i+<span class="hljs-number">1</span>)%<span class="hljs-built_in">len</span>(seq7)],<span class="hljs-string">&#x27;7&#x27;</span>)])<br>Col=&#123;<span class="hljs-string">&#x27;#ff9900&#x27;</span>:[<span class="hljs-number">0</span>],<span class="hljs-string">&#x27;#00ff66&#x27;</span>:seq3[<span class="hljs-number">1</span>:]&#125;<br>Dpos=&#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(seq3)):<br>       x = <span class="hljs-built_in">float</span>(cos(pi/<span class="hljs-number">2</span> + ((<span class="hljs-number">2</span>*pi)/<span class="hljs-built_in">len</span>(seq3))*i))<br>       y = <span class="hljs-built_in">float</span>(sin(pi/<span class="hljs-number">2</span> + ((<span class="hljs-number">2</span>*pi)/<span class="hljs-built_in">len</span>(seq3))*i))<br>       Dpos[seq3[i]]=(x,y)<br>Gr.graphplot(edge_labels=<span class="hljs-literal">False</span>,color_by_label=<span class="hljs-literal">True</span>,vertex_size=<span class="hljs-number">500</span>,vertex_colors=Col,pos=Dpos).plot()<br></code></pre></td></tr></table></figure></blockquote><p>å¦‚æœæˆ‘ä»¬è§„å®šä¸Šå›¾ä» $0$ å¼•å‡ºçš„çº¿ä¸­ï¼Œç®­å¤´æ–¹å‘ä¸ºæ­£æ–¹å‘çš„è¯ï¼Œé‚£ä¹ˆå¯†é’¥åŒæ–¹å¯ä»¥äº’ç›¸çº¦å®šèµ°æ³•ï¼Œæ˜¯æ­£ç€èµ°è¿˜æ˜¯åç€èµ°ï¼Œé‚£ä¹ˆåªéœ€è¦åŒæ–¹çº¦å®šå¥½è¿™ä¸ªå‚æ•°ï¼ŒåŒæ–¹èµ°çš„å†…å®¹ä¸€æ ·ï¼Œé‚£ä¸å°±èƒ½å¤Ÿå¾—åˆ°ç›¸åŒçš„å€¼äº†å—ã€‚</p><h3 id="3-9-æ€»ç»“ä¸å›é¡¾"><a href="#3-9-æ€»ç»“ä¸å›é¡¾" class="headerlink" title="3.9 æ€»ç»“ä¸å›é¡¾"></a>3.9 æ€»ç»“ä¸å›é¡¾</h3><h4 id="3-9-1-æ±‚-p-åŒæºçš„è’™å“¥é©¬åˆ©å‚æ•°"><a href="#3-9-1-æ±‚-p-åŒæºçš„è’™å“¥é©¬åˆ©å‚æ•°" class="headerlink" title="3.9.1 æ±‚ $p$ åŒæºçš„è’™å“¥é©¬åˆ©å‚æ•°"></a>3.9.1 æ±‚ $p$ åŒæºçš„è’™å“¥é©¬åˆ©å‚æ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">E=EllipticCurve(GF(<span class="hljs-number">419</span>),[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>])<br>G=(E(<span class="hljs-number">0</span>).division_points(<span class="hljs-number">7</span>))[<span class="hljs-number">2</span>]<br>phi=E.isogeny(G)<br>phi.codomain().montgomery_model().a2()<br></code></pre></td></tr></table></figure><h4 id="3-9-2-æ±‚-p-åŒæºçš„é˜¶"><a href="#3-9-2-æ±‚-p-åŒæºçš„é˜¶" class="headerlink" title="3.9.2 æ±‚ $p$ åŒæºçš„é˜¶"></a>3.9.2 æ±‚ $p$ åŒæºçš„é˜¶</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <span class="hljs-number">419</span><br>E = EllipticCurve(GF(p), [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>])<br>j = E.j_invariant()<br>m = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    G = choice(E(<span class="hljs-number">0</span>).division_points(<span class="hljs-number">3</span>)[<span class="hljs-number">1</span>:])<br>    E = E.isogeny(G).codomain()<br>    m += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> E.j_invariant() == j:<br>        <span class="hljs-built_in">print</span>(m)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><h4 id="3-9-3-æ±‚ä¸åŒ-p-åŒæºå¤åˆçš„ç»“æœ"><a href="#3-9-3-æ±‚ä¸åŒ-p-åŒæºå¤åˆçš„ç»“æœ" class="headerlink" title="3.9.3 æ±‚ä¸åŒ $p$ åŒæºå¤åˆçš„ç»“æœ"></a>3.9.3 æ±‚ä¸åŒ $p$ åŒæºå¤åˆçš„ç»“æœ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <span class="hljs-number">419</span><br>E = EllipticCurve(GF(p), [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>])<br>ells = [<span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>]<br>key = [<span class="hljs-number">3</span>, -<span class="hljs-number">4</span>, <span class="hljs-number">4</span>]<br><span class="hljs-keyword">for</span> ell,k <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ells,key):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>        G = choice(E(<span class="hljs-number">0</span>).division_points(ell)[<span class="hljs-number">1</span>:])<br>        E = E.isogeny_codomain(G)<br>E.montgomery_model().a2()<br></code></pre></td></tr></table></figure><h4 id="3-9-4-ç»™å®šæ›²çº¿äºŒæ¬¡æ‰­æ›²çš„æ±‚æ³•"><a href="#3-9-4-ç»™å®šæ›²çº¿äºŒæ¬¡æ‰­æ›²çš„æ±‚æ³•" class="headerlink" title="3.9.4 ç»™å®šæ›²çº¿äºŒæ¬¡æ‰­æ›²çš„æ±‚æ³•"></a>3.9.4 ç»™å®šæ›²çº¿äºŒæ¬¡æ‰­æ›²çš„æ±‚æ³•</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <span class="hljs-number">419</span><br>E = EllipticCurve(GF(p), [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>])<br>G = choice(E(<span class="hljs-number">0</span>).division_points(<span class="hljs-number">3</span>)[<span class="hljs-number">1</span>:])<br>E = E.isogeny_codomain(G)<br>E = E.quadratic_twist()<br>E.montgomery_model().a2()<br></code></pre></td></tr></table></figure><h2 id="4-CSIDHç®—æ³•"><a href="#4-CSIDHç®—æ³•" class="headerlink" title="4.CSIDHç®—æ³•"></a>4.CSIDHç®—æ³•</h2><h3 id="4-1-æ–¹æ¡ˆç®€ä»‹"><a href="#4-1-æ–¹æ¡ˆç®€ä»‹" class="headerlink" title="4.1 æ–¹æ¡ˆç®€ä»‹"></a>4.1 æ–¹æ¡ˆç®€ä»‹</h3><h4 id="4-1-1-Setup"><a href="#4-1-1-Setup" class="headerlink" title="4.1.1 Setup"></a>4.1.1 Setup</h4><p>é€‰æ‹©ç´ æ•° $p\equiv 3\pmod 8$ï¼Œå®é™…ä¸Šå¤šä½¿ç”¨ $p&#x3D;4(\prod_{i&#x3D;1}^n\ell_i)-1$ï¼Œå…¶ä¸­ $\ell_i$ æ˜¯ä¸åŒçš„å°ç´ æ•°ï¼Œä»¥åŠåœ¨ $\mathbb F_p$ ä¸Šæ‹¥æœ‰è‡ªåŒæ€ $O[\sqrt {-p}]$ ä¸Šçš„è¶…å¥‡å¼‚æ¤­åœ†æ›²çº¿ $E:y^2&#x3D;x^3+x$ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹© $p&#x3D;419$ï¼Œå…¶ä¸­ $\ell&#x3D;3,5,7$ï¼Œ$n&#x3D;3$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">ells=[<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>]<br>p=<span class="hljs-number">4</span>*prod(ells)-<span class="hljs-number">1</span><br>F = GF(p)<br>E0 = EllipticCurve(F, [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure><h4 id="4-1-2-KeyGen-KeyExchange"><a href="#4-1-2-KeyGen-KeyExchange" class="headerlink" title="4.1.2 KeyGen + KeyExchange"></a>4.1.2 KeyGen + KeyExchange</h4><p> é€šä¿¡åŒæ–¹Aliceå’ŒBobåˆ†åˆ«ç”Ÿæˆä¸€ä¸ª $n$ å…ƒç»„ $(e_1,e_2,â€¦,e_n)$ ä½œä¸ºç§é’¥ï¼Œå…¶ä¸­ $e_i\in[-m,m]\cap \mathbb Z$ã€‚æˆ‘ä»¬å‡è®¾ $m&#x3D;5$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">ska=[<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,-<span class="hljs-number">1</span>]<br>skb=[<span class="hljs-number">0</span>,-<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><p>éšåï¼ŒAliceæŒ‰ç…§ <code>ska</code> çš„å†…å®¹å¼€å§‹èµ°çº¿ï¼ŒBob æŒ‰ç…§ <code>skb</code> çš„å†…å®¹å¼€å§‹èµ°çº¿ï¼Œæœ€ç»ˆåŒæ–¹ä¼šå¾—åˆ°ä¸¤æ¡æ›²çº¿ $E_A$ å’Œ $E_B$ï¼ŒAliceå’ŒBobåˆ†åˆ«è®°å½• $E_A$ çš„è’™å“¥é©¬åˆ©å‚æ•° $A$ å’Œ $E_B$ çš„è’™å“¥é©¬åˆ©å‚æ•° $B$ï¼Œå¹¶å‘é€ç»™å¯¹æ–¹ã€‚</p><p>åœ¨æ”¶åˆ°å¯¹æ–¹çš„ä¿¡æ¯åï¼ŒAlice ä»¥ $y^2&#x3D;x^3+Bx^2+x$ ä¸ºèµ·ç‚¹ï¼ŒBob ä»¥ $y^2&#x3D;x^3+Ax^2+x$ ä¸ºèµ·ç‚¹ï¼Œç»§ç»­æŒ‰ç…§è‡ªå·±çš„å‚æ•°èµ°çº¿ï¼Œæœ€åå¾—åˆ°çš„æ›²çº¿çš„è’™å“¥é©¬åˆ©å‚æ•°å°±æ˜¯åŒæ–¹å…±äº«çš„å¯†é’¥äº†ï¼</p><p>åœ¨å®é™…ä¸­ï¼Œå¸¸å¸¸é€‰å– $n&#x3D;74$ï¼Œ $p&#x3D;4(\prod_{i&#x3D;1}^{74}\ell_i)-1$ï¼Œå…¶ä¸­ $\ell_1\sim\ell_{73}$ ä¸ºæœ€å°çš„ $73$ ä¸ªå¥‡ç´ æ•°ï¼Œ$\ell_{74}&#x3D;587$ã€‚æ­¤æ—¶ $p$ ä¸º $512$ ä½ç´ æ•°ï¼Œå› æ­¤å…¬é’¥çš„å¤§å°ä¸º $64$ å­—èŠ‚ã€‚è€Œç§é’¥å¤§å°ä¸€èˆ¬ä¸º $37$ å­—èŠ‚ï¼Œè¯´æ˜ $m$ çš„å€¼ä¸€èˆ¬ä¸è¶…è¿‡  $Â±7$ï¼Œè¿™æ ·æ‰èƒ½åœ¨ $37$ å­—èŠ‚ä¸­å¡å…¥ $74$ ä¸ªæ•°å­—ã€‚</p><p>CSIDHçš„ä»£ç å…¶å®éå¸¸ç®€å•ï¼Œä½†ç†è§£èµ·æ¥æŒºéš¾çš„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">csidh</span>(<span class="hljs-params">A, priv</span>):<br>    E = EllipticCurve(F, [<span class="hljs-number">0</span>, A, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">for</span> sgn <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>]:<br>        <span class="hljs-keyword">for</span> e, ell <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(priv, ells):<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(sgn * e):<br>                <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> (P := (p + <span class="hljs-number">1</span>) // ell * E.random_element()):<br>                    <span class="hljs-keyword">pass</span><br>                E = E.isogeny_codomain(P)<br>        E = E.quadratic_twist()<br>    <span class="hljs-keyword">return</span> E.montgomery_model().a2()<br>A = csidh(<span class="hljs-number">0</span>,ska)<br>B = csidh(<span class="hljs-number">0</span>,skb)<br>key1=csidh(B,ska)<br>key2=csidh(A,skb)<br><span class="hljs-built_in">print</span>(key1,key2)<br><span class="hljs-comment">#124 124</span><br></code></pre></td></tr></table></figure><p>æ”¾ä¸ªè®ºæ–‡ä¸­å¯¹è¿™éƒ¨åˆ†çš„ä¸¥è°¨è¯´æ³•<br><img src="/2025/02/01/ECCNotes4/15.png" alt="15"></p><h3 id="4-2-CSIDHçš„å®‰å…¨æ€§"><a href="#4-2-CSIDHçš„å®‰å…¨æ€§" class="headerlink" title="4.2 CSIDHçš„å®‰å…¨æ€§"></a>4.2 CSIDHçš„å®‰å…¨æ€§</h3><p>CSIDHæ˜¯å¯è¯æ˜é‡å­å®‰å…¨çš„ï¼Œåœ¨ä»…çŸ¥é“ $A,B$ ä¸¤ä¸ªè’™å“¥é©¬åˆ©å‚æ•°çš„æƒ…å†µä¸‹ï¼Œæƒ³è¦æ±‚å‡ºæœ€ç»ˆçš„ç§˜å¯†å€¼æ˜¯ä¸å¯è¡Œçš„ã€‚å…¶å®å¯ä»¥çœ‹ä¸€ä¸‹ $p&#x3D;419$ çš„é‚£å¼ å›¾ï¼Œç§˜å¯†å€¼ç›¸å·®ä¸€ç‚¹ï¼Œæœ€åç»“æœå…¶å®å¯ä»¥ç›¸å·®éå¸¸å¤§ï¼Œå¹¶ä¸”ç¡®å®å¯ä»¥åœ¨ $m$ å¾ˆå°çš„æƒ…å†µä¸‹ï¼Œéå†å®Œæ‰€æœ‰å¯èƒ½çš„å–å€¼ã€‚å› æ­¤è™½ç„¶SIDHè¢«æ”»ç ´äº†ï¼Œä½†CSIDHç›®å‰å°šæœªæœ‰æœ‰æ•ˆçš„æ”»å‡»æ–¹æ³•ï¼ˆå‘ƒï¼Œå¦‚æœè¿™ä¸ªè¢«æ”»ç ´ï¼ŒåŒæºæ˜¯ä¸æ˜¯å°±ç©ä¸èµ·æ¥äº†ï¼‰ã€‚</p><h3 id="4-3-CSIDH-ä¾‹é¢˜é€‰è®²"><a href="#4-3-CSIDH-ä¾‹é¢˜é€‰è®²" class="headerlink" title="4.3 CSIDH ä¾‹é¢˜é€‰è®²"></a>4.3 CSIDH ä¾‹é¢˜é€‰è®²</h3><h4 id="4-3-1-SU-Auth"><a href="#4-3-1-SU-Auth" class="headerlink" title="4.3.1 SU_Auth"></a>4.3.1 SU_Auth</h4><p>ä¹‹å‰SUCTFå‡ºäº†ä¸€ä¸ªSU_Authï¼Œä¹Ÿæ˜¯åŸºäºCSIDHçš„ï¼Œæ¥çœ‹ä¸€ä¸‹ï¼ˆä½¿ç”¨æœ¬åœ°å¤ç°ä»£ç ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> ast <span class="hljs-keyword">import</span> literal_eval<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">import</span> subprocess<br><br>ells = [*primes(<span class="hljs-number">3</span>, <span class="hljs-number">200</span>), <span class="hljs-number">269</span>]<br>p = <span class="hljs-number">4</span>*prod(ells) - <span class="hljs-number">1</span><br>F = GF(p)<br><br>SUKEY = [randint(-<span class="hljs-number">3</span>, <span class="hljs-number">3</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ells))]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">SuAuth</span>(<span class="hljs-params">A, priv, LIMIT=<span class="hljs-literal">True</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">any</span>(priv[i] == SUKEY[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ells))) <span class="hljs-keyword">and</span> LIMIT: <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ğŸ™…SUKEY&quot;</span><br>    E = EllipticCurve(F, [<span class="hljs-number">0</span>, A, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">for</span> sgn <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>]:<br>        <span class="hljs-keyword">for</span> e, ell <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(priv, ells):<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(sgn * e):<br>                <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> (P := (p + <span class="hljs-number">1</span>) // ell * E.random_element()) <span class="hljs-keyword">or</span> P.order() != ell:<br>                    <span class="hljs-keyword">pass</span><br>                E = E.isogeny_codomain(P)<br>        E = E.quadratic_twist()<br>    <span class="hljs-keyword">return</span> E.montgomery_model().a2()<br><br>cipher = <span class="hljs-keyword">lambda</span> key: AES.new(md5(key.encode()).digest(),AES.MODE_ECB)<br>SUDOOR = cipher(<span class="hljs-built_in">str</span>(SuAuth(<span class="hljs-number">0</span>, SUKEY, <span class="hljs-number">0</span>))).encrypt(<span class="hljs-string">b&quot;./OPEN_THE_FLAG!&quot;</span>)<br><span class="hljs-comment">#P.S. è¿™ä¸ªæœ¬åœ°å¤ç°æ—¶ï¼Œè¦å†™ä¸€ä¸ªprintf(&quot;flag&#123;XXX&#125;&quot;)çš„ç¨‹åºå¹¶ç¼–è¯‘ï¼Œ ç¨‹åºå‘½åä¸ºOPEN_THE_FLAG!</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ˜œ&quot;</span>, SuAuth(<span class="hljs-number">0</span>, SUKEY, <span class="hljs-number">0</span>))<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    AKey = SuAuth(<span class="hljs-number">0</span>, literal_eval(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;ğŸ”‘: &quot;</span>)))<br>    <span class="hljs-keyword">try</span>: subprocess.run(cipher(<span class="hljs-built_in">str</span>(AKey)).decrypt(SUDOOR))<br>    <span class="hljs-keyword">except</span>: <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æœ¬åœ°æµ‹ä¸€ä¸‹ï¼Œä¼šå‘ç°è¿ä¸Šå»ä¹‹åï¼Œè·‘å¾—éå¸¸æ…¢ï¼Œ10ç§’æ‰ç»™å‡ºflagçš„åŠ å¯†å€¼ã€‚</p><p>å¯ä»¥çœ‹åˆ°SUAuthä¸­çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå¦‚æœç»™å‡ºçš„KEYå’ŒSUKEYä¸­çš„ä»»ä½•ä¸€ä¸ªåˆ†é‡ç›¸å¯¹åº”ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¼šç›´æ¥è¿”å›ï¼Œä¸ä¼šæ‰§è¡Œåé¢çš„å†…å®¹ã€‚å¹¶ä¸”ç¨‹åºè¯­è¨€æ‰§è¡Œæ—¶ï¼Œä¸€å®šæ˜¯å­˜åœ¨é€»è¾‘çŸ­è·¯çš„ï¼Œ<code>any</code> å°±ç›¸å½“äºæœ‰ä¸€ä¸ªæˆç«‹ä¹…ä¼šè¿”å›ã€‚è€ƒè™‘åˆ°ä»è¿ä¸Šåˆ°æ”¶åˆ°flagçš„å¯†æ–‡ç”¨äº†10ç§’ï¼Œåˆ¨å»å‚æ•°åˆå§‹åŒ–å’Œè¿æ¥è€—æ—¶ï¼Œè¯´æ˜æ‰§è¡ŒSUAuthå‡½æ•°è‡³å°‘éœ€è¦ $3$ ç§’ä»¥ä¸Š ï¼Œå› æ­¤åº”è¯¥å¯ä»¥é€šè¿‡æ—¶é—´å»åˆ¤æ–­æ¡ä»¶æˆç«‹ã€‚</p><p>ç”±äº SUKEY æ¯ä¸ªåˆ†é‡çš„å€¼æ˜¯ $-3$ åˆ° $3$ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå‘é€ä¸€ä¸ªå…¨ $2$ çš„Keyï¼Œæœ¬åœ° 2ms å°±æ”¶åˆ°äº†è¿”å›ç»“æœï¼Œè€Œå‘é€ä¸€ä¸ªå…¨ $4$ çš„Keyï¼Œæœ¬åœ° 5193ms æ‰ç»™å‡ºç»“æœï¼Œå¯è§è¿™ä¸ªçš„æ—¶é—´å·®è·æ˜¾è‘—ï¼Œå¯ä»¥å¯¹SUKeyè¿›è¡Œæµ‹ä¿¡é“æ”»å‡»çˆ†ç ´ã€‚</p><blockquote><p>P.S. å¦‚æœè€ƒè™‘è¿œç¨‹äº¤äº’è¿‡ç¨‹ï¼Œå¦‚æœä¸¤ä¸ªæ‰§è¡Œæ—¶é—´é•¿åº¦è¶…è¿‡ 1 ç§’ï¼Œé‚£å¤§æ¦‚ç‡æ˜¯å¯ä»¥æµ‹ä¿¡é“æ”»å‡»çš„ã€‚ä½†æ®è¯´ä¹‹å‰å¼ºç½‘æ¯é‚£ä¸ªå¤šé¡¹å¼é¢˜ä¸å¤ªè¡Œï¼Œå› ä¸ºæ—¶é—´ç›¸å·®å¤ªçŸ­äº†ï¼Œè™½ç„¶æœ¬åœ°è·‘æ˜¯6mså’Œ50msï¼Œä½†ç”±äºç½‘ç»œå»¶è¿Ÿçš„å­˜åœ¨ï¼Œè¿™ä¸ªå‡ åæ¯«ç§’è¿˜æ˜¯å¯ä»¥å¿½ç•¥çš„</p></blockquote><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span> <span class="hljs-comment">#=&#x27;debug&#x27;</span><br>ells = [*primes(<span class="hljs-number">3</span>, <span class="hljs-number">200</span>), <span class="hljs-number">269</span>]<br>p = <span class="hljs-number">4</span>*prod(ells) - <span class="hljs-number">1</span><br>F = GF(p)<br>n=<span class="hljs-built_in">len</span>(ells)<br>sh=process([<span class="hljs-string">&#x27;sage&#x27;</span>,<span class="hljs-string">&#x27;task11.sage&#x27;</span>])<br><br>ts=datetime.now()<br>C=<span class="hljs-built_in">int</span>(sh.recvline()[<span class="hljs-number">4</span>:].strip())<br><span class="hljs-built_in">print</span>(datetime.now()-ts)<br><span class="hljs-built_in">print</span>(C)<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>ts=datetime.now()<br>sh.sendline(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;[<span class="hljs-number">2</span>]*n&#125;</span>&#x27;</span>.encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br><span class="hljs-built_in">print</span>(datetime.now()-ts)<br><br>ts=datetime.now()<br>sh.sendline(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;[<span class="hljs-number">4</span>]*n&#125;</span>&#x27;</span>.encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br><span class="hljs-built_in">print</span>(datetime.now()-ts)<br><br>sh.interactive()<br></code></pre></td></tr></table></figure><p><img src="/2025/02/01/ECCNotes4/16.png" alt="16"></p><p>é‚£ä¹ˆæ—¢ç„¶çŸ¥é“äº†è¿™ä¸ªï¼Œå°±å¯ä»¥å¼€å§‹çˆ†ç ´äº†ï¼Œä»¥ä¸‹æ˜¯çˆ†ç ´ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span> <span class="hljs-comment">#=&#x27;debug&#x27;</span><br>ells = [*primes(<span class="hljs-number">3</span>, <span class="hljs-number">200</span>), <span class="hljs-number">269</span>]<br>p = <span class="hljs-number">4</span>*prod(ells) - <span class="hljs-number">1</span><br>F = GF(p)<br>n=<span class="hljs-built_in">len</span>(ells)<br>sh=process([<span class="hljs-string">&#x27;sage&#x27;</span>,<span class="hljs-string">&#x27;task11.sage&#x27;</span>])<br><br>ts=datetime.now()<br>C=<span class="hljs-built_in">int</span>(sh.recvline()[<span class="hljs-number">4</span>:].strip())<br><span class="hljs-built_in">print</span>(datetime.now()-ts)<br><span class="hljs-built_in">print</span>(C)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>(<span class="hljs-params">ind,x</span>):<br>    <span class="hljs-comment">#sh.recvline(keepends=False)</span><br>    L=[x <span class="hljs-keyword">if</span> (i==ind) <span class="hljs-keyword">else</span> <span class="hljs-number">4</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br>    sh.sendline(<span class="hljs-built_in">str</span>(L).encode())<br><br>K=[<span class="hljs-number">9</span>]*n<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (<span class="hljs-built_in">range</span>(n)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">3</span>,<span class="hljs-number">4</span>):<br>        <span class="hljs-comment">#print(i,j)</span><br>        stime=datetime.now()<br>        attack(i,j)<br>        sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>        timecost=(datetime.now()-stime).total_seconds()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Attacking <span class="hljs-subst">&#123;i&#125;</span>,<span class="hljs-subst">&#123;j&#125;</span> with timecost <span class="hljs-subst">&#123;timecost&#125;</span> seconds&#x27;</span>)<br>        <span class="hljs-keyword">if</span>(timecost&lt;<span class="hljs-number">0.95</span>):<br>            K[i]=j<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Found Key[<span class="hljs-subst">&#123;i&#125;</span>]=<span class="hljs-subst">&#123;j&#125;</span>&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Now, Key is <span class="hljs-subst">&#123;K&#125;</span>&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(K)<br></code></pre></td></tr></table></figure><p>è¿è¡Œè¿‡ç¨‹ä¸­çš„ç»“æœï¼Œå¯ä»¥å‘ç°è¿™ä¸ªæ—¶é—´å·®è·éå¸¸æ˜¾è‘—ï¼Œå¹¶ä¸”æ˜¯å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„Keyçš„ã€‚</p><p><img src="/2025/02/01/ECCNotes4/17.png" alt="17"></p><p>ä½†åˆ°è¿™ä¸€æ­¥åˆå‡ºé—®é¢˜äº†ï¼šæˆ‘ä»¬ä¸çŸ¥é“å¯†æ–‡SUDOORçš„å†…å®¹ï¼Œå¹¶ä¸”æœåŠ¡å™¨æ˜¯æ‰§è¡Œè¿œç¨‹çš„ç¨‹åºæ‰ç»™å‡ºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªKEYï¼Œä½¿å¾—æ„é€ çš„KEYå’ŒåŸå§‹ç§é’¥çš„æ‰§è¡Œç»“æœä¸€æ ·ã€‚</p><p>ç”±äº $p+1&#x3D;4\prod_{i&#x3D;1}^n{\ell_i}$ï¼Œå› æ­¤ $\prod_{i&#x3D;1}^n\ell_i$ æ˜¯ä¸€ä¸ª 4-åŒæºï¼Œå…¶é˜¶æ•°ä¸º $3$ï¼Œä¹Ÿå°±æ˜¯å¦‚æœä½¿ç”¨å…¨ $1$ ç§é’¥ï¼Œä¹Ÿå°±æ˜¯å¯¹äºæ¯ä¸ª $\ell_i$ å‡æ²¿ç€åŒæºå›¾åœ¨ä¸Šé¢èµ°ä¸€æ­¥ï¼Œé‚£ä¹ˆé‡å¤ä¸‰æ¬¡å°±ä¼šå›åˆ°åŸç‚¹â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒæºå›¾ç‚¹çš„ä¸ªæ•°ä¸€å®šæ˜¯ $3$ çš„å€æ•°ã€‚</p><p>å› æ­¤ï¼Œå¯†é’¥ <code>K1=[3+i for i in K]</code>  ä¸å¯†é’¥ <code>K</code> æ˜¯ç­‰ä»·çš„ï¼Œå› æ­¤åªéœ€è¦å°†æ‰€æœ‰ç§é’¥çš„å€¼åŠ ä¸‰ï¼Œç„¶åå‘é€ç»™æœåŠ¡å™¨å°±OKäº†ï¼ã€‚ </p><p>é‚£ä¹ˆæœ€åçš„æ”»å‡»ä»£ç ä¹Ÿå°±å‡ºæ¥äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span> <span class="hljs-comment">#=&#x27;debug&#x27;</span><br>ells = [*primes(<span class="hljs-number">3</span>, <span class="hljs-number">200</span>), <span class="hljs-number">269</span>]<br>p = <span class="hljs-number">4</span>*prod(ells) - <span class="hljs-number">1</span><br>F = GF(p)<br>n=<span class="hljs-built_in">len</span>(ells)<br>sh=process([<span class="hljs-string">&#x27;sage&#x27;</span>,<span class="hljs-string">&#x27;task11.sage&#x27;</span>])<br><br>ts=datetime.now()<br>C=<span class="hljs-built_in">int</span>(sh.recvline()[<span class="hljs-number">4</span>:].strip())<br><span class="hljs-built_in">print</span>(datetime.now()-ts)<br><span class="hljs-built_in">print</span>(C)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>(<span class="hljs-params">ind,x</span>):<br>    <span class="hljs-comment">#sh.recvline(keepends=False)</span><br>    L=[x <span class="hljs-keyword">if</span> (i==ind) <span class="hljs-keyword">else</span> <span class="hljs-number">4</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br>    sh.sendline(<span class="hljs-built_in">str</span>(L).encode())<br><br>K=[<span class="hljs-number">9</span>]*n<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (<span class="hljs-built_in">range</span>(n)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">3</span>,<span class="hljs-number">4</span>):<br>        <span class="hljs-comment">#print(i,j)</span><br>        stime=datetime.now()<br>        attack(i,j)<br>        sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>        timecost=(datetime.now()-stime).total_seconds()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Attacking <span class="hljs-subst">&#123;i&#125;</span>,<span class="hljs-subst">&#123;j&#125;</span> with timecost <span class="hljs-subst">&#123;timecost&#125;</span> seconds&#x27;</span>)<br>        <span class="hljs-keyword">if</span>(timecost&lt;<span class="hljs-number">0.95</span>):<br>            K[i]=j<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Found Key[<span class="hljs-subst">&#123;i&#125;</span>]=<span class="hljs-subst">&#123;j&#125;</span>&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Now, Key is <span class="hljs-subst">&#123;K&#125;</span>&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(K)<br><br>sh.sendline(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;[<span class="hljs-number">3</span>+i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> K]&#125;</span>&#x27;</span>.encode())     <br><span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">5</span>))<br></code></pre></td></tr></table></figure><p>æœ¬åœ°æµ‹è¯•çš„æ‰§è¡Œç»“æœï¼ˆéšä¾¿å†™äº†ä¸ªflagç¼–è¯‘äº†ï¼Œå› æ­¤flagä¸æ˜¯åŸå§‹é¢˜ç›®çš„flagï¼‰ï¼š<img src="/2025/02/01/ECCNotes4/18.png" alt="18"></p><h4 id="4-3-2-CSIDHç‰¹æ®Šå‚æ•°çš„DDHé—®é¢˜"><a href="#4-3-2-CSIDHç‰¹æ®Šå‚æ•°çš„DDHé—®é¢˜" class="headerlink" title="4.3.2 CSIDHç‰¹æ®Šå‚æ•°çš„DDHé—®é¢˜"></a>4.3.2 CSIDHç‰¹æ®Šå‚æ•°çš„DDHé—®é¢˜</h4><p>çœ‹ä¸€ä¸ªé¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Hash <span class="hljs-keyword">import</span> SHA256<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> os<br><br>ls = <span class="hljs-built_in">list</span>(primes(<span class="hljs-number">3</span>, <span class="hljs-number">112</span>)) + [<span class="hljs-number">139</span>]<br>p = <span class="hljs-number">2</span> * prod(ls) - <span class="hljs-number">1</span><br>max_exp = ceil((sqrt(p) ** (<span class="hljs-number">1</span> / <span class="hljs-built_in">len</span>(ls)) - <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>)<br>Fp2 = GF(p**<span class="hljs-number">2</span>, names=<span class="hljs-string">&quot;w&quot;</span>, modulus=[<span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<br>w = Fp2.gen()<br>base = EllipticCurve(Fp2, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<br><br><br>SECRET = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">8</span>), <span class="hljs-string">&quot;big&quot;</span>) <span class="hljs-comment"># 2^64 security is more than enough...</span><br>FLAG = <span class="hljs-string">b&quot;crypto&#123;????????????????????????????????&#125;&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_flag</span>(<span class="hljs-params">secret</span>):<br>    key = SHA256.new(<span class="hljs-built_in">int</span>.to_bytes(<span class="hljs-built_in">int</span>(secret), <span class="hljs-number">8</span>)).digest()[:<span class="hljs-number">128</span>]<br>    iv = os.urandom(<span class="hljs-number">16</span>)<br>    cipher = AES.new(key, AES.MODE_CBC, iv)<br>    ct = cipher.encrypt(pad(FLAG, <span class="hljs-number">16</span>))<br><br>    <span class="hljs-keyword">return</span> iv.<span class="hljs-built_in">hex</span>(), ct.<span class="hljs-built_in">hex</span>()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">private</span>():<br>    <span class="hljs-keyword">return</span> [randrange(-max_exp, max_exp + <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ls))]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">action</span>(<span class="hljs-params">pub, priv</span>):<br>    E = pub<br>    es = priv[:]<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">any</span>(es):<br>        E._order = (p + <span class="hljs-number">1</span>) ** <span class="hljs-number">2</span>  <span class="hljs-comment"># else sage computes this</span><br>        P = E.lift_x(GF(p).random_element())<br>        s = +<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> P.xy()[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> GF(p) <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br>        k = prod(l <span class="hljs-keyword">for</span> l, e <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ls, es) <span class="hljs-keyword">if</span> sign(e) == s)<br>        P *= (p + <span class="hljs-number">1</span>) // k<br>        <span class="hljs-keyword">for</span> i, (l, e) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(ls, es)):<br>            <span class="hljs-keyword">if</span> sign(e) != s:<br>                <span class="hljs-keyword">continue</span><br>            Q = k // l * P<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Q:<br>                <span class="hljs-keyword">continue</span><br>            Q._order = l  <span class="hljs-comment"># else sage computes this</span><br>            phi = E.isogeny(Q)<br>            E, P = phi.codomain(), phi(P)<br>            es[i] -= s<br>            k //= l<br>    <span class="hljs-keyword">return</span> E<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">backdoor</span>(<span class="hljs-params">priv</span>):<br>    b = <span class="hljs-number">1</span><br>    <span class="hljs-comment"># secret_marks is a redacted CSIDH private key</span><br>    <span class="hljs-keyword">for</span> e, m <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(secret_marks, priv):<br>        b *= e ^ m<br>    <span class="hljs-keyword">return</span> b<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">package_challenge</span>(<span class="hljs-params">EA, EB, EC</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">package_curve</span>(<span class="hljs-params">E</span>):<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-string">&quot;a4&quot;</span> : <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, E.a4())),<br>            <span class="hljs-string">&quot;a6&quot;</span> : <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, E.a6()))<br>        &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-string">&quot;EA&quot;</span> : package_curve(EA),<br>        <span class="hljs-string">&quot;EB&quot;</span> : package_curve(EB),<br>        <span class="hljs-string">&quot;EC&quot;</span> : package_curve(EC)<br>    &#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_challenge</span>(<span class="hljs-params">bit</span>):<br>    privA = private()<br>    pubA = action(base, privA)<br>    privB = private()<br>    pubB = action(base, privB)<br>    shared = action(pubB, privA)<br>    t = backdoor(privA) * backdoor(privB)<br>    privC = private()<br>    <span class="hljs-keyword">while</span> backdoor(privC) == t:<br>        privC = private()<br>    pubC = action(base, privC)<br>    <span class="hljs-keyword">if</span> bit:<br>        <span class="hljs-keyword">return</span> package_challenge(pubA, pubB, shared)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> package_challenge(pubA, pubB, pubC)<br><br>data = []<br><span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> ZZ(SECRET).bits():<br>    data.append(gen_challenge(bit))<br><br>iv, ct = encrypt_flag(SECRET)<br><br>output = &#123;&#125;<br>output[<span class="hljs-string">&quot;iv&quot;</span>] = iv<br>output[<span class="hljs-string">&quot;ct&quot;</span>] = ct<br>output[<span class="hljs-string">&quot;challenge_data&quot;</span>] = data <br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(json.dumps(output))<br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®çš„å¤§æ„å¾ˆç®€å•ï¼šç»™ä½ ä¸‰æ¡æ›²çº¿ $E_A,E_B$ å’Œ $E_C$ï¼Œé—®ä½  $E_C$ æ˜¯ $E_A,E_B$ å¤åˆåŒæºå¾—åˆ°çš„ï¼Œè¿˜æ˜¯ä»…ä»…æ˜¯éšæœºäº§ç”Ÿçš„çš„æ›²çº¿ï¼Œå¾ˆæ˜æ˜¾çš„ DDH é—®é¢˜çš„isogenyç‰ˆæœ¬ã€‚</p><p>æ³¨æ„åˆ°è¿™ä¸ªèµ·å§‹æ›²çº¿æ¯”è¾ƒç‰¹æ®Šï¼šå±äº $j(E_0)&#x3D;0,\sqrt{-3}\in K$ çš„ç‰¹æ®Šæ›²çº¿ï¼Œå› æ­¤æ— æ³•è®¡ç®—è’™å“¥é©¬åˆ©å‚æ•°ã€‚å¹¶ä¸”è¿™ä¸ªé¢˜åˆ†æ•°è¿˜æŒºé«˜ï¼Œç›²çŒœæ˜¯ä¸ªè®ºæ–‡é¢˜ã€‚</p><p>æœäº†ä¸€åœˆisogeny DDHï¼Œå¯ä»¥æ‰¾åˆ°è¿™ç¯‡è®ºæ–‡ï¼š<a href="https://eprint.iacr.org/2020/151.pdf">2020-151.pdf</a>ï¼Œè®ºæ–‡ç¬¬ 5 ç« ä»‹ç»äº†å‡ ä¸ªç¬¦å·çš„è®¡ç®—æ–¹æ³•ï¼Œå¹¶ä¸”å‚è€ƒ 18 ç»™å‡ºäº†Githubä¸Šçš„magmaä»£ç ã€‚</p><p>ç”±äº $\delta$ ç¬¦å·çš„è®¡ç®—æ¯”è¾ƒç®€å•ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥è®¡ç®— $\delta(E_B,E_0)$ å’Œ $\delta(E_A,E_C)$ æ˜¯å¦ç›¸ç­‰ï¼Œæ¥åˆ¤æ–­ $E_C$ æ˜¯å¦æ˜¯ $E_0$ ç»è¿‡ $E_A,E_B$ çš„å¤åˆåŒæºã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python">DATA= <span class="hljs-comment">#Copy from the output.txt</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>ls = <span class="hljs-built_in">list</span>(primes(<span class="hljs-number">3</span>, <span class="hljs-number">112</span>)) + [<span class="hljs-number">139</span>]<br>p = <span class="hljs-number">2</span> * prod(ls) - <span class="hljs-number">1</span><br>max_exp = ceil((sqrt(p) ** (<span class="hljs-number">1</span> / <span class="hljs-built_in">len</span>(ls)) - <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>)<br>Fp2 = GF(p**<span class="hljs-number">2</span>, names=<span class="hljs-string">&quot;w&quot;</span>, modulus=[<span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<br>w = Fp2.gen()<br>base = EllipticCurve(Fp2, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<br><br>iv,C=DATA[<span class="hljs-string">&quot;iv&quot;</span>],DATA[<span class="hljs-string">&quot;ct&quot;</span>]<br>D=DATA[<span class="hljs-string">&quot;challenge_data&quot;</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(D)):<br>    EA=EllipticCurve(Fp2,[D[i][<span class="hljs-string">&#x27;EA&#x27;</span>][<span class="hljs-string">&#x27;a4&#x27;</span>],D[i][<span class="hljs-string">&#x27;EA&#x27;</span>][<span class="hljs-string">&#x27;a6&#x27;</span>]])<br>    EB=EllipticCurve(Fp2,[D[i][<span class="hljs-string">&#x27;EB&#x27;</span>][<span class="hljs-string">&#x27;a4&#x27;</span>],D[i][<span class="hljs-string">&#x27;EB&#x27;</span>][<span class="hljs-string">&#x27;a6&#x27;</span>]])<br>    EC=EllipticCurve(Fp2,[D[i][<span class="hljs-string">&#x27;EC&#x27;</span>][<span class="hljs-string">&#x27;a4&#x27;</span>],D[i][<span class="hljs-string">&#x27;EC&#x27;</span>][<span class="hljs-string">&#x27;a6&#x27;</span>]])<br>    D[i]=(EA,EB,EC)<br>PR.&lt;x&gt;=PolynomialRing(GF(p))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">comp</span>(<span class="hljs-params">E1,E2</span>):<br>    f=PR([E1.a6(),E1.a4(),<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>    g=PR([E2.a6(),E2.a4(),<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>    r=f.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    s=g.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    judg=GF(p)((E1.a4()+<span class="hljs-number">3</span>*r**<span class="hljs-number">2</span>)/(E2.a4()+<span class="hljs-number">3</span>*s**<span class="hljs-number">2</span>))<br>    <span class="hljs-keyword">return</span> judg**((p-<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>)==<span class="hljs-number">1</span><br>M=[comp(D[i][<span class="hljs-number">0</span>],D[i][<span class="hljs-number">2</span>])==comp(D[i][<span class="hljs-number">1</span>],base) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(D))]<br>s=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(M)):<br>    s+=(M[i]&lt;&lt;i)<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br>key=sha256(long_to_bytes(s)).digest()<br>aes=AES.new(key, AES.MODE_CBC, <span class="hljs-built_in">bytes</span>.fromhex(iv))<br>aes.decrypt(<span class="hljs-built_in">bytes</span>.fromhex(C))<br></code></pre></td></tr></table></figure><h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9.æ€»ç»“"></a>9.æ€»ç»“</h2><p>çœŸéš¾ï¼Œå¥½å¤šå†…å®¹æ„Ÿè§‰æ¯”4å¹´å‰å­¦LLLçš„æ—¶å€™è¿˜æŠ½è±¡ï¼Œéƒ¨åˆ†çŸ¥è¯†å…¶å®è‡ªå·±æ ¹æœ¬å°±ä¸å¤ªæ‡‚ï¼Œä½†ä¸ºäº†é€Ÿæˆä¸€æ³¢ï¼Œè¿˜æ˜¯ç¡¬ç€å¤´çš®ï¼Œé€šè¿‡æµ‹è¯•ä»£ç çš„æ–¹å¼ï¼Œç”¨äº†ä¸€ä¸ªæ˜ŸæœŸï¼ˆ2.1åˆ°2.8ï¼‰ï¼Œå¯¹åŒæºæœ‰äº†ä¸€ä¸ªåŸºæœ¬ç†è§£äº†ã€‚ã€‚ã€‚ç­‰åé¢é‡åˆ°é¢˜ç›®å†æ¨è¿›å§ï¼</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>25Jan3</title>
    <link href="/2025/01/26/25Jan3/"/>
    <url>/2025/01/26/25Jan3/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-1æœˆçš„åˆ‡é¢˜-3"><a href="#huangx607087-1æœˆçš„åˆ‡é¢˜-3" class="headerlink" title="huangx607087 1æœˆçš„åˆ‡é¢˜ 3"></a>huangx607087 1æœˆçš„åˆ‡é¢˜ 3</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>ä¸€å›å®¶å°±Gäº†ï¼Œç„¶åä¼‘æ¯äº†å‡ å¤©ï¼Œä¸¤åœºCTFæ¯”èµ›éƒ½æ²¡å¥½å¥½çœ‹</p><h2 id="1-DASCTF2304-babyhash-revenge"><a href="#1-DASCTF2304-babyhash-revenge" class="headerlink" title="1.[DASCTF2304] babyhash_revenge"></a>1.[DASCTF2304] babyhash_revenge</h2><h3 id="1x01-é¢˜ç›®å¤§æ„"><a href="#1x01-é¢˜ç›®å¤§æ„" class="headerlink" title="1x01 é¢˜ç›®å¤§æ„"></a>1x01 é¢˜ç›®å¤§æ„</h3><p>å…ˆç„ä¸€çœ¼é¢˜ç›®ï¼Œè¿™ä¸ªHashï¼Œå’Œå‰å‡ å¤©SUCTFé‚£ä¸ªHASHç›¸ä¼¼åº¦çœŸé«˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> next_prime<br><br>banner = <span class="hljs-string">br&#x27;&#x27;&#x27;</span><br><span class="hljs-string"> _____     ______     ______     ______     ______   ______  </span><br><span class="hljs-string">/\  __-.  /\  __ \   /\  ___\   /\  ___\   /\__  _\ /\  ___\ </span><br><span class="hljs-string">\ \ \/\ \ \ \  __ \  \ \___  \  \ \ \____  \/_/\ \/ \ \  __\ </span><br><span class="hljs-string"> \ \____-  \ \_\ \_\  \/\_____\  \ \_____\    \ \_\  \ \_\   </span><br><span class="hljs-string">  \/____/   \/_/\/_/   \/_____/   \/_____/     \/_/   \/_/   </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>flag = <span class="hljs-string">b&#x27;xxx&#x27;</span><br>n0 = <span class="hljs-number">30798082519452208630254982405300548841337042015746308462162479889627080155514391987610153873334549377764946092629701</span><br>g = <span class="hljs-number">91289086035117540959154051117940771730039965839291520308840839624996039016929</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-literal">None</span>:<br>        <span class="hljs-variable language_">self</span>.n = next_prime(<span class="hljs-number">2</span>**<span class="hljs-number">240</span>)<br>        <span class="hljs-variable language_">self</span>.a = getRandomNBitInteger(<span class="hljs-number">85</span>)<br>        <span class="hljs-variable language_">self</span>.seed = randint(<span class="hljs-number">1</span>, <span class="hljs-variable language_">self</span>.n-<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.seed = (<span class="hljs-variable language_">self</span>.seed ** <span class="hljs-number">3</span> * <span class="hljs-variable language_">self</span>.a + randint(-<span class="hljs-number">2</span>**<span class="hljs-number">230</span>, <span class="hljs-number">2</span>**<span class="hljs-number">230</span>) + randint(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>)) % <span class="hljs-variable language_">self</span>.n<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.seed<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gift</span>():<br>    lcg = LCG()<br>    outputs = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>        outputs.append(<span class="hljs-built_in">int</span>(lcg.<span class="hljs-built_in">next</span>()))<br>    <span class="hljs-keyword">return</span> outputs, lcg.a<br><br>gift, a = gift()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">str1,str2</span>):<br>    key = <span class="hljs-built_in">bin</span>(a)[<span class="hljs-number">2</span>:]<br>    test = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)):<br>        <span class="hljs-keyword">if</span> key[i] == <span class="hljs-string">&#x27;0&#x27;</span>:<br>            test.append(str1[i] == str2[i])<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">all</span>(test)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">msg</span>):<br>    key = <span class="hljs-built_in">bin</span>(a)[<span class="hljs-number">2</span>:]<br>    n = n0<br>    msg = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">ord</span>,msg))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(msg)):<br>        <span class="hljs-keyword">if</span> key[i] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            n = g * (<span class="hljs-number">2</span> * n + msg[i])<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br>        n = n &amp; ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">383</span>) - <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> (n - <span class="hljs-number">0xdeedbeef114514</span>) % (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">100</span>)<br><br>MENU = <span class="hljs-string">br&#x27;&#x27;&#x27;</span><br><span class="hljs-string">&lt;OPTION&gt;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;SERVER &lt;INPUT&gt;: &#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self</span>):<br>        rounds = <span class="hljs-number">1000</span><br>        pseudo_prime = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv(prompt=<span class="hljs-string">b&#x27;[+] Plz Tell Me your number: &#x27;</span>))<br>        <span class="hljs-keyword">if</span> isPrime(pseudo_prime):<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nNo! it&#x27;s a prime, go away!&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(randint(<span class="hljs-number">2</span>, pseudo_prime), pseudo_prime - <span class="hljs-number">1</span>, pseudo_prime) != <span class="hljs-number">1</span>:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nYou failed in round &quot;</span> + <span class="hljs-built_in">str</span>(i + <span class="hljs-number">1</span>).encode() + <span class="hljs-string">b&#x27;, bye~~&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nCongratulations, you have passed the proof_of_work!\n&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        signal.alarm(<span class="hljs-number">300</span>)<br>        step1 = <span class="hljs-variable language_">self</span>.proof_of_work()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> step1:<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-variable language_">self</span>.send(banner)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nNew challenge now! Please give me 2 diff strings whose hashes are the same~~&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Here is my gift for you: \n&#x27;</span> + <span class="hljs-built_in">str</span>(gift).encode())<br>        string1 = <span class="hljs-variable language_">self</span>.recv().decode()<br>        string2 = <span class="hljs-variable language_">self</span>.recv().decode()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(string1) &lt; <span class="hljs-number">70</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">len</span>(string2) &lt; <span class="hljs-number">70</span>:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nNo! Too short!&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> check(string1,string2):<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nNo! I do not like!&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-keyword">if</span> string1 == string2:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nNo! They are the same one!&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hash</span>(string1) == <span class="hljs-built_in">hash</span>(string2):<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;\nGood job~ Here you are!&#x27;</span>)<br>            <span class="hljs-variable language_">self</span>.send(flag)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;\nConnection has been closed.&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.request.close()<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">9999</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;HOST:POST &quot;</span> + HOST+<span class="hljs-string">&quot;:&quot;</span> + <span class="hljs-built_in">str</span>(PORT))<br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br><br></code></pre></td></tr></table></figure><h3 id="1x02-è§£é¢˜è¿‡ç¨‹"><a href="#1x02-è§£é¢˜è¿‡ç¨‹" class="headerlink" title="1x02 è§£é¢˜è¿‡ç¨‹"></a>1x02 è§£é¢˜è¿‡ç¨‹</h3><p>é¦–å…ˆå…ˆè¿‡<code>proof_of_work</code>ï¼Œå‘ç°æ˜¯ä¸€ä¸ªä¼ªç´ æ•°çš„æµ‹è¯•ï¼Œè¦æ±‚ç»™ä¸€ä¸ªåˆæ•° $n$ï¼Œä½†è¦æ±‚éšæœº $a$ å‡æ»¡è¶³ $a^{n-1}\equiv 1\pmod n$ã€‚å¾ˆæ˜æ˜¾çš„å¡ç±³æ­‡å°”æ•°ã€‚ä½†è¿™è¾¹ $a$ æ˜¯éšæœºå–çš„ï¼Œå› æ­¤è¿™ä¸ªå¡ç±³æ­‡å°”æ•°çš„ç´ å› å­è¦æ¯”è¾ƒå¤§ï¼Œæ‰èƒ½ä¿è¯ $a$ å’Œ $n$ äº’ç´ ã€‚</p><p>æ„é€ æ–¹æ³•å¾ˆç®€å•ï¼šè‹¥ $6k+1,12k+1,18k+1$ å‡ä¸ºç´ æ•°ï¼Œé‚£ä¹ˆ $n&#x3D;(6k+1)(12k+1)(18k+1)$ ä¸ºå¡ç±³æ­‡å°”æ•°ï¼Œè¿™ä¸ªå…¶å®ä¹Ÿåœ¨SUCTFé‚£ä¸ªmathgameä¸­åˆ°äº†ï¼Œä¸è¿‡é‚£ä¸ªmathgameç¬¬ä¸‰é—®ä¸èƒ½ç®—ä¸ªé¢˜ï¼Œå› æ­¤å°±æ²¡æœ‰å†™åœ¨blogä¸­äº†ã€‚å› æ­¤ï¼Œå½“ $k$ è¾¾åˆ° $100$ ä½åï¼Œ$n$ å’Œ $a$ ä¸äº’ç´ çš„æ¦‚ç‡æ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> getrandbits<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">findfakePrime</span>():<br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>        a=getrandbits(<span class="hljs-number">100</span>)<br>        p,q,r=<span class="hljs-number">6</span>*a+<span class="hljs-number">1</span>,<span class="hljs-number">12</span>*a+<span class="hljs-number">1</span>,<span class="hljs-number">18</span>*a+<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span>(isPrime(p)&amp;isPrime(q)&amp;isPrime(r)):<br>            <span class="hljs-keyword">return</span> p*q*r<br>findfakePrime()<br><span class="hljs-comment"># 10s--25s</span><br><span class="hljs-comment"># 148809159554409110476163772315329170997830985215359063220293349706160369860802335922266079601</span><br></code></pre></td></tr></table></figure><p>ç„¶åçœ‹ä»–çš„Hashå‡½æ•°ï¼šå¾ˆæ˜æ˜¾ï¼Œè¿™é‡Œæœ‰ $a$ æ˜¯ä¸çŸ¥é“çš„ï¼Œé‚£å°±éœ€è¦å…ˆæŠŠ $a$ æ±‚å‡ºæ¥ã€‚è¿™è¾¹ LCG çš„å‚æ•°ä¸ºï¼š$y&#x3D;ax^3+b_i$ï¼Œå…¶ä¸­ $b_i$ ä¸º $230$ ä½çš„éšæœºæ•°ï¼Œæ¨¡æ•°ä¸º $240$ ä½ï¼Œç»™äº† $30$ ç»„æ•°æ®ï¼Œæ±‚ $a$ï¼Œè¿™é‡Œ $a$ æ˜¯ $85$ ä½ï¼Œå› æ­¤è¿™è¾¹ç›¸å½“äºä¸€ä¸ªLCGå·²çŸ¥é«˜ä½ï¼Œæ±‚æ•´ä¸ªLCGçš„é¢˜ã€‚</p><p>é‚£ä¹ˆå°è¯•æ±‚ $a$ ï¼ˆè‚¯å®šæ˜¯ä¸‰åç»„æ•°æ®å…¨ç”¨çš„ï¼Œè¿™è¾¹ä»¥ä¸‰ç»„ä¸ºä¾‹ï¼Œçœ‹ä¸ªæ„é€ è¿‡ç¨‹ï¼‰</p><p><img src="/2025/01/26/25Jan3/1.png" alt="1"></p><p>å¯¹ä¸­é—´çŸ©é˜µè¿›è¡ŒLLLï¼Œæµ‹ä¸ªç•Œï¼Œæœ€ç»ˆæœ€çŸ­å‘é‡å¤§æ¦‚ç‡æ˜¯ $a$ã€‚</p><p>æœ‰äº† $a$ ä¹‹åï¼Œå°±å¯ä»¥æŒ‰ç…§å‰é¢é‚£ä¸ªé¢˜çš„æ–¹æ³•ï¼Œæ‰¾å‡ºä¸€ç»„ç¢°æ’ï¼Œæ”»å‡»é¢˜ç›®ä¸­çš„Hashäº†ã€‚ä½†è¿™è¾¹ä»–çš„è¦æ±‚æ¯”è¾ƒå¥‡æ€ªï¼šå¦‚æœ $a$ çš„å¯¹åº”æ¯”ç‰¹ä¸º $1$ï¼Œæ‰æ”¾å…¥Hashä¸­è®¡ç®—ï¼Œä½†åˆè¦æ±‚ $a$ å¯¹åº”æ¯”ç‰¹ä¸º $0$ çš„ä½è¦ä¿æŒä¸€è‡´ï¼Œå¹¶ä¸”è¦æ±‚ç»™å‡ºçš„å­—ç¬¦ä¸ºå¯è§å­—ç¬¦ã€‚</p><p>å›é¡¾ä¸€ä¸‹é‚£ä¸ªé¢˜çš„æ„é€ æ–¹æ³•ï¼š</p><p><img src="/2025/01/26/25Jan3/2.png" alt="2"></p><p>é‚£ä¹ˆç›´æ¥æŠŠSUHashé‚£ä¸ªæ‰¾ç¢°æ’çš„å‡½æ•°æ‹¿è¿‡æ¥ç”¨ï¼Œä½†æ³¨æ„è¿™è¾¹æ„é€ çš„ä½æ•°ä¸º $a$ çš„ $1$ æ¯”ç‰¹æ•°ï¼ˆå¤§æ¦‚ $40$ å¤šï¼‰ï¼Œå¹¶ä¸”æ‰¾åˆ°ä¸€ç»„å°±OKäº†ã€‚</p><p>æˆ‘è¿™è¾¹æœ€ç»ˆæ„é€ çš„ç»“æœä¸ºï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP</span><br><span class="hljs-attribute">RPPPPTQSPONPPPPPPPPPKPOPOPPOOONPYPNKLNPPOPPPPPQQSQLPPNPPPPPPPQOQOPPPPPPPRRPPSRPPPPPPP</span><br></code></pre></td></tr></table></figure><p>expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span> <br>sh=remote(<span class="hljs-string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="hljs-number">26391</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;148809159554409110476163772315329170997830985215359063220293349706160369860802335922266079601&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;[&#x27;</span>)<br>arr=<span class="hljs-built_in">eval</span>(<span class="hljs-string">b&#x27;[&#x27;</span>+sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>p=next_prime(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">240</span>)<br>A=[arr[i]**<span class="hljs-number">3</span>%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">29</span>)]<br>B=[arr[<span class="hljs-number">1</span>+i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">29</span>)]<br>M=[[p*(i==j) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>)]<br>M[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>],M[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]=<span class="hljs-number">2</span>**(<span class="hljs-number">230</span>-<span class="hljs-number">85</span>),<span class="hljs-number">2</span>**<span class="hljs-number">230</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">29</span>):<br>    M[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>+i]=A[i]<br>    M[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>+i]=B[i]<br>M=matrix(ZZ,M)<br>M3L=M.LLL()<br>vec=M3L[<span class="hljs-number">0</span>]<br>a=<span class="hljs-built_in">abs</span>(vec[<span class="hljs-number">0</span>])<br><span class="hljs-keyword">assert</span> a%(<span class="hljs-number">2</span>**(<span class="hljs-number">230</span>-<span class="hljs-number">85</span>))==<span class="hljs-number">0</span><br>a=(vec[<span class="hljs-number">0</span>])&gt;&gt;(<span class="hljs-number">230</span>-<span class="hljs-number">85</span>)<br><span class="hljs-built_in">print</span>(a)<br>difflen=<span class="hljs-built_in">bin</span>(a).count(<span class="hljs-string">&#x27;1&#x27;</span>)<br><span class="hljs-built_in">print</span>(difflen)<br>n0 = <span class="hljs-number">30798082519452208630254982405300548841337042015746308462162479889627080155514391987610153873334549377764946092629701</span><br>g = <span class="hljs-number">91289086035117540959154051117940771730039965839291520308840839624996039016929</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">H</span>(<span class="hljs-params">msg</span>):<br>    key = <span class="hljs-built_in">bin</span>(a)[<span class="hljs-number">2</span>:]<br>    n = n0<br>    msg = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">ord</span>,msg))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(msg)):<br>        <span class="hljs-comment">#print(i)</span><br>        <span class="hljs-keyword">if</span> key[i] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            n = g * (<span class="hljs-number">2</span> * n + msg[i])<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br>        n = n &amp; ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">383</span>) - <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> (n - <span class="hljs-number">0xdeedbeef114514</span>) % (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">100</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getcollision</span>(<span class="hljs-params">n</span>):<br>    M=[[i==j <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>    M[-<span class="hljs-number">1</span>][-<span class="hljs-number">1</span>]=<span class="hljs-number">2</span>**<span class="hljs-number">128</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i][-<span class="hljs-number">1</span>]=<span class="hljs-number">2</span>**(n-i)*Integer(<span class="hljs-built_in">pow</span>(g,n-i,<span class="hljs-number">2</span>**<span class="hljs-number">128</span>))%(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>)<br>    M=matrix(ZZ,M)<br>    M3L=M.LLL()<br>    vec=[]<br>    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M3L:<br>        <span class="hljs-keyword">if</span>(v[-<span class="hljs-number">1</span>]==<span class="hljs-number">0</span>):<br>            vec.append(v)<br>    <span class="hljs-keyword">return</span> vec<br>detla=getcollision(difflen)[<span class="hljs-number">0</span>]<br>s=<span class="hljs-built_in">bytes</span>([<span class="hljs-number">80</span>]*<span class="hljs-number">85</span>)<br>t=[<span class="hljs-number">80</span>]*<span class="hljs-number">85</span><br>cur=<span class="hljs-number">0</span><br>table=<span class="hljs-built_in">bin</span>(a)[<span class="hljs-number">2</span>:]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">85</span>):<br>    <span class="hljs-keyword">if</span>(table[i]==<span class="hljs-string">&#x27;1&#x27;</span>):<br>        t[i]+=detla[cur]<br>        cur+=<span class="hljs-number">1</span><br>t=<span class="hljs-built_in">bytes</span>(t)<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-built_in">print</span>(t)<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(s)<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(t)<br><span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">500</span>))<br><span class="hljs-comment">#DASCTF&#123;S0rry_But_this_1s_My_revenge&#125;</span><br></code></pre></td></tr></table></figure><h2 id="2-DASCTF2410-easy-xorâ€“7solves"><a href="#2-DASCTF2410-easy-xorâ€“7solves" class="headerlink" title="2.[DASCTF2410]easy_xorâ€“7solves"></a>2.[DASCTF2410]easy_xorâ€“7solves</h2><h3 id="2x01-é¢˜ç›®å¤§æ„"><a href="#2x01-é¢˜ç›®å¤§æ„" class="headerlink" title="2x01 é¢˜ç›®å¤§æ„"></a>2x01 é¢˜ç›®å¤§æ„</h3><p>å…ˆçœ‹çœ¼é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sage</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg</span>):<br>    p = getPrime(<span class="hljs-number">256</span>)<br>    n = <span class="hljs-number">2</span>^<span class="hljs-number">512</span><br>    x = msg[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">7</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> msg:<br>        x = <span class="hljs-built_in">int</span>(x*p % n)<br>        x ^^= i<br>    <span class="hljs-keyword">return</span> x ^^ <span class="hljs-built_in">len</span>(msg) ,p<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">prime_to_matrix</span>(<span class="hljs-params">p , n</span>):<br>    <br>    binary_rep = <span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:].zfill(n^<span class="hljs-number">2</span>)<br>    matrix = Matrix(GF(<span class="hljs-number">2</span>), n, n, [<span class="hljs-built_in">int</span>(b) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> binary_rep])<br>    <br>    <span class="hljs-keyword">return</span> matrix<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_to_prime</span>(<span class="hljs-params">matrix, n</span>):<br><br>    binary_rep = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">str</span>(matrix[i, j]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n))<br>    p = <span class="hljs-built_in">int</span>(binary_rep, <span class="hljs-number">2</span>)<br>    <br>    <span class="hljs-keyword">return</span> p<br><br>key = os.urandom(<span class="hljs-number">16</span>)<br>key_list = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> key]<br>c,p = encrypt(key_list)<br><br>P = prime_to_matrix(p,<span class="hljs-number">16</span>)<br><br>q = getPrime(<span class="hljs-number">256</span>) <br>Q = prime_to_matrix(q,<span class="hljs-number">16</span>)<br><br>R = P*Q<br>r = matrix_to_prime(R,<span class="hljs-number">16</span>)<br><br>s = p^^r<br>S = prime_to_matrix(s,<span class="hljs-number">16</span>)<br><br>array_q = []<br>t = q<br><span class="hljs-keyword">while</span> t &gt; <span class="hljs-number">0</span>:<br>    array_q.append(t%<span class="hljs-number">256</span>)<br>    t = t//<span class="hljs-number">256</span><br><br>m = <span class="hljs-built_in">len</span>(array_q)<br>A = matrix(ZZ,m,m)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span>  <span class="hljs-built_in">range</span>(m):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        A[i,j] = randint(<span class="hljs-number">65537</span>//<span class="hljs-number">2</span>,<span class="hljs-number">65537</span>)<br><br>x = matrix(ZZ,[array_q])<br>x = x.T<br>e = matrix(ZZ,m,<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    e[i,<span class="hljs-number">0</span>] = randint(<span class="hljs-number">1</span>,<span class="hljs-number">256</span>)<br>b = A*x + e  <br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;out.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>\n&quot;</span>)<br>    f.write(<span class="hljs-string">f&quot;S = <span class="hljs-subst">&#123;S&#125;</span>\n&quot;</span>)<br>    f.write(<span class="hljs-string">f&quot;A = <span class="hljs-subst">&#123;A&#125;</span>\n&quot;</span>)<br>    f.write(<span class="hljs-string">f&quot;b = <span class="hljs-subst">&#123;b&#125;</span>\n&quot;</span>)<br>    <br>flag = <span class="hljs-string">&quot;CBCTF&#123;&quot;</span>+sha256(key).hexdigest()+<span class="hljs-string">&quot;&#125;&quot;</span><br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®è¦æ±‚ $key$ï¼Œä¸ºä¸€ä¸ªé•¿åº¦ä¸º $16$ çš„å­—ç¬¦ä¸²ï¼Œç»™å‡ºäº† <code>c=enc(key,p)</code>ï¼Œå…¶ä¸­ $p$ ä¸º $256$ ä½ç´ æ•°ï¼Œå¹¶ç”Ÿæˆäº†å¦ä¸€ä¸ª $256$ ä½çš„ç´ æ•° $q$ã€‚</p><p>éšåå°† $p,q$ é€æ¯”ç‰¹è½¬åŒ–ä¸º $P,Q$ ä¸¤ä¸ª $16\times16$ çš„ $\mathbb F_2$ ä¸ŠçŸ©é˜µï¼Œå¹¶è®¡ç®— $R&#x3D;PQ$ï¼Œåˆå°† $R$ é€æ¯”ç‰¹è½¬åŒ–ä¸º $256$ ä½çš„æ•°å€¼ $r$ï¼Œå¹¶è®¡ç®— $s&#x3D;p\oplus r$ï¼Œæœ€ç»ˆè½¬åŒ–æˆäº†çŸ©é˜µ $S$ã€‚</p><p>è€Œå¯¹äº $q$ï¼Œåˆå°† $q$ è½¬åŒ–ä¸ºäº† $256$ è¿›åˆ¶çš„å½¢å¼ï¼Œå¾—åˆ°äº† $\vec x$ï¼Œå¹¶æœ€ç»ˆè®¡ç®—äº† $\vec b&#x3D;A\vec x+\vec e$ã€‚</p><h3 id="2x02-é¢˜ç›®åˆ†æ"><a href="#2x02-é¢˜ç›®åˆ†æ" class="headerlink" title="2x02 é¢˜ç›®åˆ†æ"></a>2x02 é¢˜ç›®åˆ†æ</h3><p>æ‹¿åˆ°ç¬¬ä¸€æ­¥å°±å‘ç°ï¼Œ $\vec b&#x3D;A\vec x+\vec e$ è¿™ä¸€æ­¥æ²¡æœ‰å¸¦æ¨¡æ•°ï¼Œå¯ä»¥å°è¯•ç›´æ¥è§£å¹¶è·å¾— $q$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">RF600=RealField(<span class="hljs-number">600</span>)<br>A=matrix(RF600,A)<br>b=vector(RF600,[b[i][<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(b))])<br>x=A.solve_right(b)<br>xreg=[x[i].<span class="hljs-built_in">round</span>() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(x))]<br>q=<span class="hljs-built_in">sum</span>([xreg[i]*<span class="hljs-number">256</span>**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(xreg))])<br><span class="hljs-built_in">print</span>(q)<br><span class="hljs-comment">#82562676145944350609535127612846198515707028561842371207246482755300888479199</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° $q$ ä¹‹åï¼Œé‚£ä¸‹é¢å°±æ˜¯æ±‚ $p$ã€‚å¯ä»¥å‘ç°ï¼Œä» $R$ åˆ° $r$ å†è®¡ç®— $s&#x3D;p\oplus r$ è¿™ä¸€æ­¥éª¤æ„ä¹‰ä¸å¤§ï¼Œç›¸å½“äº $\mathbb F_2$ çŸ©é˜µè®¡ç®— $S&#x3D;PQ+P$ï¼Œä¹Ÿå°±æ˜¯ $S&#x3D;P(Q+E)$ï¼Œé‚£ä¹ˆ $P&#x3D;S(Q+E)^{-1}$ å°±èƒ½å¤Ÿå¾—åˆ° $p$ äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">Q=prime_to_matrix(q,<span class="hljs-number">16</span>)<br>E=identity_matrix(GF(<span class="hljs-number">2</span>),<span class="hljs-number">16</span>)<br>S=Matrix(GF(<span class="hljs-number">2</span>),S)<br>P=S*(Q+E)**-<span class="hljs-number">1</span><br>p=matrix_to_prime(P,<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-comment">#67257864135528287293221481195193537429491893060495096187717252518567940812773</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ° $p$ ä¹‹åï¼Œç”±äºå·²çŸ¥ key çš„é•¿åº¦ä¸º $16$ï¼Œå› æ­¤å…ˆç»™ $c$ å¼‚æˆ–ä¸Š $16$ï¼Œå¹¶ä¸”ç»§ç»­å°† $\oplus m_i$ çœ‹ä½œ $+\delta_i$ å»æ¨å¼å­ï¼ˆä»ç„¶ä»¥ä¸‰ä½ä¸ºä¾‹ï¼‰<br>$$<br>c&#x3D;p^2(128p+1)\delta_0+p\delta_1+\delta_2<br>$$<br>ç”±æ­¤ç±»æ¨å¯ä»¥å¾—åˆ° $15$ ä½çš„æƒ…å†µï¼Œè¿™è¾¹å°±ä¸å¤šè¯´äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">c=<span class="hljs-number">3235165504936419327001182958857604252407894106191511594689199770239529482330201776634335054024549532136197669522057846845936856432300465191006002492337710</span><br>c=c^^<span class="hljs-number">16</span><br>y=[<span class="hljs-built_in">pow</span>(p,i,<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">512</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>)]<br>y=[(-c)%(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">512</span>)]+y+[p**<span class="hljs-number">15</span>*(<span class="hljs-number">128</span>*p+<span class="hljs-number">1</span>)%(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">512</span>)]<br>y=matrix(ZZ,y[::-<span class="hljs-number">1</span>]).T<br>M=block_matrix(ZZ,[<br>    [identity_matrix(<span class="hljs-number">17</span>),y],<br>    [zero_matrix(<span class="hljs-number">1</span>,<span class="hljs-number">17</span>),<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">512</span>]<br>])<br>M3L=M.LLL()<br><span class="hljs-built_in">print</span>(M3L)<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯LLLä¹‹åï¼Œè§‚å¯Ÿ M3L çš„å‰ä¸¤è¡Œï¼Œæˆ‘ä»¬æœŸå¾…çš„æ˜¯ $(\delta_0,\delta_1,â€¦,\delta_{15},1,0)$ï¼Œä½†å´å¾—åˆ°äº†è¿™æ ·ä¸¤ä¸ªå‘é‡ï¼Œç¬¬äºŒä¸ªå‘é‡çš„å€’æ•°ç¬¬ä¸‰ä¸ªåˆ†é‡ä¸º $-11$ï¼Œæœ€åä¸€ä¸ªåˆ†é‡ä¸º $12$ã€‚å› æ­¤éœ€è¦å°†ç¬¬äºŒä¸ªå‘é‡çš„æœ€åä¸€ä¸ªåˆ†é‡æ¸…é›¶ï¼Œä¹Ÿå°±æ˜¯å®é™…çš„ç­”æ¡ˆä¸º $\vec v_2-12\vec v_1$ã€‚å¥½åœ¨å¹¸è¿çš„æ˜¯ï¼Œè¿™ä¸ªçº¿æ€§å…³ç³»è¿˜æ˜¯å¾ˆæ˜¾ç„¶çš„ï¼Œä¸ç„¶å¦‚æœçœ‹å‡ºä¸€ä¸ªä¸æ˜¾ç„¶çš„çº¿æ€§å…³ç³»ï¼Œåˆè¦ç»§ç»­æ¨å¼å­äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">[   <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>]<br>[ <span class="hljs-number">254</span>  -<span class="hljs-number">26</span>  <span class="hljs-number">151</span>  -<span class="hljs-number">81</span>   <span class="hljs-number">47</span> -<span class="hljs-number">159</span> -<span class="hljs-number">145</span>  -<span class="hljs-number">30</span> -<span class="hljs-number">167</span>  -<span class="hljs-number">61</span> -<span class="hljs-number">137</span> -<span class="hljs-number">183</span>  -<span class="hljs-number">85</span>  -<span class="hljs-number">30</span>   <span class="hljs-number">61</span>  -<span class="hljs-number">11</span>    <span class="hljs-number">1</span>   <span class="hljs-number">12</span>]<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆæœ€åå°±å¯ä»¥å¾—åˆ°æœ€ç»ˆç»“æœäº†ã€‚ï¼ˆxsï¼Œä¸ºå•¥è¿™ä¸ªé¢˜åªæœ‰ 7 è§£ï¼Œå› ä¸ºå¤ªå¥—å¨ƒäº†å—ï¼Ÿç„¶å10æœˆè€ƒè¿‡è¿™ä¸ªé¢˜ï¼Œ12æœˆCISCNåˆè€ƒï¼Ÿï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">vec=M3L[<span class="hljs-number">1</span>]-<span class="hljs-number">12</span>*M3L[<span class="hljs-number">0</span>]<br>s=[vec[<span class="hljs-number">0</span>]]+[-<span class="hljs-number">1</span>]*<span class="hljs-number">15</span><br>mask=(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">512</span>)-<span class="hljs-number">1</span><br>x=<span class="hljs-built_in">int</span>(vec[<span class="hljs-number">0</span>]&lt;&lt;<span class="hljs-number">7</span>)<br>x = <span class="hljs-built_in">int</span>(x*p&amp;mask)<br>x ^^= vec[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">16</span>):<br>    x=<span class="hljs-built_in">int</span>((x*p)&amp;mask)<br>    xbar=x+vec[i]<br>    chi=xbar^^x<br>    x=xbar<br>    s[i]=chi<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-built_in">print</span>(x==c)<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">&quot;CBCTF&#123;&quot;</span>+sha256(<span class="hljs-built_in">bytes</span>(s)).hexdigest()+<span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#[254, 42, 175, 177, 83, 227, 179, 34, 255, 67, 137, 185, 245, 230, 197, 107]</span><br><span class="hljs-comment">#True</span><br><span class="hljs-comment">#CBCTF&#123;0d3f156b0c831817e366a437fc80c0e2c14a5e36ebd5c27f9ad835dd9d6a3855&#125;</span><br></code></pre></td></tr></table></figure><h2 id="3-DASCTF-2408-ezShamir"><a href="#3-DASCTF-2408-ezShamir" class="headerlink" title="3.[DASCTF 2408] ezShamir"></a>3.[DASCTF 2408] ezShamir</h2><p>é¢˜ç›®æ¯”è¾ƒç®€å•ï¼Œè¿˜æ˜¯å…ˆçœ‹ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> getrandbits<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256, md5<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Shamir</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, pbits, noise_bit, n, m</span>):<br>        <span class="hljs-variable language_">self</span>.pbits = pbits<br>        <span class="hljs-variable language_">self</span>.noise_bit = noise_bit<br>        <span class="hljs-variable language_">self</span>.n = n<br>        <span class="hljs-variable language_">self</span>.m = m<br>        <span class="hljs-variable language_">self</span>.p = getPrime(pbits)<br>        P.&lt;x&gt; = PolynomialRing(Zmod(<span class="hljs-variable language_">self</span>.p))<br>        <span class="hljs-variable language_">self</span>.poly = P([bytes_to_long(sha256(os.urandom(<span class="hljs-number">32</span>)).digest()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.n)])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sample</span>(<span class="hljs-params">self</span>):<br>        t = getrandbits(<span class="hljs-variable language_">self</span>.pbits)<br>        y = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.poly(t))<br>        noise = getrandbits(noise_bit)<br>        <span class="hljs-keyword">return</span> (t, y | noise)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_msg</span>(<span class="hljs-params">self</span>):<br>        res = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.m):<br>            res.append(<span class="hljs-variable language_">self</span>.sample())<br>        <span class="hljs-keyword">return</span> res<br><br>pbits = <span class="hljs-number">400</span><br>noise_bit = <span class="hljs-number">32</span><br>n = <span class="hljs-number">100</span><br>m = <span class="hljs-number">75</span><br><br>shamir = Shamir(pbits, noise_bit, n, m)<br>coefficient = shamir.poly()<br>key = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(coefficient)[<span class="hljs-number">1</span>:]])<br>key = md5(key.encode()).digest()<br>aes = AES.new(key = key, mode = AES.MODE_ECB)<br>ct = aes.encrypt(pad(flag, <span class="hljs-number">16</span>))<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-built_in">str</span>(shamir.p)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    f.write(<span class="hljs-built_in">str</span>(shamir.get_msg())+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    f.write(<span class="hljs-built_in">str</span>(bytes_to_long(ct))+<span class="hljs-string">&#x27;\n&#x27;</span>)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº† $p$ å’Œ $75$ ç»„ $(x,y)$ï¼Œä½† $y&#x3D;f(x)$ çš„ç»“æœç”±äºæˆ–ä¸Šäº†ä¸€ä¸ª $32$ æ¯”ç‰¹çš„éšæœºæ•°ï¼Œå› æ­¤æ˜¯å¸¦æœ‰è¯¯å·®çš„ï¼Œè¦æ±‚æ±‚ $f(x)$ çš„ç³»æ•°ã€‚</p><p>è¿˜æ˜¯å°† $f(x) \mathrm{bitor}\space \delta$ çœ‹ä½œ $f(x)+\delta$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰ $y&#x3D;f(x)+\delta$ï¼Œä¹Ÿå°±æ˜¯ $-\delta &#x3D;f(x)-y$ã€‚</p><p>é‚£ä¹ˆå¯ä»¥æœ‰è¿™æ ·çš„å…³ç³»è¡¨è¾¾å¼ï¼š</p><p><img src="/2025/01/26/25Jan3/3.png" alt="3"></p><p>å…¶ä¸­ $V$ çš„è¡¨ç¤ºå¦‚ä¸‹ï¼ˆä»¥ $4\times 4$ ä¸ºä¾‹ï¼‰ï¼š</p><p><img src="/2025/01/26/25Jan3/4.png" alt="4"></p><p>ä¸è¿‡æ³¨æ„åˆ°ï¼Œç”±äº $a$ æ˜¯ $256$ æ¯”ç‰¹ï¼Œ $\delta$ æ˜¯ $32$ æ¯”ç‰¹ï¼Œå› æ­¤éœ€è¦ä¹˜ä¸€ä¸ªå¹³è¡¡ç³»æ•°çŸ©é˜µ $B&#x3D;\mathrm{diag}(\vec 1_{n},2^{256},2^{224}\times \vec {1} _m)$ï¼Œå¯¹ $MB$ è¿›è¡ŒLLLï¼Œç„¶åLLLä¹‹åï¼Œå†ç»™ $B$ é™¤æ‰ï¼Œæ‰¾ä¸­é—´å€¼ä¸º $1$ çš„é‚£ä¸€è¡Œå°±OKã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">1914861180127910915217161496032452354459288330404267938814385633318816795789745430689392291853522228462459760259540145551</span><br>D= <span class="hljs-comment">#75ç»„(x,y=f(x)+delta)</span><br>c=<span class="hljs-number">14058554635665083618818231958810639805770645952778992611953881143316377164307777281092527452513347998950720853358361</span><br>n,m=<span class="hljs-number">100</span>,<span class="hljs-number">75</span><br>V=[]<br>Y=[]<br><span class="hljs-keyword">for</span> x,y <span class="hljs-keyword">in</span> D:<br>    V.append([<span class="hljs-built_in">pow</span>(x,i,p) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)])<br>    Y.append(y)<br>V=Matrix(ZZ,V)<br>Y=Matrix(ZZ,Y)<br>M=block_matrix(ZZ,[<br>    [identity_matrix(n),zero_matrix(n,<span class="hljs-number">1</span>),V.T],<br>    [zero_matrix(<span class="hljs-number">1</span>,n),<span class="hljs-number">1</span>,-Y],<br>    [zero_matrix(m,n),zero_matrix(m,<span class="hljs-number">1</span>),p*identity_matrix(m)]<br>])<br>B=diagonal_matrix([<span class="hljs-number">1</span>]*n+[<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">256</span>]+[<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">224</span>]*m)<br>M=M*B<br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out122.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br>f.write(<span class="hljs-built_in">str</span>(datetime.now())+<span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-comment">#2025-01-21 22:26:49.809221</span><br><br>M3L=M.LLL()<br>f.write(<span class="hljs-built_in">str</span>(datetime.now())+<span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-comment">#2025-01-21 23:57:37.928773</span><br><br>M3L=M3L*B**-<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> vec <span class="hljs-keyword">in</span> M3L:<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(vec[n])==<span class="hljs-number">1</span>):<br>        f.write(<span class="hljs-built_in">str</span>(vec)+<span class="hljs-string">&quot;\n&quot;</span>)<br>        <span class="hljs-keyword">break</span><br>coef=vec[:n]*vec[n]<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256, md5<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>key = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> coef[<span class="hljs-number">1</span>:]])<br>key = md5(key.encode()).digest()<br>aes = AES.new(key = key, mode = AES.MODE_ECB)<br>f.write(<span class="hljs-built_in">str</span>(aes.decrypt(long_to_bytes(c))))<br>f.close()<br><span class="hljs-comment">#DASCTF&#123;3617af36-7869-6939-3a09-bb8038aea171&#125;\x04\x04\x04\x04</span><br></code></pre></td></tr></table></figure><p>æŒ‚åœ¨æœåŠ¡å™¨ä¸Šè·‘çš„ï¼ŒçœŸæ²¡æƒ³åˆ° $176\times 176$ çš„çŸ©é˜µè¦è·‘ $91$ åˆ†é’Ÿï¼ˆå¬è¯´flatteråªè¦å…«åˆ†é’Ÿï¼‰ã€‚</p><h2 id="4-DASCTF-2203-meet-me-in-the-middle"><a href="#4-DASCTF-2203-meet-me-in-the-middle" class="headerlink" title="4.[DASCTF 2203]meet me in the middle"></a>4.[DASCTF 2203]meet me in the middle</h2><p>é¢˜ç›®çœ‹ç€å¾ˆé•¿ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ä¸€ä¸ªDSAï¼Œæ¯æ¬¡ç­¾åç»™å‡º  $r,s$ å¤–ï¼Œè¿˜ç»™å‡ºäº†éšæœºæ•° $k$ ä¸­é—´çš„æ¯”ç‰¹ï¼Œé«˜ $30$ æ¯”ç‰¹å’Œä½ $30$ æ¯”ç‰¹è¢«å¿½ç•¥äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Random <span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> DSA<br><br>table = string.ascii_letters + string.digits<br>BANNER = <span class="hljs-string">br&#x27;&#x27;&#x27;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DigitalSignatureAlgorithm</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, key</span>):<br>        <span class="hljs-variable language_">self</span>.p = key.p<br>        <span class="hljs-variable language_">self</span>.q = key.q<br>        <span class="hljs-variable language_">self</span>.g = key.g<br>        <span class="hljs-variable language_">self</span>.y = key.y<br>        <span class="hljs-variable language_">self</span>.x = key.x<br>        <span class="hljs-variable language_">self</span>.k = []<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sign</span>(<span class="hljs-params">self, m</span>):<br>        k = random.StrongRandom().randint(<span class="hljs-number">1</span>, <span class="hljs-variable language_">self</span>.q - <span class="hljs-number">1</span>)<br>        <span class="hljs-variable language_">self</span>.k.append(k)<br>        h = bytes_to_long(sha256(m).digest())<br>        r = <span class="hljs-built_in">pow</span>(<span class="hljs-variable language_">self</span>.g, k, <span class="hljs-variable language_">self</span>.p) % <span class="hljs-variable language_">self</span>.q<br>        s = inverse(k, <span class="hljs-variable language_">self</span>.q) * (h + <span class="hljs-variable language_">self</span>.x * r) % <span class="hljs-variable language_">self</span>.q<br>        <span class="hljs-keyword">return</span> r, s<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">verify</span>(<span class="hljs-params">self, m, signature</span>):<br>        r, s = signature<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> (<span class="hljs-number">1</span> &lt;= r &lt;= <span class="hljs-variable language_">self</span>.q - <span class="hljs-number">1</span>)) <span class="hljs-keyword">or</span> (<span class="hljs-keyword">not</span> (<span class="hljs-number">1</span> &lt;= s &lt;= <span class="hljs-variable language_">self</span>.q - <span class="hljs-number">1</span>)):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        z = bytes_to_long(sha256(m).digest())<br>        w = inverse(s, <span class="hljs-variable language_">self</span>.q)<br>        u1 = (z * w) % <span class="hljs-variable language_">self</span>.q<br>        u2 = (r * w) % <span class="hljs-variable language_">self</span>.q<br>        v = (<span class="hljs-built_in">pow</span>(<span class="hljs-variable language_">self</span>.g, u1, <span class="hljs-variable language_">self</span>.p) * <span class="hljs-built_in">pow</span>(<span class="hljs-variable language_">self</span>.y, u2, <span class="hljs-variable language_">self</span>.p)) % <span class="hljs-variable language_">self</span>.p % <span class="hljs-variable language_">self</span>.q<br>        <span class="hljs-keyword">return</span> r == v<br><br><br>myDSA = DigitalSignatureAlgorithm(DSA.generate(<span class="hljs-number">1024</span>))<br>MENU = <span class="hljs-string">br&#x27;&#x27;&#x27;</span><br><span class="hljs-string">[1] Sign.</span><br><span class="hljs-string">[2] Verify.</span><br><span class="hljs-string">[3] Get_public_key.</span><br><span class="hljs-string">[4] Get_sth_in_the_middle</span><br><span class="hljs-string">[5] Exit.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;[-] &#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self</span>):<br>        proof = (<span class="hljs-string">&#x27;&#x27;</span>.join([random.choice(table) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>)])).encode()<br>        sha = sha256(proof).hexdigest().encode()<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="hljs-number">4</span>:] + <span class="hljs-string">b&quot;) == &quot;</span> + sha)<br>        XXXX = <span class="hljs-variable language_">self</span>.recv(prompt=<span class="hljs-string">b&#x27;[+] Plz Tell Me XXXX :&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(XXXX) != <span class="hljs-number">4</span> <span class="hljs-keyword">or</span> sha256(XXXX + proof[<span class="hljs-number">4</span>:]).hexdigest().encode() != sha:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sign</span>(<span class="hljs-params">self</span>):<br>        m1 = <span class="hljs-string">b&#x27;What you want to know&#x27;</span><br>        m2 = <span class="hljs-string">b&#x27;My dear lone warrior&#x27;</span><br>        signature1 = myDSA.sign(m1)<br>        signature2 = myDSA.sign(m2)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Your signature1 is:&#x27;</span> + <span class="hljs-built_in">str</span>(signature1).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Your signature2 is:&#x27;</span> + <span class="hljs-built_in">str</span>(signature2).encode())<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">verify</span>(<span class="hljs-params">self</span>):<br>        m = <span class="hljs-variable language_">self</span>.recv(<span class="hljs-string">b&#x27;message:&#x27;</span>)<br>        r = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv(<span class="hljs-string">b&#x27;r:&#x27;</span>))<br>        s = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv(<span class="hljs-string">b&#x27;s:&#x27;</span>))<br>        signature = (r, s)<br>        <span class="hljs-keyword">if</span> m == <span class="hljs-string">b&quot;I&#x27;m Admin.I want flag.&quot;</span>:<br>            <span class="hljs-keyword">if</span> myDSA.verify(m, signature):<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Hello there.This is what you want.&#x27;</span>)<br>                flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag&#x27;</span>).read()<br>                <span class="hljs-variable language_">self</span>.send(flag.encode())<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Who are U?Get out!&#x27;</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Who are U?Get out!&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_public_key</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;p = &#x27;</span> + <span class="hljs-built_in">str</span>(myDSA.p).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;q = &#x27;</span> + <span class="hljs-built_in">str</span>(myDSA.q).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;g = &#x27;</span> + <span class="hljs-built_in">str</span>(myDSA.g).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;y = &#x27;</span> + <span class="hljs-built_in">str</span>(myDSA.y).encode())<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sth_in_the_middle</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(myDSA.k) == <span class="hljs-number">2</span>:<br>            middle_k0 = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">bin</span>(myDSA.k[<span class="hljs-number">0</span>])[<span class="hljs-number">2</span>:][<span class="hljs-number">30</span>:-<span class="hljs-number">30</span>], <span class="hljs-number">2</span>) &lt;&lt; <span class="hljs-number">30</span><br>            middle_k1 = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">bin</span>(myDSA.k[<span class="hljs-number">1</span>])[<span class="hljs-number">2</span>:][<span class="hljs-number">30</span>:-<span class="hljs-number">30</span>], <span class="hljs-number">2</span>) &lt;&lt; <span class="hljs-number">30</span><br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;middle_k0&#x27;</span> + <span class="hljs-built_in">str</span>(middle_k0).encode())<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;middle_k1&#x27;</span> + <span class="hljs-built_in">str</span>(middle_k1).encode())<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;The time has not come.&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        signal.alarm(<span class="hljs-number">60</span>)<br>        <span class="hljs-variable language_">self</span>.send(BANNER)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-variable language_">self</span>.proof_of_work():<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Oops,you are wrong. Bye~&#x27;</span>)<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>            <span class="hljs-variable language_">self</span>.send(MENU)<br>            option = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv(prompt=<span class="hljs-string">b&#x27;Give me your option:&#x27;</span>))<br>            <span class="hljs-keyword">if</span> option == <span class="hljs-number">1</span>:<br>                <span class="hljs-variable language_">self</span>.sign()<br>            <span class="hljs-keyword">elif</span> option == <span class="hljs-number">2</span>:<br>                <span class="hljs-variable language_">self</span>.verify()<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">elif</span> option == <span class="hljs-number">3</span>:<br>                <span class="hljs-variable language_">self</span>.get_public_key()<br>            <span class="hljs-keyword">elif</span> option == <span class="hljs-number">4</span>:<br>                <span class="hljs-variable language_">self</span>.sth_in_the_middle()<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-variable language_">self</span>.request.close()<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">5000</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;HOST:POST &quot;</span> + HOST + <span class="hljs-string">&quot;:&quot;</span> + <span class="hljs-built_in">str</span>(PORT))<br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆçœ‹ç€å¾ˆæ˜¾ç„¶ï¼Œå°±è¦ä» $k$ æ³„éœ²çš„æ¯”ç‰¹å…¥æ‰‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°çº¿æ€§å…³ç³»å¼ï¼š<br>$$<br>ks\equiv h+xr\pmod q<br>$$<br>ç”±äºæ˜¯ä¸¤æ¡æ¶ˆæ¯ï¼Œé‚£å°±æ˜¯ $k_1s_1-xr_1-h_1-u_1q&#x3D;0$ å’Œ $k_2s_2-xr_2-h_2-u_2q&#x3D;0$</p><p>å¯¹ä¸Šé¢çš„å¼å­ï¼ŒåŒºåˆ† $z&#x3D;k_H,y&#x3D;k_L$ å’Œ $k&#x3D;k_M$ï¼Œä¹Ÿå°±æ˜¯ï¼š<br>$$<br>2^az+k+y-xr-h-uq&#x3D;0<br>$$<br>æ³¨æ„åˆ° $k$ åœ¨è¢«å»æ‰ä½ $30$ ä½ä¹‹åï¼Œåˆé‡æ–°ä¹˜ä¸Šäº† $2^{30}$ï¼Œæ‰€ä»¥ä¸éœ€è¦ç³»æ•°ã€‚å°è¯•æ„é€ çº¿æ€§å…³ç³»ï¼š</p><p><img src="/2025/01/26/25Jan3/5.png" alt="5"></p><p>ç¡®å®šä¸€ä¸‹å¹³è¡¡ç³»æ•°ï¼š$z,y$ éƒ½æ˜¯ $30$ ä½ï¼Œ$x$ æ˜¯ $160$ ä½ï¼Œé‚£ä¹ˆ $B&#x3D;\mathrm{diag}(2^{130},2^{130},2^{130},2^{130},1,2^{800},2^{800},2^{160})$ ã€‚ä¸¤ä¸ª $2^{800}$ æ˜¯å› ä¸ºå¯¹åº”çš„ä½ç½®ä¸º $0$ï¼Œå› æ­¤ä¹˜ä¸Šä¸€ä¸ªå¤§æ•°å¯ä»¥å¤§åŠ›å‡ºå¥‡è¿¹ï¼ˆbushiï¼‰ï¼Œå¯¹ ä¸Šé¢çš„çŸ©é˜µä¹˜ä¸Š $B$ï¼ŒLLL åå†é™¤ä»¥ $B$ ï¼Œç„¶åæ‰¾æœ€åä¸‰ä¸ªæ•°å­—ä¸º $0,0,1$ çš„å‘é‡å°±æ˜¯ç›®æ ‡å‘é‡ã€‚</p><p>è¿™ä¹ˆåšäº†ä¸€ä¸‹ï¼Œçœ‹ç€æ¨å¯¼çš„å¼å­æ²¡æœ‰é—®é¢˜ï¼ŒLLLåé™¤ä»¥ $B$ æ²¡æœ‰å‡ºç°åˆ†æ•°ï¼Œè¯´æ˜æ•°é‡çº§æ˜¯å¯¹çš„ï¼Œä½†è§„çº¦å‡ºæ¥çš„å‘é‡çš„å‰ 4 ä¸ªåˆ†é‡éƒ½æ˜¯ $33\sim35$ ä½ï¼Œå’Œ $30$ ä½æœ‰æ‰€è·ç¦»ã€‚å› æ­¤ï¼Œé—®é¢˜åº”è¯¥æ˜¯å‡ºè‡ª $x$ è¿™é‡Œï¼Œè€ƒè™‘æ¶ˆæ‰ $x$ã€‚</p><p>æ¶ˆ $x$ å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>2^{a_1}s_1r_2z_1-2^{a_2}s_2r_1z_2+s_1r_2y_1-s_2r_1y_2+C-uq&#x3D;0<br>$$<br>å…¶ä¸­ $C&#x3D;k_1s_1r_2-h_1r_2-k_2s_2r_1+h_2r_1$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„å¼å­å°±ç®€åŒ–ï¼Œå¹¶ä¸” $(z_1,z_2,y_1,y_2)$ å‡ä¸º $30$ ä½ï¼Œå› æ­¤å¹³è¡¡ç³»æ•°ä¹Ÿå¯ä»¥å°ä¸€ç‚¹ï¼š</p><p><img src="/2025/01/26/25Jan3/6.png" alt="6"></p><p>è¿™æ ·åªéœ€è¦ç»™ç¬¬äº”åˆ—ä¹˜ $2^{30}$ï¼Œæœ€åä¸€åˆ—ä¹˜ $2^{800}$ å³å¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„ $z_1,z_2,y_1,y_2$ï¼Œæ¢å¤ $k$ çš„æ‰€æœ‰æ¯”ç‰¹ï¼Œç„¶åæ±‚å‡ºç§é’¥ $x$ å¹¶å¾—åˆ°æœ€ç»ˆçš„ç­¾åå°±OKäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>context.log_level = <span class="hljs-string">&#x27;sdebug&#x27;</span> <br>sh=remote(<span class="hljs-string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="hljs-number">25739</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;sha256(XXXX+&#x27;</span>)<br>s16=sh.recvuntil(<span class="hljs-string">b&#x27;)&#x27;</span>)[:-<span class="hljs-number">1</span>]<br>sh.recvuntil(<span class="hljs-string">b&#x27;==&#x27;</span>)<br>s64=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyzm</span>(<span class="hljs-params">s16,s64</span>):<br>table=<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> table:<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> table:<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> table:<br><span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> table:<br><span class="hljs-keyword">if</span>(sha256((i+j+k+l+s16).encode()).hexdigest()==s64):<br><span class="hljs-keyword">return</span> i+j+k+l<br><span class="hljs-built_in">print</span>(s16)<br><span class="hljs-built_in">print</span>(s64)<br>yzm=getyzm(s16.decode(),s64.decode())<br>sh.sendline(yzm.encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;s:&#x27;</span>)<br>r1,s1=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>sh.recvuntil(<span class="hljs-string">b&#x27;s:&#x27;</span>)<br>r2,s2=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-built_in">print</span>(r1,s1)<br><span class="hljs-built_in">print</span>(r2,s2)<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;3&#x27;</span>)<br>arr=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>arr.append(<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>)))<br>p,q,g,y=arr<br><span class="hljs-built_in">print</span>(p,q,g,y)<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;4&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;middle_k0&#x27;</span>)<br>k1m=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>sh.recvuntil(<span class="hljs-string">b&#x27;middle_k1&#x27;</span>)<br>k2m=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:040x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(k1m),<span class="hljs-string">&#x27;&#123;:040x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(k2m))<br>a1,a2=k1m.bit_length(),k2m.bit_length()<br>m1 = <span class="hljs-string">b&#x27;What you want to know&#x27;</span><br>m2 = <span class="hljs-string">b&#x27;My dear lone warrior&#x27;</span><br>h1=bytes_to_long(sha256(m1).digest())<br>h2=bytes_to_long(sha256(m2).digest())<br><br><br><br>Ax1=<span class="hljs-number">2</span>**a1*s1*r2%q<br>Ax2=(-<span class="hljs-number">2</span>**a2*s2*r1)%q<br>Ay1=s1*r2%q<br>Ay2=(-s2*r1)%q<br>C=(k1m*s1*r2-h1*r2-k2m*s2*r1+h2*r1)%q<br>K=<span class="hljs-number">2</span>**<span class="hljs-number">500</span><br>M=matrix([<br>[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,Ax1],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,Ax2],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,Ay1],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,Ay2],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-C],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,q],<br>])<br>B=diagonal_matrix([<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">30</span>,<span class="hljs-number">2</span>**<span class="hljs-number">500</span>])<br>M3L=(M*B).LLL()*(B**-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> vec <span class="hljs-keyword">in</span> M3L:<br><span class="hljs-keyword">if</span>(vec[-<span class="hljs-number">1</span>]==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">abs</span>(vec[-<span class="hljs-number">2</span>])==<span class="hljs-number">1</span>):<br><span class="hljs-keyword">break</span><br>z1,z2,y1,y2=(<span class="hljs-built_in">abs</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> vec[:<span class="hljs-number">4</span>])<br>k1=z1*<span class="hljs-number">2</span>**a1+k1m+y1<br>k2=z2*<span class="hljs-number">2</span>**a2+k2m+y2<br><br>x=(k1*s1-h1)*inverse(r1,q)%q<br>xchk=(k2*s2-h2)*inverse(r2,q)%q<br><span class="hljs-built_in">print</span>(x,xchk)<br><span class="hljs-keyword">assert</span> x==xchk<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">pow</span>(g,x,p)==y<br><br><br>msg=long_to_bytes(<span class="hljs-number">0x49276d2041646d696e2e492077616e7420666c61672e</span>)<br><br>h3=bytes_to_long(sha256(msg).digest())<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;e:&#x27;</span>)<br>sh.send(msg)<br><span class="hljs-comment">#k=1</span><br>sh.recvuntil(<span class="hljs-string">b&#x27;r:&#x27;</span>)<br>g1=g%p%q<br>sh.sendline(<span class="hljs-built_in">str</span>(g1).encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;s:&#x27;</span>)<br>sh.sendline(<span class="hljs-built_in">str</span>((h3+x*g1)%q).encode())<br><span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">600</span>))<br></code></pre></td></tr></table></figure><p>çªç„¶å‘ç°ï¼Œå‡ ä¸ªDSAç¿»æ¥è¦†å»å°±é‚£ä¸€ä¸ªçº¿æ€§å…³ç³»å¼ï¼Œæ„Ÿè§‰å¥½åƒå¼€å§‹å¥—è·¯åŒ–äº†ï¼ŒåŸºæœ¬éƒ½æ˜¯ç”¨è¿™ä¸ªå›ºå®šçš„çº¿æ€§å…³ç³»å¼LLLçš„ã€‚ã€‚ã€‚</p><h2 id="5-VNCTF2022-Are-You-Admin-1"><a href="#5-VNCTF2022-Are-You-Admin-1" class="headerlink" title="5.[VNCTF2022] Are You Admin 1"></a>5.[VNCTF2022] Are You Admin 1</h2><p>åˆæ˜¯ä¸€ä¸ªDSAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> secretkey,flag,ezmath_flag<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(secretkey)) == <span class="hljs-number">169</span><br><br>table = string.ascii_letters+string.digits<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">PseudoRandomNumbersGenerators</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,seed1,seed2</span>):<br>        <span class="hljs-variable language_">self</span>.state_a = seed1<br>        <span class="hljs-variable language_">self</span>.state_b = seed2<br>        <span class="hljs-variable language_">self</span>.a = getRandomNBitInteger(<span class="hljs-number">160</span>)<br>        <span class="hljs-variable language_">self</span>.b = getRandomNBitInteger(<span class="hljs-number">160</span>)<br>        <span class="hljs-variable language_">self</span>.c = getRandomNBitInteger(<span class="hljs-number">160</span>)<br>        <span class="hljs-variable language_">self</span>.M = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">512</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GetNext</span>(<span class="hljs-params">self</span>):<br>        ret = (<span class="hljs-variable language_">self</span>.state_a * <span class="hljs-variable language_">self</span>.a + <span class="hljs-variable language_">self</span>.state_b * <span class="hljs-variable language_">self</span>.b + <span class="hljs-variable language_">self</span>.c) % <span class="hljs-variable language_">self</span>.M<br>        <span class="hljs-variable language_">self</span>.state_a = <span class="hljs-variable language_">self</span>.state_b<br>        <span class="hljs-variable language_">self</span>.state_b = ret<br>        <span class="hljs-keyword">return</span> ret<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GetSomethingUseful</span>(<span class="hljs-params">self,admin</span>):<br>        <span class="hljs-keyword">if</span> admin == <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.a,<span class="hljs-variable language_">self</span>.b,<span class="hljs-variable language_">self</span>.c<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;You can&#x27;t get anything here!Get out!&quot;</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">choice</span>(<span class="hljs-params">self,<span class="hljs-built_in">input</span></span>):<br>        length = <span class="hljs-built_in">len</span>(<span class="hljs-built_in">input</span>)<br>        tmp = <span class="hljs-variable language_">self</span>.GetNext() % length<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">input</span>[tmp]<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DigitalSignatureAlgorithm</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,RANDOM</span>):<br>        <span class="hljs-variable language_">self</span>.p = <span class="hljs-number">8945295668911819059540208265461979177678201229057426412681001447446107919117765962027889488459965388254641301806100385155760254966914075104367813869235667</span><br>        <span class="hljs-variable language_">self</span>.q = <span class="hljs-number">4472647834455909529770104132730989588839100614528713206340500723723053959558882981013944744229982694127320650903050192577880127483457037552183906934617833</span><br>        <span class="hljs-variable language_">self</span>.g = <span class="hljs-number">3</span><br>        <span class="hljs-variable language_">self</span>.Random = RANDOM<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">verify</span>(<span class="hljs-params">self, m, y, sig</span>):<br>        r, s = sig<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> (<span class="hljs-number">1</span> &lt;= r &lt;= <span class="hljs-variable language_">self</span>.q - <span class="hljs-number">1</span>)) <span class="hljs-keyword">or</span> (<span class="hljs-keyword">not</span> (<span class="hljs-number">1</span> &lt;= s &lt;= <span class="hljs-variable language_">self</span>.q - <span class="hljs-number">1</span>)): <br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        z = bytes_to_long(sha256(m).digest())<br>        w = inverse(s, <span class="hljs-variable language_">self</span>.q)<br>        u1 = (z * w) % <span class="hljs-variable language_">self</span>.q<br>        u2 = (r * w) % <span class="hljs-variable language_">self</span>.q<br>        v = (<span class="hljs-built_in">pow</span>(<span class="hljs-variable language_">self</span>.g, u1, <span class="hljs-variable language_">self</span>.p) * <span class="hljs-built_in">pow</span>(y, u2, <span class="hljs-variable language_">self</span>.p)) % <span class="hljs-variable language_">self</span>.p % <span class="hljs-variable language_">self</span>.q<br>        <span class="hljs-keyword">return</span> r == v<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sign</span>(<span class="hljs-params">self, m , x</span>):<br>        z = bytes_to_long(sha256(m).digest())<br>        <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>            k = <span class="hljs-variable language_">self</span>.Random.GetNext() % <span class="hljs-variable language_">self</span>.q <br>            r = <span class="hljs-built_in">pow</span>(<span class="hljs-variable language_">self</span>.g , k, <span class="hljs-variable language_">self</span>.p) % <span class="hljs-variable language_">self</span>.q<br>            s = (inverse(k, <span class="hljs-variable language_">self</span>.q) * (z + x * r)) % <span class="hljs-variable language_">self</span>.q<br>            <span class="hljs-keyword">if</span> (s != <span class="hljs-number">0</span>) <span class="hljs-keyword">and</span> (r != <span class="hljs-number">0</span>) :<br>                <span class="hljs-keyword">return</span> (r, s)<br><br>RANDOM = PseudoRandomNumbersGenerators(getPrime(<span class="hljs-number">120</span>),getPrime(<span class="hljs-number">120</span>))<br>DSA = DigitalSignatureAlgorithm(RANDOM)<br>x = secretkey<br>y = <span class="hljs-built_in">pow</span>(DSA.g,x,DSA.p)<br><br>MENU = <span class="hljs-string">br&#x27;&#x27;&#x27;</span><br><span class="hljs-string">[S]ign.</span><br><span class="hljs-string">[V]erify(or get flag).</span><br><span class="hljs-string">[I]dentify.</span><br><span class="hljs-string">[E]xit.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;&#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self</span>):<br>        proof = (<span class="hljs-string">&#x27;&#x27;</span>.join([RANDOM.choice(table)<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)])).encode()<br>        sha = sha256(proof).hexdigest().encode()<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;[+] sha256(XXXX+&quot;</span> + proof[<span class="hljs-number">4</span>:] + <span class="hljs-string">b&quot;) == &quot;</span> + sha )<br>        XXXX = <span class="hljs-variable language_">self</span>.recv(prompt = <span class="hljs-string">b&#x27;[+] Plz Tell Me XXXX :&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(XXXX) != <span class="hljs-number">4</span> <span class="hljs-keyword">or</span> sha256(XXXX + proof[<span class="hljs-number">4</span>:]).hexdigest().encode() != sha:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sign</span>(<span class="hljs-params">self</span>):<br>        m0 = <span class="hljs-string">b&#x27;dawn&#x27;</span><br>        m1 = <span class="hljs-string">b&#x27;whisper&#x27;</span><br>        m2 = <span class="hljs-string">b&#x27;want flag&#x27;</span><br>        sign0 = DSA.sign(m0,x)<br>        sign1 = DSA.sign(m1,x)<br>        sign2 = DSA.sign(m2,x)<br><br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;sign of (dawn) is: &#x27;</span>      + <span class="hljs-built_in">str</span>(sign0).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;sign of (whisper) is: &#x27;</span>   + <span class="hljs-built_in">str</span>(sign1).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;sign of (want flag) is: &#x27;</span> + <span class="hljs-built_in">str</span>(sign2).encode())<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">identify</span>(<span class="hljs-params">self</span>):<br>        rec_key = <span class="hljs-variable language_">self</span>.recv(<span class="hljs-string">b&#x27;flag of ezmath is :&#x27;</span>)<br>        ret = RANDOM.GetSomethingUseful(rec_key == ezmath_flag)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">str</span>(ret).encode())<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">verify</span>(<span class="hljs-params">self</span>):<br>        msg = <span class="hljs-variable language_">self</span>.recv(<span class="hljs-string">b&#x27;msg:&#x27;</span>)<br>        r = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv(<span class="hljs-string">b&#x27;r:&#x27;</span>))<br>        s = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv(<span class="hljs-string">b&#x27;s:&#x27;</span>))<br>        sig = (r,s)<br>        <span class="hljs-keyword">if</span> msg == <span class="hljs-string">b&quot;I&#x27;m Admin.Plz give me flag!&quot;</span>:<br>            <span class="hljs-keyword">if</span> DSA.verify(msg,y,sig):<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Yes Sir!Thank you Sir!&#x27;</span>)<br>                <span class="hljs-keyword">return</span> flag<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Who are U?Get out!&#x27;</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> DSA.verify(msg,y,sig):<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Yeah!You sign successfully!&#x27;</span>)<br>                <span class="hljs-keyword">return</span> os.urandom(<span class="hljs-number">32</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        proof = <span class="hljs-variable language_">self</span>.proof_of_work()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> proof:<br>            <span class="hljs-variable language_">self</span>.request.close()<br>        signal.alarm(<span class="hljs-number">60</span>)<br>        chance = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>            <span class="hljs-variable language_">self</span>.send(MENU)<br>            option = <span class="hljs-variable language_">self</span>.recv(<span class="hljs-string">b&#x27;\n==plz give me your option==\n[IN]:&#x27;</span>)<br>            <span class="hljs-keyword">if</span> option == <span class="hljs-string">b&#x27;S&#x27;</span>:<br>                <span class="hljs-keyword">if</span> chance == <span class="hljs-number">0</span>:<br>                    <span class="hljs-variable language_">self</span>.sign()<br>                    chance += <span class="hljs-number">1</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;ERROR! You only have one time!&#x27;</span>)<br>            <span class="hljs-keyword">elif</span> option == <span class="hljs-string">b&#x27;V&#x27;</span>:<br>                ret = <span class="hljs-variable language_">self</span>.verify()<br>                <span class="hljs-keyword">if</span> ret :<br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;Your Flag is :&#x27;</span> + ret)<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">elif</span> option == <span class="hljs-string">b&#x27;I&#x27;</span>:<br>                <span class="hljs-variable language_">self</span>.identify()<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-variable language_">self</span>.request.close()<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">10004</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;HOST:POST &quot;</span> + HOST+<span class="hljs-string">&quot;:&quot;</span> + <span class="hljs-built_in">str</span>(PORT))<br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever() <br><br></code></pre></td></tr></table></figure><p>ä»é¢˜ç›®ä¸­å¯ä»¥å¾—åˆ°çš„ä¿¡æ¯ä¸ºï¼šç§é’¥ $x$ ä¸º $167$ æ¯”ç‰¹ï¼Œéšæœºæ•° $k$ ä¸º LCG ç”Ÿæˆï¼Œå…¶è¡¨è¾¾å¼ä¸º $x_2&#x3D;ax_0+bx_1+c$ï¼Œé¢˜ç›®ä¼šç»™å‡º $3$ æ¡å†…å®¹çš„ç­¾åç»“æœã€‚</p><p>ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒLCG çš„æ¨¡æ•°ä¸º $2^{512}$ï¼Œè€Œ $q$ ä¸º $511$ ä½ç´ æ•°ã€‚ $x_0,x_1$ ä¸¤ä¸ªç§å­å€¼ä¸º $120$ ä½ï¼Œ$a,b,c$ ç³»æ•°ä¸º $160$ ä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ†æå‡ºï¼š$k_0,k_1$ çš„æ•°é‡çº§åˆ†åˆ«ä¸º $2^{281},2^{441}$ ï¼Œè€Œ $k_2$ ç»è¿‡äº†å–æ¨¡ï¼Œå¹¶ä¸”ä½¿ç”¨æ—¶è¿˜ç»å†äº†ä¸¤æ¬¡å–æ¨¡ï¼Œå…ˆæ¨¡ $2^{512}$ å†æ¨¡ $q$ã€‚ä¸è¿‡å¥½åœ¨ï¼Œç”±äº $q$ æ˜¯ $511$ ä½ç´ æ•°ï¼Œè¿™å°±æ„å‘³ç€å¯¹ $2^{512}$ å–æ¨¡åï¼Œæœ€å¤šåªä¼šå‡å» $2$ ä¸ª $q$ã€‚</p><p>é¢˜ç›®ä¸­çš„ $a,b,c$ å…¶å®æ˜¯ç»™å‡ºçš„ï¼Œé‚£ä¸ªéªŒè¯çš„flagé¢˜ç›®ç»™å‡ºäº†ï¼Œå¯ä»¥å¿½ç•¥è¿™ä¸€éƒ¨åˆ†ã€‚</p><p>é‚£ä¹ˆåšäº†è¿™ä¹ˆå¤šDSAäº†ï¼Œé‡Œé¢çº¿æ€§å…³ç³»å¼ï¼Œè¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ï¼šæˆ‘ä»¬æœ‰ä¸‰ç»„ $k_is_i-xr_i-u_iq&#x3D;h_i$ï¼Œå…¶ä¸­ $i&#x3D;0,1,2$ ã€‚å’Œä¸€ç»„ $ak_0+bk_1+c-2^{512}u_3-u_4q&#x3D;0$ ã€‚å…¶ä¸­ $u_4$ å–å€¼ä¸º $0,1,2$ã€‚é‚£ä¹ˆå¯ä»¥æ„é€ ä¸€ä¸ª $9\times9$ çš„çº¿æ€§å…³ç³»çŸ©é˜µï¼Œä¹˜ä¸Šå¹³è¡¡ç³»æ•°ï¼Œå°±OKäº†ã€‚</p><p>ç„¶åLLLæ²¡å¾—åˆ°ä»»ä½•ç»“æœï¼Œè°ƒäº† $k_{0,1,2}$ çš„æ•°é‡çº§ä¹Ÿæ²¡å•¥ç”¨ã€‚ä½†çº¿æ€§å…³ç³»è‚¯å®šæ˜¯æ²¡é—®é¢˜çš„ï¼Œä¸€ä¸ªå¾ˆæ™®é€šçš„DSAï¼Œä½ è¿˜èƒ½æœ‰åˆ«çš„çº¿æ€§å…³ç³»å—ï¼Ÿ</p><p>å¡äº†3hï¼Œç„¶åçœ‹åˆ°äº†è¿™ä¸ªï¼š<a href="https://tanglee.top/2022/02/12/VNCTF2022-Crypto-WriteUp/">VNCTF2022 Crypto WriteUp | tl2cents blog (tanglee.top)</a>ï¼Œå‘ç°è¿™ä¸ªé¢˜è¦ç”¨CVPè§£ã€‚å› ä¸ºçº¿æ€§å…³ç³»å°±é‚£ä¹ˆä¸€ä¸ªï¼Œè§£ä¸å‡ºæ¥è¯´æ˜ç›®æ ‡å‘é‡å¹¶éçŸ­å‘é‡ï¼Œä½†å¦‚æœèƒ½å¤ŸæŠ“ä½ç›®æ ‡å‘é‡çš„æ˜¾è‘—ç‰¹å¾ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘CVPï¼Œå…¶æ„é€ çš„çŸ©é˜µæ˜¯è¿™æ ·çš„ï¼ˆLLLå‰éœ€è¦è½¬ç½®ä¸€ä¸‹ï¼Œå› ä¸ºSageæ˜¯è¡Œå‘é‡ï¼‰</p><p><img src="/2025/01/26/25Jan3/7.png" alt="7"></p><p>å¯ä»¥å‘ç°ä»–è¿™è¾¹çš„å¹³è¡¡ç³»æ•°å¾ˆæœ‰æ„æ€ï¼šæˆ‘ä»¬åˆšæ‰åˆ†æäº†ï¼Œä»–è¿™ä¸ª $n_5$ ç›¸å½“äºæˆ‘ä¸Šé¢çš„ $u_5$ï¼Œå…¶å–å€¼åªæœ‰ $0,1,2$ï¼Œæ•°é‡çº§ä¸º $2$ï¼Œè€Œ$x,k_0,k_1,k_2$ çš„æ•°é‡çº§åˆ†åˆ«ä¸º $2^{169},q,q,q$ï¼Œï¼ˆP.S. $x$ çš„æ•°é‡çº§ä¸º $2^{167}$ï¼‰ï¼Œå› æ­¤è¿™æ ·å¹³è¡¡ä¹‹åï¼Œå…¶ä»–çš„æ•°å€¼å°±åŸºæœ¬ä¸º $1$ äº†ã€‚</p><p>æ­¤å¤–ï¼ŒLLLä¹‹åï¼Œå‘é‡ä¹‹é—´æœ‰ä¸é”™çš„æ­£äº¤æ€§ï¼Œå› æ­¤CVPå¯ä»¥é€šè¿‡ç®€å•çš„èˆå…¥æ³•å»è°ƒæ•´ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡ºæ ¼ä¸­è·ç¦» $(h_0,h_1,h_2,-c,1,1,1,1,1)$ æœ€è¿‘çš„å‘é‡å°±OKäº†ï¼Œå¾—åˆ°çš„å‘é‡ä¸­å¯èƒ½æœ‰ç§é’¥ $x$ã€‚</p><p>æœ¬åœ°æµ‹äº†ä¸€æ³¢ï¼Œæµ‹è¯•ä½¿ç”¨çš„ç§é’¥ä¸ºï¼š<br>$$<br>x&#x3D;174847216550444586801265996907385021425341123437671<br>$$<br>è¿™æ˜¯ä¸€ä¸ªç´ æ•°ã€‚å¦‚æœLLLèƒ½å¤Ÿç›´æ¥å¾—åˆ°ç§é’¥ï¼Œé‚£ä¹ˆæ ¹æ®ç´ æ•°çš„æ€§è´¨å’ŒSageä¸­åŸºæœ¬éƒ½ç”¨åˆ†æ•°è¡¨ç¤ºçš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨LLLåï¼Œåœ¨çŸ©é˜µä¸­ç›´æ¥å¾—åˆ°ç§é’¥ $x$ï¼Œä½†æµ‹è¯•åå‘ç°ï¼ŒLLLçš„ç»“æœæ‰¾ä¸åˆ°ç§é’¥ $x$ã€‚</p><p><img src="/2025/01/26/25Jan3/8.png" alt="8"></p><p>è€Œæ±‚CVPçš„å‡½æ•°ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯å†æ¥ä¸€æ¬¡æ–½å¯†ç‰¹æ­£äº¤åŒ–ï¼Œå¯¹äºç›®æ ‡å‘é‡ $\vec w$ å’Œæ ¼ä¸­å‘é‡ $\vec g$ï¼Œæ¯æ¬¡å¯¹ $\vec w$ å‡å» $\left\lfloor\dfrac{\vec w\cdot \vec g}{\vec g^2}\right\rceil \vec g$ å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">BabaisClosestPlaneAlgorithm</span>(<span class="hljs-params">L, w</span>):<br>    G, _ = L.gram_schmidt()<br>    t = w<br>    i = L.nrows() - <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> i &gt;= <span class="hljs-number">0</span>:<br>        w -= <span class="hljs-built_in">round</span>((w*G[i]) / G[i].norm() ** <span class="hljs-number">2</span>) * L[i]<br>        i -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> t - w<br></code></pre></td></tr></table></figure><p>åœ¨å¾—åˆ°è¿™ä¸ªä¹‹åï¼Œé‚£ä¹ˆæœ€åè§£é¢˜ä¹Ÿå°±ä¸éš¾äº†ï¼Œæ„Ÿè§‰è¿™ä¸ªé¢˜éš¾ç‚¹å°±æ˜¯CVPï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>sh=remote(<span class="hljs-string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="hljs-number">25626</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;sha256(XXXX+&#x27;</span>)<br>s16=sh.recvuntil(<span class="hljs-string">b&#x27;)&#x27;</span>)[:-<span class="hljs-number">1</span>]<br>sh.recvuntil(<span class="hljs-string">b&#x27;==&#x27;</span>)<br>s64=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyzm</span>(<span class="hljs-params">s16,s64</span>):<br>table=<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> table:<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> table:<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> table:<br><span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> table:<br><span class="hljs-keyword">if</span>(sha256((i+j+k+l+s16).encode()).hexdigest()==s64):<br><span class="hljs-keyword">return</span> i+j+k+l<br><span class="hljs-built_in">print</span>(s16)<br><span class="hljs-built_in">print</span>(s64)<br>yzm=getyzm(s16.decode(),s64.decode())<br>sh.sendline(yzm.encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;[IN]:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;I&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;vnctf&#123;m4th_5tr#c7Ur3_c4n_b3_e@s&amp;!&#125;&#x27;</span>)<br>a,b,c=<span class="hljs-built_in">eval</span>(sh.recvline())<br>sh.recvuntil(<span class="hljs-string">b&#x27;[IN]:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;S&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;is:&#x27;</span>)<br>r1,s1=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>).strip())<br>sh.recvuntil(<span class="hljs-string">b&#x27;is:&#x27;</span>)<br>r2,s2=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>).strip())<br>sh.recvuntil(<span class="hljs-string">b&#x27;is:&#x27;</span>)<br>r3,s3=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>).strip())<br>q=<span class="hljs-number">4472647834455909529770104132730989588839100614528713206340500723723053959558882981013944744229982694127320650903050192577880127483457037552183906934617833</span><br>m1 = <span class="hljs-string">b&#x27;dawn&#x27;</span><br>m2 = <span class="hljs-string">b&#x27;whisper&#x27;</span><br>m3 = <span class="hljs-string">b&#x27;want flag&#x27;</span><br>h1,h2,h3=[bytes_to_long(sha256(i).digest()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [m1,m2,m3]]<br><span class="hljs-built_in">print</span>(h1,h2,h3)<br>M = matrix(<br>    [<br>        [-r1, s1,  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,  q, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>],<br>        [-r2,  <span class="hljs-number">0</span>, s2,  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>, q, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>],<br>        [-r3,  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,  s3,  <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, q, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>],<br>        [<span class="hljs-number">0</span>,  a,  b,  -<span class="hljs-number">1</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>**<span class="hljs-number">512</span>,q],<br>        [Rational(<span class="hljs-string">f&#x27;2/<span class="hljs-subst">&#123;<span class="hljs-number">2</span>**<span class="hljs-number">169</span>&#125;</span>&#x27;</span>),  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>],<br>        [<span class="hljs-number">0</span>, Rational(<span class="hljs-string">f&#x27;2/<span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>),  <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>],<br>        [<span class="hljs-number">0</span>,  <span class="hljs-number">0</span>, Rational(<span class="hljs-string">f&#x27;2/<span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>),   <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>],<br>        [<span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>, Rational(<span class="hljs-string">f&#x27;2/<span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>),  <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>],<br>        [<span class="hljs-number">0</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<span class="hljs-number">1</span>]<br>    ]).T<br><br><br>M=matrix(M)<br>M3L=M.LLL()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">BabaisClosestPlaneAlgorithm</span>(<span class="hljs-params">L, w</span>):<br>    G, _ = L.gram_schmidt()<br>    t = w<br>    i = L.nrows() - <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> i &gt;= <span class="hljs-number">0</span>:<br>        w -= <span class="hljs-built_in">round</span>((w*G[i]) / G[i].norm() ** <span class="hljs-number">2</span>) * L[i]<br>        i -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> t - w<br><br><br>C = vector([h1, h2, h3, -c, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>,<span class="hljs-number">1</span>])  <span class="hljs-comment"># target vector</span><br>A = BabaisClosestPlaneAlgorithm(M3L, C)<br><span class="hljs-built_in">print</span>(A)<br>x = A[<span class="hljs-number">4</span>] / Rational(<span class="hljs-string">f&#x27;2/<span class="hljs-subst">&#123;<span class="hljs-number">2</span>**<span class="hljs-number">169</span>&#125;</span>&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(x)<br>g=<span class="hljs-number">3</span><br>k=<span class="hljs-number">1</span><br>r=g<br>msg=<span class="hljs-string">b&quot;I&#x27;m Admin.Plz give me flag!&quot;</span><br>h=bytes_to_long(sha256(msg).digest())<br>s=((h + x * r))% q<br>sh.recvuntil(<span class="hljs-string">b&#x27;[IN]:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;V&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;msg:&#x27;</span>)<br>sh.sendline(msg)<br>sh.recvuntil(<span class="hljs-string">b&#x27;r:&#x27;</span>)<br>sh.sendline(<span class="hljs-built_in">str</span>(r).encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;s:&#x27;</span>)<br>sh.sendline(<span class="hljs-built_in">str</span>(s).encode())<br><span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">500</span>))<br><span class="hljs-comment">#print(s)</span><br><span class="hljs-comment">#print(M3L)</span><br><span class="hljs-comment">#sh.interactive()</span><br></code></pre></td></tr></table></figure><h2 id="6-VNCTF2022-crypto-sign-in-4"><a href="#6-VNCTF2022-crypto-sign-in-4" class="headerlink" title="6.[VNCTF2022] crypto_sign_in_4"></a>6.[VNCTF2022] crypto_sign_in_4</h2><p>å…ˆçœ‹ä¸€çœ¼é¢˜ç›®ï¼š</p><p>é¢˜ç›®ç»™å‡ºäº†ç´ æ•° $p$ï¼Œå…¶ä¸­ $2$ åœ¨ $\mathbb F_p$ çš„é˜¶ä¸ºç´ æ•°ï¼Œç„¶åé¢˜ç›®å…è®¸ä½ é€‰æ‹©ä¸€ä¸ª $m$ï¼Œç„¶åå›ç»™ä½ è¿”å› $c_1&#x3D;2^x$ å’Œ $c_2&#x3D;2^{mx}$ï¼Œå…¶ä¸­ $x$ æœªçŸ¥ã€‚ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> getrandbits<br><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> *<br>welcome=<span class="hljs-string">&quot;Welcome to VNCTF 2023!Hope you can enjoy this challenge!&quot;</span><br>description=<span class="hljs-string">&#x27;&#x27;&#x27;These days DengFeng want to provide a surprise for Deebato.\n</span><br><span class="hljs-string">So he come up with an idea...\n</span><br><span class="hljs-string">That is...\n</span><br><span class="hljs-string">Designing a DLP!\n</span><br><span class="hljs-string">Namely Deebato Love Problem!&#x27;&#x27;&#x27;</span><br>begin=<span class="hljs-string">&#x27;&#x27;&#x27;So let&#x27;s go!\n</span><br><span class="hljs-string">In 1997, I learned to drive a car...\n&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>():<br>    <span class="hljs-built_in">print</span>(welcome)<br>    <span class="hljs-built_in">print</span>(description)<br>    <span class="hljs-built_in">print</span>(begin)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen</span>():<br>    a=<span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p=getPrime(<span class="hljs-number">90</span>)<br>        order=GF(p)(a).multiplicative_order()<br>        <span class="hljs-keyword">if</span> isPrime(<span class="hljs-built_in">int</span>(order)):<br>            <span class="hljs-keyword">return</span> a,p,order<br>            <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_msg</span>(<span class="hljs-params">m,a,p,order</span>):<br>    secret=getrandbits(<span class="hljs-number">85</span>)<br>    c1=<span class="hljs-built_in">pow</span>(a,secret,p)<br>    c2=<span class="hljs-built_in">pow</span>(a,<span class="hljs-built_in">pow</span>(secret,m,order),p)<br>    <span class="hljs-keyword">return</span> secret,c1,c2<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    alarm(<span class="hljs-number">300</span>)<br>    hello()<br>    a,p,order=gen()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;OOOOOOh!I will give you something useful!&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;a = <span class="hljs-subst">&#123;a&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br>    m=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Please give me your choice:&quot;</span>))<br>    secret,c1,c2=get_msg(m,a,p,order)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;OK,here is my gift.&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c1 = <span class="hljs-subst">&#123;c1&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c2 = <span class="hljs-subst">&#123;c2&#125;</span>&quot;</span>)<br>    ticket=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Please give me the secret:&quot;</span>))<br>    <span class="hljs-keyword">if</span> ticket==secret:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;OKOK,it seems that you know Deebato Love Problem well.Here is my flag&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;flag&#123;&#x27;</span>+<span class="hljs-built_in">str</span>(uuid4())+<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Sorry!You don&#x27;t understand Deebato Love Problem not at all!I can&#x27;t give you flag!&quot;</span>)<br><br><br><span class="hljs-keyword">try</span>:<br>    main()<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error : <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®è¿˜ç»™å‡ºäº†æç¤ºï¼š</p><blockquote><p>Hint1: cheon discrete log attack</p></blockquote><p>æ ¹æ®å…³é”®è¯ Google äº†ä¸€åœˆï¼Œå‘ç° eprint ä¸Šç¼–å·ä¸º 2008-300 çš„è®ºæ–‡ç»™å‡ºäº†ç®—æ³•ï¼š</p><p><img src="/2025/01/26/25Jan3/11.png" alt="11"></p><p>ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¿™é‡Œ $P$ æ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ï¼Œè€Œæˆ‘ä»¬è¿™è¾¹æ˜¯ä¹˜æ³•ç¾¤ä¸Šçš„è¿ç®—ï¼Œå› æ­¤ $\alpha P$ åº”è¯¥å†™ä¸º $2^\alpha$ï¼Œç„¶å $p$ åœ¨ç®—æ³•ä¸­è¡¨ç¤ºçš„æ˜¯ $P$ çš„é˜¶æ•°ï¼Œä½†é¢˜ç›®ä¸­ $p$ æ˜¯æ¨¡æ•°ï¼Œ$2$ åœ¨ $\mathbb F_p$ ä¸Šçš„é˜¶ä¸ºç´ æ•°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬è®¾ $2$ åœ¨ $\mathbb F_p$ ä¸Šçš„é˜¶ä¸º $q$ã€‚</p><p>é‚£ä¹ˆåœ¨å®é™…ç¼–ç¨‹çš„æ—¶å€™ï¼Œ ä¸Šé¢æ‰€æœ‰çš„ $p$ éƒ½è¦æ¢æˆ $q$ï¼Œ$P$ æ¢æˆ $2$ï¼Œ$P_1,P_2$ å¯¹åº” $c_1,c_2$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ $\mathbb F_q$ ä¸Šæ‰¾åˆ°åŸæ ¹ $g$ï¼Œä¸”å°† $q-1$ å°½å¯èƒ½åœ°åˆ†è§£æˆä¸¤ä¸ªè¿‘ä¼¼ç›¸ç­‰çš„æ•°å€¼ï¼ˆä¸ä¸€å®šæ˜¯ç´ æ•°ï¼‰ï¼Œå…¶ä¸­ä¸€ä¸ªä½œä¸º $d$ï¼Œç”¨äºBSGSã€‚ $p$ æ˜¯ $90$ ä½ï¼Œ$q$ å¯èƒ½ç•¥ä½äº $90$ ä½ï¼Œé‚£ä¹ˆè¿™æ ·ç®—ä¸‹æ¥ï¼Œå¤æ‚åº¦å¤§æ¦‚å°±åœ¨ $2^{22}$ å·¦å³äº†ï¼Œé¢˜ç›®çš„é™æ—¶ä¸º 5 åˆ†é’Ÿï¼ŒåŸºæœ¬å¯ä»¥æ¥å—ã€‚</p><p>å¹¶ä¸”ï¼Œ$q$ é•¿åº¦ä¸è¶…è¿‡ $90$ æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é«˜æ•ˆå¯¹ $q -1$ åˆ†è§£æ¥è·å– $d$ï¼Œä»¥åŠå¯»æ‰¾ $q$ çš„åŸæ ¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">findd</span>(<span class="hljs-params">x</span>):<br>    L=[]<br>    fcp=<span class="hljs-built_in">list</span>(factor(x-<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">for</span> u,v <span class="hljs-keyword">in</span> fcp:<br>        L=L+v*[u]<br>    xbits=x.nbits()<br>    bound=xbits&gt;&gt;<span class="hljs-number">1</span><br>    d=Integer(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> L:<br>        dbits=d.nbits()<br>        dibits=(d*i).nbits()<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(dbits-bound)&lt;<span class="hljs-built_in">abs</span>(dibits-bound)):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;factor 1: of <span class="hljs-subst">&#123;dbits&#125;</span>/<span class="hljs-subst">&#123;xbits&#125;</span> bits:<span class="hljs-subst">&#123;d&#125;</span>&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;factor 2: of <span class="hljs-subst">&#123;((x-<span class="hljs-number">1</span>)//d).nbits()&#125;</span>/<span class="hljs-subst">&#123;xbits&#125;</span> bits:<span class="hljs-subst">&#123;(x-<span class="hljs-number">1</span>)//d&#125;</span>&#x27;</span>)<br>            <span class="hljs-keyword">return</span> d,(x-<span class="hljs-number">1</span>)//d,dbits,((x-<span class="hljs-number">1</span>)//d).nbits()<br>        <span class="hljs-keyword">else</span>:<br>            d=d*i<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">findgen</span>(<span class="hljs-params">prime</span>):<br>    <span class="hljs-keyword">assert</span> isPrime(prime)<br>    g=<span class="hljs-number">1</span><br>    fcp=<span class="hljs-built_in">list</span>(factor(prime-<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>        g=g+<span class="hljs-number">1</span><br>        res=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">for</span> x,_ <span class="hljs-keyword">in</span> fcp:<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">pow</span>(g,(prime-<span class="hljs-number">1</span>)//x,prime)==<span class="hljs-number">1</span>):<br>                res=<span class="hljs-literal">False</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span>(res==<span class="hljs-literal">True</span>):<br>            <span class="hljs-keyword">return</span> g<br>sh.recvuntil(<span class="hljs-string">b&#x27;a =&#x27;</span>)<br>a=<span class="hljs-built_in">eval</span>(sh.recvline())<br>sh.recvuntil(<span class="hljs-string">b&#x27;p =&#x27;</span>)<br>p=<span class="hljs-built_in">eval</span>(sh.recvline())<br><span class="hljs-built_in">print</span>(a,p)<br>q=GF(p)(a).multiplicative_order()<br>d,_,bits1,bits2=findd(q)<br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">max</span>(bits1,bits2)&gt;<span class="hljs-number">47</span>):<br>    sh.close()<br>    <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f&quot;Find bits <span class="hljs-subst">&#123;<span class="hljs-built_in">max</span>(bits1,bits2)&#125;</span> that exceed 47!&quot;</span>)<br>g0=findgen(q)<br></code></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯ä¸¤ä¸ª BSGS äº†ï¼Œæ³¨æ„ BSGS å­˜å…¥å­—å…¸çš„æ–¹å¼ï¼Œåˆ«å­˜å€’äº†å°±OKï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#BSGS1</span><br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>D=<span class="hljs-built_in">dict</span>()<br>ginv=<span class="hljs-built_in">pow</span>(g,q-<span class="hljs-number">2</span>,q)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(d1)):<br>    u=i<br>    v=<span class="hljs-built_in">pow</span>(c2,<span class="hljs-built_in">pow</span>(ginv,i,q),p)<br>    D[v]=u<br>u1,v1=<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(d1)):<br>    v=<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,<span class="hljs-built_in">pow</span>(g,d1*i,q),p)<br>    <span class="hljs-keyword">if</span>(D.get(v,<span class="hljs-literal">None</span>)):<br>        u1,v1=D.get(v,<span class="hljs-literal">None</span>),i<br>        <span class="hljs-built_in">print</span>(u1,v1)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-comment">#BSGS2</span><br>k0=d1*v1+u1<br>d2=<span class="hljs-built_in">int</span>(<span class="hljs-number">1</span>+sqrt(d).n())<br>D=<span class="hljs-built_in">dict</span>()<br>g0inv=<span class="hljs-built_in">pow</span>(g0,q-<span class="hljs-number">2</span>,q)<br>p1divd=(p-<span class="hljs-number">1</span>)//d<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(d2)):<br>    u=i<br>    v=<span class="hljs-built_in">pow</span>(c1,<span class="hljs-built_in">pow</span>(g0inv,u*p1divd,q),p)<br>    D[v]=u<br>u2,v2=<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(d2)):<br>    v=<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,<span class="hljs-built_in">pow</span>(g0,k0+d2*i*p1divd,q),p)<br>    <span class="hljs-keyword">if</span>(D.get(v,<span class="hljs-literal">None</span>)):<br>        u2,v2=D.get(v,<span class="hljs-literal">None</span>),i<br>        <span class="hljs-built_in">print</span>(u2,v2)<br>        <span class="hljs-keyword">break</span><br>ans=<span class="hljs-built_in">pow</span>(g0,k0+(d2*v2+u2)*p1divd,q)<br></code></pre></td></tr></table></figure><p>ç”±äºè¿œç¨‹ç¯å¢ƒGäº†ï¼Œé‚£ä¹ˆå°±æœ¬åœ°æµ‹ä¸€ä¸‹ï¼Œè¿™é‡Œå¯ä»¥å¤šæ¬¡å°è¯•ï¼Œç¡®ä¿ $q-1$ è¢«å‡åŒ€åˆ†è§£ï¼Œå¦‚æœåšä¸åˆ°å¯ä»¥é‡è¿æ¢ä¸€ç»„æ•°æ®ã€‚ </p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥å¤šæ¬¡è‡ªåŠ¨é‡è¿ï¼Œç›´åˆ°æˆåŠŸå†ç»“æŸç¨‹åºï¼Œå¹³å‡ä¸‹æ¥ï¼Œå¤§æ¦‚å°è¯• 20 æ¬¡èƒ½æœ‰ä¸€æ¬¡æˆåŠŸï¼ˆä¸çŸ¥ä¸ºå•¥ï¼Œå‘ç°æœ‰çš„æ—¶å€™åœ¨æœ€åä¸€æ­¥ä¹Ÿä¸ä¸€å®šæˆåŠŸï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#context.log_level = &#x27;debug&#x27; </span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">findd</span>(<span class="hljs-params">x</span>):<br>    L=[]<br>    fcp=<span class="hljs-built_in">list</span>(factor(x-<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">for</span> u,v <span class="hljs-keyword">in</span> fcp:<br>        L=L+v*[u]<br>    xbits=x.nbits()<br>    bound=xbits&gt;&gt;<span class="hljs-number">1</span><br>    d=Integer(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> L:<br>        dbits=d.nbits()<br>        dibits=(d*i).nbits()<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(dbits-bound)&lt;<span class="hljs-built_in">abs</span>(dibits-bound)):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;factor 1: of <span class="hljs-subst">&#123;dbits&#125;</span>/<span class="hljs-subst">&#123;xbits&#125;</span> bits:<span class="hljs-subst">&#123;d&#125;</span>&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;factor 2: of <span class="hljs-subst">&#123;((x-<span class="hljs-number">1</span>)//d).nbits()&#125;</span>/<span class="hljs-subst">&#123;xbits&#125;</span> bits:<span class="hljs-subst">&#123;(x-<span class="hljs-number">1</span>)//d&#125;</span>&#x27;</span>)<br>            <span class="hljs-keyword">return</span> d,(x-<span class="hljs-number">1</span>)//d,dbits,((x-<span class="hljs-number">1</span>)//d).nbits()<br>        <span class="hljs-keyword">else</span>:<br>            d=d*i<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">findgen</span>(<span class="hljs-params">prime</span>):<br>    <span class="hljs-keyword">assert</span> isPrime(prime)<br>    g=<span class="hljs-number">1</span><br>    fcp=<span class="hljs-built_in">list</span>(factor(prime-<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>        g=g+<span class="hljs-number">1</span><br>        res=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">for</span> x,_ <span class="hljs-keyword">in</span> fcp:<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">pow</span>(g,(prime-<span class="hljs-number">1</span>)//x,prime)==<span class="hljs-number">1</span>):<br>                res=<span class="hljs-literal">False</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span>(res==<span class="hljs-literal">True</span>):<br>            <span class="hljs-keyword">return</span> g<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">sh</span>):<br>    <br>    sh.recvuntil(<span class="hljs-string">b&#x27;a =&#x27;</span>)<br>    a=<span class="hljs-built_in">eval</span>(sh.recvline())<br>    sh.recvuntil(<span class="hljs-string">b&#x27;p =&#x27;</span>)<br>    p=<span class="hljs-built_in">eval</span>(sh.recvline())<br>    <span class="hljs-built_in">print</span>(a,p)<br>    q=GF(p)(a).multiplicative_order()<br>    <br>            <br>    d,_,bits1,bits2=findd(q)<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">max</span>(bits1,bits2)&gt;=<span class="hljs-number">47</span>):<br>        sh.close()<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f&quot;Find bits <span class="hljs-subst">&#123;<span class="hljs-built_in">max</span>(bits1,bits2)&#125;</span> that exceed 47!&quot;</span>)<br>    sh.recvuntil(<span class="hljs-string">b&#x27;ce:&#x27;</span>)<br>    sh.sendline(<span class="hljs-built_in">str</span>(d).encode())<br>    sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    c1=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>    c2=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    <span class="hljs-built_in">print</span>(c1,c2)<br>    g0=findgen(q)<br>    g=<span class="hljs-built_in">pow</span>(g0,d,q)<br>    d1=(sqrt((q-<span class="hljs-number">1</span>)/d))<br>    d1=<span class="hljs-built_in">int</span>(d1.n()+<span class="hljs-number">0.5</span>)<br>    <span class="hljs-comment">#---------BSGS1---------</span><br>    D=<span class="hljs-built_in">dict</span>()<br>    ginv=<span class="hljs-built_in">pow</span>(g,q-<span class="hljs-number">2</span>,q)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(d1)):<br>        u=i<br>        v=<span class="hljs-built_in">pow</span>(c2,<span class="hljs-built_in">pow</span>(ginv,i,q),p)<br>        D[v]=u<br>    u1,v1=<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(d1)):<br>        v=<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,<span class="hljs-built_in">pow</span>(g,d1*i,q),p)<br>        <span class="hljs-keyword">if</span>(D.get(v,<span class="hljs-literal">None</span>)):<br>            u1,v1=D.get(v,<span class="hljs-literal">None</span>),i<br>            <span class="hljs-built_in">print</span>(u1,v1)<br>            <span class="hljs-keyword">break</span><br>    k0=d1*v1+u1<br>    d2=<span class="hljs-built_in">int</span>(<span class="hljs-number">1</span>+sqrt(d).n())<br>    D=<span class="hljs-built_in">dict</span>()<br>    g0inv=<span class="hljs-built_in">pow</span>(g0,q-<span class="hljs-number">2</span>,q)<br>    p1divd=(p-<span class="hljs-number">1</span>)//d<br>    <span class="hljs-comment">#---------BSGS2---------</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(d2)):<br>        u=i<br>        v=<span class="hljs-built_in">pow</span>(c1,<span class="hljs-built_in">pow</span>(g0inv,u*p1divd,q),p)<br>        D[v]=u<br>    u2,v2=<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(d2)):<br>        v=<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,<span class="hljs-built_in">pow</span>(g0,k0+d2*i*p1divd,q),p)<br>        <span class="hljs-keyword">if</span>(D.get(v,<span class="hljs-literal">None</span>)):<br>            u2,v2=D.get(v,<span class="hljs-literal">None</span>),i<br>            <span class="hljs-built_in">print</span>(u2,v2)<br>            <span class="hljs-keyword">break</span><br>    ans=<span class="hljs-built_in">pow</span>(g0,k0+(d2*v2+u2)*p1divd,q)<br>    <br>    sh.sendline(<span class="hljs-built_in">str</span>(ans).encode())<br>    <span class="hljs-built_in">print</span>(sh.recvall(timeout=<span class="hljs-number">600</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run2</span>():<br>    sh=<span class="hljs-literal">None</span><br>    <span class="hljs-keyword">try</span>:<br>        sh=process([<span class="hljs-string">&#x27;sage&#x27;</span>,<span class="hljs-string">&#x27;task9.sage&#x27;</span>])<br>        run(sh)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">except</span>:<br>        sh.close()<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>Tim=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>    Tim+=<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Running on <span class="hljs-subst">&#123;Tim&#125;</span>th time&#x27;</span>)<br>    <span class="hljs-keyword">if</span>(run2()):<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p><img src="/2025/01/26/25Jan3/10.png" alt="10"></p><p>è¿™ç§è®ºæ–‡é¢˜ï¼Œæ„Ÿè§‰ä¸»è¦è¿˜æ˜¯è®ºæ–‡å®ç°ã€‚</p><h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9.æ€»ç»“"></a>9.æ€»ç»“</h2><p>BUUç»§ç»­ä¸Šåˆ†ingï¼Œå½“å¹´è‡ªå·±æœ€é«˜å¥½åƒæ˜¯CryptoåŒºç¬¬ 6 æ¥ç€ï¼Ÿç„¶åä¸¤å¹´æ²¡æ‰“ï¼Œè·Œåˆ°äº† 35ï¼Œå¯’å‡æ‰é‡æ–°å›æ¥ç»§ç»­æ‰“ï¼Œä¸Šåˆ°äº† 15 åï¼</p><p>xsï¼Œè¿™æ—¶é—´è·¨åº¦ï¼Œä¹Ÿæ²¡è°äº†</p><p><img src="/2025/01/26/25Jan3/13.png" alt="13"></p><p>è¿˜æœ‰ï¼ŒExplore MT19937 ç»è¿‡ 3 å¹´åŠï¼Œæ›´æ–°äº†ä¸€äº›å†…å®¹ï¼Œè¡¥å……äº†ä»»æ„ 19937 ä¸ªæ¯”ç‰¹çš„æƒ…å†µï¼Œå…·ä½“è¯·è®¿é—®é‚£ç¯‡åšæ–‡å†…å®¹ã€‚</p><p><img src="/2025/01/26/25Jan3/14.png" alt="14"></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>25Jan2</title>
    <link href="/2025/01/15/25Jan2/"/>
    <url>/2025/01/15/25Jan2/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-1æœˆçš„åˆ‡é¢˜2"><a href="#huangx607087-1æœˆçš„åˆ‡é¢˜2" class="headerlink" title="huangx607087 1æœˆçš„åˆ‡é¢˜2"></a>huangx607087 1æœˆçš„åˆ‡é¢˜2</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>æ˜¯æ—¶å€™è¡¥ä¸€ä¸‹æœ€è¿‘é”™è¿‡çš„é¢˜äº†ã€‚</p><p>å†™å®ŒNTRUé‚£ä¸ªç¬”è®°ï¼Œå’Œå¤–é¢çš„å¸ˆå‚…ä»¬è®¨è®ºäº†ä¸€ä¸‹SUCTFçš„å‡ ä¸ªé¢˜ï¼Œé¡ºä¾¿è¡¥äº†ä¸¤ä¸ªSCTFçš„é¢˜ç›®ã€‚å› ä¸ºæ˜¯å’Œå¤–é¢å¸ˆå‚…ä¸€èµ·è®¨è®ºåšçš„é¢˜ï¼Œå°±å½“ç©ç©ï¼Œæ‰€ä»¥æ²¡æœ‰äº¤flagï¼ˆå½“ç„¶ï¼Œæ­£å¼æ¯”èµ›ï¼Œè‚¯å®šè¿˜æ˜¯å¾—è‡ªå·±åšçš„ï¼ï¼‰ã€‚</p><h2 id="1-SUCTF2025-SU-Signin"><a href="#1-SUCTF2025-SU-Signin" class="headerlink" title="1.[SUCTF2025] SU_Signin"></a>1.[SUCTF2025] SU_Signin</h2><p>å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>bit_length = <span class="hljs-built_in">len</span>(flag) * <span class="hljs-number">8</span><br><br>p = <span class="hljs-number">0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab</span><br>K = GF(p)<br>E = EllipticCurve(K, (<span class="hljs-number">0</span>, <span class="hljs-number">4</span>))<br>o = <span class="hljs-number">793479390729215512516507951283169066088130679960393952059283337873017453583023682367384822284289</span><br>n1, n2 = <span class="hljs-number">859267</span>, <span class="hljs-number">52437899</span><br><br><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>    G1, G2 = E.random_element(), E.random_element()<br>    <span class="hljs-keyword">if</span>(G1.order() == o <span class="hljs-keyword">and</span> G2.order() == o):<br>        P1, P2 = (o//n1)*G1, (o//n2)*G2<br>        <span class="hljs-keyword">break</span><br><br>cs = [(randrange(<span class="hljs-number">0</span>, o) * P1 + randrange(<span class="hljs-number">0</span>, o) * G2).xy() <span class="hljs-keyword">if</span> i == <span class="hljs-string">&quot;1&quot;</span> <span class="hljs-keyword">else</span> (randrange(<span class="hljs-number">0</span>, o) * G1 + randrange(<span class="hljs-number">0</span>, o) * P2).xy() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(bytes_to_long(flag))[<span class="hljs-number">2</span>:].zfill(bit_length)]<br><span class="hljs-built_in">print</span>(cs)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªæ¤­åœ†æ›²çº¿ $y^2\equiv x^3+4 \pmod p$ï¼Œåœ¨æ¤­åœ†æ›²çº¿ä¸Šæ‰¾åˆ°ä¸¤ä¸ªé˜¶ä¸º $o$  çš„ç‚¹ $G_1,G_2$ï¼Œå¹¶æ„é€  $P_1&#x3D;k_1G_1,P_2&#x3D;k_2G_2$ï¼Œä½¿å¾— $P_1,P_2$ çš„é˜¶æ•°åˆ†åˆ«ä¸º $n_1,n_2$ã€‚è¦æ±‚åŒºåˆ†æ¯ä¸ªç‚¹çš„è¡¨è¾¾å¼æ˜¯ $xG_2+yP_1$ è¿˜æ˜¯ $xG_1+yP_2$ã€‚</p><p>è¿™ä¹ˆå¥‡æ€ªçš„è¡¨è¾¾å¼ï¼Œè‚¯å®šå¾—å¾€pairingå»æƒ³ã€‚éšä¾¿å†™ä¸ªä»£ç æµ‹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>    G1, G2 = E.random_element(), E.random_element()<br>    <span class="hljs-keyword">if</span>(G1.order() == o <span class="hljs-keyword">and</span> G2.order() == o):<br>        P1, P2 = (o//n1)*G1, (o//n2)*G2<br>        <span class="hljs-keyword">break</span><br>G1.weil_pairing(G2,o)<br><span class="hljs-comment">#2043960270847413570808455484853990840286568693988679265167903455579011705465705419705469862656455560563791378579381</span><br></code></pre></td></tr></table></figure><p>å‘ç°éšæœºæŒ‰ç…§é¢˜ç›®è¦æ±‚ç”Ÿæˆçš„å‚æ•° $G_1,G_2$ï¼Œå…¶é…å¯¹ $e(G_1,G_2)\not &#x3D;1$ï¼Œè¯´æ˜ $G_1&#x3D;kG_2$ çš„æ¦‚ç‡å¾ˆå°ã€‚</p><p>é‚£ä¹ˆä»¥ $xG_1+yP_2$ ä¸ºä¾‹ï¼šè‹¥è®¡ç®— $n_2(xG_1+yP_2)$ï¼Œå°±ä¼šå¾—åˆ° $n_2xG_1$ çš„å€¼ã€‚è‹¥æ­¤æ—¶ä¸å¦ä¸€ç»„ $n_2(uG_1+vP_2)&#x3D;n_2uG_1$ é…å¯¹ï¼Œé‚£ä¹ˆä½ ä¼šå‘ç° $n_2xG_1&#x3D;k\cdot n_2uG_1$ï¼Œè¿™ä¸ªé…å¯¹å€¼è‚¯å®šä¸º $1$ã€‚è€Œå¦‚æœå’Œ $n_2(rG_2+sP_1)$ é…å¯¹ï¼Œç”±äºè¿™é‡Œä¹˜äº† $n_2$ï¼Œä¸” $G_1\not&#x3D;kG_2$ï¼Œå› æ­¤è¿™ä¸ªé…å¯¹ä¸ç­‰äº $1$ã€‚</p><p>å¥½å®¶ä¼™ï¼ŒåŸæ¥è¿™ä¸ªåŒçº¿æ€§å¯¹æ˜¯è¿™æ ·ç”¨çš„ï¼ŒçŸ¥è¯†åˆé•¿äº†ï¼</p><p>ç”±äºflagä¸€èˆ¬éƒ½æ˜¯å¯è§å­—ç¬¦ï¼Œå› æ­¤ $C_0$ ä¸€å®šå…·æœ‰ $xG_1+yP_2$ çš„å½¢å¼ï¼Œé‚£å°±ä»¥ $C_0$ ä¸ºåŸºç‚¹ï¼Œæ¯ä¸ªé…å¯¹å»å§ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <span class="hljs-number">0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab</span><br>K = GF(p)<br>E = EllipticCurve(K, (<span class="hljs-number">0</span>, <span class="hljs-number">4</span>))<br>o = <span class="hljs-number">793479390729215512516507951283169066088130679960393952059283337873017453583023682367384822284289</span><br>n1, n2 = <span class="hljs-number">859267</span>, <span class="hljs-number">52437899</span><br>Cxy = [......]<br>C = [E(xi,yi) <span class="hljs-keyword">for</span> xi,yi <span class="hljs-keyword">in</span> Cxy]<br><br>H=C[<span class="hljs-number">0</span>]*n2<br>s=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(C)):<br>    k=(H.weil_pairing(C[i]*n2,o))<br>    s&lt;&lt;=<span class="hljs-number">1</span><br>    s|=<span class="hljs-built_in">bool</span>(k-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(long_to_bytes(s))<br><span class="hljs-comment">#SUCTF&#123;We1come__T0__SUCTF__2025&#125;</span><br></code></pre></td></tr></table></figure><h2 id="2-SUCTF2025-SU-RSA"><a href="#2-SUCTF2025-SU-RSA" class="headerlink" title="2.[SUCTF2025]SU_RSA"></a>2.[SUCTF2025]SU_RSA</h2><p>é¢˜é¢å¾ˆç®€å•ï¼Œç»™å‡ºäº† $d$ çš„é«˜ $512$ ä½ï¼Œè¦æ±‚åˆ†è§£ $n$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>).read()<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>e = getPrime(<span class="hljs-number">256</span>)<br>n = p*q<br>d = inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>d_m = ((d &gt;&gt; <span class="hljs-number">512</span>) &lt;&lt; <span class="hljs-number">512</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d_m = &quot;</span>,d_m)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n = &quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e = &quot;</span>,e)<br><span class="hljs-keyword">assert</span> flag[<span class="hljs-number">6</span>:-<span class="hljs-number">1</span>] == sha256(<span class="hljs-built_in">str</span>(p).encode()).hexdigest()[:<span class="hljs-number">32</span>]<br></code></pre></td></tr></table></figure><p>é‡æ–°æ¨å¼å­å¯ä»¥å¾—åˆ°ï¼Œå…¶ä¸­ $k&#x3D;\left\lfloor\dfrac{ed_m}{n}\right\rfloor$ã€‚<br>$$<br>ed&#x3D;kn-k(p+q)+1+k<br>$$<br>ç„¶åï¼Œä¸¤è¾¹å¯¹ $e$ å–æ¨¡ï¼š<br>$$<br>0\equiv kn-k(p+q)+1+k\pmod e<br>$$<br>åˆ†ç¦»å‡º $p+q$ï¼š<br>$$<br>p+q\equiv n+1+k^{-1} \pmod e<br>$$<br>é‚£ä¹ˆæˆ‘ä»¬å°±å¾—åˆ°äº† $p+q \mod e$ çš„å€¼ï¼Œæ ¹æ® $n \mod e$ çš„å€¼ï¼Œå¯ä»¥è§£å‡º $p\mod e,q\mod e$ çš„å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>dm =  <span class="hljs-number">54846367460362174332079522877510670032871200032162046677317492493462931044216323394426650814743565762481796045534803612751698364585822047676578654787832771646295054609274740117061370718708622855577527177104905114099420613343527343145928755498638387667064228376160623881856439218281811203793522182599504560128</span><br>n =  <span class="hljs-number">102371500687797342407596664857291734254917985018214775746292433509077140372871717687125679767929573899320192533126974567980143105445007878861163511159294802350697707435107548927953839625147773016776671583898492755338444338394630801056367836711191009369960379855825277626760709076218114602209903833128735441623</span><br>e =  <span class="hljs-number">112238903025225752449505695131644979150784442753977451850362059850426421356123</span><br><br>k=<span class="hljs-number">1</span>+(e*dm)//n<br>s=(n+<span class="hljs-number">1</span>+inverse(k,e))%e<br><span class="hljs-keyword">assert</span> e%<span class="hljs-number">4</span>==<span class="hljs-number">3</span><br>pbar=(s+<span class="hljs-built_in">pow</span>(s*s-<span class="hljs-number">4</span>*n,(e+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,e))*inverse(<span class="hljs-number">2</span>,e)%e<br>qbar=(s-<span class="hljs-built_in">pow</span>(s*s-<span class="hljs-number">4</span>*n,(e+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,e))*inverse(<span class="hljs-number">2</span>,e)%e<br><span class="hljs-built_in">print</span>(pbar)<br><span class="hljs-comment"># 56220299912083199824680953877514275031991586299490111910943821482768735249418</span><br></code></pre></td></tr></table></figure><p>ç”±äºè¿™é‡Œ $e$ æ˜¯ $256$ ä½ï¼Œä¹Ÿç›¸å½“äºæˆ‘ä»¬çŸ¥é“äº† $p$ çš„ $256$ ä½å†…å®¹ï¼Œåªä¸è¿‡è¿™é‡Œæ˜¯æ¨¡ $e$ æ„ä¹‰ä¸‹çš„ $256$ ä½ å†…å®¹ã€‚</p><p>æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ä¹‹å‰æµ‹ flatter çš„å¼å­ï¼Œ$f\equiv 2^{u}h+x\pmod n$ï¼Œå…¶ä¸­ $h$ æ˜¯ $p$ çš„é«˜ä½æ¯”ç‰¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">PR = PolynomialRing(Zmod(N), <span class="hljs-string">&#x27;x&#x27;</span>)<br>x = PR.gen()<br>f = (h &lt;&lt; ubit) + x<br>tstart=datetime.now()<br>roots = Small_Roots_Univariate(f, <span class="hljs-number">2</span> ** ubit, <span class="hljs-number">0.49</span>, <span class="hljs-number">0.007</span>)<br>tend=datetime.now()<br>p=Integer(h&lt;&lt;ubit)|Integer(roots[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(p),Integer(N)%Integer(p)==<span class="hljs-number">0</span>,<span class="hljs-built_in">str</span>(tend-tstart))<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™é‡Œï¼Œæ„é€ çš„å¼å­å°±åº”è¯¥æ˜¯ï¼š$f\equiv xe+p_L\pmod n$ï¼Œä½†è¿™é‡Œ $x$ çš„ä¸Šé™è¾¾åˆ°äº† $e$ï¼Œä¹Ÿå°±æ˜¯ $256$ ä½ï¼Œå› æ­¤éœ€è¦çˆ†ç ´å‡ ä½ã€‚äºæ˜¯æˆ‘è¿™é‡Œæ„é€ çš„æ˜¯ $f\equiv 2^6xe+ie+p_L\pmod n$ï¼Œå…¶ä¸­æšä¸¾ $i$ ä» $0$ åˆ° $63$ï¼Œ$x$ çš„ä¸Šé™ä¸º $\dfrac {e} {64}$ã€‚è‡³äºå…¶ä½™å‚æ•°çš„å–å€¼ï¼Œå¯ä»¥å‚è§ LatticeNotes8 ä¸­çš„å‚æ•°å–å€¼ã€‚</p><p>expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> subprocess <span class="hljs-keyword">import</span> check_output<br><span class="hljs-keyword">from</span> re <span class="hljs-keyword">import</span> findall<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flatter</span>(<span class="hljs-params">M</span>):  <span class="hljs-comment"># flatter</span><br>    z = <span class="hljs-string">&quot;[[&quot;</span> + <span class="hljs-string">&quot;]\n[&quot;</span>.join(<span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, row)) <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> M) + <span class="hljs-string">&quot;]]&quot;</span><br>    ret = check_output([<span class="hljs-string">&quot;flatter&quot;</span>], <span class="hljs-built_in">input</span>=z.encode())<br>    <span class="hljs-keyword">return</span> matrix(M.nrows(), M.ncols(), <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, findall(<span class="hljs-string">b&quot;-?\\d+&quot;</span>, ret)))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_overview</span>(<span class="hljs-params">BB</span>):  <span class="hljs-comment"># see the shape of matrix</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        a = (<span class="hljs-string">&#x27;%02d &#x27;</span> % ii)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">1</span>]):<br>            a += <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">if</span> BB[ii, jj] == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;X&#x27;</span><br>            <span class="hljs-keyword">if</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">60</span>:<br>                a += <span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Small_Roots_Univariate</span>(<span class="hljs-params">f, X=<span class="hljs-literal">None</span>, beta=<span class="hljs-number">1.0</span>, epsilon=<span class="hljs-literal">None</span></span>):  <span class="hljs-comment"># å¤šé¡¹å¼f,X,beta,epsilon</span><br><br>    delta = f.degree()  <span class="hljs-comment"># åº¦delta</span><br>    N = f.parent().characteristic()  <span class="hljs-comment"># æ¨¡æ•°N</span><br>    PR = PolynomialRing(ZZ, <span class="hljs-string">&#x27;x&#x27;</span>)<br>    x = PR.gen()<br><br>    Zm = f.base_ring()  <span class="hljs-comment"># Zmod(N)</span><br>    f = f.change_ring(ZZ)  <span class="hljs-comment"># ZZä¸‹f(x)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> f.is_monic():  <span class="hljs-comment"># é¦–ä¸€</span><br>        f = f.monic()  <span class="hljs-comment"># f = f * f[delta].inverse_mod(N)</span><br><br>    m = ceil(<span class="hljs-built_in">max</span>(beta * beta / (delta * epsilon), <span class="hljs-number">7</span> * beta / delta))  <span class="hljs-comment"># m</span><br>    t = floor(delta * m * (<span class="hljs-number">1</span> / beta - <span class="hljs-number">1</span>))  <span class="hljs-comment"># t</span><br>    <span class="hljs-comment">#print(&#x27;m=&#123;&#125;, t=&#123;&#125;&#x27;.format(m, t))</span><br><br>    f_ij = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(delta):<br>            f_ij.append(x ** j * N ** (m - i) * f ** i)  <span class="hljs-comment"># shift g_ij(x)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>        f_ij.append(x ** i * f ** m)  <span class="hljs-comment"># shift h_i(x)</span><br><br>    monomials = []<br>    <span class="hljs-keyword">for</span> g <span class="hljs-keyword">in</span> f_ij:<br>        monomials += g.monomials()  <span class="hljs-comment"># ç»Ÿè®¡æ‰€æœ‰å‡ºç°çš„å•é¡¹ x^i</span><br>    monomials = <span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">set</span>(monomials))  <span class="hljs-comment"># å»é‡å¹¶æ’åº</span><br><br>    M = Matrix(ZZ, <span class="hljs-built_in">len</span>(f_ij), <span class="hljs-built_in">len</span>(monomials))  <span class="hljs-comment"># è¡Œæ•°ä¸ºå¤šé¡¹å¼ä¸ªæ•°ï¼Œåˆ—æ•°ä¸ºæ‰€æœ‰å•é¡¹å¯èƒ½ä¸ªæ•°</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M.nrows()):<br>        <span class="hljs-keyword">for</span> j, monomial <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(monomials):<br>            M[i, j] = f_ij[i].monomial_coefficient(monomial) * monomial.subs(x=X)  <span class="hljs-comment"># g_ij(xX)å’Œh_i(xX)</span><br>    <span class="hljs-comment">#matrix_overview(M)  # see</span><br>    <span class="hljs-keyword">assert</span> M.nrows() == M.ncols()  <span class="hljs-comment"># æ–¹é˜µ nrows()=ncols()</span><br>    B = flatter(M)  <span class="hljs-comment"># flateråŠ é€Ÿ</span><br>    <span class="hljs-comment">#print(&#x27;end LLL&#x27;)</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M.nrows()):  <span class="hljs-comment"># å¾—åˆ°f(xX)ï¼Œæ„å»ºf(x)ï¼Œæ±‚æ ¹æ£€éªŒ</span><br>        Cx = <span class="hljs-built_in">sum</span>(ZZ(B[j, i] // monomials[i](X)) * monomials[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M.ncols()))  <span class="hljs-comment"># construct polynomial,</span><br>        R = Cx.roots()  <span class="hljs-comment"># get roots</span><br>        roots = [Zm(r[<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> R <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(r[<span class="hljs-number">0</span>]) &lt;= X]  <span class="hljs-comment"># check x0&lt;=X</span><br>        roots = [r <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> roots <span class="hljs-keyword">if</span> gcd(N, ZZ(f(r))) &gt;= ZZ(floor(N ** beta))]  <span class="hljs-comment"># check gcd(f(x_0),N)&gt;N^beta</span><br>        <span class="hljs-keyword">if</span> roots:<br>            <span class="hljs-keyword">return</span> roots  <span class="hljs-comment"># è¿”å›root</span><br><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>N=<span class="hljs-number">102371500687797342407596664857291734254917985018214775746292433509077140372871717687125679767929573899320192533126974567980143105445007878861163511159294802350697707435107548927953839625147773016776671583898492755338444338394630801056367836711191009369960379855825277626760709076218114602209903833128735441623</span><br>h=<span class="hljs-number">56220299912083199824680953877514275031991586299490111910943821482768735249418</span><br>PR=PolynomialRing(Zmod(N),<span class="hljs-string">&#x27;x&#x27;</span>)<br>x=PR.gen()<br>e=<span class="hljs-number">112238903025225752449505695131644979150784442753977451850362059850426421356123</span><br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)): <br>    f=(<span class="hljs-number">2</span>**<span class="hljs-number">6</span>*x*e+i*e+h).monic()<br>    roots=Small_Roots_Univariate(f,e&gt;&gt;<span class="hljs-number">6</span>,<span class="hljs-number">0.49</span>,<span class="hljs-number">0.0085</span>)<br>    <span class="hljs-keyword">if</span>(roots):<br>        <span class="hljs-built_in">print</span>(roots,i)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-comment">#[1579733723890583379944346027928995285091232963803321176752930674794829848032] 13</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬æœ‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">p=(<span class="hljs-number">1579733723890583379944346027928995285091232963803321176752930674794829848032</span>&lt;&lt;<span class="hljs-number">6</span>)*e+<span class="hljs-number">13</span>*e+h<br><span class="hljs-keyword">assert</span>(N%p==<span class="hljs-number">0</span>)<br>q=N//p<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(q)<br><span class="hljs-comment">#11347685135451772316799055128658844076558937002070169522376774233969211713689222327103200800438106374510397161974671925195478541934100406041896292545674921</span><br><span class="hljs-comment">#9021355410009950348639875237199118006505512170606972234278412660410503971242219008091386834585426483874880261151641622040094401795529954768919085685089663</span><br></code></pre></td></tr></table></figure><p>$n$ åˆ†è§£æˆåŠŸäº†ï¼Œé‚£ä¹ˆç­”æ¡ˆä¹Ÿå°±å‡ºæ¥äº†ã€‚ã€‚ã€‚</p><h2 id="3-SCTF2024-Signin"><a href="#3-SCTF2024-Signin" class="headerlink" title="3.[SCTF2024] Signin"></a>3.[SCTF2024] Signin</h2><p>çœ‹ä¸€çœ¼é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RSA</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, nbits</span>):<br>        <span class="hljs-variable language_">self</span>.nbits = nbits<br>        <span class="hljs-variable language_">self</span>.p, <span class="hljs-variable language_">self</span>.q = <span class="hljs-variable language_">self</span>.getPrimes()<br>        <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.p*<span class="hljs-variable language_">self</span>.q<br>        <span class="hljs-variable language_">self</span>.Gift = <span class="hljs-variable language_">self</span>.Gift()<br>        <span class="hljs-variable language_">self</span>.priv, <span class="hljs-variable language_">self</span>.pub = <span class="hljs-variable language_">self</span>.keyGen()<br>        <br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getPrimes</span>(<span class="hljs-params">self</span>):<br>        nbits = <span class="hljs-variable language_">self</span>.nbits<br>        p = random_prime(<span class="hljs-number">2</span>^(nbits-<span class="hljs-number">1</span>),lbound=<span class="hljs-number">2</span>^(nbits-<span class="hljs-number">2</span>))<br>        q = random_prime(<span class="hljs-number">2</span>^(nbits-<span class="hljs-number">1</span>),lbound=<span class="hljs-number">2</span>^(nbits-<span class="hljs-number">2</span>))<br>        <span class="hljs-keyword">while</span> p == q:<br>            q = random_prime(<span class="hljs-number">2</span>^(nbits-<span class="hljs-number">1</span>),lbound=<span class="hljs-number">2</span>^(nbits-<span class="hljs-number">2</span>))<br>        <span class="hljs-keyword">return</span> p,q<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Gift</span>(<span class="hljs-params">self</span>):<br>        p,q = <span class="hljs-variable language_">self</span>.p, <span class="hljs-variable language_">self</span>.q<br>        <span class="hljs-keyword">return</span> (p^<span class="hljs-number">2</span> + p + <span class="hljs-number">1</span>)*(q^<span class="hljs-number">2</span> + q + <span class="hljs-number">1</span>)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">keyGen</span>(<span class="hljs-params">self</span>):<br>        nbits = <span class="hljs-variable language_">self</span>.nbits<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            d = randint(<span class="hljs-number">2</span>^(nbits//<span class="hljs-number">4</span>),<span class="hljs-number">2</span>^(nbits//<span class="hljs-number">2</span>))<br>            <span class="hljs-keyword">if</span> gcd(d,<span class="hljs-variable language_">self</span>.Gift) != <span class="hljs-number">1</span>:<br>                d = randint(<span class="hljs-number">2</span>^(nbits//<span class="hljs-number">4</span>),<span class="hljs-number">2</span>^(nbits//<span class="hljs-number">2</span>))<br>            e = <span class="hljs-built_in">pow</span>(d,-<span class="hljs-number">1</span>,<span class="hljs-variable language_">self</span>.phi)<br>            <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">self</span>.p,<span class="hljs-variable language_">self</span>.q,<span class="hljs-variable language_">self</span>.n,e,d),(<span class="hljs-variable language_">self</span>.n,e)<br>RRR = RSA(<span class="hljs-number">512</span>)<br>bp = long_to_bytes(<span class="hljs-built_in">int</span>(RRR.p))<br>FLAG = <span class="hljs-string">&#x27;SCTF&#123;&#x27;</span>+md5(bp).hexdigest()+<span class="hljs-string">&#x27;&#125;&#x27;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;N = <span class="hljs-subst">&#123;RRR.n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;RRR.pub[<span class="hljs-number">1</span>]&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº† $n,e$ï¼Œä»¥åŠ $ed\equiv 1 \pmod g  $ å’Œ $g&#x3D;(p^2+p+1)(q^2+q+1)$ çš„æ¡ä»¶ï¼Œç„¶åæ¡ä»¶æ˜¯åˆ†è§£ $n$ã€‚è¿™é‡Œæœ‰ $g\sim n^2$ï¼Œä¸” $d&lt;n^{1&#x2F;2}$ï¼Œä¹Ÿå°±æ˜¯ $d&lt;g^{1&#x2F;4}$ã€‚</p><p>è¿™ä¸ªæ¡ä»¶å’Œwiener attackç±»ä¼¼ï¼Œé‚£ä¸ªæ˜¯ $e&#x2F;n$ å¯ä»¥ç²¾ç¡®è¦†ç›– $k&#x2F;d$ï¼Œè¿™ä¸ªå¯ä»¥çŒœæµ‹æ˜¯ $e&#x2F;n^2$ é‡Œé¢æœ‰ç„æœºï¼Œå› æ­¤å¯ä»¥ç›²çŒœï¼š<br>$$<br>ed-1&#x3D;kg<br>$$<br>ç„¶åç”¨Sageä¸­çš„è¿åˆ†æ•°å±•å¼€å°±OKäº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-number">32261421478213846055712670966502489204755328170115455046538351164751104619671102517649635534043658087736634695616391757439732095084483689790126957681118278054587893972547230081514687941476504846573346232349396528794022902849402462140720882761797608629678538971832857107919821058604542569600500431547986211951</span><br>e = <span class="hljs-number">334450817132213889699916301332076676907807495738301743367532551341259554597455532787632746522806063413194057583998858669641413549469205803510032623432057274574904024415310727712701532706683404590321555542304471243731711502894688623443411522742837178384157350652336133957839779184278283984964616921311020965540513988059163842300284809747927188585982778365798558959611785248767075169464495691092816641600277394649073668575637386621433598176627864284154484501969887686377152288296838258930293614942020655916701799531971307171423974651394156780269830631029915305188230547099840604668445612429756706738202411074392821840</span><br>cf=continued_fraction(e/n**<span class="hljs-number">2</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>,<span class="hljs-number">20000</span>):<br>    k,d=cf.numerator(i),cf.denominator(i)<br>    <span class="hljs-keyword">if</span>(e*d%k==<span class="hljs-number">1</span>):<br>        <span class="hljs-built_in">print</span>(d)<br>        <span class="hljs-keyword">break</span><br>g=(e*d-<span class="hljs-number">1</span>)//k<br><span class="hljs-built_in">print</span>(g)<br></code></pre></td></tr></table></figure><p>æ±‚å‡ºäº† $g$ è¿˜è¦æ±‚ $n$ çš„åˆ†è§£ã€‚æˆ‘ä»¬å¯ä»¥å…ˆå¯¹ $g$ çš„è¡¨è¾¾å¼è¿›è¡Œå±•å¼€ï¼š<br>$$<br>g&#x3D;p^2q^2+p^2q+pq^2+pq+p^2+q^2+p+q+1<br>$$<br>ç„¶åä»£å…¥ $n&#x3D;pq$ï¼š<br>$$<br>g&#x3D;n^2+n(p+q)+n+p^2+q^2+(p+q)+1<br>$$<br>è¿™ä¸ªåœ¨å¤–é¢çš„ $p^2+q^2$ ï¼Œå¯ä»¥åŒ–æˆ $(p+q)^2-2n$ï¼Œå¾—åˆ°æœ€ç»ˆè¡¨è¾¾å¼ï¼š<br>$$<br>g&#x3D;n^2-n+n(p+q)+(p+q)^2+(p+q)+1<br>$$<br>ä»¤ $x&#x3D;p+q$ï¼š<br>$$<br>0&#x3D;x^2+(n+1)x+n^2-n+1-g<br>$$</p><p>ç›´æ¥æ”¾sageä¸­è§£å‡º $p+q$ ï¼ˆè´Ÿå€¼èˆå»ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">solve(x**<span class="hljs-number">2</span>+(n+<span class="hljs-number">1</span>)*x+n**<span class="hljs-number">2</span>-n-g+<span class="hljs-number">1</span>,x)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">output:</span><br><span class="hljs-string">[</span><br><span class="hljs-string">x == -32261421478213846055712670966502489204755328170115455046538351164751104619671102517649635534043658087736634695616391757439732095084483689790126957681118289429943388851693149399740590663288610471650910670306567179355758613300549681123982851259417107072281489085039743066732289373012356978449638761920384845504,</span><br><span class="hljs-string">x == 11375355494879145919318225902721812105625077564437957170650561735710451147218983261968497619498442602950113206885958812468314407814408849138330372398633552</span><br><span class="hljs-string">]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ç„¶åæœ‰äº† $p+q$ï¼Œå°±å¯ä»¥æœ‰ $p,q$ äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">s=<span class="hljs-number">11375355494879145919318225902721812105625077564437957170650561735710451147218983261968497619498442602950113206885958812468314407814408849138330372398633552</span><br>solve(x**<span class="hljs-number">2</span>-s*x+n,x)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">[x == 5984758006806378809956519900535567746479053908385004504598524889746027259134602871258417614666511624425382102292754198444334667792470478919346145707972191, x == 5390597488072767109361706002186244359146023656052952666052036845964423888084380390710080004831930978524731104593204614023979740021938370218984226690661361]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>æµ‹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">5984758006806378809956519900535567746479053908385004504598524889746027259134602871258417614666511624425382102292754198444334667792470478919346145707972191</span><br>q=<span class="hljs-number">5390597488072767109361706002186244359146023656052952666052036845964423888084380390710080004831930978524731104593204614023979740021938370218984226690661361</span><br>n%p,n%q<br><span class="hljs-comment">#(0,0)</span><br></code></pre></td></tr></table></figure><p>æ€»ç»“ï¼šæ„Ÿè§‰è¿™ä¸ªé¢˜ï¼Œç”¨wiener attackçš„æ€è·¯ï¼Œç¡®å®ä¸å¥½æƒ³ï¼Œå¾—æ³¨æ„åˆ° $e&#x2F;n^2$ çš„è¿åˆ†æ•°å±•å¼€ï¼ˆä¸ºå•¥ä¸€ä¸ªä¸ªçš„æ³¨æ„åŠ›éƒ½é‚£ä¹ˆé›†ä¸­ï¼å¯æ¶ï¼ï¼‰ã€‚</p><h2 id="4-SCTF2024-ä¸å®Œå…¨é˜»å¡å¹²æ‰°"><a href="#4-SCTF2024-ä¸å®Œå…¨é˜»å¡å¹²æ‰°" class="headerlink" title="4.[SCTF2024] ä¸å®Œå…¨é˜»å¡å¹²æ‰°"></a>4.[SCTF2024] ä¸å®Œå…¨é˜»å¡å¹²æ‰°</h2><p>å…ˆçœ‹çœ‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># The ship crashed into the sun, causing a massive magnetic storm</span><br><span class="hljs-comment">#part of script</span><br>msg = bytes_to_long(FLAG)<br>n = p^<span class="hljs-number">5</span>*q^<span class="hljs-number">2</span><br>phi = p^<span class="hljs-number">4</span>*(p-<span class="hljs-number">1</span>)*q*(q-<span class="hljs-number">1</span>)<br>e = <span class="hljs-number">65537</span><br>d = inverse(d,phi)<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(c)<br></code></pre></td></tr></table></figure><p>é™¤äº†è¿™ä¸ªä»£ç ä¹‹å¤–ï¼Œé¢˜ç›®è¿˜ç»™å‡ºäº†ä¸€ä¸ªpemæ–‡ä»¶ï¼Œè¿™ä¸ªpemæ–‡ä»¶çš„æœ«å°¾æ˜¯ä¸€å † <code>A</code>ã€‚ã€‚ã€‚</p><p>ç„¶åæ¥æ‰‹æ’•ä¸€ä¸‹ï¼Œå‚è€ƒè¿™é‡Œï¼š<a href="https://tover.xyz/p/pem-by-hand/">æ‰‹æ’•PEMå¯†é’¥ï¼ˆRSAï¼‰ | Toverâ€™s Blog</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">3082</span> <span class="hljs-comment">#begin sequence 82è¡¨ç¤ºé™„åŠ 2å­—èŠ‚é•¿åº¦</span><br>0815 <span class="hljs-comment">#len=0x0815</span><br><br>0282 <span class="hljs-comment">#n: 02:æ•´æ•°å¼€å§‹æ ‡å¿—ï¼Œ82:8è¡¨ç¤ºé™„åŠ ï¼Œ2è¡¨ç¤º2å­—èŠ‚</span><br>0380 <span class="hljs-comment">#é•¿åº¦:0x380å­—èŠ‚</span><br>067f0aa4e974a63a1ffe8d5c23e5d3c431653ae41cc746f305f62a9f193f22486cb7ef1b275634818f46d0752a5139e19918271fa0d7d27bc660d2b72414d08ea52c8837f949c7baecc3029ba31727ef3bf120d9926c02d7412f187e98dc56dd07b987d2cc191ad56164a144f28b2f70a15d105588a4f27fbb2891fc527bd6890a5f795b5c48476a6bf9dfb67b7e1ebc7b1b086cd28b58c68955bfdf44ecce11ffacdf654551b159b7832040cc28ee8ebea48f8672d53e3de88fcfbb5fb276b503880dd34d5993335ddf8ccb96c1b4d79f502d72104765ad9c2b1858a17af3d5be44fa3cbf4b8eeb942aa3942a3871d2c65ac70289123fc2e9f9b25cbfcbd7841096060fa504c3a07b591493c64c88d0bb45285a85b5f7d59db98faa00c2cd3fbb63da599205f1cab0df52cf7b431a0ee4a7e35696546ce9d03ef595ecee92d2142c92e97d2744939703455b4c70dec27c321ec6b83c029622e83a9e0d55d0b258d95d4e61291865dda76dc619fce9577990429c6e77e9d40781e3b2f449701b83e8b0c6c66eb380f96473e5d422efee8b2b0e88b716b00a79c9d514ca3ad9d2dee526609ff9541732a4198d11b9dbfbb2e55c24d80ea522d0786e3355f23606a5d38a72de4eefc8b6bfc482248a2862cb69d8e0e3d316597da9d80828be85054faf15fc369caacafb815c6973c171940683d56a1a1967b09b7ffa3fbe5b2e08699759d84d71603f516447696bb27322a69f39f6ca253e00dc9555d5f97328070c467f3663cc489aad130f28c42f35bf88c571920ab92acb8f75d03e35a75103c5bd96f061c96bd02af6e1d191b0dd164bc721377003edbf5d3ef65a5e9046385356b521623bee37f164850a0a7afb0ed4e7e8bd9afe1298f7d532bc9ad941812d332aece75d1cccb1ff69fd42b31f248ae579d9e0d6a14b0546e784ba940e32bd01c395df8ff4584040462b5479fa07336d503dc332e70fc06d9463297fc042b623d56f87efaa525a9b580e314d90d1211893ed407a26508deaa0a13c9ee8c902b9e1c3a02fe9a51452c02ee7bdcc85c0eff63891e24703bd265d9c9dbf456e2af9409538bce0fecc7ebab20266aaab06c766c3ea6cda9cb9ba5e1d024b7dc3d73e76f6a333197bad87c4fb34d565a0014aac72825e41adcfeadadc87acef40ad84b7c55691abad561be0550ea0a988470c427432acb8feb2b9d2d2598fb2089bb91bbd9cb199e892d36164d8bf3ecd54576a97134047a12da84207485bb4e5<br>0203 <span class="hljs-comment">#e: 02: æ•´æ•°å¼€å§‹æ ‡å¿— 03:æ•´æ•°é•¿åº¦3å­—èŠ‚ï¼Œè¿™é‡Œæ˜¯03è¡¨ç¤ºä¸é™„åŠ é•¿åº¦ï¼Œå¦‚æœæ˜¯83è¡¨ç¤ºé™„åŠ é•¿åº¦å­—æ®µã€‚</span><br><span class="hljs-number">0</span>10001 <br>0282 <span class="hljs-comment">#d: 02:æ•´æ•°å¼€å§‹æ ‡å¿— 82:é•¿åº¦é™„åŠ 2å­—èŠ‚</span><br>0380 <span class="hljs-comment">#d: é•¿åº¦0x380å­—èŠ‚</span><br>0400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<br>0281 <span class="hljs-comment">#p: 02: æ•´æ•°å¼€å§‹æ ‡å¿— 81:æ•´æ•°é•¿åº¦é™„åŠ 1å­—èŠ‚</span><br><span class="hljs-number">81</span>   <span class="hljs-comment">#æ•´æ•°é•¿åº¦0x81å­—èŠ‚</span><br>008063d0a21876e5ce1e2101c20015529066ed9976882d1002a29efe0f2fdfcc2743fc9a4b5b651cc97108699eca2fb1f3d93175bae343e7c92e4a41c72d05e57019400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<br>0281 <span class="hljs-comment">#q: 02: æ•´æ•°å¼€å§‹æ ‡å¿— 81:æ•´æ•°é•¿åº¦é™„åŠ 1å­—èŠ‚</span><br><span class="hljs-number">81</span>   <span class="hljs-comment">#æ•´æ•°é•¿åº¦0x81å­—èŠ‚</span><br>00e4f0fe49f9ae1492c097a0a988fa71876625fe4fce05b0204f1fdf43ec64b4dac699d28e166efdfc7562d19e58c3493d9100365cf2840b46c0f6ee8d964807170ff2c13c4eb8012ecab37862a3900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<br></code></pre></td></tr></table></figure><p>äºæ˜¯æˆ‘ä»¬å°±å¾—åˆ°äº†RSAå‚æ•°ï¼Œå…¶ä¸­ $n&#x3D;p^5q^2$ï¼Œä½† $p$ çš„ä½ $502$ ä½å’Œ $q$ çš„ä½ $404$ ä½è¢«éšè—äº†ï¼Œåˆæ˜¯ä¸€ä¸ªRSA-HNPé—®é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">0x067f0aa4e974a63a1ffe8d5c23e5d3c431653ae41cc746f305f62a9f193f22486cb7ef1b275634818f46d0752a5139e19918271fa0d7d27bc660d2b72414d08ea52c8837f949c7baecc3029ba31727ef3bf120d9926c02d7412f187e98dc56dd07b987d2cc191ad56164a144f28b2f70a15d105588a4f27fbb2891fc527bd6890a5f795b5c48476a6bf9dfb67b7e1ebc7b1b086cd28b58c68955bfdf44ecce11ffacdf654551b159b7832040cc28ee8ebea48f8672d53e3de88fcfbb5fb276b503880dd34d5993335ddf8ccb96c1b4d79f502d72104765ad9c2b1858a17af3d5be44fa3cbf4b8eeb942aa3942a3871d2c65ac70289123fc2e9f9b25cbfcbd7841096060fa504c3a07b591493c64c88d0bb45285a85b5f7d59db98faa00c2cd3fbb63da599205f1cab0df52cf7b431a0ee4a7e35696546ce9d03ef595ecee92d2142c92e97d2744939703455b4c70dec27c321ec6b83c029622e83a9e0d55d0b258d95d4e61291865dda76dc619fce9577990429c6e77e9d40781e3b2f449701b83e8b0c6c66eb380f96473e5d422efee8b2b0e88b716b00a79c9d514ca3ad9d2dee526609ff9541732a4198d11b9dbfbb2e55c24d80ea522d0786e3355f23606a5d38a72de4eefc8b6bfc482248a2862cb69d8e0e3d316597da9d80828be85054faf15fc369caacafb815c6973c171940683d56a1a1967b09b7ffa3fbe5b2e08699759d84d71603f516447696bb27322a69f39f6ca253e00dc9555d5f97328070c467f3663cc489aad130f28c42f35bf88c571920ab92acb8f75d03e35a75103c5bd96f061c96bd02af6e1d191b0dd164bc721377003edbf5d3ef65a5e9046385356b521623bee37f164850a0a7afb0ed4e7e8bd9afe1298f7d532bc9ad941812d332aece75d1cccb1ff69fd42b31f248ae579d9e0d6a14b0546e784ba940e32bd01c395df8ff4584040462b5479fa07336d503dc332e70fc06d9463297fc042b623d56f87efaa525a9b580e314d90d1211893ed407a26508deaa0a13c9ee8c902b9e1c3a02fe9a51452c02ee7bdcc85c0eff63891e24703bd265d9c9dbf456e2af9409538bce0fecc7ebab20266aaab06c766c3ea6cda9cb9ba5e1d024b7dc3d73e76f6a333197bad87c4fb34d565a0014aac72825e41adcfeadadc87acef40ad84b7c55691abad561be0550ea0a988470c427432acb8feb2b9d2d2598fb2089bb91bbd9cb199e892d36164d8bf3ecd54576a97134047a12da84207485bb4e5</span><br>e=<span class="hljs-number">0x10001</span><br>p=<span class="hljs-number">0x008063d0a21876e5ce1e2101c20015529066ed9976882d1002a29efe0f2fdfcc2743fc9a4b5b651cc97108699eca2fb1f3d93175bae343e7c92e4a41c72d05e57019400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br>q=<span class="hljs-number">0x00e4f0fe49f9ae1492c097a0a988fa71876625fe4fce05b0204f1fdf43ec64b4dac699d28e166efdfc7562d19e58c3493d9100365cf2840b46c0f6ee8d964807170ff2c13c4eb8012ecab37862a3900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br></code></pre></td></tr></table></figure><p>ç”¨ç¬¬äºŒé¢˜çš„Flatterè§£å†³ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>N=<span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>N=<span class="hljs-number">0x067f0aa4e974a63a1ffe8d5c23e5d3c431653ae41cc746f305f62a9f193f22486cb7ef1b275634818f46d0752a5139e19918271fa0d7d27bc660d2b72414d08ea52c8837f949c7baecc3029ba31727ef3bf120d9926c02d7412f187e98dc56dd07b987d2cc191ad56164a144f28b2f70a15d105588a4f27fbb2891fc527bd6890a5f795b5c48476a6bf9dfb67b7e1ebc7b1b086cd28b58c68955bfdf44ecce11ffacdf654551b159b7832040cc28ee8ebea48f8672d53e3de88fcfbb5fb276b503880dd34d5993335ddf8ccb96c1b4d79f502d72104765ad9c2b1858a17af3d5be44fa3cbf4b8eeb942aa3942a3871d2c65ac70289123fc2e9f9b25cbfcbd7841096060fa504c3a07b591493c64c88d0bb45285a85b5f7d59db98faa00c2cd3fbb63da599205f1cab0df52cf7b431a0ee4a7e35696546ce9d03ef595ecee92d2142c92e97d2744939703455b4c70dec27c321ec6b83c029622e83a9e0d55d0b258d95d4e61291865dda76dc619fce9577990429c6e77e9d40781e3b2f449701b83e8b0c6c66eb380f96473e5d422efee8b2b0e88b716b00a79c9d514ca3ad9d2dee526609ff9541732a4198d11b9dbfbb2e55c24d80ea522d0786e3355f23606a5d38a72de4eefc8b6bfc482248a2862cb69d8e0e3d316597da9d80828be85054faf15fc369caacafb815c6973c171940683d56a1a1967b09b7ffa3fbe5b2e08699759d84d71603f516447696bb27322a69f39f6ca253e00dc9555d5f97328070c467f3663cc489aad130f28c42f35bf88c571920ab92acb8f75d03e35a75103c5bd96f061c96bd02af6e1d191b0dd164bc721377003edbf5d3ef65a5e9046385356b521623bee37f164850a0a7afb0ed4e7e8bd9afe1298f7d532bc9ad941812d332aece75d1cccb1ff69fd42b31f248ae579d9e0d6a14b0546e784ba940e32bd01c395df8ff4584040462b5479fa07336d503dc332e70fc06d9463297fc042b623d56f87efaa525a9b580e314d90d1211893ed407a26508deaa0a13c9ee8c902b9e1c3a02fe9a51452c02ee7bdcc85c0eff63891e24703bd265d9c9dbf456e2af9409538bce0fecc7ebab20266aaab06c766c3ea6cda9cb9ba5e1d024b7dc3d73e76f6a333197bad87c4fb34d565a0014aac72825e41adcfeadadc87acef40ad84b7c55691abad561be0550ea0a988470c427432acb8feb2b9d2d2598fb2089bb91bbd9cb199e892d36164d8bf3ecd54576a97134047a12da84207485bb4e5</span><br>h=<span class="hljs-number">0x008063d0a21876e5ce1e2101c20015529066ed9976882d1002a29efe0f2fdfcc2743fc9a4b5b651cc97108699eca2fb1f3d93175bae343e7c92e4a41c72d05e57019400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br>PR=PolynomialRing(Zmod(N),<span class="hljs-string">&#x27;x&#x27;</span>)<br>x=PR.gen()<br>f=(h+x)**<span class="hljs-number">5</span><br>roots=Small_Roots_Univariate(f,<span class="hljs-number">2</span>**<span class="hljs-number">503</span>,<span class="hljs-number">0.4</span>,<span class="hljs-number">0.007</span>)<br><span class="hljs-built_in">print</span>(roots)<br>h=<span class="hljs-number">0x008063d0a21876e5ce1e2101c20015529066ed9976882d1002a29efe0f2fdfcc2743fc9a4b5b651cc97108699eca2fb1f3d93175bae343e7c92e4a41c72d05e57019400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br>PR=PolynomialRing(Zmod(N),<span class="hljs-string">&#x27;x&#x27;</span>)<br>x=PR.gen()<br>f=(h+x)**<span class="hljs-number">5</span><br>roots=Small_Roots_Univariate(f,<span class="hljs-number">2</span>**<span class="hljs-number">503</span>,<span class="hljs-number">0.4</span>,<span class="hljs-number">0.007</span>)<br><span class="hljs-built_in">print</span>(roots)<br><span class="hljs-comment">#6708022338172260347899030626323676022100749598842650911015897443511894444627151436951734224984454180375617062494685670914830207366629067809127120853621</span><br></code></pre></td></tr></table></figure><p>æœ€åå°±å¯ä»¥å¾—åˆ°flagäº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#ä¸Šé¢æ˜¯è°ƒç”¨flatterçš„å†…å®¹</span><br>p=h+roots<br>q=(N//Integer(p**<span class="hljs-number">5</span>)).nth_root(<span class="hljs-number">2</span>)<br>c=<span class="hljs-number">145554802564989933772666853449758467748433820771006616874558211691441588216921262672588167631397770260815821197485462873358280668164496459053150659240485200305314288108259163251006446515109018138298662011636423264380170119025895000021651886702521266669653335874489612060473962259596489445807308673497717101487224092493721535129391781431853820808463529747944795809850314965769365750993208968116864575686200409653590102945619744853690854644813177444995458528447525184291487005845375945194236352007426925987404637468097524735905540030962884807790630389799495153548300450435815577962308635103143187386444035094151992129110267595908492217520416633466787688326809639286703608138336958958449724993250735997663382433125872982238289419769011271925043792124263306262445811864346081207309546599603914842331643196984128658943528999381048833301951569809038023921101787071345517702911344900151843968213911899353962451480195808768038035044446206153179737023140055693141790385662942050774439391111437140968754546526191031278186881116757268998843581015398070043778631790328583529667194481319953424389090869226474999123124532354330671462280959215310810005231660418399403337476289138527331553267291013945347058144254374287422377547369897793812634181778309679601143245890494670013019155942690562552431527149178906855998534415120428884098317318129659099377634006938812654262148522236268027388683027513663867042278407716812565374141362015467076472409873946275500942547114202939578755575249750674734066843408758067001891408572444119999801055605577737379889503505649865554353749621313679734666376467890526136184241450593948838055612677564667946098308716892133196862716086041690426537245252116765796203427832657608512488619438752378624483485364908432609100523022628791451171084583484294929190998796485805496852608557456380717623462846198636093701726099310737244471075079541022111303662778829695340275795782631315412134758717966727565043332335558077486037869874106819581519353856396937832498623662166446395755447101393825864584024239951058366713573567250863658531585064635727070458886746791722270803893438211751165831616861912569513431821959562450032831904268205845224077709362068478</span><br>phi = p**<span class="hljs-number">4</span>*(p-<span class="hljs-number">1</span>)*q*(q-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>d=inverse(<span class="hljs-number">0x10001</span>,Integer(phi))<br>long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,N))<br><span class="hljs-comment">#SCTF&#123;0ne_4rgum3nt_1s_r0tt3n_0r4ng3s,_th3_wh0le_cert1fic4t3_1s_r0tt3n_0r4ng3s:XD&#125;</span><br></code></pre></td></tr></table></figure><p>æ„Ÿè§‰è¿™ä¸ªé¢˜ï¼Œä¸å¥½æçš„å°±æ˜¯æ‰‹æ’•pemã€‚ã€‚ã€‚</p><h2 id="5-SUCTF2025-ez-Hash"><a href="#5-SUCTF2025-ez-Hash" class="headerlink" title="5.[SUCTF2025] ez_Hash"></a>5.[SUCTF2025] ez_Hash</h2><h3 id="5x01-çœ‹é¢˜"><a href="#5x01-çœ‹é¢˜" class="headerlink" title="5x01 çœ‹é¢˜"></a>5x01 çœ‹é¢˜</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;SUCTF&#123;??????????????????????????????&#125;&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">myhash</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,n</span>):<br>        <span class="hljs-variable language_">self</span>.g = <span class="hljs-number">91289086035117540959154051117940771730039965839291520308840839624996039016929</span><br>        <span class="hljs-variable language_">self</span>.n = n<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,msg: <span class="hljs-built_in">bytes</span></span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(msg)):<br>            <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.g * (<span class="hljs-number">2</span> * <span class="hljs-variable language_">self</span>.n + msg[i])<br>            <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.n &amp; ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">383</span>) - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">digest</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        <span class="hljs-keyword">return</span> ((<span class="hljs-variable language_">self</span>.n - <span class="hljs-number">0xd1ef3ad53f187cc5488d19045</span>) % (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">128</span>)).to_bytes(<span class="hljs-number">16</span>,<span class="hljs-string">&quot;big&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">x, y</span>):<br>    x = <span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(x)) + x<br>    y = <span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(y)) + y<br>    <span class="hljs-keyword">return</span> long_to_bytes(bytes_to_long(<span class="hljs-built_in">bytes</span>([a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(x, y)])))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">msg, n0</span>):<br>    h = myhash(n0)<br>    ret = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>] * <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> msg:<br>        h.update(<span class="hljs-built_in">bytes</span>([b]))<br>        ret = xor(ret,h.digest())<br>    <span class="hljs-keyword">return</span> ret<br><br>n0 = getRandomNBitInteger(<span class="hljs-number">382</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n0 = &quot;</span>,n0)<br>your_input = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;give me your msg -&gt;&quot;</span>).strip())<br><span class="hljs-keyword">if</span> fn(your_input, n0) == <span class="hljs-string">b&#x27;justjusthashhash&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;try again?&quot;</span>)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®å…ˆç»™å‡ºäº† myhash ç±»ï¼Œå…¶è¡¨è¾¾å¼ä¸º $n_{i+1}&#x3D;g(2n_{i}+m_i)$ã€‚ç„¶åå–digestçš„æ—¶å€™ï¼Œæ˜¯å¯¹ $n-B$ çš„ <code>long_to_bytes</code> çš„å€¼ã€‚æœ€ç»ˆçš„hashç»“æœä¸ºæ¯ä¸€æ­¥ digest çš„å¼‚æˆ–å’Œã€‚</p><h3 id="5x02-åˆæ­¥æ€è·¯-1-13-3pm"><a href="#5x02-åˆæ­¥æ€è·¯-1-13-3pm" class="headerlink" title="5x02 åˆæ­¥æ€è·¯(1.13 3pm)"></a>5x02 åˆæ­¥æ€è·¯(1.13 3pm)</h3><p>æ¨å¼å­ï¼ˆä»¥é•¿åº¦ä¸º 3 çš„å­—ç¬¦ä¸²ä¸ºä¾‹ï¼‰<br>$$<br>n_3&#x3D;2^3g^3n_0+2^2g^3m_0+2^1g^2m_1+gm_2<br>$$<br>æ³¨æ„åˆ°æ¨¡æ•°æ˜¯ $2^{128}$ï¼Œå¹¶ä¸”æ¯ä¸ªå…ƒç´ éƒ½ä¼šè¢«ä¹˜ä¸Šä¸€ä¸ª $2g$ï¼Œè¯´æ˜æ¯ä¸ªå…ƒç´ å¯¹æœ€ç»ˆç»“æœçš„å½±å“æ˜¯æœ‰é™çš„ï¼Œæµ‹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(fn(<span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">10000</span>,<span class="hljs-number">666</span>).<span class="hljs-built_in">hex</span>())<br><span class="hljs-built_in">print</span>(fn(<span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">12000</span>,<span class="hljs-number">666</span>).<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#fd31a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-comment">#fd31a968bcce1f25079b64f099e1c72e</span><br></code></pre></td></tr></table></figure><p>æµ‹ä¸€ä¸‹x2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(fn(<span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">1000</span>,<span class="hljs-number">666</span>).<span class="hljs-built_in">hex</span>())<br><span class="hljs-built_in">print</span>(fn(<span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">1001</span>,<span class="hljs-number">666</span>).<span class="hljs-built_in">hex</span>())<br><span class="hljs-built_in">print</span>(fn(<span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">1002</span>,<span class="hljs-number">666</span>).<span class="hljs-built_in">hex</span>())<br><span class="hljs-built_in">print</span>(fn(<span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">1003</span>,<span class="hljs-number">666</span>).<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#fd31a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-comment">#1ee0d0ff837f4f3c0f711066867bc444</span><br><span class="hljs-comment">#fd31a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-comment">#1ee0d0ff837f4f3c0f711066867bc444</span><br></code></pre></td></tr></table></figure><p>ç»§ç»­æµ‹ï¼Œæœç„¶ä» $127$ å¼€å§‹ï¼Œç»“æœå°±æ”¶æ•›äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">120</span>,<span class="hljs-number">135</span>):<br>    <span class="hljs-built_in">print</span>(i,fn(<span class="hljs-string">b&#x27;1&#x27;</span>*i,<span class="hljs-number">666</span>).<span class="hljs-built_in">hex</span>())<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">120 4331a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-string">121 bae0d0ff837f4f3c0f711066867bc444</span><br><span class="hljs-string">122 3531a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-string">123 0ee0d0ff837f4f3c0f711066867bc444</span><br><span class="hljs-string">124 9d31a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-string">125 dee0d0ff837f4f3c0f711066867bc444</span><br><span class="hljs-string">126 7d31a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-string">127 1ee0d0ff837f4f3c0f711066867bc444</span><br><span class="hljs-string">128 fd31a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-string">129 1ee0d0ff837f4f3c0f711066867bc444</span><br><span class="hljs-string">130 fd31a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-string">131 1ee0d0ff837f4f3c0f711066867bc444</span><br><span class="hljs-string">132 fd31a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-string">133 1ee0d0ff837f4f3c0f711066867bc444</span><br><span class="hljs-string">134 fd31a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ç„¶åå‘¢ï¼Ÿææ¯”ç‰¹è¿½è¸ªå—ï¼Œæ„Ÿè§‰ï¼Œä¸å¤ªè¡Œçš„æ ·å­ï¼Ÿå› ä¸ºè¿™é‡Œæ˜¯æ¯ä¸€æ­¥çš„å¼‚æˆ–ï¼Œå‰é¢å­—ç¬¦åˆ°äº†æœ€åæ‰ä¸å†å½±å“åé¢å­—ç¬¦çš„ã€‚æŠŠä¸Šé¢çš„ $\mathtt{31H}$ å­—ç¬¦æ¢æˆ $\mathtt{00H}$ å­—ç¬¦ï¼Œè§£å‡ºæ¥çš„æœ¬è´¨ä¹Ÿæ˜¯ä¸€æ ·çš„å§ï¼ŒåŸºæœ¬ä¸Šåˆ°äº†åæœŸï¼Œå°±æ˜¯ä¸¤ä¸ªå€¼çš„è·³è·ƒï¼Œåªæ˜¯å¼å­æ›´åŠ ç®€åŒ–äº†ï¼š<br>$$<br>n_{128}&#x3D;0<br>$$</p><p>åŠ ä¸€ç»„è°ƒè¯•éªŒè¯ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">msg, n0</span>):<br>    h = myhash(n0)<br>    ret = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>] * <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> msg:<br>        h.update(<span class="hljs-built_in">bytes</span>([b]))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(h.n%(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>)),end=<span class="hljs-string">&#x27;,&#x27;</span>)<br>        ret = xor(ret,h.digest())<br>    <span class="hljs-keyword">return</span> ret<br>fn(<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">128</span>,<span class="hljs-number">666</span>).<span class="hljs-built_in">hex</span>()<br></code></pre></td></tr></table></figure><p><img src="/2025/01/15/25Jan2/1.png" alt="1"></p><p>ç„¶åå°±è¢«å¡ä½äº†ã€‚ã€‚</p><h3 id="5x03-ç„ä¸€çœ¼wpå‘ç°æ²¡æƒ³åˆ°çš„ç‚¹ï¼"><a href="#5x03-ç„ä¸€çœ¼wpå‘ç°æ²¡æƒ³åˆ°çš„ç‚¹ï¼" class="headerlink" title="5x03 ç„ä¸€çœ¼wpå‘ç°æ²¡æƒ³åˆ°çš„ç‚¹ï¼"></a>5x03 ç„ä¸€çœ¼wpå‘ç°æ²¡æƒ³åˆ°çš„ç‚¹ï¼</h3><p>ç»“æœçœ‹äº†é¸¡å—çš„åšå®¢ï¼Œå‘ç°è‡ªå·±å‰é¢çš„æ€è·¯ï¼Œç«Ÿç„¶æ˜¯å¯¹çš„ã€‚ã€‚ã€‚ä½†ä¸‹é¢è¿™ä¸€æ­¥è‡ªå·±æ²¡æ³¨æ„åˆ°ï¼Œæ¥å­¦ä¹ ä¸€ä¸‹æ€è·¯ï¼</p><p>REFï¼š<a href="https://tangcuxiaojikuai.xyz/post/67c5a822.html#more">2025-SUCTF-wp-crypto | ç³–é†‹å°é¸¡å—çš„blog (tangcuxiaojikuai.xyz)</a></p><blockquote><p>æ‰€ä»¥å®Œå…¨å¯ä»¥åœ¨0-255ä¹‹é—´éšä¾¿é€‰128ä¸ªå€¼ï¼Œç„¶ååˆ†åˆ«ç»™ä»–ä»¬éƒ½åŠ ä¸Š<code>b&quot;\x00&quot;*128</code>çš„åç¼€ï¼Œç„¶åçœ‹ä½œ128ä¸ªä¸åŒçš„æ•´ä½“å»è§£çº¿æ€§æ–¹ç¨‹ç»„å°±å¯ä»¥äº†ã€‚</p></blockquote><p>Whyï¼Ÿ</p><p>é‡æ–°åˆ†æä¸€ä¸‹åˆšæ‰åšçš„å®éªŒï¼šå¦‚æœæ€»æ˜¯è¾“å…¥ä»…åŒ…å«ä¸€ä¸ªå­—ç¬¦ $C$ çš„å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆåˆ°æœ€åï¼Œ $n$ çš„å€¼ä¸€å®šä¼šæ”¶æ•›äºä¸€ä¸ªå›ºå®šå€¼ä¸º<br>$$<br>n_{âˆ}&#x3D;C\sum_{i&#x3D;0}^{127} 2^{i}g^{i+1} \pmod {2^{128}}<br>$$<br>å¦‚æœ $C&#x3D;0$ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼æ˜¯ $0$ï¼Œå¦‚æœ $C\not &#x3D;0$ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼ä¹Ÿå›ºå®šï¼Œå¹¶ä¸”è¿™ä¸ªå€¼ï¼Œå’Œ $n_0$ æ— å…³ã€‚</p><p>è€Œä¸ºä½•ä¼šæ”¶æ•›åˆ°ä¸¤ä¸ªå€¼ï¼Œæ˜¯å› ä¸ºæ¯æ¬¡å¼‚æˆ–çš„å†…å®¹ä¸º $n_{âˆ}$ã€‚ç”±äº $n_{âˆ}$ æ”¶æ•›ï¼Œå› æ­¤ $n_{âˆ}-B$ ä¹Ÿæ”¶æ•›ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºåˆ°åæœŸï¼Œæ¯æ¬¡åœ¨å‰ä¸€æ¬¡çš„åŸºç¡€ä¸Šï¼Œå¼‚æˆ–ä¸€ä¸ªå›ºå®šå€¼ã€‚ä¸€ä¸ªæ•°ä¸åœåœ°å¼‚æˆ–ä¸€ä¸ªå›ºå®šå€¼ï¼Œå¾—åˆ°çš„ç»“æœå½“ç„¶æ˜¯è¿™ä¸ªæ•°åœ¨ä¸¤ä¸ªå€¼ä¸Šåå¤æ¨ªè·³äº† :)ã€‚</p><p>ä½†ï¼Œç”±äºæ˜¯ç´¯ç§¯å¼‚æˆ–ï¼Œ$n_0$ ä¼šåœ¨å‰é¢å‘æŒ¥ä½œç”¨ï¼Œæ‰€ä»¥æœ€ç»ˆç»“æœä»ç„¶ä¼šå—åˆ° $n_0$ å½±å“å’Œå‰é¢çš„å­—ç¬¦å½±å“ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(fn(<span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">190</span>,<span class="hljs-number">666</span>).<span class="hljs-built_in">hex</span>())<br><span class="hljs-built_in">print</span>(fn(<span class="hljs-string">b&#x27;2&#x27;</span>+<span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">189</span>,<span class="hljs-number">666</span>).<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#fd31a968bcce1f25079b64f099e1c72e</span><br><span class="hljs-comment">#bb6d4e71bbc7ac8e1240f6b96b0dddcd</span><br></code></pre></td></tr></table></figure><p>æ—¢ç„¶è¿™æ ·ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸‹é¢çš„æ­¥éª¤ï¼š</p><ol><li>æ¶ˆé™¤ $n_0$ å½±å“ï¼Œåœ¨æœ€å‰é¢å¡« $128$ ä¸ª $\mathtt{00H}$ å­—èŠ‚ï¼Œä½¿å¾—ç³»ç»Ÿä¸­ $h.n$ çš„å€¼æ€»æ˜¯ $0$ã€‚</li><li>æ„é€  $128$ ä¸ªå‰ç¼€ä¸åŒï¼Œåç¼€ä¸º $128$ ä¸ª $\mathtt{00H}$ çš„å­—ç¬¦ä¸² $m_1\sim m_{128}$ï¼Œè®¡ç®— $f_n(m_i,0)$ï¼Œè¿™ $128$ ä¸ªç»“æœå¤§æ¦‚ç‡çº¿æ€§æ— å…³ã€‚</li><li>æ—¢ç„¶æœ€åç»“æœæ˜¯ $128$ ä¸ªçº¿æ€§æ— å…³çš„ç»“æœï¼Œæœ€åhashä¹Ÿæ˜¯ $128$ ä½ï¼Œé‚£ä¸€å®šå­˜åœ¨ä¸€ç§ç»„åˆï¼Œä½¿å¾—è¿™äº› hash çš„è‡ªç”±ç»„åˆå¯ä»¥å¾—åˆ°ç›®æ ‡å€¼ã€‚å¹¶ä¸”è¿™ä¸ªæ˜¯ç»„åˆï¼Œä¸æ˜¯æ’åˆ—ï¼Œä¹Ÿå°±æ˜¯ï¼Œé™¤äº†æœ€å‰é¢ $128$ ä¸ª $\mathtt{00H}$ å¤–ï¼Œå‡è®¾è§£å‡ºæ¥ $m_1,m_2,m_3$ å¯ä»¥ç»„åˆæˆç›®æ ‡å€¼ï¼Œé‚£ä¹ˆ $m_3,m_1,m_2$ ä¹Ÿå¯ä»¥ç»„åˆæˆç›®æ ‡å€¼ã€‚ï¼ˆè¯æ˜è§åé¢ï¼‰</li></ol><p>é‚£ä¹ˆæˆ‘ä»¬ç»§ç»­åˆ†æï¼š</p><ul><li>æ—¢ç„¶ä¸€å¼€å§‹æ˜¯ $128$ ä¸ª $\mathtt{00H}$ å­—èŠ‚ï¼Œé‚£ä¹ˆæœ€ç»ˆæˆ‘ä»¬ä¼šå¾—åˆ° $f_n(\mathtt{00H}\times128,n_0)$ çš„ç»“æœä¸ºåˆå€¼ $A$ï¼Œæ­¤æ—¶å¤„ç†åï¼Œ $h.n$ çš„å€¼ä¸º $0$ã€‚è€Œæˆ‘ä»¬éœ€è¦çš„ç›®æ ‡å€¼ä¸º $T$ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„å˜åŒ–é‡å°±æ˜¯ $A\oplus T$ï¼Œå°† $A\oplus T$ å•æ¯”ç‰¹æ„é€ ä¸€ä¸ªå‘é‡ $\vec y$ã€‚</li><li>ç„¶åï¼Œæˆ‘ä»¬è®¡ç®—$128$ ä¸ªçº¿æ€§æ— å…³çš„ $f_n(m_i,0)$ çš„å€¼ ï¼Œæ¯ä¸€è¡ŒæŒ‰å•æ¯”ç‰¹ï¼Œæ„å»ºä¸€ä¸ªçŸ©é˜µ $M$ã€‚</li><li>æ—¢ç„¶æœ€ç»ˆç»“æœæ˜¯ $n$ ä¸ªçº¿æ€§æ— å…³çš„ $f_n(m_i,0)$ ç»„åˆçš„ç»“æœï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°ï¼š</li></ul><p>$$<br>\vec y&#x3D;\bigoplus_{i&#x3D;0}^{127} b_i f_n(m_i,0)<br>$$</p><ul><li>é‚£ä¹ˆæˆ‘ä»¬è§£ $b_i$ å°±æ˜¯äº†ï¼Œå¦‚æœ $b_i$ ä¸º $1$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼‚æˆ–ä¸Š $f_n(m_i,0)$ã€‚</li></ul><p>Correctness Proofï¼šè¿™æ ·åšçš„æ­£ç¡®æ€§å°±åœ¨äºï¼Œç”±äº $m_i$ åé¢è·Ÿäº†ä¸€å¤§å † $00$ï¼Œé‚£ä¹ˆå½“ä¸€ç»„ $f_n(m_i,0)$ åšå®Œä¹‹åï¼Œä¸‹ä¸€ç»„å¼€å§‹å‰ï¼Œ$h.n$ çš„ç»“æœä»ç„¶æ˜¯ $0$ï¼Œå› æ­¤å¯ä»¥ç›´æ¥å¼€å§‹å¼‚æˆ–ä¸‹ä¸€ç»„çš„ $f_n(m_{i+1},0)$ã€‚å¹¶ä¸”å¼‚æˆ–å…·æœ‰äº¤æ¢å¾‹ï¼Œå› æ­¤ï¼Œåªè¦å¯¹åº”çš„ $b_i$ æ˜¯ $1$ï¼Œé‚£ä¹ˆé™¤äº†å¿…é¡»ä»¥ $128$ ä¸ª $\mathtt{00H}$ å¼€å¤´çš„è¦æ±‚å¤–ï¼Œå®é™…å¼‚æˆ–é¡ºåºæ— æ‰€è°“ï¼</p><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python 3.12.1</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">b&#x27;SUCTF&#123;??????????????????????????????&#125;&#x27;</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">myhash</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,n</span>):<br>        <span class="hljs-variable language_">self</span>.g = <span class="hljs-number">91289086035117540959154051117940771730039965839291520308840839624996039016929</span><br>        <span class="hljs-variable language_">self</span>.n = n<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self,msg: <span class="hljs-built_in">bytes</span></span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(msg)):<br>            <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.g * (<span class="hljs-number">2</span> * <span class="hljs-variable language_">self</span>.n + msg[i])<br>            <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.n &amp; ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">383</span>) - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">digest</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        <span class="hljs-keyword">return</span> ((<span class="hljs-variable language_">self</span>.n - <span class="hljs-number">0xd1ef3ad53f187cc5488d19045</span>) % (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">128</span>)).to_bytes(<span class="hljs-number">16</span>,<span class="hljs-string">&quot;big&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">x, y</span>):<br>    x = <span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(x)) + x<br>    y = <span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(y)) + y<br>    <span class="hljs-keyword">return</span> long_to_bytes(bytes_to_long(<span class="hljs-built_in">bytes</span>([a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(x, y)])))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">msg, n0</span>):<br>    h = myhash(n0)<br>    ret = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>] * <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> msg:<br>        h.update(<span class="hljs-built_in">bytes</span>([b]))<br>        <span class="hljs-comment">#print(&#x27;&#123;:032x&#125;&#x27;.format(h.n%(2**128)),end=&#x27;,&#x27;)</span><br>        ret = xor(ret,h.digest())<br>    <span class="hljs-keyword">return</span> ret<br><br>n0=getrandbits(<span class="hljs-number">128</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n0=&#123;:032x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(n0))<br>msgarr=[<span class="hljs-built_in">bytes</span>([<span class="hljs-number">1</span>+i]+[<span class="hljs-number">0</span>]*<span class="hljs-number">128</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>)]<br>resarr=[bytes_to_long(fn(msg1,<span class="hljs-number">0</span>)) <span class="hljs-keyword">for</span> msg1 <span class="hljs-keyword">in</span> msgarr]<br>M=[[<span class="hljs-built_in">bool</span>(i&amp;(<span class="hljs-number">1</span>&lt;&lt;j)) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> resarr]<br>val0=bytes_to_long(fn(<span class="hljs-built_in">bytes</span>(<span class="hljs-number">128</span>),n0))<br>target=bytes_to_long(<span class="hljs-string">b&#x27;justjusthashhash&#x27;</span>)<br>target=val0^target<br>y=[<span class="hljs-built_in">bool</span>((target)&amp;(<span class="hljs-number">1</span>&lt;&lt;i)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>)]<br>M=matrix(GF(<span class="hljs-number">2</span>),M)<br>y=vector(GF(<span class="hljs-number">2</span>),y)<br>ans=M.solve_left(y)<br>msga=<span class="hljs-built_in">bytes</span>(<span class="hljs-number">128</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ans)):<br>    <span class="hljs-keyword">if</span>(ans[i]):<br>        msga+=<span class="hljs-built_in">bytes</span>([<span class="hljs-number">1</span>+i]+[<span class="hljs-number">0</span>]*<span class="hljs-number">128</span>)<br><span class="hljs-built_in">print</span>(fn(msga,n0)) <span class="hljs-comment">#b&#x27;justjusthashhash&#x27;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(msga)*<span class="hljs-number">2</span>) <span class="hljs-comment">#16000+</span><br></code></pre></td></tr></table></figure><h3 id="5x04-å’Œä¹‹å‰çš„fnvå…³è”ï¼Ÿ"><a href="#5x04-å’Œä¹‹å‰çš„fnvå…³è”ï¼Ÿ" class="headerlink" title="5x04 å’Œä¹‹å‰çš„fnvå…³è”ï¼Ÿ"></a>5x04 å’Œä¹‹å‰çš„fnvå…³è”ï¼Ÿ</h3><blockquote><p>ä½ ä¸è§‰å¾—ï¼Œè¿™ä¸ª $16000+$ çš„é•¿åº¦ï¼Œæœ‰ç‚¹å¤ªé•¿äº†å—ï¼Œä¸‡ä¸€é¢˜ç›®é™åˆ¶äº†é•¿åº¦å‘¢ï¼Ÿèƒ½ä¸èƒ½è€ƒè™‘ç”¨SUSCTFé‚£ä¸ªçš„LLLåšæ¥æ”»å‡»å‘¢ï¼Ÿ</p></blockquote><p>é‚£ä¸ªmyhashï¼Œä¸å°±æ˜¯fnvå—ï¼Œèƒ½ä¸èƒ½ä»è¿™é‡Œå…¥æ‰‹å‘¢ï¼Ÿ</p><p>èµ›åå’Œæ˜Ÿç›Ÿçš„ DexterJie å¸ˆå‚…äº¤æµäº†ä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥æ­£å¸¸åšï¼Œå‚è€ƒäº†æ˜Ÿç›Ÿçš„WPï¼Œæ„Ÿè§‰é‚£ä¸ªä»£ç å†™å¾—æœ‰ç‚¹ç¹çäº†ï¼Œæˆ‘ç†äº†ç†æ€è·¯ï¼Œç®—æ˜¯å½»åº•ææ‡‚äº†è¿™ä¸ªé¢˜ï¼š</p><p>å‚è€ƒï¼š<a href="https://blog.xmcve.com/2025/01/14/SUCTF2025-Writeup/#title-16">SUCTF2024 Writeup - æ˜Ÿç›Ÿå®‰å…¨å›¢é˜Ÿ (xmcve.com)</a></p><p>æˆ‘ä»¬è€ƒå¯Ÿhashç¢°æ’ï¼ˆä»¥ä¸‰ä½ä¸ºä¾‹ï¼‰<br>$$<br>2^3g^3n+2^2g^3m_0+2^1g^2m_1+gm_2\equiv 2^3g^3n+2^2g^3r_0+2^1g^2r_1+gr_2 \pmod {2^{128}}<br>$$<br>å¯æ¶ˆå» $2^3g^3n$ é¡¹ï¼š<br>$$<br>2^2g^3\delta_0+2^1g^2\delta_1+g\delta_2\equiv 0\pmod{2^{128}}<br>$$<br>æ˜¾ç„¶ï¼Œ$\delta $ å¾ˆå°ï¼Œå¯ä»¥æ„é€ è¿™ä¸ªçŸ©é˜µå»æ±‚è§£ï¼Œç”šè‡³æœ€åæ‰©å¼ ç³»æ•° $K&#x3D;1$ ä¹Ÿèƒ½æ±‚ï¼ </p><p><img src="/2025/01/15/25Jan2/2.png" alt="2"></p><p>ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œç»™ä»–å¢åŠ äº†ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸¤ä¸ªå€¼ï¼šä¸€ä¸ªæ˜¯ ret çš„æ•°å€¼ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯ $h.n$ å†…éƒ¨çš„å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">fnTest</span>(<span class="hljs-params">msg, n0</span>):<br>    h = myhash(n0)<br>    ret = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>] * <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> msg:<br>        h.update(<span class="hljs-built_in">bytes</span>([b]))<br>        d = h.digest()<br>        ret = xor(ret, d)<br>    <span class="hljs-keyword">return</span> bytes_to_long(ret),h.n%(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>)<br></code></pre></td></tr></table></figure><p>æµ‹ä¸€ä¸‹ï¼Œæœ€åä¸¤ä¸ª $h.n$ çš„çŠ¶æ€æœç„¶ä¸€æ ·ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">n0=<span class="hljs-number">0xf3ad24a59d00d329a56273d2154d51f3</span><br>g=<span class="hljs-number">60836803250181415307496727382007595489</span><br>n=<span class="hljs-number">64</span><br>M=[[i==j <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>M[-<span class="hljs-number">1</span>][-<span class="hljs-number">1</span>]=<span class="hljs-number">2</span>**<span class="hljs-number">128</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    M[i][-<span class="hljs-number">1</span>]=<span class="hljs-number">2</span>**(n-i)*Integer(<span class="hljs-built_in">pow</span>(g,n-i,<span class="hljs-number">2</span>**<span class="hljs-number">128</span>))%(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>)<br>M=matrix(ZZ,M)<span class="hljs-comment">#*diagonal_matrix([1]*(n+1)+[2**2000])</span><br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M3L:<br>    <span class="hljs-keyword">if</span>(v[-<span class="hljs-number">1</span>]==<span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">break</span><br>s1=[<span class="hljs-number">110</span>]*<span class="hljs-number">64</span><br>s2=[<span class="hljs-number">110</span>+v[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(s1))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(s2))<br>d1,h1=fnTest(<span class="hljs-built_in">bytes</span>(s1),n0)<br><span class="hljs-built_in">print</span>(d1.<span class="hljs-built_in">hex</span>(),h1%(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>))<br>d2,h2=fnTest(<span class="hljs-built_in">bytes</span>(s2),n0)<br><span class="hljs-built_in">print</span>(d2.<span class="hljs-built_in">hex</span>(),h2%(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn&#x27;</span><br><span class="hljs-string">b&#x27;kooopjknnmoomnnoopklnmnmhnlronpqnmlnmopnnnnnnnnnnnnnnnnnnnnnnnnn&#x27;</span><br><span class="hljs-string">af3bb53e332f1723690e9b8631f69e76 228056009380557728235158378943134817746</span><br><span class="hljs-string">188ae78e8e8cf3752e5b3a3493c21909 228056009380557728235158378943134817746</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>é‚£å¦‚ä½•å»æ‰¾ $128$ ç»„ï¼Œä½¿è¿™ $128$ ç»„å‡åšåˆ°çº¿æ€§æ— å…³å‘¢ï¼Ÿå½“ç„¶æ˜¯ä¸¤ä¸ªæ–¹æ³•ï¼šä¸€æ˜¯æ”¹å˜é•¿åº¦ï¼ŒäºŒæ˜¯åŒä¸€é•¿åº¦ä¸‹å¤šä¿å­˜å‡ ç»„æ•°æ®ã€‚ã€‚ã€‚å¹¶ä¸”ï¼Œä½ ä¼šå‘ç°ï¼Œæˆ‘ä¿å­˜ä¸‹æ¥çš„æ•°æ®ï¼Œæ˜¯ä¸åˆå€¼æ— å…³çš„ï¼</p><p>æ ¹æ®ä¸Šé¢æ„é€ çš„æ ¼å’Œå®éªŒç»“æœï¼Œå…ˆç»™ä»–å°è£…ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">CheckVec</span>(<span class="hljs-params">v</span>):<br>    s1=[<span class="hljs-number">80</span>]*(<span class="hljs-built_in">len</span>(v)-<span class="hljs-number">1</span>)<br>    s2=[<span class="hljs-number">80</span>+v[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v)-<span class="hljs-number">1</span>)]<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">25</span>):<br>        tmp=getrandbits(<span class="hljs-number">128</span>)<br>        <span class="hljs-keyword">if</span>(fnTest(<span class="hljs-built_in">bytes</span>(s1),tmp)[<span class="hljs-number">1</span>]!=fnTest(<span class="hljs-built_in">bytes</span>(s2),tmp)[<span class="hljs-number">1</span>]):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getcollision</span>(<span class="hljs-params">n</span>):<br>    g=<span class="hljs-number">60836803250181415307496727382007595489</span><br>    M=[[i==j <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>    M[-<span class="hljs-number">1</span>][-<span class="hljs-number">1</span>]=<span class="hljs-number">2</span>**<span class="hljs-number">128</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i][-<span class="hljs-number">1</span>]=<span class="hljs-number">2</span>**(n-i)*Integer(<span class="hljs-built_in">pow</span>(g,n-i,<span class="hljs-number">2</span>**<span class="hljs-number">128</span>))%(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>)<br>    M=matrix(ZZ,M)<br>    M3L=M.LLL()<br>    vec=[]<br>    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M3L:<br>        <span class="hljs-keyword">if</span>(v[-<span class="hljs-number">1</span>]==<span class="hljs-number">0</span>):<br>            vec.append(v)<br>    ret=[]<br>    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> vec:<br>        <span class="hljs-keyword">if</span>(CheckVec(v)):<br>            ret.append(v[:-<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">return</span> ret<br></code></pre></td></tr></table></figure><p>ç”±äºä¸Šé¢çš„ä»£ç æ˜¾ç¤ºï¼šæˆ‘ä»¬å¯ä»¥æ„é€ hashç»“æœä¸åŒï¼Œä½†æ“ä½œå $h.n$ çš„ç»“æœç›¸åŒçš„ä¸¤ä¸ªå­—ç¬¦ä¸² $s,t$ï¼Œå¹¶åˆ©ç”¨è¿™äº›æ€§è´¨ï¼š</p><ol><li><p>æ¯æ¬¡æ“ä½œåï¼Œ$h.n$ çš„ç»“æœç›¸åŒï¼Œè¯´æ˜è¿™ä¸€æ­¥ï¼Œæ— è®ºæ˜¯å¯¹ $s$ æ“ä½œè¿˜æ˜¯å¯¹ $t$ æ“ä½œï¼Œéƒ½ä¸ä¼šå½±å“å¯¹ä¸‹ä¸€å­—ç¬¦ä¸² $r$ çš„æ“ä½œã€‚å› ä¸ºå¯¹ä¸‹ä¸€å­—ç¬¦ä¸² $r$ çš„æ“ä½œç­‰ä»·äº $f_n(r,h.nâ€™)$ï¼Œå…¶ä¸­ $h.nâ€™$ æ˜¯è¿™ä¸€æ­¥æ“ä½œåçš„ $h.n$ çš„å€¼ã€‚</p></li><li><p>ç”±äº $s$ å’Œ $t$ çš„æ“ä½œç»“æœä¸åŒï¼Œå› æ­¤è¿™ä¸€æ­¥é‡Œ $d&#x3D;f_n(s)\oplus f_n(t)$ ä¸ä¸º $0$ã€‚</p></li><li><p>æˆ‘ä»¬å‡è®¾æœ€åæˆ‘ä»¬çš„ç›®æ ‡ä¸º $T$ï¼Œç„¶åæˆ‘ä»¬è®¡ç®— $D&#x3D;f_n(S,n_0)$ ï¼Œå…¶ä¸­ $S$ ä¸ºæ‰€æœ‰ $s_i$ æŒ‰é¡ºåºè¿æ¥çš„ç»“æœã€‚é‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆå°±å¯ä»¥æ ¹æ® $128$ ä¸ªä¸åŒçš„ $d$ å»ç»„åˆ $T\oplus D$ çš„å€¼ï¼Œå›åˆ°äº†è§£æ–¹ç¨‹ä¸Šé¢å»</p></li></ol><p>æœ¬åœ°æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python 3.12.1</span><br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#------åŸé¢˜æ–‡ä»¶-------#</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">myhash</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, n</span>):<br>        <span class="hljs-variable language_">self</span>.g = <span class="hljs-number">91289086035117540959154051117940771730039965839291520308840839624996039016929</span><br>        <span class="hljs-variable language_">self</span>.n = n<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self, msg: <span class="hljs-built_in">bytes</span></span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(msg)):<br>            <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.g * (<span class="hljs-number">2</span> * <span class="hljs-variable language_">self</span>.n + msg[i])<br>            <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.n &amp; ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">383</span>) - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">digest</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>((<span class="hljs-variable language_">self</span>.n - <span class="hljs-number">0xd1ef3ad53f187cc5488d19045</span>) % (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">128</span>)).to_bytes(<span class="hljs-number">16</span>, <span class="hljs-string">&quot;big&quot;</span>)<br>        <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">x, y</span>):<br>    x = <span class="hljs-string">b&#x27;\x00&#x27;</span> * (<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(x)) + x<br>    y = <span class="hljs-string">b&#x27;\x00&#x27;</span> * (<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(y)) + y<br>    <span class="hljs-keyword">return</span> long_to_bytes(bytes_to_long(<span class="hljs-built_in">bytes</span>([a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(x, y)])))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">msg, n0</span>):<br>    h = myhash(n0)<br>    ret = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>] * <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> msg:<br>        h.update(<span class="hljs-built_in">bytes</span>([b]))<br>        d = h.digest()<br>        ret = xor(ret, d)<br>    <span class="hljs-keyword">return</span> ret<br><span class="hljs-comment">#------æµ‹è¯•å‡½æ•°-------#</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fnTest</span>(<span class="hljs-params">msg, n0</span>):<br>    h = myhash(n0)<br>    ret = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>] * <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> msg:<br>        h.update(<span class="hljs-built_in">bytes</span>([b]))<br>        d = h.digest()<br>        ret = xor(ret, d)<br>    <span class="hljs-keyword">return</span> bytes_to_long(ret),h.n%(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>)<br><span class="hljs-comment">#------å¯»æ‰¾ç¢°æ’-------#</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CheckVec</span>(<span class="hljs-params">v</span>):  <span class="hljs-comment">#æ£€æŸ¥æ˜¯å¦æ»¡è¶³Testé€šè¿‡</span><br>    s1=[<span class="hljs-number">80</span>]*(<span class="hljs-built_in">len</span>(v)-<span class="hljs-number">1</span>)<br>    s2=[<span class="hljs-number">80</span>+v[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v)-<span class="hljs-number">1</span>)]<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">25</span>):<br>        tmp=getrandbits(<span class="hljs-number">128</span>)<br>        <span class="hljs-keyword">if</span>(fnTest(<span class="hljs-built_in">bytes</span>(s1),tmp)[<span class="hljs-number">1</span>]!=fnTest(<span class="hljs-built_in">bytes</span>(s2),tmp)[<span class="hljs-number">1</span>]):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getcollision</span>(<span class="hljs-params">n</span>):<br>    g=<span class="hljs-number">60836803250181415307496727382007595489</span><br>    M=[[i==j <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>    M[-<span class="hljs-number">1</span>][-<span class="hljs-number">1</span>]=<span class="hljs-number">2</span>**<span class="hljs-number">128</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i][-<span class="hljs-number">1</span>]=<span class="hljs-number">2</span>**(n-i)*Integer(<span class="hljs-built_in">pow</span>(g,n-i,<span class="hljs-number">2</span>**<span class="hljs-number">128</span>))%(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>)<br>    M=matrix(ZZ,M)<br>    M3L=M.LLL()<br>    vec=[]<br>    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M3L:<br>        <span class="hljs-keyword">if</span>(v[-<span class="hljs-number">1</span>]==<span class="hljs-number">0</span>):<br>            vec.append(v)<br>    <span class="hljs-comment">#return vec</span><br>    ret=[]<br>    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> vec:<br>        <span class="hljs-keyword">if</span>(CheckVec(v)):<br>            ret.append(v[:-<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">return</span> ret<br><span class="hljs-comment">#------äº§ç”Ÿæµ‹è¯•æ•°æ®-------#</span><br>s=[]<br>lens=<span class="hljs-number">35</span><br><span class="hljs-keyword">while</span>(<span class="hljs-built_in">len</span>(s)&lt;<span class="hljs-number">128</span>):<br>    s+=getcollision(lens)<br>    lens+=<span class="hljs-number">1</span><br>s=s[:<span class="hljs-number">128</span>]<br>n0=getrandbits(<span class="hljs-number">128</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;0x&#123;:032x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(n0))<br><span class="hljs-comment">#------å¯»æ‰¾128ç»„ç¢°æ’å¹¶æ„å»ºéšæœºå­—ç¬¦ä¸²-------#</span><br>msG,msH=[],[]s<br>Gall=<span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">myRandString</span>(<span class="hljs-params">lens</span>):<br>    ret=<span class="hljs-string">&#x27;&#x27;</span><br>    Table=(<span class="hljs-string">&#x27;456GHIJKLMNOPQRSTghijklmnopqrst&#x27;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(lens):<br>        ret+=choice(Table)<br>    <span class="hljs-keyword">return</span> ret<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>    v=s[i]<br>    si=myRandString(<span class="hljs-built_in">len</span>(v)).encode()<br>    msG.append(si)<br>    Gall+=si<br>    msH.append(<span class="hljs-built_in">bytes</span>([si[i]+v[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v))]))<br><br><span class="hljs-comment">#------è®¡ç®—å…¨Gçš„hashç»“æœï¼Œå¹¶å’Œç›®æ ‡å¼‚æˆ–å¾—åˆ°å·®åˆ†å€¼-------#</span><br>HashGall=bytes_to_long(fn(Gall,n0))<br>D=bytes_to_long(<span class="hljs-string">b&#x27;justjusthashhash&#x27;</span>)<br>D=D^HashGall<br>diffGH=[]<br>curstat=n0<br><span class="hljs-comment">#------æ„å»ºæ¯ä¸€æ­¥gå’Œhçš„å·®åˆ†-------#</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>    tG,tH=msG[i],msH[i]<br>    tgf,nxtstat,thf,nxtstatChk=fnTest(tG,curstat)+fnTest(tH,curstat)<br>    <span class="hljs-keyword">assert</span> nxtstat==nxtstatChk<br>    diffGH.append(tgf^thf)<br>    curstat=nxtstat<br><span class="hljs-comment">#------æ„å»ºçŸ©é˜µæ±‚è§£æ–¹ç¨‹ï¼Œåˆ¤æ–­æ¯ä¸€æ­¥å¼‚æˆ–msgè¿˜æ˜¯å¼‚æˆ–msh-------#</span><br>M=[[<span class="hljs-built_in">bool</span>(diffGH[i]&amp;(<span class="hljs-number">1</span>&lt;&lt;j)) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>)]<br>y=[<span class="hljs-built_in">bool</span>(D&amp;(<span class="hljs-number">1</span>&lt;&lt;j)) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>)]<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br>y=vector(GF(<span class="hljs-number">2</span>),y)<br>ans=M.solve_left(y)<br><span class="hljs-comment">#------æ„é€ æœ€åå­—ç¬¦ä¸²-------#</span><br>finalMsg=<span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>    <span class="hljs-keyword">if</span>(ans[i]):<br>        finalMsg+=msH[i]<br>    <span class="hljs-keyword">else</span>:<br>        finalMsg+=msG[i]<br><span class="hljs-built_in">print</span>(fn(finalMsg,n0))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(finalMsg))<br><span class="hljs-built_in">print</span>(finalMsg)<br><span class="hljs-comment">#å¯èƒ½çš„è¾“å‡ºç»“æœï¼š</span><br><span class="hljs-comment">#n0=0x0c4db02b41aa032cf28ac84dc7908f1e</span><br><span class="hljs-comment">#b&#x27;justjusthashhash&#x27;</span><br><span class="hljs-comment">#5432</span><br><span class="hljs-comment">#å‡ä¸ºå¯è§å­—ç¬¦</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œç”±äºæ¯æ¬¡LLLåçš„å€¼å¾ˆå°ï¼Œå› æ­¤æˆ‘æœ€åæ„å»ºå‡ºæ¥çš„å­—ç¬¦ä¸²å†…å‡ä¸ºå¯è§å­—ç¬¦ï¼Œä¸”å­—ç¬¦ä¸²é•¿åº¦ä¹Ÿåªå‰©ä¸‹ $5000$ ä½äº†ã€‚å®˜æ–¹WPå…¶å®ä¹Ÿæ˜¯è¿™ä¸ªæ€è·¯ï¼Œä¿æŒæ¯æ¬¡å¤„ç†å $n$ çš„çŠ¶æ€ç›¸åŒï¼Œé€šè¿‡è§£ $GF(2)$ ä¸Šçš„æ–¹ç¨‹ï¼Œæ¯æ¬¡é€‰ä¸åŒçš„çŠ¶æ€æ¥çº¿æ€§ç»„åˆæˆæœ€ç»ˆç»“æœï¼Œè¿™ä¸ªé¢˜ï¼Œä¹Ÿç®—æ˜¯ææ‡‚äº†ï¼Œç”¨äº†æˆ‘ä¸€å¤©:(</p><h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9.æ€»ç»“"></a>9.æ€»ç»“</h2><p>ä¸çŸ¥ä¸è§‰åˆæ˜¯ 1 æœˆäº†ï¼Œ4 å¹´ï¼Œå¥½å¿«ã€‚</p><p>2021 å¹´çš„é‚£ä¸ªå¯’å‡ï¼Œå½“æ—¶ç¡®å®è‡ªå·±å¥½å¥½æ‰“äº† 1 ä¸ªæœˆçš„ CTFï¼Œæ°´å¹³æå‡äº†å¾ˆå¤šï¼é‚£å°± 2021 Once Moreï¼Œç”¨å¥½è¿™æ®µæ—¶é—´ï¼Œä¹Ÿè®¸èƒ½å†æ¥ä¸€æ¬¡æ°´å¹³çªç ´å‘¢ï¼</p><p>é‡æ–°æ¥è§¦äº†æ›´å¤šçš„å¸ˆå‚…~ï¼Œåé¢å¾—å¤šå…³æ³¨å…³æ³¨å¤–é¢çš„æ¯”èµ›äº†ï¼Œç¡®å®èƒ½å¤Ÿæ„Ÿè§‰åˆ°ï¼Œè¿˜æ˜¯æ‰“æ¯”èµ›ç„¶åæ‰“å®Œäº¤æµï¼Œæ¯”ç›´æ¥è¡¥é¢˜ï¼Œæ•ˆæœè¦å¥½å¤šäº†:)</p><p>å½“ç„¶ï¼Œç¬¬ 2 é¢˜ä¹Ÿéœ€è¦è®©æˆ‘æ³¨æ„åˆ°ä»¥å‰çš„ä¸€äº›é¢˜ç›®ä¹Ÿå¾—å¸¦ç€å»å¤ç›˜ä¸€ä¸‹:)ï¼Œå…å¾—ä¸‹æ¬¡çœ‹åˆ°ç†Ÿæ‚‰çš„é¢˜ç›®åˆä¸ä¼š</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>25Jan1</title>
    <link href="/2025/01/12/25Jan1/"/>
    <url>/2025/01/12/25Jan1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-1æœˆçš„åˆ‡é¢˜1-NTRU-Note-1"><a href="#huangx607087-1æœˆçš„åˆ‡é¢˜1-NTRU-Note-1" class="headerlink" title="huangx607087 1æœˆçš„åˆ‡é¢˜1(NTRU Note 1)"></a>huangx607087 1æœˆçš„åˆ‡é¢˜1(NTRU Note 1)</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>è‡ªä»ä»è´µå·å›æ¥ä¹‹åï¼Œå°±æŒç»­çº¢æ¸©äº†45å¤©ï¼Œåˆæ˜¯è¯¾ç¨‹è®ºæ–‡åˆæ˜¯preçš„ï¼Œåšäº†3ä¸ªpptï¼Œ3ä¸ªè¯¾ç¨‹è®ºæ–‡ï¼Œ5åœºè€ƒè¯•ï¼Œä¸­é€”æ‰“äº†ä¸ªCISCNã€‚ä¸¤é—¨èƒŒè¯µçš„è¯¾æäº†æˆ‘15å¤©ï¼Œå¯¹æˆ‘è¿™ç§èƒŒä¹¦ä¸è¡Œçš„å®¶ä¼™æ¥è¯´çœŸçš„å¾ˆéš¾é¡¶ã€‚ã€‚ã€‚</p><p>1 æœˆ 9 æ—¥11:00ï¼Œç»ˆäºè€ƒå®Œäº†ï¼Œåæ­£èƒ½è¿‡ã€‚ä¸å¾—ä¸è¯´ 12 æœˆ 5 å·çš„å¯†ç å­¦è€ƒè¯•ï¼Œä¸ä»…å…¨æ˜¯æœ¬ç§‘çš„çŸ¥è¯†ï¼Œè¿˜æ¯”æˆ‘æœ¬ç§‘å¯†ç å­¦è€ƒå¾—ä¸œè¥¿ç®€å•å¤šäº†ï¼Œå¤§ä½œä¸š 5 ä¸ªæ¨¡å—ï¼ˆAES,DES,MD5,SHA1,RSAï¼‰ï¼Œæˆ‘æœ¬ç§‘å…¨é€šè¿‡è‡ªå®šä¹‰ä»£ç å†™è¿‡ï¼Œå°è£…ä¸ªGUIï¼Œä¸‰å¤©å…‰é€Ÿå®Œæˆï¼Œæœ€åç›´æ¥æ¯«æ— å‹åŠ›åœ°è§„æ ¼åŒ– 94 æ‹¿ä¸‹å®ƒï¼</p><p>CTFï¼Œå¯åŠ¨ï¼ç«èµ›ï¼Œå¯åŠ¨ï¼</p><h2 id="1-2024å¼ºç½‘æ¯å†³èµ›-fak1"><a href="#1-2024å¼ºç½‘æ¯å†³èµ›-fak1" class="headerlink" title="1.[2024å¼ºç½‘æ¯å†³èµ›]fak1"></a>1.[2024å¼ºç½‘æ¯å†³èµ›]fak1</h2><h3 id="1x01-é¢˜ç›®å¤§æ„"><a href="#1x01-é¢˜ç›®å¤§æ„" class="headerlink" title="1x01 é¢˜ç›®å¤§æ„"></a>1x01 é¢˜ç›®å¤§æ„</h3><p>ä¸€ä¸ªNTRUé¢˜ç›®ï¼Œå…ˆçœ‹çœ¼é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_timeout</span>(<span class="hljs-params">signum, frame</span>):<br>    <span class="hljs-keyword">raise</span> TimeoutError(<span class="hljs-string">&#x27;function timeout&#x27;</span>)<br><br>timeout = <span class="hljs-number">60</span><br>signal.signal(signal.SIGALRM, _handle_timeout)<br>signal.alarm(timeout)<br><br>load(<span class="hljs-string">&quot;ntru.sage&quot;</span>)<br>p,n,q,dg,df = <span class="hljs-number">3</span>,<span class="hljs-number">117</span>,<span class="hljs-number">1091</span>,<span class="hljs-number">35</span>,<span class="hljs-number">37</span><br><br><br>cs = []<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Game</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        pk,sk = genKeys()<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-number">1</span> / pk<br>            <span class="hljs-built_in">print</span>(pk.<span class="hljs-built_in">list</span>())<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>                <br>    secret = os.urandom(<span class="hljs-number">23</span>)<br>    secretPoly = MsgtoPoly(secret)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Welcome to fak1. You can send some message to me. Have fun!&quot;</span>)<br>    msgs = [[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">116</span>)]]<br><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        msg = [<span class="hljs-built_in">round</span>(<span class="hljs-built_in">int</span>(i,<span class="hljs-number">16</span>) % <span class="hljs-number">3329</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Give me a list of message (hex):&quot;</span>).split(<span class="hljs-string">&quot; &quot;</span>)]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(msg) != <span class="hljs-number">116</span> <span class="hljs-keyword">or</span> (msg <span class="hljs-keyword">in</span> msgs):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You bad!&quot;</span>)<br>            <span class="hljs-keyword">return</span><br>        msgs.append(msg)<br>        m = secretPoly + QR([<span class="hljs-built_in">round</span>(i / <span class="hljs-number">3329</span> * q) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> msg])<br>        c = encrypt(pk,m)<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">assert</span> m == decrypt(sk,c)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You bad!!&quot;</span>)<br>            <span class="hljs-keyword">return</span><br>        <span class="hljs-built_in">print</span>(c.<span class="hljs-built_in">list</span>())<br><br>    <span class="hljs-keyword">if</span> long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;You wanner say something? :&quot;</span>), <span class="hljs-number">16</span>)) == secret:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;flag&#123;Success at :&#x27;</span>+<span class="hljs-built_in">str</span>(datetime.now())+<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You good!&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;OK, bye bye~&quot;</span>) <br><br>Game()<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#ntru.sage</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long,long_to_bytes<br><br>p,n,q,dg,df = <span class="hljs-number">3</span>,<span class="hljs-number">117</span>,<span class="hljs-number">1091</span>,<span class="hljs-number">35</span>,<span class="hljs-number">37</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(q))<br>RR.&lt;xx&gt; = PolynomialRing(Zmod(p))<br>QR = R.quotient(x ^ n + <span class="hljs-number">1</span>)<br>QRR = RR.quotient(xx ^ n + <span class="hljs-number">1</span>)<br>flag = <span class="hljs-string">b&quot;flag&#123;*******************************************&#125;&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">balancemodlist</span>(<span class="hljs-params"><span class="hljs-type">List</span>,p</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-type">List</span>)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(<span class="hljs-type">List</span>[i]) &gt; p / <span class="hljs-number">2</span>:<br>            <span class="hljs-type">List</span>[i] = <span class="hljs-built_in">int</span>(<span class="hljs-type">List</span>[i]) - p<br>    <span class="hljs-keyword">return</span> <span class="hljs-type">List</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">randomPoly</span>(<span class="hljs-params">d = <span class="hljs-number">0</span></span>):<br>    <span class="hljs-keyword">if</span> d == <span class="hljs-number">0</span>:<br>        poly = QR([random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)])<br>    <span class="hljs-keyword">else</span>:<br>        L_0 = [<span class="hljs-number">0</span>] * (n - <span class="hljs-number">2</span> * d - <span class="hljs-number">1</span>)<br>        L_1 = (d + <span class="hljs-number">1</span>) * [<span class="hljs-number">1</span>]<br>        L_2 = d * [-<span class="hljs-number">1</span>]<br>        L = L_0 + L_1 + L_2<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(randint(<span class="hljs-number">5</span>,<span class="hljs-number">10</span>)):<br>            random.shuffle(L)<br>        poly = QR(L)<br>    <span class="hljs-keyword">return</span> poly<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genPrivKey</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        poly = randomPoly(df)<br>        <span class="hljs-keyword">try</span>:<br>            poly_q = (<span class="hljs-number">1</span> / QR(poly))<br>            poly_p = (<span class="hljs-number">1</span> / QRR(RR(balancemodlist(poly.<span class="hljs-built_in">list</span>(),q))))   <br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> poly, poly_q, poly_p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">MsgtoPoly</span>(<span class="hljs-params">msg</span>):<br>    msg = Integer(bytes_to_long(msg))<br>    m = msg.digits(p)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(m)):<br>        <span class="hljs-keyword">if</span> m[i] &gt; p / <span class="hljs-number">2</span>:<br>            m[i] -= p<br>    <span class="hljs-keyword">return</span> QR(m)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genKeys</span>():<br>    f, f_q, f_p = genPrivKey()<br>    g = randomPoly(dg)<br>    pk = QR(p * g * f_q)<br>    sk = (f,f_q,f_p,g)<br>    <span class="hljs-keyword">return</span> pk,sk<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">pk, m</span>):<br>    r = randomPoly()<br>    <span class="hljs-keyword">return</span> pk * r + m<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">sk,c</span>):<br>    f,_,f_p,_ = sk<br>    m = QR(balancemodlist((QRR(balancemodlist((f * c).<span class="hljs-built_in">list</span>(),q)) * f_p).<span class="hljs-built_in">list</span>(),p))<br>    <span class="hljs-keyword">return</span> m<br></code></pre></td></tr></table></figure><h3 id="1x02-é¢˜ç›®åˆ†æ"><a href="#1x02-é¢˜ç›®åˆ†æ" class="headerlink" title="1x02 é¢˜ç›®åˆ†æ"></a>1x02 é¢˜ç›®åˆ†æ</h3><p>å…ˆå›é¡¾ä¸€ä¸‹NTRUåŠ å¯†è¿‡ç¨‹ï¼šäº§ç”Ÿç§é’¥ $f(x)\in T(d_f,d_f-1)$ï¼Œå…¶ä¸­ $T(d_1,d_2)$ è¡¨ç¤ºå…·æœ‰ $d_1$ ä¸ªç³»æ•°ä¸º $1$ï¼Œ$d_2$ ä¸ªç³»æ•°ä¸º $-1$ çš„å¤šé¡¹å¼é›†åˆã€‚ç„¶åè®¡ç®— $f_p(x)&#x3D;R_p\left(\dfrac{1}{f(x)}\right)$ï¼Œ $f_q(x)&#x3D;R_q\left(\dfrac{1}{f(x)}\right)$ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œéšæœºäº§ç”Ÿä»…å«ç³»æ•° $0,1$ çš„å¤šé¡¹å¼ $g(x)\in R_q$ã€‚ç§é’¥ä¸º $f(x),f_p(x),f_q(x),g(x)$ï¼Œå…¬é’¥ä¸º $h(x)&#x3D;pg(x)f_q(x)\in R_q$ã€‚åŠ å¯†æ–¹å¼ä¸ºéšæœºäº§ç”Ÿå°ç³»æ•°å¤šé¡¹å¼ $r(x)$ï¼Œè®¡ç®— $c(x)&#x3D;h(x)r(x)+m(x)$</p><p>è¿™é‡Œï¼Œæ˜¯ç»™å‡ºäº† 10 æ¬¡æœºä¼šï¼Œæ¯æ¬¡è®©ä½ é€‰æ‹©ä¸€ä¸ª $m(x)$ï¼Œç„¶åä¼šç»™å‡º $c_i(x)&#x3D;h(x)r_i(x)+s(x)+m_i(x)$ ã€‚å…¶ä¸­ï¼š$h(x),c(x)$ å·²çŸ¥ï¼Œ$m_i(x)$ è‡ªè¡Œæ„é€ ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æœ‰ $\bar c_i(x)&#x3D;c_i(x)-m_i(x)&#x3D;h(x)r_i(x)+s(x)$ã€‚</p><p>å¤„ç†ä¹‹åï¼Œç”±äº $r(x)$ ä»…åŒ…å« $0,1$ï¼Œå¯ä»¥è®¡ç®— $d_i(x)&#x3D;\bar c_0(x)-\bar c_i(x),x&#x3D;1,2,â€¦,9$ï¼Œæ¥æ¶ˆé™¤ $s(x)$ã€‚å†è®¡ç®— $\bar d_i(x)&#x3D;\dfrac{d_i(x)}{h(x)}$ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸¤ä¸ª $r_0(x)-r_i(x)$ çš„å·®äº†ï¼Œå¦‚æœæŸä¸ªç³»æ•°æ˜¯ $1$ï¼Œåˆ™è¯´æ˜ $r_0(x)$ å¯¹åº”ç³»æ•°ä¸º $1$ï¼›å¦‚æœæŸä¸ªç³»æ•°æ˜¯ $-1$ï¼Œåˆ™è¯´æ˜ $r_0(x)$ å¯¹åº”çš„ç³»æ•°ä¸º $0$ï¼›å¦‚æœä¸º $0$ï¼Œè¯´æ˜æ— æ³•ç¡®å®šè¿™ä¸ªæƒ…å†µã€‚ä½† $9$ ç»„æ•°æ®ï¼ŒåŸºæœ¬å¤Ÿç”¨äº†ã€‚ã€‚ã€‚</p><h3 id="1x03-exp"><a href="#1x03-exp" class="headerlink" title="1x03  exp"></a>1x03  exp</h3><p>ä¸æ˜¯å¾ˆéš¾ï¼Œä½†NTRUä»¥å‰è‡ªå·±æ²¡è§è¿‡ï¼Œç¡®å®ä¸å¤ªå¥½æã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#from sage.all import *</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>o1.&lt;u&gt;=PolynomialRing(GF(<span class="hljs-number">3</span>))<br>o2.&lt;v&gt;=PolynomialRing(GF(<span class="hljs-number">1091</span>))<br>Rp=o1.quotient(u**<span class="hljs-number">117</span>+<span class="hljs-number">1</span>)<br>Rq=o2.quotient(v**<span class="hljs-number">117</span>+<span class="hljs-number">1</span>)<br>sh=process([<span class="hljs-string">&#x27;python3&#x27;</span>,<span class="hljs-string">&#x27;task.py&#x27;</span>])<br><br>Hx=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-built_in">print</span>(Hx)<br>farr=[]<br>carr=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>sh.recvuntil(<span class="hljs-string">b&quot;Give me a list of message (hex):&quot;</span>)<br>f=<span class="hljs-string">&quot;1&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">115</span>):<br>f+=<span class="hljs-string">&quot; &quot;</span>+<span class="hljs-built_in">str</span>(randint(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>))<br>farr.append(f)<br>sh.sendline(f.encode())<br>c=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-comment">#print(c)</span><br>carr.append(c)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>farr[i]=farr[i].split(<span class="hljs-string">&quot; &quot;</span>)<br>farr[i]=[<span class="hljs-built_in">round</span>(<span class="hljs-built_in">int</span>(j)/<span class="hljs-number">3329</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> farr[i]]<br>farr[i]=Rq(farr[i])<br>carr[i]=Rq(carr[i])<br>Hx=Rq(Hx)<br><br>dcarr=[(-carr[i]+carr[<span class="hljs-number">0</span>])/Hx <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>)]<br><span class="hljs-comment"># print(dcarr[7])</span><br><span class="hljs-comment"># # #print(dcarr[0])</span><br>rx=[-<span class="hljs-number">2</span>]*<span class="hljs-number">116</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>ldci=<span class="hljs-built_in">list</span>(dcarr[i])<br><span class="hljs-comment">#print(ldci)</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">116</span>):<br><span class="hljs-keyword">if</span>(rx[j]==-<span class="hljs-number">2</span>):<br><span class="hljs-keyword">if</span>(ldci[j]==<span class="hljs-number">1</span>):<br>rx[j]=<span class="hljs-number">1</span><br><span class="hljs-keyword">if</span>(ldci[j]==<span class="hljs-number">1090</span>):<br>rx[j]=<span class="hljs-number">0</span><br><br><span class="hljs-keyword">assert</span> -<span class="hljs-number">2</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> rx<br>rx=Rq(rx)<br>sx=carr[<span class="hljs-number">0</span>]-Hx*rx<br><span class="hljs-built_in">print</span>(sx)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">set</span>(<span class="hljs-built_in">list</span>(sx))==&#123;<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1090</span>&#125;<br>sh.recvuntil(<span class="hljs-string">b&quot;You wanner say something? :&quot;</span>)<br>A=<span class="hljs-number">0</span><br>lsx=<span class="hljs-built_in">list</span>(sx)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">117</span>):<br><span class="hljs-keyword">if</span>(lsx[i]==<span class="hljs-number">1</span>):<br>A+=<span class="hljs-number">3</span>**i<br><span class="hljs-keyword">if</span>(lsx[i]==<span class="hljs-number">1090</span>):<br>A+=<span class="hljs-number">2</span>*<span class="hljs-number">3</span>**i<br>sh.sendline(<span class="hljs-built_in">hex</span>(A)[<span class="hljs-number">2</span>:].encode())<br><span class="hljs-built_in">print</span>(sh.recvall())<br>sh.close()<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœï¼š</p><p><img src="/2025/01/12/25Jan1/1.png" alt="1"></p><h2 id="2-2024å¼ºç½‘æ¯å†³èµ›-f2ke"><a href="#2-2024å¼ºç½‘æ¯å†³èµ›-f2ke" class="headerlink" title="2.[2024å¼ºç½‘æ¯å†³èµ›]f2ke"></a>2.[2024å¼ºç½‘æ¯å†³èµ›]f2ke</h2><h3 id="2x01-é¢˜ç›®å¤§æ„"><a href="#2x01-é¢˜ç›®å¤§æ„" class="headerlink" title="2x01 é¢˜ç›®å¤§æ„"></a>2x01 é¢˜ç›®å¤§æ„</h3><p>è€è§„çŸ©ï¼Œè¿˜æ˜¯å…ˆçœ‹ä¸€çœ‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_timeout</span>(<span class="hljs-params">signum, frame</span>):<br>    <span class="hljs-keyword">raise</span> TimeoutError(<span class="hljs-string">&#x27;function timeout&#x27;</span>)<br><br>timeout = <span class="hljs-number">70</span><br>signal.signal(signal.SIGALRM, _handle_timeout)<br>signal.alarm(timeout)<br><br>load(<span class="hljs-string">&quot;ntru.sage&quot;</span>)<br>p,n,q,dg,df = <span class="hljs-number">3</span>,<span class="hljs-number">117</span>,<span class="hljs-number">1091</span>,<span class="hljs-number">35</span>,<span class="hljs-number">37</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Game</span>():<br>    secret = os.urandom(<span class="hljs-number">23</span>)<br>    secretpoly = MsgtoPoly(secret)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Welcome to f2ke. You can send some message to me. Have fun!&quot;</span>)<br>    msgs = [[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">116</span>)]]<br><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>((n + <span class="hljs-number">3</span>) // <span class="hljs-number">2</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            pk,sk = genKeys()<br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-number">1</span> / pk<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-keyword">pass</span><br>        msg = [<span class="hljs-built_in">round</span>(<span class="hljs-built_in">int</span>(i,<span class="hljs-number">16</span>) % <span class="hljs-number">3329</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Give me a list of message (hex):&quot;</span>).split(<span class="hljs-string">&quot; &quot;</span>)]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(msg) != <span class="hljs-number">116</span> <span class="hljs-keyword">or</span> (msg <span class="hljs-keyword">in</span> msgs):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You bad!&quot;</span>)<br>            <span class="hljs-keyword">return</span><br>        msgs.append(msg)<br>        m = secretpoly + QR([<span class="hljs-built_in">round</span>(i / <span class="hljs-number">3329</span> * q) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> msg])<br>        c = encrypt(pk,m)<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">assert</span> m == decrypt(sk,c)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You bad!!&quot;</span>)<br>            <span class="hljs-keyword">return</span><br>        <span class="hljs-built_in">print</span>(c.<span class="hljs-built_in">list</span>())<br>        <span class="hljs-built_in">print</span>(pk.<span class="hljs-built_in">list</span>())<br><br>    <span class="hljs-keyword">if</span> long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;You wanner say something? :&quot;</span>), <span class="hljs-number">16</span>)) == secret:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;flag&#123;Success at :&#x27;</span>+<span class="hljs-built_in">str</span>(datetime.now())+<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You good!&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;OK, bye bye~&quot;</span>) <br><br>Game()<br><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå’Œä¸Šä¸€é¢˜çš„åŒºåˆ«ï¼Œå°±åœ¨äºï¼šæ¯ä¸€æ¬¡çš„å…¬é’¥ $h(x)$ éƒ½äº§ç”Ÿäº†å˜åŒ–ï¼Œå¹¶ä¸”äº¤äº’æ¬¡æ•°è¾¾åˆ°äº† $60$ æ¬¡ã€‚ä¹ä¸€çœ‹ï¼Œæ„Ÿè§‰æ˜¯NTRUçš„å¹¿æ’­æ”»å‡»ï¼Œä½†æ„Ÿè§‰æ¬¡æ•°ä¸å¤ªå¤Ÿã€‚ï¼ˆç¡®å®ä¸å¤ªå¤Ÿï¼Œè¦ $176$ æ¬¡äº¤äº’ï¼‰</p><h3 id="2x02-NTRUçš„å¹¿æ’­æ”»å‡»å­¦ä¹ "><a href="#2x02-NTRUçš„å¹¿æ’­æ”»å‡»å­¦ä¹ " class="headerlink" title="2x02 NTRUçš„å¹¿æ’­æ”»å‡»å­¦ä¹ "></a>2x02 NTRUçš„å¹¿æ’­æ”»å‡»å­¦ä¹ </h3><h4 id="2x02-1-modulus-x-n-1"><a href="#2x02-1-modulus-x-n-1" class="headerlink" title="2x02.1 modulus&#x3D;$x^n-1$"></a>2x02.1 modulus&#x3D;$x^n-1$</h4><p>ä¸è¿‡ï¼Œè‡ªå·±è¿™ä¸ªæ—¶å€™è¿˜ä¸å¤ªä¼šNTRUçš„å¹¿æ’­æ”»å‡»ï¼Œäºæ˜¯ï¼Œå…ˆå­¦ä¸€ä¸‹NTRUçš„å¹¿æ’­æ”»å‡»ã€‚åœ¨åŸå§‹NTRUä¸­ï¼Œä½¿ç”¨çš„å–æ¨¡å¤šé¡¹å¼æ˜¯ $x^n-1$ï¼Œä½†é¢˜ç›®æ˜¯ $x^n+1$ï¼Œå› æ­¤å…ˆçœ‹ $x^n-1$ çš„æƒ…å†µï¼š</p><p>å½“æ¨¡æ•°ä¸º $x^n-1$ æ—¶ï¼Œå¯¹åº”çš„å…¬é’¥ $h(x)$ çš„ç³»æ•°çŸ©é˜µä¸ºä¸€ä¸ªå¾ªç¯çŸ©é˜µï¼Œç±»ä¼¼äºè¿™æ ·çš„å½¢å¼ï¼Œè¯¥çŸ©é˜µå¤§æ¦‚ç‡å¯é€†ï¼š</p><p><img src="/2025/01/12/25Jan1/2.png" alt="2"></p><p>å› æ­¤ï¼ŒNTRUå†™æˆçŸ©é˜µçš„å½¢å¼å°±æ˜¯ï¼š<br>$$<br>H\vec r+\vec m&#x3D;\vec c<br>$$<br>ç”±äºçŸ©é˜µ $H$ å¤§æ¦‚ç‡å¯é€†ï¼Œé‚£ä¹ˆå¯ä»¥æœ‰ï¼š<br>$$<br>\vec r+H^{-1}\vec m&#x3D;H^{-1}\vec c<br>$$<br>è®¾ $H^{-1}&#x3D;K,H^{-1}\vec c&#x3D;\vec b$ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼å­å˜æˆï¼š<br>$$<br>\vec r+K\vec m&#x3D;\vec b<br>$$<br>ç§»é¡¹ï¼Œæœ‰<br>$$<br>\vec r&#x3D;\vec b-K\vec m<br>$$<br>ä¸¤è¾¹å¹³æ–¹ï¼š<br>$$<br>\vec r^2&#x3D;\vec b^2-2\vec b\cdot(K\vec m)+(K\vec m)^2<br>$$<br>å¦‚æœæˆ‘ä»¬å·²çŸ¥ $\vec r^2$ï¼Œé‚£ä¹ˆï¼Œå¯ä»¥æœ‰ï¼š<br>$$<br>\vec r^2-\vec b^2&#x3D;(K\vec m)^2-2\vec b\cdot(K\vec m)<br>$$<br>å†™å¾—è§„èŒƒä¸€ç‚¹ï¼Œå°±æ˜¯ï¼š<br>$$<br>\vec r^2-\vec b^2&#x3D;\vec m^TK^TK\vec m-2\left(\vec b^TK\right)\vec m<br>$$<br>è®¾ï¼š</p><p><img src="/2025/01/12/25Jan1/3.png" alt="3"></p><p>å¯ä»¥å¾—åˆ°ï¼š</p><p><img src="/2025/01/12/25Jan1/4.png" alt="4"></p><p>å…¶ä¸­ $s&#x3D;\vec r^2-\vec b^2$ï¼Œè¿™é‡Œ $\vec r^2$ å·²çŸ¥ã€‚ç”±äº $\vec r$ ä»…å« $0,1,-1$ï¼Œé‚£ä¹ˆ $\vec r^2$ å°±æ˜¯ $\vec r$ ä¸­éé›¶åˆ†é‡çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆæœ€ç»ˆç»“æœä¸º</p><p><img src="/2025/01/12/25Jan1/5.png" alt="5"></p><p>å› æ­¤ï¼Œè¿™é‡Œæœ‰ $n+\left\lceil\dfrac{n}{2}\right\rceil$ ä¸ªæœªçŸ¥æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦æ„é€ å¯¹åº”æ•°é‡çš„æ–¹ç¨‹ï¼Œå°±å¯ä»¥å»è§£æ–¹ç¨‹äº†ï¼</p><p>ä¸è¿‡è‡ªå·±æ ¹æ®è®ºæ–‡ä»£ç å®ç°æ—¶ï¼Œå‘ç°æ€»æœ‰ç‚¹å°é—®é¢˜ï¼ŒçŸ©é˜µä¸æ»¡ç§©ï¼Œå¯¼è‡´æœ€åç»“æœæ€»æ˜¯ä¼šåç§» $x^{n-1}$ çš„ç³»æ•°ã€‚åæ­£é‚£ä¸ªå€¼å°±æ˜¯ $0,Â±1$ï¼Œç‰¹åˆ¤ä¸€ä¸‹å°±è¡Œã€‚</p><p>Codeï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long,long_to_bytes<br><br>p,n,q,dg,df = <span class="hljs-number">3</span>,<span class="hljs-number">117</span>,<span class="hljs-number">1091</span>,<span class="hljs-number">35</span>,<span class="hljs-number">37</span><br>dr=<span class="hljs-number">37</span> <span class="hljs-comment">#æœ‰å˜åŒ–</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(q))<br>RR.&lt;xx&gt; = PolynomialRing(Zmod(p))<br>QR = R.quotient(x ^ n - <span class="hljs-number">1</span>) <span class="hljs-comment">#æœ‰å˜åŒ–</span><br>QRR = RR.quotient(xx ^ n - <span class="hljs-number">1</span>) <span class="hljs-comment">#æœ‰å˜åŒ–</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">balancemodlist</span>(<span class="hljs-params"><span class="hljs-type">List</span>,p</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-type">List</span>)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(<span class="hljs-type">List</span>[i]) &gt; p / <span class="hljs-number">2</span>:<br>            <span class="hljs-type">List</span>[i] = <span class="hljs-built_in">int</span>(<span class="hljs-type">List</span>[i]) - p<br>    <span class="hljs-keyword">return</span> <span class="hljs-type">List</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">randomPoly</span>(<span class="hljs-params">d = <span class="hljs-number">0</span></span>):<br>    <span class="hljs-keyword">if</span> d == <span class="hljs-number">0</span>:<br>        poly = QR([random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)])<br>    <span class="hljs-keyword">else</span>:<br>        L_0 = [<span class="hljs-number">0</span>] * (n - <span class="hljs-number">2</span> * d - <span class="hljs-number">1</span>)<br>        L_1 = (d + <span class="hljs-number">1</span>) * [<span class="hljs-number">1</span>]<br>        L_2 = d * [-<span class="hljs-number">1</span>]<br>        L = L_0 + L_1 + L_2<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(randint(<span class="hljs-number">5</span>,<span class="hljs-number">10</span>)):<br>            random.shuffle(L)<br>        poly = QR(L)<br>    <span class="hljs-keyword">return</span> poly<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genPrivKey</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        poly = randomPoly(df)<br>        <span class="hljs-keyword">try</span>:<br>            poly_q = (<span class="hljs-number">1</span> / QR(poly))<br>            poly_p = (<span class="hljs-number">1</span> / QRR(RR(balancemodlist(poly.<span class="hljs-built_in">list</span>(),q))))<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> poly, poly_q, poly_p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genKeys</span>():<br>    f, f_q, f_p = genPrivKey()<br>    g = randomPoly(dg)<br>    pk = QR(p * g * f_q)<br>    sk = (f,f_q,f_p,g)<br>    <span class="hljs-keyword">return</span> pk,sk<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">pk, m</span>):<br>    r = randomPoly(dr)<span class="hljs-comment">#æœ‰å˜åŒ–</span><br>    <span class="hljs-keyword">return</span> pk * r + m<br><br><br>mx=R([randint(-<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)])<br>Fxarr=[]<br>Fqxarr=[]<br>Fpxarr=[]<br>Gxarr=[]<br>Hxarr=[]<br>Cxarr=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">200</span>):<br>    pk,sk=genKeys()<br>    fx,fqx,fpx,gx=sk<br>    hx=pk<br>    Fxarr.append(fx)<br>    Fqxarr.append(fqx)<br>    Fpxarr.append(fpx)<br>    Gxarr.append(gx)<br>    Hxarr.append(hx)<br>    cx=encrypt(hx,mx)<br>    Cxarr.append(cx)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;mx(for debug check)=&#x27;</span>,<span class="hljs-built_in">list</span>(mx))<br>HxMatrixarr=[]<br>CxVecarr=[]<br><span class="hljs-keyword">for</span> hx <span class="hljs-keyword">in</span> Hxarr:<br>    HxMatrixarr.append(Matrix(GF(q),[<span class="hljs-built_in">list</span>(hx*x**(i)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]).T)<br>KxMatrixarr=[mhx**-<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> mhx <span class="hljs-keyword">in</span> HxMatrixarr]<br><span class="hljs-keyword">for</span> cx <span class="hljs-keyword">in</span> Cxarr:<br>    CxVecarr.append(vector(GF(q),<span class="hljs-built_in">list</span>(cx)))<br>BxVecarr=[mkx*vcx <span class="hljs-keyword">for</span> mkx,vcx <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(KxMatrixarr,CxVecarr)]<br>A=[]<br>y=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>+n+((n+<span class="hljs-number">1</span>)&gt;&gt;<span class="hljs-number">1</span>)):<br>    Kx=KxMatrixarr[i]<br>    vecb=BxVecarr[i]<br>    vecw=vecb*Kx<br>    veca=((Kx.T*Kx).T)[<span class="hljs-number">0</span>]<br>    uke=[veca[<span class="hljs-number">0</span>]]+[<span class="hljs-number">2</span>*veca[i+<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n//<span class="hljs-number">2</span>)]<br>    uke+=<span class="hljs-built_in">list</span>(-<span class="hljs-number">2</span>*vecw)<br>    A.append(uke)<br>    y.append(<span class="hljs-number">2</span>*dr+<span class="hljs-number">1</span>-vecb*vecb)<br>A=matrix(GF(q),A)<br>y=vector(GF(q),y)<br>res=(A.solve_right(y))<br><span class="hljs-built_in">print</span>(res[-n:])<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(mx))<br>reschk=<span class="hljs-built_in">set</span>(<span class="hljs-built_in">list</span>(res[-n:]))<br><span class="hljs-keyword">if</span>(<span class="hljs-number">2</span> <span class="hljs-keyword">in</span> reschk):<br>    res-=vector([<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(res))])<br><span class="hljs-keyword">elif</span>(q-<span class="hljs-number">2</span> <span class="hljs-keyword">in</span> reschk):<br>    res+=vector([<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(res))])<br><span class="hljs-built_in">print</span>(res[-n:])<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(res[-n:])==<span class="hljs-built_in">list</span>(mx))<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(datetime.now()))<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¾“å‡ºç»“æœï¼ˆå¾ˆæ˜¾ç„¶ï¼Œè§£å‡ºæ¥çš„ç»“æœæœ‰ $-2$ï¼Œè¯´æ˜æ•´ä½“åç§»äº†ä¸€ä¸ª $ -1$ï¼Œç›´æ¥è°ƒå›æ¥å°±è¡Œï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">(<span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1089</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>) <br>[<span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]<br>(<span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br><span class="hljs-literal">True</span><br><span class="hljs-number">2025</span>-01-<span class="hljs-number">11</span> <span class="hljs-number">10</span>:<span class="hljs-number">11</span>:<span class="hljs-number">33.085945</span><br></code></pre></td></tr></table></figure><h4 id="2x02-2é¢˜ç›®å‚æ•°"><a href="#2x02-2é¢˜ç›®å‚æ•°" class="headerlink" title="2x02.2é¢˜ç›®å‚æ•°"></a>2x02.2é¢˜ç›®å‚æ•°</h4><p>åœ¨ææ‡‚åŸºæœ¬åŸç†åï¼Œæˆ‘ä»¬å›åˆ°é¢˜ç›®çš„å‚æ•°ï¼Œç”±äºæ¨¡æ•°å˜æˆäº† $x^n+1$ï¼Œå¹¶ä¸”ï¼Œ $\vec r$ ä¸ºå®Œå…¨éšæœºçš„ $0,1$ å‘é‡ã€‚ </p><p>æ—¢ç„¶æ¨¡æ•°æ”¹å˜äº†ï¼Œé‚£ä¹ˆä¹‹å‰çš„çŸ©é˜µä¹Ÿä¼šæœ‰æ‰€å˜åŒ–ï¼Œéœ€è¦é‡æ–°è®¾ä¸ºï¼š</p><p><img src="/2025/01/12/25Jan1/6.png" alt="6"></p><p>ç”±äºåˆšæ‰æ˜¯ $\vec r&#x3D;\vec b-K\vec m$ï¼Œè¿™é‡Œå¯ä»¥ä¸¤è¾¹ä¹˜ $2$ï¼Œå†å‡å»ä¸€ä¸ªå…¨ $1$ å‘é‡ï¼Œå˜ä¸ºï¼š<br>$$<br>2\vec r-\vec 1&#x3D;2(\vec b-K\vec m)-\vec 1<br>$$<br>ç”±äº $\vec r$ ä»…å« $0,1$ï¼Œé‚£ä¹ˆ $2\vec r-\vec 1$ å°±ä»…å« $-1,1$ äº†ï¼Œä¸¤è¾¹å¹³æ–¹æœ‰ï¼š<br>$$<br>(2\vec r-\vec 1)^2&#x3D;4(\vec b-K\vec m)^2-4(\vec b-K\vec m)\cdot \vec 1+\vec 1^2<br>$$<br>ç”±äº $(2\vec r-\vec 1)^2&#x3D;\vec 1^2&#x3D;n$ï¼Œè¿™ä¸¤ä¸ªå¯ä»¥ç›´æ¥çº¦æ‰ï¼Œç„¶åè¿›è¡Œç³»æ•°åŒ–ç®€ï¼š<br>$$<br>0&#x3D;(\vec b-K\vec m)^2-(\vec b-K\vec m)\cdot \vec 1<br>$$<br>ç»§ç»­å¤„ç†ä¸€ä¸‹ï¼š<br>$$<br>\vec b^2-\vec b\cdot \vec 1&#x3D;2\vec b^TK\vec m-\vec m^TK^TK\vec m-(K\vec m)\cdot \vec 1<br>$$<br>å·¦è¾¹çš„éƒ½æ˜¯å·²çŸ¥é‡ï¼Œå¾ˆå¥½ç®—ï¼Œç„¶åæˆ‘ä»¬çœ‹çœ‹å³è¾¹ä¸‰é¡¹çš„è¡¨è¾¾å¼ï¼š</p><p>ç¬¬ä¸€é¡¹ç»™æ‰€æœ‰çš„ $m_i$ é¡¹å¸¦æ¥äº†ä¸€ä¸ª $w_i$ï¼›ç¬¬ä¸‰é¡¹ç»™æ¯ä¸ª $ m_i$ åˆå¸¦æ¥äº†ä¸€ä¸ª $K$ çš„ç¬¬ $i$ åˆ—ç³»æ•°ä¹‹å’Œï¼Œå³ $m_i$ çš„ç³»æ•°ä¸º$\sum_j K^{T}_{ij}$</p><p>è€Œç¬¬äºŒé¡¹ä¹Ÿå‡ºç°äº†ä¸€ç‚¹ç‚¹å°å˜åŒ–ï¼šæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°æ­¤æ—¶æœ‰ $x_i&#x3D;-x_{n-i}$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">var(<span class="hljs-string">&quot;a0 a1 a2 a3 a4&quot;</span>)<br>var(<span class="hljs-string">&quot;m0 m1 m2 m3 m4&quot;</span>)<br>v=vector([m0,m1,m2,m3,m4])<br>M=[[a0,-a4,-a3,-a2,-a1],<br>[a1,a0,-a4,-a3,-a2],<br>[a2,a1,a0,-a4,-a3],<br>[a3,a2,a1,a0,-a4],<br>[a4,a3,a2,a1,a0]]<br>M=matrix(M)<br>v*M*v<br>f=v*M*v<br>xarr=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [a0,a1,a2,a3,a4]:<br>    xarr.append(f.differentiate(i))<br><span class="hljs-built_in">print</span>(xarr[<span class="hljs-number">1</span>]+xarr[<span class="hljs-number">4</span>],xarr[<span class="hljs-number">2</span>]+xarr[<span class="hljs-number">3</span>])<br><span class="hljs-comment">#0 0</span><br></code></pre></td></tr></table></figure><p>ç„¶åå†è€ƒå¯Ÿä¸€ä¸‹ $K^TK$ï¼Œæµ‹è¯•å‘ç°ï¼Œæœ‰ $a_i&#x3D;-a_{n-i}$</p><p>é‚£ä¹ˆï¼š $a_ix_i+a_{n-i}x_{n-i}$ï¼Œç…§æ ·ç­‰äº $2a_ix_i$ã€‚é‚£ä¹ˆå¯ä»¥ä¸å¯¹åŸæ¥çš„ntru.sageæ–‡ä»¶åšä»»ä½•æ”¹å˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python">load(<span class="hljs-string">&#x27;ntru.sage&#x27;</span>)<br>mx=R([randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>)-<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)])<br>Fxarr=[]<br>Fqxarr=[]<br>Fpxarr=[]<br>Gxarr=[]<br>Hxarr=[]<br>Cxarr=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">400</span>):<br>    pk,sk=genKeys()<br>    fx,fqx,fpx,gx=sk<br>    hx=pk<br>    Fxarr.append(fx)<br>    Fqxarr.append(fqx)<br>    Fpxarr.append(fpx)<br>    Gxarr.append(gx)<br>    Hxarr.append(hx)<br>    cx=encrypt(hx,mx)<br>    Cxarr.append(cx)<br><br>HxMatrixarr=[]<br>CxVecarr=[]<br><span class="hljs-keyword">for</span> hx <span class="hljs-keyword">in</span> Hxarr:<br>    HxMatrixarr.append(Matrix(GF(q),[<span class="hljs-built_in">list</span>(hx*x**(i)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]).T)<br>KxMatrixarr=[mhx**-<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> mhx <span class="hljs-keyword">in</span> HxMatrixarr]<br><span class="hljs-keyword">for</span> cx <span class="hljs-keyword">in</span> Cxarr:<br>    CxVecarr.append(vector(GF(q),<span class="hljs-built_in">list</span>(cx)))<br>BxVecarr=[mkx*vcx <span class="hljs-keyword">for</span> mkx,vcx <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(KxMatrixarr,CxVecarr)]<br>A=[]<br>y=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+((n+<span class="hljs-number">1</span>)&gt;&gt;<span class="hljs-number">1</span>)):<br>    Kx=KxMatrixarr[i]<br>    vecb=BxVecarr[i]<br>    vecw=vecb*Kx<br>    veca=((Kx.T*Kx).T)[<span class="hljs-number">0</span>]<br>    uke=[veca[<span class="hljs-number">0</span>]]+[<span class="hljs-number">2</span>*veca[i+<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n//<span class="hljs-number">2</span>)]<br>    ukep=<span class="hljs-built_in">list</span>(<span class="hljs-number">2</span>*vecw)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        ukep[j]-=<span class="hljs-built_in">sum</span>(<span class="hljs-built_in">list</span>(Kx.T[j]))<br>    uke=uke+ukep<br>    A.append(uke)<br>    y.append(vecb*vecb-<span class="hljs-built_in">sum</span>(<span class="hljs-built_in">list</span>(vecb)))<br>A=matrix(GF(q),A)<br>y=vector(GF(q),y)<br>res=(A.solve_right(y))<br>res=R(<span class="hljs-built_in">list</span>(res[-n:]))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(mx))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(res))<br><span class="hljs-built_in">print</span>(res-mx)<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(datetime.now()))<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªä¸ä¸€å®šæ€»èƒ½æ­£å¸¸è¿è¡Œï¼Œå› ä¸ºçŸ©é˜µ $H$ çš„é€†çŸ©é˜µ $H^{-1}$ å¹¶éæ€»å­˜åœ¨ã€‚</p><p><img src="/2025/01/12/25Jan1/7.png" alt="7"></p><h3 id="2x03-ç®€åŒ–ç‰ˆæœ¬ï¼š400æ¬¡è¯¢é—®"><a href="#2x03-ç®€åŒ–ç‰ˆæœ¬ï¼š400æ¬¡è¯¢é—®" class="headerlink" title="2x03 ç®€åŒ–ç‰ˆæœ¬ï¼š400æ¬¡è¯¢é—®"></a>2x03 ç®€åŒ–ç‰ˆæœ¬ï¼š400æ¬¡è¯¢é—®</h3><p>å› æ­¤ï¼Œå¦‚æœåŸé¢˜ç»™å‡º 400 æ¬¡è¯¢é—®ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨å¹¿æ’­æ”»å‡»æ–¹å¼å»åšï¼ˆå…¶å®176æ¬¡å°±å¤Ÿäº†ï¼Œè¿™é‡Œææˆ400æ¬¡ï¼Œä¸»è¦æ˜¯å› ä¸ºä¸€å¼€å§‹æ‡’å¾—ç®—æ¬¡æ•°äº†ï¼Œå®é™…ä¹Ÿåªç”¨äº†176ç»„æ•°æ®ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>sh=process([<span class="hljs-string">&#x27;python3&#x27;</span>,<span class="hljs-string">&#x27;task.py&#x27;</span>])<br>q=<span class="hljs-number">1091</span><br>n=<span class="hljs-number">117</span><br>Mxarr=[[getrandbits(<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">116</span>)]<span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">400</span>)]<br>Cxarr=[]<br>Hxarr=[]<br>O7.&lt;x_&gt;=PolynomialRing(GF(q))<br>Rq.&lt;x&gt;=O7.quotient(x_**<span class="hljs-number">117</span>+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">400</span>)):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;Give me a list of message (hex):&#x27;</span>)<br>    s=<span class="hljs-built_in">str</span>(Mxarr[i])[<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br>    s=s.replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>    s=s.replace(<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-comment">#print(s)</span><br>    sh.sendline(s.encode())<br>    Cx=(<span class="hljs-built_in">eval</span>(sh.recvline()))<br>    Hx=(<span class="hljs-built_in">eval</span>(sh.recvline()))<br>    Cxarr.append(Rq(Cx))<br>    Hxarr.append(Rq(Hx))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">400</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">116</span>):<br>        Mxarr[i][j]=<span class="hljs-built_in">round</span>(Mxarr[i][j]/<span class="hljs-number">3329</span>*q)<br>    Mxarr[i]=Rq(Mxarr[i])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">400</span>):<br>    Cxarr[i]=Cxarr[i]-Mxarr[i]<br>HxMatrixarr=[]<br>CxVecarr=[]<br><span class="hljs-keyword">for</span> hx <span class="hljs-keyword">in</span> Hxarr:<br>    HxMatrixarr.append(Matrix(GF(q),[<span class="hljs-built_in">list</span>(hx*x**(i)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]).T)<br>KxMatrixarr=[mhx**-<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> mhx <span class="hljs-keyword">in</span> HxMatrixarr]<br><span class="hljs-keyword">for</span> cx <span class="hljs-keyword">in</span> Cxarr:<br>    CxVecarr.append(vector(GF(q),<span class="hljs-built_in">list</span>(cx)))<br>BxVecarr=[mkx*vcx <span class="hljs-keyword">for</span> mkx,vcx <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(KxMatrixarr,CxVecarr)]<br>A=[]<br>y=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+((n+<span class="hljs-number">1</span>)&gt;&gt;<span class="hljs-number">1</span>)):<br>    Kx=KxMatrixarr[i]<br>    vecb=BxVecarr[i]<br>    vecw=vecb*Kx<br>    veca=((Kx.T*Kx).T)[<span class="hljs-number">0</span>]<br>    uke=[veca[<span class="hljs-number">0</span>]]+[<span class="hljs-number">2</span>*veca[i+<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n//<span class="hljs-number">2</span>)]<br>    ukep=<span class="hljs-built_in">list</span>(<span class="hljs-number">2</span>*vecw)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        ukep[j]-=<span class="hljs-built_in">sum</span>(<span class="hljs-built_in">list</span>(Kx.T[j]))<br>    uke=uke+ukep<br>    A.append(uke)<br>    y.append(vecb*vecb-<span class="hljs-built_in">sum</span>(<span class="hljs-built_in">list</span>(vecb)))<br>A=matrix(GF(q),A)<br>y=vector(GF(q),y)<br>res=(A.solve_right(y))<br>res=Rq(<span class="hljs-built_in">list</span>(res[-n:]))<br><span class="hljs-comment">#print(res)</span><br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(datetime.now()))<br>res=<span class="hljs-built_in">list</span>(res)<br><span class="hljs-built_in">print</span>(res)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(res)):<br>    <span class="hljs-keyword">if</span>(res[i]==q-<span class="hljs-number">1</span>):<br>        res[i]=<span class="hljs-number">2</span><br>res=vector(ZZ,res+[<span class="hljs-number">0</span>]*(<span class="hljs-number">117</span>-<span class="hljs-built_in">len</span>(res)))<br>exp3=vector(ZZ,[<span class="hljs-number">3</span>**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">117</span>)])<br>ans=res*exp3<br><span class="hljs-built_in">print</span>(ans)<br>sh.recvuntil(<span class="hljs-string">b&#x27;You wanner say something? :&#x27;</span>)<br>sh.sendline(<span class="hljs-built_in">hex</span>(ans)[<span class="hljs-number">2</span>:].encode())<br>sh.interactive()<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœï¼š</p><p><img src="/2025/01/12/25Jan1/8.png" alt="8"></p><h3 id="2x04-åŸé¢˜åšæ³•"><a href="#2x04-åŸé¢˜åšæ³•" class="headerlink" title="2x04 åŸé¢˜åšæ³•"></a>2x04 åŸé¢˜åšæ³•</h3><p>åŸé¢˜çš„è¯ï¼Œåªæœ‰60æ¬¡è¯¢é—®æœºä¼šï¼Œæ¬¡æ•°è¿˜æ˜¯ä¸å¤ªå¤Ÿã€‚</p><p>ç„¶ååœ¨2010-598é‚£ç¯‡è®ºæ–‡ä¸­ï¼Œæˆ‘çœ‹åˆ°äº†è¿™æ ·ä¸€å¥è¯ï¼š</p><blockquote><p>å¦‚æœ $ES$ åªæœ‰ $0,1$ ä¸¤ç§å–å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¢åŠ  $n$ ä¸ªæ–¹ç¨‹ï¼š $r_i^2-r_i&#x3D;0$ã€‚</p></blockquote><p>åœ¨ $\vec r&#x3D;\vec b-K\vec m$ ä¸­ï¼Œæˆ‘ä»¬è€ƒå¯Ÿ $\vec r$ çš„æ¯ä¸€ä¸ªåˆ†é‡æ‰€æ¶‰åŠåˆ°çš„å…³ç³»ï¼Œä»¥ä¸‰ä¸ªä¸ºä¾‹ï¼š<br>$$<br>r_0&#x3D;b_0-\vec K_0\vec m&#x3D;b_0-(K_{00}m_0+K_{01}m_1+K_{02}m_2)<br>$$<br>ä¸¤è¾¹å˜æ¢ï¼Œæœ‰ï¼š<br>$$<br>r_0^2-r_0&#x3D;\left(b_0-(K_{00}m_0+K_{01}m_1+K_{02}m_2)\right)^2-(b_0-(K_{00}m_0+K_{01}m_1+K_{02}m_2))<br>$$<br>ç­‰å·å·¦è¾¹æ˜¾ç„¶ä¸º $0$ï¼Œå¯¹ç­‰å·å³è¾¹å±•å¼€ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: var(<span class="hljs-string">&quot;b0 K00 K01 K02 m0 m1 m2&quot;</span>)<br>(b0, K00, K01, K02, m0, m1, m2)<br>sage: f=b0-K00*m0-K01*m1-K02*m2<br>sage: f*(f-<span class="hljs-number">1</span>)<br>(K00*m0 + K01*m1 + K02*m2 - b0 + <span class="hljs-number">1</span>)*(K00*m0 + K01*m1 + K02*m2 - b0)<br>sage: f*(f-<span class="hljs-number">1</span>).expand()<br>(K00*m0 + K01*m1 + K02*m2 - b0 + <span class="hljs-number">1</span>)*(K00*m0 + K01*m1 + K02*m2 - b0)<br>sage: y=f*(f-<span class="hljs-number">1</span>)<br>sage: y.expand()<br>K00^<span class="hljs-number">2</span>*m0^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>*K00*K01*m0*m1 + K01^<span class="hljs-number">2</span>*m1^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>*K00*K02*m0*m2 + <span class="hljs-number">2</span>*K01*K02*m1*m2 + K02^<span class="hljs-number">2</span>*m2^<span class="hljs-number">2</span> - <span class="hljs-number">2</span>*K00*b0*m0 - <span class="hljs-number">2</span>*K01*b0*m1 - <span class="hljs-number">2</span>*K02*b0*m2 + b0^<span class="hljs-number">2</span> + K00*m0 + K01*m1 + K02*m2 - b0<br></code></pre></td></tr></table></figure><p>ç­‰å·ä¸€éç•™ä¸‹ $b_0^2-b_0$ï¼Œé‚£ä¹ˆå³è¾¹å°±æ˜¯è¿™ä¸€å †ç©æ„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">-K00^<span class="hljs-number">2</span>*m0^<span class="hljs-number">2</span> - <span class="hljs-number">2</span>*K00*K01*m0*m1 - K01^<span class="hljs-number">2</span>*m1^<span class="hljs-number">2</span> - <span class="hljs-number">2</span>*K00*K02*m0*m2 - <span class="hljs-number">2</span>*K01*K02*m1*m2 - K02^<span class="hljs-number">2</span>*m2^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>*K00*b0*m0 + <span class="hljs-number">2</span>*K01*b0*m1 + <span class="hljs-number">2</span>*K02*b0*m2 - K00*m0 - K01*m1 - K02*m2<br></code></pre></td></tr></table></figure><p>æ•´ç†ä¸€ä¸‹ï¼š</p><p>ä¸€æ¬¡é¡¹ï¼š $m_0$ ç³»æ•°ä¸º $-2K_{00}b_0+K_{00}$ï¼Œ$m_1$ ç³»æ•°ä¸º $-2K_{01}b_0+K_{01}$ï¼Œ$m_2$ ç³»æ•°ä¸º $-2K_{02}b_0+K_{02}$</p><p>å¹³æ–¹é¡¹ï¼š $m_0^2$ ç³»æ•°ä¸º $-K_{00}^2$ï¼ŒåŒç†ï¼Œ$m_1^2,m_2^2$ çš„ç³»æ•°åˆ†åˆ«ä¸º $-K_{01}^2,-K_{02}^2$ ã€‚</p><p>äº¤å‰é¡¹ï¼š $m_im_j$ ç³»æ•°ä¸º $-2K_{0i}K_{0j}$ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±æœ‰äº† $n$ ä¸ªä¸€æ¬¡é¡¹ï¼Œ$n$ ä¸ªå¹³æ–¹é¡¹ï¼Œ$\dfrac{n(n-1)}{2}$ ä¸ªäº¤å‰é¡¹ï¼Œä¸€å…± $\dfrac{n(n+3)}{2}$ ä¸ªæœªçŸ¥æ•°ï¼Œä¸€æ¬¡å¹¿æ’­æ”»å‡»å¯ä»¥å–å¾— $n$ ä¸ªæœªçŸ¥æ•°ã€‚</p><p>ç„¶åï¼ŒåŸé¢˜æ˜¯ $117$ï¼Œæœ€åçš„çŸ©é˜µè§„æ¨¡é«˜è¾¾ $7020\times7020$ï¼Œå…‰æ˜¯è·‘è¿™ä¸ªæ„é€ å°±è¦è€—æˆ‘ä¸€å°æ—¶ï¼Œåœ¨æœåŠ¡å™¨ä¸Šè·‘å¿«ä¸€ç‚¹ï¼Œä½†2æ ¸2Gçš„æœåŠ¡å™¨ï¼Œç›´æ¥ç‚¸æ‰äº†ã€‚ã€‚ã€‚ã€‚</p><p>ä¸è¿‡ï¼Œä¸ºäº†æµ‹è¯•æ­£ç¡®æ€§ï¼Œè¿˜æ˜¯å¾—åšä¸€ä¸‹çš„ã€‚ã€‚ã€‚ã€‚å› æ­¤ï¼Œæˆ‘æŠŠ $n$ ä» $117$ è°ƒæˆäº† $47$ï¼Œ$d_f,d_g$ ä» $(35,37)$ è°ƒä¸º $(7,7)$ï¼Œä»…ç”¨äºæµ‹è¯•æ­£ç¡®æ€§ï¼Œå› æ­¤ï¼Œæœ€åçš„äº¤äº’æ¬¡æ•°ä¹Ÿä» $60$ ä¸‹é™åˆ°äº† $25$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>sh=process([<span class="hljs-string">&#x27;python3&#x27;</span>,<span class="hljs-string">&#x27;task.py&#x27;</span>])<br>q=<span class="hljs-number">1091</span><br>n=<span class="hljs-number">47</span><br>Mxarr=[[getrandbits(<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">46</span>)]<span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">400</span>)]<br>Cxarr=[]<br>Hxarr=[]<br>K7.&lt;x_&gt;=PolynomialRing(GF(q))<br>Rq.&lt;x&gt;=K7.quotient(x_**n+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">25</span>)):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;Give me a list of message (hex):&#x27;</span>)<br>    s=<span class="hljs-built_in">str</span>(Mxarr[i])[<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br>    s=s.replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>    s=s.replace(<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-string">&#x27; &#x27;</span>)<br>    sh.sendline(s.encode())<br>    Cx=(<span class="hljs-built_in">eval</span>(sh.recvline()))<br>    Hx=(<span class="hljs-built_in">eval</span>(sh.recvline()))<br>    Cxarr.append(Rq(Cx))<br>    Hxarr.append(Rq(Hx))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">25</span>):<br>    Cxarr[i]=Rq(Cxarr[i])<br>    Hxarr[i]=Rq(Hxarr[i])<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br>HxMatrixarr=[]<br>CxVecarr=[]<br><span class="hljs-keyword">for</span> hx <span class="hljs-keyword">in</span> Hxarr:<br>    HxMatrixarr.append(Matrix(GF(q),[<span class="hljs-built_in">list</span>(hx*x**(i)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]).T)<br>KxMatrixarr=[mhx**-<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> mhx <span class="hljs-keyword">in</span> HxMatrixarr]<br><span class="hljs-keyword">for</span> cx <span class="hljs-keyword">in</span> Cxarr:<br>    CxVecarr.append(vector(GF(q),<span class="hljs-built_in">list</span>(cx)))<br>BxVecarr=[mkx*vcx <span class="hljs-keyword">for</span> mkx,vcx <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(KxMatrixarr,CxVecarr)]<br>A=[]<br>y=[]<br><span class="hljs-keyword">for</span> ttt <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">25</span>)):<br>    K=KxMatrixarr[ttt]<br>    b=BxVecarr[ttt]<br>    Kt=K.T<br>    G=Kt*K<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        y.append(b[i]*b[i]-b[i])<br>        singlem=[]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            singlem.append(b[i]*K[i][j]+(b[i]-<span class="hljs-number">1</span>)*K[i][j]) <br>        squarem=[]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            squarem.append(K[i][j]**<span class="hljs-number">2</span>)<br>        crossm=[]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(j+<span class="hljs-number">1</span>, n):<br>                crossm.append(-<span class="hljs-number">2</span>*K[i][j]*K[i][k])<br>        A.append(singlem+squarem+crossm)<br>A=matrix(GF(q),A)<br>y=vector(GF(q),y)<br>res=A.solve_right(y)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(datetime.now()))<br><span class="hljs-built_in">print</span>(res[:n])<br>sh.recvuntil(<span class="hljs-string">b&quot;You wanner say something? :&quot;</span>)<br>vres=res[:n]<br>ans=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    ans+=<span class="hljs-built_in">min</span>(<span class="hljs-number">2</span>,Integer(res[i]))*<span class="hljs-number">3</span>**i<br>sh.sendline(<span class="hljs-built_in">hex</span>(ans)[<span class="hljs-number">2</span>:].encode())<br><span class="hljs-built_in">print</span>(sh.recvall())<br>sh.close()<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><p><img src="/2025/01/12/25Jan1/9.png" alt="9"></p><p>åŸé¢˜çš„æ•°æ®å°±ä¸æµ‹äº†ï¼Œä¸¤è¾¹è®¾å¤‡æ¡ä»¶éƒ½ä¸æ˜¯å¾ˆå…è®¸æˆ‘æµ‹ã€‚ã€‚ã€‚ã€‚æ ¹æ® $O(n^3)$ çš„å¤æ‚åº¦çœ‹ï¼Œç›®æµ‹è¦è·‘ä¸€å¤©ï¼</p><h2 id="3-fake2çš„éé¢„æœŸåšæ³•â€”NTRUå­ç¯æ”»å‡»"><a href="#3-fake2çš„éé¢„æœŸåšæ³•â€”NTRUå­ç¯æ”»å‡»" class="headerlink" title="3.fake2çš„éé¢„æœŸåšæ³•â€”NTRUå­ç¯æ”»å‡»"></a>3.fake2çš„éé¢„æœŸåšæ³•â€”NTRUå­ç¯æ”»å‡»</h2><h3 id="3x01-åˆ†æ"><a href="#3x01-åˆ†æ" class="headerlink" title="3x01 åˆ†æ"></a>3x01 åˆ†æ</h3><p>å…¶å®æˆ‘ä¸€å¼€å§‹å°±å‘ç°ï¼Œè¿™é‡Œç”¨ $117$ ä½œä¸ºæŒ‡æ•°ï¼Œå°±ä¸å¤ªå¯¹ã€‚å¾ˆæ˜æ˜¾ï¼Œ$117&#x3D;3^2\times13$ ï¼Œä¸æ˜¯ä¸€ä¸ªç´ æ•°ã€‚åˆçœ‹åˆ°æ˜¯å¹¿æ’­æ”»å‡»ï¼Œå› æ­¤ä¹Ÿè®¸å¯èƒ½èƒ½CRTï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼š<br>$$<br>x^3+1&#x3D;(x+1)(x^2-x+1)<br>$$<br>é‚£ä¹ˆï¼Œ$x^{117}+1$ ä¹Ÿå¯ä»¥è¢«åˆ†è§£æˆï¼š<br>$$<br>x^{117}+1&#x3D;(x^{39}+1)(x^{78}-x^{39}+1)<br>$$<br>ç„¶åé¢˜ç›®çš„äº¤äº’æ¬¡æ•°æ˜¯ $60$ æ¬¡ï¼Œå¯¹äº $x^{39}+1$ çš„æ¨¡æ•°ï¼Œè²Œä¼¼åˆšå¥½å¤Ÿæ‰“ï¼ˆ59æ¬¡ï¼‰ã€‚ä½†å¯¹äº $x^{78}-x^{39}+1$ å‘¢ï¼Ÿ</p><p>ä¸è¿‡æ®è¯´å¯ä»¥ç›´æ¥å¯¹å…¬é’¥å¼€æ‰“ï¼Œæ„é€ NTRUçŸ©é˜µï¼Œå…¶ä¸­ $H$ çš„ç¬¬ $i$ è¡Œè¡¨ç¤º $x^ih(x)$ çš„åˆ—è¡¨è¡¨ç¤ºï¼Œè¯·æ³¨æ„ï¼Œ$i$ ä» $0$ å¼€å§‹ã€‚</p><p><img src="/2025/01/12/25Jan1/10.png" alt="10"></p><p>å¯¹è¿™ä¸ª $M$ è¿›è¡Œ BKZ ï¼Œæœ€åæœ‰å¯èƒ½å¾—åˆ° $(f,3g)$ çš„å€¼ï¼ˆå› ä¸ºé¢˜ç›®æ˜¯ $h(x)&#x3D;pg(x)r(x),p&#x3D;3$ï¼‰ã€‚ä¸è¿‡è¿™ä¸ª $f$ å¯èƒ½ä¼šå‡ºç° $2$ï¼Œå› ä¸ºæ˜¯åœ¨å­ç¯ä¸Šæ‰“çš„ã€‚å› æ­¤ï¼Œå¯ä»¥å¯¹ 60 ç»„å…¬é’¥åˆ†åˆ«å¼€æ‰“ï¼Œå¯»æ‰¾ä¸€ä¸ªåˆé€‚çš„å…¬é’¥ï¼Œä½¿å…¶åœ¨ $R_{q,78}$ å’Œ $R_{q,39}$ ä¸Šéƒ½èƒ½å¾—åˆ°å¾ˆå°çš„å€¼ã€‚60æ¬¡æœºä¼šï¼Œè²Œä¼¼è¿˜æ˜¯å¤Ÿç”¨çš„ã€‚</p><h3 id="3x02-å®éªŒæµ‹è¯•"><a href="#3x02-å®éªŒæµ‹è¯•" class="headerlink" title="3x02 å®éªŒæµ‹è¯•"></a>3x02 å®éªŒæµ‹è¯•</h3><p>ç„¶åå°±æ˜¯å®éªŒæµ‹è¯•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">f39=<span class="hljs-literal">None</span><br>f78=<span class="hljs-literal">None</span><br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>avail=[]<br><span class="hljs-keyword">for</span> T <span class="hljs-keyword">in</span> trange(<span class="hljs-number">60</span>):<br>    M39=[<span class="hljs-built_in">list</span>(Rq39(Hxarr[T])*Rq39([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])**i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">39</span>)]<br>    M39=matrix(M39)<br>    M=block_matrix(ZZ,[[<span class="hljs-number">1</span>,M39],[<span class="hljs-number">0</span>,q]])<br>    M3L=M.BKZ()<br>    fxtest=<span class="hljs-built_in">list</span>(M3L[<span class="hljs-number">0</span>])[:<span class="hljs-number">39</span>]<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">max</span>(fxtest)&lt;=<span class="hljs-number">2</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">min</span>(fxtest)&gt;=-<span class="hljs-number">2</span>):<br>        avail.append((T,fxtest))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;find <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(avail)&#125;</span> possible&#x27;</span>)<br><span class="hljs-keyword">for</span> T,_f39 <span class="hljs-keyword">in</span> avail:<br>    M78=[<span class="hljs-built_in">list</span>(Rq78(Hxarr[T])*Rq78([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])**i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">78</span>)]<br>    M78=matrix(M78)<br>    M=block_matrix(ZZ,[[<span class="hljs-number">1</span>,M78],[<span class="hljs-number">0</span>,q]])<br>    M3L=M.BKZ()<br>    fxtest=<span class="hljs-built_in">list</span>(M3L[<span class="hljs-number">0</span>])[:<span class="hljs-number">78</span>]<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">max</span>(fxtest)&lt;=<span class="hljs-number">2</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">min</span>(fxtest)&gt;=-<span class="hljs-number">2</span>):<br>        f78=fxtest<br>        f39=_f39<br>        <span class="hljs-built_in">print</span>(T)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(f78)<br><span class="hljs-built_in">print</span>(f39)<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¾“å‡ºç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">find <span class="hljs-number">14</span> possible<br><span class="hljs-number">50</span><br>[-<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, -<span class="hljs-number">2</span>, -<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>]<br>[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">2</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><p>ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œæˆ‘å¯¹åŸé¢˜è¿›è¡Œäº†ä¿®æ”¹ï¼Œä»¤å…¶æ¯æ¬¡ç”Ÿæˆçš„ç§é’¥ $f(x)$ ä¼šè¢«å†™å…¥ä¸€ä¸ªæ–‡ä»¶ä¸­å»ã€‚æˆ‘æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰¾åˆ°äº†ç¬¬ $50$ ç»„ç§é’¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">i:<span class="hljs-number">50</span>,sk=[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p>ç„¶åæµ‹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">ycrt=crt([O7(f78),O7(f39)],[x_**<span class="hljs-number">78</span>-x_**<span class="hljs-number">39</span>+<span class="hljs-number">1</span>,x_**<span class="hljs-number">39</span>+<span class="hljs-number">1</span>])<br>y=Rq(<span class="hljs-built_in">list</span>(ycrt))<br>listskreal=[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]<br>skreal=Rq(listskreal)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(y))<br><span class="hljs-comment">#[1090, 0, 1090, 0, 363, 727, 727, 363, 727, 726, 365, 363, 1090, 365, 728, 363, 364, 1, 728, 1090, 363, 726, 727, 0, 365, 1090, 0, 727, 363, 363, 365, 0, 1, 363, 362, 1090, 1, 1, 727, 1090, 0, 1090, 1, 726, 362, 363, 728, 364, 364, 728, 727, 1090, 727, 364, 727, 728, 1, 363, 0, 728, 364, 363, 1, 727, 0, 0, 363, 727, 728, 728, 1090, 1, 728, 727, 0, 0, 1090, 362, 1, 1, 1, 1090, 364, 727, 727, 364, 726, 727, 365, 363, 1, 363, 728, 364, 363, 1090, 727, 0, 364, 728, 728, 1, 364, 1, 1, 727, 362, 363, 363, 1090, 1090, 365, 364, 0, 0, 0, 727]</span><br><br></code></pre></td></tr></table></figure><p>ä½ ä¼šå‘ç°ï¼Œ$y$ å¹¶ä¸æ˜¯ä»…åŒ…å« $0,1,-1$ï¼Œè¿˜åŒ…å«äº†å¾ˆå¤šå…¶ä»–çš„å€¼ã€‚å› ä¸ºæˆ‘ä»¬BKZå‡ºæ¥çš„æ˜¯å¾—åˆ°å¾ªç¯ç§»ä½çš„ä¸œè¥¿ã€‚</p><p>æµ‹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">1</span>/Rq78(listskreal)*Rq78(y)<br><span class="hljs-comment"># x^23</span><br>Rq39(y)/Rq39(listskreal)<br><span class="hljs-comment"># x^25</span><br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯ï¼Œåœ¨ $R_{q,78}$ ä¸­ï¼Œ$\dfrac{y(x)}{f(x)}&#x3D;x^{23}$ï¼Œåœ¨ $R_{q,39}$ ä¸­ï¼Œ$\dfrac{y(x)}{f(x)}&#x3D;x^{25}$ã€‚çœ‹æ¥å¯ä»¥çˆ†ç ´ï¼Ÿè¿˜çœŸæ˜¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">78</span>,<span class="hljs-number">78</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">39</span>,<span class="hljs-number">39</span>):<br>        y39x=Rq39(f39)*Rq39([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])**j<br>        y78x=Rq78(f78)*Rq78([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])**i<br>        y39x=O7(<span class="hljs-built_in">list</span>(y39x))<br>        y78x=O7(<span class="hljs-built_in">list</span>(y78x))<br>        yguess=crt([y39x,y78x],[x_**<span class="hljs-number">39</span>+<span class="hljs-number">1</span>,x_**<span class="hljs-number">78</span>-x_**<span class="hljs-number">39</span>+<span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">if</span>(Rq(yguess)==Rq(listskreal)):<br>            <span class="hljs-built_in">print</span>(i,j)<br><span class="hljs-comment"># -23 -25</span><br></code></pre></td></tr></table></figure><p>ä½†ï¼Œåœ¨å®é™…åšé¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ç§é’¥ï¼Œå› æ­¤éœ€è¦åŠ ä¸€ä¸ªåˆ¤æ–­æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">78</span>,<span class="hljs-number">78</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">39</span>,<span class="hljs-number">39</span>):<br>        y39x=Rq39(f39)*Rq39([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])**j<br>        y78x=Rq78(f78)*Rq78([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])**i<br>        y39x=O7(<span class="hljs-built_in">list</span>(y39x))<br>        y78x=O7(<span class="hljs-built_in">list</span>(y78x))<br>        yguess=crt([y39x,y78x],[x_**<span class="hljs-number">39</span>+<span class="hljs-number">1</span>,x_**<span class="hljs-number">78</span>-x_**<span class="hljs-number">39</span>+<span class="hljs-number">1</span>])<br>        ylist=<span class="hljs-built_in">list</span>(yguess)<br>        yset=<span class="hljs-built_in">set</span>(ylist)<br>        vecy=vector(GF(<span class="hljs-number">1091</span>),ylist)<br>        <span class="hljs-keyword">if</span>(yset==&#123;<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1090</span>&#125; ):<br>            <span class="hljs-built_in">print</span>(i,j,Rq(yguess)/Rq(listskreal))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">-78 -2 1090*x^62</span><br><span class="hljs-string">-77 -1 1090*x^63</span><br><span class="hljs-string">-76 0 1090*x^64</span><br><span class="hljs-string">-75 1 1090*x^65</span><br><span class="hljs-string">-74 2 1090*x^66</span><br><span class="hljs-string"><span class="hljs-meta">... </span>... ... ...</span><br><span class="hljs-string">-25 -27 1090*x^115</span><br><span class="hljs-string">-24 -26 1090*x^116</span><br><span class="hljs-string">-23 -25 1</span><br><span class="hljs-string">-22 -24 x</span><br><span class="hljs-string">-21 -23 x^2</span><br><span class="hljs-string"><span class="hljs-meta">... </span>... ... ...</span><br><span class="hljs-string">73 -7 x^96</span><br><span class="hljs-string">74 -6 x^97</span><br><span class="hljs-string">75 -5 x^98</span><br><span class="hljs-string">76 -4 x^99</span><br><span class="hljs-string">77 -3 x^100</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªè¾“å‡ºç»“æœæ˜¯æœ‰è§„å¾‹çš„ï¼Œæœ€åè§£å‡ºæ¥çš„ä¸œè¥¿ä¹Ÿæ˜¯ç§é’¥çš„å¾ªç¯ç§»ä½ã€‚ä¸è¿‡è²Œä¼¼ä¸æ˜¯æ¯æ¬¡éƒ½èƒ½è§£å‡ºæ¥çš„ï¼Œå› ä¸º $x^{39}+1$ çš„åˆ†è§£å¤ªå¤šäº†ï¼Œå¾ˆå®¹æ˜“å‡ºç°ä¸å¯é€†çš„ç»“æœã€‚</p><p>å¤šè°ƒè¯•äº†å‡ æ¬¡ï¼Œæ‹¿åˆ°äº†ä¸€ç»„ç»“æœï¼Œéšæœºå–æœ€åä¸€ç»„ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">balancemodlist</span>(<span class="hljs-params"><span class="hljs-type">List</span>,p</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-type">List</span>)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(<span class="hljs-type">List</span>[i]) &gt; p / <span class="hljs-number">2</span>:<br>            <span class="hljs-type">List</span>[i] = <span class="hljs-built_in">int</span>(<span class="hljs-type">List</span>[i]) - p<br>    <span class="hljs-keyword">return</span> <span class="hljs-type">List</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">f,fp,c</span>):<br>    m = Rq(balancemodlist((Rp(balancemodlist((f * c).<span class="hljs-built_in">list</span>(),q)) * fp).<span class="hljs-built_in">list</span>(),p))<br>    <span class="hljs-keyword">return</span> m<br><br><span class="hljs-built_in">print</span>(fx)<br>fp = (<span class="hljs-number">1</span> / Rp(O8(balancemodlist(fx.<span class="hljs-built_in">list</span>(),q))))<br>s=decrypt(fx,fp,Rq(Cxarr[<span class="hljs-number">16</span>]))<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-comment">#fx:[0, 1090, 1090, 0, 0, 1090, 0, 0, 1, 1, 0, 1090, 1090, 1090, 0, 1, 1, 1, 1, 1090, 1090, 0, 0, 1090, 1, 1090, 0, 1, 0, 0, 1090, 0, 1, 0, 1, 1090, 1, 1, 0, 1, 1090, 1090, 1090, 1090, 1, 1090, 0, 1, 0, 1090, 1, 1090, 1090, 1, 1090, 0, 1090, 0, 0, 0, 1090, 0, 0, 1, 0, 1090, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1090, 0, 1, 1090, 1, 1, 0, 0, 1090, 1090, 1, 0, 1090, 0, 1090, 1090, 1090, 0, 0, 0, 0, 1090, 1, 1090, 1090, 1090, 0, 0, 1, 0, 1090, 1090, 1, 1, 1, 1090, 1090, 1090, 1090, 1090, 1]</span><br><span class="hljs-comment">#s:[0, 1090, 1090, 1090, 1090, 1090, 1090, 1, 1090, 1090, 1, 0, 0, 1, 1090, 1, 1090, 1, 1, 1, 0, 1090, 1, 1090, 0, 0, 1090, 1, 1, 1, 1090, 0, 1, 0, 0, 0, 1090, 1, 1, 0, 0, 1, 1090, 0, 1, 1, 1, 1090, 1, 1090, 1090, 0, 1, 0, 1090, 1090, 1090, 1090, 0, 1090, 0, 1090, 1090, 1, 1, 1090, 0, 1, 1090, 1090, 0, 1090, 1, 1, 0, 0, 1090, 1090, 1, 0, 0, 1090, 0, 0, 1090, 0, 1, 1, 1090, 1, 0, 1090, 1090, 1090, 0, 1, 1, 1, 1, 0, 1090, 1090, 0, 0, 1, 1090, 1090, 1090, 0, 1, 0, 1, 1, 0, 1, 0, 0]</span><br></code></pre></td></tr></table></figure><p>ç„¶åè°ƒè¯•äº†ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">sreal=Rq([<span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">1090</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>])<br><span class="hljs-comment">#ä»æ–‡ä»¶ä¸­é¢„å…ˆè·å–çš„sreal</span><br>sreal-s<br><span class="hljs-comment">#0</span><br></code></pre></td></tr></table></figure><p>ç„¶åå‘ç°ç¬¬ä¸€ç»„ä¹Ÿå¯ä»¥ï¼Œçœ‹æ¥ç§é’¥çš„ç§»ä½ä¸å½±å“æœ€åè§£å¯†ç»“æœã€‚é‚£å¹²è„†ç›´æ¥æ‰¾åˆ°ä¸€ç»„breakæ‰å°±okäº†ã€‚</p><h3 id="3x03-exp"><a href="#3x03-exp" class="headerlink" title="3x03 exp"></a>3x03 exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>sh=process([<span class="hljs-string">&#x27;python3&#x27;</span>,<span class="hljs-string">&#x27;task.py&#x27;</span>])<br><span class="hljs-comment">#load(&#x27;ntru.sage&#x27;)</span><br>p,n,q,dg,df = <span class="hljs-number">3</span>,<span class="hljs-number">117</span>,<span class="hljs-number">1091</span>,<span class="hljs-number">35</span>,<span class="hljs-number">37</span><br>Mxarr=[[getrandbits(<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">116</span>)]<span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">400</span>)]<br>Cxarr=[]<br>Hxarr=[]<br>O7.&lt;x_&gt;=PolynomialRing(GF(q))<br>O8.&lt;xp_&gt;=PolynomialRing(GF(p))<br>Rp.&lt;xp&gt;=O8.quotient(xp_**<span class="hljs-number">117</span>+<span class="hljs-number">1</span>)<br>Rq.&lt;x&gt;=O7.quotient(x_**<span class="hljs-number">117</span>+<span class="hljs-number">1</span>)<br>Rq39.&lt;x&gt;=O7.quotient(x_**<span class="hljs-number">39</span>+<span class="hljs-number">1</span>)<br>Rq78.&lt;x&gt;=O7.quotient(x_**<span class="hljs-number">78</span>-x_**<span class="hljs-number">39</span>+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">60</span>)):<br>    sh.recvuntil(<span class="hljs-string">b&#x27;Give me a list of message (hex):&#x27;</span>)<br>    s=<span class="hljs-built_in">str</span>(Mxarr[i])[<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br>    s=s.replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>    s=s.replace(<span class="hljs-string">&#x27;,&#x27;</span>,<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-comment">#print(s)</span><br>    sh.sendline(s.encode())<br>    Cx=(<span class="hljs-built_in">eval</span>(sh.recvline()))<br>    Hx=(<span class="hljs-built_in">eval</span>(sh.recvline()))<br>    Cxarr.append((Cx))<br>    Hxarr.append((Hx))<br>f39=<span class="hljs-literal">None</span><br>f78=<span class="hljs-literal">None</span><br>Tfinal=<span class="hljs-literal">None</span><br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>avail=[]<br><span class="hljs-keyword">for</span> T <span class="hljs-keyword">in</span> trange(<span class="hljs-number">60</span>):<br>    M39=[<span class="hljs-built_in">list</span>(Rq39(Hxarr[T])*Rq39([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])**i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">39</span>)]<br>    M39=matrix(M39)<br>    M=block_matrix(ZZ,[[<span class="hljs-number">1</span>,M39],[<span class="hljs-number">0</span>,q]])<br>    M3L=M.BKZ()<br>    fxtest=<span class="hljs-built_in">list</span>(M3L[<span class="hljs-number">0</span>])[:<span class="hljs-number">39</span>]<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">max</span>(fxtest)&lt;=<span class="hljs-number">2</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">min</span>(fxtest)&gt;=-<span class="hljs-number">2</span>):<br>        avail.append((T,fxtest))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;find <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(avail)&#125;</span> possible&#x27;</span>)<br><span class="hljs-keyword">for</span> T,_f39 <span class="hljs-keyword">in</span> avail:<br>    M78=[<span class="hljs-built_in">list</span>(Rq78(Hxarr[T])*Rq78([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])**i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">78</span>)]<br>    M78=matrix(M78)<br>    M=block_matrix(ZZ,[[<span class="hljs-number">1</span>,M78],[<span class="hljs-number">0</span>,q]])<br>    M3L=M.BKZ()<br>    fxtest=<span class="hljs-built_in">list</span>(M3L[<span class="hljs-number">0</span>])[:<span class="hljs-number">78</span>]<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">max</span>(fxtest)&lt;=<span class="hljs-number">2</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">min</span>(fxtest)&gt;=-<span class="hljs-number">2</span>):<br>        f78=fxtest<br>        f39=_f39<br>        Tfinal=T<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(f78)<br><span class="hljs-built_in">print</span>(f39)<br>fx=<span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">77</span>,<span class="hljs-number">78</span>):<br>    <span class="hljs-keyword">if</span>(fx):<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">38</span>,<span class="hljs-number">39</span>):<br>        y39x=Rq39(f39)*Rq39([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])**j<br>        y78x=Rq78(f78)*Rq78([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])**i<br>        y39x=O7(<span class="hljs-built_in">list</span>(y39x))<br>        y78x=O7(<span class="hljs-built_in">list</span>(y78x))<br>        yguess=crt([y39x,y78x],[x_**<span class="hljs-number">39</span>+<span class="hljs-number">1</span>,x_**<span class="hljs-number">78</span>-x_**<span class="hljs-number">39</span>+<span class="hljs-number">1</span>])<br>        ylist=<span class="hljs-built_in">list</span>(yguess)<br>        yset=<span class="hljs-built_in">set</span>(ylist)<br>        vecy=vector(GF(<span class="hljs-number">1091</span>),ylist)<br>        <span class="hljs-keyword">if</span>(yset==&#123;<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1090</span>&#125;):<br>            fx=Rq(ylist)<br>            <span class="hljs-built_in">print</span>(fx)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">balancemodlist</span>(<span class="hljs-params"><span class="hljs-type">List</span>,p</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-type">List</span>)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(<span class="hljs-type">List</span>[i]) &gt; p / <span class="hljs-number">2</span>:<br>            <span class="hljs-type">List</span>[i] = <span class="hljs-built_in">int</span>(<span class="hljs-type">List</span>[i]) - p<br>    <span class="hljs-keyword">return</span> <span class="hljs-type">List</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">f,fp,c</span>):<br>    m = Rq(balancemodlist((Rp(balancemodlist((f * c).<span class="hljs-built_in">list</span>(),q)) * fp).<span class="hljs-built_in">list</span>(),p))<br>    <span class="hljs-keyword">return</span> m<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(fx))<br>fp = (<span class="hljs-number">1</span> / Rp(O8(balancemodlist(fx.<span class="hljs-built_in">list</span>(),q))))<br>s=decrypt(fx,fp,Rq(Cxarr[Tfinal]))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(s))<br>lists=<span class="hljs-built_in">list</span>(s)<br>ans=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(lists)):<br>    ans+=<span class="hljs-built_in">min</span>(<span class="hljs-number">2</span>,Integer(s[i]))*<span class="hljs-number">3</span>**i<br>sh.recvuntil(<span class="hljs-string">b&quot;You wanner say something? :&quot;</span>)<br>sh.sendline(<span class="hljs-built_in">hex</span>(ans)[<span class="hljs-number">2</span>:].encode())<br><span class="hljs-built_in">print</span>(sh.recvall())<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœï¼Œä¹Ÿæ˜¯æ¦‚ç‡æˆåŠŸã€‚åœ¨æœ¬åœ°è·‘ï¼Œ70ç§’æ—¶é—´ä¼¼ä¹æ˜¯å¤Ÿçš„ã€‚</p><p><img src="/2025/01/12/25Jan1/12.png" alt="12"></p><h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9.æ€»ç»“"></a>9.æ€»ç»“</h2><p>ä¸¤ä¸ªNTRUé¢˜ç›®ï¼ŒçŸ¥è¯†åˆå¢é•¿äº†ï¼Œå¥½è€¶ï¼</p><p>ä¸è¿‡åé¢è¿˜æœ‰ä¸€å †é¢˜ç›®è¦è¡¥ï¼Œç»§ç»­åŠ æ²¹ï¼</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ciscn2025wp1</title>
    <link href="/2024/12/16/ciscn2025wp1/"/>
    <url>/2024/12/16/ciscn2025wp1/</url>
    
    <content type="html"><![CDATA[<h1 id="CISCN2025-Crypto-Writeup"><a href="#CISCN2025-Crypto-Writeup" class="headerlink" title="CISCN2025 Crypto Writeup"></a>CISCN2025 Crypto Writeup</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><blockquote><p>æœ€å15åˆ†é’Ÿï¼Œä¸€ä¸ªé¢˜çªç„¶æœ‰äº†æ€è·¯ï¼ç„¶åæ¡†æ¡†åšã€‚å‰©ä¸‰åˆ†é’Ÿçš„æ—¶å€™å‡ºäº†ç»“æœã€‚</p><p>ç„¶åï¼Œå‘ç°flagæœ‰ä¸€ä½ä¸å¯¹ï¼Œä½†æ—¶é—´ä¸å¤Ÿäº†ï¼Œè¿äº¤16å‘ï¼Œè¿‡äº†ã€‚</p></blockquote><p><img src="/2024/12/16/ciscn2025wp1/2.png" alt="2"></p><h2 id="1-rasnd"><a href="#1-rasnd" class="headerlink" title="1.rasnd"></a>1.rasnd</h2><p>ç­¾åˆ°é¢˜</p><h3 id="1x01-ç¬¬ä¸€é—®"><a href="#1x01-ç¬¬ä¸€é—®" class="headerlink" title="1x01 ç¬¬ä¸€é—®"></a>1x01 ç¬¬ä¸€é—®</h3><p>ç¬¬ä¸€é—®æ˜¯ä¸¤ä¸ª $xp+yq$ çš„æ–¹ç¨‹ç»„ï¼Œå…¶ä¸­ä¸¤ä¸ª $x$ å‡ä¸º $11$ bitï¼Œè€Œ $y$ æ¯”è¾ƒå¤§ã€‚å…ˆæŠŠå¹²æ‰°é¡¹<code>0x114</code> å’Œ <code>0x514</code> åŠ ä¸Šå»é‚£ä¸ªå†è€ƒè™‘é—®é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">crypto1</span>():<br>    p = getPrime(<span class="hljs-number">1024</span>)<br>    q = getPrime(<span class="hljs-number">1024</span>)<br>    n = p * q<br>    e = <span class="hljs-number">0x10001</span><br>    x1=randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">11</span>)<br>    y1=randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">114</span>)<br>    x2=randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">11</span>)<br>    y2=randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">514</span>)<br>    hint1=x1*p+y1*q-<span class="hljs-number">0x114</span><br>    hint2=x2*p+y2*q-<span class="hljs-number">0x514</span><br>    c = <span class="hljs-built_in">pow</span>(bytes_to_long(flag1), e, n)<br>    <span class="hljs-built_in">print</span>(n)<br>    <span class="hljs-built_in">print</span>(c)<br>    <span class="hljs-built_in">print</span>(hint1)<br>    <span class="hljs-built_in">print</span>(hint2)<br></code></pre></td></tr></table></figure><p>è®¾ $h_1&#x3D;ap+uq,h_2&#x3D;bp+vq$ï¼Œè¿™é‡Œ $a,b,u,v$ åˆ†åˆ«ä»£è¡¨åŸé¢˜ä¸­çš„ $x_1,x_2,y_1,y_2$ã€‚å› æ­¤ï¼Œæœ‰ $h_1\equiv ap \pmod q$ å’Œ $h_2 \equiv bp \pmod q$ã€‚</p><p>é‚£ä¹ˆæ—¢ç„¶è¿™æ ·ï¼Œå°±å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>bh_1-ah_2\equiv 0\pmod q<br>$$<br>ä¹Ÿå°±æ˜¯åªéœ€è¦è®¡ç®— $bh_1-ah_2$ å¯¹ $n$ å–æ¨¡çš„å€¼ï¼Œç„¶åæ±‚è¿™ä¸ªå€¼ä¸ $n$ çš„æœ€å¤§å…¬çº¦æ•°å°±è¡Œã€‚æœ‰å› ä¸ºè¿™è¾¹ $a,b$ æ¯”è¾ƒå°ï¼Œå› æ­¤ç›´æ¥çˆ†ç ´å°±OKäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">19248664689530123393339750857691758159828998141083113433318210575707422181489994495258568353664585884974589784326344875616422623723134787567523135053918656358818197978064530098405128694160259578347511022497921607363550797990918049734722532831572612769156259971404777247374524932064252338601246476354828069402346646655148066484265861458411755063666748004293786860672431085761001135092249308802515486462877548621098190062391716183875115012331375463955835485096757222226810547395731394800944696108335750671156420296030042196532586476376809261086236384076130490521533794626278538191680511190432034822246405284567044535737</span><br>c=<span class="hljs-number">16453581113263628465402092791273671627253499425447855398153502324952305815396643914684535248142751183677820566647078077684635808968023794878415787181748005037265484795254931463576254805033054376345359635944723694122534587670849618937642199417698103245704677524885526618274177589192207268821472812014491228744087019681084825136309747168220038888386631991014234901274101176732935273456684918926783662195903675201338561673573750363288113393253956526505273390732848815303616961944660066711735531801399259938551249259161863955642767344503658923718752086167261196386024011356237085630947227087647937956059125524152447531046</span><br>h1=<span class="hljs-number">1142155587999054452936236690724846373317633853126793089144726626669657375885752630969112453860698940164376661793846305685672149286102455708196921631520363911372723899902966372266397544814322619319044169128946954204738673025539895226335296999362788265718140587423185015428744709814309161721272465730611687942859087016764569757722320187632936089</span><br>h2=<span class="hljs-number">6805681534385851179775478266005282964511861953948523771351357282112956013491219260195830638806682420098299511263106560638896904299407473460758909050042070258290378172452854156007202430941147523420211671963915796599471635868375761210639654134882971355856028137677035546043236438576341615763406191904837152865917403676918731794126663654959372843668491934375801326063783580396546640850799544632110824221535250489490336046772019863423668554252214257321844182545387418</span><br>h1+=<span class="hljs-number">0x114</span><br>h2+=<span class="hljs-number">0x514</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>found=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> trange(<span class="hljs-number">2</span>**<span class="hljs-number">11</span>):<br>    <span class="hljs-keyword">if</span>(found):<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">11</span>):<br>        q = GCD(a * h1 - b * h2, n)<br>        <span class="hljs-keyword">if</span> q != <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> q &lt; n:<br>            found=<span class="hljs-number">1</span><br>            <span class="hljs-built_in">print</span>(q, n)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment">#q=173412142663396382437110320378676957702956603225161519151255211880350143773589704812177489820788273353229406821960488375289526428322543015221422549411580243762548438732318695065025392633248468667975976279310511629585619218884427826162013207814208144971619806977124558725541302263038307640311180609750589387139</span><br></code></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯æ­£å¸¸çš„è§£å¯†äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">q=<span class="hljs-number">173412142663396382437110320378676957702956603225161519151255211880350143773589704812177489820788273353229406821960488375289526428322543015221422549411580243762548438732318695065025392633248468667975976279310511629585619218884427826162013207814208144971619806977124558725541302263038307640311180609750589387139</span> <br>p=n//q<br>d=inverse(<span class="hljs-number">0x10001</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n))<br><span class="hljs-comment">#flag&#123;c4a8755f-e3ee-</span><br></code></pre></td></tr></table></figure><h3 id="1x02-ç¬¬äºŒé—®"><a href="#1x02-ç¬¬äºŒé—®" class="headerlink" title="1x02 ç¬¬äºŒé—®"></a>1x02 ç¬¬äºŒé—®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">crypto2</span>():<br>    p = getPrime(<span class="hljs-number">1024</span>)<br>    q = getPrime(<span class="hljs-number">1024</span>)<br>    n = p * q<br>    e = <span class="hljs-number">0x10001</span><br>    hint = <span class="hljs-built_in">pow</span>(<span class="hljs-number">514</span>*p - <span class="hljs-number">114</span>*q, n - p - q, n)<br>    c = <span class="hljs-built_in">pow</span>(bytes_to_long(flag2),e,n)<br>    <span class="hljs-built_in">print</span>(n)<br>    <span class="hljs-built_in">print</span>(c)<br>    <span class="hljs-built_in">print</span>(hint)<br></code></pre></td></tr></table></figure><p>æ³¨æ„åˆ° $\varphi(n)&#x3D;(p-1)(q-1)&#x3D;n-p-q+1$ ä»¥åŠæ¬§æ‹‰å®šç† $a^{\varphi(n)}\equiv 1 \pmod n$ã€‚è€Œè¿™è¾¹å°‘äº†ä¸€ä¸ª $+1$ã€‚</p><p>å› æ­¤ï¼Œé¢˜ç›®ä¸­çš„hintå…¶å®æ˜¯ $514p-114q$ çš„é€†å…ƒï¼Œå³ $h\equiv \dfrac{1}{514p-114q}$ã€‚å› æ­¤æ±‚é€†ä¹‹åï¼Œsageå¯ä»¥ä¸€æŠŠæ¢­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">18469971394567700555887545287738030390998670849233400121622608332076900381636174405583926146207911760514526165345411119372695640879373233807010796828189247487881583450802018570094118969936556808837735331742986354386573070679971526372651273191418416553892526494787200424504794508644408739520632218791263187635391385857246002374949380609580488294584115876165520379716472501738721881865651392018210313227950727959918876612379099361481409818981815277337620592265054900554332804125089828492735185173430695836219401530601136278511063507531410018405775105282450190556279513289553601110429728232438726893960214994464326642501</span><br>c=<span class="hljs-number">8384245358517209206638591536430089936750872075931157496159484493219224715458106957074197415753212306103270383975531507561845531202902990237136664716166981869184244988309170499142927622452946928886208659190260182148074631735133891762719723325840541605207148731809561384567275222023097150960503034472178349354131047589997261802023668033259892426337260551376445994419408154784104500004806681716393027194354460841110067278287117340780462399365432976004668936950623590082446226194389401021047094109734198271887111013770971020353155639875222275579921784263393549902894072613204186386891381226594909524653335513046000779913</span><br>h=<span class="hljs-number">10613527688726423579754152693752973064592747678519716670281951817557565124963478644451998246232654577070335083234391448787101641842881480848146247384045578217961864919867766100286869024387066802728323491078123363075076998082908591788534532074882105038688917723726272300258577874995515845057668640104924642429913694188593719906989625368537851337574010386820985695951602020986744321047364238143041381580204581757698773733909442002829918853274102631318801737704555525749901970771051179058453501567637677171608531708913198318266934162394058243794913193446935461537732717610020726853015268231704202587137995580373031429184</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>h11=inverse(h,n)<br>var(<span class="hljs-string">&#x27;p q&#x27;</span>)<br>solve([p * q == n, <span class="hljs-number">514</span> * p - <span class="hljs-number">114</span> * q == h11],(p, q))<br><span class="hljs-comment">#[[p == 124374482713744254421196146561721734370797689508289476755605840389633983382899202977355204274399588551326418117247498420139367095759757770970096113272582067707802898348673920735904464508743418701977275366218690118662098779221336992548858532837641630846364672805473992679529496368359318673509345992314976898271, q == 148502900205643540040835714929977680824759735566050594322503799979640528741251944541387833043478598810328443666188068011083556939321771693171145515982180549200450564885451040239556674788106253037174232984849335478469598925152366683693097813645050646728552643163657439369582006776770981653061881169323572439131], [p == (-8464665311721681782327635751008727807011304927264883876382716598839510138251360838859106483478280132188721288972719876631762745541340986510755294410984291304425682198470709293654730462922056423118931280136412122272767138733684900970506575377767886863527500660328474044066174386275945954224527226651443629030467/257), q == (-31964242057432273386247409666362485733295006203630395526190700980135933729405095165180287498520694257690889456132607093975817343610257747139314701111053591400905344875609197629127447378747058606408159769118203360496159386259883607085056642939273899127515720911006816118639080566668344899091901920024949062855647/57)]]</span><br></code></pre></td></tr></table></figure><p>ç„¶åå¤åˆ¶ç¬¬ä¸€ç»„è§£å°±è¡Œäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">pp=<span class="hljs-number">124374482713744254421196146561721734370797689508289476755605840389633983382899202977355204274399588551326418117247498420139367095759757770970096113272582067707802898348673920735904464508743418701977275366218690118662098779221336992548858532837641630846364672805473992679529496368359318673509345992314976898271</span><br>qq=<span class="hljs-number">148502900205643540040835714929977680824759735566050594322503799979640528741251944541387833043478598810328443666188068011083556939321771693171145515982180549200450564885451040239556674788106253037174232984849335478469598925152366683693097813645050646728552643163657439369582006776770981653061881169323572439131</span><br>d=inverse(<span class="hljs-number">0x10001</span>,(pp-<span class="hljs-number">1</span>)*(qq-<span class="hljs-number">1</span>))<br><br>long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n))<br><span class="hljs-comment">#4451-9804-56becf5a4151&#125;</span><br></code></pre></td></tr></table></figure><p>æœ€ç»ˆflagï¼š<code>flag&#123;c4a8755f-e3ee-4451-9804-56becf5a4151&#125;</code></p><h2 id="2-fffffhash"><a href="#2-fffffhash" class="headerlink" title="2.fffffhash"></a>2.fffffhash</h2><p>ä¸€çœ¼çœ‹åˆ°è¿™ä¸ªï¼Œå‘ç°å’ŒSUSCTFé‚£ä¸ªé¢˜ç«Ÿç„¶å·®ä¸å¤šï¼Œå‡è®¾æˆ‘ä»¬è¦æ±‚çš„ç›®æ ‡å€¼ä¸º $G$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">giaogiao</span>(<span class="hljs-params">hex_string</span>):<br>        base_num = <span class="hljs-number">0x6c62272e07bb014262b821756295c58d</span><br>        x = <span class="hljs-number">0x0000000001000000000000000000013b</span><br>        MOD = <span class="hljs-number">2</span>**<span class="hljs-number">128</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> hex_string:<br>                base_num = (base_num * x) &amp; (MOD - <span class="hljs-number">1</span>) <br>                base_num ^= i<br>        <span class="hljs-keyword">return</span> base_num<br>giao=<span class="hljs-number">201431453607244229943761366749810895688</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;1geiwoligiaogiao&quot;</span>)<br>hex_string = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(),<span class="hljs-number">16</span>)<br>s = long_to_bytes(hex_string)<br><br><span class="hljs-keyword">if</span> giaogiao(s) == giao:<br>        <span class="hljs-built_in">print</span>(os.getenv(<span class="hljs-string">&#x27;FLAG&#x27;</span>))<br><span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;error&quot;</span>)<br><br></code></pre></td></tr></table></figure><blockquote><p>SUSCTFä¸­å†™çš„æ€è·¯ï¼š</p><p>ç”±äº $m_i$ å¾ˆå°ï¼Œå› æ­¤ $h \oplus m_i$ å¯ä»¥å†™æˆ $h+\delta_i$ï¼Œå…¶ä¸­ $\delta_i$ ä¹Ÿå¾ˆå°ã€‚æŠŠå¼‚æˆ–æ¢åŠ ï¼Œå°±å¯ä»¥å‘ç°ï¼Œæœ€å $H$ å¯ä»¥å†™æˆä¸€ä¸ªå…³äº $t$ çš„å¤šé¡¹å¼ï¼Œå…¶ä¸­ $\delta_i $ å¾ˆå° ã€‚</p></blockquote><p>ä»ç„¶ä»¥å››ä¸ªå€¼ä¸ºä¾‹ï¼š</p><p>é‚£ä¸ªé¢˜æ˜¯ï¼š<br>$$<br>H(m)\equiv \delta_1A^4+\delta_2A^3+\delta_3A^2+\delta_4A\pmod q<br>$$<br>ä½†è¿™ä¸ªé¢˜å¸¦åˆå€¼ï¼Œè¡¨è¾¾å¼å˜æˆäº†ï¼š<br>$$<br>H(m)\equiv BA^4+\delta_1A^3+\delta_2A^2+\delta_3A+\delta_4\pmod q<br>$$<br>é‚£å°±å¾®è°ƒä¸€ä¸‹çŸ©é˜µï¼ˆ$K&#x3D;2^{2600}$ï¼‰ï¼š</p><p><img src="/2024/12/16/ciscn2025wp1/4.png" alt="4"></p><p>ä½†è¿™è¾¹çš„ $D$ å°±ä¸æ˜¯ç›®æ ‡å€¼äº† $G$ äº†ã€‚å› ä¸ºè¿™è¾¹å¸¦æœ‰åˆå€¼ã€‚è¿™é‡Œ $D$ çš„å€¼åº”è¯¥æ˜¯ï¼š<br>$$<br>D&#x3D;G-BA^n<br>$$<br>å…¶ä¸­ $n$ æ˜¯å¾…æ„é€ å­—ç¬¦ä¸²çš„ä½æ•°ã€‚</p><p>å› æ­¤åˆæ­¥æ„é€ expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">H</span>(<span class="hljs-params">hex_string</span>):<br>    base_num = <span class="hljs-number">0x6c62272e07bb014262b821756295c58d</span><br>    x = <span class="hljs-number">0x0000000001000000000000000000013b</span><br>    MOD = <span class="hljs-number">2</span>**<span class="hljs-number">128</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> hex_string:<br>        base_num = (base_num * x) &amp; (MOD - <span class="hljs-number">1</span>) <br>        base_num ^^= i<br>    <span class="hljs-keyword">return</span> base_num<br>q=<span class="hljs-number">2</span>**<span class="hljs-number">128</span><br>n=<span class="hljs-number">96</span><br>D=<span class="hljs-number">201431453607244229943761366749810895688</span>-(<span class="hljs-number">0x6c62272e07bb014262b821756295c58d</span>*<span class="hljs-built_in">pow</span>(<span class="hljs-number">0x0000000001000000000000000000013b</span>,n,q)%q)<br>D=D%q<br>t=<span class="hljs-number">0x0000000001000000000000000000013b</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getVec</span>(<span class="hljs-params">mod,g,targ</span>):<br>    K=<span class="hljs-number">2</span>**<span class="hljs-number">2600</span><br>    M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">3</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>):<br>        M[i][i]=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i][n+<span class="hljs-number">2</span>]=Integer(<span class="hljs-built_in">pow</span>(g,n-i-<span class="hljs-number">1</span>,mod))*K<br>    M[n][n+<span class="hljs-number">2</span>]=-targ*K<br>    M[n+<span class="hljs-number">1</span>][n+<span class="hljs-number">2</span>]=mod*K<br>    M=matrix(ZZ,M)<br>    <span class="hljs-keyword">return</span> M.LLL()<br>A=getVec(q,t,D)<br>vv=A[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>):<br>    <span class="hljs-keyword">if</span>(A[i][-<span class="hljs-number">3</span>]==<span class="hljs-number">1</span>):<br>        vv=A[i]<br>        <span class="hljs-keyword">break</span><br>R=vv <span class="hljs-keyword">if</span> vv[<span class="hljs-number">0</span>]&gt;=<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> -vv<br>s=[]<br>b=<span class="hljs-number">0x6c62272e07bb014262b821756295c58d</span><br>h=b<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    h=(t*h)%q<br>    s.append(h^^(h+R[i]))<br>    h+=R[i]<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-comment">#[0, 6, 28, 0, 6, 31, 3, 2, 6, 3, 59, 6, 2, 60, 29, 0, 3, 2, 7, 28, 1, 5, 0, 127, 1, 0, 1, 7, 1, 2, 3, 2, 7, 5, 0, 4, 2, 1, 31, 13, 1, 3, 2, 3, 124, 5, 5, 1, 2, 31, 0, 31, 1, 0, 0, 7, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span><br><span class="hljs-built_in">print</span>(H(<span class="hljs-built_in">bytes</span>(s)))<br><span class="hljs-comment">#201431453607244229943761366749810895688</span><br><span class="hljs-built_in">print</span>(<span class="hljs-number">201431453607244229943761366749810895688</span>)<br><span class="hljs-comment">#201431453607244229943761366749810895688</span><br>ans=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>    ans+=<span class="hljs-string">&#x27;&#123;:02x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i)<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-comment">#00061c00061f030206033b06023c1d000302071c0105007f01000107010203020705000402011f0d010302037c050501021f001f0100000701000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br></code></pre></td></tr></table></figure><p>ç»“æœå‘ç°äº¤ä¸Šå»ï¼Œç«Ÿç„¶ä¸å¯¹ã€‚å› ä¸ºåŸé¢˜ç”¨çš„æ˜¯<code>long_to_bytes</code>ï¼Œå› æ­¤å¦‚æœå­—ç¬¦ä¸²ä»¥ <code>0x00</code> å¼€å¤´ï¼Œé‚£ä¹ˆé«˜ä½å°±è¢«çœç•¥æ‰äº†ã€‚</p><p>ç„¶åæ¢äº†å‡ ä¸ª $n$ï¼Œå¥½åƒä¹Ÿä¸å¤ªè¡Œçš„æ ·å­ã€‚ä¸»è¦è¯•äº† $128,160$ï¼Œç„¶åæ‰è¯•åˆ°äº† $96$ã€‚å¤ªä½çš„è¯ï¼Œ$64$ ä¼šå‡ºç°è¶…è¿‡ $255$ çš„æ•°å­—ï¼Œä¹Ÿä¸è¡Œã€‚</p><blockquote><p>èµ›åè¡¥å……ï¼šç»æµ‹è¯•ï¼Œå¥½åƒ $66\sim80$ å‡ºçš„æ¦‚ç‡æŒºé«˜çš„</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">n</span><span class="hljs-operator">=</span><span class="hljs-number">66</span><br>ff0407010e1d03000e0f03020f00013b0603060f01050002010301000003010103027f0d000f0105020000060307023e030101010701000300030000000000000f00<br><span class="hljs-attribute">n</span><span class="hljs-operator">=</span><span class="hljs-number">69</span><br>fe070100060001000606033d0f0300fd000103000f04070502010f0305000506030001030e06ff0c0200010100000102020001010103010001000000000000000000000000<br><span class="hljs-attribute">n</span><span class="hljs-operator">=</span><span class="hljs-number">72</span><br>ff00000300067d0f0a04070000010201031d1f02040101030f01011c0201010c0103011e1e0d02031f0102000f020203001f07010f01000300030000000000000000000000000001<br><span class="hljs-attribute">n</span><span class="hljs-operator">=</span><span class="hljs-number">80</span><br>fc02017b010307010200070201020007061e1e0600020002000304190100030005060e00000103000602020200050303030100007f010000070100000000000000000000000000000000000000000000<br></code></pre></td></tr></table></figure></blockquote><p>ä½†æ¯”èµ›ä¸­æˆ‘åœ¨é‚£ç§æƒ…å†µä¸‹ï¼ŒåŠ ä¹‹å¿ƒæ€æ¯”è¾ƒæ€¥ï¼Œå¯æ²¡é‚£ä¹ˆæƒ³æ³•å»æµ‹è¯•ã€‚ä¸è¿‡æˆ‘å‘ç°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">H(<span class="hljs-string">b&#x27;1&#x27;</span>)=<span class="hljs-number">279349696642264188298419300151331525710</span><br></code></pre></td></tr></table></figure><p>é‚£å°±åœ¨å‰é¢å¼ºè¡ŒåŠ ä¸€ä¸ªå­—ç¬¦ <code>1</code> ï¼Œç„¶åæ”¹å˜åˆå€¼å°±è¡Œäº†ã€‚</p><p>æœ€ç»ˆWPï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CH</span>(<span class="hljs-params">hex_string</span>): <span class="hljs-comment">#åŸå§‹çš„hashå‡½æ•°</span><br>    base_num = <span class="hljs-number">0x6c62272e07bb014262b821756295c58d</span><br>    x = <span class="hljs-number">0x0000000001000000000000000000013b</span><br>    MOD = <span class="hljs-number">2</span>**<span class="hljs-number">128</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> hex_string:<br>        base_num = (base_num * x) &amp; (MOD - <span class="hljs-number">1</span>) <br>        base_num ^^= i<br>    <span class="hljs-keyword">return</span> base_num<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">H</span>(<span class="hljs-params">hex_string</span>): <span class="hljs-comment">#ä»¥å­—ç¬¦1å¼€å¤´çš„hashå‡½æ•°</span><br>    base_num = <span class="hljs-number">279349696642264188298419300151331525710</span><br>    x = <span class="hljs-number">0x0000000001000000000000000000013b</span><br>    MOD = <span class="hljs-number">2</span>**<span class="hljs-number">128</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> hex_string:<br>        base_num = (base_num * x) &amp; (MOD - <span class="hljs-number">1</span>) <br>        base_num ^^= i<br>    <span class="hljs-keyword">return</span> base_num<br>q=<span class="hljs-number">2</span>**<span class="hljs-number">128</span><br>n=<span class="hljs-number">96</span><br>D=<span class="hljs-number">201431453607244229943761366749810895688</span>-(<span class="hljs-number">279349696642264188298419300151331525710</span>*<span class="hljs-built_in">pow</span>(<span class="hljs-number">0x0000000001000000000000000000013b</span>,n,q)%q)<br>D=D%q<br>t=<span class="hljs-number">0x0000000001000000000000000000013b</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getVec</span>(<span class="hljs-params">mod,g,targ</span>):<br>    K=<span class="hljs-number">2</span>**<span class="hljs-number">2600</span><br>    M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">3</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>):<br>        M[i][i]=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i][n+<span class="hljs-number">2</span>]=Integer(<span class="hljs-built_in">pow</span>(g,n-i-<span class="hljs-number">1</span>,mod))*K<br>    M[n][n+<span class="hljs-number">2</span>]=-targ*K<br>    M[n+<span class="hljs-number">1</span>][n+<span class="hljs-number">2</span>]=mod*K<br>    M=matrix(ZZ,M)<br>    <span class="hljs-keyword">return</span> M.LLL()<br>A=getVec(q,t,D)<br>vv=A[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>):<br>    <span class="hljs-keyword">if</span>(A[i][-<span class="hljs-number">3</span>]==<span class="hljs-number">1</span>):<br>        vv=A[i]<br>        <span class="hljs-keyword">break</span><br>R=vv <span class="hljs-keyword">if</span> vv[<span class="hljs-number">0</span>]&gt;=<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> -vv<br>s=[]<br>b=<span class="hljs-number">279349696642264188298419300151331525710</span><br>h=b<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    h=(t*h)%q<br>    s.append(h^^(h+R[i]))<br>    h+=R[i]<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-comment">#[1, 0, 7, 7, 14, 2, 1, 7, 5, 2, 1, 5, 6, 5, 0, 1, 0, 0, 0, 3, 7, 0, 4, 13, 15, 14, 7, 13, 3, 0, 2, 2, 3, 4, 0, 10, 12, 5, 2, 2, 3, 3, 1, 7, 60, 1, 0, 0, 0, 3, 1, 1, 0, 0, 1, 0, 63, 1, 7, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span><br><span class="hljs-built_in">print</span>(CH(<span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x31</span>]+s)))<br><span class="hljs-comment">#201431453607244229943761366749810895688</span><br><span class="hljs-built_in">print</span>(<span class="hljs-number">201431453607244229943761366749810895688</span>)<br><span class="hljs-comment">#201431453607244229943761366749810895688</span><br><span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x31</span>]+s).<span class="hljs-built_in">hex</span>()<br><span class="hljs-comment">#31010007070e0201070502010506050001000000030700040d0f0e070d030002020304000a0c050202030301073c01000000030101000001003f010701000000000000000000000000000000000000000000000000000000000000000000000000</span><br></code></pre></td></tr></table></figure><p><img src="/2024/12/16/ciscn2025wp1/5.png" alt="5"></p><p>flag:<code>flag&#123;d57bee7d-c49a-49f8-86a2-b7fd36889d00&#125;</code></p><h2 id="3-LWEWL"><a href="#3-LWEWL" class="headerlink" title="3.LWEWL"></a>3.LWEWL</h2><h3 id="3x01-ç¬¬ä¸€é—®"><a href="#3x01-ç¬¬ä¸€é—®" class="headerlink" title="3x01 ç¬¬ä¸€é—®"></a>3x01 ç¬¬ä¸€é—®</h3><p>ç¬¬ä¸€é—®ç»™äº† 612  ç»„  $b&#x3D;\vec a\cdot \vec s+257 e$ï¼Œæ²¡æœ‰å–æ¨¡ã€‚ç„¶ååŠ å¯†æ–¹å¼æ˜¯ $b\equiv \vec a\cdot \vec s+257 e+m \pmod {1048583}$ï¼Œæœ‰å–æ¨¡ã€‚</p><p>å› ä¸ºç¬¬ä¸€é—®çš„LWEæ˜¯ $b&#x3D;\vec a\cdot \vec s+257 e$ã€‚å› æ­¤ä¸¤è¾¹æ¨¡ $257$ ï¼Œè¯¯å·®å°±æ²¡æœ‰äº†ã€‚å¯ä»¥ç›´æ¥è§£å‡ºå‘é‡ $\vec s$ çš„æ¯ä¸ªåˆ†é‡æ¨¡ $257$ çš„å€¼ ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">LWEPK=load(<span class="hljs-string">&#x27;lwe_public_key&#x27;</span>)<br>LWEC=load(<span class="hljs-string">&#x27;lwe_ciphertext&#x27;</span>)<br>pka,pkb=LWEPK<br>ca,cb=LWEC<br>mtxpA=Matrix(GF(<span class="hljs-number">257</span>),pka[:<span class="hljs-number">512</span>])<br>vecpb=vector(GF(<span class="hljs-number">257</span>),pkb[:<span class="hljs-number">512</span>])<br>vecs257=(mtxpA**-<span class="hljs-number">1</span>)*vecpb<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">513</span>,<span class="hljs-number">612</span>):<br>    <span class="hljs-keyword">assert</span> vector(GF(<span class="hljs-number">257</span>),pka[i])*vecs257==pkb[i]%<span class="hljs-number">257</span><br><span class="hljs-comment">#assert é€šè¿‡ã€‚</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„åˆ°æ²¡æœ‰å–æ¨¡æ“ä½œï¼Œå¹¶ä¸”ç»™äº†é‚£ä¹ˆå¤šæ•°æ®ã€‚ç›²çŒœå­˜åœ¨ç§é’¥ $\vec s$ æ³„éœ²ã€‚</p><p>æ±‚å‡ºäº† $\vec s$ æ¯ä¸ªåˆ†é‡æ¨¡ $257$ çš„<strong>å‡†ç¡®å€¼</strong>ä¹‹åï¼Œé‚£å°±å¯ä»¥æŠŠ $\vec s$ åˆ†æˆ $\vec s&#x3D;257\vec s_H+\vec s_L$ã€‚å…¶ä¸­ $\vec s_L$ æ˜¯æˆ‘ä»¬åˆšæ±‚å‡ºæ¥çš„ $\vec s$ æ¯ä¸ªåˆ†é‡æ¨¡ $257$ çš„ç»“æœã€‚</p><p>é‚£ä¹ˆå°±æœ‰ $b&#x3D;\vec a\cdot \vec s_L+257\vec a\cdot\vec s_H+257 e$ã€‚æ•´ç†ä¸€ä¸‹ï¼Œå°±æœ‰ $\dfrac{b-\vec a\cdot \vec s_L}{257}&#x3D;\vec a \cdot \vec s_H +e$ã€‚è¿™é‡Œ $e$ çš„çš„ç»å¯¹å€¼ä¸è¶…è¿‡ $15$ï¼Œ $\vec s_H$ çš„æ¯ä¸ªåˆ†é‡ä¸Šé™å€¼ç•¥ä½äº $4096$ ï¼ˆå¤§æ¦‚æ˜¯å››åƒé›¶å…«åå‡ ï¼‰ã€‚å°è¯•å¼ºè¡Œæ±‚è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">pkbr=[(pkb[i]-vector(ZZ,pka[i])*vecs257.change_ring(ZZ))//<span class="hljs-number">257</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">612</span>)]<br>RF1K=RealField(<span class="hljs-number">1000</span>)<br>A=matrix(RF1K,pka[:<span class="hljs-number">512</span>])<br>vrb=vector(RF1K,pkbr[:<span class="hljs-number">512</span>])<br>f=A.solve_right(vrb)<br></code></pre></td></tr></table></figure><p>æµ‹ä¸€ä¸‹è§£å‡ºæ¥çš„å€¼ï¼Œå‘ç°å°æ•°éƒ¨åˆ†ä¸æ˜¯ $0000$ å°±æ˜¯ $9999$ï¼Œå¹¶ä¸”æ¯ä¸ªé‡çš„å¤§å°ç¬¦åˆé¢„æœŸï¼ˆä¸Šé™å››åƒé›¶å…«åå‡ ï¼Œå‡åŒ€åˆ†å¸ƒçš„è¯ï¼Œå¹³å‡å€¼åº”è¯¥æ˜¯ä¸¤åƒå¤šä¸€ç‚¹ï¼‰ï¼Œçœ‹æ¥è§£çš„æŒºæˆåŠŸçš„ã€‚æœç„¶æœ‰æ€è·¯äº†æ„Ÿè§‰å¯ä»¥ï¼Œè¿˜æ˜¯è¦æ•¢åšæ‰æ•¢èµ¢ã€‚</p><p><img src="/2024/12/16/ciscn2025wp1/6.png" alt="6"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>(f)/<span class="hljs-built_in">len</span>(f))<br><span class="hljs-comment">#2009.96874997776160337770580881274982166822040808118839110467659132914509888108790192401929747758265873815462669464429511425547300791249092612758307303074944364972205465412080525094462257069285726770549633697572244153728953621331352055730480085919509414632437397365432465233683065741178107243748044155</span><br></code></pre></td></tr></table></figure><p>é‚£å°±å¯¹ $\vec s_H$ å››èˆäº”å…¥ï¼Œç›´æ¥å‡ºäº†ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">sh=[i.<span class="hljs-built_in">round</span>()<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f]<br>s=[sh[i]*<span class="hljs-number">257</span>+Integer(vecs257[i])<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>)]<br>pp=[]<br>q=<span class="hljs-number">1048583</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">18</span>):<br>    pp.append(vector(GF(q),ca[i])*vector(GF(q),s))<br>s=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">18</span>):<br>    s+=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">int</span>(cb[i])%<span class="hljs-number">257</span>-<span class="hljs-built_in">int</span>(pp[i])%<span class="hljs-number">257</span>)%<span class="hljs-number">257</span>)<br>s<br><span class="hljs-comment">#a3bc5491-fa53-4&#125;47</span><br></code></pre></td></tr></table></figure><p>ä½†ï¼Œæœ‰ä¸€ä½ä¸å¯¹ã€‚ã€‚ã€‚åŸå› è§ **3x04 **éƒ¨åˆ†ã€‚</p><h3 id="3x02-ç¬¬äºŒé—®"><a href="#3x02-ç¬¬äºŒé—®" class="headerlink" title="3x02 ç¬¬äºŒé—®"></a>3x02 ç¬¬äºŒé—®</h3><p>ç¬¬äºŒé—®æ˜¯ä¸€ä¸ªRLWEé—®é¢˜ã€‚æ²¡æœ‰ç»™ä»€ä¹ˆå…¶ä»–çš„ä¿¡æ¯ï¼Œflagåº”è¯¥æ˜¯ 18 ä½ï¼Œç›²çŒœåªåŒ…æ‹¬ <code>0123456789abcdef-</code> è¿™ 17 ä¸ªå­—ç¬¦ã€‚</p><p>å…ˆå¯¼å…¥æµ‹ä¸€ä¸‹å§ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">CRLWE=load(<span class="hljs-string">&#x27;rlwe_ciphertext&#x27;</span>)<br>a, b, f, p=CRLWE<br><span class="hljs-built_in">print</span>(a)<br><span class="hljs-comment">#é•¿åº¦ä¸º 64  çš„list</span><br><span class="hljs-built_in">print</span>(b)<br><span class="hljs-comment">#63æ¬¡å¤šé¡¹å¼</span><br><span class="hljs-built_in">print</span>(f)<br><span class="hljs-comment">#64æ¬¡å¤šé¡¹å¼</span><br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-comment">#294258122831803380997956804968164525729</span><br></code></pre></td></tr></table></figure><p>è¿™è¾¹ï¼Œå…¬å…±å‚æ•°æ˜¯ $a(x)$ï¼Œå¯†æ–‡æ˜¯ $b(x)&#x3D;a(x)s(x)+e(x)$ï¼Œä¸å¯çº¦å¤šé¡¹å¼æ˜¯ $f(x)$ï¼Œæ¨¡æ•° $p$ ä¸º $128$ ä½ç´ æ•°ã€‚å…¶ä¸­ $s(x)$ çš„ç³»æ•°æ˜¯ flagååŠéƒ¨åˆ†ã€‚è€Œ $e(x)$ çš„æ¯ä¸ªåˆ†é‡çš„ç»å¯¹å€¼ä¸è¶…è¿‡ $5$ã€‚ç„¶åé¢˜ç›®å°±æ²¡ç»™å…¶ä»–çš„ä¸œè¥¿äº†ã€‚</p><p>æ—¢ç„¶å¤§æ•°å­—ä¸‹é¢åˆæœ‰å°æ•°å­—ï¼Œè€ƒè™‘ LLLæ±‚è§£ã€‚ä½†æ€æ ·æ„å»ºLLLå‘¢ï¼Ÿ</p><p>è®°ç¬¦å· $f_i$ ä¸º $f(x)$ ä¸­ $x^{i}$ çš„ç³»æ•°ã€‚</p><p>å› æ­¤æœ‰ç­‰å¼ï¼ˆæ³¨æ„ä¸‹æ ‡å­—æ¯ï¼Œè¿™ä¸ª $b_r$ è¡¨ç¤ºå¯¹äºæŒ‡å®šçš„ä¸€ä¸ª $b$ å€¼ï¼‰ï¼š<br>$$<br>b_r&#x3D;\sum_{i&#x3D;0}^{63} (x^ia)_r \cdot s_i+e_r-k_rp<br>$$<br>æ³¨æ„é‚£ä¸ª $xa$ æ˜¯è¿åœ¨ä¸€èµ·å–ä¸‹æ ‡çš„çš„ã€‚æœ‰äººè¦è¯´ï¼šé‚£è¶…è¿‡ $64$ äº†æ€ä¹ˆåŠï¼Ÿä¸æ˜¯æœ‰ $f(x)$ å–æ¨¡å—ï¼Ÿå› æ­¤è¿™ä¸ª $xa$ ä¹Ÿæ˜¯å¯¹ $f(x)$ å–æ¨¡çš„ç»“æœã€‚</p><p>å»åŒä½™ï¼Œä¹Ÿå°±æ˜¯<br>$$<br>b_r&#x3D;\sum_{i&#x3D;0}^{63} (x^ia)_r \cdot s_i+e_r-k_rp<br>$$<br>è¿™æ ·å°±å¯ä»¥æ„é€ LLLäº†ã€‚è¿˜æ˜¯ä»¥ä¸‰ä¸ªä¸ºä¾‹ï¼š</p><p><img src="/2024/12/16/ciscn2025wp1/7.png" alt="7"></p><p>å¯¹è¿™ä¸ªçŸ©é˜µLLLå°±è¡Œã€‚(å‘ç° <code>quotient</code> è¿˜æ˜¯æ¯” <code>GF(p**n,modulus=list(f))</code> å¥½ç”¨ï¼Œå› ä¸º <code>quotient</code> ä¸­çš„å…ƒç´ å¯ä»¥ç”¨ <code>list()</code> å»æå–)ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">OP.&lt;x&gt;=PolynomialRing(GF(p))<br>R.&lt;x&gt;=OP.quotient(OP(f))<br>c=[<span class="hljs-built_in">list</span>(R(a)*(x**i)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">19</span>)]<br>c=matrix(c)<br>M=block_matrix(ZZ,<br>    [[p*identity_matrix(<span class="hljs-number">64</span>),zero_matrix(<span class="hljs-number">64</span>,<span class="hljs-number">19</span>)],<br>    [c.change_ring(ZZ),identity_matrix(<span class="hljs-number">19</span>)],<br>    [matrix(ZZ,<span class="hljs-built_in">list</span>(b)),matrix(ZZ,[<span class="hljs-number">0</span>]*<span class="hljs-number">18</span>+[<span class="hljs-number">1</span>])]])<br>M3L=M.LLL()<br>res=<span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> vv <span class="hljs-keyword">in</span> M3L:<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(vv[-<span class="hljs-number">1</span>])==<span class="hljs-number">1</span>):<br>        res=vv<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(res)<br><span class="hljs-comment">#(2, -2, -2, -2, -2, -1, -5, -3, 0, -3, -3, -1, 3, 0, -4, -4, -2, 5, 1, 5, -5, 4, -5, 4, 3, -1, -2, 4, 5, -3, -1, 2, 4, -5, -4, -5, -2, -5, 3, 1, 4, 3, -1, -1, 2, 5, -4, 4, -2, -2, -1, -4, -4, -4, 2, -2, -1, -2, -1, -1, 3, 3, -1, -5, -45, -56, -56, -49, -57, -45, -56, -53, -54, -97, -56, -102, -101, -53, -97, -100, -97, -48, 1)</span><br></code></pre></td></tr></table></figure><p>æœ€åç»“æœå¯è§ï¼šå‰é¢åº”è¯¥æ˜¯ $-e$ ï¼Œä¸­é—´æ˜¯ $-s$ï¼Œæœ€åä¸€ä¸ª $1$ ä¸ºå“¨å…µã€‚</p><p>è‡³äºä¸ºä»€ä¹ˆæ˜¯ $19$ï¼Œå› ä¸ºæˆ‘å¼€å§‹ç”¨äº† $18$ï¼Œå‘ç°æœ€åä¸€ä½æ˜¯ $-45$ å¾ˆæ˜æ˜¾ä¸å¯¹ï¼Œæˆ‘è¿˜è¦åœ¨æœ€åæ”¾ä¸ªå“¨å…µ $1$ï¼Œä¸å¤Ÿæ”¾äº†ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ $19$ï¼Œæœ€åä¸€ä½æ˜¯ $-48$ ï¼Œå–ååå°±æ˜¯å­—ç¬¦ <code>0</code>ã€‚</p><p>é‚£å°±ç›´æ¥æå–å§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">C=-vector([-<span class="hljs-number">45</span>, -<span class="hljs-number">56</span>, -<span class="hljs-number">56</span>, -<span class="hljs-number">49</span>, -<span class="hljs-number">57</span>, -<span class="hljs-number">45</span>, -<span class="hljs-number">56</span>, -<span class="hljs-number">53</span>, -<span class="hljs-number">54</span>, -<span class="hljs-number">97</span>, -<span class="hljs-number">56</span>, -<span class="hljs-number">102</span>, -<span class="hljs-number">101</span>, -<span class="hljs-number">53</span>, -<span class="hljs-number">97</span>, -<span class="hljs-number">100</span>, -<span class="hljs-number">97</span>, -<span class="hljs-number">48</span>])<br><span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">list</span>(C))<br><span class="hljs-comment">#-8819-856a8fe5ada0</span><br></code></pre></td></tr></table></figure><h3 id="3x03-è€ƒè¯•åˆ°16-56çš„æƒ…å†µ"><a href="#3x03-è€ƒè¯•åˆ°16-56çš„æƒ…å†µ" class="headerlink" title="3x03 è€ƒè¯•åˆ°16:56çš„æƒ…å†µ"></a>3x03 è€ƒè¯•åˆ°16:56çš„æƒ…å†µ</h3><p>ä¸¤éƒ¨åˆ†æ‹¼æ¥ï¼š</p><p><img src="/2024/12/16/ciscn2025wp1/8.png" alt="8"></p><p>é‚£ä¸­é—´è¿˜æœ‰ä¸€ä½ä¸å¯¹å‘¢ï¼æ­¤æ—¶å·²ç»æ˜¯ 16:56äº†ã€‚æ¥ä¸åŠç»†æƒ³äº†ï¼Œç›´æ¥ä¸‰åˆ†é’Ÿè¿äº¤ 16 æ¬¡ï¼Œä» 0 è¯•åˆ°äº† fã€‚ç»“æœæœ€åä¸€æ¬¡å‡ºäº†ï¼ˆè„¸çœŸé»‘ï¼‰</p><p><code>flag&#123;a3bc5491-fa53-4f47-8819-856a8fe5ada0&#125;</code></p><p>16:59:03äº¤äº†flagï¼Œ400åˆ†åˆ°æ‰‹ï¼Œä¸­é—´è¢«æç¤ºä¸¤æ¬¡æäº¤è¿‡äºé¢‘ç¹ï¼ŒçœŸåˆºæ¿€å•Šï¼Œè¿˜å¥½æ²¡æœ‰é™åˆ¶CTFçš„flagæäº¤æ¬¡æ•°ï¼Œè®©æˆ‘è¿™ä¸ªæ°´å¹³å¹¶ä¸å¤ªè¡Œçš„cryptoerä¹Ÿå·é¸¡æˆåŠŸäº†ã€‚</p><p>ï¼ˆä¸è¿‡æ®è¯´è¿™ä¸ªé¢˜æœ‰åŸé¢˜ï¼Ÿçœ‹æ¥è¿˜è¦å¤šç»ƒå•Šï¼Œä½†æœŸæœ«è€ƒè¯•è¦åˆ°äº†ï¼‰</p><p><img src="/2024/12/16/ciscn2025wp1/9.png" alt="9"></p><h3 id="3x04-èµ›åæ€è€ƒ-ä¸ºå•¥é‚£ä¸€ä½è§£ä¸å‡ºæ¥"><a href="#3x04-èµ›åæ€è€ƒ-ä¸ºå•¥é‚£ä¸€ä½è§£ä¸å‡ºæ¥" class="headerlink" title="3x04 (èµ›åæ€è€ƒ)ä¸ºå•¥é‚£ä¸€ä½è§£ä¸å‡ºæ¥"></a>3x04 (èµ›åæ€è€ƒ)ä¸ºå•¥é‚£ä¸€ä½è§£ä¸å‡ºæ¥</h3><p>å†æµ‹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">pp=[]<br>q=<span class="hljs-number">1048583</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">18</span>):<br>    pp.append(vector(GF(q),ca[i])*vector(GF(q),s))<br><span class="hljs-built_in">print</span>(pp)<br><span class="hljs-built_in">print</span>(cb)<br><span class="hljs-comment">#[463996, 243852, 639733, 817669, 561259, 349164, 74393, 545321, 988914, 632572, 726690, 568995, 560062, 709951, 861692, 24980, 278164, 701247]</span><br><span class="hljs-comment">#[407039, 330769, 564787, 841669, 573134, 356926, 65198, 474952, 1006178, 600549, 693377, 546175, 551889, 660909, 925737, 980117, 319336, 682798]</span><br></code></pre></td></tr></table></figure><p>å‘ç° <code>pp</code> å€’æ•°ç¬¬ä¸‰ä¸ªåˆ†é‡æ˜¯ $24980$ï¼Œè€Œ <code>cb</code> å€’æ•°ç¬¬ä¸‰ä¸ªåˆ†é‡æ˜¯ $980117$ã€‚è®¡ç®—ä¸€ä¸‹ $\Z(\vec{pp})-\Z(\vec{cb})$ï¼Œæ¯ä¸ªåˆ†é‡ç»“æœå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">18</span>):<br>    <span class="hljs-built_in">print</span>(ZZ(pp[i])-ZZ(cb[i]))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">56957</span><br><span class="hljs-string">-86917</span><br><span class="hljs-string">74946</span><br><span class="hljs-string">-24000</span><br><span class="hljs-string">-11875</span><br><span class="hljs-string">-7762</span><br><span class="hljs-string">9195</span><br><span class="hljs-string">70369</span><br><span class="hljs-string">-17264</span><br><span class="hljs-string">32023</span><br><span class="hljs-string">33313</span><br><span class="hljs-string">22820</span><br><span class="hljs-string">8173</span><br><span class="hljs-string">49042</span><br><span class="hljs-string">-64045</span><br><span class="hljs-string">-955137</span><br><span class="hljs-string">-41172</span><br><span class="hljs-string">18449</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œå…¶ä»–çš„å€¼éƒ½ä¸è¶…è¿‡åä¸‡ï¼Œå› ä¸ºè¯¯å·®æœ¬èº«å°±å¾ˆå°ï¼Œåœ¨è¿™è¾¹æ‰©å±•ä¸€æ¬¡ï¼Œä¹Ÿä¸ä¼šå¸¦æ¥ç‰¹åˆ«å¤§çš„è¯¯å·®ã€‚è€Œå€’æ•°ç¬¬ä¸‰ä¸ªåˆ†é‡å·®å€¼ç«Ÿç„¶è¾¾åˆ°äº† $-955137$ï¼Œè¯´æ˜ <code>cb</code> åˆ° <code>pp</code> åŠ ä¸Šè¯¯å·®åï¼Œåˆšå¥½è¶Šè¿‡äº†å–æ¨¡çº¿ï¼Œå¯¼è‡´ç»“æœå¯¹ $1048583$ å–æ¨¡äº†ä¸€æ¬¡ã€‚</p><p>å› ä¸º $-1048583 \equiv -23 \pmod {257}$ï¼Œå› æ­¤å€’æ•°ç¬¬ä¸‰ä½åˆšå¥½å¤šäº† $23$ã€‚è€Œ $125-23&#x3D;102$ï¼Œæ°å¥½å¯¹åº” <code>f</code>ï¼ŒåŸå› å°±æ‰¾åˆ°äº†ã€‚ã€‚ã€‚</p><p>æ‰€ä»¥åŠ ä¸ªç‰¹åˆ¤ï¼Œè¿™æ ·å°±å¯¹äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">s=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">18</span>):<br>    chi=ZZ(cb[i])-ZZ(pp[i])<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(chi)&gt;<span class="hljs-number">500000</span>):<br>        chi=sgn(chi)*(chi-q)<br>    s+=<span class="hljs-built_in">chr</span>(chi%<span class="hljs-number">257</span>)<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-comment">#a3bc5491-fa53-4f47</span><br></code></pre></td></tr></table></figure><h3 id="3x05-ocå¸ˆå‚…çš„wp"><a href="#3x05-ocå¸ˆå‚…çš„wp" class="headerlink" title="3x05 ocå¸ˆå‚…çš„wp"></a>3x05 ocå¸ˆå‚…çš„wp</h3><p>16æ—¥æ™šä¸Šï¼Œocå¸ˆå‚…å‘Šè¯‰æˆ‘è¿™ä¸ªé¢˜å¯ä»¥ç›´æ¥æœ€å°äºŒä¹˜æ³•ï¼Œå› ä¸º<code>samples*error_bound&lt;mod</code>ã€‚</p><p>å¹¶ä¸”ä»£ç çœ‹ç€æ›´ç®€æ´ï¼Œä»–æ²¡æœ‰è€ƒè™‘é«˜ä½ä½çš„é—®é¢˜ã€‚å½“ç„¶ï¼Œå› ä¸ºä»–å–çš„æ˜¯ $(-p&#x2F;2,p&#x2F;2)$ çš„èŒƒå›´ï¼Œè€Œä¸æ˜¯ $[0,p-1]$ çš„èŒƒå›´ï¼Œå› æ­¤è²Œä¼¼æ²¡æœ‰å‡ºç°é”™è¯¯è§£çš„é—®é¢˜ï¼Œç­‰åé¢å†å­¦ä¹ ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>lwe_pubkey1,lwe_pubkey2=load(<span class="hljs-string">&quot;lwe_public_key&quot;</span>)<br>lwe_cipher1,lwe_cipher2=load(<span class="hljs-string">&quot;lwe_ciphertext&quot;</span>)<br>rlwe_ciphertext=load(<span class="hljs-string">&quot;rlwe_ciphertext&quot;</span>)<br><br>lwe_dimension = <span class="hljs-number">2</span>**<span class="hljs-number">9</span><br>lwe_num_samples = <span class="hljs-number">2</span>**<span class="hljs-number">9</span> + <span class="hljs-number">2</span>**<span class="hljs-number">6</span> + <span class="hljs-number">2</span>**<span class="hljs-number">5</span> + <span class="hljs-number">2</span>**<span class="hljs-number">2</span><br>lwe_plaintext_modulus = next_prime(<span class="hljs-number">256</span>)<br>lwe_ciphertext_modulus = next_prime(<span class="hljs-number">1048576</span>)<br>rlwe_dim = <span class="hljs-number">64</span><br>a, b, f, rlwe_modulus = rlwe_ciphertext<br><br>lwe_secret_key=np.linalg.lstsq(np.array(lwe_pubkey1),np.array(lwe_pubkey2))[<span class="hljs-number">0</span>].<span class="hljs-built_in">round</span>().astype(<span class="hljs-built_in">int</span>)<br><br>flag=<span class="hljs-string">&#x27;flag&#123;&#x27;</span><br><span class="hljs-keyword">for</span> tmp1, tmp2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(lwe_cipher1, lwe_cipher2):<br>    t=<span class="hljs-built_in">int</span>(tmp2-tmp1*vector(lwe_secret_key))<br>    <span class="hljs-keyword">if</span> t&gt;lwe_ciphertext_modulus//<span class="hljs-number">2</span>:<br>        t+=((lwe_ciphertext_modulus-t)//lwe_plaintext_modulus+<span class="hljs-number">1</span>)*lwe_plaintext_modulus-lwe_ciphertext_modulus<br>    <span class="hljs-keyword">else</span>:<br>        t-=t//lwe_plaintext_modulus*lwe_plaintext_modulus<br>    flag+=<span class="hljs-built_in">chr</span>(t)<br><br>m=<span class="hljs-built_in">len</span>(lwe_cipher2)+<span class="hljs-number">1</span><br>P.&lt;x&gt; = PolynomialRing(Zmod(rlwe_modulus))<br>PR = P.quo(f)<br>M=block_matrix(ZZ,[[matrix(b.<span class="hljs-built_in">list</span>()),zero_matrix(<span class="hljs-number">1</span>,m),matrix([<span class="hljs-number">100</span>])],<br>                 [PR(a).matrix()[:m],identity_matrix(m),zero_matrix(m,<span class="hljs-number">1</span>)],<br>                 [rlwe_modulus*identity_matrix(rlwe_dim),zero_matrix(rlwe_dim,m),zero_matrix(rlwe_dim,<span class="hljs-number">1</span>)]])<br>L=M.LLL()<br>flag+=<span class="hljs-built_in">bytes</span>(L[<span class="hljs-number">0</span>][rlwe_dim:rlwe_dim+m]).rstrip(<span class="hljs-string">b&#x27;\x00&#x27;</span>).decode()+<span class="hljs-string">&#x27;&#125;&#x27;</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="4-å¾…è¡¥é¢˜-babypqc"><a href="#4-å¾…è¡¥é¢˜-babypqc" class="headerlink" title="4.[å¾…è¡¥é¢˜]babypqc"></a>4.[å¾…è¡¥é¢˜]babypqc</h2><p>åé¢çœ‹æƒ…å†µè¡¥å……ï¼Œæ®è¯´æœ‰éé¢„æœŸï¼Œä½†æˆ‘ä¹Ÿå¾ˆå¥½å¥‡é¢„æœŸè§£æ˜¯å•¥ï¼Œè¿™ä¸ªé¢˜å¥½åƒæ˜¯ä¸€ä¸ªLWEç­¾åï¼Œè‡ªå·±å¯¹CTFä¸­çš„LWEè¿˜ä¸å¤ªä¼šå‘¢ã€‚ã€‚ã€‚å’‹æ„Ÿè§‰ç°åœ¨CTFé¢˜ç›®è¶Šæ¥è¶Šå¥‡æ€ªäº†ï¼Ÿ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs awk">ğŸ¦Œ <span class="hljs-number">2024</span><span class="hljs-regexp">/12/</span><span class="hljs-number">15</span> <span class="hljs-number">21</span>:<span class="hljs-number">11</span>:<span class="hljs-number">04</span><br>å¯¹çš„<br><br>ğŸ¦Œ <span class="hljs-number">2024</span><span class="hljs-regexp">/12/</span><span class="hljs-number">15</span> <span class="hljs-number">21</span>:<span class="hljs-number">11</span>:<span class="hljs-number">09</span><br>æˆ‘å¤ç°äº†ä¸€äº›<br><br>ğŸ¦Œ <span class="hljs-number">2024</span><span class="hljs-regexp">/12/</span><span class="hljs-number">15</span> <span class="hljs-number">21</span>:<span class="hljs-number">11</span>:<span class="hljs-number">16</span><br>méšä¾¿ä¼ <br><br>ğŸ¦Œ <span class="hljs-number">2024</span><span class="hljs-regexp">/12/</span><span class="hljs-number">15</span> <span class="hljs-number">21</span>:<span class="hljs-number">11</span>:<span class="hljs-number">22</span><br>signaturesä¼ []<br><br>ğŸ¦Œ <span class="hljs-number">2024</span><span class="hljs-regexp">/12/</span><span class="hljs-number">15</span> <span class="hljs-number">21</span>:<span class="hljs-number">11</span>:<span class="hljs-number">29</span><br>ä¼šä½¿å¾—answers=<span class="hljs-number">0</span><br><br>ğŸ¦Œ <span class="hljs-number">2024</span><span class="hljs-regexp">/12/</span><span class="hljs-number">15</span> <span class="hljs-number">21</span>:<span class="hljs-number">11</span>:<span class="hljs-number">39</span><br>è€Œnumæœ‰<span class="hljs-number">1</span>/<span class="hljs-number">16</span>çš„æ¦‚ç‡ä¸º<span class="hljs-number">0</span><br><br>ğŸ¦Œ <span class="hljs-number">2024</span><span class="hljs-regexp">/12/</span><span class="hljs-number">15</span> <span class="hljs-number">21</span>:<span class="hljs-number">11</span>:<span class="hljs-number">43</span><br>è¿™ä¸ªå°±ä¸€ç›´ncåˆ·å°±å¥½äº†<br><br></code></pre></td></tr></table></figure><h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9. æ€»ç»“"></a>9. æ€»ç»“</h2><p>ä¸çŸ¥ä¸è§‰å·²ç»3ä¸ªæœˆäº†ï¼Œæ„Ÿè§‰è‡ªå·±è¿™3ä¸ªæœˆè¿˜æ˜¯å­¦äº†æŒºå¤šçš„ï¼Œæ‰‹æ„Ÿæ¢å¤äº†ã€‚é ç€å­¦é•¿ä»¬å¸¦æˆ‘ï¼Œæ‰“äº†äº›æ¯”èµ›ï¼Œæ”¶è·äº†ä¸å°‘ã€‚</p><p>ç¬¬ä¸€æ¬¡åœ¨æ¯”èµ›ä¸­åšå‡ºäº† ä¸ªä½æ•° è§£çš„é¢˜ç›®ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><p>é˜Ÿé‡Œçš„å­¦é•¿ä»¬è¿˜æ˜¯tqlï¼Œèƒ½æŠŠæˆ‘è¿™ä¸ªä¸å¤ªè¡Œçš„ctferå¸¦åŠ¨ã€‚ä½†åé¢ä¹Ÿå¾—é è‡ªå·±å‘åŠ›äº†ï¼Œäº‰å–èƒ½å’Œå­¦é•¿ä»¬ä¸€æ ·æˆåŠŸå§ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LatticeNotes8</title>
    <link href="/2024/12/05/LatticeNotes8/"/>
    <url>/2024/12/05/LatticeNotes8/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087æ„é€ æ ¼LLLçš„ç¬”è®°-8"><a href="#huangx607087æ„é€ æ ¼LLLçš„ç¬”è®°-8" class="headerlink" title="huangx607087æ„é€ æ ¼LLLçš„ç¬”è®° 8"></a>huangx607087æ„é€ æ ¼LLLçš„ç¬”è®° 8</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>æœ€è¿‘çœ‹åˆ°å‡ ä¸ªé¢˜ç›®æ„é€ çŸ©é˜µç„¶åLLLçš„ï¼Œå‘ç°è‡ªå·±ä»¥å‰çš„ä¸€äº›åšæ³•å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå› æ­¤åœ¨è¿™è¾¹è®°å½•ä¸€ä¸‹æ–°å­¦åˆ°çš„ä¸€äº›å†…å®¹ã€‚</p><p>å’Œå‰é¢çš„ç¬”è®°ä¸ä¸€æ ·ï¼Œè¿™ç¯‡ç¬”è®°ä¸­ï¼Œå¾ˆå¤šé¢˜ç›®éƒ½æ˜¯ä»¥å‰å‡ºç°è¿‡çš„ï¼Œå› æ­¤åœ¨è¿™é‡Œå¯¹éƒ¨åˆ†é¢˜ç›®å†è¿›è¡Œä¸€ä¸ªå¤ç›˜ã€‚</p><p>æœ€è¿‘å‘ç°å¾ˆå¤šå¸ˆå‚…éƒ½çœ‹è¿‡æˆ‘åšå®¢ï¼Ÿå¹¶ä¸”è¿™é‡Œæœ‰äº›å¸ˆå‚…è¿˜æ˜¯åœ¨æˆ‘é€€å½¹åå…¥å‘çš„ã€‚ï¼ˆå…¶å®ï¼Œæˆ‘è‡ªå·±éƒ½ä¸çŸ¥é“ï¼Œè‡ªå·±åœ¨2021å¹´å†™äº†å†™å•¥äº†ï¼‰</p><h2 id="1-å›é¡¾ä»¥å‰çš„çŸ¥è¯†"><a href="#1-å›é¡¾ä»¥å‰çš„çŸ¥è¯†" class="headerlink" title="1. å›é¡¾ä»¥å‰çš„çŸ¥è¯†"></a>1. å›é¡¾ä»¥å‰çš„çŸ¥è¯†</h2><h3 id="1x01-å‡ ä¸ªå®šç†"><a href="#1x01-å‡ ä¸ªå®šç†" class="headerlink" title="1x01 å‡ ä¸ªå®šç†"></a>1x01 å‡ ä¸ªå®šç†</h3><p><strong>é«˜æ–¯å¯å‘å¼ï¼š</strong>åœ¨ç¬”è®°2ä¸­ï¼Œæˆ‘ä»¬æåˆ°äº†é«˜æ–¯å¯å‘å¼ï¼Œä¹Ÿå°±æ˜¯å¯¹äºä¸€ä¸ªæ ¼çŸ©é˜µ $L$ ï¼Œè‹¥æƒ³åœ¨åŸç‚¹æ„é€ ä¸€ä¸ªåŠå¾„ä¸º $r$ çš„ï¼ˆé«˜ç»´ï¼‰çƒï¼Œä½¿å¾—è¿™ä¸ªçƒä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ ¼ç‚¹å‘é‡ $\vec v$ï¼Œé‚£ä¹ˆå¯¹åº”çš„åŠå¾„çš„æœ€å°å€¼ $r$ ä¸º<br>$$<br>râ‰ˆ\sqrt{\dfrac{n}{2\pi e}}Â·\sqrt[n]{\det L}&#x3D;\sigma (L)<br>$$</p><p><strong>Hermiteå®šç†ï¼š</strong> ç»´æ•° $n$ çš„æ¯ä¸€ä¸ªæ ¼çŸ©é˜µ $L$ ä¸­ï¼Œå…¶æœ€çŸ­å‘é‡é•¿åº¦ $|\vec v_1|$ æ»¡è¶³<br>$$<br>|\vec v_1|\le\sqrt nÂ· \sqrt[n]{\det L}<br>$$<br><strong>Minkowskiå®šç†ï¼š</strong> è®¾ $L$ æ˜¯ $\mathbb R^n$ ä¸­çš„ä¸€ä¸ªæ ¼ï¼Œ$S$ æ˜¯ $\mathbb R^n$ ä¸­çš„ä¸€ä¸ªå¯¹ç§°å‡¸é›†ï¼Œé‚£ä¹ˆ $S$ çš„ä½“ç§¯ $\text{Vol }S&gt; 2^n \det L$ æ—¶ï¼Œ$S$ ä¸­å°±åŒ…å«ä¸€ä¸ªéé›¶æ ¼å‘é‡ã€‚</p><p>è¿™è¾¹é‡ç‚¹æ˜¯ç¬¬äºŒä¸ªçš„Hermiteå®šç†ï¼Œå› ä¸ºè¿™ä¸ªå®šç†ï¼Œæ˜ç¡®äº†æœ€çŸ­å‘é‡çš„å¤§å°ã€‚å¦‚æœå¿½ç•¥æ‰ $\sqrt n$ è¿™ä¸€ç³»æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¤§æ¦‚å¾—å‡ºç»“è®ºï¼š</p><blockquote><p>å¦‚æœå¾…æ±‚çš„ç›®æ ‡å‘é‡ $\vec v$ çš„é•¿åº¦å°äº $\sqrt[n]{\det L}$ï¼Œåˆ™åœ¨è§£é¢˜ä¸­ï¼Œæ„é€ çŸ©é˜µLLLåï¼Œå¤§æ¦‚ç‡æœ€çŸ­å‘é‡å°±æ˜¯æ‰€æ±‚çš„è§£ã€‚</p></blockquote><h3 id="1x02-æ ¼çš„æ„é€ æ–¹æ³•å›é¡¾"><a href="#1x02-æ ¼çš„æ„é€ æ–¹æ³•å›é¡¾" class="headerlink" title="1x02 æ ¼çš„æ„é€ æ–¹æ³•å›é¡¾"></a>1x02 æ ¼çš„æ„é€ æ–¹æ³•å›é¡¾</h3><h4 id="Example-1-å•ä¸ªçº¿æ€§å…³ç³»å¼"><a href="#Example-1-å•ä¸ªçº¿æ€§å…³ç³»å¼" class="headerlink" title="Example 1 å•ä¸ªçº¿æ€§å…³ç³»å¼"></a>Example 1 å•ä¸ªçº¿æ€§å…³ç³»å¼</h4><p>æ„é€ æ ¼ä¸»è¦æ˜¯å½“ç¡®å®šéƒ¨åˆ†æœªçŸ¥é‡ç›¸å¯¹äºæ¨¡æ•° $n$ å¾ˆå°ï¼Œå¹¶ä¸”æœ‰è¾ƒä¸ºæ˜æ˜¾çº¿æ€§å…³ç³»æ—¶ï¼Œé€šè¿‡çŸ©é˜µçš„æ–¹æ³•è¿æ¥å·²çŸ¥é‡å’ŒæœªçŸ¥é‡ï¼Œç„¶åæ„é€ ã€‚æ¯”å¦‚åœ¨ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#T1</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>x=[(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">95</span>)|getrandbits(<span class="hljs-number">96</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>a=[getrandbits(<span class="hljs-number">1024</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>p=getPrime(<span class="hljs-number">1024</span>)<br>veca=vector(GF(p),a)<br>vecx=vector(GF(p),x)<br>y=veca*vecx<br><span class="hljs-built_in">print</span>(y)<br><span class="hljs-built_in">print</span>(veca)<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œè¿™é‡Œæ¯ä¸ª $x$ çš„å€¼ä¸º $96$ ä½ï¼Œç„¶å $a,y,p$ å‡ä¸º $1024$ ä½ï¼Œä¸”è¿™ä¸ªçº¿æ€§å…³ç³»ç»™å¾—éå¸¸æ˜æ˜¾ï¼š<br>$$<br>a_1x_1+a_2x_2+a_3x_3\equiv y \pmod p<br>$$<br>å»åŒä½™ï¼Œå¯ä»¥æœ‰<br>$$<br>a_1x_1+a_2x_2+a_3x_3-y-kp&#x3D;0<br>$$<br>å› ä¸ºæˆ‘ä»¬è¦æ±‚çš„å†…å®¹æ˜¯ $x$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æš‚æ—¶æŠŠ $x$ æ”¾åœ¨å‰ $3$ ä¸ªã€‚å› ä¸ºä¸Šé¢çš„çº¿æ€§å…³ç³»ä¸€å…±æ˜¯äº”é¡¹ï¼Œå› æ­¤å¯ä»¥æœ‰ $1\times -y$ å’Œ $-k\times p$ é¡¹ã€‚å› æ­¤ï¼ŒçŸ©é˜µçš„æœ€åä¸€åˆ—å¯ä»¥æ”¾å…¥ $(a_1,a_2,a_3,-y,p)$ã€‚è€Œç¬¬å››åˆ—çš„ $1$ï¼Œæ˜¯ä¸ºäº†ç¬¬äº”åˆ—ç¬¬å››è¡Œçš„ $y$ åŒ¹é…ã€‚è¿™ä¸ª $1$ ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªæ ‡å¿—ä½¿ç”¨ã€‚å› ä¸ºæˆ‘ä»¬ç»“å‡ºæ¥çš„å‘é‡ <strong>å¯èƒ½ä¸æ˜¯</strong> æœ€çŸ­å‘é‡ï¼Œè¿™ä¸ª $1$ å’Œæœ€åçš„ $0$ å¯ä»¥å½“æˆä¸€ä¸ªå“¨å…µï¼Œå¦‚æœæˆ‘ä»¬æœ€åLLLçš„åçŸ©é˜µä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦ç­›é€‰å‡ºå€’æ•°ç¬¬äºŒä¸ªåˆ†é‡ä¸º $1$ï¼Œæœ€åä¸€ä¸ªåˆ†é‡ä¸º $0$ çš„å‘é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå‘é‡çš„å‰ä¸‰ä¸ªåˆ†é‡å°± <strong>å¯èƒ½æ˜¯</strong> $x_1,x_2,x_3$ã€‚</p><p><img src="/2024/12/05/LatticeNotes8/1.png" alt="1"></p><p>ç„¶åæˆ‘ä»¬å¯ä»¥å†™ä¸ªä»£ç æµ‹è¯•ä¸€ä¸‹ï¼š</p><p><img src="/2024/12/05/LatticeNotes8/2.png" alt="2"></p><p>å¯ä»¥çœ‹å‡ºï¼Œæœ€åæ±‚å‡ºçš„ç¬¬ä¸€ä¸ªå‘é‡ï¼Œæ°å¥½å°±æ˜¯ä¸‰ä¸ªæœªçŸ¥çš„ $x$ å€¼ã€‚</p><h4 id="Example-2-å¤šä¸ªçº¿æ€§å…³ç³»å¼"><a href="#Example-2-å¤šä¸ªçº¿æ€§å…³ç³»å¼" class="headerlink" title="Example 2 å¤šä¸ªçº¿æ€§å…³ç³»å¼"></a>Example 2 å¤šä¸ªçº¿æ€§å…³ç³»å¼</h4><p>å½“ç„¶ï¼Œå…¶å®ä¹Ÿä¸ä¸€å®šè¦æ„é€ å¯¹è§’çº¿å…¨ $1$ï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œä¼šä¸¥é‡æ‹‰ä½çŸ©é˜µçš„è¡Œåˆ—å¼çš„å€¼ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´æ±‚å‡ºæ¥çš„å‘é‡ä¸åœ¨æœ€çŸ­çš„ $n$ ä¸ªå‘é‡ä¸­ã€‚å¦‚æœæœ‰æœªçŸ¥é‡å’ŒæœªçŸ¥é‡ä¹‹é—´çš„å…³ç³»ï¼Œä¹Ÿå¯ä»¥ä»æœªçŸ¥é‡åˆ°æœªçŸ¥é‡æ„é€ çº¿æ€§å…³ç³»ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªé¢˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#T2</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p=getPrime(<span class="hljs-number">1024</span>)<br>x=[getPrime(<span class="hljs-number">160</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>y=[getPrime(<span class="hljs-number">160</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>a=[getrandbits(<span class="hljs-number">1024</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>b=[getrandbits(<span class="hljs-number">1024</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>z=[(a[i]*x[i]+b[i]*y[i])%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br><span class="hljs-built_in">print</span>(a)<br><span class="hljs-built_in">print</span>(b)<br><span class="hljs-built_in">print</span>(z)<br><span class="hljs-built_in">print</span>(p)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜çš„æ–¹æ³•æ˜¯ $a_ix_i+b_iy_i\equiv z_i \pmod p$ ï¼Œæœ‰ä¸¤ä¸ªæœªçŸ¥é‡ $x,y$ï¼Œå¹¶ä¸”æ•°å­—éƒ½å¾ˆå°ã€‚å¦‚æœåƒåˆšæ‰é‚£æ ·æ„é€ çŸ©é˜µï¼Œä¼šå¯¼è‡´çŸ©é˜µä¸­å¯¹è§’çº¿ä¸Šçš„ $1$ è¿‡å¤šï¼Œæ‰©å¤§äº†çŸ©é˜µçš„ç»´æ•°ï¼Œå¯¼è‡´çŸ©é˜µä¸­çš„æœ€çŸ­å‘é‡å˜å¾—å¾ˆçŸ­ï¼ˆç”šè‡³LLLåå¾—åˆ°çš„æ˜¯ä¸€ä¸ªå•ä½çŸ©é˜µçš„è¡Œç½®æ¢ï¼‰ã€‚</p><p>ç”±äº $x$ å’Œ $y$ éƒ½å¾ˆå°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä» $x$ åˆ° $y$ çš„ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œç”±äº<br>$$<br>a_ix_i+b_iy_i\equiv z_i\pmod p<br>$$<br>å› æ­¤ï¼š<br>$$<br>y_i\equiv \frac{z_i-a_ix_i}{b_i}\pmod p<br>$$<br>ä¹Ÿå°±æ˜¯ï¼š<br>$$<br>y_i\equiv Z_i-A_ix_i\pmod p<br>$$<br>å…¶ä¸­ï¼š<br>$$<br>Z_i\equiv \frac{z_i}{b_i}\pmod p,A_i\equiv \frac{a_i}{b_i} \pmod p<br>$$<br>å¯¹ä¸Šé¢çš„å¼å­å»åŒä½™ï¼Œå¯ä»¥å¾—åˆ°ï¼š<br>$$<br>y_i&#x3D;Z_i-A_ix_i-k_ip<br>$$</p><p>å› æ­¤ï¼Œå¯ä»¥æ„é€ ä¸‹é¢çš„çº¿æ€§å…³ç³»ï¼š</p><p><img src="/2024/12/05/LatticeNotes8/3.png" alt="3"></p><p>å½“ç„¶ï¼Œè¿™ä¹ˆçœ‹ç€å¥½åƒæœ‰ç‚¹ä¸å¤ªé¡ºçœ¼ï¼Œå®é™…ä¸Šï¼Œè¿™ä¹ˆè§£å‡ºæ¥ä¹Ÿå¾—ä¸åˆ°ä»»ä½•æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œå› ä¸ºè¿™ä¸ªçŸ©é˜µå½¢çŠ¶æœ‰ç‚¹æ€ªå¼‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#exp2-1</span><br>A=[a[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>Z=[z[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>M=block_matrix(ZZ,<br>    [<br>        [-diagonal_matrix(A)],<br>        [matrix(Z)],<br>        [p*identity_matrix(<span class="hljs-number">3</span>)]<br>    ]<br>)<br>M3L=M.LLL()<br><span class="hljs-built_in">print</span>(M3L)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">[ 0  0  0]</span><br><span class="hljs-string">[ 0  0  0]</span><br><span class="hljs-string">[ 0  0  0]</span><br><span class="hljs-string">[ 0  0  0]</span><br><span class="hljs-string">[-1  0  0]</span><br><span class="hljs-string">[ 0  1  0]</span><br><span class="hljs-string">[ 0  0  1]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªçŸ©é˜µçš„å·¦ä¸Šè§’å¡ä¸€ä¸ªå•ä½çŸ©é˜µï¼Œè¿™æ ·å°±æ˜¯ $7\times6$ï¼Œæ•ˆæœå¥½å¤šäº†ï¼š</p><p><img src="/2024/12/05/LatticeNotes8/4.png" alt="4"></p><p>ç„¶åè¿è¡Œä¸€ä¸‹è¿™ä¸ªä»£ç çœ‹çœ‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#exp2-2</span><br>A=[a[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>Z=[z[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>M=block_matrix(ZZ,<br>    [<br>        [identity_matrix(<span class="hljs-number">3</span>),-diagonal_matrix(A)],<br>        [zero_matrix(<span class="hljs-number">1</span>,<span class="hljs-number">3</span>),matrix(Z)],<br>        [zero_matrix(<span class="hljs-number">3</span>),p*identity_matrix(<span class="hljs-number">3</span>)]<br>    ]<br>)<br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.nrows()):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.ncols()):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">abs</span>(M3L[i][j]).nbits(),end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">0 0 0 0 0 0 </span><br><span class="hljs-string">160 160 160 160 160 160 </span><br><span class="hljs-string">377 376 376 376 376 376 </span><br><span class="hljs-string">373 376 376 373 377 376 </span><br><span class="hljs-string">377 377 374 375 373 373 </span><br><span class="hljs-string">375 374 377 378 377 375 </span><br><span class="hljs-string">375 375 375 374 377 378 </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹ç¬¬ä¸€è¡Œå†…å®¹ï¼Œç»è¿‡æµ‹è¯•æ²¡æœ‰é—®é¢˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#exptest2</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;x=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;x1=<span class="hljs-subst">&#123;M3L[<span class="hljs-number">1</span>][:<span class="hljs-number">3</span>]&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;y=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;y1=<span class="hljs-subst">&#123;M3L[<span class="hljs-number">1</span>][<span class="hljs-number">3</span>:]&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(vector(x)==M3L[<span class="hljs-number">1</span>][:<span class="hljs-number">3</span>] <span class="hljs-keyword">or</span> -vector(x)==M3L[<span class="hljs-number">1</span>][:<span class="hljs-number">3</span>])<br><span class="hljs-built_in">print</span>(vector(y)==M3L[<span class="hljs-number">1</span>][<span class="hljs-number">3</span>:] <span class="hljs-keyword">or</span> -vector(y)==M3L[<span class="hljs-number">1</span>][<span class="hljs-number">3</span>:])<br><span class="hljs-comment">#x=[1059875609154052394049446554149851904167774738381, 898532734274997387994126363047576903953022594169, 1461113197585095174694740018880741222582006584223]</span><br><span class="hljs-comment">#x1=(1059875609154052394049446554149851904167774738381, 898532734274997387994126363047576903953022594169, 1461113197585095174694740018880741222582006584223)</span><br><span class="hljs-comment">#y=[1325343819676712371092085429082944496756103571807, 745378211847616885781181840559736682949015771531, 800128726102435929010952852039360480436507220627]</span><br><span class="hljs-comment">#y1=(1325343819676712371092085429082944496756103571807, 745378211847616885781181840559736682949015771531, 800128726102435929010952852039360480436507220627)</span><br><span class="hljs-comment">#True</span><br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œå¦‚æœä½ æœ‰å¼ºè¿«ç—‡ï¼Œæƒ³è¦æ„é€ æ–¹é˜µï¼Œè®©æœ€çŸ­å‘é‡æˆä¸ºç­”æ¡ˆï¼Œå½“ç„¶æ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥æ„é€ çŸ©é˜µ</p><p><img src="/2024/12/05/LatticeNotes8/6.png" alt="6"></p><p>è¿™è¾¹åªè¾“å‡ºäº†æ¯ä¸ªåˆ†é‡çš„æ¯”ç‰¹æ•°ï¼Œç»è¿‡æµ‹è¯•ï¼Œå¯ä»¥å‘ç°ï¼Œç¬¬ä¸€ä¸ªåˆ†é‡å°±æ˜¯ $(x_1,x_2,x_3,1,y_1,y_2,y_3)$ï¼Œç¬¦åˆæ¡ä»¶ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#exp2-3</span><br>M=block_matrix(ZZ,<br>    [<br>        [identity_matrix(<span class="hljs-number">3</span>),zero_matrix(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),-diagonal_matrix(A)],<br>        [zero_matrix(<span class="hljs-number">1</span>,<span class="hljs-number">3</span>),matrix([<span class="hljs-number">1</span>]),matrix(Z)],<br>        [zero_matrix(<span class="hljs-number">3</span>),zero_matrix(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),p*identity_matrix(<span class="hljs-number">3</span>)]<br>    ]<br>)<br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.nrows()):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.ncols()):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">abs</span>(M3L[i][j]).nbits(),end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-built_in">print</span>(vector(x)==M3L[<span class="hljs-number">0</span>][:<span class="hljs-number">3</span>] <span class="hljs-keyword">or</span> -vector(x)==M3L[<span class="hljs-number">0</span>][:<span class="hljs-number">3</span>])<br><span class="hljs-built_in">print</span>(vector(y)==M3L[<span class="hljs-number">0</span>][-<span class="hljs-number">3</span>:] <span class="hljs-keyword">or</span> -vector(y)==M3L[<span class="hljs-number">0</span>][-<span class="hljs-number">3</span>:])<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">160 160 160 1 160 160 160 </span><br><span class="hljs-string">484 484 483 482 481 484 478 </span><br><span class="hljs-string">481 483 484 483 484 484 483 </span><br><span class="hljs-string">484 483 483 485 484 483 481 </span><br><span class="hljs-string">485 484 484 485 480 481 484 </span><br><span class="hljs-string">484 484 484 484 483 484 485 </span><br><span class="hljs-string">485 483 485 484 484 485 485 </span><br><span class="hljs-string">True</span><br><span class="hljs-string">True</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h4 id="Example-3-ç¬¬ä¸€é¢˜çš„åŠ å¼ºç‰ˆ"><a href="#Example-3-ç¬¬ä¸€é¢˜çš„åŠ å¼ºç‰ˆ" class="headerlink" title="Example 3 ç¬¬ä¸€é¢˜çš„åŠ å¼ºç‰ˆ"></a>Example 3 ç¬¬ä¸€é¢˜çš„åŠ å¼ºç‰ˆ</h4><p>å¦‚æœæˆ‘ä»¬æ”¹ä¸€ä¸‹Example 1ï¼Œå•¥ä¹Ÿæ²¡æœ‰æ”¹ï¼Œå°±æŠŠç¬¬ä¸€è¡Œçš„ $x$ æ¯ä¸ªåˆ†é‡ä» $96$ æ¯”ç‰¹æ”¹æˆ $240$ æ¯”ç‰¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#T3</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>x=[getPrime(<span class="hljs-number">240</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>a=[getrandbits(<span class="hljs-number">1024</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>p=getPrime(<span class="hljs-number">1024</span>)<br>veca=vector(GF(p),a)<br>vecx=vector(GF(p),x)<br>y=veca*vecx<br><span class="hljs-built_in">print</span>(y)<br><span class="hljs-built_in">print</span>(veca)<br></code></pre></td></tr></table></figure><p>ç°åœ¨å¦‚æœæˆ‘ä»¬æ„é€ é‚£ä¸ªä»£ç ï¼Œä¼šæ€æ ·å‘¢ï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#exp1</span><br>M=[<br>    [<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">0</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">1</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">2</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-y],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,p]<br>]<br>M=Matrix(ZZ,M)<br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.nrows()):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.ncols()):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">abs</span>(M3L[i][j]).nbits(),end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">204 204 202 204 203 </span><br><span class="hljs-string">204 202 204 204 203 </span><br><span class="hljs-string">205 203 205 203 198 </span><br><span class="hljs-string">203 206 202 204 201 </span><br><span class="hljs-string">204 201 203 204 205 </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å¥½åƒè§£ä¸å‡ºå•¥ä¸œè¥¿æ¥äº†ï¼æˆ‘ä»¬æœŸå¾…çš„ $(x_1,x_2,x_3,1,0)$ å¯¹åº”çš„æ¯”ç‰¹æ•°åˆ†åˆ«ä¸º $(240,240,240,1,0)$ï¼Œè¿™é‡Œå¾—åˆ°çš„å‘é‡çš„æ¯”ç‰¹æ•°éƒ½æ˜¯ $204$ å·¦å³ã€‚å¦‚æœæˆ‘ä»¬å›é¡¾å®šç†ï¼Œå¯ä»¥å‘ç° $\log_2 \det M&#x3D;\log_2 p&#x3D;1024$ï¼ŒçŸ©é˜µé˜¶æ•°ä¸º $5$ï¼Œå› æ­¤çŸ©é˜µä¸­æœ€çŸ­å‘é‡é•¿åº¦æ˜¯ $1024&#x2F;5&#x3D;205$ æ¯”ç‰¹ï¼Œæœ€åäº‹å®ä¹Ÿç¡®å®å¦‚æ­¤ã€‚æˆ‘ä»¬æœŸå¾…çš„å‘é‡å¹¶ä¸æ˜¯æœ€çŸ­çš„ $5$ ä¸ªå‘é‡ã€‚</p><p>å› ä¸ºè¿™ä¸ªçŸ©é˜µæ˜¯ä¸‰è§’çŸ©é˜µï¼Œå› æ­¤ä»¥å‰æˆ‘çš„æ“ä½œå°±æ˜¯åœ¨æœ€åä¸€åˆ—ä¹˜ä¸Šä¸€ä¸ªå¾ˆå¤§çš„æ•°å­—ï¼ˆå¯ä»¥ç”¨å®šç†ç®—å‡ºæ¥ï¼Œä½†æˆ‘å‡ ä¹æ˜¯ä¹±ä¹˜çš„ï¼‰ï¼Œç„¶åæˆ‘ä»¬æœŸå¾…çš„å‘é‡å°±åˆåœ¨å…¶ä¸­äº†ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™çŸ©é˜µè¡Œåˆ—å¼çš„å€¼è¾¾åˆ°äº† $2^{10000}$ ä»¥ä¸Šï¼Œæœ€çŸ­å‘é‡å¤§å°èŒƒå›´è¢«æ‰©å¤§ï¼Œå› æ­¤æˆ‘ä»¬æœŸå¾…çš„å‘é‡ä¹Ÿå°±å‡ºæ¥äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#exp3</span><br>M=[<br>    [<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">0</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">1</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,a[<span class="hljs-number">2</span>]],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-y],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,p]<br>]<br>C=<span class="hljs-number">2</span>**<span class="hljs-number">9999</span><br>M=Matrix(ZZ,M)*diagonal_matrix(ZZ,[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,C])<br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.nrows()):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.ncols()):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">abs</span>(M3L[i][j]).nbits(),end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">240 240 240 1 0 </span><br><span class="hljs-string">258 260 260 260 0 </span><br><span class="hljs-string">261 261 261 259 0 </span><br><span class="hljs-string">260 259 261 262 0 </span><br><span class="hljs-string">260 259 259 260 10000 </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h4 id="Example-4-ç¬¬äºŒé¢˜çš„åŠ å¼ºç‰ˆ"><a href="#Example-4-ç¬¬äºŒé¢˜çš„åŠ å¼ºç‰ˆ" class="headerlink" title="Example 4 ç¬¬äºŒé¢˜çš„åŠ å¼ºç‰ˆ"></a>Example 4 ç¬¬äºŒé¢˜çš„åŠ å¼ºç‰ˆ</h4><p>åŒç†ï¼Œæˆ‘ä»¬æ”¹ä¸€ä¸‹Example 2ï¼Œ$x$ å’Œ $y$ å¤§å°ä» $2^{160}$ å˜æˆ $2^{450}$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#T4</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p=getPrime(<span class="hljs-number">1024</span>)<br>x=[getPrime(<span class="hljs-number">450</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>y=[getPrime(<span class="hljs-number">450</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>a=[getrandbits(<span class="hljs-number">1024</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>b=[getrandbits(<span class="hljs-number">1024</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>z=[(a[i]*x[i]+b[i]*y[i])%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br><span class="hljs-built_in">print</span>(a)<br><span class="hljs-built_in">print</span>(b)<br><span class="hljs-built_in">print</span>(z)<br><span class="hljs-built_in">print</span>(p)<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å†çœ‹çœ‹ä¼šæ€æ ·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#exp2-3</span><br>A=[a[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>Z=[z[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>M=block_matrix(ZZ,<br>    [<br>        [identity_matrix(<span class="hljs-number">3</span>),zero_matrix(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),-diagonal_matrix(A)],<br>        [zero_matrix(<span class="hljs-number">1</span>,<span class="hljs-number">3</span>),matrix([<span class="hljs-number">1</span>]),matrix(Z)],<br>        [zero_matrix(<span class="hljs-number">3</span>),zero_matrix(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),p*identity_matrix(<span class="hljs-number">3</span>)]<br>    ]<br>)<br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.nrows()):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.ncols()):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">abs</span>(M3L[i][j]).nbits(),end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">439 438 436 438 436 434 438 </span><br><span class="hljs-string">439 438 437 438 436 437 438 </span><br><span class="hljs-string">438 438 438 438 438 434 435 </span><br><span class="hljs-string">438 434 439 435 436 439 437 </span><br><span class="hljs-string">436 438 437 436 438 436 439 </span><br><span class="hljs-string">433 438 439 439 439 437 436 </span><br><span class="hljs-string">438 437 439 439 434 438 438 </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå› ä¸ºçŸ©é˜µå¤§å°ä¸º $7\times7$ï¼Œè¡Œåˆ—å¼å€¼ä¸º $p^3$ï¼Œå› æ­¤æœ€çŸ­å‘é‡é•¿åº¦ä¸º $p^{3&#x2F;7}$ï¼Œå¯¹åº”é•¿åº¦ä¹Ÿå°±æ˜¯ $438$ æ¯”ç‰¹å·¦å³ï¼Œå¯ä»¥çœ‹å‡ºï¼Œæœ€åå¾—åˆ°çš„$7$ ä¸ªå‘é‡é•¿åº¦éƒ½æ˜¯ $438$ æ¯”ç‰¹å·¦å³ã€‚</p><p>ç„¶åä»¥å‰æˆ‘åšåˆ°è¿™è¾¹ï¼Œç›´æ¥å¤§åŠ›å‡ºå¥‡è¿¹ï¼Œè¿˜çœŸåˆ«è¯´ï¼Œæœ€åè§£å‡ºæ¥ï¼Œæœ€åä¸€ä¸ªå‘é‡è¿˜çœŸæ˜¯ç­”æ¡ˆã€‚ã€‚ã€‚</p><p><img src="/2024/12/05/LatticeNotes8/7.png" alt="7"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#exp4</span><br>A=[a[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>Z=[z[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>M=block_matrix(ZZ,<br>    [<br>        [identity_matrix(<span class="hljs-number">3</span>),zero_matrix(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),-diagonal_matrix(A)],<br>        [zero_matrix(<span class="hljs-number">1</span>,<span class="hljs-number">3</span>),matrix([<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">20000</span>]),matrix(Z)],<br>        [zero_matrix(<span class="hljs-number">3</span>),zero_matrix(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),p*identity_matrix(<span class="hljs-number">3</span>)]<br>    ]<br>)<br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.nrows()):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.ncols()):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">abs</span>(M3L[i][j]).nbits(),end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">0 0 511 0 0 0 510 </span><br><span class="hljs-string">508 0 0 0 512 0 0 </span><br><span class="hljs-string">0 512 0 0 0 512 0 </span><br><span class="hljs-string">0 512 0 0 0 512 0 </span><br><span class="hljs-string">513 0 0 0 509 0 0 </span><br><span class="hljs-string">0 0 512 0 0 0 513 </span><br><span class="hljs-string">450 450 450 20001 450 450 450 </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ç„¶åï¼Œå¥½åƒå°±æ²¡å•¥ç„¶åäº†ï¼Œä¼¼ä¹è¿™ä¹ˆåšè¿˜æŒºå¯¹çš„ï¼Œç›´åˆ°æˆ‘é‡åˆ°ã€‚ã€‚ã€‚</p><h4 id="Example-5-å‡ºç°é—®é¢˜"><a href="#Example-5-å‡ºç°é—®é¢˜" class="headerlink" title="Example 5 å‡ºç°é—®é¢˜"></a>Example 5 å‡ºç°é—®é¢˜</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#T5</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p=getPrime(<span class="hljs-number">1024</span>)<br>x=[getPrime(<span class="hljs-number">333</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>y=[getPrime(<span class="hljs-number">633</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>a=[getrandbits(<span class="hljs-number">1024</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>b=[getrandbits(<span class="hljs-number">1024</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>z=[(a[i]*x[i]+b[i]*y[i])%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br><span class="hljs-built_in">print</span>(a)<br><span class="hljs-built_in">print</span>(b)<br><span class="hljs-built_in">print</span>(z)<br><span class="hljs-built_in">print</span>(p)<br></code></pre></td></tr></table></figure><p>ç„¶åï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#exp4</span><br>A=[a[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>Z=[z[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>M=block_matrix(ZZ,<br>    [<br>        [identity_matrix(<span class="hljs-number">3</span>),zero_matrix(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),-diagonal_matrix(A)],<br>        [zero_matrix(<span class="hljs-number">1</span>,<span class="hljs-number">3</span>),matrix([<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">20000</span>]),matrix(Z)],<br>        [zero_matrix(<span class="hljs-number">3</span>),zero_matrix(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),p*identity_matrix(<span class="hljs-number">3</span>)]<br>    ]<br>)<br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.nrows()):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.ncols()):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">abs</span>(M3L[i][j]).nbits(),end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">0 0 511 0 0 0 509 </span><br><span class="hljs-string">510 0 0 0 512 0 0 </span><br><span class="hljs-string">0 511 0 0 0 511 0 </span><br><span class="hljs-string">0 512 0 0 0 512 0 </span><br><span class="hljs-string">512 0 0 0 512 0 0 </span><br><span class="hljs-string">0 0 512 0 0 0 514 </span><br><span class="hljs-string">509 512 511 20001 506 510 512 </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><h2 id="2-è§‚å¯Ÿè§£å‡ºçš„å‘é‡ç‰¹ç‚¹"><a href="#2-è§‚å¯Ÿè§£å‡ºçš„å‘é‡ç‰¹ç‚¹" class="headerlink" title="2.è§‚å¯Ÿè§£å‡ºçš„å‘é‡ç‰¹ç‚¹"></a>2.è§‚å¯Ÿè§£å‡ºçš„å‘é‡ç‰¹ç‚¹</h2><p>è§‚å¯Ÿä¸€ä¸‹å‰é¢LLLç”Ÿæˆçš„æ¯ä¸ªå‘é‡å„ä¸ªåˆ†é‡çš„æ¯”ç‰¹é•¿åº¦ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒExample1,2ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œè§£å‡ºæ¥çš„å‘é‡æ¯ä¸ªåˆ†é‡çš„æ¯”ç‰¹æ•°éƒ½æ¯”è¾ƒè¿‘ä¼¼ã€‚è¿™ç”šè‡³ä¹ŸåŒ…æ‹¬äº†Example 3,4ä¸­è§£å‡ºæ¥çš„éƒ¨åˆ†å‘é‡çš„ç‰¹æ€§ã€‚</p><p>è€Œä¹‹æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨Example 3,4ä¸­ï¼Œé€šè¿‡åŠ å…¥ä¸€ä¸ªè¿œå¤§äºæ¨¡æ•°çš„æ•°å­—ï¼Œæœ€åä¾ç„¶èƒ½å¤Ÿå¾—åˆ°ç­”æ¡ˆï¼Œæ˜¯å› ä¸ºé‚£ä¸ªçŸ©é˜µä¸­æ‰€æœ‰è¡Œå‘é‡ä¸­ï¼Œåªæœ‰é‚£å”¯ä¸€ä¸€ä¸ªè¡Œå‘é‡å¯¹åº”çš„åˆ†é‡ä¸ºé $0$ã€‚æ¯”å¦‚Example 4ä¸­æ„é€ çš„çŸ©é˜µï¼Œ7â€‹ ä¸ªè¡Œå‘é‡ä¸­ï¼Œåªæœ‰ç¬¬ â€‹4â€‹ ä¸ªè¡Œå‘é‡çš„ç¬¬ 4 åˆ†é‡ä¸ºé 0ï¼Œè¿™æ˜¯ä¸€ä¸ªbugçº§åˆ«çš„è®¾ç½®ï¼Œå› ä¸ºå½“é‚£ä¸ªåˆ†é‡å€¼ä¸º $2^{20000}$ åï¼ŒLLLåï¼ŒçŸ©é˜µä¸­ç¬¬ 4 ä¸ªåˆ†é‡å¿…é¡»æ˜¯ $2^{20000}$ çš„å€æ•°ï¼Œä¸”è‡³å°‘æœ‰ä¸€ä¸ªå‘é‡çš„ç¬¬ 4 åˆ†é‡ä¸ä¸º 0ã€‚å› æ­¤ï¼Œæ ¼ä¸­æ»¡è¶³ç¬¬ 4 åˆ†é‡é 0 çš„æœ€çŸ­å‘é‡çš„ç¬¬ 4 åˆ†é‡åªèƒ½ä¸º $2^{20000}$ï¼Œè‡³äºå…¶ä»–çš„åˆ†é‡ï¼Œé‚£ä¹Ÿåªèƒ½è®©å…¶å°½é‡çŸ­äº†ã€‚å› æ­¤æœ€åLLLä¹‹åï¼Œ$2^{20000}$ å°±ä¿å­˜ä¸‹æ¥äº†ã€‚</p><p>å¹¶ä¸”æˆ‘ä»¬ä¹Ÿèƒ½å‘ç°ï¼ŒåŠ å…¥ $2^{20000}$ åï¼ŒåŒ…å« $2^{20000}$ é¡¹çš„é‚£ä¸ªå‘é‡çš„å…¶ä»–å‡ ä¸ªåˆ†é‡é•¿åº¦ä¹Ÿæ¯”è¾ƒæ¥è¿‘ã€‚å¹¶ä¸”æŠ›å¼€å¯¹åº”çŸ©é˜µçš„ç¬¬å››åˆ†é‡ä¸çœ‹ï¼Œå…¶ä»–å‘é‡çš„æ¯”ç‰¹æ•°ä¹Ÿæ¯”è¾ƒæ¥è¿‘ã€‚è€Œä¹‹æ‰€ä»¥ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå¯ä»¥è¿™ä¹ˆæƒ³ï¼š</p><blockquote><p>å·²çŸ¥ä¸¤ä¸ªå‘é‡ $\log_2\vec v_1&#x3D;(500,600,700)$ å’Œ $\log_2 \vec v_2&#x3D;(600,600,600)$ï¼Œå¾ˆæ˜¾ç„¶ï¼Œ$\vec v_1$ çš„é•¿åº¦è¿œè¿œé•¿äº $\vec v_2$ï¼Œå› ä¸ºå‘é‡é•¿åº¦æ˜¯æ‰€æœ‰åˆ†é‡çš„å¹³æ–¹å’Œå¼€æ ¹å·ã€‚è¶Šå¤§çš„æ•°å­—å¹³æ–¹åï¼Œä¼šå˜å¾—æ›´å¤§ï¼Œè€Œæ­¤æ—¶å°æ•°å­—ç›¸å¯¹äºå¤§æ•°å­—å°±å¯ä»¥è¢«å¿½ç•¥äº†ï¼</p></blockquote><p>è¯·æ³¨æ„ï¼Œè¿™ä¸¤ä¸ªå‘é‡å‰é¢åŠ äº† $\log_2$ ç¬¦å·ï¼Œ$(500,600,700)$ å’Œ $(600,600,600)$ éƒ½æ˜¯å–å¯¹æ•°åçš„ç»“æœï¼Œè¿™é‡Œ $700$ ä»£è¡¨çš„æ•°å­—æ¯” $600$ ä»£è¡¨çš„æ•°å­—å¤§ $2^{100}$ å€ï¼é‚£ä¹ˆæœ€åç®—é•¿åº¦ï¼Œ$\vec v_1$ çš„é•¿åº¦å°±æ˜¯ $700$ ä½ï¼Œè€Œ $\vec v_2$ çš„é•¿åº¦å¤§æ¦‚æ˜¯ $601$ ä½ï¼Œè¿™æ ·æ˜ç¡®çš„æ„Ÿè§‰å°±æ¥äº†ï¼æ¢å¥è¯è¯´ï¼ŒLLLæ ¼åŸºå½’çº¦æ—¶ï¼Œå¦‚æœ<strong>é‡åˆ°æŸä¸ªåˆ†é‡è¾ƒå¤§æ—¶</strong>ï¼Œä¼šé€šè¿‡çº¿æ€§è®¡ç®—ï¼Œæ‰©å¤§è¾ƒå°çš„åˆ†é‡ï¼Œæ¥é™ä½è¾ƒå¤§çš„åˆ†é‡çš„å¤§å°ï¼Œ<strong>å› ä¸ºLLLæ˜¯è¦æ±‚æœ€çŸ­å‘é‡ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå‘é‡çš„å¹³æ–¹å’Œå°½é‡çŸ­ï¼Œå› æ­¤ï¼Œæœ€åå¾—åˆ°çš„å‘é‡ï¼Œæ¯ä¸ªåˆ†é‡çš„ç»“æœå°±ä¼šè¶‹è¿‘äºå¹³å‡</strong>ã€‚</p><p>è€ŒExample 5ä¸­å‡ºç°çš„é—®é¢˜ï¼Œå°±æ˜¯ $x$ ä¸º $333$ ä½ï¼Œ$y$ ä¸º $633$ ä½ã€‚ ä¸¤ä¸ªæ•°å­—ä¹‹é—´ä¸å¹³è¡¡æ‰€å¯¼è‡´çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¹˜å…¥ä¸€ä¸ªç³»æ•°çš„æ–¹æ³•ï¼Œå°†è¯¥å‘é‡ä¸­çš„æ¯ä¸€ä¸ªåˆ†é‡å‡‘å¹³è¡¡ã€‚</p><p>ç”±äºæˆ‘ä»¬çš„ç›®æ ‡å‘é‡ä¸º $(x_1,x_2,x_3,1,y_1,y_2,y_3)$ï¼Œæ¯ä¸ªæ•°å­—æ¯”ç‰¹æ•°åˆ†åˆ«ä¸º $(333,333,333,1,633,633,633)$ï¼Œå› æ­¤å¯ä»¥å¯¹æ„é€ çš„åŸçŸ©é˜µçš„å‰ $3$ åˆ—ä¹˜å…¥ä¸€ä¸ª $2^{300}$ï¼Œç¬¬å››åˆ—ä¹˜ä¸€ä¸ª $2^{633}$ï¼Œæœ€åå¾—åˆ°çš„ç›®æ ‡å‘é‡å°±å˜æˆäº†ï¼š<br>$$<br>(2^{300}x_1,2^{300}x_2,2^{300}x_3,2^{633},y_1,y_2,y_3)<br>$$<br>è¿™ä¸ªå‘é‡æ¯ä¸ªåˆ†é‡å‡ä¸º $633$ ä½ï¼ŒåŸçŸ©é˜µä¸º $7$ é˜¶æ–¹é˜µï¼Œæ­¤æ—¶ä¹˜å…¥è¿™ä¸ªå¹³è¡¡ç³»æ•°åï¼ŒçŸ©é˜µçš„è¡Œåˆ—å¼æ»¡è¶³ï¼š<br>$$<br>\log_2 \det M&#x3D;300\times3+633+1024\times3&#x3D;4605<br>$$<br>å› æ­¤ï¼Œæœ€çŸ­å‘é‡çš„é•¿åº¦å¤§æ¦‚ä¸ºï¼š<br>$$<br>\log_2 |\vec v_1|&lt;\frac{4605}{7}&#x3D;657.85<br>$$<br>è€Œæˆ‘ä»¬æ‰€æ±‚çš„å‘é‡ï¼Œæ¯ä¸ªåˆ†é‡å‡ä¸º $633$ ä½ï¼Œå› æ­¤å…¶é•¿åº¦å¤§æ¦‚ä¸º $2^{633}\sqrt7$ï¼Œå¯¹åº”ä½æ•°ä¸º $635$ ä½ä¸åˆ°ï¼Œæ¯” $657.85$ å°ï¼Œå› æ­¤å¯èƒ½ä¸ºæœ€çŸ­å‘é‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#exp5</span><br>A=[a[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>Z=[z[i]*inverse(b[i],p)%p <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>M=block_matrix(ZZ,<br>    [<br>        [identity_matrix(<span class="hljs-number">3</span>),zero_matrix(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),-diagonal_matrix(A)],<br>        [zero_matrix(<span class="hljs-number">1</span>,<span class="hljs-number">3</span>),matrix([<span class="hljs-number">1</span>]),matrix(Z)],<br>        [zero_matrix(<span class="hljs-number">3</span>),zero_matrix(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),p*identity_matrix(<span class="hljs-number">3</span>)]<br>    ]<br>)<br>M=M*diagonal_matrix(ZZ,[<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">300</span>]*<span class="hljs-number">3</span>+[<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">633</span>]+[<span class="hljs-number">1</span>]*<span class="hljs-number">3</span>)<br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.nrows()):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M3L.ncols()):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">abs</span>(M3L[i][j]).nbits(),end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">633 633 633 634 633 633 633 </span><br><span class="hljs-string">657 661 657 658 657 660 658 </span><br><span class="hljs-string">660 659 658 659 661 658 659 </span><br><span class="hljs-string">658 658 662 658 658 657 660 </span><br><span class="hljs-string">656 661 659 661 660 660 662 </span><br><span class="hljs-string">659 660 660 662 661 662 661 </span><br><span class="hljs-string">662 659 658 659 662 658 659 </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€è¡Œå¾ˆæ˜æ˜¾æ˜¯ç­”æ¡ˆï¼ˆå‘ƒï¼Œå› ä¸º $2^{633}$ æ¯”ç‰¹æ•°ä¸º $634$ï¼‰ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥éªŒè¯ä¸€ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">vans=<span class="hljs-built_in">list</span>(M3L[<span class="hljs-number">0</span>])<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">abs</span>(vans[<span class="hljs-number">3</span>])==(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">633</span>)<br>xguess=vans[:<span class="hljs-number">3</span>]<br>yguess=vans[<span class="hljs-number">4</span>:]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    xguess[i]=<span class="hljs-built_in">abs</span>(xguess[i])&gt;&gt;<span class="hljs-number">300</span><br>    yguess[i]=<span class="hljs-built_in">abs</span>(yguess[i])<br><span class="hljs-built_in">print</span>(xguess==x,yguess==y)<br><span class="hljs-comment">#True True</span><br></code></pre></td></tr></table></figure><h2 id="3-ç½‘é¼æ¯2024åŠå†³èµ›-RSAåŠ å¯†åˆ†æ"><a href="#3-ç½‘é¼æ¯2024åŠå†³èµ›-RSAåŠ å¯†åˆ†æ" class="headerlink" title="3. [ç½‘é¼æ¯2024åŠå†³èµ›] RSAåŠ å¯†åˆ†æ"></a>3. [ç½‘é¼æ¯2024åŠå†³èµ›] RSAåŠ å¯†åˆ†æ</h2><p>ä¹‹æ‰€ä»¥å†™è¿™ç¯‡åšå®¢ï¼Œæ˜¯å› ä¸ºå½“æ—¶wdbåŠå†³èµ›çš„æ—¶å€™ï¼Œè‡ªå·±æ²¡è€ƒè™‘å¹³è¡¡å¸¸æ•°ï¼Œç»“æœæ„é€ çš„çŸ©é˜µå·¦ä¸Šè§’ä¸º $1$ï¼Œæ€ä¹ˆè§£ä¹Ÿè§£ä¸å‡ºä¸œè¥¿æ¥ã€‚ã€‚ã€‚</p><p>è¿˜å¥½ï¼Œè¿™ä¸ªé¢˜åªæœ‰ $1$ è§£ï¼Œæœ¬è´¨è¿˜æ˜¯ä¸€ä¸ªå¥—å¨ƒé¢˜ã€‚ä½†CTFåªæœ‰4hï¼Œæœ€ååšèµ·æ¥è¿˜æŒºç¹ççš„ã€‚</p><h3 id="3x01-é¢˜ç›®å¤§æ„"><a href="#3x01-é¢˜ç›®å¤§æ„" class="headerlink" title="3x01 é¢˜ç›®å¤§æ„"></a>3x01 é¢˜ç›®å¤§æ„</h3><p>å…ˆçœ‹çœ‹é¢˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># sagemath</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;&#x27;</span><br><br>k = <span class="hljs-number">3</span><br>d = k/(<span class="hljs-number">2</span>*(k+<span class="hljs-number">1</span>))<br>ns = []<br>pqs = []<br>es = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = getPrime(<span class="hljs-number">512</span>)<br>    <span class="hljs-keyword">if</span> p &lt; q:<br>        tmp = p<br>        p = q<br>        q = tmp<br>    n = p*q<br>    ns.append(n)<br>    pqs.append((p,q))<br><br>n = <span class="hljs-built_in">min</span>(ns)<br>x = random.randint(<span class="hljs-number">0</span>,<span class="hljs-built_in">int</span>(n^(d/<span class="hljs-number">2</span>)))<br>x = next_prime(x)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    p,q = pqs[i][<span class="hljs-number">0</span>],pqs[i][<span class="hljs-number">1</span>]<br>    bound1 = <span class="hljs-built_in">int</span>((p-q)/(<span class="hljs-number">3</span>*(p+q)) * x * n ^ <span class="hljs-number">0.25</span>)<br>    bound2 = <span class="hljs-built_in">int</span>((p-q)/(<span class="hljs-number">3</span>*(p+q)) * x^<span class="hljs-number">2</span> * n ^ <span class="hljs-number">0.25</span>)<br>    z = random.randint(bound1,bound2)<br>    f = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>    e = inverse(x^<span class="hljs-number">2</span>,f) * z % f<br>    es.append(e)<br><br>e = <span class="hljs-number">8462913</span><br>c = <span class="hljs-built_in">pow</span>(bytes_to_long(flag),e,ns[<span class="hljs-number">0</span>])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ns=<span class="hljs-subst">&#123;ns&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;es=<span class="hljs-subst">&#123;es&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c=<span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">ns=[58456238154727772714762362790039415372652580738847549549926175214592421074440425380491278175531057453959583518365006871715668115289674464868754600641087664868445977308497244134179400977293896807231964047365956545629327100737851868274388108150918741474301542596310528990700043925342513137054619092876834352167, 77621328849675766747673031143217563980503830449890233197117569566535170499356584333526498228802079135043121885950830320777642529199704224484173792215691924850086027618183393165197503325417741686635820334799489140360184827244176669486536901652827052817389390205607840551799799037689580359943641014734459153393, 112244920700186260026594736958318991062998987080230137582151100770199379608284829383065111800934933346946496041561749555085922429662611986339400029890877247514987095240380019377389184545006798594193383230298132838994539491402564579629017309643629910561998268286162916487705908044261914142200286678017692930877]</span><br><span class="hljs-string">es=[46762963588977775648213636278524171408894671002158172701955774077187382885695296449518850546775920334764033057745226744111631183010556541467024035131602309988991836959736948179491431343087734419406823467043032520956443072556932946767546576469286010676651317873358203560021064830688914958086524112915123700678, 49605058941818136068558533413619424099600243928109466352604646203354430655695939177245076016870792265350960174089601299549033530643078866868937787258274475767441534991912769995268058506952466739575911255510940326565376471493045685544056383561868628029099619187607579109612157304977780126730283103824111801708, 35433601810279274137096137736120773703247868305827931187532982974242279082633517463016086358856291932337981126992048059591164336008738979183437333221010305682689432537562502148059203087673302900990705589870381203411821061168753251557946997898741497047442934600089950257888693394999451561437497637827070063398]</span><br><span class="hljs-string">c=45042826649205831967869785980034342377048541926664036544108272069702081866501394370318117629151408517708467341069558466115205805860156690204194355692872459196902123082567148537856941845388225814307822482217762135547080677443326657146552580523747535577686386312386011950929734955156100305548239483424574706729</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®é¢˜ç›®æ•°æ®çš„è§„æ¨¡ï¼Œå¤§è‡´å¯ä»¥å¾—åˆ°ï¼š $x$ æ˜¯ $192$ ä½ï¼Œå› æ­¤ $x^2$ æ˜¯ $384$ ä½ã€‚<code>bound1</code> æ˜¯ $192+256&#x3D;448$ ä½ï¼Œ <code>bound2</code> æ˜¯$384+512&#x3D;640$ ä½ï¼Œå› æ­¤ <code>bound1</code> ç›¸å¯¹äº <code>bound2</code> å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚é‚£ä¹ˆï¼Œéšæœºæ•° $z$ å°±æ˜¯ $896$ ä½ã€‚å› æ­¤ç¬¬ä¸€æ­¥å°±æ˜¯æ±‚ $x$ã€‚</p><h3 id="3x02-æ±‚è§£-x"><a href="#3x02-æ±‚è§£-x" class="headerlink" title="3x02 æ±‚è§£ $x$"></a>3x02 æ±‚è§£ $x$</h3><p> é¢˜ç›®ç»™å‡ºçš„å…³ç³»å¼ä¸ºï¼š<br>$$<br>e_i\equiv \frac{z_i}{x^2} \pmod {f_i}<br>$$<br>å…¶ä¸­ï¼Œ$f_i&#x3D;(p_i-1)(q_i-1)$ã€‚</p><p>å› æ­¤ï¼Œå¯¹ä¸Šé¢å¼å­ï¼Œå»åŒä½™åŒ–ç®€ï¼Œå¾—<br>$$<br>e_ix^2-z_i-kf_i&#x3D;0<br>$$<br>ç”±äº $f_i$ ä¸ $n_i$ ä¹‹é—´çš„å…³ç³»ä¸º $f_i&#x3D;n_i-(p_i+q_i)+1$ï¼Œè®¾ $y_i&#x3D;p_i+q_i$ï¼Œé‚£ä¹ˆ $y_i$ çš„æ¯”ç‰¹æ•°ä¸º $513$ã€‚ä¸Šé¢çš„å¼å­å¯ä»¥åŒ–æˆ<br>$$<br>e_ix^2-z_i-kn_i+ky_i-1&#x3D;0<br>$$<br>ç”±äº $e_ix^2-z_i&#x3D;kf_i$ ï¼Œ$e_i,x^2$ åˆ†åˆ«ä¸º $1024$ å’Œ $384$ ä½ï¼Œå› æ­¤ $e_ix^2$ çš„å€¼ï¼ˆä¸å–æ¨¡ï¼‰æ˜¯ $1408$ ä½ï¼Œ$z_i$ æ˜¯ $635$ ä½ï¼Œç›¸å¯¹äº $1408$ ä½å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚å› æ­¤ï¼Œ$kf_i$ ä¹Ÿåº”å½“æ˜¯ $1408$ ä½ï¼Œç”±äº $f$ æ˜¯ $1408$ ä½ï¼Œå› æ­¤ $k$ å’Œ $x^2$ åŒé˜¶ï¼Œä¹Ÿæ˜¯ $384$ ä½ã€‚ä¸” $k$ åœ¨çŸ¥é“ $x$ åæ˜¯å¯æ±‚çš„ï¼Œå…¶å€¼ä¸ºï¼š<br>$$<br>k_i&#x3D;\frac{e_ix^2-z_i}{f_i}&#x3D;1+ \left \lfloor\frac{e_ix^2}{n_i} \right\rfloor<br>$$<br>åŒæ—¶ï¼Œæˆ‘ä»¬çŸ¥é“äº† $y_i$ æ˜¯ $513$ ä½ï¼Œå› æ­¤ $ky_i$ ä¸º $513+384&#x3D;899$ ä½ã€‚ç›¸å¯¹äºæ ¼ä¸­ $1024$ çš„é‡ï¼Œè¿˜æ˜¯æ¯”è¾ƒå°çš„ã€‚æ‰€ä»¥æœ€ç»ˆçš„ç­‰å¼ä¸ºï¼š<br>$$<br>e_ix^2-k(n_i+1)&#x3D;z_i-k_iy_i<br>$$<br>$z_i-ky_i$ çš„ä½æ•°ä¸º $899$ ä½ï¼Œç¬¦åˆé¢„æœŸã€‚æ‰€ä»¥ï¼š</p><p><img src="/2024/12/05/LatticeNotes8/8.png" alt="8"></p><p>ç„¶åå°±GGäº†ï¼Œå¡äº†æˆ‘4hã€‚</p><p>æ­£ç¡®åšæ³•ï¼šå› ä¸º $x$ æ˜¯ $384$ ä½ï¼Œå¸¦ $z_i-ky_i$ çš„é‡æ˜¯ $899$ ä½ï¼Œä¸­é—´å·®äº† $515$ ä½ï¼Œå› æ­¤å¾—å¸¦ä¸ªå¹³è¡¡ç³»æ•° $2^{515}$ã€‚</p><p><img src="/2024/12/05/LatticeNotes8/9.png" alt="9"></p><p>ç„¶åå°±å‡ºäº†ã€‚ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>M=[<br>    [<span class="hljs-number">2</span>**<span class="hljs-number">515</span>,es[<span class="hljs-number">0</span>],es[<span class="hljs-number">1</span>],es[<span class="hljs-number">2</span>]],<br>    [<span class="hljs-number">0</span>,ns[<span class="hljs-number">0</span>],<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,ns[<span class="hljs-number">1</span>],<span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,ns[<span class="hljs-number">2</span>]]<br>]<br>M=Matrix(ZZ,M)<br>M3L=M.LLL()<br>x2=(<span class="hljs-built_in">abs</span>(M3L[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])&gt;&gt;(<span class="hljs-number">515</span>))<br><span class="hljs-keyword">assert</span> x2.is_square()<br>x=x2.nth_root(<span class="hljs-number">2</span>)<br><span class="hljs-keyword">assert</span> isPrime(x)<br><span class="hljs-built_in">print</span>(x)<br><span class="hljs-comment">#1696237025993008832375257492068228509280454088630659960513</span><br></code></pre></td></tr></table></figure><h3 id="3x03-æ±‚-y-çš„å€¼"><a href="#3x03-æ±‚-y-çš„å€¼" class="headerlink" title="3x03 æ±‚ $y$ çš„å€¼"></a>3x03 æ±‚ $y$ çš„å€¼</h3><p>æœ‰äº† $x$ ä¹‹åï¼Œå°±å¯ä»¥æŠŠä¸‰ä¸ª $k$ ä¹Ÿç»™æ±‚å‡ºæ¥ï¼Œä½†æˆ‘ä»¬å®é™…ä¸Šåªéœ€è¦ç¬¬ä¸€ç»„æ•°æ®å°±è¡Œã€‚</p><p>ç›®å‰æˆ‘ä»¬å·²çŸ¥çš„å†…å®¹ä¸º $x,k_1,z_1-k_1y_1$ï¼Œç›®æ ‡æ˜¯æ±‚ $y_1$ã€‚</p><p>æ ¹æ®å‰é¢å·²çŸ¥çš„ç­‰å¼ï¼š<br>$$<br>e_1x^2-z_1-k_1n_1+k_1y_1-1&#x3D;0<br>$$<br>å˜å½¢ä¸€ä¸‹ï¼Œå¯ä»¥æœ‰<br>$$<br>e_1x^2-k_1(n_1+1)-z_1-k_1y_1&#x3D;0<br>$$<br>è¿™ä¸ªå¼å­ä¸­ï¼Œåªæœ‰ $y_1,z_1$ ä¸ºæœªçŸ¥é‡ï¼Œå…¶ä¸­ $z_1$ ä¸º $640$ ä½ï¼Œ $y_1$ ä¸º $513$ ä½ï¼Œå·®å€¼ä¸º $127$ã€‚å¹¶ä¸”è¿˜è¦è€ƒè™‘ å·²çŸ¥é¡¹ $e_1x^2-k_1(n_1+1)$ï¼Œå¯¹åº”å‘é‡åˆ†ç±»ä¸­çš„å¸¸æ•°é¡¹ $1$ã€‚</p><p>å› æ­¤ç»§ç»­æ„é€ ï¼š</p><p><img src="/2024/12/05/LatticeNotes8/11.png" alt="11"></p><p>ç®€å•ç„ä¸€ä¸‹ï¼šå¯¹è§’çº¿å…ƒç´ çº¦ä¸º $127+640&#x3D;767$ ï¼Œè¿™ä¸ªä¸æ˜¯æ–¹é˜µã€‚æ„Ÿè§‰æœ‰ç‚¹ä¸å¤ªå¤Ÿçš„æ ·å­ã€‚</p><p>åœ¨è¿™é‡Œï¼Œå“¨å…µå…ƒç´ ä¸º $2^{640}$ å’Œ $0$ï¼Œå› æ­¤æˆ‘ä»¬LLLä¹‹åï¼Œæ‰¾ç¬¬ä¸‰åˆ†é‡ä¸º $2^{640}$ï¼Œç¬¬å››åˆ†é‡ä¸º $0$ çš„å…ƒç´ ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">k=<span class="hljs-number">1</span>+(((es[<span class="hljs-number">0</span>])*x)//ns[<span class="hljs-number">0</span>])<br>zky=M3L[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]<br>G=[<br>    [<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">127</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-k],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">640</span>,es[<span class="hljs-number">0</span>]*x**<span class="hljs-number">2</span>-k*(ns[<span class="hljs-number">0</span>]+<span class="hljs-number">1</span>)]<br>]<br>G=matrix(ZZ,G)<br>G=G<span class="hljs-comment">#*diagonal_matrix(ZZ,[1,1,1,2**2000])</span><br>G3L=G.LLL()<br>vans=<span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> G3L:<br>    <span class="hljs-keyword">if</span>(v[<span class="hljs-number">2</span>]==<span class="hljs-number">2</span>**<span class="hljs-number">640</span> <span class="hljs-keyword">and</span> v[<span class="hljs-number">3</span>]==<span class="hljs-number">0</span>):<br>        vans=v<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(vans)<br></code></pre></td></tr></table></figure><p>ç»“æœæ²¡æ‰¾åˆ°ï¼Œç„¶åè¾“å‡º <code>G3L</code> çš„ç»“æœçœ‹ä¸€çœ¼ï¼Œå‘ç°ä¸€ä¸ªå‘é‡æ»¡è¶³ç¬¬ä¸‰åˆ†é‡æ˜¯ $2^{640}$ï¼Œå¦ä¸€ä¸ªå‘é‡æ»¡è¶³ç¬¬å››åˆ†é‡æ˜¯ $0$ã€‚</p><p>çœ‹æ¥æ˜¯ç•Œä¸å¤ªå¤Ÿäº†ï¼Œé‚£å°±å†æ¥ä¸€æ³¢å¤§åŠ›å‡ºå¥‡è¿¹ã€‚</p><p><img src="/2024/12/05/LatticeNotes8/12.png" alt="12"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">k=<span class="hljs-number">1</span>+(((es[<span class="hljs-number">0</span>])*x*x)//ns[<span class="hljs-number">0</span>])<br>zky=M3L[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]<br>G=[<br>    [<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">127</span>,<span class="hljs-number">20</span>,<span class="hljs-number">0</span>,-k],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">640</span>,es[<span class="hljs-number">0</span>]*(x**<span class="hljs-number">2</span>)-k*(ns[<span class="hljs-number">0</span>]+<span class="hljs-number">1</span>)]<br>]<br>G=matrix(ZZ,G)<br>G=G*diagonal_matrix(ZZ,[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">20000</span>])<br><span class="hljs-comment">#print(G)</span><br>G3L=G.LLL()<br>vans=<span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> G3L:<br>    <span class="hljs-keyword">if</span>(v[<span class="hljs-number">2</span>]==<span class="hljs-number">2</span>**<span class="hljs-number">640</span> <span class="hljs-keyword">and</span> v[<span class="hljs-number">3</span>]==<span class="hljs-number">0</span>):<br>        vans=v<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(vans)<br>y=<span class="hljs-built_in">abs</span>(vans[<span class="hljs-number">0</span>])&gt;&gt;<span class="hljs-number">127</span><br>z=vans[<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(y.nbits(),z.nbits())<br><span class="hljs-comment">#(-2601742433829735205717510958984597054031885650700522469656590841975973352498358057919092577419846355269586088827959437508632269659680389249804349835135992919707882192966293703794747575323590656, -191810479825992932776976119516271570787555880246177445289447710773949638278444955289971892948555085597643726446747043, 4562440617622195218641171605700291324893228507248559930579192517899275167208677386505912811317371399778642309573594407310688704721375437998252661319722214188251994674360264950082874192246603776, 0)</span><br><span class="hljs-comment">#513 387</span><br></code></pre></td></tr></table></figure><p>$y$ å¯¹åº”çš„å€¼æ˜¯ $513$ ä½ï¼Œè²Œä¼¼æ˜¯æ­£ç¡®çš„ï¼Œä½† $z$ ä¸å¯¹ã€‚ä½†æˆ‘ä»¬å¹¶ä¸éœ€è¦é‚£ä¸ª $z$ã€‚ä½†è¾“å‡º $y$ çœ‹ä¸€ä¸‹ï¼Œå‘ç° $y$ æ˜¯ä¸ªå¥‡æ•°ã€‚ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(y)<br><span class="hljs-comment">#15291667666307414493036951046107275741397940767822287922559621898054774057554431022160493431539991508171319851807097492122079767748903000613100351624105777</span><br></code></pre></td></tr></table></figure><p>è¯´æ˜ $y$ å¯èƒ½æ˜¯ $p_1+q_1$ çš„é«˜ä½ã€‚ç”±äºåé¢åªæ¶‰åŠç¬¬ä¸€ç»„æ•°æ®äº†ï¼Œå› æ­¤ï¼Œä¸‹æ ‡ $1,2,3$ å°†å†ä¸‹ä¸€å°èŠ‚è¢«çœç•¥ã€‚</p><h3 id="3x04-æ±‚-p-å€¼"><a href="#3x04-æ±‚-p-å€¼" class="headerlink" title="3x04 æ±‚ $p$ å€¼"></a>3x04 æ±‚ $p$ å€¼</h3><p>ç”¨é¢˜ç›®ä»£ç ç”Ÿæˆå…¶ä»–å‡ ç»„æ•°æ®æµ‹ä¸€ä¸‹ï¼Œ$y$ ç¡®å®ä¸º $p+q$ é«˜ä½ï¼Œæœ€ä½ $254$ ä½æœ‰åå·®ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çŸ¥é“äº† $p+q$ ä½æ•°çš„ä¸€åŠã€‚é‚£ä¹ˆæ„å»ºæ–¹ç¨‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">58456238154727772714762362790039415372652580738847549549926175214592421074440425380491278175531057453959583518365006871715668115289674464868754600641087664868445977308497244134179400977293896807231964047365956545629327100737851868274388108150918741474301542596310528990700043925342513137054619092876834352167</span><br>y=<span class="hljs-number">15291667666307414493036951046107275741397940767822287922559621898054774057554431022160493431539991508171319851807097492122079767748903000613100351624105777</span><br>R.&lt;x&gt; = PolynomialRing(RealField(<span class="hljs-number">2048</span>))<br>f = x * ((y) - x) - n<br>res = f.roots()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">longdouble2int</span>(<span class="hljs-params">x</span>):<br>    x=<span class="hljs-built_in">str</span>(x)<br>    x=x.split(<span class="hljs-string">&#x27;.&#x27;</span>)<br>    x[<span class="hljs-number">1</span>]=x[<span class="hljs-number">1</span>].split(<span class="hljs-string">&#x27;e&#x27;</span>)<br>    <span class="hljs-keyword">return</span> Integer(x[<span class="hljs-number">0</span>]+x[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>][:<span class="hljs-built_in">int</span>(x[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>])])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res:<br>    <span class="hljs-built_in">print</span>(longdouble2int(i[<span class="hljs-number">0</span>]))<br><span class="hljs-comment">#7595466686419558151205913432118661460574378336265188601308332178368424478703277500529523587366925897212947299535668041397861697290034233117986300118079322</span><br><span class="hljs-comment">#7696200979887856341831037613988614280823562431557099321251289719686349578851153521630969844173065610958372552271429450724218070458868767495114051506026454</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°äº† $p$ çš„é«˜ä½å’Œ $q$ çš„é«˜ä½ï¼Œè¿™ä¸ªå€¼å¤§æ¦‚æœ‰ä¸€åŠæ˜¯ç²¾ç¡®çš„ã€‚å°è¯•çˆ†ç ´ $12$ ä½ï¼Œåº”è¯¥èƒ½å‡ºè§£ï¼Œå¤§æ¦‚è€—æ—¶ä¸ºä¸€å°æ—¶å·¦å³ï¼ˆåˆšå¥½å‰å‡ å¤©æäº†ä¸ª58ä¸€å¹´çš„2h2gçš„æœåŠ¡å™¨ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">ph=<span class="hljs-number">7696200979887856341831037613988614280823562431557099321251289719686349578851153521630969844173065610958372552271429450724218070458868767495114051506026454</span><br>n=<span class="hljs-number">58456238154727772714762362790039415372652580738847549549926175214592421074440425380491278175531057453959583518365006871715668115289674464868754600641087664868445977308497244134179400977293896807231964047365956545629327100737851868274388108150918741474301542596310528990700043925342513137054619092876834352167</span><br><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">p4</span>):<br>    pbits = <span class="hljs-number">512</span><br>    kbits = pbits - p4.nbits()<br>    p4 = p4 &lt;&lt; kbits<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    f = x + p4<br>    roots = f.small_roots(X=<span class="hljs-number">2</span>**kbits, beta=<span class="hljs-number">0.42</span>,epsilon=<span class="hljs-number">0.012</span>)<br>    <span class="hljs-keyword">if</span> roots:        <br>        p = p4 + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])<br>        q = n//p<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(<span class="hljs-string">f&#x27;p: <span class="hljs-subst">&#123;p&#125;</span>\n&#x27;</span>)<br>            f.write(<span class="hljs-string">f&#x27;q: <span class="hljs-subst">&#123;q&#125;</span>\n&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>ph=ph&gt;&gt;<span class="hljs-number">256</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve1</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">11</span>)):<br>        <span class="hljs-keyword">if</span>(solve((ph&lt;&lt;<span class="hljs-number">12</span>)|i)):<br>            <span class="hljs-keyword">return</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve2</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">11</span>,<span class="hljs-number">2</span>**<span class="hljs-number">12</span>)):<br>        <span class="hljs-keyword">if</span>(solve((ph&lt;&lt;<span class="hljs-number">12</span>)|i)):<br>            <span class="hljs-keyword">return</span><br><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Process, current_process<br>PROC=[]<br>PROC.append(Process(target=solve1))<br>PROC.append(Process(target=solve2))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>    PROC[i].start()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>    PROC[i].join()<br></code></pre></td></tr></table></figure><p>ç„¶åè·‘äº†20åˆ†é’Ÿåï¼Œå‘ç°æœåŠ¡å™¨è´Ÿè½½çªç„¶é™åˆ°äº†50%ï¼Œçœ‹æ¥æ˜¯ä¸€ä¸ªè¿›ç¨‹å‡ºäº†ç»“æœï¼Œæ‰“å¼€result.txtæŸ¥çœ‹ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">p: <span class="hljs-number">7696200979887856341831037613988614280823562431557099321251289719686349578851157595313091133333376255237947592610103860940743200558583228583143108125315529</span><br>q: <span class="hljs-number">7595466686419558151205913432118661460574378336265188601308332178368424478703273480167149453312906478797521330243646557948961908036589158891684701262055023</span><br></code></pre></td></tr></table></figure><h3 id="3x05-æ±‚æœ€ç»ˆflag"><a href="#3x05-æ±‚æœ€ç»ˆflag" class="headerlink" title="3x05 æ±‚æœ€ç»ˆflag"></a>3x05 æ±‚æœ€ç»ˆflag</h3><p>å‘ç° $e&#x3D;8462913$ï¼Œä¸æ˜¯é»˜è®¤çš„ $65537$ æˆ– <code>getPrime</code> å¾—åˆ°çš„æ•°å­—ï¼Œçœ‹æ¥å¤§äº‹ä¸å¦™ï¼Œæœç„¶ï¼Œæœ‰ $e&#x3D;3 \times 2820971$ã€‚ç„¶åå‘ç°ï¼š$p-1,q-1$ éƒ½æ˜¯ $3$ çš„å€æ•°ï¼Œè¿˜å¾—æŠŠ AMMç®—æ³•è°ƒå‡ºæ¥ã€‚</p><p>å¾—åˆ°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">cbrtcp=&#123;<span class="hljs-number">5457734212209914607812625325490750749661326921613441346478932389873269831927640313433909213645212354490723810811111424420872595194416663018676652425769843</span>, <span class="hljs-number">2078396872589066084890946019870420517722364119774927920595224513472857788525543374144267568390931958280362619350258000147602830214465571608914879090611743</span>, <span class="hljs-number">160069895088875649127466268627443013439871390168730054177132816340221958397973907734914351297231942466861162448734436372267775149700993955551576608933943</span>&#125;<br>cbrtcq=&#123;<span class="hljs-number">2673359237708120727862398760587900169638391052868557052175750873601678618266229531730282702839716628363656139382035102683850049531165943543150164597396242</span>, <span class="hljs-number">4480948863344673380560358841432740594822756100315860318495558241131293070924509985646332250166426369654468055542550092440114644741178753450051611037785301</span>, <span class="hljs-number">441158585366764042783155830098020696113231183080771230637023063635452789512533962790534500306763480779397135319061362824997213764244461898482925626873480</span>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœå‘ç°ï¼Œ$p-1$ ç«Ÿç„¶ä¹Ÿæ˜¯ $2820971$ çš„å€æ•°</p><p>å› ä¸º512æ¯”ç‰¹å¯¹åº”64å­—èŠ‚ï¼Œå› æ­¤å¯ä»¥å°è¯•ç›²çŒœflagæ²¡æœ‰64å­—èŠ‚ã€‚ã€‚ã€‚ç„¶åå°±å‡ºäº† ã€‚ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>n=p*q<br>e=<span class="hljs-number">2820971</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cbrtcq:<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(i,inverse(e,q-<span class="hljs-number">1</span>),q)))<br><span class="hljs-comment">#flag&#123;N3w_Attacks_4_key_equat1ons&#125;</span><br></code></pre></td></tr></table></figure><blockquote><p>é‚£å¦‚æœflagè¶…è¿‡äº†64å­—èŠ‚å‘¢ï¼Ÿ</p><p>ç”¨AMMç®—æ³•ï¼Œå¯¹ $p$ å†å¼€æ ¹ $2820971$ æ¬¡æ ¹ï¼Œå¾—åˆ°ä¸€ä¸ªç‰¹è§£ $x^*$ã€‚ç„¶åå†æ±‚ $x^{2820971}\equiv 1\pmod p$ çš„ $2820971$ æ¬¡æ ¹ï¼Œèƒ½å¾—åˆ° $2820971$ ä¸ªæ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼ˆè¿™ä¸ªå¾ˆç®€å•ï¼Œç”¨ç¾¤è®ºçš„çŸ¥è¯†å°±å¯ä»¥è§£å†³ï¼‰ã€‚ç„¶åå†CRTã€‚è€—æ—¶çº¦ä¸º $3^2\times2820971$ï¼Œä¹Ÿå°±æ˜¯ $2538$ ä¸‡æ¬¡CRTã€‚ã€‚ã€‚</p></blockquote><h2 id="4-å…³äºsmall-roots-çš„è°ƒå‚"><a href="#4-å…³äºsmall-roots-çš„è°ƒå‚" class="headerlink" title="4. å…³äºsmall_roots çš„è°ƒå‚"></a>4. å…³äºsmall_roots çš„è°ƒå‚</h2><p>è‡ªå·±æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå®éªŒç¯å¢ƒä¸º Sagemath 10.4ã€‚</p><p><code>f.small_roots</code> æœ‰ä¸‰ä¸ªå‚æ•°ï¼š <code>X,beta,epsilon</code>ï¼Œåˆ†åˆ«ä»£è¡¨ç»“æœçš„ä¸Šç•Œã€æ¨¡æ•°å› å­çš„ä¸‹ç•Œå’Œæ±‚è§£æ­¥é•¿ã€‚å…¶ä¸­ï¼Œ $X$ è¶Šå¤§ã€ $\beta$ è¶Šå¤§ã€$\epsilon$ è¶Šå°ï¼Œå¾—åˆ°ç»“æœçš„æ¦‚ç‡è¶Šé«˜ï¼Œä½†è€—æ—¶ä¹Ÿè¶Šé•¿ã€‚ã€‚ã€‚</p><p>åœ¨2h2gçš„äº‘æœåŠ¡å™¨ä¸Šè·‘çš„ã€‚å¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š</p><h3 id="4x01-beta-0-4çš„å®éªŒç»“æœ"><a href="#4x01-beta-0-4çš„å®éªŒç»“æœ" class="headerlink" title="4x01 beta&#x3D;0.4çš„å®éªŒç»“æœ"></a>4x01 beta&#x3D;0.4çš„å®éªŒç»“æœ</h3><table><thead><tr><th>unknownbit</th><th>240</th><th>241</th><th>242</th><th>243</th><th>244</th><th>245</th><th>246</th><th>247</th><th>248</th><th>249</th><th align="left">250</th></tr></thead><tbody><tr><td>$\beta$</td><td>0.4</td><td>0.4</td><td>0.4</td><td>0.4</td><td>0.4</td><td>0.4</td><td>0.4</td><td>0.4</td><td>0.4</td><td>0.4</td><td align="left">0.4</td></tr><tr><td>$1000\epsilon$</td><td>22</td><td>20</td><td>18</td><td>17</td><td>16</td><td>14</td><td>12</td><td>11</td><td>10</td><td>8</td><td align="left">7</td></tr><tr><td>timecost(s)</td><td>0.09</td><td>0.15</td><td>0.19</td><td>0.23</td><td>0.34</td><td>0.53</td><td>1.08</td><td>1.53</td><td>2.81</td><td>9.6</td><td align="left">13.6</td></tr></tbody></table><h3 id="4x02-beta-0-495-çš„å®éªŒç»“æœ"><a href="#4x02-beta-0-495-çš„å®éªŒç»“æœ" class="headerlink" title="4x02 beta&#x3D;0.495 çš„å®éªŒç»“æœ"></a>4x02 beta&#x3D;0.495 çš„å®éªŒç»“æœ</h3><table><thead><tr><th>unknownbit</th><th>248</th><th>249</th><th>250</th><th>251</th><th>252</th><th>253</th></tr></thead><tbody><tr><td>$\beta$</td><td>0.495</td><td>0.495</td><td>0.495</td><td>0.495</td><td>0.495</td><td>0.495</td></tr><tr><td>$1000\epsilon$</td><td>13</td><td>12</td><td>10</td><td>$9\sim8$</td><td>$7.5\sim6$</td><td>$5.5\sim5$</td></tr><tr><td>timecost(s)</td><td>3.71</td><td>6.42</td><td>16.9</td><td>$32\sim60$</td><td>$76\sim308$</td><td>$544\sim1400$</td></tr></tbody></table><h3 id="4x03-beta-0-498-çš„å®éªŒç»“æœ"><a href="#4x03-beta-0-498-çš„å®éªŒç»“æœ" class="headerlink" title="4x03 beta&#x3D;0.498+ çš„å®éªŒç»“æœ"></a>4x03 beta&#x3D;0.498+ çš„å®éªŒç»“æœ</h3><table><thead><tr><th>unknownbit</th><th>252</th><th>253</th><th>254</th><th>255</th></tr></thead><tbody><tr><td>$\beta$</td><td>0.498</td><td>0.498</td><td>0.499</td><td>0.499</td></tr><tr><td>$1000\epsilon$</td><td>$7.5\sim6.5$</td><td>$5.5\sim4.5$</td><td>$3.5\sim3$</td><td>ä¸å¯åš</td></tr><tr><td>timecost(s)</td><td>$92\sim238$</td><td>$600\sim2200$</td><td>$26877\sim63702$</td><td>ä¸å¯åš</td></tr></tbody></table><blockquote><p>254åœ¨æœåŠ¡å™¨ä¸Šè·‘äº†ä¸€å¤©ï¼Œåªè·‘å‡ºæ¥äº†ä¸¤ç»„æ•°æ®ï¼Œä¸€ç»„ $3.5$ çš„ $26877$ ç§’ï¼Œä¸€ä¸ª $3$ çš„ $63702$ ç§’ã€‚ç›´æ¥æŠŠæˆ‘æœåŠ¡å™¨CPUçº¢æ¸©äº†ä¸€æ•´å¤©ã€‚</p></blockquote><p>å‰ä¸‰ä¸ªçš„æµ‹è¯•ä»£ç ï¼ˆåªä¿®æ”¹for ubï¼Œfor betak å’Œfor epsk ä¸­çš„å†…å®¹ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Sample</span>(<span class="hljs-params">ubits</span>):<br>    p=getPrime(<span class="hljs-number">512</span>)<br>    q=getPrime(<span class="hljs-number">512</span>)<br>    n=p*q<br>    <span class="hljs-keyword">return</span> n,p&gt;&gt;ubits<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">p4,n</span>):<br>    pbits = <span class="hljs-number">512</span><br>    kbits = pbits - p4.nbits()<br>    p4 = p4 &lt;&lt; kbits<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    f = x + p4<br>    <span class="hljs-keyword">for</span> betak <span class="hljs-keyword">in</span> [<span class="hljs-number">0.499</span>]:<br>        <span class="hljs-keyword">for</span> epsk <span class="hljs-keyword">in</span>[<span class="hljs-number">0.0045</span>,<span class="hljs-number">0.004</span>,<span class="hljs-number">0.0035</span>,<span class="hljs-number">0.003</span>,<span class="hljs-number">0.0025</span>,<span class="hljs-number">0.002</span>,<span class="hljs-number">0.0015</span>]:<br>            <span class="hljs-built_in">print</span>(epsk)<br>            stime=datetime.now()<br>            roots = f.small_roots(X=<span class="hljs-number">2</span>**kbits, beta=betak,epsilon=epsk)<br>            <span class="hljs-keyword">if</span> roots:        <br>                p = p4 + <span class="hljs-built_in">int</span>(roots[<span class="hljs-number">0</span>])<br>                q = n//p<br>                <span class="hljs-keyword">assert</span> p!=n <span class="hljs-keyword">and</span> q!=n <span class="hljs-keyword">and</span> p!=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> q!=<span class="hljs-number">1</span><br>                ttime=datetime.now()<br>                <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result0499-254255&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                    f.write(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;kbits&#125;</span>,&#x27;</span>+<span class="hljs-string">&#x27;&#123;:.4f&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(betak)+<span class="hljs-string">&#x27;,&#x27;</span>+<span class="hljs-string">&#x27;&#123;:.4f&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(epsk)+<span class="hljs-string">&#x27;,&#x27;</span>+<span class="hljs-built_in">str</span>((ttime-stime).total_seconds())+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">for</span> ub <span class="hljs-keyword">in</span> [<span class="hljs-number">254</span>,<span class="hljs-number">255</span>]:<br>    <span class="hljs-built_in">print</span>(datetime.now())<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        n,ph=Sample(ub)<br>        n,ph=Integer(n),Integer(ph)<br>        <span class="hljs-built_in">print</span>(datetime.now())<br>        <span class="hljs-built_in">print</span>(solve(ph,n))<br></code></pre></td></tr></table></figure><h3 id="4x04-flatter"><a href="#4x04-flatter" class="headerlink" title="4x04 flatter"></a>4x04 flatter</h3><p>æ ¹æ®<a href="https://blog.csdn.net/qwerzbc66?type=blog">striving</a> âœŒçš„æç¤ºï¼Œå¯ä»¥å®‰è£…<a href="https://github.com/keeganryan/flatter">flatter</a>åæ±‚è§£ä¼¼ä¹æ›´å¿«ã€‚</p><table><thead><tr><th>unknownbit</th><th>253</th><th>254</th><th>255</th></tr></thead><tbody><tr><td>$\beta$</td><td>0.499</td><td>0.499</td><td>0.499</td></tr><tr><td>$1000\epsilon$</td><td>5</td><td>$3.5\sim3$ ï¼ˆä¸ä¿è¯ï¼‰</td><td>ä¸å¯åš</td></tr><tr><td>timecost(s)</td><td>$75\sim120$</td><td>$400\sim820$</td><td>ä¸å¯åš</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> subprocess <span class="hljs-keyword">import</span> check_output<br><span class="hljs-keyword">from</span> re <span class="hljs-keyword">import</span> findall<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flatter</span>(<span class="hljs-params">M</span>):  <span class="hljs-comment"># flatter</span><br>    z = <span class="hljs-string">&quot;[[&quot;</span> + <span class="hljs-string">&quot;]\n[&quot;</span>.join(<span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, row)) <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> M) + <span class="hljs-string">&quot;]]&quot;</span><br>    ret = check_output([<span class="hljs-string">&quot;flatter&quot;</span>], <span class="hljs-built_in">input</span>=z.encode())<br>    <span class="hljs-keyword">return</span> matrix(M.nrows(), M.ncols(), <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, findall(<span class="hljs-string">b&quot;-?\\d+&quot;</span>, ret)))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_overview</span>(<span class="hljs-params">BB</span>):  <span class="hljs-comment"># see the shape of matrix</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        a = (<span class="hljs-string">&#x27;%02d &#x27;</span> % ii)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">1</span>]):<br>            a += <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">if</span> BB[ii, jj] == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;X&#x27;</span><br>            <span class="hljs-keyword">if</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">60</span>:<br>                a += <span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Small_Roots_Univariate</span>(<span class="hljs-params">f, X=<span class="hljs-literal">None</span>, beta=<span class="hljs-number">1.0</span>, epsilon=<span class="hljs-literal">None</span></span>):  <span class="hljs-comment"># å¤šé¡¹å¼f,X,beta,epsilon</span><br><br>    delta = f.degree()  <span class="hljs-comment"># åº¦delta</span><br>    N = f.parent().characteristic()  <span class="hljs-comment"># æ¨¡æ•°N</span><br>    PR = PolynomialRing(ZZ, <span class="hljs-string">&#x27;x&#x27;</span>)<br>    x = PR.gen()<br><br>    Zm = f.base_ring()  <span class="hljs-comment"># Zmod(N)</span><br>    f = f.change_ring(ZZ)  <span class="hljs-comment"># ZZä¸‹f(x)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> f.is_monic():  <span class="hljs-comment"># é¦–ä¸€</span><br>        f = f.monic()  <span class="hljs-comment"># f = f * f[delta].inverse_mod(N)</span><br><br>    m = ceil(<span class="hljs-built_in">max</span>(beta * beta / (delta * epsilon), <span class="hljs-number">7</span> * beta / delta))  <span class="hljs-comment"># m</span><br>    t = floor(delta * m * (<span class="hljs-number">1</span> / beta - <span class="hljs-number">1</span>))  <span class="hljs-comment"># t</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;m=&#123;&#125;, t=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(m, t))<br><br>    f_ij = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(delta):<br>            f_ij.append(x ** j * N ** (m - i) * f ** i)  <span class="hljs-comment"># shift g_ij(x)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>        f_ij.append(x ** i * f ** m)  <span class="hljs-comment"># shift h_i(x)</span><br><br>    monomials = []<br>    <span class="hljs-keyword">for</span> g <span class="hljs-keyword">in</span> f_ij:<br>        monomials += g.monomials()  <span class="hljs-comment"># ç»Ÿè®¡æ‰€æœ‰å‡ºç°çš„å•é¡¹ x^i</span><br>    monomials = <span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">set</span>(monomials))  <span class="hljs-comment"># å»é‡å¹¶æ’åº</span><br><br>    M = Matrix(ZZ, <span class="hljs-built_in">len</span>(f_ij), <span class="hljs-built_in">len</span>(monomials))  <span class="hljs-comment"># è¡Œæ•°ä¸ºå¤šé¡¹å¼ä¸ªæ•°ï¼Œåˆ—æ•°ä¸ºæ‰€æœ‰å•é¡¹å¯èƒ½ä¸ªæ•°</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M.nrows()):<br>        <span class="hljs-keyword">for</span> j, monomial <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(monomials):<br>            M[i, j] = f_ij[i].monomial_coefficient(monomial) * monomial.subs(x=X)  <span class="hljs-comment"># g_ij(xX)å’Œh_i(xX)</span><br>    matrix_overview(M)  <span class="hljs-comment"># see</span><br>    <span class="hljs-keyword">assert</span> M.nrows() == M.ncols()  <span class="hljs-comment"># æ–¹é˜µ nrows()=ncols()</span><br>    B = flatter(M)  <span class="hljs-comment"># flateråŠ é€Ÿ</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;end LLL&#x27;</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M.nrows()):  <span class="hljs-comment"># å¾—åˆ°f(xX)ï¼Œæ„å»ºf(x)ï¼Œæ±‚æ ¹æ£€éªŒ</span><br>        Cx = <span class="hljs-built_in">sum</span>(ZZ(B[j, i] // monomials[i](X)) * monomials[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M.ncols()))  <span class="hljs-comment"># construct polynomial,</span><br>        R = Cx.roots()  <span class="hljs-comment"># get roots</span><br>        roots = [Zm(r[<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> R <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(r[<span class="hljs-number">0</span>]) &lt;= X]  <span class="hljs-comment"># check x0&lt;=X</span><br>        roots = [r <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> roots <span class="hljs-keyword">if</span> gcd(N, ZZ(f(r))) &gt;= ZZ(floor(N ** beta))]  <span class="hljs-comment"># check gcd(f(x_0),N)&gt;N^beta</span><br>        <span class="hljs-keyword">if</span> roots:<br>            <span class="hljs-keyword">return</span> roots  <span class="hljs-comment"># è¿”å›root</span><br><br>N = <span class="hljs-number">135500646574582511239845764710311769260801998982429500680171919823431178899526463566215834234383331374445093363969218810906991784569340270510936759183504496584225937614940086329775325893307453919055830270986601152002191368431527285285313669979358099782497422114870417519470053198217401297960844455029559146309</span><br>h = <span class="hljs-number">918578024558168836638919636090777586135497638818209533615420650282292168631485</span><br>PR = PolynomialRing(Zmod(N), <span class="hljs-string">&#x27;x&#x27;</span>)<br>x = PR.gen()<br>f = (h &lt;&lt; <span class="hljs-number">253</span>) + x<br>roots = Small_Roots_Univariate(f, <span class="hljs-number">2</span> ** <span class="hljs-number">253</span>, <span class="hljs-number">0.499</span>, <span class="hljs-number">0.005</span>)<br><span class="hljs-built_in">print</span>(roots)<br></code></pre></td></tr></table></figure><blockquote><p>æ€»ä¹‹ï¼Œ$254$ åŸºæœ¬ä¸å¯åšï¼Œ$255$ å®Œå…¨ä¸å¯åšï¼Œä¸å¦‚ç”¨flatterçˆ†ç ´å‡ ä½ï¼Œç”¨ $253$ åšæ•ˆç‡é«˜</p></blockquote><h2 id="5-å¼ºç½‘æ¯2024å†³èµ›-Signin-å‡æ‰MSBå¹³è¡¡æ³•-Update-12-8"><a href="#5-å¼ºç½‘æ¯2024å†³èµ›-Signin-å‡æ‰MSBå¹³è¡¡æ³•-Update-12-8" class="headerlink" title="5.[å¼ºç½‘æ¯2024å†³èµ›] Signin:å‡æ‰MSBå¹³è¡¡æ³•[Update 12.8]"></a>5.[å¼ºç½‘æ¯2024å†³èµ›] Signin:å‡æ‰MSBå¹³è¡¡æ³•[Update 12.8]</h2><p>12 æœˆ 6 æ—¥æ‹¿åˆ°äº†å¼ºç½‘æ¯å†³èµ›çš„é¢˜ç›®ï¼Œçœ‹åˆ°ä¸€ä¸ªSigninæ„Ÿè§‰æœ‰ç‚¹æ„æ€ï¼Œæ‰“ç®—çœ‹çœ‹ã€‚</p><p>æåˆ°é¢˜ä¹‹åï¼Œ 15 åˆ†é’Ÿå‡ºæ€è·¯ï¼Œè°ƒå¹³è¡¡å‚æ•°åˆç”¨äº†ä¸€å¤©ã€‚ã€‚ã€‚</p><h3 id="5x01-é¢˜ç›®å¤§æ„"><a href="#5x01-é¢˜ç›®å¤§æ„" class="headerlink" title="5x01 é¢˜ç›®å¤§æ„"></a>5x01 é¢˜ç›®å¤§æ„</h3><p>å…ˆçœ‹çœ‹é¢˜ç›®ï¼ˆå› ä¸ºæœ¬åœ°å¤ç°ï¼Œæ•…ç•¥æœ‰ä¿®æ”¹ï¼Œä¸æ”¹å˜åŸé¢˜é¢˜æ„ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿debugï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse, bytes_to_long<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-comment">#from secret import flag</span><br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> signal<br><br>p = <span class="hljs-number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</span><br>a = <span class="hljs-number">0</span><br>b = <span class="hljs-number">7</span><br>gx = <span class="hljs-number">0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798</span><br>gy = <span class="hljs-number">0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8</span><br>order = <span class="hljs-number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141</span><br><br>zero = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>G = (gx, gy)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">p1, p2</span>):<br>    <span class="hljs-keyword">if</span> p1 == zero:<br>        <span class="hljs-keyword">return</span> p2<br>    <span class="hljs-keyword">if</span> p2 == zero:<br>        <span class="hljs-keyword">return</span> p1<br>    (p1x, p1y), (p2x, p2y) = p1, p2<br>    <span class="hljs-keyword">if</span> p1x == p2x <span class="hljs-keyword">and</span> (p1y != p2y <span class="hljs-keyword">or</span> p1y == <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> zero<br>    <span class="hljs-keyword">if</span> p1x == p2x:<br>        tmp = (<span class="hljs-number">3</span> * p1x * p1x + a) * inverse(<span class="hljs-number">2</span> * p1y, p) % p<br>    <span class="hljs-keyword">else</span>:<br>        tmp = (p2y - p1y) * inverse(p2x - p1x, p) % p<br>    x = (tmp * tmp - p1x - p2x) % p<br>    y = (tmp * (p1x - x) - p1y) % p<br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(x), <span class="hljs-built_in">int</span>(y))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul</span>(<span class="hljs-params">n, p</span>):<br>    r = zero<br>    tmp = p<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">0</span> &lt; n:<br>        <span class="hljs-keyword">if</span> n &amp; <span class="hljs-number">1</span> == <span class="hljs-number">1</span>:<br>            r = add(r, tmp)<br>        n, tmp = n &gt;&gt; <span class="hljs-number">1</span>, add(tmp, tmp)<br>    <span class="hljs-keyword">return</span> r<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sign</span>(<span class="hljs-params">msg, q, d, G</span>):<br>    z = <span class="hljs-built_in">int</span>(sha256(msg).hexdigest(), <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        k = randint(<span class="hljs-number">1</span>, q - <span class="hljs-number">1</span>)<br>        P = mul(k, G)<br>        r = P[<span class="hljs-number">0</span>]<br>        s = inverse(k, q) * (z + r * d) % q<br>        <span class="hljs-keyword">if</span> r != <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> s != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> r, s, k.bit_length()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">verify</span>(<span class="hljs-params">sig, msg, q, G, Q</span>):<br>    r, s = sig<br>    <span class="hljs-built_in">print</span>(r, s)<br>    <span class="hljs-keyword">if</span> r == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> s == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    z = <span class="hljs-built_in">int</span>(sha256(msg).hexdigest(), <span class="hljs-number">16</span>)<br>    u1 = z * inverse(s, q) % q<br>    u2 = r * inverse(s, q) % q<br>    P = add(mul(u1, G), mul(u2, Q))<br>    <span class="hljs-keyword">return</span> P[<span class="hljs-number">0</span>] == r<br><br><br>signal.alarm(<span class="hljs-number">240</span>)<br>menu = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">1.sign</span><br><span class="hljs-string">2.verify</span><br><span class="hljs-string">3.exit</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>uur=urandom(<span class="hljs-number">27</span>)<br>secret_key = bytes_to_long( uur+ <span class="hljs-string">b&quot;qwbs8&quot;</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;dbg&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f: <span class="hljs-comment"># only for debug check.</span><br>f.write(uur.<span class="hljs-built_in">hex</span>())<br>Q = mul(secret_key, G)<br><br>count = <span class="hljs-number">678</span> <span class="hljs-comment">#1300 #1300 for debug and test, original changces is 678</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(count):<br>    <span class="hljs-built_in">print</span>(menu)<br>    op = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt;&quot;</span>).strip())<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">1</span>:<br>        msg = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;msg: &quot;</span>).strip().encode()<br>        <span class="hljs-keyword">if</span> msg == <span class="hljs-string">b&quot;qwbs8_send_flag_to_me&quot;</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;another msg plz.&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            r, s, kbits = sign(msg, order, secret_key, G)<br>            <span class="hljs-built_in">print</span>(r, s, kbits)<br>    <span class="hljs-keyword">elif</span> op == <span class="hljs-number">2</span>:<br>        msg = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;msg: &quot;</span>).strip().encode()<br>        ur = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;r: &quot;</span>).strip())<br>        us = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;s: &quot;</span>).strip())<br>        sig = (ur, us)<br>        <span class="hljs-keyword">if</span> verify(sig, msg, order, G, Q):<br>            <span class="hljs-keyword">if</span> msg == <span class="hljs-string">b&quot;qwbs8_send_flag_to_me&quot;</span>:<br>                flag=<span class="hljs-string">&#x27;flag&#123;success-at-&#x27;</span>+<span class="hljs-built_in">str</span>(datetime.now()).replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;-&#x27;</span>)+<span class="hljs-string">&#x27;&#125;&#x27;</span><br>                <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-literal">True</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;malformed signature.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        exit(<span class="hljs-number">0</span>)<br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªECDSAï¼Œå…¶ä¸­ç§é’¥ä½ 40 ä½æ³„éœ²ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆå…¶ä»–å¯åšçš„ä¸œè¥¿ã€‚å› æ­¤åªèƒ½ä»ç§é’¥æ³„éœ²å»æ€è€ƒã€‚å¹¶ä¸”ï¼Œé¢˜ç›®ç»™å‡ºäº†æ¯æ¬¡ç­¾åéšæœºæ•° $k$ çš„æ¯”ç‰¹æ•°ï¼Œè¿™åº”è¯¥ä¹Ÿå±äºä¸€ä¸ªçªç ´å£ã€‚</p><h3 id="5x02-åˆæ­¥æ€è·¯"><a href="#5x02-åˆæ­¥æ€è·¯" class="headerlink" title="5x02 åˆæ­¥æ€è·¯"></a>5x02 åˆæ­¥æ€è·¯</h3><p>15åˆ†é’Ÿæ—¶é—´ï¼Œæˆ‘å°±æœ‰äº†æ€è·¯ï¼šæ¯æ¬¡ç”¨åŒä¸€æ¡æ¶ˆæ¯ $m$ï¼Œå¯¹ $m$ ç­¾å $677$ æ¬¡ï¼Œè¿™æ · $z$ å°±ç›¸åŒã€‚</p><p>å¾ˆå¿«æ‰¾åˆ°çº¿æ€§å…³ç³»å¼ï¼š<br>$$<br>\frac{z+dr_i}{s_i}\equiv k_i \pmod q<br>$$<br>ä¹Ÿå°±æ˜¯ï¼š<br>$$<br>\frac{z}{s_i}+\frac{d_Lr_i}{s_i}+\frac{2^{40}r_i}{s_i}d_H-u_iq&#x3D;k_i<br>$$<br>è®¾ $C_i&#x3D;\dfrac{z}{s_i}+\dfrac{d_Lr_i}{s_i}$ï¼Œ$B_i&#x3D;\dfrac{2^{40}r_i}{s_i}$é‚£ä¹ˆå¯ä»¥æ„é€ çº¿æ€§å…³ç³»å¼ï¼ˆä»ç„¶ä»¥ä¸‰ç»„æ•°æ®ä¸ºä¾‹ï¼‰ï¼š</p><p><img src="/2024/12/05/LatticeNotes8/13.png" alt="13"></p><p>ç„¶åç®—ä¸€ä¸‹ç•Œï¼š$q$ æ˜¯ $256$ ä½ï¼Œ$d_H$ æ˜¯ $216$ ä½ï¼Œé‚£ä¹ˆç¡®å®šä¸€ä¸‹ $k$ çš„æ¯”ç‰¹æ•°ã€‚</p><p>å› ä¸ºè¦ç•™æœ€åä¸€æ¬¡æœºä¼šä¼ªé€ ç­¾åï¼Œå› æ­¤ç­¾åæ¬¡æ•°ä¸º  $677$ æ¬¡ã€‚ä¸ºäº†ä¿è¯ $k$ æ¯”è¾ƒå°ï¼Œå¯ä»¥é€‰å– $k$ ä¸è¶…è¿‡ $253$ ä½çš„æ•°æ®åšã€‚é‚£ä¹ˆè·å– $k$ ä¸è¶…è¿‡ $253$ ä½çš„ç»„æ•°æœŸæœ›ä¸º $84$ æ¬¡å·¦å³ï¼Œæœ€åå‘é‡çš„å…¨éƒ¨åˆ†é‡å¯ä»¥å…¨å¹³è¡¡åˆ° $253$ ä½ï¼Œä¹Ÿå°±æ˜¯ $\log_2 |\vec v|&#x3D;253(n+2)$ ï¼Œè€Œ$\log_2 \det M&#x3D;256n$ï¼Œé›¶å‰è€…å°äºåè€…ï¼Œå¾— $n&gt;73$ï¼Œè²Œä¼¼å¯è¡Œã€‚</p><p>ç„¶åå…ˆç”¨ 1200æ¬¡æœºä¼šæµ‹ä¸€æŠŠï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-comment">#context.log_level=&#x27;debug&#x27;</span><br>sh=process([<span class="hljs-string">&#x27;python3&#x27;</span>,<span class="hljs-string">&#x27;taskdbg.py&#x27;</span>])<br>q=<span class="hljs-number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141</span><br>z = <span class="hljs-built_in">int</span>(sha256(<span class="hljs-string">b&#x27;1&#x27;</span>).hexdigest(), <span class="hljs-number">16</span>)<br>D=[]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cmp</span>(<span class="hljs-params">xtuple</span>):<br><span class="hljs-keyword">return</span> xtuple[<span class="hljs-number">2</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1200</span>)):<br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;msg: &#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>rline=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>r,s,lgk=[<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rline.split()]<br><span class="hljs-keyword">if</span>(lgk&lt;=<span class="hljs-number">253</span>):<br>D.append((r,s,lgk))<br>D=<span class="hljs-built_in">sorted</span>(D,key=cmp)<br>dl=bytes_to_long(<span class="hljs-string">b&quot;qwbs8&quot;</span>)<br>n=<span class="hljs-built_in">len</span>(D)<br>C,B=[],[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>ri,si,lgk=D[i]<br>C.append((z+dl*ri)*inverse(si,q)%q)<br>B.append((ri*<span class="hljs-number">2</span>**<span class="hljs-number">40</span>)*inverse(si,q)%q)<br>M=block_matrix(ZZ,<br>[<br>[identity_matrix(<span class="hljs-number">2</span>),matrix(ZZ,[B,C])],<br>[zero_matrix(n,<span class="hljs-number">2</span>),q*identity_matrix(n)],<br>])<br>scale=[<span class="hljs-number">216</span>,<span class="hljs-number">0</span>]+[(D[i][<span class="hljs-number">2</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br>H=diagonal_matrix([<span class="hljs-number">1</span>&lt;&lt;(<span class="hljs-number">253</span>-i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> scale])<br>M3L=(M*H).LLL()<br>count=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M3L:<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(v[<span class="hljs-number">1</span>])==<span class="hljs-number">2</span>**<span class="hljs-number">253</span> <span class="hljs-keyword">and</span> v[<span class="hljs-number">0</span>]%<span class="hljs-number">2</span>**<span class="hljs-number">37</span>==<span class="hljs-number">0</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:054x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">abs</span>(v[<span class="hljs-number">0</span>]&gt;&gt;<span class="hljs-number">37</span>)))<br><span class="hljs-comment">#00035200d2eb85df354d512e1ed7507fafa5f65421af758c6b69da</span><br><span class="hljs-comment">#0001e3bb8bf2700f617a094f0a9bbeb9a4846a50e9fa6fe58ae15f</span><br><span class="hljs-comment">#00052585d2d84afe1946e4c677b624fd13d46406c738b1dd456dbd</span><br><span class="hljs-comment">#1565175e195b3e11fcab83369564a74051eaddd58da439d1d43b4f</span><br><span class="hljs-comment">#156c8b3f909c72c31b7bd954c030a0e1c69d8c538ad3c375ff8eba</span><br><span class="hljs-comment">#143967156dabd7d3acfc42a814a16017166cd69fd9f1e3d61c293d</span><br><span class="hljs-comment">#1733855122e779bb0825373d45e906062963d8889d9291cea0d1a7</span><br><span class="hljs-comment">#17259640adc01e43c2b4e11150063b9703fe06734a2762f931a4bb</span><br><span class="hljs-comment">#16059790aec15b5f13ad8b9bd0616741b9a46b9af96c75fac7f97f</span><br><span class="hljs-comment">#033c737ebad6cb1e7e0c1f4edfe1f2d76f35b56026475a81df7ee0</span><br><span class="hljs-comment">#140f3ee633e6aaba4634aaa658010c524923b369035728c95fa649</span><br><span class="hljs-comment">#12d7a77743dd51f6368865420fb199ca13cb389972e2a6279214d7</span><br><span class="hljs-comment">#017c96aee9f5b7c4daf633f3e3d384a508545c73fec68f4bf02ce8</span><br><span class="hljs-comment">#... ... åæ­£æ²¡ä¸€ä¸ªå¯¹çš„</span><br><span class="hljs-comment">#ans: d2dffadd7e9a6d4e839c17b2c5907a51c130cf352c9eb356c0a0e4</span><br></code></pre></td></tr></table></figure><p>ç„¶åæµ‹äº†å¥½å‡ æ¬¡ï¼Œä¹Ÿæ²¡ä¸€ä¸ªå¯¹çš„ã€‚ï¼ˆæŒ‰é“ç†è¯´ä¸åº”è¯¥å•Šï¼Œç„äº†çœ¼æ‰€æœ‰å‘é‡ï¼šæˆ‘æœŸå¾…çš„æ˜¯ç¬¬äºŒåˆ†é‡ä¸º $2^{253}$ï¼Œç„¶åå…¶ä»–æ‰€æœ‰åˆ†é‡å‡ä¸º $253$ æ¯”ç‰¹ï¼‰ã€‚ç»“æœè¾“å‡ºä¸€çœ‹ï¼šæ¯ä¸ªå‘é‡éƒ½æ··æ‚ç€ 248,249,250 æ¯”ç‰¹çš„æ•°å­—ï¼Œæˆ–è€…ä¸€ä¸ªå€¼ä¸º256æ¯”ç‰¹ï¼ˆç­‰äº $q$ï¼‰ï¼Œç„¶åå…¶ä½™å…¨ $0$ã€‚</p><h3 id="5x03-æ–°çš„å¹³è¡¡ç³»æ•°æ–¹æ³•ï¼Ÿ"><a href="#5x03-æ–°çš„å¹³è¡¡ç³»æ•°æ–¹æ³•ï¼Ÿ" class="headerlink" title="5x03 æ–°çš„å¹³è¡¡ç³»æ•°æ–¹æ³•ï¼Ÿ"></a>5x03 æ–°çš„å¹³è¡¡ç³»æ•°æ–¹æ³•ï¼Ÿ</h3><p>ç„¶åå‘<a href="https://tangcuxiaojikuai.xyz/">é¸¡å—å¸ˆå‚…</a>é—®äº†ä¸€ä¸‹ ï¼Œé¡ºä¾¿è¦åˆ°äº†æµ‹è¯•ç¨‹åº</p><blockquote><p>ç³–é†‹å°é¸¡å— 2024&#x2F;12&#x2F;7 19:10:55<br>ä¸»è¦æ€è·¯æ˜¯balanceæ‰dé«˜ä½å’Œk</p><p>huangx607087 2024&#x2F;12&#x2F;7 19:11:05<br>æ‰€æœ‰çš„kéƒ½balanceå—ï¼Ÿ</p><p>ç³–é†‹å°é¸¡å— 2024&#x2F;12&#x2F;7 19:14:02<br><strong>å™¢ï¼Œbalanceæˆ‘è¿™é‡Œè¯´çš„ä¸æ˜¯ç³»æ•°é…å¹³</strong></p><p>ç³–é†‹å°é¸¡å— 2024&#x2F;12&#x2F;7 19:14:08<br><strong>æ˜¯ä½ å‡å»msb</strong></p><p>ç³–é†‹å°é¸¡å— 2024&#x2F;12&#x2F;7 19:14:20<br>æ¯”å¦‚kç°åœ¨èŒƒå›´æ˜¯$(0ï¼Œ2^{253})$</p><p>ç³–é†‹å°é¸¡å— 2024&#x2F;12&#x2F;7 19:14:32<br>ä½ å¯ä»¥å‡å»msbå˜æˆ $(-2^{252},2^{252})$</p><p>ç³–é†‹å°é¸¡å— 2024&#x2F;12&#x2F;7 19:28:41<br>dä¹Ÿå¯ä»¥balance</p><p>ç³–é†‹å°é¸¡å— 2024&#x2F;12&#x2F;7 19:28:43<br>ä¸€ä¸ªé“ç†</p><p>huangx607087 2024&#x2F;12&#x2F;7 19:28:58<br>dHæ˜¯216ä½</p><p>huangx607087 2024&#x2F;12&#x2F;7 19:29:08<br>ä¹˜ä¸ª$2^{37}$æ˜¯253ä½ï¼Ÿ</p><p>huangx607087 2024&#x2F;12&#x2F;7 19:29:24<br>è¿˜æ˜¯å‡ä¸ªå¤šå°‘ï¼Ÿ</p><p>ç³–é†‹å°é¸¡å— 2024&#x2F;12&#x2F;7 19:29:33<br>dhä¹Ÿå¯ä»¥å‡ä¸ª$2^{215}$ä¹‹ç±»çš„</p><p>ç³–é†‹å°é¸¡å— 2024&#x2F;12&#x2F;7 19:29:35<br>ç…§ä½ è¿™ä¸ª</p><p>ç³–é†‹å°é¸¡å— 2024&#x2F;12&#x2F;7 19:29:58<br>æ€»ä¹‹å°±æ˜¯æŠŠ $(0,a)$ å˜æˆ $(-a&#x2F;2,a&#x2F;2)$</p></blockquote><p>å•Šï¼Ÿè¿˜èƒ½è¿™ä¹ˆæ“ä½œçš„å—ï¼Ÿå¥‡æ€ªçš„çŸ¥è¯†åˆå¢åŠ äº†ï¼ä¹Ÿå°±æ˜¯æ‰€æœ‰çš„å€¼ï¼Œå…¨éƒ¨å‡å»æœ€é«˜ä½ï¼Œæœ€åå†åŠ å›æ¥ã€‚</p><p>é‚£ä¹ˆå‰é¢çš„å¼å­å°±å˜æˆäº†ï¼ˆå…¶ä¸­ $\beta_i&#x3D;\mathrm{kbits-1}$ï¼‰ï¼š<br>$$<br>\frac{z}{s_i}+\frac{d_Lr_i}{s_i}+\frac{2^{40}r_i}{s_i}(d_H-2^{215}+2^{215})-u_iq&#x3D;k_i+2^{\beta_i}-2^{\beta_i}<br>$$<br>ç„¶åé‡æ–°æ•´ç†ï¼š<br>$$<br>\frac{z}{s_i}+\frac{d_Lr_i}{s_i}+\frac{2^{255}r_i}{s_i}-2^{\beta_i}+\frac{2^{40}r_i}{s_i}(d_H-2^{215})-u_iq&#x3D;k_i-2^{\beta_i}<br>$$<br>è®¾ $C_i&#x3D;\dfrac{z}{s_i}+\dfrac{d_Lr_i}{s_i}+\dfrac{2^{255}r_i}{s_i}-2^{\beta}$ï¼Œ$B_i&#x3D;\dfrac{2^{40}r_i}{s_i}$é‚£ä¹ˆå¯ä»¥æ„é€ çº¿æ€§å…³ç³»å¼ï¼ˆä»ç„¶ä»¥ä¸‰ç»„æ•°æ®ä¸ºä¾‹ï¼‰ï¼š</p><p><img src="/2024/12/05/LatticeNotes8/14.png" alt="14"></p><p>ç„¶åå¯¹ä¸Šé¢çš„çŸ©é˜µè¿›è¡Œå¹³è¡¡å°±å¥½ï¼Œå¹³è¡¡åˆ° $253$ ä½å°±å¯ä»¥ã€‚</p><p>ç”±äºæœ€åè§£å‡ºæ¥å¯èƒ½ä¼šæœ‰ç¬¦å·å·®ï¼Œä¹Ÿå°±æ˜¯ä¸çŸ¥é“æ˜¯ $d_H-2^{215}$ è¿˜æ˜¯ $2^{215}-d_H$ï¼Œå› æ­¤å¯ä»¥éƒ½è¯•ä¸€ä¸‹ã€‚ç»è¿‡æµ‹è¯•ï¼Œä¸€èˆ¬ç¬¬ä¸€è¡Œå°±æ˜¯ç­”æ¡ˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-comment">#context.log_level=&#x27;debug&#x27;</span><br>sh=process([<span class="hljs-string">&#x27;python3&#x27;</span>,<span class="hljs-string">&#x27;taskdbg.py&#x27;</span>])<br>q=<span class="hljs-number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141</span><br>z = <span class="hljs-built_in">int</span>(sha256(<span class="hljs-string">b&#x27;1&#x27;</span>).hexdigest(), <span class="hljs-number">16</span>)<br>D=[]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cmp</span>(<span class="hljs-params">xtuple</span>):<br><span class="hljs-keyword">return</span> xtuple[<span class="hljs-number">2</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1200</span>)):<br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;msg: &#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>rline=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>r,s,lgk=[<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rline.split()]<br><span class="hljs-keyword">if</span>(lgk&lt;=<span class="hljs-number">253</span>):<br>D.append((r,s,lgk))<br><span class="hljs-comment">#D=sorted(D,key=cmp)</span><br>dl=bytes_to_long(<span class="hljs-string">b&quot;qwbs8&quot;</span>)<br>n=<span class="hljs-built_in">len</span>(D)<br>C,B=[],[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>ri,si,lgk=D[i]<br>C.append((-<span class="hljs-number">2</span>**(D[i][<span class="hljs-number">2</span>]-<span class="hljs-number">1</span>) +(z+ri*dl+ri*<span class="hljs-number">2</span>**<span class="hljs-number">255</span>)*inverse(si,q))%q)<br>B.append((ri*<span class="hljs-number">2</span>**<span class="hljs-number">40</span>)*inverse(si,q)%q)<br>M=block_matrix(ZZ,<br>[<br>[identity_matrix(<span class="hljs-number">2</span>),matrix(ZZ,[B,C])],<br>[zero_matrix(n,<span class="hljs-number">2</span>),q*identity_matrix(n)],<br>])<br><span class="hljs-comment"># scale=[2**215,1]+[2**(D[i][2]-1) for i in range(n)]</span><br>H=diagonal_matrix([<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">38</span>,<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">253</span>]+[<span class="hljs-number">1</span>&lt;&lt;(<span class="hljs-number">253</span>-D[i][<span class="hljs-number">2</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)])<br>M3L=(M*H).LLL()<br>count=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M3L:<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(v[<span class="hljs-number">1</span>])==<span class="hljs-number">2</span>**<span class="hljs-number">253</span> <span class="hljs-keyword">and</span> v[<span class="hljs-number">0</span>]%<span class="hljs-number">2</span>**(<span class="hljs-number">38</span>)==<span class="hljs-number">0</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:054x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-number">2</span>**<span class="hljs-number">215</span>+(v[<span class="hljs-number">0</span>]&gt;&gt;<span class="hljs-number">38</span>)),<span class="hljs-string">&#x27;&#123;:054x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-number">2</span>**<span class="hljs-number">215</span>-(v[<span class="hljs-number">0</span>]&gt;&gt;<span class="hljs-number">38</span>)))<br><span class="hljs-comment">#76999ca36b634ef46930567a8115ac40f3cb3c9f89e6432fd9dcc8 8966635c949cb10b96cfa9857eea53bf0c34c3607619bcd0262338</span><br><span class="hljs-comment">#...</span><br><span class="hljs-comment">#ans:8966635c949cb10b96cfa9857eea53bf0c34c3607619bcd0262338</span><br></code></pre></td></tr></table></figure><h3 id="5x04-exp-1200æ¬¡æœºä¼š"><a href="#5x04-exp-1200æ¬¡æœºä¼š" class="headerlink" title="5x04 exp(1200æ¬¡æœºä¼š):"></a>5x04 exp(1200æ¬¡æœºä¼š):</h3><p>æ—¢ç„¶èƒ½æ±‚å‡º $d$ ï¼Œé‚£æœ€åçš„ç­¾åå°±å¥½ä¼ªé€ äº†ï¼Œéšæœºæ•° $k$ å¯ä»¥é€‰ $1$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-comment">#context.log_level=&#x27;debug&#x27;</span><br>sh=process([<span class="hljs-string">&#x27;python3&#x27;</span>,<span class="hljs-string">&#x27;taskdbg.py&#x27;</span>])<br>q=<span class="hljs-number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141</span><br>z = <span class="hljs-built_in">int</span>(sha256(<span class="hljs-string">b&#x27;1&#x27;</span>).hexdigest(), <span class="hljs-number">16</span>)<br>D=[]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cmp</span>(<span class="hljs-params">xtuple</span>):<br><span class="hljs-keyword">return</span> xtuple[<span class="hljs-number">2</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1200</span>)):<br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;msg: &#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>rline=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>r,s,lgk=[<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rline.split()]<br><span class="hljs-keyword">if</span>(lgk&lt;=<span class="hljs-number">253</span>):<br>D.append((r,s,lgk))<br><span class="hljs-comment">#D=sorted(D,key=cmp)</span><br>dl=bytes_to_long(<span class="hljs-string">b&quot;qwbs8&quot;</span>)<br>n=<span class="hljs-built_in">len</span>(D)<br>C,B=[],[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>ri,si,lgk=D[i]<br>C.append((-<span class="hljs-number">2</span>**(D[i][<span class="hljs-number">2</span>]-<span class="hljs-number">1</span>) +(z+ri*dl+ri*<span class="hljs-number">2</span>**<span class="hljs-number">255</span>)*inverse(si,q))%q)<br>B.append((ri*<span class="hljs-number">2</span>**<span class="hljs-number">40</span>)*inverse(si,q)%q)<br>M=block_matrix(ZZ,<br>[<br>[identity_matrix(<span class="hljs-number">2</span>),matrix(ZZ,[B,C])],<br>[zero_matrix(n,<span class="hljs-number">2</span>),q*identity_matrix(n)],<br>])<br><span class="hljs-comment"># scale=[2**215,1]+[2**(D[i][2]-1) for i in range(n)]</span><br>H=diagonal_matrix([<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">38</span>,<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">253</span>]+[<span class="hljs-number">1</span>&lt;&lt;(<span class="hljs-number">253</span>-D[i][<span class="hljs-number">2</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)])<br>M3L=(M*H).LLL()<br>count=<span class="hljs-number">0</span><br>dh1,dh2,k0p,k0n=<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M3L:<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(v[<span class="hljs-number">1</span>])==<span class="hljs-number">2</span>**<span class="hljs-number">253</span> <span class="hljs-keyword">and</span> v[<span class="hljs-number">0</span>]%<span class="hljs-number">2</span>**(<span class="hljs-number">38</span>)==<span class="hljs-number">0</span>):<br>        vlow=v[<span class="hljs-number">0</span>]&gt;&gt;<span class="hljs-number">38</span><br>        dh1,dh2=<span class="hljs-number">2</span>**<span class="hljs-number">215</span>+vlow,<span class="hljs-number">2</span>**<span class="hljs-number">215</span>-vlow<br>        k0p=<span class="hljs-number">2</span>**(D[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]-<span class="hljs-number">1</span>)+(v[<span class="hljs-number">2</span>]&gt;&gt;(<span class="hljs-number">253</span>-D[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]))<br>        k0n=<span class="hljs-number">2</span>**(D[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]-<span class="hljs-number">1</span>)-(v[<span class="hljs-number">2</span>]&gt;&gt;(<span class="hljs-number">253</span>-D[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]))<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(dh1),<span class="hljs-built_in">hex</span>(dh2))<br>p=<span class="hljs-number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</span><br>E=EllipticCurve(GF(p),[<span class="hljs-number">0</span>,<span class="hljs-number">7</span>])<br>gx=<span class="hljs-number">0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798</span><br>gy=<span class="hljs-number">0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8</span><br>G=E(gx,gy)<br>d=<span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> [k0p,k0n]:<br>    <span class="hljs-keyword">for</span> dh <span class="hljs-keyword">in</span> [dh1,dh2]:<br>        testd=(dh&lt;&lt;<span class="hljs-number">40</span>)|dl<br>        P=k*G<br>        r0=P[<span class="hljs-number">0</span>]<br><br>        s0=(z+<span class="hljs-built_in">int</span>(r0)*testd)*inverse(<span class="hljs-built_in">int</span>(k),<span class="hljs-built_in">int</span>(q))%q<br>        <span class="hljs-keyword">if</span>(s0==D[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]):<br>            <span class="hljs-built_in">print</span>((k),(dh))<br>            d=testd<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span>(d):<br>        <span class="hljs-keyword">break</span><br>FLAGMSG=<span class="hljs-string">b&quot;qwbs8_send_flag_to_me&quot;</span><br><span class="hljs-built_in">print</span>(d)<br><span class="hljs-keyword">if</span>(d):<br>zf=<span class="hljs-built_in">int</span>(sha256(FLAGMSG).hexdigest(), <span class="hljs-number">16</span>)<br>ansK=<span class="hljs-number">1</span><br>P=G<br>ansR=P[<span class="hljs-number">0</span>]<br>ansS=(zf+<span class="hljs-built_in">int</span>(ansR)*d)%q<br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;msg: &#x27;</span>)<br>sh.sendline(FLAGMSG)<br>sh.recvuntil(<span class="hljs-string">b&#x27;r: &#x27;</span>)<br>sh.sendline(<span class="hljs-built_in">str</span>(ansR).encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;s: &#x27;</span>)<br>sh.sendline(<span class="hljs-built_in">str</span>(ansS).encode())<br>sh.interactive()<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><p><img src="/2024/12/05/LatticeNotes8/15.png" alt="15"></p><p>é‚£å¦‚æœæŠŠæ¬¡æ•°è°ƒå› 677 å‘¢ï¼Ÿè²Œä¼¼æ¦‚ç‡è¿˜èƒ½æ¥å—ï¼Œ40å‡ æ¬¡èƒ½å‡ºä¸€æ¬¡ï¼Œä¸è¿‡è¿˜çœŸçš„å¾—çœ‹è¿æ°”ï¼Œå› ä¸ºæœ‰çš„æ—¶å€™ 79 ç»„å°±èƒ½å‡ºï¼Œæœ‰çš„ 95 ç»„ä¹Ÿå‡ºä¸äº†ã€‚</p><p><img src="/2024/12/05/LatticeNotes8/16.png" alt="16"></p><h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9. æ€»ç»“"></a>9. æ€»ç»“</h2><p>å›é¡¾äº†ä¸€ä¸‹è‡ªå·±ä»¥å‰çš„æ„é€ LLLå­˜åœ¨çš„é—®é¢˜ï¼Œå› ä¸ºä¹‹å‰ç¡®å®æ²¡è€ƒè™‘è¿‡LLLæ±‚è§£å‘é‡çš„åŸç†ï¼ŒåŠ ä¸Šè‡ªå·±è¿™æ¬¡ç½‘é¼æ¯è¢«å¡ä½äº†ï¼Œå†™ç¯‡åšå®¢ï¼Œå›é¡¾ä¸€ä¸‹è‡ªå·±æ²¡æ³¨æ„åˆ°çš„ä¸€äº›éƒ¨åˆ†ï¼Œæ¯”å¦‚å¹³è¡¡å‚æ•°çš„æ„é€ ã€‚</p><p>ä¸è¿‡ç½‘é¼æ¯é‚£ä¸ªé¢˜ç¡®å®æŒºéš¾çš„ï¼Œå¥—äº†è¿™ä¹ˆå¤šå±‚:(</p><p>12æœˆ12æ—¥çš„å¤ç°ï¼Œç»“æœè¿˜çŸ¥é“äº†å¯ä»¥æŠŠmsbå‡æ‰å»å¹³è¡¡å‚æ•°ï¼Œæ–°çš„çŸ¥è¯†åˆå¢åŠ äº†ã€‚ã€‚ã€‚ã€‚</p><p>æœŸå¾…ç€ï¼Œè‡ªå·±åœ¨çº¿ä¸‹èµ›åšå‡ºæ¥çš„ç¬¬ 1 é¢˜ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>24Nov3</title>
    <link href="/2024/11/20/24Nov3/"/>
    <url>/2024/11/20/24Nov3/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-11æœˆçš„åˆ‡é¢˜3"><a href="#huangx607087-11æœˆçš„åˆ‡é¢˜3" class="headerlink" title="huangx607087 11æœˆçš„åˆ‡é¢˜3"></a>huangx607087 11æœˆçš„åˆ‡é¢˜3</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>é‡åˆ°äº†å‡ ä¸ªå¤æ‚çš„é¢˜ç›®ï¼Œå¯¹ç€é¢˜è§£çœ‹äº†2ä¸ªå°æ—¶ä¹Ÿæ²¡æœ‰è¯»æ‡‚ï¼Œæ„Ÿè§‰å†è¿™ä¹ˆä¸‹å»è‡ªå·±è¿Ÿæ—©å¾—å´©ã€‚</p><p>ä¸Šä¸€å‘¨å‡ ä¹æ²¡çœ‹æ–‡çŒ®ï¼Œå‰3å¤©ä¹Ÿå°±æ•´ç†äº†ä¸€ä¸‹ä¹‹å‰ä¸Šè¯¾å­¦çš„å†…å®¹ï¼Œåé¢è¿˜æœ‰ä¸€å †preå¾—åš&gt;</p><blockquote><p>æœ¬ç¯‡åšå®¢ç”±äºé¢˜ç›®å¾ˆéš¾ï¼Œå› æ­¤å¤šæ•°è¿˜æ˜¯å‚è€ƒäº†wpåšçš„ï¼Œå¦‚æœå„ä½å¸ˆå‚…ä»¬å‘ç°é‡Œé¢å¼•ç”¨äº†ä½ çš„wpï¼Œä½†æ²¡æœ‰åšæ ‡æ³¨çš„è¯ï¼Œè¯·é‚®ä»¶è”ç³»æˆ‘ï¼Œæ³¨æ˜åšæ–‡çš„title,dateä»¥åŠç»™å‡ºä½ çš„wpçš„åœ°å€ï¼Œæˆ‘ä¼šé…Œæƒ…åŠ ä¸Šå¼•ç”¨ï¼ˆå¦‚æœæˆ‘å½“æ—¶ç¡®å®æ²¡æƒ³å‡ºæ¥çš„è¯ï¼Œä¸€äº›è¿‡äºç®€å•çš„çŸ¥è¯†ä¸åœ¨æ­¤èŒƒå›´å†…ï¼‰ï¼Œæ„Ÿè°¢ã€‚</p></blockquote><p>ï¼ˆ12.2è€ƒå¯†ç å­¦ï¼Œæ— çº¿æ•°å­—é€šä¿¡æŠ€æœ¯ä¼°è®¡ä¹Ÿæ˜¯12æœˆåˆè€ƒè¯•äº†ï¼Œ12.15CISCNåˆèµ›ï¼ŒæœŸæœ«åˆæœ‰ä¸€å †ä¸œè¥¿è¦èƒŒï¼Œä¹Ÿä¸çŸ¥é“åé¢ä¼šæ€ä¹ˆæ ·ï¼‰</p><h2 id="1-2024å¼ºç½‘æ¯-electronic-game"><a href="#1-2024å¼ºç½‘æ¯-electronic-game" class="headerlink" title="1.[2024å¼ºç½‘æ¯]electronic_game"></a>1.[2024å¼ºç½‘æ¯]electronic_game</h2><h3 id="1x01-é¢˜ç›®å¤§æ„"><a href="#1x01-é¢˜ç›®å¤§æ„" class="headerlink" title="1x01 é¢˜ç›®å¤§æ„"></a>1x01 é¢˜ç›®å¤§æ„</h3><p>è¿˜æ˜¯å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.rings.finite_rings.hom_finite_field <span class="hljs-keyword">import</span> FiniteFieldHomomorphism_generic<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> * <br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64encode<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> * <br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> signal<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_timeout</span>(<span class="hljs-params">signum, frame</span>):<br>    <span class="hljs-keyword">raise</span> TimeoutError(<span class="hljs-string">&#x27;function timeout&#x27;</span>)<br><br>timeout = <span class="hljs-number">66</span><br>signal.signal(signal.SIGALRM, _handle_timeout)<br>signal.alarm(timeout)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">qary_trans_to_int</span>(<span class="hljs-params">x, q</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sum</span>([<span class="hljs-built_in">int</span>(x[i]) * q**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(x))])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">f, q</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> b64encode(long_to_bytes(qary_trans_to_int(f.polynomial().coefficients(sparse = <span class="hljs-literal">False</span>), q)))<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> b64encode(long_to_bytes(qary_trans_to_int(f.coefficients(sparse = <span class="hljs-literal">False</span>), q)))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_irreducible_polynomial</span>(<span class="hljs-params">R, n</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>: <br>        f = R.random_element(degree=n) <br>        <span class="hljs-keyword">while</span> f.degree() != n:<br>            f = R.random_element(degree=n) <br>        <span class="hljs-keyword">if</span> f.is_irreducible():<br>            <span class="hljs-keyword">return</span> f<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_sparse_irreducible_polynomial</span>(<span class="hljs-params">R, n</span>): <br>    x = R.gen()<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        g = <span class="hljs-built_in">sum</span>(choice([-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]) * x**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(randint(<span class="hljs-number">1</span>, n//<span class="hljs-number">2</span> + <span class="hljs-number">1</span>)))<br>        <span class="hljs-keyword">if</span> (x**n + g + <span class="hljs-number">1</span>).is_irreducible():<br>            <span class="hljs-keyword">return</span> x**n + g + <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">random_polynomial</span>(<span class="hljs-params">R, n, beta</span>):  <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sum</span>(randrange(-beta, beta) * R.gen()**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(randint(<span class="hljs-number">0</span>, n))) + R.gen()**n  <br><br>q = <span class="hljs-number">333337</span><br>n = <span class="hljs-number">128</span><br>beta = <span class="hljs-number">333</span> <br>chance = <span class="hljs-number">111</span><br>polyns = beta//chance<br>bound  = <span class="hljs-number">106</span><br>R = PolynomialRing(GF(q),<span class="hljs-string">&#x27;x&#x27;</span>)<br><br>F = generate_irreducible_polynomial(R,n).monic()<br><br>k1 = GF(q**n, name = <span class="hljs-string">&#x27;a&#x27;</span>, modulus = generate_sparse_irreducible_polynomial(R,n).monic())<br>k2 = GF(q**n, name = <span class="hljs-string">&#x27;b&#x27;</span>, modulus = F)<br><br>phi = FiniteFieldHomomorphism_generic(Hom(k1, k2)) <br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;F:&quot;</span>, encode(F,q).decode())<br><br>win_count = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(chance):<br>    opt = randint(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">if</span> opt:<br>        As = [phi(random_polynomial(k1,n,beta)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(polyns)] <br>    <span class="hljs-keyword">else</span>:<br>        As = [k2.random_element() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(polyns)]<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(polyns):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;As[<span class="hljs-subst">&#123;i&#125;</span>]: <span class="hljs-subst">&#123;encode(As[i],q).decode()&#125;</span>&quot;</span>)<br><br>    opt_guess = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Guess the option[0/1]: &quot;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(opt_guess) != opt:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wrong guess!&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        win_count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct guess!&quot;</span>)<br><br><span class="hljs-keyword">if</span> win_count &gt;= bound:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You are so smart! Here is your flag:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No flag for you!&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†ä¸¤ä¸ªæœ‰é™åŸŸ $K_1$ å’Œ $K_2$ï¼Œå‡ä¸º $GF(333337^{128})$ï¼Œåªæ˜¯é€‰æ‹©çš„æ¨¡å¤šé¡¹å¼ä¸åŒã€‚å…¶ä¸­ $K_1$ çš„æ¨¡å¤šé¡¹å¼ç³»æ•°å‡ä¸º $0,1,-1$ï¼Œä¸”é™¤äº† $x^{128}$ é¡¹ä¹‹å¤–ï¼Œæ‰€æœ‰çš„é¡¹æ¬¡æ•°ä¸è¶…è¿‡ $64$ã€‚è€Œ $K_2$ çš„æ¨¡å¤šé¡¹å¼ä¸ºéšæœºçš„ã€‚</p><p>æ­¤å¤–ï¼Œè¿™é‡Œè¿˜ç”Ÿæˆäº†ä¸€ä¸ªåŸŸåŒæ€ $\phi$ ï¼Œä¹Ÿå°±æ˜¯ $K_1$ åˆ° $K_2$ ä¸Šçš„æ˜ å°„æ–¹å¼ã€‚å¾ˆæ˜¾ç„¶ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªåŸŸçš„å…ƒç´ ä¸ªæ•°ä¸€æ ·ï¼Œç¾¤å…ƒç´ çš„é˜¶ä¸€æ ·ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯å­˜åœ¨åŒæ€çš„ã€‚ç„¶åè¦æ±‚ä½ åŒºåˆ†ä¸€ä¸ªç»“æœ $W(x)$ æ˜¯åœ¨ $K_1$ ä¸Šå°ç³»æ•°å¤šé¡¹å¼ $A(X)$ åŒæ€åˆ° $K_2$ å¾—åˆ°çš„ $\phi(A(x))$ ï¼Œè¿˜æ˜¯ä»…ä»…åœ¨ $K_2$ ä¸Šéšæœºå–çš„ä¸€ä¸ªå¤šé¡¹å¼ã€‚</p><p>å‚è€ƒäº†ä¸€ä¸‹<a href="https://tangcuxiaojikuai.xyz/post/df3f7032.html#more">ç³–é†‹å°é¸¡å—çš„blog</a>ï¼Œå‘ç°æ­£è§£æ˜¯å’Œå¤šé¡¹å¼å…ƒç´ çš„è¿¹æœ‰å…³ã€‚é€Ÿé€Ÿåœ°è¡¥åŸºç¡€çŸ¥è¯†ã€‚</p><h3 id="1x02-åŸºç¡€çŸ¥è¯†"><a href="#1x02-åŸºç¡€çŸ¥è¯†" class="headerlink" title="1x02 åŸºç¡€çŸ¥è¯†"></a>1x02 åŸºç¡€çŸ¥è¯†</h3><h4 id="1x02o01-ä¸åŒæ¨¡å¤šé¡¹å¼ä¸‹çš„-GF-q-n-ä¹‹é—´çš„åŒæ€æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1x02o01-ä¸åŒæ¨¡å¤šé¡¹å¼ä¸‹çš„-GF-q-n-ä¹‹é—´çš„åŒæ€æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1x02o01 ä¸åŒæ¨¡å¤šé¡¹å¼ä¸‹çš„ $GF(q^n)$ ä¹‹é—´çš„åŒæ€æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1x02o01 ä¸åŒæ¨¡å¤šé¡¹å¼ä¸‹çš„ $GF(q^n)$ ä¹‹é—´çš„åŒæ€æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>ç”±äºæœ‰é™åŸŸçš„æ¨¡å¤šé¡¹å¼è‚¯å®šæ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œç±»æ¯”ç´ æ•° $p$ æœ‰åŸæ ¹ $g$ï¼Œä¸å¯çº¦å¤šé¡¹å¼ $p(x)$ ä¹Ÿæœ‰åŸæ ¹ $g(x)$ï¼Œå…¶åŸæ ¹ $g(x)$ æ»¡è¶³ $g^{p^n-1}(x)\equiv 1\pmod {p(x)}$ï¼Œä¸”å¯¹äºä»»æ„ $k|p^{n}-1$ï¼Œ$g^{k}(x)\not \equiv 1 \pmod {p(x)}$ï¼Œä¹Ÿå°±æ˜¯æŒ‡æ•°å¿…é¡»åˆ°è¾¾ $p^n-1$ æ‰ç­‰äº $1$ï¼Œè¾¾ä¸åˆ° $p^{n}-1$ ä¸€å®šä¸ç­‰äº $1$ã€‚</p><p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š $B_1&#x3D;GF(2^{8},x^8+x^4+x^3+x^2+1)$ å’Œ $B_2&#x3D;GF(2^8,x^8+x^4+x^3+x+1)$ã€‚å¯¹äº $B_1$ ä¸­çš„æ¨¡å¤šé¡¹å¼ $x^8+x^4+x^3+x^2+1$ï¼Œå¯ä»¥å‘ç°è¯¥å¤šé¡¹å¼çš„ä¸€ä¸ªåŸæ ¹ä¸º $x$ï¼Œå› ä¸º $2^{8}-1&#x3D;255&#x3D;3\times5\times17$ã€‚è€Œ $x$ ä¸æ˜¯ $x^8+x^4+x^3+x+1$ çš„åŸæ ¹ï¼Œå› ä¸º $x^{51}\equiv 1\pmod {x^8+x^4+x^3+x+1}$ï¼ŒæŒ‡æ•°è¿˜æ²¡è¾¾åˆ° $255$ ï¼Œç»“æœå·²ç»ç­‰äº $1$ äº†ã€‚</p><p>ä½†ç»è¿‡éªŒè¯ï¼Œ$x+1$ æ˜¯ $x^8+x^4+x^3+x+1$ çš„åŸæ ¹ï¼Œå› æ­¤ï¼Œå¦‚æœèƒ½æŠŠ $B_1$ ä¸Šçš„ $x$ çœ‹ä½œ $B_2$ ä¸Šçš„ $x+1$ï¼Œå‘ƒï¼Œæˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯ç”¨ $u$ å’Œ $v$ æ¥åŒºåˆ† $B_1$ å’Œ $B_2$ ä¸Šçš„å…ƒç´ å§ã€‚ä¹Ÿå°±æ˜¯ï¼Œå¦‚æœæŠŠ $B_1$ ä¸­çš„ $u$ï¼Œçœ‹ä½œ $B_2$ ä¸Šçš„ $v+1$ï¼Œé‚£ä¹ˆä¼šäº§ç”Ÿä»€ä¹ˆæ•ˆæœï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: B1.&lt;u&gt;=GF(<span class="hljs-number">2</span>**<span class="hljs-number">8</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>sage: B2.&lt;v&gt;=GF(<span class="hljs-number">2</span>**<span class="hljs-number">8</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>sage: <span class="hljs-keyword">from</span> sage.rings.finite_rings.hom_finite_field <span class="hljs-keyword">import</span> FiniteFieldHomomorphism_generic<br>sage: phi=FiniteFieldHomomorphism_generic(Hom(B1,B2))<br>sage: phi<br>Ring morphism:<br>  From: Finite Field <span class="hljs-keyword">in</span> u of size <span class="hljs-number">2</span>^<span class="hljs-number">8</span><br>  To:   Finite Field <span class="hljs-keyword">in</span> v of size <span class="hljs-number">2</span>^<span class="hljs-number">8</span><br>  Defn: u |--&gt; v + <span class="hljs-number">1</span><br>sage: u**<span class="hljs-number">116</span><br>u^<span class="hljs-number">7</span> + u^<span class="hljs-number">6</span> + u^<span class="hljs-number">5</span> + u^<span class="hljs-number">4</span> + u^<span class="hljs-number">3</span><br>sage: (v+<span class="hljs-number">1</span>)**<span class="hljs-number">116</span><br>v^<span class="hljs-number">7</span> + v^<span class="hljs-number">2</span> + v + <span class="hljs-number">1</span><br>sage: R.&lt;x&gt;=PolynomialRing(GF(<span class="hljs-number">2</span>)) <span class="hljs-comment">#æ„é€ å¤åˆå‡½æ•°x^7+x^6+x^5+x^4+x^3</span><br>sage: ((x+<span class="hljs-number">1</span>)**<span class="hljs-number">7</span>+(x+<span class="hljs-number">1</span>)**<span class="hljs-number">6</span>+(x+<span class="hljs-number">1</span>)**<span class="hljs-number">5</span>+(x+<span class="hljs-number">1</span>)**<span class="hljs-number">4</span>+(x+<span class="hljs-number">1</span>)**<span class="hljs-number">3</span>)%(x^<span class="hljs-number">8</span>+x^<span class="hljs-number">4</span>+x^<span class="hljs-number">3</span>+x+<span class="hljs-number">1</span>)<br>x^<span class="hljs-number">7</span> + x^<span class="hljs-number">2</span> + x + <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ $B_1$ ä¸­çš„ $u$ ç­‰ä»·äº $B_2$ ä¸­çš„ $v+1$ã€‚ä¸ä»…ä»…æ˜¯åŸæ ¹çš„å…³ç³»ï¼Œå¦‚æœæˆ‘ä»¬éšæœºå– $u^{116}$ï¼Œç»“æœä¸º $u^7+u^6+u^5+u^4+u^3$ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æŠŠ $u$ å…¨éƒ¨æ›¿æ¢æˆ $v+1$ï¼Œé‚£ä¹ˆåœ¨ $B_2$ çš„æ„ä¹‰ä¸‹ï¼Œç»“æœä¸º $v^7+v^2+v+1$ ï¼ˆå…·ä½“çœ‹ä¸Šé¢ä»£ç ï¼‰ï¼Œå³ $B_1$ ä¸­çš„ $u$ å’Œåœ¨ $B_2$ ä¸­çš„ $v+1$ æ˜¯ <strong>ç­‰ä»·çš„</strong> ã€‚å› æ­¤åŒæ€ä¹Ÿå°±è¿™ä¹ˆäº§ç”Ÿäº†ï¼ˆåŸŸçš„æ€§è´¨åº”è¯¥éƒ½æ‡‚å§ï¼‰ã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥è¿™ä¹ˆåè¿‡æ¥åŒæ€ï¼Œä¹Ÿå°±æ˜¯ $B_2$ ä¸­çš„ $v$ ç­‰ä»·äº $B_1$ ä¸­çš„ $u+1$ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªçš„é˜¶éƒ½æ˜¯ $51$ï¼Œç›¸å½“äº $B_2$ çš„ä¸€ä¸ª $51$ ä¸ªå…ƒç´ çš„å­åŸŸä¹Ÿå¯ä»¥åŒæ€åˆ° $B_1$ ä¸Šçš„ä¸€ä¸ª $51$ å…ƒç´ çš„å­åŸŸã€‚ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: phinv=FiniteFieldHomomorphism_generic(Hom(B2,B1))<br>sage: phinv<br>Ring morphism:<br>  From: Finite Field <span class="hljs-keyword">in</span> v of size <span class="hljs-number">2</span>^<span class="hljs-number">8</span><br>  To:   Finite Field <span class="hljs-keyword">in</span> u of size <span class="hljs-number">2</span>^<span class="hljs-number">8</span><br>  Defn: v |--&gt; u + <span class="hljs-number">1</span><br>sage: (u+<span class="hljs-number">1</span>)**<span class="hljs-number">51</span><br><span class="hljs-number">1</span><br>sage: v**<span class="hljs-number">51</span><br><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œå¹¶ä¸æ˜¯åŸæ ¹éƒ½æ˜¯ $x$ï¼Œå°±å¯ä»¥ä» $x$ åŒæ€åˆ° $x$ çš„ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ ï¼ˆä½ è‡ªå·±æƒ³æƒ³ï¼Œä¸‹é¢è¿™ä¸ª $C$ ä¸­çš„ $u$ èƒ½å’Œ $D$ ä¸­çš„ $v$ ç­‰ä»·å—ï¼Œå‡å¦‚ $C([0,1])\equiv D([0,1])$ï¼Œä½ æ„é€ ä¸ªå¤åˆå‡½æ•°è¯•è¯•çœ‹ï¼Œæ¨¡å¤šé¡¹å¼éƒ½ä¸ä¸€æ ·ï¼Œç›´æ¥æ”¾è¿‡å»è¿˜èƒ½ä¸€æ ·ï¼Ÿï¼‰</p><p>æ³¨ï¼š $\mathbb F_7[x]$ ä¸­ï¼Œ$x^3+x+1$ å’Œ $x^3+2x^2+4x+2$ éƒ½æ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œä¸” $x$ éƒ½æ˜¯å®ƒä»¬çš„åŸæ ¹ã€‚</p><p>ä¸ºå•¥è¿™ä¸ªåŒæ€è¿‡å»æ˜¯ $5v^2+6v+6$ å‘¢ï¼Ÿéšæœºå– $u^{100}&#x3D;4u^2+3u+3$ï¼Œä½ æ„é€  $f(x)&#x3D;4x^2+3x+3$ï¼Œç„¶åè®¡ç®— $f(5v^2+6v+6) \bmod (x^3+2x^2+4x+2)$ï¼Œè®¡ç®—ç»“æœè‚¯å®šå’Œé¢„æƒ³çš„ä¸€æ ·ï¼Œè¿™æ ·æ‰æ˜¯æœ‰æ„ä¹‰çš„åŒæ€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: C.&lt;u&gt;=GF(<span class="hljs-number">7</span>**<span class="hljs-number">3</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>sage: D.&lt;v&gt;=GF(<span class="hljs-number">7</span>**<span class="hljs-number">3</span>,modulus=[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>])<br>sage: <span class="hljs-keyword">from</span> sage.rings.finite_rings.hom_finite_field <span class="hljs-keyword">import</span> FiniteFieldHomomorphism_generic<br>sage: phi=FiniteFieldHomomorphism_generic(Hom(C,D))<br>sage: phi<br>Ring morphism:<br>  From: Finite Field <span class="hljs-keyword">in</span> u of size <span class="hljs-number">7</span>^<span class="hljs-number">3</span><br>  To:   Finite Field <span class="hljs-keyword">in</span> v of size <span class="hljs-number">7</span>^<span class="hljs-number">3</span><br>  Defn: u |--&gt; <span class="hljs-number">5</span>*v^<span class="hljs-number">2</span> + <span class="hljs-number">6</span>*v + <span class="hljs-number">6</span><br>sage: u**<span class="hljs-number">100</span><br><span class="hljs-number">4</span>*u^<span class="hljs-number">2</span> + <span class="hljs-number">3</span>*u + <span class="hljs-number">3</span><br>sage: R.&lt;x&gt;=PolynomialRing(GF(<span class="hljs-number">7</span>))<br>sage: f=<span class="hljs-number">4</span>*x^<span class="hljs-number">2</span>+<span class="hljs-number">3</span>*x+<span class="hljs-number">3</span><br>sage: phi(u**<span class="hljs-number">100</span>)<br><span class="hljs-number">3</span>*v^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>*v + <span class="hljs-number">1</span><br>sage: (<span class="hljs-number">5</span>*v^<span class="hljs-number">2</span>+<span class="hljs-number">6</span>*v+<span class="hljs-number">6</span>)**<span class="hljs-number">100</span><br><span class="hljs-number">3</span>*v^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>*v + <span class="hljs-number">1</span><br>sage: f(<span class="hljs-number">5</span>*x^<span class="hljs-number">2</span>+<span class="hljs-number">6</span>*x+<span class="hljs-number">6</span>)%(x^<span class="hljs-number">3</span>+<span class="hljs-number">2</span>*x^<span class="hljs-number">2</span>+<span class="hljs-number">4</span>*x+<span class="hljs-number">2</span>)<br><span class="hljs-number">3</span>*x^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>*x + <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h4 id="1x02o02-ä»€ä¹ˆæ˜¯åŸŸä¸­å…ƒç´ çš„å…±è½­ï¼Œè¿¹å’Œæå°å¤šé¡¹å¼ã€‚"><a href="#1x02o02-ä»€ä¹ˆæ˜¯åŸŸä¸­å…ƒç´ çš„å…±è½­ï¼Œè¿¹å’Œæå°å¤šé¡¹å¼ã€‚" class="headerlink" title="1x02o02 ä»€ä¹ˆæ˜¯åŸŸä¸­å…ƒç´ çš„å…±è½­ï¼Œè¿¹å’Œæå°å¤šé¡¹å¼ã€‚"></a>1x02o02 ä»€ä¹ˆæ˜¯åŸŸä¸­å…ƒç´ çš„å…±è½­ï¼Œè¿¹å’Œæå°å¤šé¡¹å¼ã€‚</h4><p>ä¸Šæ¬¡ä½ å¬åˆ°å…±è½­è¿™ä¸ªè¯´æ³•ï¼Œè¿˜æ˜¯åœ¨å¤æ•°åŸŸä¸­çš„å…±è½­å¤æ•°é‚£ä¸€å—ã€‚ä¹Ÿå°±æ˜¯ $a+b\mathrm i$ çš„å…±è½­å¤æ•°æ˜¯ $a-b\mathrm i$ã€‚è€ŒåŸŸ $\mathbb F_{p^n}$ ä¸­æŸå…ƒç´  $\alpha$ çš„å…±è½­ä¸€å…±æœ‰ $n-1$ ä¸ªï¼Œä¸º $\alpha^q,\alpha^{q^2},\alpha^{q^{3}},â€¦,\alpha^{q^{n-1}}$ï¼Œè¿™åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>è¿˜æ˜¯ä»å¤æ•°åŸŸå¼€å§‹ï¼š åœ¨ $\mathbb C_7$ ä¸­ $3+2\mathrm i$ çš„å…±è½­å¤æ•°æ˜¯ $3+5\mathrm i$ï¼Œè¿™ä¸ªèƒ½ç†è§£ã€‚å¹¶ä¸”ä½ ä¼šå‘ç°ï¼Œåœ¨ $\mathbb C$ ä¸­ï¼Œä¸¤ä¸ªå…±è½­å¤æ•°ç›¸åŠ ä¹‹åï¼Œåªå‰©ä¸‹äº†å®éƒ¨ï¼Œè™šéƒ¨æ¸…é›¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: C7.&lt;img&gt;=GF(<span class="hljs-number">49</span>,modulus=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])<br>sage: <span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>+<span class="hljs-number">2</span>*img,<span class="hljs-number">7</span>)<br><span class="hljs-number">5</span>*img + <span class="hljs-number">3</span><br>sage: (<span class="hljs-number">3</span>+<span class="hljs-number">2</span>*img)+(<span class="hljs-number">3</span>+<span class="hljs-number">5</span>*img)<br><span class="hljs-number">6</span><br></code></pre></td></tr></table></figure><p>ç„¶åæ‰©å±•åˆ°ä¸‰é˜¶ï¼Œä»»æ„å…ƒç´  $a$ å’Œå…¶ä¸¤ä¸ªå…±è½­ $a^{p},a^{p^2}$ ç›¸åŠ ï¼Œä¹Ÿå¾—åˆ°äº†ä¸€ä¸ªæ•°å€¼ï¼Œ$u,u^2$ æ¸…é›¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">sage: D13.&lt;u&gt;=GF(<span class="hljs-number">11</span>**<span class="hljs-number">3</span>)<br>sage: D13.modulus()<br>x^<span class="hljs-number">3</span> + <span class="hljs-number">2</span>*x + <span class="hljs-number">9</span><br>sage: a=D13.random_element()<br>sage: a<br><span class="hljs-number">10</span>*u^<span class="hljs-number">2</span> + <span class="hljs-number">3</span>*u + <span class="hljs-number">4</span><br>sage: a+(a**<span class="hljs-number">11</span>)+(a**<span class="hljs-number">121</span>)<br><span class="hljs-number">5</span><br>sage: a.trace()<br><span class="hljs-number">5</span><br></code></pre></td></tr></table></figure><p>è¿™ä¹Ÿå°±æ˜¯ $\alpha $  çš„è¿¹çš„å®šä¹‰ã€‚</p><p>å½“ç„¶ï¼Œ$\alpha$ å’Œå®ƒçš„ $n$ ä¸ªå…±è½­å¯ä»¥æˆä¸ºä¸€ä¸ªä¸€å…ƒ $n$ æ¬¡æ–¹ç¨‹ $(x-\alpha)(x-\alpha^{p^2})\cdots(x-\alpha^{p^{n-1}})&#x3D;0$ çš„æ‰€æœ‰æ ¹ã€‚è®¡ç­‰å·å·¦è¾¹ä¸º $f$ï¼Œé€šè¿‡æ ¹ä¸ç³»æ•°çš„æ¯”è¾ƒå…³ç³»å¯ä»¥å‘ç°ï¼Œ$-f[n-1]$ ä¸º $n$ ä¸ªæ ¹ä¹‹å’Œï¼Œä¹Ÿå°±æ˜¯ $x^{n-1}$ æ¬¡ç³»æ•°çš„ç›¸åæ•°ä¸º $\alpha$ çš„è¿¹ã€‚</p><h4 id="1x02o03-åŒæ€å‰åè¿¹ä¸å˜çš„åŸå› ã€-K-1-ä¸­å°ç³»æ•°å¤šé¡¹å¼è¿¹å¾ˆå°çš„åŸå› ã€‚"><a href="#1x02o03-åŒæ€å‰åè¿¹ä¸å˜çš„åŸå› ã€-K-1-ä¸­å°ç³»æ•°å¤šé¡¹å¼è¿¹å¾ˆå°çš„åŸå› ã€‚" class="headerlink" title="1x02o03 åŒæ€å‰åè¿¹ä¸å˜çš„åŸå› ã€$K_1$ ä¸­å°ç³»æ•°å¤šé¡¹å¼è¿¹å¾ˆå°çš„åŸå› ã€‚"></a>1x02o03 åŒæ€å‰åè¿¹ä¸å˜çš„åŸå› ã€$K_1$ ä¸­å°ç³»æ•°å¤šé¡¹å¼è¿¹å¾ˆå°çš„åŸå› ã€‚</h4><p>è¿™è¾¹æœ‰ä¸¤ä¸ªåŸŸ $F,G$ï¼Œæ¢ä¸ªå¤§ç‚¹çš„æ•°å­—ï¼Œçœ‹çœ‹å®éªŒç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p=<span class="hljs-number">1435756429</span><br>R.&lt;x&gt;=PolynomialRing(GF(p))<br>fp2=[<span class="hljs-number">1281051561</span>, <span class="hljs-number">325824623</span>, <span class="hljs-number">587085269</span>, <span class="hljs-number">519016661</span>, <span class="hljs-number">607488613</span>, <span class="hljs-number">349057141</span>, <span class="hljs-number">1328077096</span>, <span class="hljs-number">1307270920</span>, <span class="hljs-number">561010408</span>, <span class="hljs-number">1114525395</span>, <span class="hljs-number">117794890</span>, <span class="hljs-number">713439535</span>, <span class="hljs-number">696507390</span>, <span class="hljs-number">529855506</span>, <span class="hljs-number">773150011</span>, <span class="hljs-number">251203247</span>, <span class="hljs-number">1</span>]<br>fp1=[<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]<br>F.&lt;u&gt;=GF(p**<span class="hljs-number">16</span>,modulus=fp1)<br>G.&lt;v&gt;=GF(p**<span class="hljs-number">16</span>,modulus=fp2)<br><span class="hljs-keyword">from</span> sage.rings.finite_rings.hom_finite_field <span class="hljs-keyword">import</span> FiniteFieldHomomorphism_generic<br>phi = FiniteFieldHomomorphism_generic(Hom(F, G)) <br>listAx=[randint(-<span class="hljs-number">607</span>,<span class="hljs-number">607</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br><span class="hljs-built_in">print</span>(listAx)<br><span class="hljs-comment">#[-133, 543, 547, -416, -20, -228, 340, 578, 460, -394, 147, 153, -237, -589, 521, 117]</span><br>Axf=F(listAx)<br>Axg=phi(F(listAx))<br>Bx=G.random_element()<br><span class="hljs-built_in">print</span>(Axf.trace(),Axg.trace(),Bx.trace())<br><span class="hljs-comment">#[-133, 543, 547, -416, -20, -228, 340, 578, 460, -394, 147, 153, -237, -589, 521, 117]</span><br><span class="hljs-comment">#8967 8967 965643423</span><br><span class="hljs-built_in">print</span>(Axf)<br><span class="hljs-comment">#117*u^15 + 521*u^14 + 1435755840*u^13 + 1435756192*u^12 + 153*u^11 + 147*u^10 + 1435756035*u^9 + 460*u^8 + 578*u^7 + 340*u^6 + 1435756201*u^5 + 1435756409*u^4 + 1435756013*u^3 + 547*u^2 + 543*u + 1435756296</span><br><span class="hljs-built_in">print</span>(Axg)<br><span class="hljs-comment">#426045453*v^15 + 1095853004*v^14 + 1027534429*v^13 + 199604488*v^12 + 1245066406*v^11 + 491522381*v^10 + 319187049*v^9 + 793800632*v^8 + 179486685*v^7 + 1344029075*v^6 + 926473343*v^5 + 484211635*v^4 + 1047468414*v^3 + 157075129*v^2 + 610169781*v + 917898386</span><br><span class="hljs-built_in">print</span>(Bx)<br><span class="hljs-comment">#779249508*v^15 + 297567236*v^14 + 378700571*v^13 + 1081381084*v^12 + 307273340*v^11 + 64314112*v^10 + 112350563*v^9 + 649766190*v^8 + 424903042*v^7 + 223527316*v^6 + 1393065653*v^5 + 1322430432*v^4 + 457302712*v^3 + 807713883*v^2 + 1191352294*v + 461422786</span><br></code></pre></td></tr></table></figure><p>å‡è®¾ $F$ åˆ° $G$ çš„åŒæ€ä¸º $\phi$ã€‚è®¾ $A_F$ çš„æå°å¤šé¡¹å¼ä¸º $f(x)$ï¼Œé‚£ä¹ˆ $f(A_F)&#x3D;0$ï¼Œç”±åŒæ€å¯ä»¥å¾—åˆ° $\phi(f(A_F))&#x3D;f(\phi(A_F))&#x3D;f(A_G)$ï¼Œå› æ­¤åŒæ€å‰åï¼Œæå°å¤šé¡¹å¼ä¸å˜ï¼Œè¿¹ä¹Ÿä¸å˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(Axf.minimal_polynomial())<br><span class="hljs-comment">#x^16 + 1435747462*x^15 + 33455366*x^14 + 1037842702*x^13 + 11109617*x^12 + 832067022*x^11 + 138214583*x^10 + 565542262*x^9 + 1176957343*x^8 + 1394076824*x^7 + 797026202*x^6 + 1386837332*x^5 + 948171790*x^4 + 593354364*x^3 + 495207351*x^2 + 1341667046*x + 1086432282</span><br><span class="hljs-built_in">print</span>(Axg.minimal_polynomial())<br><span class="hljs-comment">#x^16 + 1435747462*x^15 + 33455366*x^14 + 1037842702*x^13 + 11109617*x^12 + 832067022*x^11 + 138214583*x^10 + 565542262*x^9 + 1176957343*x^8 + 1394076824*x^7 + 797026202*x^6 + 1386837332*x^5 + 948171790*x^4 + 593354364*x^3 + 495207351*x^2 + 1341667046*x + 1086432282</span><br>Axg.minimal_polynomial()==Axf.minimal_polynomial()<br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure><p>è‡³äºä¸ºä½•åŒæ€å‰çš„è¿¹ä¹Ÿå¾ˆå°ï¼Œæˆ‘å¤§æ¦‚çš„çŒœæµ‹å¦‚ä¸‹ï¼š</p><blockquote><p>1.åŸæ¥ç”Ÿæˆçš„çš„å¤šé¡¹å¼æ˜¯å°ç³»æ•°å¤šé¡¹å¼</p><p>2.å› ä¸º $K_1$ ä¸­çš„å–æ¨¡å¤šé¡¹å¼åªæœ‰ä½ä½æœ‰ $0$ å’Œ $\pm1$ï¼Œé‚£ä¹ˆ $x^{n}$ ä¼šè¢«åˆ†æ•£åˆ°ä½ä¸€åŠçš„ä½ä¸­å»ï¼Œä¸”å˜åŠ¨åªæœ‰å¯èƒ½æ˜¯ $x^n$ çš„ç³»æ•°ã€‚å› æ­¤å¯¹äºç‰¹å®šé˜¶æ•°çš„å˜æ¢ $q,q^2,q^3,â€¦,q^{n-1}$ ä¸‹ï¼Œå¤šæ¬¡ä¹˜æ–¹åçš„æ•ˆæœä¼šè¢«æŠµæ¶ˆæ‰ï¼ˆå¯¹åº”å…ƒç´ çš„å…±è½­ï¼‰ï¼Œç„¶åå…¨éƒ¨åŠ èµ·æ¥ï¼Œå¾—åˆ°çš„è¿¹ä¹Ÿå°±å¾ˆå°äº†ã€‚</p></blockquote><p>é—²å¾—æ— èŠçœ‹äº†ä¸€ä¸‹è¿™ä¸ª</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(Hom(F,G))) <span class="hljs-comment">#length:16</span><br></code></pre></td></tr></table></figure><p>ç„¶ååˆè°ƒäº†ä¸€ä¸‹è¿™ä¸ª</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">phi(u**(p**<span class="hljs-number">3</span>)) <span class="hljs-comment">#1,2,3,4,5,...,15</span><br></code></pre></td></tr></table></figure><p>å‘ç°è¿™äº›åˆšå¥½å¯¹åº” <code>(list(Hom(F,G)))</code> ä¸­å‡ºç°çš„æ‰€æœ‰è¡¨è¾¾å¼ï¼Œæœ‰ç‚¹æ„æ€ã€‚</p><h3 id="1x03-è§£é¢˜"><a href="#1x03-è§£é¢˜" class="headerlink" title="1x03 è§£é¢˜"></a>1x03 è§£é¢˜</h3><p>æ—¢ç„¶åœ¨ $K_1$ ä¸Šå–å°å¤šé¡¹å¼ä¹‹åï¼Œå¾—åˆ°çš„è¿¹å¾ˆå°ï¼Œé‚£æ€ä¹ˆæ ·ä¸ªè¿¹æ‰ç®—å°å‘¢ï¼Ÿéšæœºå–æ ·ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„å·®è·ï¼š</p><p><img src="/2024/11/20/24Nov3/1.png" alt="1"></p><p><img src="/2024/11/20/24Nov3/2.png" alt="2"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">T=[<span class="hljs-number">3765</span>, <span class="hljs-number">7362</span>, <span class="hljs-number">7440</span>, <span class="hljs-number">7259</span>, <span class="hljs-number">7343</span>, <span class="hljs-number">6932</span>, <span class="hljs-number">1174</span>, <span class="hljs-number">1072</span>, <span class="hljs-number">976</span>, <span class="hljs-number">821</span>, <span class="hljs-number">707</span>, <span class="hljs-number">668</span>, <span class="hljs-number">598</span>, <span class="hljs-number">540</span>, <span class="hljs-number">422</span>, <span class="hljs-number">409</span>, <span class="hljs-number">382</span>, <span class="hljs-number">367</span>, <span class="hljs-number">351</span>, <span class="hljs-number">306</span>, <span class="hljs-number">308</span>, <span class="hljs-number">290</span>, <span class="hljs-number">306</span>, <span class="hljs-number">316</span>, <span class="hljs-number">357</span>, <span class="hljs-number">365</span>, <span class="hljs-number">356</span>, <span class="hljs-number">369</span>, <span class="hljs-number">395</span>, <span class="hljs-number">495</span>, <span class="hljs-number">549</span>, <span class="hljs-number">583</span>, <span class="hljs-number">637</span>, <span class="hljs-number">738</span>, <span class="hljs-number">802</span>, <span class="hljs-number">981</span>, <span class="hljs-number">1060</span>, <span class="hljs-number">1364</span>, <span class="hljs-number">7058</span>, <span class="hljs-number">7249</span>, <span class="hljs-number">7249</span>, <span class="hljs-number">7421</span>, <span class="hljs-number">7434</span>, <span class="hljs-number">4424</span>, <span class="hljs-number">0</span>]<br>S=[<span class="hljs-number">1189</span>, <span class="hljs-number">2334</span>, <span class="hljs-number">2362</span>, <span class="hljs-number">2395</span>, <span class="hljs-number">2329</span>, <span class="hljs-number">2269</span>, <span class="hljs-number">2359</span>, <span class="hljs-number">2378</span>, <span class="hljs-number">2341</span>, <span class="hljs-number">2276</span>, <span class="hljs-number">2333</span>, <span class="hljs-number">2387</span>, <span class="hljs-number">2300</span>, <span class="hljs-number">2265</span>, <span class="hljs-number">2347</span>, <span class="hljs-number">2307</span>, <span class="hljs-number">2236</span>, <span class="hljs-number">2272</span>, <span class="hljs-number">2282</span>, <span class="hljs-number">2339</span>, <span class="hljs-number">2285</span>, <span class="hljs-number">2331</span>, <span class="hljs-number">2353</span>, <span class="hljs-number">2308</span>, <span class="hljs-number">2295</span>, <span class="hljs-number">2342</span>, <span class="hljs-number">2308</span>, <span class="hljs-number">2254</span>, <span class="hljs-number">2323</span>, <span class="hljs-number">2275</span>, <span class="hljs-number">2249</span>, <span class="hljs-number">2283</span>, <span class="hljs-number">2306</span>, <span class="hljs-number">2357</span>, <span class="hljs-number">2371</span>, <span class="hljs-number">2375</span>, <span class="hljs-number">2339</span>, <span class="hljs-number">2344</span>, <span class="hljs-number">2411</span>, <span class="hljs-number">2375</span>, <span class="hljs-number">2323</span>, <span class="hljs-number">2327</span>, <span class="hljs-number">2363</span>, <span class="hljs-number">1203</span>, <span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p>ç„¶åä½ ä¼šå‘ç°ï¼Œç¬¬ä¸€ä¸ªå–æ ·è€—æ—¶æ¥è¿‘ç¬¬äºŒä¸ªçš„å››å€ï¼ˆæ‰€ä»¥è¦æ˜¯åœ¨å¯¹é¢æœåŠ¡å™¨ä¸Šæ‰“çš„è¯ï¼Œæ˜¯ä¸æ˜¯èƒ½ç›´æ¥æ ¹æ®æ—¶é—´å»åˆ¤æ–­(bushi)</p><p>æœ€åä¸»è¦å°±æ˜¯é traceåŒºåˆ†äº†ï¼Œå› ä¸ºåŸé¢˜ç¯å¢ƒæ²¡äº†ï¼Œæ‰€ä»¥è¿›è¡Œäº†æœ¬åœ°å¤ç°ã€‚ä¸€å¼€å§‹Boundè°ƒ $50000$ å’Œ $60000$ éƒ½æ²¡æˆåŠŸï¼Œ$70000$ è°ƒäº†ä¸€æ¬¡ï¼ŒæˆåŠŸäº†ï¼Œä½†å¥½åƒçœŸçš„æ¯”è¾ƒçœ‹è„¸ã€‚ã€‚ã€‚å› ä¸ºåç»­æˆ‘åˆå°è¯•äº†å‡ æ¬¡éƒ½æ²¡æˆåŠŸã€‚ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>sh=remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">60733</span>)<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b642poly</span>(<span class="hljs-params">fb64</span>):<br>flist=[<span class="hljs-number">0</span>]*<span class="hljs-number">129</span><br>fi=bytes_to_long(b64decode(fb64))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">129</span>):<br>flist[i]=fi%<span class="hljs-number">333337</span><br>fi//=<span class="hljs-number">333337</span><br><span class="hljs-keyword">return</span> flist<br>sh.recvuntil(<span class="hljs-string">b&#x27;F:&#x27;</span>)<br>Px=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip().decode()<br>Px=(b642poly(Px))<br>K=GF(<span class="hljs-number">333337</span>**<span class="hljs-number">128</span>,modulus=Px,names=(<span class="hljs-string">&#x27;t&#x27;</span>,))<br>BOUND=<span class="hljs-number">70000</span><br>score=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">111</span>):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;score=&#125;</span>,round=<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>Fx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>Gx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>Hx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>Fx,Gx,Hx=b642poly(Fx),b642poly(Gx),b642poly(Hx)<br>Fx,Gx,Hx=K(Fx),K(Gx),K(Hx)<br>a,b,c=(Fx.trace(),Gx.trace(),Hx.trace())<br>judg=<span class="hljs-built_in">sum</span>([a&lt;BOUND,a&gt;<span class="hljs-number">333337</span>-BOUND,b&lt;BOUND,b&gt;<span class="hljs-number">333337</span>-BOUND,c&lt;BOUND,c&gt;<span class="hljs-number">333337</span>-BOUND])<br><span class="hljs-keyword">if</span>(judg&gt;<span class="hljs-number">2</span>):<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>sh.sendline(<span class="hljs-string">b&#x27;0&#x27;</span>)<br>jres=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-keyword">if</span>(<span class="hljs-string">b&#x27;Correct&#x27;</span> <span class="hljs-keyword">in</span> jres):<br>score+=<span class="hljs-number">1</span><br>sh.interactive()<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼Œå¡çº¿å‡ºäº†ä¸€æ¬¡ï¼š</p><img src="/2024/11/20/24Nov3/3.png" alt="3" style="zoom:87%;"><p>ç„¶åBOUNDè°ƒæˆ $65000$ï¼Œå†™äº†ä¸ªè‡ªåŠ¨åŒ–å¤šæ¬¡è¿æ¥å¤šæ¬¡è¿è¡Œçš„è„šæœ¬ï¼Œåæ­£èƒ½å‡ºï¼Œå¹³å‡ä¸‹æ¥æœ‰åå‡ åˆ†ä¹‹ä¸€çš„æ¦‚ç‡ã€‚ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b642poly</span>(<span class="hljs-params">fb64</span>):<br>flist=[<span class="hljs-number">0</span>]*<span class="hljs-number">129</span><br>fi=bytes_to_long(b64decode(fb64))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">129</span>):<br>flist[i]=fi%<span class="hljs-number">333337</span><br>fi//=<span class="hljs-number">333337</span><br><span class="hljs-keyword">return</span> flist<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Solveeee</span>():<br>sh=remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">60733</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;F:&#x27;</span>)<br>Px=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip().decode()<br>Px=(b642poly(Px))<br>K=GF(<span class="hljs-number">333337</span>**<span class="hljs-number">128</span>,modulus=Px,names=(<span class="hljs-string">&#x27;t&#x27;</span>,))<br>BOUND=<span class="hljs-number">65000</span><br>score=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">111</span>):<br><span class="hljs-comment">#print(f&#x27;&#123;score=&#125;,round=&#123;i&#125;&#x27;)</span><br>sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>Fx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>Gx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>sh.recvuntil(<span class="hljs-string">b&#x27;]:&#x27;</span>)<br>Hx=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()<br>Fx,Gx,Hx=b642poly(Fx),b642poly(Gx),b642poly(Hx)<br>Fx,Gx,Hx=K(Fx),K(Gx),K(Hx)<br>a,b,c=(Fx.trace(),Gx.trace(),Hx.trace())<br>judg=<span class="hljs-built_in">sum</span>([a&lt;BOUND,a&gt;<span class="hljs-number">333337</span>-BOUND,b&lt;BOUND,b&gt;<span class="hljs-number">333337</span>-BOUND,c&lt;BOUND,c&gt;<span class="hljs-number">333337</span>-BOUND])<br><span class="hljs-keyword">if</span>(judg&gt;<span class="hljs-number">2</span>):<br>sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>sh.sendline(<span class="hljs-string">b&#x27;0&#x27;</span>)<br>jres=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-keyword">if</span>(<span class="hljs-string">b&#x27;Correct&#x27;</span> <span class="hljs-keyword">in</span> jres):<br>score+=<span class="hljs-number">1</span><br>C=(sh.recvall())<br>sh.close()<br><span class="hljs-keyword">return</span> score,C<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (<span class="hljs-built_in">range</span>(<span class="hljs-number">300</span>)):<br><span class="hljs-built_in">print</span>(i+<span class="hljs-number">1</span>,Solveeee())<br><span class="hljs-comment">#sh.interactive()</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼šï¼ˆæœåŠ¡å™¨ç«¯åˆ é™¤äº†from secret import flagï¼Œæ”¹æˆäº†è‡ªå®šä¹‰flagæ ¼å¼ï¼Œå…¶ä»–æ–¹æ³•ç­‰æ•ˆäºåŸæœåŠ¡å™¨ï¼‰ã€‚</p><p><img src="/2024/11/20/24Nov3/4.png" alt="4"></p><h2 id="2-numbers2"><a href="#2-numbers2" class="headerlink" title="2.numbers2"></a>2.numbers2</h2><h3 id="2x01-é¢˜ç›®å¤§æ„"><a href="#2x01-é¢˜ç›®å¤§æ„" class="headerlink" title="2x01 é¢˜ç›®å¤§æ„"></a>2x01 é¢˜ç›®å¤§æ„</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n  = p*q<br>m = bytes_to_long(os.urandom(<span class="hljs-number">20</span>))<br>x = <span class="hljs-built_in">pow</span>(m,p,n)<br>y = <span class="hljs-built_in">pow</span>(m,q,n)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <br>    file.write(<span class="hljs-string">&#x27;n = &#x27;</span> + <span class="hljs-built_in">str</span>(n) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-string">&#x27;x = &#x27;</span> + <span class="hljs-built_in">str</span>(x) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-string">&#x27;y = &#x27;</span> + <span class="hljs-built_in">str</span>(y) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br><br>iv = sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()[:<span class="hljs-number">16</span>]<br><br><br>n = <span class="hljs-number">17</span><br>q = getPrime(<span class="hljs-number">1024</span>)<br>x = randint(q//<span class="hljs-number">2</span>,q-<span class="hljs-number">1</span>)<br>S = <span class="hljs-number">2</span>**<span class="hljs-number">544</span><br>K = <span class="hljs-number">2</span>**<span class="hljs-number">480</span><br><br>s = [randint(S//<span class="hljs-number">2</span>,S-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>t = [randint(S//<span class="hljs-number">2</span>,S-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br><br>k = [randint(K//<span class="hljs-number">2</span>,K-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>b = [randint(K//<span class="hljs-number">2</span>,K-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br>r = [(s[i]*k[i] - b[i]*t[i]) * inverse(x,q) % q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-string">f&quot;s = <span class="hljs-subst">&#123;s&#125;</span>\n&quot;</span>)<br>    file.write(<span class="hljs-string">f&quot;t = <span class="hljs-subst">&#123;t&#125;</span>\n&quot;</span>)<br>    file.write(<span class="hljs-string">f&quot;r = <span class="hljs-subst">&#123;r&#125;</span>\n&quot;</span>)<br>    file.write(<span class="hljs-string">&#x27;q = &#x27;</span> + <span class="hljs-built_in">str</span>(q) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <br>key = sha256(<span class="hljs-built_in">str</span>(<span class="hljs-number">2024</span>*b[<span class="hljs-number">0</span>]+<span class="hljs-number">2023</span>*k[<span class="hljs-number">0</span>] + x).encode()).digest()[:<span class="hljs-number">16</span>]<br><br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br>aes = AES.new(key,AES.MODE_CBC,iv)<br>cipher = aes.encrypt(pad(flag.encode(),<span class="hljs-number">16</span>))<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.write(<span class="hljs-string">f&quot;cipher = <span class="hljs-subst">&#123;cipher&#125;</span>&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®çš„flagä½¿ç”¨äº†AES-CBCåŠ å¯†ã€‚åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå¯¹ivçš„åŠ å¯†å’Œå¯¹å¯†é’¥çš„åŠ å¯†ã€‚ä¸‹é¢åˆ†åˆ«é˜è¿°</p><h3 id="2x02-Part-1"><a href="#2x02-Part-1" class="headerlink" title="2x02 Part 1"></a>2x02 Part 1</h3><p>ç¬¬ä¸€éƒ¨åˆ†ç»™å‡ºäº†ä¸€ä¸ªRSAçš„åŠ å¯†è¿‡ç¨‹åŠ å¯† ivã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n  = p*q<br>m = bytes_to_long(os.urandom(<span class="hljs-number">20</span>))<br>x = <span class="hljs-built_in">pow</span>(m,p,n)<br>y = <span class="hljs-built_in">pow</span>(m,q,n)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <br>    file.write(<span class="hljs-string">&#x27;n = &#x27;</span> + <span class="hljs-built_in">str</span>(n) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-string">&#x27;x = &#x27;</span> + <span class="hljs-built_in">str</span>(x) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-string">&#x27;y = &#x27;</span> + <span class="hljs-built_in">str</span>(y) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>iv = sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()[:<span class="hljs-number">16</span>]<br></code></pre></td></tr></table></figure><p>è¿™ä¸€é—®å’Œé¹åŸæ¯çš„é‚£ä¸ªé¢˜ä¸€æ ·ï¼ŒCRTåŒ–ç®€ä¹‹åï¼Œè¿˜æ˜¯ $g\equiv m\pmod p,h\equiv m \pmod q$ çš„å½¢å¼ï¼Œå®Œå…¨ä¸€æ ·çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-number">133693649727082259107041662011720823458571250895054242259170170354175642242128965748915759548206594541801234255878757661771526775311636655859201668702890990745739241126384729560433907755687614698569613585182786544165812027959219789602655976970715100245966545577285355634247363922810553139003838578363660449109</span><br>g=<span class="hljs-number">92401219014364912794053160070309527007771356043695463515571328726676546494869270394623052969651083009651771857467561945521106625547418406188430774969043958102947805651169010188202688119325462398122519423459244079993702953589811689050017122705616315531462047800685314554111273134721614734430443067361639605720</span><br>h=<span class="hljs-number">27444123601022148160097636168019280219400389861288181193988463940073215353205764735090720106313510456714820401995714013971697413924167047690200030265762984461900122475812718262941762361406314725034408660419186620573774598548615986428700226735633115570424145980543054306673862989672645266476994517440508647839</span><br><br>K=<span class="hljs-number">2</span>**<span class="hljs-number">1600</span><br>M=Matrix(ZZ,[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,g*h*K],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-(g+h)*K],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>*K],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,K*n]])<br><span class="hljs-built_in">print</span>(M.LLL()[<span class="hljs-number">0</span>])<br><span class="hljs-comment">#(-1, -220100243352092218129491119040565723833151607139, -48444117123650214661388931601686039991652705643026455075715408364262521400552593472298595765321, 0)</span><br></code></pre></td></tr></table></figure><p>åªæ˜¯éœ€è¦å¤šåšä¸€æ­¥ï¼Œè®¡ç®— $g-m$ å’Œ $n$ çš„æœ€å¤§å…¬çº¦æ•°ï¼Œå› ä¸º $g\equiv m\pmod p$ï¼Œä¹Ÿå°±æ˜¯ $g&#x3D;kp+m$ï¼Œå› æ­¤ $g-m&#x3D;kp$ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ° $n$ çš„åˆ†è§£äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">p=GCD(g-m,n)<br>q=n//p<br><span class="hljs-keyword">assert</span> p*q==n<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>iv1= sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()[:<span class="hljs-number">16</span>]<br>iv2= sha256(<span class="hljs-built_in">str</span>(q).encode()).digest()[:<span class="hljs-number">16</span>]<br><span class="hljs-built_in">print</span>(iv1.<span class="hljs-built_in">hex</span>())<br><span class="hljs-built_in">print</span>(iv2.<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#8076dd87467b159231123921f92dd39b</span><br><span class="hljs-comment">#313f3a43636d41db93278863b3d50e73</span><br></code></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸¤ä¸ªIVï¼Œå…ˆä¿å­˜ç€ï¼Œä¸ç¡®å®šå“ªä¸ªæ˜¯å¯¹çš„ã€‚</p><h3 id="2x03-Part-2"><a href="#2x03-Part-2" class="headerlink" title="2x03 Part 2"></a>2x03 Part 2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-number">17</span><br>q = getPrime(<span class="hljs-number">1024</span>)<br>x = randint(q//<span class="hljs-number">2</span>,q-<span class="hljs-number">1</span>)<br>S = <span class="hljs-number">2</span>**<span class="hljs-number">544</span><br>K = <span class="hljs-number">2</span>**<span class="hljs-number">480</span><br><br>s = [randint(S//<span class="hljs-number">2</span>,S-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>t = [randint(S//<span class="hljs-number">2</span>,S-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br><br>k = [randint(K//<span class="hljs-number">2</span>,K-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>b = [randint(K//<span class="hljs-number">2</span>,K-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><br>r = [(s[i]*k[i] - b[i]*t[i]) * inverse(x,q) % q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br></code></pre></td></tr></table></figure><p>è¿™ä¸€éƒ¨åˆ†ç»™å‡ºäº† $18$ ç»„æ•°æ®ã€æ¨¡æ•° $q$ï¼Œæ•°ç»„ $s,t,r$ã€‚ä½†æœªçŸ¥é‡ä¸º $x$ å’Œæ•°ç»„ $b$ã€‚å…¶ä¸­ $q,x$ å‡ä¸º $1024$ æ¯”ç‰¹ï¼Œ$s,t$ å‡ä¸º $544$ æ¯”ç‰¹ï¼Œ $k,b$ å‡ä¸º $480$ æ¯”ç‰¹ã€‚å¾ˆæ˜æ˜¾ä¸€ä¸ªHNPé—®é¢˜ï¼Œå¹¶ä¸”è¿™ä¸ªå¼å­æ˜¯ä¸€çœ¼çœ‹å‡ºæ¥çš„ï¼š<br>$$<br>s_ik_i-t_ib_i\equiv r_ix \pmod q<br>$$<br>å¾ˆæ˜æ˜¾çš„çº¿æ€§å…³ç³»ï¼Œä½†è¿™ä¸ªçŸ©é˜µå±å®ä¸å¥½æ„é€ ã€‚æˆ‘ä¸€å¼€å§‹æŠŠæ‰€æœ‰çš„ $s_i$ å’Œ $b_i$ éƒ½æ”¾åœ¨ä¸€èµ·ï¼Œæ¶ˆ $x$ï¼Œæ„é€ äº†ä¸€ä¸ª $37\times37$ çš„çŸ©é˜µï¼Œä½†å¯¹è§’çº¿ä¸Šå…¨æ˜¯ $1$ï¼ŒåŠ ä¸Š $k,b$ åŒé˜¶ï¼Œä¸éœ€è¦å¹³è¡¡å› å­ï¼ŒçŸ©é˜µçš„è¡Œåˆ—å¼å®Œå…¨è¾¾ä¸åˆ°è¦æ±‚ã€‚</p><p>æœ€åå‚è€ƒäº†<a href="https://blog.csdn.net/qwerzbc66">striving</a>âœŒçš„æ„é€ æ–¹æ³•ï¼šä¿ç•™ $x$ï¼ŒåŒ–ç®€å¼å­ï¼š<br>$$<br>sâ€™_ik_i-r_iâ€™x\equiv b_i \pmod q<br>$$<br>ä¹Ÿå°±æ˜¯<br>$$<br>sâ€™_ik_i-r_iâ€™x-u_iq&#x3D; b_i<br>$$</p><p>å…¶ä¸­ $s_iâ€™&#x3D;\frac{s_i}{t_i},r_iâ€™&#x3D;\frac{r_i}{t_i}$ã€‚æ„é€ çŸ©é˜µå¦‚ä¸‹ï¼ˆä»¥ä¸‰ä¸ªä¸ºä¾‹ï¼‰ï¼š</p><p><img src="/2024/11/20/24Nov3/6.png" alt="6"></p><p>æ ¹æ®strivingçš„æé†’ï¼šæ ¹æ®å¯¹è§’çº¿ç®—ç•Œï¼š$\log_2 q^3&#x3D;3072$ï¼Œ$\log_2\vec v_1&#x3D;(k_1,k_2,k_3,b_1,b_2,b_3)&#x3D;480+\log_2 6&#x3D;482$ï¼Œ$6\log_2 \vec v_1&#x3D;2892&lt;3072$ï¼Œå› æ­¤ç®—æ³•æ˜¯å¯è¡Œçš„ã€‚</p><p>æ‰“å°ä¸€ä¸‹æ¯ä¸€è¡Œçš„nbitsï¼Œå¯ä»¥çœ‹åˆ°ç¬¬äºŒè¡Œæ¸…ä¸€è‰²çš„ $480$ï¼Œè¯´æ˜è¿™å°±æ˜¯æ‰€æ±‚çš„å€¼ï¼Œå¯¹åº”ä¸‹æ ‡ä¸º1</p><p><img src="/2024/11/20/24Nov3/7.png" alt="7"></p><p>ä»£ç ä¹Ÿæ”¾ä¸€ä¸‹ï¼Œæ–¹ä¾¿å¤ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>sdivt=[s[i]*inverse(t[i],q)%q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s))]<br>rdivt=[r[i]*inverse(t[i],q)%q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(r))]<br>M=block_matrix([[identity_matrix(<span class="hljs-built_in">len</span>(s)),diagonal_matrix(ZZ,sdivt)],<br>                [zero_matrix(<span class="hljs-built_in">len</span>(s)),q*identity_matrix(<span class="hljs-built_in">len</span>(s))],<br>                [zero_matrix(<span class="hljs-number">1</span>,<span class="hljs-number">18</span>),Matrix(ZZ,rdivt)]])<br>MLLL=M.LLL()<br></code></pre></td></tr></table></figure><p>æœ‰äº† $k$ å’Œ $b$ï¼Œå°±å¯ä»¥æ±‚å‡º AES çš„å¯†é’¥äº†ã€‚ä¸¤ä¸ªIVåˆ†åˆ«è¯•ä¸€ä¸‹ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¯¹çš„ï¼Œå› æ­¤åŸé¢˜å¾—è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">v=MLLL[<span class="hljs-number">1</span>]<br>v=v*sgn(v[<span class="hljs-number">0</span>])<br>listv=<span class="hljs-built_in">list</span>(v)<br>k=listv[:<span class="hljs-built_in">len</span>(s)]<br>b=listv[<span class="hljs-built_in">len</span>(s):]<br>x=(k[<span class="hljs-number">0</span>]*s[<span class="hljs-number">0</span>]-b[<span class="hljs-number">0</span>]*t[<span class="hljs-number">0</span>])*inverse(r[<span class="hljs-number">0</span>],q)%q <br><span class="hljs-built_in">print</span>(x,k[<span class="hljs-number">0</span>],b[<span class="hljs-number">0</span>])<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>key=sha256(<span class="hljs-built_in">str</span>(<span class="hljs-number">2024</span>*b[<span class="hljs-number">0</span>]+<span class="hljs-number">2023</span>*k[<span class="hljs-number">0</span>]+x).encode()).digest()[:<span class="hljs-number">16</span>]<br>key<br><span class="hljs-comment">#b&#x27;\xe0\x14\x00\x84\xb9\xcd\xa1\t\xec\xa9\x86\x91g\xcb\x8d\x16&#x27;</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>aes = AES.new(key,AES.MODE_CBC,iv=<span class="hljs-string">b&#x27;\x80v\xdd\x87F&#123;\x15\x921\x129!\xf9-\xd3\x9b&#x27;</span>)<br>m=aes.decrypt(cipher)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-comment">#DASCTF&#123;b157059c-2871-421f-8cec-332b617de4d5&#125;\x04\x04\x04\x04</span><br></code></pre></td></tr></table></figure><h3 id="2x04-Part-2-æ¶ˆ-x-åšæ³•"><a href="#2x04-Part-2-æ¶ˆ-x-åšæ³•" class="headerlink" title="2x04 Part 2 æ¶ˆ $x$ åšæ³•"></a>2x04 Part 2 æ¶ˆ $x$ åšæ³•</h3><p>å½“ç„¶ï¼Œæˆ‘ä¸€å¼€å§‹çš„æ€è·¯è¿˜æ˜¯æƒ³æ¶ˆ $x$ï¼Œåœ¨ strivingâœŒçš„æŒ‡ç‚¹ä¸‹ï¼Œæˆ‘å°è¯•äº†ä¸€ä¸‹è¿™ä¸ªçŸ©é˜µï¼š</p><p>ç”±äº<br>$$<br>s_{18}k_{18}-t_{18}b_{18}\equiv r_{18}x\pmod q<br>$$<br>å’Œ<br>$$<br>s_2k_2-t_2b_2\equiv r_2x\pmod q<br>$$<br>å› æ­¤æ¶ˆ $x$ï¼Œæœ‰<br>$$<br>r_2s_{18}k_{18}-r_{18}s_2k_2-r_2t_{18}b_{18}+r_{18}t_2b_{2}\equiv 0\pmod q<br>$$<br>é‚£ä¹ˆå¯ä»¥æœ‰<br>$$<br>b_2&#x3D;\frac{r_2s_{18}k_{18}-r_{18}s_2k_2-r_2t_{18}b_{18}}{r_{18}t_2}-u_2q<br>$$<br>å›ºå®šç¬¬ä¸€ç»„æ•°æ®ï¼Œå°†ä¸Šé¢çš„ $x$ æ¢ä¸º $b_{18}$ï¼Œç„¶åå³è¾¹å‘é‡ä» $b_2$ å¼€å§‹ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ç®—äº†ä¸€ä¸‹ç•Œï¼Œä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚ä½†è€ƒè™‘åˆ°ä»–ç¬¬ä¸€ç»„æ•°æ®ä¸å¯†é’¥æœ‰å…³ï¼Œå› æ­¤è¿™é‡Œå›ºå®šæœ€åä¸€ç»„æ•°æ®ã€‚</p><p>è®¾ $A_i&#x3D;\dfrac{r_is_{18}} {r_{18}t_i},B_i&#x3D;\dfrac{r_{18}s_i} {r_{18}t_i},C_i&#x3D;\dfrac{r_it_{18}} {r_{18}t_i}$ï¼Œæœ€åæ„é€ çš„çŸ©é˜µä¸ºï¼ˆä¸¤ç»„æ•°æ®çš„æƒ…å†µï¼‰</p><p><img src="/2024/11/20/24Nov3/9.png" alt="9"></p><p>è¿™è¾¹çš„ä»£ç æ”¾ä¸€ä¸‹ï¼Œä¸çŸ¥é“ä¸ºå•¥ä¸éœ€è¦åŠ è´Ÿå·ï¼Œå¾ˆå¥‡æ€ªã€‚ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>A=[r[i]*s[-<span class="hljs-number">1</span>]*inverse(r[-<span class="hljs-number">1</span>]*t[i],q)%q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>)]<br>B=[r[-<span class="hljs-number">1</span>]*s[i]*inverse(r[-<span class="hljs-number">1</span>]*t[i],q)%q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>)]<br>C=[r[i]*t[-<span class="hljs-number">1</span>]*inverse(r[-<span class="hljs-number">1</span>]*t[i],q)%q <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>)]<br>M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">35</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">35</span>):<br>    M[i][i]=<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">18</span> <span class="hljs-keyword">else</span> q<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[i][i+<span class="hljs-number">18</span>]=B[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[<span class="hljs-number">17</span>][<span class="hljs-number">18</span>+i]=A[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[-<span class="hljs-number">1</span>][<span class="hljs-number">18</span>+i]=C[i]<br>M=Matrix(ZZ,M)<br>MLLL=M.LLL()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;  &#x27;</span>,end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">35</span>):<br>    <span class="hljs-built_in">print</span>(i%<span class="hljs-number">10</span>,end=<span class="hljs-string">&#x27; &#x27;</span>)<br><span class="hljs-built_in">print</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M.nrows()):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;i%<span class="hljs-number">10</span>&#125;</span> &#x27;</span>,end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M.ncols()):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;X&#x27;</span><span class="hljs-keyword">if</span> M[i][j] <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;.&#x27;</span>,end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(MLLL.nrows()):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(MLLL.ncols()):<br>        <span class="hljs-built_in">print</span>(MLLL[i][j].nbits(),end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br>v=MLLL[<span class="hljs-number">3</span>]<br>v=v*sgn(v[<span class="hljs-number">0</span>])<br>listv=<span class="hljs-built_in">list</span>(v)<br>k=listv[:<span class="hljs-number">18</span>]<br>b=listv[<span class="hljs-number">18</span>:]<br>x=(k[<span class="hljs-number">0</span>]*s[<span class="hljs-number">0</span>]-b[<span class="hljs-number">0</span>]*t[<span class="hljs-number">0</span>])*inverse(r[<span class="hljs-number">0</span>],q)%q<br><span class="hljs-built_in">print</span>(x,k[<span class="hljs-number">0</span>],b[<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure><p>æœ€åç¬¬ 4 ä¸ªå‘é‡ï¼ˆä¸‹æ ‡ä¸º3ï¼‰ä¸ºç­”æ¡ˆï¼Œå¾ˆå¥‡æ€ªã€‚strivingå¸ˆå‚…ä½¿ç”¨çš„ç¬¬ä¸€ç»„æ•°æ®ï¼Œè§£å‡ºæ¥ç¬¬ä¸€ä¸ªå‘é‡å°±æ˜¯ç­”æ¡ˆã€‚ã€‚</p><p>å¾—åˆ°äº†strivingâœŒçš„è§£ç­”ï¼šæ„å»ºå¯¹è§’+æ–¹é˜µè¿™æ ·ä¼šå¥½ä¸€ç‚¹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä¸Šé¢çš„é‚£ä¸ªæœ€åä¸€è¡Œè¢«ç§»åˆ°äº†ç¬¬ä¸€è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">36</span>):<br>    M[i][i]=<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> i&lt;=<span class="hljs-number">18</span> <span class="hljs-keyword">else</span> q<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[i+<span class="hljs-number">1</span>][i+<span class="hljs-number">19</span>]=B[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[<span class="hljs-number">18</span>][<span class="hljs-number">19</span>+i]=A[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):<br>    M[<span class="hljs-number">0</span>][<span class="hljs-number">19</span>+i]=C[i]<br></code></pre></td></tr></table></figure><h2 id="3-N1CTF2021-n1token-1"><a href="#3-N1CTF2021-n1token-1" class="headerlink" title="3.[N1CTF2021]n1token-1"></a>3.[N1CTF2021]n1token-1</h2><h3 id="3x01-é¢˜ç›®å¤§æ„"><a href="#3x01-é¢˜ç›®å¤§æ„" class="headerlink" title="3x01 é¢˜ç›®å¤§æ„"></a>3x01 é¢˜ç›®å¤§æ„</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gettoken</span>(<span class="hljs-params">c</span>):<br>    X = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> ((<span class="hljs-built_in">pow</span>(X, (p-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>, p)!=<span class="hljs-number">1</span>) <span class="hljs-keyword">or</span> (<span class="hljs-built_in">pow</span>(X, (q-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>, q)!=<span class="hljs-number">1</span>)):<br>        X = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> X.bit_length() &lt; <span class="hljs-number">920</span>:<br>            X *= random.choice(primes)<br>    xp = <span class="hljs-built_in">pow</span>(X, (p + <span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, p)<br>    xq = <span class="hljs-built_in">pow</span>(X, (q + <span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, q)<br>    xp = random.choice([xp,-xp%p])<br>    xq = random.choice([xq,-xq%q])<br>    x = c * (xp*inverse(q,p)*q + xq*inverse(p,q)*p) % n<br>    <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getmyPrime</span>(<span class="hljs-params">nbits</span>):<br>    p = getPrime(nbits)<br>    <span class="hljs-keyword">while</span>(p%<span class="hljs-number">4</span>==<span class="hljs-number">1</span>):<br>        p = getPrime(nbits)<br>    <span class="hljs-keyword">return</span> p<br><br>primes = random.sample(sieve_base, <span class="hljs-number">920</span>)<br>p = getmyPrime(<span class="hljs-number">512</span>)<br>q = getmyPrime(<span class="hljs-number">512</span>)<br>e = <span class="hljs-number">65537</span><br>n = p*q<br>c = <span class="hljs-built_in">pow</span>(bytes_to_long(flag), e, n)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-string">&quot;n = &quot;</span> + <span class="hljs-built_in">str</span>(n) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>):<br>        f.write(<span class="hljs-string">&quot;Token #&quot;</span>+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;: &#x27;</span>+<span class="hljs-built_in">str</span>(gettoken(c))+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-comment">#æœ€åç»™å‡ºäº†920ç»„æ•°æ®</span><br></code></pre></td></tr></table></figure><h3 id="3x02-Easyçš„Part-1"><a href="#3x02-Easyçš„Part-1" class="headerlink" title="3x02 Easyçš„Part 1"></a>3x02 Easyçš„Part 1</h3><p>é¢˜ç›®åªç»™å‡ºäº† $n,e$ï¼Œ$c$ æ²¡æœ‰ç»™å‡ºã€‚ä½†é¢˜ç›®ç»™å‡ºäº† $t_i&#x3D;cx_i$ å€¼ï¼Œå…¶ä¸­ $X&#x3D;x^2\pmod n$ï¼Œä¸” $X$ ä¸º $920$ ä½å…‰æ»‘æ•°å­—ã€‚å› æ­¤å¯ä»¥å¾—åˆ°<br>$$<br>t_i^2c^{-2}-k_in&#x3D;X_i<br>$$<br>å¾ˆæ˜æ˜¾çš„LLLï¼Œç›´æ¥ä¸€æŠŠæ¢­ï¼Œæ±‚å‡ºäº†æ‰€æœ‰ $X$ï¼Œå¹¶å¾—åˆ°äº† $c^2$ã€‚è¿™ä¸ªæˆ‘å¾ˆå®¹æ˜“çœ‹å‡ºæ¥äº†ï¼Œé‚£ä¸ªçœ‹ç€å¤æ‚çš„å¼å­ï¼Œåªä¸è¿‡æ˜¯åœ¨çŸ¥é“ $n$ åˆ†è§£æ—¶ï¼Œé€šè¿‡CRTæ±‚ $\sqrt x\pmod n$ï¼Œ$p\equiv 3\pmod 4$ çš„ç´ æ•°å¯ä»¥ç”¨å…¬å¼å¼€å¹³æ–¹ã€‚</p><p>çŸ©é˜µæ„é€ åœ¨è¿™é‡Œï¼Œè¿™ä¸ªå…¶å®å¾ˆç®€å•ï¼Œwpç”¨äº† $64$ ç»„ï¼Œæˆ‘ç”¨äº† $50$ ç»„ä¹Ÿèƒ½å‡ºã€‚</p><p><img src="/2024/11/20/24Nov3/10.png" alt="10"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>tokens=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).readlines()<br>tokens.pop(<span class="hljs-number">0</span>)<br>n=<span class="hljs-number">68512262030092235082955402685415541014208343583540436164257874839232436153071370815269154345614809159891073442197732980480807167946204103083844856370368201582809851941837996671056932696292853288793127100756079130455873788646267803515293475609923615566516458978625901881951403282617405981962778117066458607117</span><br>tokens=[<span class="hljs-built_in">int</span>(tokens[i].split(<span class="hljs-string">&#x27;:&#x27;</span>)[<span class="hljs-number">1</span>])<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>)]<br>tokens2=[i*i%n <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tokens]<br>M=block_matrix(ZZ,<br>[[Matrix(tokens2[:<span class="hljs-number">50</span>])],<br>[identity_matrix(<span class="hljs-number">50</span>)*n]])<br><br>MLLL=M.LLL()<br>lgMLLL=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>)]<span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">51</span>)]<br>Xarr=<span class="hljs-built_in">list</span>(MLLL[<span class="hljs-number">1</span>])<br><span class="hljs-comment">#print(Xarr)</span><br>C2=tokens2[<span class="hljs-number">0</span>]*inverse(Xarr[<span class="hljs-number">0</span>],n)%n<br><span class="hljs-comment">#print(C2)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>,<span class="hljs-number">920</span>):<br>    Xarr.append(tokens2[i]*inverse(C2,n)%n)<br></code></pre></td></tr></table></figure><p>ç„¶åå‘¢ï¼Ÿæˆ‘ä»¬è¦æ±‚çš„æ˜¯ $c$ å•Šã€‚</p><p>è€ƒè™‘åˆ° $X$ çš„å…‰æ»‘ï¼Œæˆ‘ä»¬æ‰“ç®—åˆ†è§£æ¯ä¸€ä¸ª $X$ï¼Œå¹¶å°†å…¶ä¿å­˜èµ·æ¥ã€‚å› ä¸ºç´ æ•°æ˜¯ $920$ ä¸ªï¼Œ$X$ ä¹Ÿæ˜¯ $920$ ä¸ªï¼Œå¯ä»¥ç›´æ¥factorï¼Œè·å–å› å­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">FactXarr=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (<span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>)):<br>    FactXarr.append(<span class="hljs-built_in">list</span>(factor(Xarr[i])))<br>primeset=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>):<br>    <span class="hljs-keyword">for</span> j,_ <span class="hljs-keyword">in</span> FactXarr[i]:<br>        primeset.append(j)<br>primeset=<span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(primeset)))<br>indexdic=&#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>):<br>    indexdic[primeset[i]]=i<br></code></pre></td></tr></table></figure><p> ç„¶åæˆ‘å°±è¢«å¡ä½äº†ã€‚ã€‚</p><h3 id="3x03-Toughçš„Part-2"><a href="#3x03-Toughçš„Part-2" class="headerlink" title="3x03 Toughçš„Part 2"></a>3x03 Toughçš„Part 2</h3><p>ç„ä¸€ä¸‹<a href="https://www.anquanke.com/post/id/261215#h2-9">wp</a>ï¼š</p><blockquote><p>WP:</p><p>è‹¥ $x^2\equiv y^2 \pmod n$ï¼Œåˆ™ $x&#x3D;ky\pmod n$ï¼Œå…¶ä¸­ $k^2\equiv 1\pmod n$ã€‚</p><p>ä¹Ÿå°±æ˜¯ $(k+1)(k-1)\equiv 0\pmod n$ï¼Œå³ $(k+1)(k-1)&#x3D;gn$ã€‚å¦‚æœ $k$ ä¸ä¸º $1$ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½é€šè¿‡å…¬å› æ•°åˆ†è§£ $n$ï¼Œè¿™é‡Œ $\gcd(k+1,n)&#x3D;p,\gcd(k-1,n)&#x3D;q$ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬è¦æ±‚ä¸€ä¸ª $k$ æ¥åˆ†è§£ $n$ã€‚</p><p>å¦‚æœæˆ‘ä»¬ä»å…¶ä¸­é€‰å– $w$ ä¸ªè¡¨è¾¾å¼ç›¸ä¹˜ï¼Œå½“$w$ä¸ºå¶æ•°æ—¶ï¼Œé‚£ä¹ˆåŒä½™å¼å·¦è¾¹ç”± $t_i^2$ç´¯ä¹˜å¾—åˆ°çš„é¡¹å¯ä»¥çœ‹æˆ$(t_0 * t_1 * â€¦ * t_w)^2$ï¼ŒåŒä½™å¼å³è¾¹ç”±$c^2$ç´¯ä¹˜å¾—åˆ°çš„é¡¹å¯ä»¥çœ‹æˆ$(c^w)^2$ï¼Œå½“å‰©ä¸‹çš„è¿™$w$ä¸ª$X_i$ç›¸ä¹˜å¾—åˆ°çš„é¡¹ä¹Ÿå¯ä»¥å†™ä¸ºä¸€ä¸ªé¡¹çš„å¹³æ–¹æ—¶ï¼Œæˆ‘ä»¬å³æ„é€ å‡ºäº†ä¸€ä¸ªä¸Šé¢æ‰€æåˆ°çš„åˆ†è§£$n$æ‰€éœ€çš„è¡¨è¾¾å¼ï¼Œç”±äºè¿™é‡Œ$t_i$ã€$X_i$å’Œ$c^2$åœ¨æ¨¡$n$ä¸‹çš„å€¼æˆ‘ä»¬å‡å·²çŸ¥ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¡ç®—å‡º$k$çš„å€¼ï¼Œç»§è€ŒæŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•åˆ†è§£$n$ï¼Œå› æ­¤æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€ä»è¿™920ç»„æ•°æ®å½“ä¸­æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„$w$ç»„å³å¯ã€‚</p><p>ä¸ºäº†æ‰¾åˆ°è¿™æ ·çš„$w$ç»„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¯ä¸ª$X_i$å±•å¼€ä¸ºè‹¥å¹²ç´ æ•°$prime_i$ä¹˜ç§¯çš„å½¢å¼ï¼Œç„¶åè®°å½•ä¸‹æ¯ä¸ª$prime_i$çš„æŒ‡æ•°çš„å¥‡å¶æ€§ï¼Œè¿™æ ·ä¸€æ¥å¯ä»¥å°†å…¶çœ‹ä½œä¸€ä¸ªGF(2)ä¸Šçš„920ç»´è¡Œå‘é‡ï¼Œç”±äºæˆ‘ä»¬æœ‰920ç»„æ•°æ®ï¼Œå› æ­¤å¯ä»¥åˆ—å‡ºä¸€ä¸ª920 * 920çš„çŸ©é˜µï¼Œè¿™æ ·ä¸€æ¥å¯»æ‰¾è‹¥å¹²$X_i$ç›¸ä¹˜çš„ç»“æœå…¶æŒ‡æ•°ä¸ºå¶æ•°çš„é—®é¢˜å°±è½¬åŒ–ä¸ºäº†å¯»æ‰¾è‹¥å¹²$prime_i$å…¶æŒ‡æ•°ä¹‹å’Œåœ¨GF(2)ä¸‹ä¸º0çš„é—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬ç›´æ¥å¯¹è¯¥çŸ©é˜µæ±‚left kernel matrixå³å¯ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°è‹¥å¹²ç»„$res$å‘é‡ï¼Œå…¶ä¸­æ¯ä¸€ä¸ª$res$å‘é‡ä¸­å€¼ä¸º1çš„ä¸‹æ ‡å¯¹åº”ç€æˆ‘ä»¬çš„920ç»„æ•°æ®å½“ä¸­åº”å½“é€‰å–çš„$X_i$çš„ä¸‹æ ‡ï¼ŒåŒæ—¶ä¸ºäº†ä¿è¯$w$ä¸ºå¶æ•°ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é€‰æ‹©$res$å‘é‡ä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°çš„å‘é‡ï¼Œåœ¨æœ¬é¢˜çš„æ•°æ®ä¸­ï¼Œæˆ‘ä»¬ä¸€å…±å¾—åˆ°äº†ä¸¤ç»„$res$å‘é‡ï¼Œå…¶ä¸­ä¸€ç»„ä¸­1çš„ä¸ªæ•°ä¸ºå¥‡æ•°ã€ä¸€ç»„ä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°ï¼Œæˆ‘ä»¬é€‰æ‹©å¶æ•°è¿™ç»„å³å¯ï¼Œç„¶åæŒ‰ç…§ä¸Šè¿°è¿‡ç¨‹è®¡ç®—å‡º$k$ï¼Œæ—¢è€Œå³å¯åˆ†è§£$N$æ±‚å‡ºç§é’¥$d$ã€‚</p></blockquote><p>è²Œä¼¼æœ‰é“ç†ï¼Œä½†è¿™æ˜¯å•¥æ„æ€å‘¢ï¼Ÿ</p><p>ç®—äº†ï¼Œå…ˆæ ¹æ®wpåšä¸€ä¸‹ã€‚å•Šï¼Ÿè¢«åˆ†è§£å‡ºæ¥äº†å—ï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">PM=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>)):<br>    cpm=[<span class="hljs-number">0</span>]*<span class="hljs-number">920</span><br>    <span class="hljs-keyword">for</span> j,k <span class="hljs-keyword">in</span> FactXarr[i]:<br>        cpm[indexdic[j]]=k<br>    PM.append(cpm)<br>PM2=Matrix(GF(<span class="hljs-number">2</span>),PM)<br>PM=Matrix(ZZ,PM)<br><span class="hljs-built_in">print</span>(PM2.rank())<br><span class="hljs-comment">#918</span><br>PM2K=PM2.left_kernel()<br>judgvec=<span class="hljs-built_in">list</span>(PM2K[<span class="hljs-number">2</span>])<br>cnt=judgvec.count(<span class="hljs-number">1</span>)<br>Xpro,Tpro=<span class="hljs-number">1</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">920</span>):<br>    <span class="hljs-keyword">if</span>(judgvec[i]):<br>        Xpro=Xpro*Xarr[i]<br>        Tpro=Tpro*tokens[i]<br><span class="hljs-keyword">assert</span> Xpro.is_square()<br>Xprosq=Xpro.nth_root(<span class="hljs-number">2</span>)<br>k = (((Tpro * inverse_mod(Xprosq, n)) % n) * <span class="hljs-built_in">pow</span>(C2, -(cnt // <span class="hljs-number">2</span>), n)) % n<br><span class="hljs-built_in">print</span>(GCD(<span class="hljs-built_in">int</span>(k-<span class="hljs-number">1</span>),n))<br><span class="hljs-comment">#7066689880579369785256516192953365235434055150846536631329529038878914448897380081597992569628631985623841078424106593028009177867365917709699457885163883</span><br></code></pre></td></tr></table></figure><p>ä¸¤ä¸ªå¹³æ–¹ç›¸ç­‰ï¼Œå“ªä¸¤ä¸ªç›¸ç­‰å•Šï¼Ÿä¸€ä¸ªå°æ—¶çš„ä¹±æåï¼Œæˆ‘å¾—åˆ°äº†ç­”æ¡ˆï¼š<br>$$<br>\prod_{\mathrm{judgvec}[i]&#x3D;1} t_i^2\equiv \prod_{\mathrm{judgvec}[i]&#x3D;1}X_ic^{2\sum\mathrm{judgvec}} \pmod n<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">Tpro**<span class="hljs-number">2</span>%n==(Xpro*<span class="hljs-built_in">pow</span>(C2,cnt,n))%n <span class="hljs-comment">#cnt=judgvec.count(1)</span><br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure><p>å†å›é¡¾è¿‡ç¨‹ï¼šçŸ©é˜µ <code>PM</code> ä¸­å­˜æ”¾çš„æ˜¯æ¯ä¸ª $X$ å¯¹åº”çš„ç´ æ•°çš„æŒ‡æ•°ï¼Œ<code>PM[i][j]</code> è¡¨ç¤º $X_i$ çš„åˆ†è§£ä¸­ç¬¬ $j$ ä¸ªç´ æ•°çš„æŒ‡æ•°ï¼Œå¯¹ <code>PM</code> çŸ©é˜µå…¨ä½“æ¨¡ $2$ï¼Œå°±å¯ä»¥æœ‰æ¯ä¸ªæŒ‡æ•°æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°ã€‚åœ¨ <code>PM2=GF(2)(PM)</code> ä¸‹æ±‚left kernelï¼Œå°±æ˜¯æ±‚æ»¡è¶³æ¡ä»¶çš„ $\vec v&#x3D;(v_0,v_1,â€¦,v_{919})$ï¼Œä½¿å¾— $\pi_{i&#x3D;0}^{919}  X_i^{v_i}$ æ˜¯ä¸€ä¸ªå¹³æ–¹æ•°ã€‚ç„¶åå°±å›åˆ°äº† WP ä¸­çš„è¿™å¥è¯ï¼š</p><blockquote><p>å¦‚æœæˆ‘ä»¬ä»å…¶ä¸­é€‰å– $w$ ä¸ªè¡¨è¾¾å¼ç›¸ä¹˜ï¼Œå½“$w$ä¸ºå¶æ•°æ—¶ï¼Œé‚£ä¹ˆåŒä½™å¼å·¦è¾¹ç”± $t_i^2$ç´¯ä¹˜å¾—åˆ°çš„é¡¹å¯ä»¥çœ‹æˆ$(t_0 * t_1 * â€¦ * t_w)^2$ï¼ŒåŒä½™å¼å³è¾¹ç”±$c^2$ç´¯ä¹˜å¾—åˆ°çš„é¡¹å¯ä»¥çœ‹æˆ$(c^w)^2$ï¼Œå½“å‰©ä¸‹çš„è¿™$w$ä¸ª$X_i$ç›¸ä¹˜å¾—åˆ°çš„é¡¹ä¹Ÿå¯ä»¥å†™ä¸ºä¸€ä¸ªé¡¹çš„å¹³æ–¹æ—¶ï¼Œæˆ‘ä»¬å³æ„é€ å‡ºäº†ä¸€ä¸ªä¸Šé¢æ‰€æåˆ°çš„åˆ†è§£$n$æ‰€éœ€çš„è¡¨è¾¾å¼ï¼Œç”±äºè¿™é‡Œ$t_i$ã€$X_i$å’Œ$c^2$åœ¨æ¨¡$n$ä¸‹çš„å€¼æˆ‘ä»¬å‡å·²çŸ¥ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¡ç®—å‡º$k$çš„å€¼ï¼Œç»§è€ŒæŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•åˆ†è§£$n$ï¼Œå› æ­¤æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€ä»è¿™920ç»„æ•°æ®å½“ä¸­æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„$w$ç»„å³å¯ã€‚</p></blockquote><p>éªŒè¯ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">Xpro.is_square()<br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure><p>çœ‹æ¥æ²¡é—®é¢˜äº†ã€‚è®¾è¿™ä¸ª $X_{pro}&#x3D;a^2$ï¼Œè¿™è¾¹left kernelä¿è¯ $X$ çš„åˆ†è§£çš„æŒ‡æ•°éƒ½æ˜¯å¶æ•°ï¼ˆå› ä¸ºå–æ¨¡åŸå› ï¼Œ$X$ æ˜¯æ¨¡ $n$ çš„äºŒæ¬¡å‰©ä½™ï¼Œä½† $X$ çš„åˆ†è§£æŒ‡æ•°ä¸å…¨ä¸ºå¶æ•°ï¼Œæ˜¯å› ä¸ºéƒ¨åˆ†å¥‡æ•°å¯ä»¥ä¸ºäºŒæ¬¡å‰©ä½™ï¼‰ã€‚åˆå› ä¸º $t^2\equiv Xc^2\pmod n$ï¼Œå› æ­¤ $T_{pro}^2&#x3D;X_{pro}c^{2w}$ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ä¸¤è¾¹å¼€æ ¹ï¼š<br>$$<br>T_{pro}&#x3D;ac^{w}<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">Xprosq.is_square()<br><span class="hljs-comment">#False</span><br></code></pre></td></tr></table></figure><p>OKï¼Œè¿™ä¸‹çœ‹çœ‹ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä»€ä¹ˆï¼Ÿ<br>$$<br>T^2_{pro}&#x3D;a^2c^{2w}<br>$$<br>ä¸¤ä¸ªå¹³æ–¹ç›¸ç­‰ï¼</p><p>å¼€æ ¹æµ‹ä¸€ä¸‹ï¼šä¸¤ä¸ªå¹³æ–¹æ¨¡ $n$ ç›¸ç­‰ï¼Œä½†å¼€æ–¹åä¸ç­‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">Tpro**<span class="hljs-number">2</span>%n==(Xpro*<span class="hljs-built_in">pow</span>(C2,cnt,n))%n <span class="hljs-comment">#cnt=judgvec.count(1)</span><br><span class="hljs-comment">#True</span><br>Tpro%n==Xprosq*<span class="hljs-built_in">pow</span>(C2,cnt//<span class="hljs-number">2</span>,n)%n<br><span class="hljs-comment">#False</span><br></code></pre></td></tr></table></figure><p>å› æ­¤ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æ‰€éœ€è¦çš„ $k\equiv \dfrac{a}{c^{2(w&#x2F;2)}}$ã€‚å› ä¸º $c^2$ æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œæ‰€ä»¥ $w$ è¦ä¿è¯æ˜¯å¶æ•°æ‰å¯è¡Œã€‚è¿™æ ·æ€è·¯ç»ˆäºå’ŒWPé—­ç¯äº†ã€‚ã€‚ã€‚</p><h3 id="3x04-å®Œç»“æ’’èŠ±"><a href="#3x04-å®Œç»“æ’’èŠ±" class="headerlink" title="3x04 å®Œç»“æ’’èŠ±"></a>3x04 å®Œç»“æ’’èŠ±</h3><p>åˆ†è§£ $n$ ä¹‹åï¼Œå…ˆç”¨CRTå¯¹ $c^2$ å¼€æ ¹ï¼Œå¾—åˆ°å››ä¸ªå¯èƒ½çš„ç»“æœã€‚ç„¶ååˆ†åˆ«RSAè§£å¯†ï¼Œæ‰¾åˆ°flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">p,q=GCD(<span class="hljs-built_in">int</span>(k-<span class="hljs-number">1</span>),n),GCD(<span class="hljs-built_in">int</span>(k+<span class="hljs-number">1</span>),n)<br><span class="hljs-keyword">assert</span> p <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,n] <span class="hljs-keyword">and</span> q <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,n] <span class="hljs-keyword">and</span> p!=q<br>carr=[]<br>cp=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(C2,(p+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,p))<br>cq=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(C2,(q+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,q))<br><span class="hljs-keyword">for</span> sp <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]:<br>    <span class="hljs-keyword">for</span> sq <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>]:<br>        carr.append(crt([cp*sp,cq*sq],[p,q]))<br><span class="hljs-built_in">print</span>(carr)<br>d=inverse(<span class="hljs-number">65537</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> carr:<br>    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">[46630614291745334334152762312676921133624051168940817865903892997090214159501097997241603185344424810227360569767886901658508914717819387760635901824660947938796941642460399170111143796793156856634009422349818143947262685178807938549388138287681555995508698977295037594135656538624892517735216104401235804978, 19703989276128579847076476848899002659695039512136459426637790674933329268053509523645116022627877355721599775333883095285751759221736313984198660551863329947412556215691527518951119591197450423277438733191151653085195488305757310694499293449100108574981362635828059309918833297115589471736564051849673468541, 48808272753963655235878925836516538354513304071403976737620084164299106885017861291624038322986931804169473666863849885195055408724467789099646195818504871635397295726146469152105813105095402865515688367564927477370678300340510492820794182160823506991535096342797842572032569985501816510226214065216785138576, 21881647738346900748802640372738619880584292414599618298353981842142221993570272818027551160270384349663712872429846078822298253228384715323208954545707253644012910299377597500945788899499696432159117678406260986508611103467459864965905337322242059571007760001330864287815746743992513464227562012665222802139]</span><br><span class="hljs-string">b&#x27;2v\xa7F0aU\xdaJK\x1e\xff\r!&gt;\x84\xf3\xe3\xe5sC\xd6\xa2\x8a-vJ\xe15g\xf0\xcb-^g\xaeJ\x05o.N\xd2\xb1\x12\x06\xe0\x05\xf9\xcc\x0f\xcf\xac(\x1d\x9c\\\xfcz\xe9\xf4\x04\x99V[\x98\xc7\xeb(\xfe\xa1X\x1a\x89\xaa\x17,\xf7\xc9d\x069\xb3\x1d\x0chd\x9d6Z\xdaT\xf8\xba1\x16\xf8&#123;Z\xb3D\xd9\x05\xf8\xb8E\xb8\xd75V\xcc-\x80al\xc3\xf2\xd6.\xcaNt\xfa\xed\x83\x14T\xb3\xe1&#x27;</span><br><span class="hljs-string">b&#x27;n1ctf&#123;b9e7d419-0df8-438a-9120-efdf3ddf155f&#125;&#x27;</span><br><span class="hljs-string">b&quot;a\x90\x90(K\xa8\x92&amp;\x82\x8f6\xdf\x86^\xa8p\x94\xf9^@wR\x08-g\xc19\x90\xae\x02\xfdQ\x1a\xb21U^(\xe0]9\n\xba\x86\xc1z!\xf1M\xc1\xa1\xcc\xb9~m:w\x0e\xf5\xe2s-\x83\xb0\xb0H^\xed\xe1H\xd5\x83yHp\xcf\x15\xed\xc6\xd8\xf1S\xf1B\xb2\xc1\xce!\xc0\x01\xbc\x82:0\xdd\xdfLy\xe3\xedJ\x9b\x0b\x14\xa0t\xef \x15\x02\xd8O\xfe\x8a&#x27;&#125;3\x96\xc1\xbf\xef\x01\xcf\xf4\xb4\xa1\xc7\x90&quot;</span><br><span class="hljs-string">b&#x27;/\x19\xe8\xe2\x1bG&lt;L8D\x17\xe0y=i\xeb\xa1\x15x\xcd3&#123;e\xa3:J\xee\xafx\x9b\x0c\x85\xedS\xc9\xa7\x14#q.\xea8\tt\xba\x9a\x1b\xf7\x81\xb1\xd2 \x91`\xd0\xddz\x94\x0b\xeen\x94-U\x17\x80s\xc4\xe2\xa7&#125;h\xef\x9eY\xa2\x1e$b\xd2\xb7\xa0\xd46J\xcbbN\xd9\x8d\xe2\xeb\xb9d\xfeK\x05Pi\xd5\xa1\xf9x\x94\x87\xf0K#\x1fc\xe4\x00\xcfM\x90\xef\xc3\xcc]\xa4\xdekH\xa2\xd5\x82z,&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>flagï¼š<code>n1ctf&#123;b9e7d419-0df8-438a-9120-efdf3ddf155f&#125;</code></p><h2 id="4-å¼ºç½‘æ¯2024-traditional-game"><a href="#4-å¼ºç½‘æ¯2024-traditional-game" class="headerlink" title="4.[å¼ºç½‘æ¯2024]traditional game"></a>4.[å¼ºç½‘æ¯2024]traditional game</h2><h3 id="4x01-é¢˜ç›®å¤§æ„"><a href="#4x01-é¢˜ç›®å¤§æ„" class="headerlink" title="4x01 é¢˜ç›®å¤§æ„"></a>4x01 é¢˜ç›®å¤§æ„</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime,bytes_to_long<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> secret,flag<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> signal<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_timeout</span>(<span class="hljs-params">signum, frame</span>):<br>    <span class="hljs-keyword">raise</span> TimeoutError(<span class="hljs-string">&#x27;function timeout&#x27;</span>)<br><br>timeout = <span class="hljs-number">300</span><br>signal.signal(signal.SIGALRM, _handle_timeout)<br>signal.alarm(timeout)<br><br>random.seed(secret + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time())).encode())<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RSA</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.p = getPrime(<span class="hljs-number">512</span>)<br>        <span class="hljs-variable language_">self</span>.q = getPrime(<span class="hljs-number">512</span>)<br>        <span class="hljs-variable language_">self</span>.e = getPrime(<span class="hljs-number">128</span>)<br>        <span class="hljs-variable language_">self</span>.n = <span class="hljs-variable language_">self</span>.p * <span class="hljs-variable language_">self</span>.q<br>        <span class="hljs-variable language_">self</span>.phi = (<span class="hljs-variable language_">self</span>.p - <span class="hljs-number">1</span>) * (<span class="hljs-variable language_">self</span>.q - <span class="hljs-number">1</span>)<br>        <span class="hljs-variable language_">self</span>.d = <span class="hljs-built_in">pow</span>(<span class="hljs-variable language_">self</span>.e, -<span class="hljs-number">1</span>, <span class="hljs-variable language_">self</span>.phi)  <br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_pub</span> lic_key(<span class="hljs-variable language_">self</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">self</span>.n, <span class="hljs-variable language_">self</span>.e)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_private_key</span>(<span class="hljs-params">self, blind_bit=<span class="hljs-literal">None</span>, unknown_bit=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-keyword">if</span> blind_bit <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> unknown_bit <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            blind = getPrime(blind_bit)<br>            d_ = ((<span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.d &gt;&gt; unknown_bit) // blind * blind) &lt;&lt; unknown_bit) + <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.d % blind)<br>            <span class="hljs-keyword">return</span> (d_, blind)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">self</span>.d, <span class="hljs-number">0</span>)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self, m</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(m) == <span class="hljs-built_in">bytes</span>:<br>            m = bytes_to_long(m)<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(m) == <span class="hljs-built_in">str</span>:<br>            m = bytes_to_long(m.encode())<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(m, <span class="hljs-variable language_">self</span>.e, <span class="hljs-variable language_">self</span>.n)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">game</span>(<span class="hljs-params">self,m0,m1,b</span>):   <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.encrypt([m0,m1][b]) <br><br><br>rsa = RSA()<br>token = os.urandom(<span class="hljs-number">66</span>) <br><br><span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;[+] Welcome to the game!&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] rsa public key: <span class="hljs-subst">&#123;rsa.get_public_key()&#125;</span>&quot;</span>)<br><br>coins = <span class="hljs-number">100</span><br>price = <span class="hljs-number">100</span><br><span class="hljs-keyword">while</span> coins &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=================================&quot;</span>)<br>    b = random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)<br>    c = rsa.game(<br>        <span class="hljs-string">b&#x27;bit 0:&#x27;</span> + os.urandom(<span class="hljs-number">114</span>), <br>        <span class="hljs-string">b&#x27;bit 1:&#x27;</span> + os.urandom(<span class="hljs-number">114</span>), <br>        b)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] c:&quot;</span>,c)<br>    guessb = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[-] b:&quot;</span>))<br>    coins -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> guessb == b:<br>        price -= <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] correct!&quot;</span>) <br>    <span class="hljs-keyword">else</span>: <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] wrong!&quot;</span>) <br><br><span class="hljs-keyword">if</span> price != <span class="hljs-number">0</span>: <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] game over!&quot;</span>)<br>    exit()<br><br>blind_bit = <span class="hljs-number">40</span><br>unknown_bit = <span class="hljs-number">365</span><br><br>d_,blind = rsa.get_private_key(blind_bit, unknown_bit)<br><br><span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;[+] Now, you have permission to access the privkey!&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] privkey is: (<span class="hljs-subst">&#123;d_&#125;</span>,<span class="hljs-subst">&#123;blind&#125;</span>).&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] encrypt token is: <span class="hljs-subst">&#123;rsa.encrypt(bytes_to_long(token))&#125;</span>&quot;</span>)<br><br>guess_token = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[-] guess token:&quot;</span>))<br><span class="hljs-keyword">if</span> guess_token == token:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] correct token, here is your flag:&quot;</span>,flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] wrong token&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®è¿˜æ˜¯åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåé¢ä¸€æ­¥ä¸€æ­¥åœ°æ¥çœ‹ã€‚</p><h3 id="4x02-Part-1"><a href="#4x02-Part-1" class="headerlink" title="4x02 Part 1"></a>4x02 Part 1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">coins = <span class="hljs-number">100</span><br>price = <span class="hljs-number">100</span><br><span class="hljs-keyword">while</span> coins &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=================================&quot;</span>)<br>    b = random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)<br>    c = rsa.game(<br>        <span class="hljs-string">b&#x27;bit 0:&#x27;</span> + os.urandom(<span class="hljs-number">114</span>), <br>        <span class="hljs-string">b&#x27;bit 1:&#x27;</span> + os.urandom(<span class="hljs-number">114</span>), <br>        b)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] c:&quot;</span>,c)<br>    guessb = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;[-] b:&quot;</span>))<br>    coins -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> guessb == b:<br>        price -= <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] correct!&quot;</span>) <br>    <span class="hljs-keyword">else</span>: <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] wrong!&quot;</span>) <br><br><span class="hljs-keyword">if</span> price != <span class="hljs-number">0</span>: <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] game over!&quot;</span>)<br>    exit()<br><br>blind_bit = <span class="hljs-number">40</span><br>unknown_bit = <span class="hljs-number">365</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸€éƒ¨åˆ†æ˜¯åŒºåˆ†ä¸¤ä¸ªå€¼çš„ç‰¹å®šæ¯”ç‰¹ã€‚ä¸æ˜¯ï¼Œå°±å‰é¢ä¸¤ä¸ªä¸€æ ·ï¼Œåé¢ $912$ ä½éƒ½ä¸ä¸€æ ·ï¼Œè¿™è¿˜èƒ½åŒºåˆ†ï¼Ÿ</p><p>ç„¶åå½“æ—¶åœ¨é‚£è¾¹æƒ³äº†åŠå¤©ï¼Œæ¯”èµ›çš„æ—¶å€™å®åœ¨æ²¡æƒ³å‡ºæ¥æ€ä¹ˆæè¿™ä¸ªã€‚èµ›åé—®äº†å…¶ä»–çš„å¸ˆå‚…ï¼š</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs dns">Dialog huangx607087-DeeBaTo<br><br>huangx6<span class="hljs-number">07087 2024</span>/<span class="hljs-number">11/7 17:29</span>:<span class="hljs-number">09</span><br>å¸ˆå‚…åœ¨å—ï¼Ÿæƒ³é—®é—®ä½ é‚£è¾¹æœ‰æ— å‰å‡ å¤©å¼ºç½‘æ¯çš„wpï¼Œä¹‹å‰çœ‹äº†recå¸ˆå‚…å¯¹é‚£ä¸ªtraditional gameçš„ç¬¬ä¸€é—®ä¹Ÿæ˜¯å¼€ä¸¤ä¸ªè¿›ç¨‹ï¼ŒåŒæ—¶è¿æ¥å®¹å™¨ï¼Œå»è·å¾—åŒæ ·çš„éšæœºæ•°ç§å­åšçš„ï¼Œæˆ‘å¾ˆå¥½å¥‡é‚£ä¸ªé¢˜ç¬¬ä¸€é—®çš„æ­£ç¡®åšæ³•ã€‚<br><br>DeeBaTo <span class="hljs-number">2024/11/7</span> <span class="hljs-number">17</span>:<span class="hljs-number">29</span>:<span class="hljs-number">22</span><br>å°±æ˜¯è¿™ä¸ª<br><br>DeeBaTo <span class="hljs-number">2024/11/7</span> <span class="hljs-number">17</span>:<span class="hljs-number">29</span>:<span class="hljs-number">34</span><br>ç½‘ç»œåè®®é‡Œçš„åå°„æ”»å‡»<br><br>Dialog huangx607087-rec<br><br>rec <span class="hljs-number">2024/11/7</span> <span class="hljs-number">17</span>:<span class="hljs-number">32</span>:<span class="hljs-number">39</span><br>ä¸Šä¸ªæœˆblackhatæˆ‘å’Œä»–ä¸€èµ·æ‰“çš„<br><br>rec <span class="hljs-number">2024/11/7</span> <span class="hljs-number">17</span>:<span class="hljs-number">32</span>:<span class="hljs-number">43</span><br>æœ‰ä¸ªé¢˜å°±æ˜¯è¿™æ ·<br><br></code></pre></td></tr></table></figure><p>ï¼Ÿï¼Ÿï¼Ÿå¥½å®¶ä¼™ï¼Œå¥‡æ€ªçš„çŸ¥è¯†å¢åŠ äº†ã€‚æ‰€ä»¥å¼€ä¸¤ä¸ªè¿›ç¨‹ï¼Œç„¶ååŒæ—¶è¿æ¥ã€‚çœŸä¼šç©å•Šã€‚ã€‚</p><p>å¤§æ¦‚ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solve</span>:<br>    <span class="hljs-variable language_">self</span>.sh=remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">60716</span>) <span class="hljs-comment"># for solve 2</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>():<br>        <span class="hljs-keyword">pass</span><br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">solve1</span>():<br>        th=remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">60716</span>) <span class="hljs-comment">#only used in solve1</span><br>        A=[]<br>        <span class="hljs-comment">#solve code,collect results</span><br>        <span class="hljs-keyword">return</span> A<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">solve2</span>(<span class="hljs-params">resultarr</span>):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">solveall</span>():<br>        resultarr=solve1()<br>        solve2(resultarr)<br>    <br></code></pre></td></tr></table></figure><p>å‚è€ƒç½‘å€ï¼š<a href="https://blog.s1um4i.com/2024-QWBCTF/#traditional_game">2024 å¼ºç½‘æ¯ éƒ¨åˆ†é¢˜è§£ - S1uM4i</a></p><h3 id="4x03-Part-2"><a href="#4x03-Part-2" class="headerlink" title="4x03 Part 2"></a>4x03 Part 2</h3><p>å‚è€ƒï¼š<a href="https://tangcuxiaojikuai.xyz/post/df3f7032.html#more">ç³–é†‹å°é¸¡å—çš„blog </a></p><p>é€šè¿‡Part1ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è·å¾— $d_x$ çš„å€¼ï¼Œå…¶å€¼ä¸ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_private_key</span>(<span class="hljs-params">self, blind_bit=<span class="hljs-literal">None</span>, unknown_bit=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> blind_bit <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> unknown_bit <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        blind = getPrime(blind_bit)<br>        d_ = ((<span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.d &gt;&gt; unknown_bit) // blind * blind) &lt;&lt; unknown_bit) + <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.d % blind)<br>        <span class="hljs-keyword">return</span> (d_, blind)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">self</span>.d, <span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>è¿™è¾¹ <code>unknown_bit=365,blind_bit=40</code>ã€‚</p><p>æ ¹æ® $d_x$ çš„è¡¨è¾¾å¼ï¼Œå¦‚æœåŒ–æˆåå…­è¿›åˆ¶ï¼Œæœ€ä½ 40 ä½å°±æ˜¯ $d \bmod b$ çš„å€¼ï¼ŒåŒæ—¶ï¼Œé¢˜ç›®ä¸­ä¹Ÿå‘Šè¯‰äº†æˆ‘ä»¬ $b$ çš„å€¼ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“äº†  $d$ çš„é«˜ä½å’Œä½ä½ã€‚</p><p>å› æ­¤å¯ä»¥å¾—åˆ°<br>$$<br>C&#x3D;e(bd_h+bd_m+d_l)&#x3D;1+k\varphi<br>$$<br>å…¶ä¸­ï¼Œ$ed-1&#x3D;k\varphi&#x3D;k(n-(p+q)+1)\equiv k-k(p+q)\pmod n$ã€‚</p><p>ä½†æ˜¯è¿™è¾¹ $k$ ä¸çŸ¥é“å•Šï¼Œçœ‹äº†å‚è€ƒçš„wpï¼Œç„¶åè‡ªå·±åŠ¨æ‰‹å®éªŒäº†ä¸€ä¸‹ï¼Œå› ä¸º $d$ é«˜ä½çŸ¥é“äº†å¾ˆå¤šï¼Œ$n$ å’Œ $\varphi$ çš„é«˜ $511$ ä½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥æœ‰<br>$$<br>\left \lfloor \frac{ebd_h}{n}\right \rfloor+1&#x3D;k<br>$$<br>è®¾<br>$$<br>C&#x3D;e(bd_h+d_l-k(n+1)-1)<br>$$<br>åˆ°è¿™ä¸€æ­¥ï¼ŒLLLå°±å¾ˆç®€å•äº†ã€‚æˆ‘ä»¬æœŸå¾…æ±‚å‡º $(p+q,d_m)$ï¼Œæ ¹æ®ä¸Šé¢çš„å¼å­ï¼Œæœ‰<br>$$<br>ebd_m+k(p+q)\equiv n \pmod C<br>$$<br>å…¶ä¸­ï¼š$d_m$ é¢„æœŸä¸º $365$ ä½ï¼Œ$(p+q)$ é¢„æœŸä¸º $513$ ä½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">dh=(((dx&gt;&gt;<span class="hljs-number">365</span>)//b)*<span class="hljs-number">2</span>**<span class="hljs-number">365</span>)<br>dl=(dx&amp;<span class="hljs-number">0xffffffffff</span>)<br><span class="hljs-built_in">print</span>(dh,dl)<br>k=<span class="hljs-number">1</span>+(e*dh*b//n)<br>C=e*(b*dh+dl)-k*(n+<span class="hljs-number">1</span>)-<span class="hljs-number">1</span><br>M=[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,k],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,e*b],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,C]]<br>M=Matrix(ZZ,M)<br>M=M*diagonal_matrix(ZZ,[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">148</span>,C]) <span class="hljs-comment">#148=513-365</span><br>M3L=M.LLL()<br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> M3L:<br>    <span class="hljs-built_in">print</span>(v)<br><span class="hljs-comment">#(-165382578491530217740294945789051327054550730412409, 6069854417684843869781185345814449921057599813490779103392444182843066433073577984, 0)</span><br><span class="hljs-comment">#(24253655408554923753657477074063654465943861814895829354859517611675085695676047250571909835358720051039798073116052933831237123986406228006920402560817446, 660828381258241436840092787866586880655656505125224479398221243621629860031648793514091179644037262606768135285755491647488, 0)</span><br><span class="hljs-comment">#(13265834046843137898321312630162668582611515930035, -486881279321864056104093205528514024155683530545938397465394105939234142703058944, 412587550651454677464807044872817944212261052389482413806028317495998064325432106958378875349983999689868802166640436956611193538891106166781061387911779019238685876501201863206243588919056176)</span><br></code></pre></td></tr></table></figure><p>ç„¶åè§£å‡ºæ¥ä¸€çœ‹ï¼šç¬¬äºŒä¸ªå‘é‡æ˜¯ $513$ ä½ï¼Œè²Œä¼¼æˆåŠŸäº†å—ï¼Ÿ</p><p>æ‹¿è¿›å»è¯•ä¸€ä¸‹ï¼Œå‘ç°ä¸å¯¹ã€‚ã€‚å¹¶ä¸”ç¬¬ä¸€ä¸ªå‘é‡éå¸¸çŸ­ï¼Œç»è¿‡æµ‹è¯•ï¼Œé‡Œé¢çš„ç»“æœæ˜¯ $(-k,2^{148}eb,0)$ï¼Œæ˜¯ä¸€ä¸ªéå¸¸éå¸¸trivialçš„è§£ã€‚å¦‚æœä»¤ $p+q&#x3D;x,d_m&#x3D;y$ï¼Œé‚£ä¹ˆæœ‰ $kx+eby$ï¼Œé‚£ä¹ˆ $(x,y)&#x3D;(-eb,k)$ å½“ç„¶ä¹Ÿæ˜¯ä¸€ç»„è§£å’¯ã€‚</p><p>è®¾ç¬¬äºŒç»„æ•°æ®ä¸º $(x_2,y_2,0)$ï¼Œç”±äº $x_2,y_2$ å¤§å°ç¬¦åˆé¢„æœŸï¼Œå‚è€ƒwpä¸­çš„æç¤ºï¼Œå¯ä»¥è®¤ä¸º $p+q&#x3D;x_2+teb$ï¼Œä¹Ÿå°±æ˜¯<br>$$<br>p+q\equiv x_2\pmod {eb}<br>$$</p><p>å› ä¸ºæˆ‘æ˜¯æœ¬åœ°æ•°æ®æµ‹è¯•ï¼Œæ‰€ä»¥å¯ä»¥æœ‰ $p,q$ï¼Œæµ‹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">x2=<span class="hljs-built_in">abs</span>(M3L[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])<br>paddqL=(x2%(e*b))<br>paddqH=(x2//(e*b))*(e*b)<br><span class="hljs-built_in">print</span>(paddqL,paddqH)<br><span class="hljs-built_in">print</span>((p+q)%(e*b)==paddqL)<br><span class="hljs-comment">#True</span><br></code></pre></td></tr></table></figure><p>ç„¶åå†æµ‹ä¸€ä¸‹ $eb$ è¿›åˆ¶ä¸‹ï¼Œ$p+q$ å’Œ $x_2$ çš„å·®åˆ«ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getradixb</span>(<span class="hljs-params">x,bb</span>):<br>    arr=[<span class="hljs-number">0</span>]*<span class="hljs-number">30</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>        arr[i]=x%bb<br>        x//=bb<br>    <span class="hljs-keyword">return</span> arr<br>A=<span class="hljs-built_in">print</span>(getradixb((dh*b)+dl,e*b))<br>B=<span class="hljs-built_in">print</span>(getradixb(d,e*b))<br><span class="hljs-built_in">print</span>(A)<br><span class="hljs-built_in">print</span>(B)<br><span class="hljs-comment">#[104668899241649537541186210781987061154261026601556, 92109567048793027288125736075569023185167845386074, 62813493539693390648778685609015503369769016471552, 80689223742648360656616346585665194908177979489243, 70805628792722422704735895621626856114034836989125, 41818883498127627092744577886150813128254101231100, 711081, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span><br><span class="hljs-comment">#[157342616402321470506410965081459618389668038679383, 105869422956878578854817467532416606067687308116443, 62813493539693390648778685611216892179500683590388, 80689223742648360656616346585665194908177979489243, 70805628792722422704735895621626856114034836989125, 41818883498127627092744577886150813128254101231100, 711081, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span><br></code></pre></td></tr></table></figure><p> å¥½åƒå·®çš„ä¸å¤šï¼Œä¸æ˜¯å—ï¼ˆ</p><p>ç„¶åå°±ä¼¼ä¹å·²çŸ¥ $d$ éƒ¨åˆ†ä½æ±‚è§£äº†ï¼Œè¿™ä¸€éƒ¨åˆ†å®Œå…¨å‚è€ƒäº†é¸¡å—ä½¬çš„ï¼Œä¸‹ä½ æ±‚ä¸€ä¸ªå¤§æ¦‚è§£ï¼Œç„¶åä½¿ç”¨CRTæ±‚ $p$ ä½ä½æ¨¡ $eb$ çš„å€¼ï¼Œå¯ä»¥å‘ç°è¿™ä¸ªé¢˜ç•Œå¡å¾—éå¸¸ç´§ã€‚ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python">PR.&lt;x&gt; = PolynomialRing(RealField(<span class="hljs-number">2000</span>))<br>f = x*(paddqH-x) - n <br>ph = <span class="hljs-built_in">int</span>(f.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]) // (e*b) * (e*b)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>(f.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]))<br>R.&lt;x&gt; = PolynomialRing(Zmod(e))<br>fe = x*(paddqL-x) - n<br>rese = fe.roots()<br>R.&lt;x&gt; = PolynomialRing(Zmod(b))<br>fb = x*(paddqL-x) - n<br>resb = fb.roots()<br>rese=[rese[i][<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(rese))]<br>resb=[resb[i][<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(resb))]<br><span class="hljs-built_in">print</span>(rese,resb)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> rese:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> resb:<br>        pl=crt([<span class="hljs-built_in">int</span>(i),<span class="hljs-built_in">int</span>(j)],[e,b])<br>        PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>        f = ph + e*b*x + pl<br>        f = f.monic()<br>        res = f.small_roots(X=<span class="hljs-number">2</span>**<span class="hljs-number">245</span>,beta=<span class="hljs-number">0.496</span>,epsilon=<span class="hljs-number">0.015</span>)<br>        <span class="hljs-keyword">if</span>(res!=[]):<br>            pg=ph+e*b*res[<span class="hljs-number">0</span>]+pl<br>            <span class="hljs-keyword">assert</span> (n%<span class="hljs-built_in">int</span>(pg)==<span class="hljs-number">0</span>)<br>            <span class="hljs-built_in">print</span>(pg)<br>            qg=<span class="hljs-built_in">int</span>(n)//<span class="hljs-built_in">int</span>(pg)<br>            dg=inverse(<span class="hljs-built_in">int</span>(e),<span class="hljs-built_in">int</span>((pg-<span class="hljs-number">1</span>)*(qg-<span class="hljs-number">1</span>)))<br>            <span class="hljs-built_in">print</span>(pg,qg)<br></code></pre></td></tr></table></figure><p>some situation.</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">rec <span class="hljs-number">2024</span><span class="hljs-regexp">/11/</span><span class="hljs-number">3</span> <span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">01</span><br>è¿™ä¸ªæˆ‘å’Œé¸¡å—æäº†ä¸€å¤©ã€‚ã€‚<br><br>rec <span class="hljs-number">2024</span><span class="hljs-regexp">/11/</span><span class="hljs-number">3</span> <span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">10</span><br>æˆ‘ä¸€ä¸ªæœ‹å‹å‡ºçš„ï¼Œæ¯«ä¸ç•™æƒ…<br></code></pre></td></tr></table></figure><p>éº»äº†ã€‚</p><h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9.æ€»ç»“"></a>9.æ€»ç»“</h2><p>å¥½éš¾å•Šï¼Œä¸è¿‡å¥½åœ¨è‡ªå·±å­¦åˆ°äº†å¾ˆå¤šï¼Œä¹Ÿç®—æ˜¯æŒºæœ‰æ”¶è·çš„äº†å§ã€‚</p><p>è®¡åˆ’11æœˆ24æ—¥ä»è´µé˜³å›æ¥ä¹‹åï¼Œåœä¸€æ®µæ—¶é—´CTFï¼Œé¢„è®¡12æœˆ5æ—¥æ¢å¤ï¼Œ12æœˆ15æ—¥æ‰“ä¸ªå›½èµ›ï¼Œåé¢è€ƒè¯•å’Œpreå¤ªå¤šäº†ï¼Œæ•´ä¸ªäººè¦çˆ†ç‚¸äº†:(</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>24Nov2</title>
    <link href="/2024/11/15/24Nov2/"/>
    <url>/2024/11/15/24Nov2/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-11æœˆçš„åˆ‡é¢˜2"><a href="#huangx607087-11æœˆçš„åˆ‡é¢˜2" class="headerlink" title="huangx607087 11æœˆçš„åˆ‡é¢˜2"></a>huangx607087 11æœˆçš„åˆ‡é¢˜2</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>è‡ªåšå®¢åˆ›ç«‹ä»¥æ¥ï¼ŒExpLogå¹¶ä¸å¤šï¼šåˆ†åˆ«æ˜¯21Jan1,21Jan2,21Jan3,21Jan4,21Feb1,21Feb2,21May1å’Œ24Nov1ã€‚ï¼ˆå¥½å®¶ä¼™ï¼Œè¿™è·¨åº¦ï¼‰ã€‚21å¹´é‚£ä¸ªæ—¶å€™è‡ªå·±ç¡®å®åˆ‡äº†å¾ˆå¤šé¢˜ï¼Œä¹Ÿæ˜¯å½“æ—¶è¿›æ­¥æœ€å¿«çš„æ—¶å€™ï¼Œä¸è¿‡åæœŸå› ä¸ºä¿ç ”è¦å·G.æ‰€ä»¥CTFå°±æ²¡æ€ä¹ˆæ‰“äº†ã€‚ï¼ˆå½“ç„¶å¦‚æœæœ¬ç§‘ä¿ç ”å’ŒCTFäºŒé€‰ä¸€è®©æˆ‘å†é€‰ä¸€æ¬¡çš„è¯ï¼Œå½“ç„¶è¿˜æ˜¯å¾—é€‰ä¿ç ”ï¼‰ï¼Œå› ä¸ºè¿™æ ·æ‰èƒ½åœ¨ç ”ä¸€å¯¼å¸ˆæ”¾å…»çš„æ—¶å€™ï¼Œç»§ç»­ææŠ€æœ¯ã€‚</p><h2 id="1-2024å¼ºç½‘æ‹Ÿæ€-CFBChall"><a href="#1-2024å¼ºç½‘æ‹Ÿæ€-CFBChall" class="headerlink" title="1.[2024å¼ºç½‘æ‹Ÿæ€]CFBChall"></a>1.[2024å¼ºç½‘æ‹Ÿæ€]CFBChall</h2><p>é¦–å…ˆæ¥å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ä»£ç ï¼ˆæœ¬åœ°å¤ç°æ—¶ï¼Œå¯¹é¢˜ç›®ä»£ç æœ‰æ‰€ä¿®æ”¹ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br>key = os.urandom(<span class="hljs-number">16</span>)<br>iv  = os.urandom(<span class="hljs-number">16</span>)<br>register_open = <span class="hljs-literal">True</span><br>login_attempts = <span class="hljs-number">500</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">data, key</span>):<br>    cipher = AES.new(key, AES.MODE_CFB, iv=iv)<br>    ct_bytes = cipher.encrypt(data.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    <span class="hljs-keyword">return</span> ct_bytes.<span class="hljs-built_in">hex</span>()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ct, key</span>):<br>    ct_bytes = <span class="hljs-built_in">bytes</span>.fromhex(ct)<br>    cipher = AES.new(key, AES.MODE_CFB, iv=iv)<br>    data = cipher.decrypt(ct_bytes[:])<br>    <span class="hljs-keyword">return</span> data<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;debug:(key,iv)=&#x27;</span>,key.<span class="hljs-built_in">hex</span>(),iv.<span class="hljs-built_in">hex</span>()) <span class="hljs-comment">#è¿™ä¸ªæ˜¯æˆ‘æœ¬åœ°å¤ç°åŠ çš„ï¼ŒçœŸå®æƒ…å†µæ²¡æœ‰è¿™ä¸ªã€‚</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">InitialGlobals</span>():<br>    <span class="hljs-keyword">global</span> key,iv,register_open,login_attempts<br>    key = os.urandom(<span class="hljs-number">16</span>)<br>    iv  = os.urandom(<span class="hljs-number">16</span>)<br>    register_open = <span class="hljs-literal">True</span><br>    login_attempts = <span class="hljs-number">500</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Register</span>(<span class="hljs-params">username,password</span>):<br>    <span class="hljs-keyword">global</span> key,iv,register_open,login_attempts<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> register_open:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(password)&lt;<span class="hljs-number">8</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">set</span>(password+username)&lt;=<span class="hljs-built_in">set</span>(printable):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;admin&#x27;</span> <span class="hljs-keyword">in</span> username:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">else</span>:<br>            token = encrypt(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;username&#125;</span>\x00<span class="hljs-subst">&#123;password&#125;</span>\x01\x02\x03&quot;</span>, key)<br>            register_open = <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">return</span> token<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Login</span>(<span class="hljs-params">username,password,token</span>): <span class="hljs-comment">#å‡½æ•°å’ŒåŸé¢˜æœ‰æ‰€å·®åˆ«ã€‚</span><br>    <span class="hljs-keyword">global</span> key,iv,register_open,login_attempts<br>    <span class="hljs-keyword">if</span> login_attempts &lt;= <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">try</span>:<br>            decrypted = decrypt(token, key)<br>            token_username, *_, token_password = decrypted.split(<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>            <span class="hljs-keyword">assert</span>(token_password[-<span class="hljs-number">3</span>:]==<span class="hljs-string">b&quot;\x01\x02\x03&quot;</span>)<br>            token_password=token_password[:-<span class="hljs-number">3</span>]<br>            <span class="hljs-keyword">if</span> username == token_username <span class="hljs-keyword">and</span> password == token_password:<br>                <span class="hljs-keyword">if</span> username == <span class="hljs-string">b&#x27;admin&#x27;</span>:<br>                    <span class="hljs-keyword">if</span> password == <span class="hljs-string">b&#x27;123456&#x27;</span>:<br>                        <span class="hljs-keyword">return</span> (<span class="hljs-string">&#x27;flag&#123;This is a flag&#125;&#x27;</span>)<br>                    <span class="hljs-keyword">else</span>:<br>                        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;failed&#x27;</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;failed&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;failed&#x27;</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;failed&#x27;</span><br>        <span class="hljs-keyword">finally</span>:<br>            login_attempts -= <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>åœ¨åŸå§‹é¢˜ç›®ä¸­ï¼Œä½ æœ‰ä¸€æ¬¡æ³¨å†Œçš„æœºä¼šï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶åä»–ä¼šç»™ä½ ä¸€ä¸ªåŠ å¯†çš„tokenï¼Œtokençš„æ ¼å¼æ˜¯<code>username||\x00||password||\x01\x02\x03</code>ï¼Œç”¨AES-CFBåŠ å¯†ã€‚ç™»é™†æ—¶éœ€è¦ä»¥<code>admin</code> çš„èº«ä»½å’Œ <code>123456</code> çš„å¯†ç ç™»å½•å°±å¯ä»¥è·å¾—flagã€‚é¢˜ç›®ä¸­æ²¡æœ‰é™åˆ¶äº¤äº’æ¬¡æ•°ï¼Œä½†ç™»é™†å°è¯•æœ€å¤šä¸º 500 æ¬¡ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¹Ÿå¯ä»¥é‡ç½®å‚æ•°è¿›è¡Œé‡è¯•ã€‚</p><p>åœ¨BlockCipher3ä¸­ï¼Œæˆ‘ä»¬å›é¡¾äº†CFBçš„æ¨¡å¼ï¼ŒCFBæ¨¡å¼å°†åˆ†ç»„å¯†ç å½“æµå¯†ç ä½¿ç”¨ã€‚åœ¨Crypto.Util.Cipherä¸­çš„å®ç°ä¸ºé€å­—èŠ‚åŠ å¯†ï¼šæŠ•å…¥åˆå§‹å‘é‡ $(u_0,u_1,â€¦,u_{15})$ ï¼Œå¯¹åˆå§‹å‘é‡ç”¨å¯†é’¥åŠ å¯†åï¼Œå°†ä¸€ä¸ªå­—èŠ‚ï¼ˆç›®å‰å°šä¸æ¸…æ¥šæ˜¯é¦–ä¸ªè¿˜æ˜¯æœ€åä¸€ä¸ªï¼‰å’Œ ä¸€å­—èŠ‚æ˜æ–‡å¼‚æˆ–å¾—åˆ°å¯†æ–‡ $u_{16}$ï¼Œä¹Ÿå°±æ˜¯æ¶ˆæ¯é¦–ä¸ªå­—èŠ‚ $m_0$ çš„å¯†æ–‡ä¸º $u_{16}$ã€‚ç„¶åä¸‹ä¸€è½®ï¼Œå¯¹ $(u_1,u_2,â€¦,u_{16})$ ç”¨ç›¸åŒçš„å¯†é’¥åŠ å¯†ï¼Œ ç„¶åå°†æ˜æ–‡ç¬¬äºŒå­—èŠ‚$m_1$å’Œå¾—å‡ºçš„åŠ å¯†ç»“æœçš„ä¸€å­—èŠ‚å¼‚æˆ–å¾—åˆ° $u_{17}$ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p><img src="/2024/11/15/24Nov2/1.png" alt="1"></p><p>å¦‚æœä½¿ç”¨å¯†é’¥å’ŒIVç›¸åŒï¼Œé‚£ä¹ˆå¯¹äºä¸¤ä¸ªæ¶ˆæ¯  $M_1&#x3D;A||B,M_2&#x3D;A||C$ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ¶ˆæ¯åŠ å¯†åï¼Œå…¶å‰ç¼€ $A$ ä¼šè¢«åŠ å¯†æˆç›¸åŒå†…å®¹</p><p>å› ä¸ºAESçš„åˆ†ç»„é•¿åº¦ä¸º 16 å­—èŠ‚ï¼Œå› æ­¤å½“å‡ºç°1å­—èŠ‚é”™è¯¯æ—¶ï¼Œåé¢ 16 å­—èŠ‚ä¼šå‡ºç°é”™è¯¯ï¼Œ16å­—èŠ‚ä¹‹åä¼šæ¢å¤æ­£å¸¸ã€‚ä¹‹æ‰€ä»¥CFBã€OFBã€CTRæ¨¡å¼å¯ä»¥åœ¨åˆ†ç»„å¯†ç ä¸­ä½¿ç”¨ï¼Œæ˜¯å› ä¸ºåˆ†ç»„å¯†ç è‰¯å¥½çš„æ‰©æ•£æ€§å’Œæ··æ·†æ€§ï¼Œä¸¤ä¸ªç›¸ä¼¼çš„æ˜æ–‡ï¼Œç»è¿‡åŠ å¯†åï¼Œä¼šå¾—åˆ°æ ·è²Œç›¸å·®å¾ˆå¤§çš„å¯†æ–‡ã€‚</p><p>äº†è§£äº†CFBçš„å·¥ä½œåŸç†ï¼Œä¸‹é¢æˆ‘ä»¬å°±éœ€è¦è€ƒè™‘æ„å»ºpayloadäº†ï¼š</p><p>ç”±äºå…¶AESè‰¯å¥½çš„æ‰©æ•£æ€§å’Œæ··æ·†æ€§ï¼Œå› æ­¤ï¼Œå¯¹äºä¸¤ä¸ªæ˜æ–‡ï¼š<code>00 00 00 00</code>  å’Œ <code>00 00 01 00</code>ï¼Œå‡è®¾å‰è€…ç»è¿‡åŠ å¯†å˜æˆäº† <code>f0 e0 d0 c0</code>ï¼Œé‚£ä¹ˆåè€…ç»è¿‡ç›¸åŒåŠ å¯†ï¼Œå‰ä¸‰å­—èŠ‚ä¸€å®šæ˜¯ <code>f0 e0 d1</code>ï¼Œä½†ç¬¬å››å­—èŠ‚å°±æ— æ³•é¢„çŸ¥äº†ã€‚å› æ­¤ï¼Œä¸ºäº†èƒ½å¤Ÿæ„é€ adminå¼€å¤´çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªç‰¹æ€§ï¼Œç”¨æˆ·åè¾“å…¥<code>admio</code> ï¼ˆ<code>o</code> å’Œ<code>n</code> çš„å¼‚æˆ–å€¼ä¸º1ï¼‰ã€‚å¯†ç çš„è¯ï¼Œç”±äºè¦æ±‚å¼ºåˆ¶å…«ä½ä»¥ä¸Šï¼ŒåŠ ä¸Šå‰é¢ä¸€ä½<code>o</code> ä¼šå½±å“åç»­ 16 ä½ï¼Œå› æ­¤æ”¾16ä¸ªå¡«å……å­—ç¬¦ï¼Œç„¶ååŠ ä¸Š<code>123456</code>ï¼Œè¿™æ ·æœ€ååˆšå¥½å¯ä»¥åœ¨æœ€åä»¥ <code>\x01\x02\x03</code> çš„paddingç»“å°¾ã€‚</p><p>ç„¶åå°±æ˜¯æ‹¼è¿æ°”äº†ï¼Œå› ä¸ºç¬¬6ä½å­—ç¬¦å¼€å§‹å—åˆ°å½±å“ï¼Œå› æ­¤ç¬¬å…­ä½å¯¹åº”çš„å¯†æ–‡ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œçˆ†ç ´ï¼Œç„¶åèµŒè¿™ä¸­é—´å­˜åœ¨ <code>\x00</code> è¿›è¡Œéš”æ–­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">T=<span class="hljs-number">0</span><br>found=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> found:<br>    InitialGlobals()<br>    mytoken=Register(<span class="hljs-string">&#x27;admio&#x27;</span>,<span class="hljs-string">&#x27;A&#x27;</span>*<span class="hljs-number">16</span>+<span class="hljs-string">&#x27;123456&#x27;</span>)<br>    mytoken=mytoken[:<span class="hljs-number">8</span>]+<span class="hljs-string">&#x27;&#123;:02x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">int</span>(mytoken[<span class="hljs-number">8</span>:<span class="hljs-number">10</span>],<span class="hljs-number">16</span>)^<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;XX&#x27;</span>+mytoken[<span class="hljs-number">12</span>:]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        ftoken=mytoken.replace(<span class="hljs-string">&#x27;XX&#x27;</span>,<span class="hljs-string">&#x27;&#123;:02x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i))<br>        chk=Login(<span class="hljs-string">b&#x27;admin&#x27;</span>,<span class="hljs-string">b&#x27;123456&#x27;</span>,ftoken)<br>        T+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span>(chk[:<span class="hljs-number">4</span>]==<span class="hljs-string">&#x27;flag&#x27;</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;success with <span class="hljs-subst">&#123;T&#125;</span> queries&#x27;</span>)<br>            found=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(decrypt(ftoken,key))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;debug:(key,iv)=&#x27;</span>,key.<span class="hljs-built_in">hex</span>(),iv.<span class="hljs-built_in">hex</span>()) <span class="hljs-comment">#æœ¬åœ°å¤ç°ï¼Œå¯ä»¥è¾“å‡ºè°ƒè¯•ç”¨ã€‚</span><br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªå¯èƒ½çš„è¾“å‡ºç»“æœï¼Œ30000å¤šæ¬¡å¯ä»¥æ‹¿åˆ°flagï¼Œä¸è¿‡æœ¬åœ°æµ‹è¯•æ—¶äº¤äº’æ—¶é—´ä¸å®šï¼Œè¿æ°”å¥½2000å¤šæ¬¡å‡ºç»“æœï¼Œè¿æ°”å·®è¦10ä¸‡æ¬¡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">success <span class="hljs-keyword">with</span> <span class="hljs-number">35192</span> queries<br><span class="hljs-string">b&#x27;admin\x00\x0e-\xb0[.\xd3\xd4\xb9\xd5\x1f`\xd2\xe9)\x9e\x00123456\x01\x02\x03&#x27;</span><br>debug:(key,iv)= fe419d0b1dcd16b75247181d1e7fa0f5 8b49ad0c5018eb41d083058881323f84<br></code></pre></td></tr></table></figure><h2 id="2-2024é¹åŸæ¯-babyenc"><a href="#2-2024é¹åŸæ¯-babyenc" class="headerlink" title="2.[2024é¹åŸæ¯] babyenc"></a>2.[2024é¹åŸæ¯] babyenc</h2><p>é¢˜ç›®ä¸€å…±åˆ†ä¸¤é—®ï¼Œåˆ†åˆ«æ¥çœ‹</p><h3 id="2o01-Part1"><a href="#2o01-Part1" class="headerlink" title="2o01 Part1"></a>2o01 Part1</h3><p>ç¬¬ä¸€é—®çš„åŠ å¯†ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">enc1</span>(<span class="hljs-params">m, e, shift</span>):<br>    n = next_prime(m &lt;&lt; shift) <span class="hljs-comment">#shift=310</span><br>    tmp = getPrime(<span class="hljs-number">256</span>)<br>    cc = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e)):<br>        cc.append(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(tmp, e[i], n)))<br>    <span class="hljs-keyword">return</span> cc<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">output:e = [43, 37, 53, 61, 59]</span><br><span class="hljs-string">c1 = [304054249108643319766233669970696347228113825299195899223597844657873869914715629219753150469421333712176994329969288126081851180518874300706117, 300569071066351295347178153438463983525013294497692191767264949606466706307039662858235919677939911290402362961043621463108147721176372907055224, 294806502799305839692215402958402593834563343055375943948669528217549597192296955202812118864208602813754722206211899285974414703769561292993531, 255660645085871679396238463457546909716172735210300668843127008526613931533718130479441396195102817055073131304413673178641069323813780056896835, 194084621856364235027333699558487834531380222896709707444060960982448111129722327145131992393643001072221754440877491070115199839112376948773978]</span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸€é—®ä¸­ï¼Œç»™å‡ºäº†äº”ç»„ $t^{e} \bmod n$ çš„å€¼ï¼Œå…¶ä¸­ $n$ æ˜¯ $2^{310}m$ çš„ä¸‹ä¸€ä¸ªç´ æ•°ï¼Œè€Œ $e$ çš„å€¼å¾ˆå°ã€‚ä½†è¿™è¾¹ $n,t$ éƒ½ä¸çŸ¥é“ã€‚</p><p>è®¾ $A,B,C,D,E$ åˆ†åˆ«ä¸º $5$ ä¸ª $c$ å€¼ï¼Œé‚£ä¹ˆæœ‰ $(t^{43},t^{37},t^{53},t^{61},t^{59})\equiv (A,B,C,D,E) \pmod n$ã€‚</p><p>å› æ­¤ï¼Œå¯ä»¥å¾—åˆ°ç­‰å¼ï¼š<br>$$<br>\frac{A}{B}\equiv\frac{E}{C}\equiv\frac{D^3}{E^3}\equiv t^{6} \pmod n<br>$$<br>ä¹Ÿå°±æ˜¯<br>$$<br>AC-BE \equiv AE^3-BD^3\equiv E^4-CD^3\equiv 0\pmod n<br>$$<br>éšä¾¿å–ä¸¤ç»„æ•°æ®ï¼Œæ¯”å¦‚è®¡ç®— $|AC-BE|$ å’Œ $|AE^3-BD^3|$ï¼ˆä¸å–æ¨¡ï¼‰ï¼Œç„¶åæ±‚æœ€å¤§å…¬çº¦æ•°å°±å¯ä»¥å¾—åˆ° $n$ äº†ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€‰ç¬¬ä¸‰ç»„æ•°æ® $|E^4-CD^3|$ã€‚</p><p>$n$ å¾—åˆ°åç›´æ¥å³ç§» $310$ ä½ï¼Œå¾—åˆ°flagå‰åŠéƒ¨åˆ†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = [<span class="hljs-number">43</span>, <span class="hljs-number">37</span>, <span class="hljs-number">53</span>, <span class="hljs-number">61</span>, <span class="hljs-number">59</span>]<br>c1 = [<span class="hljs-number">304054249108643319766233669970696347228113825299195899223597844657873869914715629219753150469421333712176994329969288126081851180518874300706117</span>, <span class="hljs-number">300569071066351295347178153438463983525013294497692191767264949606466706307039662858235919677939911290402362961043621463108147721176372907055224</span>, <span class="hljs-number">294806502799305839692215402958402593834563343055375943948669528217549597192296955202812118864208602813754722206211899285974414703769561292993531</span>, <span class="hljs-number">255660645085871679396238463457546909716172735210300668843127008526613931533718130479441396195102817055073131304413673178641069323813780056896835</span>, <span class="hljs-number">194084621856364235027333699558487834531380222896709707444060960982448111129722327145131992393643001072221754440877491070115199839112376948773978</span>]<br><br>aa,bb,cc,dd=c1[<span class="hljs-number">1</span>],c1[<span class="hljs-number">0</span>],c1[<span class="hljs-number">2</span>],c1[<span class="hljs-number">4</span>]<br><span class="hljs-comment">#Ax^6=B (mod u)</span><br><span class="hljs-comment">#Cx^6=D (mod u)</span><br><span class="hljs-comment">#B/A=D/C</span><br><span class="hljs-comment">#BC=AD (mod u)</span><br>F=bb*cc-aa*dd<br>aaa,bbb,ccc,ddd=c1[<span class="hljs-number">1</span>],c1[<span class="hljs-number">0</span>],c1[<span class="hljs-number">4</span>],c1[<span class="hljs-number">3</span>]<br><span class="hljs-comment">#Ax^6=B</span><br><span class="hljs-comment">#Cx^2=D</span><br><span class="hljs-comment">#C^3x^6=D^3</span><br><span class="hljs-comment">#B/A=D/C</span><br>G=<span class="hljs-built_in">abs</span>(bbb*(ccc**<span class="hljs-number">3</span>)-aaa*(ddd**<span class="hljs-number">3</span>))<br><br>u=gcd(F,G)<br><span class="hljs-built_in">print</span>(u,isPrime(<span class="hljs-built_in">int</span>(u)))<br>u3=u&gt;&gt;<span class="hljs-number">310</span><br>long_to_bytes(u3)<br><span class="hljs-comment"># print(u,isPrime(int(u))) è¾“å‡ºç»“æœ</span><br><span class="hljs-comment">#312246073793634738336797238973383686069608357320504281244915809376146746877615304143136570336999218383069369602336776078145547720220248077500917 True</span><br><span class="hljs-comment">#Out[29]:</span><br><span class="hljs-comment">#b&#x27;flag&#123;3e99c26b-efdd-4c&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="2o02-Part-2"><a href="#2o02-Part-2" class="headerlink" title="2o02 Part 2"></a>2o02 Part 2</h3><p>ç„¶åæ˜¯ç¬¬äºŒé—®ï¼šç¬¬äºŒé—®ç»™äº† $g&#x3D;m^p \pmod n,h&#x3D;m^q\pmod n$ã€‚è¿™ä¸€é—®ç”±äº $n&#x3D;pq$ï¼Œå› æ­¤å¦‚æœæŠŠ $g,h$å†™æˆä¸­å›½å‰©ä½™å®šç†çš„å½¢å¼ï¼Œå°±æ˜¯ï¼š</p><p><img src="/2024/11/15/24Nov2/2.png" alt="2"></p><p>æ ¹æ®è´¹é©¬å°å®šç† $m^p\equiv m\pmod p$ï¼Œå¯ä»¥æœ‰</p><p><img src="/2024/11/15/24Nov2/3.png" alt="3"></p><p>æ­¤ï¼Œå»æ‰åŒä½™ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆï¼š $g&#x3D;up+m,h&#x3D;vq+m$ã€‚</p><p>ä¹Ÿå°±æ˜¯ $(g-m)(h-m)\equiv gh-m(g+h)+m^2\equiv (up)(vq) \equiv uvpq\equiv 0\pmod n$</p><p>æ³¨æ„åˆ° $m$ æ˜¯ $21\times8&#x3D;168$ ä½ï¼Œè€Œ $n$æ˜¯2048ä½ï¼Œmç›¸å¯¹äºnç‰¹åˆ«å°ã€‚</p><p>ä¸Šé¢å¼å­å»åŒä½™ï¼Œæœ‰ $(g-m)(h-m)&#x3D;gh-m(g+h)+m^2-wn&#x3D;0$ã€‚</p><p>å› æ­¤å¯ä»¥æ„é€ çŸ©é˜µï¼ŒLLLæ ¼åŸºå½’çº¦æå‡º$m$ï¼ˆè¿™ä¸ª$K&#x3D;2^{1600}$æ˜¯ä¸ºäº†æ‰©å¤§æœ€çŸ­å‘é‡çš„é•¿åº¦ï¼Œå¦åˆ™æœ€çŸ­å‘é‡å°±æ˜¯çŸ©é˜µç¬¬ä¸‰è¡Œçš„$(0,0,0,1,-1)$ï¼‰</p><p><img src="/2024/11/15/24Nov2/4.png" alt="4"></p><p><strong>äº‹åè¡¥å……ï¼š</strong> è¿™è¾¹å› ä¸º $m$ åªæœ‰ $168$ ä½ï¼Œæ‰€ä»¥éšä¾¿ä¹±æå°±å‡ºæ¥äº†ï¼Œä½†å…¶å®ä»é—µå¯å¤«æ–¯åŸºå®šç†æ¥çœ‹ï¼Œä½ å³è¾¹æ•´ä½“ä¹˜ä¸€è¡Œï¼Œ $\det M$ åªå¢åŠ äº† $K$ å€ã€‚æ­£ç¡®åšæ³•è¿˜è¦è€ƒè™‘ä¸‰ä¸ª $1$ è¿‡å°å¸¦æ¥çš„å½±å“ã€‚å› ä¸º $m$ æ˜¯ $168$ ä½ï¼Œé‚£ä¹ˆ $m^2$ å°±æ˜¯ $376$ ä½ã€‚å› æ­¤æ„é€ çš„çŸ©é˜µå‰ $3$ åˆ—æœ€å¥½ä¹˜ä¸€ä¸ª $(2^{376},2^{168},1)$ çš„ç³»æ•°ï¼Œæ¥ä¿è¯ä¸¤è¾¹å¹³è¡¡ã€‚æœ€ç»ˆç»“æœä¸º $(2^{376},2^{168}m,m^2)$ã€‚</p><p>æœ€åå°±å¯ä»¥å¾—åˆ° $m$äº†ï¼Œå¯ä»¥çœ‹åˆ°ç»“æœä¸é¢„æœŸç›¸ç¬¦ï¼Œå·®ä¸ªç¬¦å·å–æ­£å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># In [1]:</span><br>n = <span class="hljs-number">16175064088648626038689748434699435826247716579187475966092822028609536761351820951820375552440329596553448265674841223230257463367834546091974959931391707199002842774795702094681528411058318007858638798643010942408552063479863545047616823056802010158288409527763686086960916160949496083789920012040215745627854092010308869223489833074860062054019221397227691063339148923860987250696934050122115972982286012688955816234717242567815830341836031567275888691320640526306946586793028267588302696611724356566003447616419092371914903382944112125852939011729294400479171568234647164730191643282793224422368321464125847020067</span><br>c2 = [<span class="hljs-number">12053085469218650692076937068797478047679005585690696222988148891925249697123080938461512785257424651119325211991331622346111396522606463631848519999574540677285771456451798811902760319940781754940936484802949729402283626052963389539032949160905330315285409948932070460455535716223838438994608837585387741418172014634472651248450564788332400265295308803291229281839428962457585593065595521459963501453576128172245723315811398209056633738967993602668795794847967331946516181453804430961308142497659799416125763566765485760600358126127595222197324155943818136202233758771243043559460620477085689770403810190118485243364</span>, <span class="hljs-number">13878717704635179949812987989626985689079485417345626168168664941124566737996226347895779823781042724620099437593856913505609774929187720381745418166924229828643565384137488017127800518133460531729559408120123922005898834268035918798610962941606864727966963354615441094676621013036726097763695675723672289505864372820096404707522755617527884121630784469379311199256277022770033036782130954108210409787680433301426480762532000133464370267551845990395683108170721952672388388178378604502610341465223041534665133155077544973384500983410220955683686526835733853985930134970899200234404716865462481142496209914197674463932</span>]<br>g,h=c2<br>K=<span class="hljs-number">2</span>**<span class="hljs-number">1600</span><br>M=Matrix(ZZ,[[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,g*h*K],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-(g+h)*K],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>*K],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,K*n]])<br><span class="hljs-built_in">print</span>(M.LLL()[<span class="hljs-number">0</span>])<br><br><span class="hljs-comment"># Out [1]:</span><br><span class="hljs-comment">#(-1, -146436625375651639081292195233290471195543268962429, -21443685251408941546679213362069702254265669437874360093122983595763055555796655464630848682213580041, 0)</span><br><span class="hljs-comment">#å¯¹åº”(1,m,m^2,w,0)ï¼Œå·®ä¸ªäº†ç¬¦å·ï¼Œæ— æ‰€è°“</span><br><br><span class="hljs-comment"># In [2]:</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>long_to_bytes(<span class="hljs-number">146436625375651639081292195233290471195543268962429</span>)<span class="hljs-comment">#ç›´æ¥å¤åˆ¶ä¸Šé¢ç¬¬äºŒä¸ªåˆ†é‡å³å¯ã€‚</span><br><span class="hljs-comment"># Out [2]:</span><br><span class="hljs-comment">#b&#x27;d2-bbe5-1420eaaa3b30&#125;&#x27;</span><br><span class="hljs-comment">#æœ€ç»ˆflag:flag&#123;3e99c26b-efdd-4cd2-bbe5-1420eaaa3b30&#125;</span><br></code></pre></td></tr></table></figure><h2 id="3-2024é¹åŸæ¯-tarscr"><a href="#3-2024é¹åŸæ¯-tarscr" class="headerlink" title="3.[2024é¹åŸæ¯] tarscr"></a>3.[2024é¹åŸæ¯] tarscr</h2><p>è¿™ä¸ªé¢˜ç›® $d_q$ å¾ˆå°ï¼Œ$p$ å’Œ $q$ çš„å¤§å°ä¹Ÿä¸å¹³è¡¡ã€‚ä¹Ÿå°±æ˜¯ $p&lt;n^{\beta},d_q&lt;n^{\delta}$ã€‚è¿™é‡Œ $\beta&#x3D;0.3,\delta&#x3D;0.1$ã€‚</p><p>ä¸€å¼€å§‹æ ¹æ® <a href="https://link.springer.com/content/pdf/10.1007%2F3-540-45708-9_16.pdf">è¿™ç¯‡æ–‡çŒ®</a>ä¸­çš„æ–¹æ³•åšçš„ï¼Œå› ä¸º $\beta&lt;0.382$ï¼Œä½†è¿™ç¯‡æ–‡çŒ®è¿˜æœ‰ä¸€ä¸ªè¦æ±‚å°±æ˜¯ $3\beta-\beta^2+2\delta&lt;1$ï¼Œå› æ­¤ä¸æ»¡è¶³æ¡ä»¶ã€‚</p><p>å› æ­¤æ ¹æ® <a href="https://www.iacr.org/archive/pkc2006/39580001/39580001.pdf">è¿™ç¯‡æ–‡çŒ®</a>çš„æ–¹æ³•å»åšï¼Œå‚è€ƒäº†<a href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/index.html">lazzaroçš„åšå®¢</a>ï¼Œæ”¹ä¸€ä¸‹é‡Œé¢çš„å‚æ•°å³å¯ã€‚</p><p>è²Œä¼¼æ˜¯2022NCTFçš„åŸé¢˜ï¼Ÿé‚£ä¸ªæ—¶å€™æˆ‘CTFå·²ç»é€€å½¹äº†ï¼ˆä¸è¿‡è¯è¯´å›æ¥ï¼Œå†ç»™æˆ‘ä¸€æ¬¡é€‰æ‹©ï¼ŒCTFå’Œä¿ç ”ä¹‹é—´æˆ‘å½“ç„¶è¿˜æ˜¯é€‰æ‹©ä¿ç ”å•¦ï¼Œä¿ç ”æ·±é€ 3å¹´ï¼Œå»è®¤è¯†è®¤è¯†æ›´å¤šçš„å¤§ä½¬ï¼Œ<strong>å¯¹æˆ‘è€Œè¨€</strong>è¿˜æ˜¯æ¯”ç›´æ¥å·¥ä½œå¥½ã€‚å½“ç„¶ï¼Œä»¥å‰CTFé˜Ÿå‹æœ¬ç§‘æ¯•ä¸šç›´æ¥å·¥ä½œï¼Œè¿˜å»äº†å¾ˆä¸é”™çš„å•ä½ï¼Œæ¯•ç«Ÿä»–ä»¬ä¸éœ€è¦è¯»ç ”å°±å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªéå¸¸å¥½çš„å·¥ä½œï¼Œä¹Ÿæ˜¯æŒºä»¤äººç¾¡æ…•çš„ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#reference: https://lazzzaro.github.io/2020/05/06/crypto-RSA/index.html</span><br><span class="hljs-keyword">from</span> copy <span class="hljs-keyword">import</span> deepcopy<br><span class="hljs-comment"># https://www.iacr.org/archive/pkc2006/39580001/39580001.pdf</span><br><span class="hljs-comment"># Author: ZM__________J, To1in</span><br>N = <span class="hljs-number">61857467041120006957454494977971762866359211220721592255304580940306873708357617802596067329984189345493420858543581027612648626678588277060222860337783377316655375278359169520243355170247177279595812282793212550819124960549824278287538977769728573023023364686725321548391592858202718446127851076431000427033</span><br>e = <span class="hljs-number">22696852369762746127523066296087974245933137295782964284054040654103039210164173227291367914580709029582944005335464668969366909190396194570924426653294883884186299265660358589254391341147028477295482787041170991166896788171334992065199814524969470117229229967188623636764051681654720429531708441920158042161</span><br>alpha = log(e, N)<br>beta = <span class="hljs-number">0.3</span><br>delta = <span class="hljs-number">0.1</span><br>P.&lt;x,y,z&gt;=PolynomialRing(ZZ)<br> <br>X = ceil(<span class="hljs-number">2</span> * N^(alpha + beta + delta - <span class="hljs-number">1</span>))<br>Y = ceil(<span class="hljs-number">2</span> * N^beta)<br>Z = ceil(<span class="hljs-number">2</span> * N^(<span class="hljs-number">1</span> - beta))<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x,y</span>):<br>    <span class="hljs-keyword">return</span> x*(N-y)+N<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trans</span>(<span class="hljs-params">f</span>):<br>    my_tuples = f.exponents(as_ETuples=<span class="hljs-literal">False</span>)<br>    g = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> my_tuple <span class="hljs-keyword">in</span> my_tuples:<br>        exponent = <span class="hljs-built_in">list</span>(my_tuple)<br>        mon = x ^ exponent[<span class="hljs-number">0</span>] * y ^ exponent[<span class="hljs-number">1</span>] * z ^ exponent[<span class="hljs-number">2</span>]<br>        tmp = f.monomial_coefficient(mon)<br>        <br>        my_minus = <span class="hljs-built_in">min</span>(exponent[<span class="hljs-number">1</span>], exponent[<span class="hljs-number">2</span>])<br>        exponent[<span class="hljs-number">1</span>] -= my_minus<br>        exponent[<span class="hljs-number">2</span>] -= my_minus<br>        tmp *= N^my_minus<br>        tmp *= x ^ exponent[<span class="hljs-number">0</span>] * y ^ exponent[<span class="hljs-number">1</span>] * z ^ exponent[<span class="hljs-number">2</span>]<br>        <br>        g += tmp<br>    <span class="hljs-keyword">return</span> g<br>  <br>m = <span class="hljs-number">5</span> <span class="hljs-comment"># need to be adjusted according to different situations</span><br>tau = ((<span class="hljs-number">1</span> - beta)^<span class="hljs-number">2</span> - delta) / (<span class="hljs-number">2</span> * beta * (<span class="hljs-number">1</span> - beta))<br>sigma = (<span class="hljs-number">1</span> - beta - delta) / (<span class="hljs-number">2</span> * (<span class="hljs-number">1</span> - beta))<br> <br><span class="hljs-built_in">print</span>(sigma * m)<br><span class="hljs-built_in">print</span>(tau * m)<br> <br>s = ceil(sigma * m)<br>t = ceil(tau * m)<br>my_polynomials = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m+<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m-i+<span class="hljs-number">1</span>):<br>        g_ij = trans(e^(m-i) * x^j * z^s * f(x, y)^i)<br>        my_polynomials.append(g_ij)<br> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m+<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, t+<span class="hljs-number">1</span>):<br>        h_ij = trans(e^(m-i) * y^j * z^s * f(x, y)^i)<br>        my_polynomials.append(h_ij)<br>        <br>known_set = <span class="hljs-built_in">set</span>()<br>new_polynomials = []<br>my_monomials = []<br> <br><span class="hljs-comment"># construct partial order</span><br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(my_polynomials) &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(my_polynomials)):<br>        f = my_polynomials[i]<br>        current_monomial_set = <span class="hljs-built_in">set</span>(x^tx * y^ty * z^tz <span class="hljs-keyword">for</span> tx, ty, tz <span class="hljs-keyword">in</span> f.exponents(as_ETuples=<span class="hljs-literal">False</span>))<br>        delta_set = current_monomial_set - known_set<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(delta_set) == <span class="hljs-number">1</span>:<br>            new_monomial = <span class="hljs-built_in">list</span>(delta_set)[<span class="hljs-number">0</span>]<br>            my_monomials.append(new_monomial)<br>            known_set |= current_monomial_set<br>            new_polynomials.append(f)            <br>            my_polynomials.pop(i)<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;GG&#x27;</span>)<br>        <br>my_polynomials = deepcopy(new_polynomials)<br> <br>nrows = <span class="hljs-built_in">len</span>(my_polynomials)<br>ncols = <span class="hljs-built_in">len</span>(my_monomials)<br>L = [[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows)]<br> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows):<br>    g_scale = my_polynomials[i](X * x, Y * y, Z * z)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols):<br>        L[i][j] = g_scale.monomial_coefficient(my_monomials[j])<br>        <br><span class="hljs-comment"># remove N^j</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows):<br>    Lii = L[i][i]<br>    N_Power = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> (Lii % N == <span class="hljs-number">0</span>):<br>        N_Power *= N<br>        Lii //= N<br>    L[i][i] = Lii<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols):<br>        <span class="hljs-keyword">if</span> (j != i):<br>            L[i][j] = (L[i][j] * inverse_mod(N_Power, e^m))<br><br>L = Matrix(ZZ, L)<br>nrows = L.nrows()<br> <br>L = L.LLL()<br><span class="hljs-comment"># Recover poly</span><br>reduced_polynomials = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows):<br>    g_l = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols):<br>        g_l += L[i][j] // my_monomials[j](X, Y, Z) * my_monomials[j]<br>    reduced_polynomials.append(g_l)<br> <br>my_ideal_list= [y * z - N] + reduced_polynomials<br> <br><span class="hljs-comment"># Variety</span><br>my_ideal_list = [Hi.change_ring(QQ) <span class="hljs-keyword">for</span> Hi <span class="hljs-keyword">in</span> my_ideal_list]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(my_ideal_list),<span class="hljs-number">3</span>,-<span class="hljs-number">1</span>):<br>    <span class="hljs-built_in">print</span>(i)<br>    V = Ideal(my_ideal_list[:i]).variety(ring=ZZ)<br>    <span class="hljs-built_in">print</span>(V)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">OUTPUT:</span><br><span class="hljs-string">2.14285714285714</span><br><span class="hljs-string">4.64285714285714</span><br><span class="hljs-string">52</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">51</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">50</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">49</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">48</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">47</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">46</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">45</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">44</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">43</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">42</span><br><span class="hljs-string">[]</span><br><span class="hljs-string">41</span><br><span class="hljs-string">[&#123;z: 426614979768518060635433317149972303610396098751783498586225631589479798053751568080185868568717967344782297587209012869059719479952019313461850777653567018452929932659204669967695196434044149034271037885062392902287, y: 144996003362760405215910388196517232449311004246441924325936847006315296003811348342536838359, x: 66838488369949543369599279980954380920457752396291961341704448955532596917094831390389571041281062121515985150418852560085&#125;]</span><br><span class="hljs-string">40</span><br><span class="hljs-string">[&#123;z: 426614979768518060635433317149972303610396098751783498586225631589479798053751568080185868568717967344782297587209012869059719479952019313461850777653567018452929932659204669967695196434044149034271037885062392902287, y: 144996003362760405215910388196517232449311004246441924325936847006315296003811348342536838359, x: 66838488369949543369599279980954380920457752396291961341704448955532596917094831390389571041281062121515985150418852560085&#125;]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢å¼å­ä¸­, $y$ å’Œ $z$ åˆ†åˆ«å¯¹åº” $p$ å’Œ $q$ï¼Œ$x$ å¯¹åº” $d_q$ï¼Œå¤åˆ¶åˆ°ä¸‹ä¸€ä¸ªæ¡†å†…ç›´æ¥è§£å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">N=<span class="hljs-number">61857467041120006957454494977971762866359211220721592255304580940306873708357617802596067329984189345493420858543581027612648626678588277060222860337783377316655375278359169520243355170247177279595812282793212550819124960549824278287538977769728573023023364686725321548391592858202718446127851076431000427033</span><br>p=<span class="hljs-number">426614979768518060635433317149972303610396098751783498586225631589479798053751568080185868568717967344782297587209012869059719479952019313461850777653567018452929932659204669967695196434044149034271037885062392902287</span><br>q=<span class="hljs-number">144996003362760405215910388196517232449311004246441924325936847006315296003811348342536838359</span><br>e=<span class="hljs-number">22696852369762746127523066296087974245933137295782964284054040654103039210164173227291367914580709029582944005335464668969366909190396194570924426653294883884186299265660358589254391341147028477295482787041170991166896788171334992065199814524969470117229229967188623636764051681654720429531708441920158042161</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>c = <span class="hljs-number">41862679760722981662840433621129671566139143933210627878095169470855743742734397276638345217059912784871301273620533442249011607182329472311453700434692358352210197988000738272869600692181834281813995048665466937302183039555350612260646428575598237960405962714063137455677605629008760761743568236135324015278</span><br>d=inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,d,N)))<br><span class="hljs-comment">#output:b&#x27;flag&#123;tlp17_1s_4w3s0m3&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="4-2024é¹åŸæ¯-PolyPrime"><a href="#4-2024é¹åŸæ¯-PolyPrime" class="headerlink" title="4.[2024é¹åŸæ¯] PolyPrime"></a>4.[2024é¹åŸæ¯] PolyPrime</h2><h3 id="4o01-Problem"><a href="#4o01-Problem" class="headerlink" title="4o01 Problem"></a>4o01 Problem</h3><p>å…ˆçœ‹çœ‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, isPrime, bytes_to_long<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> random<br><br><br>k = getPrime(<span class="hljs-number">333</span> * <span class="hljs-number">5</span>)<br>e = <span class="hljs-number">65537</span><br>m = bytes_to_long(flag)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">temp_calc</span>(<span class="hljs-params">x</span>): <br>    <span class="hljs-keyword">return</span> (x * random.randint(<span class="hljs-number">2</span>, <span class="hljs-number">5</span>)) ^ random.randint(<span class="hljs-number">100</span>, <span class="hljs-number">500</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">some_calc</span>(<span class="hljs-params">size, depth</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sums_calc</span>(<span class="hljs-params">base, degree</span>): <br>        result = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(degree): <br>            temp = temp_calc(base ** i)<br>            result += base ** i + temp // temp_calc(base**(i + <span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        prime_number = getPrime(size)<br><br>        temp_number = temp_calc(prime_number)<br>        poly_primes = sums_calc(prime_number, depth)  <br>        <span class="hljs-keyword">if</span> temp_number % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>: <br>            temp_number = temp_calc(poly_primes)<br>            <span class="hljs-keyword">continue</span><br>        <br>        <span class="hljs-keyword">if</span> isPrime(poly_primes):<br>            <span class="hljs-keyword">return</span> prime_number, poly_primes<br><br><br>p, q = some_calc(<span class="hljs-number">333</span>, <span class="hljs-number">5</span>)<br><br>n = p * q * k<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;n = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;e = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;c = &#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>OUTPUTï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-number">659401821142664131364043958430747314465977448744532421905138184036743766362324320051729418680079590835903781525157600055608268591994754328563246418114269690475272262915661210669701969695314157602927462228079044905276064391615467601628466982949165371933147600418057089432876120807721483665788557812323607370950442342057254926375842684430119320789097029996211564275310819486004520088130146630452262340185192110066151930586956190499953220051855668474863659201165952231016814569364299000130323859609047687714260776467149437031397019411599103716200258382231589757031469168245396061619327867355414287059363691024984066070128364157490336808211223714816668548049472199794493895870662970541167490686648385211854469386812214775829776376273299648505880034651930322294605482489225723014758138525637864689594748771025870209444029669477294995691067669374491852721622469656239730320092112222948718027850386898461208936333788173263904607181823233002355650353116486156927403178510412091666951574340730799316032588099237</span><br>c = <span class="hljs-number">455042981325030540026829365098432813829591020497037525707600104817313008442900331256387443469027825344761381076471749826547710666806180999603254398722965179851898391700090501419875562919365894255855734276825027850795202733875071307773598881254863911398285400038957998385685292965812925607278232164067624548120378758414574370042945538632864154772437639053907149514588502689277630450575630168099810584842881257614115970132960679023265157277718654731105815060916800751033956715430930381384344469220951638102432198422350425390757155267143393385221465041749156153517556389417033187856017198907366720281408810250981776112815100319814215140919133440637395953567624057248002125277569474190364142291136361144552953540727462623677375371327473687508344483184466522697912317252462246054471196345909304668083637177166153036111122244170846815657389873986264187766636830907458940128844256504176917204131708083105093700023335939233711693409336968008112511482237441198116493965744903995545941700742865846469036763734618</span><br>e = <span class="hljs-number">0x10001</span><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº† $n&#x3D;pqk$ï¼Œå…¶ä¸­ $k$ æ˜¯ $333\times5$ çš„ç´ æ•°ï¼Œ $p,q$ ç”Ÿæˆæ–¹å¼å¾ˆå¥‡æ€ªã€‚</p><p>å®¡è®¡ä¸€ä¸‹ <code>temp_calc</code> å‡½æ•°ï¼Œç»™äººä¸€ç§RLWEçš„æ„Ÿè§‰ã€‚ä½†åœ¨ <code>some_calc</code> ä¸­çš„ <code>sums_calc </code> ä¸­ï¼Œè€ƒè™‘åˆ° <code>size</code> æ˜¯ $333$ï¼Œé‚£ä¹ˆå…³æ³¨è¿™ä¸€éƒ¨åˆ†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(degree): <br>temp = temp_calc(base ** i)<br>result += base ** i + temp // temp_calc(base**(i + <span class="hljs-number">1</span>))<br></code></pre></td></tr></table></figure><p>tempçš„æ•°é‡çº§æ˜¯ $333\times i$ï¼Œè€Œ <code>temp_calc(base**(i+1))</code> çš„æ•°é‡çº§æ˜¯ $333\times(i+1)$ï¼Œæ˜¯tempçš„ $2^{333}$ å€ã€‚è€Œ<code>temp_calc</code>  è¿”å› $[2x-512,5x+512]$ çš„å€¼ï¼Œå¯¹äº $2^{233}$ å®Œå…¨å¯ä»¥å¿½ç•¥ï¼Œå› æ­¤è¿™ä¸€éƒ¨åˆ†çš„å€¼è®¡ç®—ç»“æœæ€»ä¸º $0$ ã€‚æœ¬åœ°æµ‹è¯•äº†ä¸€ä¸‹ä¹Ÿç¡®å®å¦‚æ­¤ã€‚</p><p>é‚£ä¹ˆï¼Œå¯ä»¥å¾—åˆ°ï¼š$q&#x3D;p^4+p^3+p^2+p+1$ï¼Œé‚£ä¹ˆ $n&#x3D;kp(p^4+p^3+p^2+p+1)$ã€‚</p><p>å¯¹äº$$q&#x3D;p+p^2+p^3$$çš„æƒ…å½¢åœ¨[ImaginaryCTF 2023](<a href="https://github.com/maple3142/My-CTF-Challenges/tree/master/ImaginaryCTF">https://github.com/maple3142/My-CTF-Challenges/tree/master/ImaginaryCTF</a> 2023)ä¸­æœ‰è¿‡ç±»ä¼¼çš„é¢˜ç›®ï¼Œå› æ­¤å¯ä»¥ç›´æ¥å‚è€ƒé‚£ä¸ªé¢˜ç›®çš„WP <a href="https://github.com/maple3142/My-CTF-Challenges/blob/master/ImaginaryCTF%202023/Sus/solve.sage">link</a>ï¼Œç®€å•ä¿®æ”¹å‚æ•°å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <br>c = <br>e = <br>k = <span class="hljs-number">5</span><br><br>R = Zmod(n)[<span class="hljs-string">&quot;x&quot;</span>]<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    Q = R.quo(R.random_element(k))<br>    pp = gcd(ZZ(<span class="hljs-built_in">list</span>(Q.random_element() ^ n)[<span class="hljs-number">1</span>]), n)<br>    <span class="hljs-keyword">if</span> pp != <span class="hljs-number">1</span>:<br>        qq = <span class="hljs-built_in">sum</span>([pp**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k)])<br>        rr = n // (pp * qq)<br>        <span class="hljs-keyword">assert</span> n == pp * qq * rr<br>        <span class="hljs-keyword">break</span><br>phi = (pp - <span class="hljs-number">1</span>) * (qq - <span class="hljs-number">1</span>) * (rr - <span class="hljs-number">1</span>)<br>d = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br><span class="hljs-comment">#b&#x27;flag&#123;som3thing_1nter3sting_1n_su5&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="4o02-Proof"><a href="#4o02-Proof" class="headerlink" title="4o02 Proof"></a>4o02 Proof</h3><p>å½“ç„¶ç›´æ¥æŠŠåŸé¢˜æ¬è¿‡æ¥è‚¯å®šæ˜¯ä¸å¤ªå¥½çš„ï¼Œçœ‹çœ‹æ€ä¹ˆè¯æ˜çš„ï¼Ÿ</p><blockquote><p>Pick a random polynomial $f(x)&#x3D;x^3+ax^2+bx+c$, and pick a random element a in $R&#x3D;\mathbb Z_n[x]&#x2F;f(x)$ . If $f(x)$ is irreducible in $\mathbb F_p[x]$ then the filed $\mathbb K&#x3D;\mathbb F_p[x]&#x3D; \mathbb F_p[x]&#x2F;f(x)&#x3D;\mathbb F_{p^3}$ will be a field with order $p^3âˆ’1&#x3D;(pâˆ’1)(p^2+p+1)$.</p><p>We raise a to the power of $n&#x3D;pqr&#x3D;p(p^2+p+1)r$ then an would probably be of order $pâˆ’1$, which implies it will be in the form of $u+0x+0x^2$ in $\mathbb K$. This means we can take the degree $1$ or $2$ coefficient of an in $R$ and gcd it with $n$ to get $p$, then we can fully factor $n$ to decrypt the flag.</p><p>This is basically the same idea as Pollardâ€™s $p-1$ or Williamsâ€™ $p+1$ factorization algorithm, but we are doing it in a field with higher degree.</p></blockquote><p>ç¬¬ä¸€æ®µç»™å‡ºäº†æ¨¡ $p$ æ„ä¹‰ä¸‹ $n$ é˜¶æœ‰é™åŸŸçš„ $\mathbb F_{p^n}$ çš„æ„é€ è¿‡ç¨‹ï¼Œè¿™ä¸ªåœ¨ä¿¡å®‰æ•°åŸºä¸­è®²è¿‡ï¼Œä¸ç»†è¯´äº†ã€‚</p><p>ç„¶åç®€å•æä¸€ä¸‹ï¼Œä¸ºå•¥ $x^4+x^3+x^2+x+1$ ä¸å¯çº¦ï¼Œæ‰“ä¸ªè¡¨çœ‹ä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°ï¼Œå¦‚æœ $n$ æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆ $\sum_{i&#x3D;0}^{n-1}$ ä¸å¯çº¦ã€‚</p><p><img src="/2024/11/15/24Nov2/5.png" alt="5"></p><p>å…¶å®è¿™ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸ºè¿™å°±æ˜¯ä¸€ä¸ªç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼ã€‚<br>$$<br>\sum_{i&#x3D;0}^{n-1} x^i&#x3D;\frac{x^{n}-1}{x-1}<br>$$<br>ç„¶åå°±æ˜¯è€ƒè™‘ $x^n-1$ çš„é—®é¢˜ï¼Œæ®è¯´ä¸åˆ†åœ†åŸŸå’Œåˆ†åœ†å¤šé¡¹å¼æœ‰å…³ã€‚</p><p>å› ä¸ºä»¤ $x^n-1&#x3D;0$ï¼Œåœ¨ $\mathbb C$ ä¸­å¯ä»¥è§£å¾— $x&#x3D;\omega(i,n)&#x3D;\cos \frac{2k\pi}{n}+\mathrm i\sin \frac{2k\pi}{n}$ï¼Œå…¶ä¸­ $k&#x3D;1,2,â€¦,n$ï¼Œ$x_n&#x3D;\omega(n,n)&#x3D;1$ã€‚å¦‚æœ $n$ æ˜¯ç´ æ•°ï¼Œå‡è®¾ $i&#x3D;1,2,â€¦,n-1$ï¼Œé‚£ä¹ˆ $\omega(i,n)$ çš„é˜¶ä¸€å®šæ˜¯ $n$ï¼Œå› ä¸º $\gcd(i,n)$ ä¸€å®šä¸º $1$ ã€‚å¦‚æœ $n$ ä¸æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆ $\omega(i,n)$ çš„é˜¶ä¸ä¸º $n$ã€‚æ¯”å¦‚å½“ $n&#x3D;4$ æ—¶ï¼Œ$\omega(1,4)&#x3D;\mathrm i$ï¼Œ$\omega(2,4)&#x3D;-1$ï¼Œ$-1$ çš„é˜¶æ•°æ˜¯ $2$ è€Œä¸æ˜¯ $4$ã€‚</p><p>è¿™ä¸ª $\omega$ ä¹Ÿæ¯”è¾ƒæœ‰è¶£ï¼Œæ¯”å¦‚å¤§æ•°ä¹˜æ³•å¯ä»¥ä½¿ç”¨FFT&#x2F;NTTå®ç°ï¼Œæœ€å¸¸ç”¨æ¨¡æ•°å°±æ˜¯ $998244353$ï¼Œå› ä¸º $998244353-1&#x3D;2^{23}\times7\times17$ï¼Œå…¶åŸæ ¹ä¸º $3$ï¼Œåœ¨NTTä¸­ï¼Œæœ€é•¿å¯ä»¥è®¡ç®—åˆ° $2^{23}$ æ¬¡å•ä½æ ¹ä¸æŸå¤±ç²¾åº¦ï¼ˆå…·ä½“NTTå¯ä»¥è‡ªè¡Œäº†è§£ï¼ŒRLWEä¸­å¸¸ç”¨çš„æ¨¡æ•° $12289$ å’Œ $786433$ ä¹Ÿæœ‰è¿™ä¸ªæ€§è´¨ï¼‰ã€‚å…¶å…·æœ‰ä¸€ä¸ªé‡è¦æ€§è´¨å°±æ˜¯ $\omega(a,n)^b&#x3D;\omega(ab,n)$ å’Œ $\omega(a,n)\omega(b,n)&#x3D;\omega(a+b,n)$</p><blockquote><p>å½“ç„¶ï¼Œå¦‚æœè¯»è€…è§‰å¾—ä¸ç†è§£ï¼Œå¯ä»¥å°è¯•åœ¨åŸç‚¹ç”»ä¸€ä¸ªå•ä½åœ†ï¼Œä» $x^+$ è½´å¼€å§‹åˆ’åˆ†è¿™ä¸ªåœ†ä¸º $n$ ç­‰ä»½ï¼Œæ¯ä¸€ä»½å¯¹åº”åœ†ä¸Šç‚¹çš„åæ ‡å°±æ˜¯ $(\cos \frac{2k\pi}{n},\sin\frac{2k\pi}{n})$ï¼Œç„¶åè®¾ $\theta_k$ ä¸ºå¯¹åº”è§’ï¼Œè‡ªå·±ä» $(1,0)$ å¼€å§‹ï¼Œæ¯æ¬¡æ—‹è½¬ $\theta_k$ï¼Œçœ‹çœ‹æœ€å¿«å›åˆ° $(1,0)$ éœ€è¦å‡ æ­¥ã€‚è¿™å…¶å®å°±å¯¹åº”äº†æ—‹è½¬å˜æ¢ã€‚</p></blockquote><p>è¯»è€…å¦‚æœæœ‰å…´è¶£çš„è¯å¯ä»¥çœ‹çœ‹åˆ†åœ†å¤šé¡¹å¼æ€ä¹ˆæ±‚çš„ï¼Œæˆ‘å¤§æ¦‚çœ‹å‡ºæ¥äº†å‡ ä¸ªæ€§è´¨ï¼ˆä»¥åå†è¡¥å……ï¼‰</p><blockquote><ol><li>è‹¥ $n$ ä¸ºç´ æ•°ï¼Œ$n$ æ¬¡åˆ†åœ†å¤šé¡¹å¼ä¸º $f_n(x)&#x3D;\sum_{i&#x3D;1}^{n-1}x^i$ï¼Œæ¯”å¦‚ $f_3(x)&#x3D;x^2+x+1$</li><li>$2n$ æ¬¡åˆ†åœ†å¤šé¡¹å¼ä¸º $f_n(-x)$ï¼Œæ¯”å¦‚ $f_6(x)&#x3D;x^2-x+1$ã€‚</li><li>è‹¥ $n$ ä¸ºç´ æ•°ï¼Œåˆ™ $n^a$ æ¬¡åˆ†åœ†å¤šé¡¹å¼ä¸º $f_n(x^{n^{a-1}})$ï¼Œæ¯”å¦‚ $f_9(x)&#x3D;f_3(x^3)&#x3D;x^6+x^3+1$ï¼Œ$f_{27}(x)&#x3D;f_3(x^9)&#x3D;x^{18}+x^9+1$ã€‚</li><li>$n$ æ¬¡åˆ†åœ†å¤šé¡¹å¼æ¬¡æ•°ä¸º $\varphi(n)$ã€‚</li></ol></blockquote><p>è²Œä¼¼æ‰¯è¿œäº†ï¼ˆå°´å°¬ï¼‰ï¼Œåæ­£å…ˆçŸ¥é“ $x^4+x^3+x^2+x+1$ ä¸å¯çº¦ã€‚è¿™è¾¹é˜¶æ•°æ˜¯ $5$ï¼Œé‚£ä¹ˆ $\mathbb F_{p^5}$ ä¸Šï¼Œé™¤äº† $0$ ä¹‹å¤–ï¼Œéƒ½æœ‰ $a^{p^5-1}&#x3D;1$ ã€‚ç„¶å $p^5-1&#x3D;(p^4+p^3+p^2+p+1)(p-1)$ã€‚åŒæ—¶ï¼Œå¯¹äºä¸€ä¸ªç¾¤è€Œè¨€ï¼Œè‹¥ $a^{k}&#x3D;1$ï¼Œåˆ™æ»¡è¶³æ¡ä»¶çš„ $a$ æœ‰ $k$ ä¸ªï¼Œ$k$ æ•´é™¤ç¾¤çš„é˜¶æ•°ã€‚å› æ­¤ï¼Œ$k&#x3D;p-1$ æ—¶ï¼Œæ»¡è¶³ $a^{p-1}&#x3D;1$ çš„å…ƒç´ å¾ˆæ˜æ˜¾æœ‰ $p-1$ ä¸ªï¼Œå°±æ˜¯ $1,2,â€¦,p-1$ã€‚å¸¦ $x$ çš„é˜¶æ•°ä¸€å®šä¸æ˜¯ $p-1$ã€‚</p><p>å› æ­¤ï¼Œå¯¹ $x$ åš $n$ æ¬¡æ–¹ï¼Œé‚£ä¹ˆ $x^{n}&#x3D;x^{kp(p^4+p^3+p^2+p+1)}$ï¼Œå¯ä»¥çœ‹åˆ° $x$ çš„æŒ‡æ•°ä¸Šæœ‰ $p^4+p^3+p^2+p+1$ æ•´é™¤ $p^5-1$ï¼Œå› æ­¤ $x^n$ çš„é˜¶ä¸€å®šä¸º $p-1$ï¼Œä¸” $x^n&#x3D;1$ çš„æ¦‚ç‡æ˜¯å¯å¿½ç•¥çš„ã€‚å› æ­¤ $x^n$ åœ¨åŸŸä¸­çš„ç»“æœï¼Œå¸¦ $x$ çš„é¡¹çš„ç³»æ•°ä¸€å®šæ˜¯ $p$ çš„å€æ•°ï¼Œåšå…¬çº¦æ•°å°±å¯ä»¥åˆ†è§£ $n$ äº†ã€‚</p><h2 id="5-2024é¹åŸæ¯-rickroll-èµ›åè¡¥é¢˜"><a href="#5-2024é¹åŸæ¯-rickroll-èµ›åè¡¥é¢˜" class="headerlink" title="5.[2024é¹åŸæ¯]rickroll(èµ›åè¡¥é¢˜)"></a>5.[2024é¹åŸæ¯]rickroll(èµ›åè¡¥é¢˜)</h2><p>é¹åŸæ¯ä¸€å…±6ä¸ªå¯†ç é¢˜ï¼Œåšäº†5ä¸ªï¼Œæœ‰ä¸€ä¸ªqwbé‚£ä¸ªapbqçš„ç¬¬ä¸‰é—®ï¼Œè¿˜æœ‰ä¸€ä¸ªé¢˜ç›®è¿‡äºtrivialï¼Œå°±ä¸æ”¾äº†ã€‚å½“æ—¶åšå®Œå·²ç»18:15äº†ï¼Œçœ‹äº†ä¸€ä¸‹è¿™ä¸ªé¢˜ï¼Œå°±å¿™åˆ«çš„äº†ã€‚è¿™é‡Œè¡¥ä¸€ä¸‹é¢˜ã€‚</p><p>å…ˆçœ‹ä¸€çœ¼é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> xor<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><br><br>HINT = ?<br>FLAG = <span class="hljs-string">&quot;flag&#123;xxxxxxxx&#125;&quot;</span><br>EFFECTIVE_ROW = <span class="hljs-number">6</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rickroll_loader</span>():<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;rickroll&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>        lines = [line.strip().encode() <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file <span class="hljs-keyword">if</span> line.strip()]<br>    <span class="hljs-keyword">return</span> lines<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_ezprime</span>(<span class="hljs-params">size</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        prime = getPrime(size)<br>        <span class="hljs-keyword">if</span> isPrime(prime // <span class="hljs-number">2</span>):<br>            <span class="hljs-keyword">return</span> prime<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">secure_encrypt</span>(<span class="hljs-params">message_parts, hint_value</span>):<br>    modulus = find_ezprime(<span class="hljs-number">260</span>)<br><br>    key_material = os.urandom(<span class="hljs-number">32</span>)<br>    multipliers = [getrandbits(<span class="hljs-number">256</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(EFFECTIVE_ROW)]<br><br>    encrypted_parts = [<br>        <span class="hljs-built_in">int</span>((multiplier * hint_value + bytes_to_long(xor(pad(chunk, <span class="hljs-number">32</span>)<br>            [::-<span class="hljs-number">1</span>], key_material))) % (modulus - <span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">for</span> multiplier, chunk <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(multipliers, message_parts)<br>    ]<br><br>    <span class="hljs-keyword">return</span> encrypted_parts, multipliers, modulus<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    rickroll = rickroll_loader()<br>    m = bytes_to_long(HINT)<br><br>    encrypted_lyrics, multipliers, modulus = secure_encrypt(<br>        rickroll[:EFFECTIVE_ROW], m)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;S =&quot;</span>, encrypted_lyrics)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;V =&quot;</span>, multipliers)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>, modulus)<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">S = [624073892368439332713131144655355187273652775732037030273908973687487472640419, 1129513550732743550887354593625951854836036688324123410864182971141396110133306, 1117643028354341949186759218964558582164677605237787761003042032239935547551873, 151619055620013230556169740951169935393567570823439146992800622058967940011364, 596106506159944398847755500086869373163910176213091804211992440336880292610397, 685472210701608040945173323626153641749419080165879222271110177606156013942182]</span><br><span class="hljs-string">V = [100024809269721744282017864103544473542698741247649693420201028956644193231147, 85493218764912449360009112267171851264674952927507787108286827385372626006804, 75451455656190167222034904545925816909383290106210237096763781707294423744719, 1864420400658866895837249178680154965580281261003086054650703872439476331244, 111069754111223622246512532174936637994215526100226395068812327641951277359169, 88031405587803201423744918486788030404029698214504194443110805396831023823738]</span><br><span class="hljs-string">n = 1497114501625523578039715607844306226528709444454126120151416887663514076507099</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>rickroll.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>Never gonna give you up<br>Never gonna let you down<br>Never gonna run around <span class="hljs-keyword">and</span> desert you<br>Never gonna make you cry<br>Never gonna say goodbye<br>Never gonna tell a lie <span class="hljs-keyword">and</span> hurt you<br>--A mysterious singer who does <span class="hljs-keyword">not</span> want to be named.<br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº† $S,V,n$ å’Œæ˜æ–‡ç»“æœã€‚</p><p>çœ‹ä¸€çœ¼è¿™ä¸ªåŠ å¯†å‡½æ•°ï¼šè¿™ä¸ªåŠ å¯†æ–¹å¼æ¯”è¾ƒå¥‡æ€ªï¼šè®¾ $q$ ä¸ºç´ æ•°ï¼Œ $n&#x3D;2q+1$ ä¹Ÿæ˜¯ç´ æ•°ï¼Œå¯†é’¥ $k$ æ˜¯32å­—èŠ‚å›ºå®šå†…å®¹ã€‚è®¾ $x&#x3D;\mathrm{hintvalue}$ï¼Œåˆ™æ¯æ¬¡ç”Ÿæˆä¸€ä¸ªéšå³æ•° $A$ ä½œä¸ºä¹˜æ•°ï¼Œç„¶åä¹˜ $x$ã€‚ç„¶åå†åŠ ä¸Š $m_i \oplus k$ çš„ç»“æœã€‚å…¶ä¸­ $m_i$ è¿›è¡Œäº†å¡«å……ã€‚ä¹Ÿå°±æ˜¯<br>$$<br>C_i\equiv A_ix+m_i\oplus k \pmod {n-1}<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">secure_encrypt</span>(<span class="hljs-params">message_parts, hint_value</span>):<br>    modulus = find_ezprime(<span class="hljs-number">260</span>)<br><br>    key_material = os.urandom(<span class="hljs-number">32</span>)<br>    multipliers = [getrandbits(<span class="hljs-number">256</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(EFFECTIVE_ROW)]<br><br>    encrypted_parts = [<br>        <span class="hljs-built_in">int</span>((multiplier * hint_value + bytes_to_long(xor(pad(chunk, <span class="hljs-number">32</span>)<br>            [::-<span class="hljs-number">1</span>], key_material))) % (modulus - <span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">for</span> multiplier, chunk <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(multipliers, message_parts)<br>    ]<br></code></pre></td></tr></table></figure><p>å½“æ—¶æ„Ÿè§‰åƒæ˜¯ä¸€ä¸ªHNPé—®é¢˜ï¼Œä½†è¿™ä¸ªé¢˜æ²¡æœ‰HNPé‚£ç§æ˜æ˜¾çš„æ ‡å¿—ï¼ˆï¼Œç„¶åé‚£å¤©äº‹æƒ…æœ‰ç‚¹å¤šï¼Œå°±æš‚æ—¶æ”¾å¼ƒäº†ã€‚ã€‚</p><p>ä¸è¿‡èµ›ååœ¨strivingâœŒçš„æç¤ºä¸‹ï¼Œæˆ‘åˆå›çœ‹äº†ä¸€ä¸‹è¿™ä¸ªé¢˜ç›®ã€‚</p><p>å—é™ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼šæ¯ä¸€å¥è¯éƒ½æ˜¯ä»¥ <code>Never\x20gonna\x20 </code> å¼€å¤´çš„ï¼ˆé•¿åº¦ä¸º12ï¼‰ï¼Œå¹¶ä¸” <code>len(Msg[0])==len(Msg[4]),len(Msg[1])==len(Msg[3])</code>ã€‚é•¿åº¦ç›¸åŒï¼Œå°±æ„å‘³ç€å¡«å……å†…å®¹ä¹Ÿç›¸åŒï¼Œé‚£ä¹ˆå¼‚æˆ–åŒä¸€ä¸ª $k$ ä¹‹åï¼Œå¾—åˆ°çš„å†…å®¹ä¹Ÿç›¸åŒã€‚</p><p><img src="/2024/11/15/24Nov2/6.png" alt="6"></p><p>é‚£ä¹ˆä¸Šé¢çš„åŠ å¯†å°±å¯ä»¥å†™æˆè¿™ç§å½¢å¼ã€‚å› ä¸º $n&#x3D;2q+1$ï¼Œæ‰€ä»¥ $n-1&#x3D;2q$ï¼Œå› æ­¤å¯ä»¥è€ƒè™‘æ¨¡ $q$ æ„ä¹‰ä¸‹çš„å€¼ã€‚<br>$$<br>C_i\equiv A_ix+B_{Hi}+B_{Mi}+B_{Li} \pmod q<br>$$<br>è®¡ç®— $C_{04}&#x3D;C_0-C_4,C_{13}&#x3D;C_1-C_3$ï¼Œæœ‰<br>$$<br>\Delta C_{04}\equiv\Delta A_{04}x+\Delta B_{04}\pmod q \tag{F}<br>$$<br>å’Œ<br>$$<br>\Delta C_{13}&#x3D;\Delta A_{13}x+\Delta B_{13}\pmod q\tag{G}<br>$$<br>è¿™ä¸ªä½æ•°å¤§æ¦‚åœ¨ $2^{96}$ å¼€å§‹çš„ï¼Œ$x$ é•¿åº¦æœªçŸ¥ï¼Œå› ä¸ºåšå·®åï¼Œ$B$ ç›¸åŒçš„éƒ¨åˆ†è¢«å‡æ‰äº†ã€‚æ‰€ä»¥ $2^{96}\Delta B_{M04}&#x3D;\Delta B_{04}$ï¼Œ$2^{96}\Delta B_{M13}&#x3D;\Delta B_{13}$ã€‚$\Delta B_{M04}$ çº¦ä¸º $88$ ä½ï¼Œ$\Delta B_{M13}$ çº¦ä¸º $96$ ä½ã€‚</p><p>è¿™è¾¹ä¸¤ä¸ªæ–¹ç¨‹ï¼Œä¸‰ä¸ªæœªçŸ¥é‡ $\Delta B_{M13},\Delta B_{M04},x$ã€‚å› ä¸º $x$ çš„ç³»æ•°å·²çŸ¥ï¼Œå› æ­¤å¯ä»¥è®¡ç®— $A_{13}\text{(F)}-A_{04}\text{(G)}$ æ¶ˆå» $x$ï¼Œå°±å˜æˆäº†ï¼š<br>$$<br>2^{96}\Delta A_{13}\Delta B_{M04}-2^{96}\Delta A_{04}\Delta B_{M13}+\Delta C_{04}\Delta A_{13}-\Delta A_{04}\Delta C_{13}\equiv 0\pmod q<br>$$<br>å»åŒä½™ï¼Œæœ‰<br>$$<br>2^{96}\Delta A_{13}\Delta B_{M04}-2^{96}\Delta A_{04}\Delta B_{M13}+\Delta C_{04}\Delta A_{13}-\Delta A_{04}\Delta C_{13}-kq&#x3D;0<br>$$<br>æ„é€ çŸ©é˜µï¼š</p><p><img src="/2024/11/15/24Nov2/7.png" alt="7"></p><p>ä¸è¿‡è¿™æ ·è²Œä¼¼æ˜¯æ±‚ä¸å‡ºæ¥çš„ï¼Œå› æ­¤è¿˜éœ€è¦ä¸€ä¸ªå¹³è¡¡ç³»æ•°ï¼šå› ä¸º$\Delta B_{M04}$ çº¦ä¸º $88$ ä½ï¼Œ$\Delta B_{M13}$ çº¦ä¸º $96$ ä½ï¼Œå› æ­¤å‰ä¸‰åˆ—çš„å¹³è¡¡ç³»æ•°åˆ†åˆ«ä¸º $(2^8,1,2^{96})$ï¼Œç„¶åä¸ºäº†æ‰©å¤§è¡Œåˆ—å¼ï¼Œæœ€åä¸€åˆ—ä¹Ÿç»™ä¹˜ä¸ª $2^{96}$ã€‚</p><blockquote><p>è‡³äºè¿™ä¸ªå¹³è¡¡ç³»æ•°ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ„é€ çš„çŸ©é˜µæ˜¯ä¸€ä¸ªä¸Šä¸‰è§’çŸ©é˜µï¼Œå› æ­¤å…¶è¡Œåˆ—å¼å€¼å°±æ˜¯å¯¹è§’çº¿å››ä¸ªæ•°çš„ä¹˜ç§¯ã€‚æˆ‘ä»¬æƒ³è¦çš„æ•°å­—åœ¨ $2^{96}$ è§„æ¨¡ï¼Œå› æ­¤æˆ‘ä»¬å°±éœ€è¦å°†è¡Œåˆ—å¼æå‡åˆ°è‡³å°‘ $2^{384}$ã€‚åˆæ­¥æ„é€ ä¸­ï¼Œå› ä¸º $\Delta B_{M04},\Delta B_{M13}$ æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæˆ‘ä»¬åœ¨å¯¹åº”æ ¼æ”¾äº†ä¸ª $1$ï¼Œç¬¬ä¸‰åˆ—çš„ $1$ ç›®çš„æ˜¯å’Œå·²çŸ¥çš„å¸¸æ•°ç›¸ä¹˜ã€‚ä½†ä¸‰ä¸ª $1$ æ”¾åœ¨å¯¹è§’çº¿ä¸Šå®åœ¨æ˜¯å¤ªå°äº†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¹³è¡¡ä¸€ä¸‹å‰ä¸‰åˆ—ã€‚ä¼°è®¡å…¶å€¼ä¸ $2^{96}$ çš„å·®è·ã€‚åˆ†åˆ«å·®äº† $2^{8},1,2^{96}$ï¼Œå› æ­¤ä¹˜ä¸Šå¹³è¡¡ç³»æ•°ä¹‹åå¯ä»¥ä¿æŒæ¯ä¸€åˆ—æ•°é‡çº§ç›¸ç­‰ã€‚è€Œæœ€åä¸€åˆ—å†ä¹˜ä¸€ä¸ªå¾ˆå¤§çš„æ•°å­—ï¼Œæ˜¯ä¸ºäº†æ‰©å¤§çŸ©é˜µä¸­æ¯ä¸€è¡Œå‘é‡çš„é•¿åº¦ï¼Œå¹¶ä¸”æœ€åä¸€åˆ—è®¡ç®—å¾—åˆ°ç»“æœä¸º$0$ã€‚</p><p>è¿™æ ·æ“ä½œåï¼Œä¸ä»…æ‰©å¤§äº†è¡Œåˆ—å¼ï¼Œè¿˜æ²¡æœ‰ç ´ååŸæœ‰å…³ç³»ï¼Œè¿›ä¸€æ­¥ç¡®ä¿æˆ‘ä»¬çš„ç›®æ ‡å‘é‡ä¸ºçŸ­å‘é‡</p></blockquote><p>å› æ­¤ï¼Œå¯¹çŸ©é˜µLLLä¹‹åï¼Œå¯ä»¥å¾—åˆ°æœ€çŸ­å‘é‡ä¸º $(2^{8}\Delta B_{M04},B_{M13},2^{96},0)$ã€‚å› æ­¤æˆ‘ä»¬æ‰¾ç¬¬ä¸‰ä¸ªåˆ†é‡ä¸º $2^{96}$ çš„å‘é‡ $\vec v$ï¼Œé‚£ä¹ˆå…¶ç¬¬äºŒä¸ªåˆ†é‡å°±æ˜¯ $\Delta B_{M13}$ã€‚</p><p>EXPï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bytexor</span>(<span class="hljs-params">b1,b2</span>):<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(b1)&lt;<span class="hljs-built_in">len</span>(b2)):<br>        b1,b2=b2,b1<br>    lenb1,lenb2=<span class="hljs-built_in">len</span>(b1),<span class="hljs-built_in">len</span>(b2)<br>    bs=[<span class="hljs-number">0</span>]*lenb1<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(lenb1):<br>        bs[i]=b1[i]^^b2[i%lenb2]<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(bs)<br>Msg=[<br><span class="hljs-string">b&#x27;Never gonna give you up&#x27;</span>,<br><span class="hljs-string">b&#x27;Never gonna let you down&#x27;</span>,<br><span class="hljs-string">b&#x27;Never gonna run around and desert you&#x27;</span>,<br><span class="hljs-string">b&#x27;Never gonna make you cry&#x27;</span>,<br><span class="hljs-string">b&#x27;Never gonna say goodbye&#x27;</span>,<br><span class="hljs-string">b&#x27;Never gonna tell a lie and hurt you&#x27;</span>]<br>S = [<span class="hljs-number">624073892368439332713131144655355187273652775732037030273908973687487472640419</span>, <span class="hljs-number">1129513550732743550887354593625951854836036688324123410864182971141396110133306</span>, <span class="hljs-number">1117643028354341949186759218964558582164677605237787761003042032239935547551873</span>, <span class="hljs-number">151619055620013230556169740951169935393567570823439146992800622058967940011364</span>, <span class="hljs-number">596106506159944398847755500086869373163910176213091804211992440336880292610397</span>, <span class="hljs-number">685472210701608040945173323626153641749419080165879222271110177606156013942182</span>]<br>V = [<span class="hljs-number">100024809269721744282017864103544473542698741247649693420201028956644193231147</span>, <span class="hljs-number">85493218764912449360009112267171851264674952927507787108286827385372626006804</span>, <span class="hljs-number">75451455656190167222034904545925816909383290106210237096763781707294423744719</span>, <span class="hljs-number">1864420400658866895837249178680154965580281261003086054650703872439476331244</span>, <span class="hljs-number">111069754111223622246512532174936637994215526100226395068812327641951277359169</span>, <span class="hljs-number">88031405587803201423744918486788030404029698214504194443110805396831023823738</span>]<br>n = <span class="hljs-number">1497114501625523578039715607844306226528709444454126120151416887663514076507099</span><br>q=n//<span class="hljs-number">2</span><br>detAx04=(V[<span class="hljs-number">0</span>]-V[<span class="hljs-number">4</span>])%q<br>detBx04=(S[<span class="hljs-number">0</span>]-S[<span class="hljs-number">4</span>])%q<br>detAx13=(V[<span class="hljs-number">1</span>]-V[<span class="hljs-number">3</span>])%q<br>detBx13=(S[<span class="hljs-number">1</span>]-S[<span class="hljs-number">3</span>])%q<br>M=[<br>    [<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,(<span class="hljs-number">2</span>**<span class="hljs-number">96</span>*detAx13)%q],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,(-<span class="hljs-number">2</span>**<span class="hljs-number">96</span>*detAx04%q)],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,(detBx04*detAx13-detAx04*detBx13)%q],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,q]<br>]<br>M=Matrix(ZZ,M)<br>M=M*diagonal_matrix(ZZ,[<span class="hljs-number">2</span>**<span class="hljs-number">8</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">96</span>,<span class="hljs-number">2</span>**<span class="hljs-number">96</span>])<br>MLLL=M.LLL()<br><span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> MLLL:<br>    <span class="hljs-keyword">if</span>(v[<span class="hljs-number">2</span>]==<span class="hljs-number">2</span>**<span class="hljs-number">96</span>):<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(v)<br>long_to_bytes((detBx13+v[<span class="hljs-number">1</span>]*<span class="hljs-number">2</span>**<span class="hljs-number">96</span>)*inverse(detAx13,q)%q)<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">(-<span class="hljs-number">6513984789217167717123492864</span>, <span class="hljs-number">2791429855208147482625244161</span>, <span class="hljs-number">79228162514264337593543950336</span>, <span class="hljs-number">0</span>)<br><span class="hljs-string">b&quot;Md5 of &#x27;r1ckr01l&#x27; in the flag&quot;</span><br></code></pre></td></tr></table></figure><p>å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†hintï¼š<code>Md5 of &#39;r1ckr01l&#39; in the flag</code>ï¼Œå› æ­¤æœ€ç»ˆç­”æ¡ˆä¸º <code>flag&#123;a0fd873d6622f7552f8141baeb0f7ee8&#125;</code>ã€‚</p><h2 id="6-å¼ºç½‘æ‹Ÿæ€2024-brokenoracle"><a href="#6-å¼ºç½‘æ‹Ÿæ€2024-brokenoracle" class="headerlink" title="6.[å¼ºç½‘æ‹Ÿæ€2024]brokenoracle"></a>6.[å¼ºç½‘æ‹Ÿæ€2024]brokenoracle</h2><p>11æœˆ25æ—¥ï¼Œå‘å¤–æ ¡çš„å¸ˆå‚…è¦äº†ä¸€ä¸ªå¼ºç½‘æ‹Ÿæ€çš„é¢˜ç›®ï¼Œæ„Ÿè§‰ä¸æ˜¯å¾ˆéš¾ï¼Œä½†å› ä¸ºè‡ªå·±æƒ³ç®€å•äº†ï¼Œæ‰€ä»¥æœ¬åœ°æè¿˜æ˜¯ç”¨äº† 3 å°æ—¶ã€‚</p><p>å…ˆçœ‹ä¸€çœ¼é¢˜ç›®ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime,getStrongPrime<br><span class="hljs-keyword">from</span> Crypto.Random <span class="hljs-keyword">import</span> get_random_bytes<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">4096</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;&gt; &#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        p=getStrongPrime(<span class="hljs-number">512</span>)<br>        q=getStrongPrime(<span class="hljs-number">512</span>)<br>        e=<span class="hljs-number">65537</span><br>        n=p*q<br>        phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>        d=<span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,phi)<br>        token=os.urandom(<span class="hljs-number">1000</span>//<span class="hljs-number">8</span>)<br>        c=<span class="hljs-built_in">pow</span>(bytes_to_long(token),e,n)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;n=&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">hex</span>(n).encode())<br>        <br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;your token is&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">hex</span>(c).encode())<br>        <br>        signal.alarm(<span class="hljs-number">60</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;give me your message to decrypt&quot;</span>)<br>            c=<span class="hljs-variable language_">self</span>.recv()<br>            <span class="hljs-keyword">try</span>:<br>                c=<span class="hljs-built_in">int</span>(c,<span class="hljs-number">16</span>)<br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;wrong!&quot;</span>)<br>                <span class="hljs-variable language_">self</span>.request.close()<br>                <br>            <br>            m=<span class="hljs-built_in">pow</span>(c,d,n)<br>            brokenm=m&amp;((<span class="hljs-number">2</span>**(<span class="hljs-number">40</span>)-<span class="hljs-number">1</span>)*(<span class="hljs-number">2</span>**<span class="hljs-number">492</span>))<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">hex</span>(brokenm).encode())<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;give me your token&quot;</span>)<br>        t1=<span class="hljs-variable language_">self</span>.recv()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">bytes</span>.fromhex(t1.decode())==token:<br>            f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./flag&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<span class="hljs-comment">#æ­¤éƒ¨åˆ†æœ¬åœ°å¤ç°æ—¶æœ‰æ‰€ä¿®æ”¹</span><br>            flag=f.read()<br>            f.close()<br>            <span class="hljs-variable language_">self</span>.send(flag)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;wrong! try again!&quot;</span>)    <br>        <span class="hljs-variable language_">self</span>.request.close()<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">9999</span> <span class="hljs-comment">#æœ¬åœ°å¤ç°æ”¹æˆäº†60712ç«¯å£ï¼Œå‘ƒï¼Œè‡ªå·±æœ¬åœ°å¤ç°ä¸€èˆ¬ä»60709ç«¯å£å¼€å§‹å¯ç”¨ã€‚</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;HOST:POST &quot;</span> + HOST+<span class="hljs-string">&quot;:&quot;</span> + <span class="hljs-built_in">str</span>(PORT))<br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br><br></code></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªé¢˜å’Œ RSA ParityOracleç±»ä¼¼ï¼Œä¸è¿‡æ—¢ä¸çŸ¥é“æœ€é«˜ä½ï¼Œä¹Ÿä¸æ˜¯çŸ¥é“æœ€ä½ä½ï¼Œå½“æ„é€ å¯†æ–‡å‘è¿‡å»ä¹‹åï¼ŒæœåŠ¡å™¨ä¼šç»™ä½ è§£å¯†ï¼Œå¹¶è¿”å›å¯¹åº”æ˜æ–‡çš„ $40$ æ¯”ç‰¹å†…å®¹ï¼Œå¯¹åº”çš„ä½æƒä¸º $2^{492}\sim2^{531}$ã€‚æ—¶é—´é™åˆ¶ 1minï¼ŒæŸ¥è¯¢é™åˆ¶ 100 æ¬¡ã€‚</p><p>æ—¢ç„¶è¿™æ ·ï¼Œé‚£å°±å¯ä»¥ä»Parity Oracleé‚£é‡Œæƒ³ã€‚å¯ä»¥å…ˆæœ¬åœ°å†™ä¸ªä»£ç æµ‹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p=getStrongPrime(<span class="hljs-number">512</span>)<br>q=getStrongPrime(<span class="hljs-number">512</span>)<br>e=<span class="hljs-number">65537</span><br>n=p*q<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=<span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,phi)<br>token=bytes_to_long(os.urandom(<span class="hljs-number">1000</span>//<span class="hljs-number">8</span>))<br>c=<span class="hljs-built_in">pow</span>((token),e,n)<br>mask=(<span class="hljs-number">2</span>**<span class="hljs-number">40</span>-<span class="hljs-number">1</span>)&lt;&lt;<span class="hljs-number">492</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:0256X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(token))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">E</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(x,e,n))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">D</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(x,d,n))&amp;mask<br>u=<span class="hljs-built_in">pow</span>(<span class="hljs-number">16</span>,e,n)<br>c0=c<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>    dc0=D(c0)<br>    dc0&gt;&gt;=<span class="hljs-number">492</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:10X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(dc0))<br>    c0=c0*u%n<br><span class="hljs-comment">#D887DFB86E</span><br><span class="hljs-comment">#887DFB86E2</span><br><span class="hljs-comment">#87DFB86E2F</span><br><span class="hljs-comment">#7DFB86E2F7</span><br><span class="hljs-comment">#DFB86E2F73</span><br><span class="hljs-comment">#FB86E2F731</span><br><span class="hljs-comment">#FD147B8278</span><br><span class="hljs-comment">#15EE0436F4</span><br><span class="hljs-comment">#B61FBFBC52</span><br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿå‰6ä¸ªæ•°æ®ï¼Œç»“æœåˆ†åˆ«ä¸ºï¼š$\mathtt{D887DFB86EH,887DF86E2H,87DFB86E2FH,7DFB86E2F7H,DFB86E2F73H,FB86E2F731H}$ã€‚æœ‰å¾ˆæ˜æ˜¾çš„ç§»ä½ç‰¹å¾ï¼Œå› ä¸ºä½ å¯¹å¯†æ–‡ä¹˜äº†ä¸ª $16^e$ çš„ç³»æ•°ï¼Œè§£å¯†åæ˜æ–‡ä¹Ÿä¹˜ $16$ï¼Œå¯¹åº”åˆ°åå…­è¿›åˆ¶è¾“å‡ºå°±æ˜¯æ˜æ˜¾çš„ç§»ä½ç‰¹å¾ã€‚</p><p>ç”±äº $t$ æ˜¯ $1000$ ä½ï¼Œ$n$ æ˜¯ $1024$ ä½ï¼Œå› æ­¤ä»ç¬¬ $7$ ä¸ªæ•°æ®å¼€å§‹ï¼Œæœ¬åº”æ˜¯ $\mathtt{B86E2F731XH}$ï¼Œå´å˜æˆäº† $\mathtt{FD147B8278H}$ï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™åº”è¯¥æ˜¯å–æ¨¡è¿‡çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯ $16^{6}t&#x3D;xn+y$ã€‚è¿™é‡ŒæŠŠ $16^6t$ å†™æˆäº† $n$ è¿›åˆ¶çš„æ ¼å¼ï¼Œ$x,y&lt;n$ã€‚ç”±äºæ˜¯ä¹˜äº† $16$ ä¹‹åï¼Œæ‰è¶…è¿‡äº† $n$ï¼Œå› æ­¤ $x$ ä¸€å®šä¸è¶…è¿‡ $15$ã€‚çœ‹çœ‹èƒ½ä¸èƒ½æå‡º $x$ï¼Ÿ</p><p><img src="/2024/11/15/24Nov2/8.png" alt="8"></p><p>å¯ä»¥å‘ç°ï¼Œè¿™é‡Œ $x&#x3D;1$ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸€æ¬¡åœ¨å–æ¨¡å‰ï¼Œæ•°å€¼ä¸º $x$ çš„ä¸€å€å¤šï¼Œä¹Ÿå°±æ˜¯ $\left \lfloor\dfrac{16^6t}{n} \right \rfloor&#x3D;1$ã€‚</p><p>å†æµ‹ä¸¤ç»„å¯ä»¥å‘ç°ï¼š$\mathtt{FD147B8278H}$ å˜ä¸º $\mathtt{15EE0436E8H}$ å¯¹åº”çš„ $x$ ä¹Ÿæ˜¯ $1$ ï¼Œå’Œ $\mathtt{15EE0436F4H}$ æœ‰å¾ˆå°çš„è¯¯å·®ã€‚åŒç†ï¼Œ$\mathtt{15EE0436F4H}$ å˜ä¸º $\mathtt{B61FBFC52H}$ å¯¹åº”çš„ $x $ ä¸º $5$ ï¼ˆå®é™…è®¡ç®—ä¸º $\mathtt{B61FBFC49H}$ï¼‰ï¼Œä¹Ÿå°±æ˜¯å½“ $t$ å†ä¹˜ $16$ ä¹‹åï¼Œ$t$ è¾¾åˆ°äº† $n$ çš„ $5$ å€ã€‚</p><p><img src="/2024/11/15/24Nov2/9.png" alt="9">ç»“åˆä¸‰ä¸ª $x$ï¼Œå¤§æ¦‚å¯ä»¥çŸ¥é“ï¼š<br>$$<br>\left \lfloor\dfrac{16^8t}{n} \right \rfloor&#x3D;277<br>$$<br>ï¼ˆå…¶ä¸­ $277&#x3D;\mathtt{115H}$ï¼‰</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ±‚å‡º $\left \lfloor\dfrac{16^{k}t}{n}\right\rfloor$ å¯¹åº”çš„å€¼ã€‚è¿™é‡Œä¼šå¸¦æœ‰è¯¯å·®ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¯å·®ä¸è¶…è¿‡ $16$ å°±æ˜¯æ­£ç¡®çš„ã€‚ä¸è¿‡é—®é¢˜æ˜¯ï¼Œå¦‚æœæƒ³è¦è·å¾—ä¸€ä¸ªéå¸¸ç²¾å‡†çš„å€¼ï¼Œæœ€åçš„å€¼åº”è¯¥è¶…è¿‡ $n$ã€‚å¹¶ä¸”ä½ åªæœ‰ $100$ æ¬¡æœºä¼šï¼Œ$16^{100}&#x3D;2^{400}$ï¼Œçœ‹æ¥ä¸å¤ªå¯è¡Œã€‚</p><p>ä½†å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¸€æ¬¡çˆ†ç ´ä¸‰ä½åå…­è¿›åˆ¶æ•°ï¼Œå³å°†ä¸Šé¢æ‰€æœ‰çš„ $16$ æ¢æˆ $4096$ï¼Œç„¶åæˆ‘ä»¬å¼€ä¸€ä¸ªæ•°ç»„ $M$ï¼Œè®°å½•ä¸Šä¸ªè§£å¯†çš„æœ‰æ•ˆçŠ¶æ€ï¼Œå†å¼€ä¸€ä¸ªæ•°ç»„ $T$ï¼Œä»£è¡¨  $\left \lfloor\dfrac{4096^{k}t}{n}\right\rfloor$ ç»“æœçš„ $4096$ è¿›åˆ¶è¡¨ç¤ºã€‚</p><p>æœ€ç»ˆæœ¬åœ°æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼Œè€—æ—¶åªæœ‰ä¸¤ç§’ï¼Œä¼°è®¡å°±ç®—å¯¹é¶æœºåº”è¯¥ä¹Ÿä¸ä¼šè¶…è¿‡ 5 ç§’å§ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>sh=remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">60712</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;n=&#x27;</span>)<br>n=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>n=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>n=<span class="hljs-built_in">eval</span>(n)<br>t=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>t=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>t=<span class="hljs-built_in">eval</span>(t)<br><span class="hljs-built_in">print</span>(n,t)<br><br>M=[]<br>T=[]<br>mask=(<span class="hljs-number">2</span>**<span class="hljs-number">40</span>-<span class="hljs-number">1</span>)&lt;&lt;<span class="hljs-number">492</span><br>RATE2N=<span class="hljs-number">4096</span><br>POW2NE=<span class="hljs-built_in">pow</span>(RATE2N,<span class="hljs-number">65537</span>,n)%n<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> trange(<span class="hljs-number">99</span>+<span class="hljs-number">1</span>):<br><span class="hljs-comment">#print(len(M),len(T))</span><br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.send(<span class="hljs-built_in">hex</span>(t)[<span class="hljs-number">2</span>:].encode())<br>msg=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>middval=<span class="hljs-built_in">eval</span>(msg)&gt;&gt;<span class="hljs-number">492</span><br>M.append(middval)<br><span class="hljs-keyword">if</span>(i==<span class="hljs-number">0</span>):<br>t=t*POW2NE%n<br><span class="hljs-keyword">continue</span><br>prevmid=(M[-<span class="hljs-number">2</span>]&amp;<span class="hljs-number">0x000fffffffffffffffff</span>)*RATE2N<br>prevmid&lt;&lt;=<span class="hljs-number">492</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(RATE2N):<br>y=prevmid-(j*n)<br>y=y&amp;mask<br>y=y&gt;&gt;<span class="hljs-number">492</span><br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(y-middval)&lt;RATE2N):<br>T.append(j)<br><span class="hljs-keyword">break</span><br>t=t*POW2NE%n<br><span class="hljs-built_in">print</span>(M)<br><span class="hljs-built_in">print</span>(T)<br>RR2=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(T)):<br>RR2*=<span class="hljs-number">4096</span><br>RR2+=T[i]<br>C=(RR2*n)&gt;&gt;(<span class="hljs-number">12</span>*<span class="hljs-number">99</span>)<br><br><span class="hljs-built_in">print</span>(C.bit_length())<br><br>ansstr=<span class="hljs-string">&#x27;&#123;:0250x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(C+<span class="hljs-number">1</span>)<br><br><span class="hljs-built_in">print</span>(ansstr)<br>sh.sendline(ansstr.encode())<br>sh.interactive()<br><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœå›¾ä¸­ï¼Œ<code>[0,1,1166,...,3942]</code> çš„æ•°ç»„è¡¨å°±è¡¨ç¤ºçš„ç›¸é™¤å‘ä¸‹å–æ•´å¾—åˆ°ç»“æœçš„ä»é«˜ä½åˆ°ä½ä½çš„ $4096$ è¿›åˆ¶çš„è¡¨ç¤ºã€‚ä¸è¿‡æœ€åè§£å‡ºæ¥ $t$ ä¹‹åï¼Œç»è¿‡æµ‹è¯•ï¼Œå†åŠ 1æ‰æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚</p><p><img src="/2024/11/15/24Nov2/10.png" alt="10"></p><h2 id="7-HITCTF2024-supercomputer"><a href="#7-HITCTF2024-supercomputer" class="headerlink" title="7.[HITCTF2024]supercomputer"></a>7.[HITCTF2024]supercomputer</h2><p>å…ˆçœ‹ä¸€çœ¼é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>    x ^= ((x &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">0xb114514bb114514b</span>)<br>    x ^= ((x &lt;&lt; <span class="hljs-number">13</span>) &amp; <span class="hljs-number">0x114514cc114514cc</span>)<br>    x ^= ((x &lt;&lt; <span class="hljs-number">17</span>) &amp; <span class="hljs-number">0xaa191981aa191981</span>)<br>    x ^= ((x &gt;&gt; <span class="hljs-number">19</span>) &amp; <span class="hljs-number">0xb1919810b1919810</span>)<br>    x ^= ((x &lt;&lt; <span class="hljs-number">23</span>) &amp; <span class="hljs-number">0x114514cd114514cd</span>)<br>    x ^= ((x &gt;&gt; <span class="hljs-number">29</span>) &amp; <span class="hljs-number">0xb114514ab114514a</span>)<br>    x ^= ((x &lt;&lt; <span class="hljs-number">31</span>) &amp; <span class="hljs-number">0x114514cb114514cb</span>)<br>    x ^= ((x &lt;&lt; <span class="hljs-number">37</span>) &amp; <span class="hljs-number">0xaa19198caa19198c</span>)<br>    x ^= ((x &gt;&gt; <span class="hljs-number">41</span>) &amp; <span class="hljs-number">0xb191981db191981d</span>)<br>    x ^= ((x &lt;&lt; <span class="hljs-number">43</span>) &amp; <span class="hljs-number">0x114514ce114514ce</span>)<br>    <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params">n</span>):<br>    x = <span class="hljs-number">0x1122334455667788</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        x = f(x)<br>    <span class="hljs-keyword">return</span> x<br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">1</span>) == <span class="hljs-number">0xaa732acf4eb6a79d</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">10</span>) == <span class="hljs-number">0x28262ecbd673b7d7</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">100</span>) == <span class="hljs-number">0x23a6b8be477b7c3</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">1000</span>) == <span class="hljs-number">0x93737600f66aa785</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">100000</span>) == <span class="hljs-number">0x8a762387c4e3aed8</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">1000000</span>) == <span class="hljs-number">0x1267270a756bf7df</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">10000000</span>) == <span class="hljs-number">0x39377648f4e367d7</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">100000000</span>) == <span class="hljs-number">0x82232f8777773e8a</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">1000000000</span>) == <span class="hljs-number">0x8762b83d6faa783</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">10000000000</span>) == <span class="hljs-number">0x27237cdd6726788</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">100000000000</span>) == <span class="hljs-number">0x97f6b44e7fe66de</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">1000000000000</span>) == <span class="hljs-number">0x88723b8666ff27ca</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">10000000000000</span>) == <span class="hljs-number">0x8a32670ee5ef6ec0</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">100000000000000</span>) == <span class="hljs-number">0x993b3b4265ea6edb</span><br><span class="hljs-keyword">assert</span> calc(<span class="hljs-number">1000000000000000</span>) == <span class="hljs-number">0x8b732ec065e7e795</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;flag&#123;%s&#125;&#x27;</span> % <span class="hljs-built_in">hex</span>(calc(<span class="hljs-number">10000000000000000</span>)))<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ª $64$ æ¯”ç‰¹çš„å˜æ¢è¿‡ç¨‹ï¼Œå¹¶ç»™å‡ºäº† $10^{0}\sim10^{14}$ æ¬¡å˜æ¢è¿‡ç¨‹çš„ç»“æœï¼Œè¦æ±‚ç»è¿‡ $10^{15}$ æ¬¡æ¯”ç‰¹å˜æ¢çš„ç»“æœã€‚</p><p>å¾ˆæ˜æ˜¾ï¼Œé¢˜ç›®ç»™å‡ºçš„æ•°å­—å¾ˆå¤§ï¼Œå¹¶ä¸”æ˜¯æ¯”ç‰¹å˜æ¢ï¼Œå› æ­¤å¯ä»¥å¾€çŸ©é˜µå¿«é€Ÿå¹‚çš„åœ°æ–¹æƒ³ã€‚</p><p>ç„¶åååˆ†é’Ÿä¸åˆ°ï¼Œå†™å¥½äº†è¿™ä¸ªå‡½æ•°ï¼Œæ„é€ ä¹‹åå´ä¸å¯¹ã€‚ã€‚ç„¶åä¸€æ­¥ä¸€æ­¥åœ°å¯¹ç€è°ƒè¯•ï¼Œå‘ç°åªè¿›è¡Œä¸€æ­¥çš„æ—¶å€™æ˜¯å¯¹çš„ï¼Œè¿›è¡Œä¸¤æ­¥å°±å¼€å§‹ä¸å¯¹äº†ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">t,a,b</span>):<br>    vec2k=[<span class="hljs-number">1</span>&lt;&lt;i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    xornum=vec2k.copy()<br>    <span class="hljs-keyword">if</span>(t==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            xornum[i]&gt;&gt;=a<br>            <span class="hljs-comment">#xornum[i]&amp;=(2**64-1)</span><br>    <span class="hljs-keyword">if</span>(t==-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            xornum[i]&lt;&lt;=a<br>            xornum[i]&amp;=((<span class="hljs-number">2</span>**<span class="hljs-number">64</span>)-<span class="hljs-number">1</span>)<br>    <br>    mask=[<span class="hljs-built_in">int</span>(<span class="hljs-built_in">bool</span>(b&amp;(<span class="hljs-number">1</span>&lt;&lt;i))) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    xored=[mask[i]*xornum[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    result=[(vec2k[i]^^xored[i])&amp;((<span class="hljs-number">2</span>**<span class="hljs-number">64</span>)-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            M[i][j]=((result[i]&amp;(<span class="hljs-number">1</span>&lt;&lt;j))!=<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">return</span> Matrix(GF(<span class="hljs-number">2</span>),M)<br></code></pre></td></tr></table></figure><p>ç„¶åè°ƒå‰ä¸¤æ­¥çš„æ—¶å€™ï¼Œå‘ç°å…ˆä¹˜ $M_{13}$ å†ä¹˜ $M_{11}$ å¯ä»¥å¾—åˆ°æ­£ç¡®ç»“æœã€‚åŸæ¥çŸ©é˜µå˜æ¢æ–¹å¼ä¸º $(\prod M)\vec v&#x3D;M_1M_2M_3\vec v$ï¼ˆè¿˜æ˜¯ä»¥ä¸‰ä¸ªä¸¾ä¾‹ï¼‰ã€‚æ ¹æ®çŸ©é˜µå˜æ¢çš„å‡ ä½•æ„ä¹‰ï¼Œå…ˆè·Ÿ $\vec v$ ç›¸ä¹˜çš„æ˜¯ $M_3$ï¼Œä¹Ÿå°±æ˜¯æ­£ç€ä¹˜ï¼Œå…ˆè¿›è¡Œäº† $M_3$ å¯¹åº”çš„å˜æ¢ã€‚é‚£å°±è¿˜æ˜¯ä¸€ä¸ªä¸€ä¸ªæ¥ï¼Œå€’ç€ä¹˜ã€‚</p><p>é‚£ä¹ˆç­”æ¡ˆå°±å‡ºæ¥äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">t,a,b</span>):<br>    vec2k=[<span class="hljs-number">1</span>&lt;&lt;i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    xornum=vec2k.copy()<br>    <span class="hljs-keyword">if</span>(t==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            xornum[i]&gt;&gt;=a<br>            <span class="hljs-comment">#xornum[i]&amp;=(2**64-1)</span><br>    <span class="hljs-keyword">if</span>(t==-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            xornum[i]&lt;&lt;=a<br>            xornum[i]&amp;=((<span class="hljs-number">2</span>**<span class="hljs-number">64</span>)-<span class="hljs-number">1</span>)<br>    <br>    mask=[<span class="hljs-built_in">int</span>(<span class="hljs-built_in">bool</span>(b&amp;(<span class="hljs-number">1</span>&lt;&lt;i))) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    <span class="hljs-comment"># print(mask)</span><br>    <span class="hljs-comment"># print(xornum)</span><br>    xored=[mask[i]*xornum[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    <span class="hljs-comment"># print(xored)</span><br>    result=[(vec2k[i]^^xored[i])&amp;((<span class="hljs-number">2</span>**<span class="hljs-number">64</span>)-<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    <span class="hljs-comment"># print([ &#x27;&#123;:016X&#125;&#x27;.format(i) for i in result])</span><br>    M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            M[i][j]=((result[i]&amp;(<span class="hljs-number">1</span>&lt;&lt;j))!=<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">return</span> Matrix(GF(<span class="hljs-number">2</span>),M)<br><br>Marr=[]<br>Marr.append(get(-<span class="hljs-number">1</span>,<span class="hljs-number">11</span>,<span class="hljs-number">0xb114514bb114514b</span>))<br>Marr.append(get(<span class="hljs-number">1</span>,<span class="hljs-number">13</span>,<span class="hljs-number">0x114514cc114514cc</span>))<br>Marr.append(get(<span class="hljs-number">1</span>,<span class="hljs-number">17</span>,<span class="hljs-number">0xaa191981aa191981</span>))<br>Marr.append(get(-<span class="hljs-number">1</span>,<span class="hljs-number">19</span>,<span class="hljs-number">0xb1919810b1919810</span>))<br>Marr.append(get(<span class="hljs-number">1</span>,<span class="hljs-number">23</span>,<span class="hljs-number">0x114514cd114514cd</span>))<br>Marr.append(get(-<span class="hljs-number">1</span>,<span class="hljs-number">29</span>,<span class="hljs-number">0xb114514ab114514a</span>))<br>Marr.append(get(<span class="hljs-number">1</span>,<span class="hljs-number">31</span>,<span class="hljs-number">0x114514cb114514cb</span>))<br>Marr.append(get(<span class="hljs-number">1</span>,<span class="hljs-number">37</span>,<span class="hljs-number">0xaa19198caa19198c</span>))<br>Marr.append(get(-<span class="hljs-number">1</span>,<span class="hljs-number">41</span>,<span class="hljs-number">0xb191981db191981d</span>))<br>Marr.append(get(<span class="hljs-number">1</span>,<span class="hljs-number">43</span>,<span class="hljs-number">0x114514ce114514ce</span>))<br>Marr=Marr[::-<span class="hljs-number">1</span>]<br>M=identity_matrix(GF(<span class="hljs-number">2</span>),<span class="hljs-number">64</span>)<br><span class="hljs-keyword">for</span> mi <span class="hljs-keyword">in</span> Marr:<br>    M=M*mi<br>v0=[(<span class="hljs-number">0x1122334455667788</span>&amp;(<span class="hljs-number">1</span>&lt;&lt;i))!=<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>v0=vector(v0)<br>v1=(M**<span class="hljs-number">10000000000000000</span>)*v0<br><span class="hljs-built_in">print</span>(v1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;flag&#123;%s&#125;&#x27;</span>%<span class="hljs-built_in">hex</span>(vector(ZZ,[<span class="hljs-number">1</span>&lt;&lt;i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)])*(vector(ZZ,<span class="hljs-built_in">list</span>(v1)))))<br><span class="hljs-comment">#(1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1)</span><br><span class="hljs-comment">#flag&#123;0xa8276600c7e3b6d9&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BlockCipher5</title>
    <link href="/2024/11/09/BlockCipher5/"/>
    <url>/2024/11/09/BlockCipher5/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°5"><a href="#huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°5" class="headerlink" title="huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°5"></a>huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°5</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>ä¸Šä¸€ç¯‡æˆ‘ä»¬è®²åˆ°äº†DESçš„å·®åˆ†æ”»å‡»ï¼Œè¿™ä¸€æ¬¡å°±è®²ä¸€ä¸‹AESçš„ç§¯åˆ†æ”»å‡»ä¸­çš„æ¯”è¾ƒæœ‰åçš„Square Attackã€‚</p><h2 id="5-AESçš„Square-Attack"><a href="#5-AESçš„Square-Attack" class="headerlink" title="5. AESçš„Square Attack"></a>5. AESçš„Square Attack</h2><h3 id="5o01-ä»-DASCTF2024-10-symmetric-cipher-å¼•å…¥Square-Attack"><a href="#5o01-ä»-DASCTF2024-10-symmetric-cipher-å¼•å…¥Square-Attack" class="headerlink" title="5o01 ä»[DASCTF2024.10] symmetric_cipher å¼•å…¥Square Attack"></a>5o01 ä»[DASCTF2024.10] symmetric_cipher å¼•å…¥Square Attack</h3><p>è¿™ä¸€æ¬¡æˆ‘ä»¬ç›´æ¥å…ˆä»é¢˜ç›®å‡ºå‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs python">r_con = (<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>,<span class="hljs-number">0x80</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x36</span>)<br>s_box = [<br>    <span class="hljs-number">0x63</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x76</span>,<br>    <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xC0</span>,<br>    <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>,<br>    <span class="hljs-number">0x04</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x75</span>,<br>    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x84</span>,<br>    <span class="hljs-number">0x53</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCF</span>,<br>    <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xA8</span>,<br>    <span class="hljs-number">0x51</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD2</span>,<br>    <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>,<br>    <span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xDB</span>,<br>    <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x79</span>,<br>    <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8A</span>,<br>    <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x9E</span>,<br>    <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xDF</span>,<br>    <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x16</span>,<br>]<br><br>     <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor_bytes</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(i^j <span class="hljs-keyword">for</span> i, j <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(a, b))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_round_key</span>(<span class="hljs-params">s, k</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            s[i][j] ^= k[i][j]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_bytes</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            s[i][j] = s_box[s[i][j]]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shift_rows</span>(<span class="hljs-params">s</span>):<br>    s[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>], s[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>], s[<span class="hljs-number">2</span>][<span class="hljs-number">1</span>], s[<span class="hljs-number">3</span>][<span class="hljs-number">1</span>] = s[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>], s[<span class="hljs-number">2</span>][<span class="hljs-number">1</span>], s[<span class="hljs-number">3</span>][<span class="hljs-number">1</span>], s[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]<br>    s[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>], s[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>], s[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>], s[<span class="hljs-number">3</span>][<span class="hljs-number">2</span>] = s[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>], s[<span class="hljs-number">3</span>][<span class="hljs-number">2</span>], s[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>], s[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>]<br>    s[<span class="hljs-number">0</span>][<span class="hljs-number">3</span>], s[<span class="hljs-number">1</span>][<span class="hljs-number">3</span>], s[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>], s[<span class="hljs-number">3</span>][<span class="hljs-number">3</span>] = s[<span class="hljs-number">3</span>][<span class="hljs-number">3</span>], s[<span class="hljs-number">0</span>][<span class="hljs-number">3</span>], s[<span class="hljs-number">1</span>][<span class="hljs-number">3</span>], s[<span class="hljs-number">2</span>][<span class="hljs-number">3</span>]<br><br><br>xtime = <span class="hljs-keyword">lambda</span> a: (((a &lt;&lt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0x1B</span>) &amp; <span class="hljs-number">0xFF</span>) <span class="hljs-keyword">if</span> (a &amp; <span class="hljs-number">0x80</span>) <span class="hljs-keyword">else</span> (a &lt;&lt; <span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mix_single_column</span>(<span class="hljs-params">a</span>):<br>    <br>    t = a[<span class="hljs-number">0</span>] ^ a[<span class="hljs-number">1</span>] ^ a[<span class="hljs-number">2</span>] ^ a[<span class="hljs-number">3</span>]<br>    u = a[<span class="hljs-number">0</span>]<br>    a[<span class="hljs-number">0</span>] ^= t ^ xtime(a[<span class="hljs-number">0</span>] ^ a[<span class="hljs-number">1</span>])<br>    a[<span class="hljs-number">1</span>] ^= t ^ xtime(a[<span class="hljs-number">1</span>] ^ a[<span class="hljs-number">2</span>])<br>    a[<span class="hljs-number">2</span>] ^= t ^ xtime(a[<span class="hljs-number">2</span>] ^ a[<span class="hljs-number">3</span>])<br>    a[<span class="hljs-number">3</span>] ^= t ^ xtime(a[<span class="hljs-number">3</span>] ^ u)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mix_columns</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        mix_single_column(s[i])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_expand_key</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        word = <span class="hljs-built_in">list</span>(s[-<span class="hljs-number">1</span>])<br>        word.append(word.pop(<span class="hljs-number">0</span>))<br>        word = [s_box[b] <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> word] <br>        word[<span class="hljs-number">0</span>] ^= r_con[i]<br><br>        s.append(xor_bytes(word, s[-<span class="hljs-number">4</span>]))<br>        s.append(xor_bytes(s[-<span class="hljs-number">1</span>], s[-<span class="hljs-number">4</span>]))<br>        s.append(xor_bytes(s[-<span class="hljs-number">1</span>], s[-<span class="hljs-number">4</span>]))<br>        s.append(xor_bytes(s[-<span class="hljs-number">1</span>], s[-<span class="hljs-number">4</span>]))<br><br>    <span class="hljs-keyword">return</span> [s[<span class="hljs-number">4</span>*i : <span class="hljs-number">4</span>*(i+<span class="hljs-number">1</span>)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s) // <span class="hljs-number">4</span>)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bytes2matrix</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">list</span>(text[i:i+<span class="hljs-number">4</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(text), <span class="hljs-number">4</span>)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">plain,r,skeys</span>):<br>    plain = bytes2matrix(plain)<br>    add_round_key(plain, skeys[<span class="hljs-number">0</span>])<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, r+<span class="hljs-number">1</span>):<br>        sub_bytes(plain)<br>        <span class="hljs-keyword">if</span> i %<span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            shift_rows(plain)<br>        <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> :<br>            mix_columns(plain)<br>         <br>        add_round_key(plain, skeys[i])<br>    enc = <span class="hljs-built_in">bytes</span>(plain[<span class="hljs-number">0</span>]+plain[<span class="hljs-number">1</span>]+plain[<span class="hljs-number">2</span>]+plain[<span class="hljs-number">3</span>])<br>    <span class="hljs-keyword">return</span> enc<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span> ** <span class="hljs-number">8</span>):<br>    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>        p = <span class="hljs-string">b&quot;\x00&quot;</span> + <span class="hljs-string">b&quot;\xCB&quot;</span> * <span class="hljs-number">15</span><br>    <span class="hljs-keyword">else</span>:<br>        p = long_to_bytes(i) + <span class="hljs-string">b&quot;\xCB&quot;</span> * <span class="hljs-number">15</span><br>    pt.append(p)<br>    c = encrypt(p, <span class="hljs-number">7</span>, skeys)<br>    ct.append(c)<br><br>pt_serializable = [<span class="hljs-built_in">list</span>(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> pt]<br>ct_serializable = [<span class="hljs-built_in">list</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> ct]<br><br>data = &#123;<span class="hljs-string">&#x27;pt&#x27;</span>: pt_serializable, <span class="hljs-string">&#x27;ct&#x27;</span>: ct_serializable&#125;<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;out1.json&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    json.dump(data, f)<br><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜ç›®ç»™å‡ºäº† $256$ ç»„æ˜æ–‡åŠå…¶å¯¹åº”çš„å¯†æ–‡ã€‚æ˜æ–‡æ ¼å¼å‡ä¸º $(i,203,203,â€¦,203)$ï¼Œå…¶ä¸­ $i$ ä» $0$ éå†åˆ° $256$ã€‚</p><p>å›é¡¾ä¸€ä¸‹AESçš„è¿‡ç¨‹ï¼šæ¯ä¸€è½®åˆ†åˆ«è¿›è¡Œäº†å­—èŠ‚ä»£æ¢ã€è¡Œç§»ä½ã€åˆ—æ··åˆå’Œè½®å¯†é’¥åŠ  4 æ­¥ï¼Œå…¶ä¸­æœ€åä¸€è½®æ²¡æœ‰åˆ—æ··åˆæ“ä½œã€‚ä¹‹æ‰€ä»¥å«ç§¯åˆ†ç§¯åˆ†æ”»å‡»ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„å›¾ï¼ˆå‚è€ƒ<a href="https://blog.csdn.net/qwerzbc66/article/details/143632147">strivingå¸ˆå‚…çš„åšå®¢</a>ï¼‰ï¼š</p><p><img src="/2024/11/09/BlockCipher5/1.png" alt="1"></p><p>åœ¨ä¸Šé¢çš„å›¾ä¸­ï¼Œå¯¹äºå·²çŸ¥çš„ $256$  ä¸ªå¯†æ–‡ï¼Œç™½è‰²çš„éƒ¨åˆ†è¡¨ç¤ºæ’å®šå€¼ï¼Œç»¿è‰²éƒ¨åˆ†åœ¨ $256$ ä¸ªå¯†æ–‡ä¸­ä¼šéå† $0\sim255$ã€‚æˆ‘ä»¬åœ¨ä¸‹é¢ç”¨ $x$ ä»£è¡¨éå†$0\sim255$ çš„å€¼ï¼Œ$c$ ä»£è¡¨æ’å®šå€¼ï¼Œä¸‹æ ‡ $00\sim33$ è¡¨ç¤ºåœ¨çŸ©é˜µä¸­çš„ä½ç½®ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆå§‹çš„ç»“æ„ä¸ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">x00 c01 c02 c03<br>c10 c11 c12 c13<br>c20 c21 c22 c23<br>c30 c31 c32 c33<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æå›¾1ä¸­äº§ç”Ÿçš„æ•ˆæœï¼š</p><p>åœ¨<strong>è½®å¯†é’¥åŠ </strong>é˜¶æ®µï¼šå› ä¸ºAESä¸­ï¼Œå¯¹äºå•ä¸ªå­—èŠ‚ $x_{00} \oplus k_{00}$ï¼Œç”±äºå¯†é’¥ç›¸åŒæ„å‘³ç€ $k_{00}$ æ’å®šï¼Œå› æ­¤å½“ $x_{00}$ éå† $0\sim255$ æ—¶ï¼Œ$x_{00}\oplus k_{00}$ ä¹Ÿä¼šéå† $0\sim255$ï¼Œè€Œå¯¹äºä¸å˜çš„ $c_{01}$ ç­‰å…¶ä»–å€¼ï¼Œå¼‚æˆ–ä¸€ä¸ªç›¸åŒçš„ $k_{01}$ï¼Œç»“æœä¾ç„¶æ˜¯æ’å®šçš„ $c_{01}\oplus k_{00}$ï¼ˆä¸¤ä¸ªæ•°éƒ½æ’å®šï¼Œå½“ç„¶å¾—åˆ°æ’å®šå€¼ï¼‰ã€‚</p><p><img src="/2024/11/09/BlockCipher5/2.png" alt="2"></p><p>åœ¨<strong>å­—èŠ‚ä»£æ¢</strong>é˜¶æ®µï¼Œç”±äº $S$ ç›’çš„å¯é€†æ€§ï¼Œå› æ­¤å½“ $x_{00}$ éå† $0\sim255$ æ—¶ï¼Œ$S(x_{00})$ ä¹Ÿä¼šéå† $0\sim255$ ã€‚è€Œå¯¹äºç›¸åŒçš„ $c_{01}$ ç­‰å…¶ä»– $15$ ä¸ªå­—èŠ‚ï¼Œç”±äºå…¶ä¸å˜æ€§ï¼Œæœ€ç»ˆä¹Ÿä¼šå¯¼è‡´å­—èŠ‚ä»£æ¢åï¼Œå¾—åˆ°çš„ $S(c_{01})$ ä¿æŒä¸å˜ã€‚  </p><p><img src="/2024/11/09/BlockCipher5/3.png" alt="3"></p><p>åœ¨<strong>è¡Œç§»ä½</strong>é˜¶æ®µï¼Œç”±äºæˆ‘ä»¬è€ƒè™‘çš„æ˜¯ $x_{00}$ï¼Œè€ŒAESä¸­ç¬¬ä¸€è¡Œçš„å€¼ä¸ä¼šå˜åŠ¨ä½ç½®ï¼Œå› æ­¤ $x_{00}$ ç»è¿‡è¡Œç§»ä½è¿˜æ˜¯ $x_{00}$ã€‚å½“ç„¶ï¼Œå¦‚æœä¸€å¼€å§‹é€‰æ‹©ä¸‹é¢ä¸€è¡Œï¼Œå°† $x_{10}$ ä½œä¸ºéå†å€¼ï¼Œåˆ™ $(x_{10},c_{11},c_{12},c_{13})$ ä¼šå˜æˆ $(c_{10}^{(1)},c^{(1)}<em>{11},c^{(1)}</em>{12},x^{(1)}_{13})$ã€‚</p><p><img src="/2024/11/09/BlockCipher5/4.png" alt="4"></p><p>åœ¨åˆ—æ··åˆé˜¶æ®µï¼Œç”±äºæ¶‰åŠåˆ°çŸ©é˜µä¹˜æ³•ï¼Œå› æ­¤å¯¹äºç¬¬ $0$ åˆ—çš„æ•°å­—è€Œè¨€ï¼Œæœ‰ï¼š</p><p><img src="/2024/11/09/BlockCipher5/6.png" alt="6"></p><p>ç”±äºå››ä¸ª $d$ éƒ½æœ‰ $x$ çš„å‚ä¸ï¼Œå› æ­¤ç¬¬ $0$ åˆ—çš„æ‰€æœ‰å€¼ç”±äºåˆ—æ··åˆçš„å­˜åœ¨ï¼Œè¿™ $4$ ä¸ªå€¼åœ¨ $256$ ä¸ªå¯†æ–‡ä¸­éƒ½ä¼šéå† $0\sim255$ã€‚</p><p><img src="/2024/11/09/BlockCipher5/5.png" alt="5"></p><p>éšåï¼Œå›¾1ä¸­ç¬¬äºŒè½®å’Œç¬¬ä¸‰è½®åˆ°åˆ—æ··åˆå‰çš„æ­¥éª¤ï¼Œç»è¿‡ç¬¬ä¸€è½®çš„è®²è§£ï¼Œä¹Ÿå°±ä¸éš¾ç†è§£äº†ã€‚ä¹Ÿå°±æ˜¯åˆ°ç¬¬ä¸‰è½®åˆ—æ··åˆå‰ï¼Œå¯¹åº”ç»™å®šçš„ $256$ ä¸ªæ˜æ–‡ï¼Œ$16$ ä¸ªå­—èŠ‚å…¨éƒ¨éƒ½ä¼šéå† $0\sim255$ã€‚</p><p>ä½†ç»è¿‡ç¬¬ä¸‰è½®çš„åˆ—æ··åˆåï¼Œç»“æœå‡ºç°äº†å˜åŒ–ï¼Œæ­¤æ—¶çŸ©é˜µä¸­æ¯ä¸ªæ•°å­—å¹¶ä¸ä¼šéå† $0\sim255$ çš„æ‰€æœ‰å€¼äº†ï¼Œä¹Ÿå°±æ˜¯éšç€ $x_{ij}^{(3)}$ çš„éå†ï¼Œ $d^{(3)}$ å¹¶ä¸ä¼šéå† $0\sim255$ã€‚</p><p><img src="/2024/11/09/BlockCipher5/7.png" alt="7"></p><p>ä½†æˆ‘ä»¬å°† $d^{(3)}$ ï¼ˆä»¥ $d_{00}^{(3)}$ ä¸ºä¾‹ï¼‰çš„è¡¨è¾¾å¼é‡å†™ä¸€ä¸‹ã€‚ç”±äºå››ä¸ª $x$ éƒ½æ˜¯ä¼šéå† $0\sim255$ çš„ï¼Œä¹Ÿå°±æ˜¯æ„æˆä¸€ä¸ª $0\sim255$ çš„æ’åˆ—ï¼Œå› æ­¤ä¸‹é¢åˆ†åˆ«ç”¨ $p_i$è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯ç¬¬ $i$ ç»„æ˜æ–‡ä¸­ï¼Œ$x_{00}^{(3)}&#x3D;p_0(i)$ï¼ˆå‰©ä¸‹ä¸‰ä¸ªä»¥æ­¤ç±»æ¨ï¼‰<br>$$<br>\bigoplus_{i&#x3D;0}^{255}d_{00}^{(3)}&#x3D;\bigoplus_{i&#x3D;0}^{255}(p_{0}(i)\oplus p_1(i)\oplus p_2(i)\oplus p_3(i))&#x3D;\bigoplus_{i&#x3D;0}^{255}p_0(i)\oplus\bigoplus_{i&#x3D;0}^{255}p_1(i)\oplus\bigoplus_{i&#x3D;0}^{255}p_2(i)\oplus\bigoplus_{i&#x3D;0}^{255}p_3(i)<br>$$<br>å› ä¸º $p_0,p_1,p_2,p_3$ éƒ½æ˜¯ $0\sim255$ çš„ä¸€ä¸ªæ’åˆ—ï¼Œå› æ­¤<br>$$<br>\bigoplus_{i&#x3D;0}^{255}p_0(i)&#x3D;\bigoplus_{i&#x3D;0}^{255}p_1(i)&#x3D;\bigoplus_{i&#x3D;0}^{255}p_2(i)&#x3D;\bigoplus_{i&#x3D;0}^{255}p_3(i)&#x3D;\bigoplus_{i&#x3D;0}^{255}i&#x3D;0<br>$$<br>å› æ­¤ï¼Œå›¾1ä¸­çº¢è‰²çš„æ•°æ®ä»£è¡¨çš„æ„æ€å°±æ˜¯ï¼šä¸ä¿è¯è¿™ä¸ªå€¼ä¼šéå† $0\sim255$ï¼Œä½†å°† $256$ ç»„çº¢è‰²éƒ¨åˆ†å¼‚æˆ–èµ·æ¥ï¼Œç»“æœä»ç„¶ä¸º $0$ã€‚</p><p>ç„¶è€Œåœ¨ç¬¬ 4 è½®ï¼Œç»è¿‡å­—èŠ‚ä»£æ¢ä¹‹åï¼Œä¸Šé¢çš„æ€§è´¨ä¹Ÿæ¶ˆå¤±äº†ï¼ˆçº¢è‰²æ•°æ®å˜æˆäº†ç´«è‰²æ•°æ®ï¼‰ã€‚ä½†ç”±äºå­—èŠ‚ä»£æ¢ã€è¡Œç§»ä½æ˜¯å¯é€†çš„ï¼›å¦‚æœçŒœæµ‹è½®å¯†é’¥çš„å•ä¸ªå­—èŠ‚ï¼Œå¼‚æˆ–å›å»ã€å†é€†è¡Œç§»ä½ã€é€†å­—èŠ‚ä»£æ¢å°±å¯ä»¥å¾—åˆ°ç¬¬3è½®ç»“æœçš„å¯¹åº”å­—èŠ‚ï¼›æ ¹æ®å‰é¢å¾—åˆ°çš„æ€§è´¨ï¼Œå¯ä»¥éªŒè¯è¯¥çŒœæµ‹æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®åˆ™æ˜¯ä¸€ä¸ªå¯èƒ½çš„è½®å¯†é’¥å­—èŠ‚ã€‚å¹³å‡æƒ…å†µä¸‹ï¼Œä¼šå¾—åˆ°ä¸¤ä¸ªå¯èƒ½çš„å¯†é’¥å­—èŠ‚ï¼Œæœ€åä¹Ÿä¼šæœ‰ $256$ ç§æƒ…å†µã€‚æšä¸¾ä¸€ä¸‹åº”è¯¥å°±OKäº†ã€‚</p><p>æ•…è¿™ä¸ªé¢˜å¯ä»¥æ ¹æ®è¿™ä¸€åŸç†å‡ºè§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python">s_inv=[<span class="hljs-number">82</span>, <span class="hljs-number">9</span>, <span class="hljs-number">106</span>, <span class="hljs-number">213</span>, <span class="hljs-number">48</span>, <span class="hljs-number">54</span>, <span class="hljs-number">165</span>, <span class="hljs-number">56</span>, <span class="hljs-number">191</span>, <span class="hljs-number">64</span>, <span class="hljs-number">163</span>, <span class="hljs-number">158</span>, <span class="hljs-number">129</span>, <span class="hljs-number">243</span>, <span class="hljs-number">215</span>, <span class="hljs-number">251</span>, <span class="hljs-number">124</span>,<br>    <span class="hljs-number">227</span>, <span class="hljs-number">57</span>, <span class="hljs-number">130</span>, <span class="hljs-number">155</span>, <span class="hljs-number">47</span>, <span class="hljs-number">255</span>, <span class="hljs-number">135</span>, <span class="hljs-number">52</span>, <span class="hljs-number">142</span>, <span class="hljs-number">67</span>, <span class="hljs-number">68</span>, <span class="hljs-number">196</span>, <span class="hljs-number">222</span>, <span class="hljs-number">233</span>, <span class="hljs-number">203</span>, <span class="hljs-number">84</span>, <span class="hljs-number">123</span>,<br>    <span class="hljs-number">148</span>, <span class="hljs-number">50</span>, <span class="hljs-number">166</span>, <span class="hljs-number">194</span>, <span class="hljs-number">35</span>, <span class="hljs-number">61</span>, <span class="hljs-number">238</span>, <span class="hljs-number">76</span>, <span class="hljs-number">149</span>, <span class="hljs-number">11</span>, <span class="hljs-number">66</span>, <span class="hljs-number">250</span>, <span class="hljs-number">195</span>, <span class="hljs-number">78</span>, <span class="hljs-number">8</span>, <span class="hljs-number">46</span>, <span class="hljs-number">161</span>, <span class="hljs-number">102</span>,<br>    <span class="hljs-number">40</span>, <span class="hljs-number">217</span>, <span class="hljs-number">36</span>, <span class="hljs-number">178</span>, <span class="hljs-number">118</span>, <span class="hljs-number">91</span>, <span class="hljs-number">162</span>, <span class="hljs-number">73</span>, <span class="hljs-number">109</span>, <span class="hljs-number">139</span>, <span class="hljs-number">209</span>, <span class="hljs-number">37</span>, <span class="hljs-number">114</span>, <span class="hljs-number">248</span>, <span class="hljs-number">246</span>, <span class="hljs-number">100</span>, <span class="hljs-number">134</span>,<br>    <span class="hljs-number">104</span>, <span class="hljs-number">152</span>, <span class="hljs-number">22</span>, <span class="hljs-number">212</span>, <span class="hljs-number">164</span>, <span class="hljs-number">92</span>, <span class="hljs-number">204</span>, <span class="hljs-number">93</span>, <span class="hljs-number">101</span>, <span class="hljs-number">182</span>, <span class="hljs-number">146</span>, <span class="hljs-number">108</span>, <span class="hljs-number">112</span>, <span class="hljs-number">72</span>, <span class="hljs-number">80</span>, <span class="hljs-number">253</span>, <span class="hljs-number">237</span>,<br>    <span class="hljs-number">185</span>, <span class="hljs-number">218</span>, <span class="hljs-number">94</span>, <span class="hljs-number">21</span>, <span class="hljs-number">70</span>, <span class="hljs-number">87</span>, <span class="hljs-number">167</span>, <span class="hljs-number">141</span>, <span class="hljs-number">157</span>, <span class="hljs-number">132</span>, <span class="hljs-number">144</span>, <span class="hljs-number">216</span>, <span class="hljs-number">171</span>, <span class="hljs-number">0</span>, <span class="hljs-number">140</span>, <span class="hljs-number">188</span>, <span class="hljs-number">211</span>,<br>    <span class="hljs-number">10</span>, <span class="hljs-number">247</span>, <span class="hljs-number">228</span>, <span class="hljs-number">88</span>, <span class="hljs-number">5</span>, <span class="hljs-number">184</span>, <span class="hljs-number">179</span>, <span class="hljs-number">69</span>, <span class="hljs-number">6</span>, <span class="hljs-number">208</span>, <span class="hljs-number">44</span>, <span class="hljs-number">30</span>, <span class="hljs-number">143</span>, <span class="hljs-number">202</span>, <span class="hljs-number">63</span>, <span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">193</span>,<br>    <span class="hljs-number">175</span>, <span class="hljs-number">189</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">19</span>, <span class="hljs-number">138</span>, <span class="hljs-number">107</span>, <span class="hljs-number">58</span>, <span class="hljs-number">145</span>, <span class="hljs-number">17</span>, <span class="hljs-number">65</span>, <span class="hljs-number">79</span>, <span class="hljs-number">103</span>, <span class="hljs-number">220</span>, <span class="hljs-number">234</span>, <span class="hljs-number">151</span>, <span class="hljs-number">242</span>, <span class="hljs-number">207</span>,<br>    <span class="hljs-number">206</span>, <span class="hljs-number">240</span>, <span class="hljs-number">180</span>, <span class="hljs-number">230</span>, <span class="hljs-number">115</span>, <span class="hljs-number">150</span>, <span class="hljs-number">172</span>, <span class="hljs-number">116</span>, <span class="hljs-number">34</span>, <span class="hljs-number">231</span>, <span class="hljs-number">173</span>, <span class="hljs-number">53</span>, <span class="hljs-number">133</span>, <span class="hljs-number">226</span>, <span class="hljs-number">249</span>, <span class="hljs-number">55</span>, <span class="hljs-number">232</span>,<br>    <span class="hljs-number">28</span>, <span class="hljs-number">117</span>, <span class="hljs-number">223</span>, <span class="hljs-number">110</span>, <span class="hljs-number">71</span>, <span class="hljs-number">241</span>, <span class="hljs-number">26</span>, <span class="hljs-number">113</span>, <span class="hljs-number">29</span>, <span class="hljs-number">41</span>, <span class="hljs-number">197</span>, <span class="hljs-number">137</span>, <span class="hljs-number">111</span>, <span class="hljs-number">183</span>, <span class="hljs-number">98</span>, <span class="hljs-number">14</span>, <span class="hljs-number">170</span>, <span class="hljs-number">24</span>,<br>    <span class="hljs-number">190</span>, <span class="hljs-number">27</span>, <span class="hljs-number">252</span>, <span class="hljs-number">86</span>, <span class="hljs-number">62</span>, <span class="hljs-number">75</span>, <span class="hljs-number">198</span>, <span class="hljs-number">210</span>, <span class="hljs-number">121</span>, <span class="hljs-number">32</span>, <span class="hljs-number">154</span>, <span class="hljs-number">219</span>, <span class="hljs-number">192</span>, <span class="hljs-number">254</span>, <span class="hljs-number">120</span>, <span class="hljs-number">205</span>, <span class="hljs-number">90</span>, <span class="hljs-number">244</span>,<br>    <span class="hljs-number">31</span>, <span class="hljs-number">221</span>, <span class="hljs-number">168</span>, <span class="hljs-number">51</span>, <span class="hljs-number">136</span>, <span class="hljs-number">7</span>, <span class="hljs-number">199</span>, <span class="hljs-number">49</span>, <span class="hljs-number">177</span>, <span class="hljs-number">18</span>, <span class="hljs-number">16</span>, <span class="hljs-number">89</span>, <span class="hljs-number">39</span>, <span class="hljs-number">128</span>, <span class="hljs-number">236</span>, <span class="hljs-number">95</span>, <span class="hljs-number">96</span>, <span class="hljs-number">81</span>, <span class="hljs-number">127</span>,<br>    <span class="hljs-number">169</span>, <span class="hljs-number">25</span>, <span class="hljs-number">181</span>, <span class="hljs-number">74</span>, <span class="hljs-number">13</span>, <span class="hljs-number">45</span>, <span class="hljs-number">229</span>, <span class="hljs-number">122</span>, <span class="hljs-number">159</span>, <span class="hljs-number">147</span>, <span class="hljs-number">201</span>, <span class="hljs-number">156</span>, <span class="hljs-number">239</span>, <span class="hljs-number">160</span>, <span class="hljs-number">224</span>, <span class="hljs-number">59</span>, <span class="hljs-number">77</span>, <span class="hljs-number">174</span>,<br>    <span class="hljs-number">42</span>, <span class="hljs-number">245</span>, <span class="hljs-number">176</span>, <span class="hljs-number">200</span>, <span class="hljs-number">235</span>, <span class="hljs-number">187</span>, <span class="hljs-number">60</span>, <span class="hljs-number">131</span>, <span class="hljs-number">83</span>, <span class="hljs-number">153</span>, <span class="hljs-number">97</span>, <span class="hljs-number">23</span>, <span class="hljs-number">43</span>, <span class="hljs-number">4</span>, <span class="hljs-number">126</span>, <span class="hljs-number">186</span>, <span class="hljs-number">119</span>, <span class="hljs-number">214</span>, <span class="hljs-number">38</span>,<br>    <span class="hljs-number">225</span>, <span class="hljs-number">105</span>, <span class="hljs-number">20</span>, <span class="hljs-number">99</span>, <span class="hljs-number">85</span>, <span class="hljs-number">33</span>, <span class="hljs-number">12</span>, <span class="hljs-number">125</span>]<br>K=[]<br><span class="hljs-keyword">for</span> loc <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>): <span class="hljs-comment">#æšä¸¾ä½ç½®</span><br>    D=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>): <span class="hljs-comment">#çˆ†ç ´å¯èƒ½çš„key</span><br>        res=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<span class="hljs-comment">#å¯¹å¯†æ–‡çš„å¯¹åº”ä½ç®—å¼‚æˆ–å’Œ</span><br>            res^=s_box.index(i^givenC[j][loc])<br>        <span class="hljs-keyword">if</span>(res==<span class="hljs-number">0</span>):<br>            D.append(i)<br>    K.append(D)<br><span class="hljs-comment"># æ€»è€Œè¨€ä¹‹ï¼Œåœ¨åªåšå››è½®çš„æ—¶å€™å­˜åœ¨è¿™æ ·ä¸€ä¸ªå¯ä»¥è¢«è¯æ˜çš„å…¬å¼:</span><br><span class="hljs-comment"># æ¯ä¸€ä¸ªbyteçš„256æ¬¡æ˜æ–‡é€‰æ‹©åŠ å¯†çš„ç¬¬å››è½®çš„æœ€åä¸€æ¬¡addroundkeyä¹‹å‰çš„XORå’Œä¸º0ã€‚ä¾‹ç”¨è¿™ä¸ªç»“è®ºå¯ä»¥æŒ¨ä¸ªçˆ†ç ´æ¯ä¸€ä½keyã€‚</span><br><span class="hljs-built_in">print</span>(K)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">k, ind</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ind)[::-<span class="hljs-number">1</span>]:<br>        tmp = [<br>            xor_bytes(k[-<span class="hljs-number">3</span>], k[-<span class="hljs-number">4</span>]),<br>            xor_bytes(k[-<span class="hljs-number">2</span>], k[-<span class="hljs-number">3</span>]),<br>            xor_bytes(k[-<span class="hljs-number">1</span>], k[-<span class="hljs-number">2</span>]),<br>        ]<br>        word = <span class="hljs-built_in">list</span>(tmp[-<span class="hljs-number">1</span>])<br>        word.append(word.pop(<span class="hljs-number">0</span>))<br>        word = [s_box[b] <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> word] <br>        word[<span class="hljs-number">0</span>] ^= r_con[i]<br>        tmp = [xor_bytes(k[-<span class="hljs-number">4</span>], word)] + tmp<br>        k = tmp<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;&#x27;</span>.join(k)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs</span>(<span class="hljs-params">ind, key</span>):<br>    <span class="hljs-keyword">if</span> ind == <span class="hljs-number">16</span>:<br>        key = func([<span class="hljs-built_in">bytes</span>(key[i:i+<span class="hljs-number">4</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-number">4</span>)], <span class="hljs-number">7</span>)<br>        skeys = _expand_key(bytes2matrix(key))<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">8</span>):<br>            pti = givenP[i]<br>            cti = givenC[i]<br>            <span class="hljs-keyword">if</span> encrypt(pti, <span class="hljs-number">7</span>, skeys) != <span class="hljs-built_in">bytes</span>(cti):<span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(key.<span class="hljs-built_in">hex</span>())<br>            <span class="hljs-comment">#print(&quot;DASCTF&#123;&quot;+ sha256(key).digest().hex()+&quot;&#125;&quot;)</span><br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(K[ind])):<br>        dfs(ind+<span class="hljs-number">1</span>, key + [K[ind][i]])<br>dfs(<span class="hljs-number">0</span>,[])<br><span class="hljs-comment">#output:</span><br><span class="hljs-comment">#K=[[204, 247], [112, 251], [158, 205], [50, 73, 137], [236], [17, 219, 221, 237], [34, 55], [5, 90], [205], [63, 86], [47, 52], [32, 39, 63], [90, 194, 213], [30, 113, 182], [0, 113, 130], [8, 45, 154]]</span><br><span class="hljs-comment">#key.hex()=86f3e2d49c86425ba4d772a5f81af7b9</span><br></code></pre></td></tr></table></figure><h3 id="5o02-å¦ä¸€ä¸ªä¾‹é¢˜ï¼š0xGame2024-AES"><a href="#5o02-å¦ä¸€ä¸ªä¾‹é¢˜ï¼š0xGame2024-AES" class="headerlink" title="5o02 å¦ä¸€ä¸ªä¾‹é¢˜ï¼š0xGame2024 AES"></a>5o02 å¦ä¸€ä¸ªä¾‹é¢˜ï¼š0xGame2024 AES</h3><p>è¿™ä¸ªé¢˜ç›®å…¶å®è¿˜æ˜¯AES-Square Attackï¼Œåªæ˜¯å°† $4\times4$ çš„çŸ©é˜µå˜æˆäº† $3\times 3$ çš„çŸ©é˜µï¼Œç„¶åä» $GF(2^{8},x^8+x^4+x^3+x+1)$ åŸŸä¸­çš„è¿ç®—å˜æˆäº† $GF(3^{5},x^5+x^2+1)$ ä¸Šçš„è¿ç®—ã€‚é¢˜ç›®ç›®æ ‡æ˜¯æ‹¿åˆ°æ­£ç¡®çš„Keyï¼Œæ²¡æœ‰è¯¢é—®æ¬¡æ•°é™åˆ¶å’Œäº¤äº’æ—¶é—´é™åˆ¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Util.py</span><br><span class="hljs-keyword">from</span> GF <span class="hljs-keyword">import</span> GF<br><br>SBOX, INV_SBOX = <span class="hljs-built_in">dict</span>(), <span class="hljs-built_in">dict</span>()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span> ** <span class="hljs-number">5</span>):<br>    v = GF(<span class="hljs-number">23</span>) + (GF(<span class="hljs-number">0</span>) <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> GF(i).inverse())<br>    SBOX[GF(i)] = v<br>    INV_SBOX[v] = GF(i)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BlockCipher</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, key: <span class="hljs-built_in">bytes</span>, rnd: <span class="hljs-built_in">int</span></span>):<br>        <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(key) == <span class="hljs-number">9</span><br>        sks = [GF(b) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> key]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rnd * <span class="hljs-number">9</span>):<br>            sks.append(sks[-<span class="hljs-number">1</span>] + SBOX[sks[-<span class="hljs-number">9</span>]])<br>        <span class="hljs-variable language_">self</span>.subkeys = [sks[i:i+<span class="hljs-number">9</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, (rnd + <span class="hljs-number">1</span>) * <span class="hljs-number">9</span>, <span class="hljs-number">9</span>)]<br>        <span class="hljs-variable language_">self</span>.rnd = rnd<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_add_key</span>(<span class="hljs-params">self, l1, l2</span>):<br>        <span class="hljs-keyword">return</span> [x + y <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(l1, l2)]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_sub_key</span>(<span class="hljs-params">self, l1, l2</span>):<br>        <span class="hljs-keyword">return</span> [x - y <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(l1, l2)]<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_sub</span>(<span class="hljs-params">self, l</span>):<br>        <span class="hljs-keyword">return</span> [SBOX[x] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> l]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_sub_inv</span>(<span class="hljs-params">self, l</span>):<br>        <span class="hljs-keyword">return</span> [INV_SBOX[x] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> l]<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_shift</span>(<span class="hljs-params">self, b</span>):<br>        <span class="hljs-keyword">return</span> [<br>            b[<span class="hljs-number">0</span>], b[<span class="hljs-number">1</span>], b[<span class="hljs-number">2</span>],<br>            b[<span class="hljs-number">4</span>], b[<span class="hljs-number">5</span>], b[<span class="hljs-number">3</span>],<br>            b[<span class="hljs-number">8</span>], b[<span class="hljs-number">6</span>], b[<span class="hljs-number">7</span>]<br>        ]<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_shift_inv</span>(<span class="hljs-params">self, b</span>):<br>        <span class="hljs-keyword">return</span> [<br>            b[<span class="hljs-number">0</span>], b[<span class="hljs-number">1</span>], b[<span class="hljs-number">2</span>],<br>            b[<span class="hljs-number">5</span>], b[<span class="hljs-number">3</span>], b[<span class="hljs-number">4</span>],<br>            b[<span class="hljs-number">7</span>], b[<span class="hljs-number">8</span>], b[<span class="hljs-number">6</span>]<br>        ]<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_mix</span>(<span class="hljs-params">self, b</span>):<br>        b = b[:] <span class="hljs-comment"># Copy</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            x = GF(<span class="hljs-number">7</span>) * b[i] + GF(<span class="hljs-number">2</span>) * b[<span class="hljs-number">3</span> + i] + b[<span class="hljs-number">6</span> + i]<br>            y = GF(<span class="hljs-number">2</span>) * b[i] + b[<span class="hljs-number">3</span> + i] + GF(<span class="hljs-number">7</span>) * b[<span class="hljs-number">6</span> + i]<br>            z = b[i] + GF(<span class="hljs-number">7</span>) * b[<span class="hljs-number">3</span> + i] + GF(<span class="hljs-number">2</span>) * b[<span class="hljs-number">6</span> + i]<br>            b[i], b[<span class="hljs-number">3</span> + i], b[<span class="hljs-number">6</span> + i] = x, y, z<br>        <span class="hljs-keyword">return</span> b<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_mix_inv</span>(<span class="hljs-params">self, b</span>):<br>        b = b[:] <span class="hljs-comment"># Copy</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            x = GF(<span class="hljs-number">86</span>) * b[i] + GF(<span class="hljs-number">222</span>) * b[<span class="hljs-number">3</span> + i] + GF(<span class="hljs-number">148</span>) * b[<span class="hljs-number">6</span> + i]<br>            y = GF(<span class="hljs-number">222</span>) * b[i] + GF(<span class="hljs-number">148</span>) * b[<span class="hljs-number">3</span> + i] + GF(<span class="hljs-number">86</span>) * b[<span class="hljs-number">6</span> + i]<br>            z = GF(<span class="hljs-number">148</span>) * b[i] + GF(<span class="hljs-number">86</span>) * b[<span class="hljs-number">3</span> + i] + GF(<span class="hljs-number">222</span>) * b[<span class="hljs-number">6</span> + i]<br>            b[i], b[<span class="hljs-number">3</span> + i], b[<span class="hljs-number">6</span> + i] = x, y, z<br>        <span class="hljs-keyword">return</span> b<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self, inp: <span class="hljs-built_in">bytes</span></span>):<br>        <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(inp) == <span class="hljs-number">9</span><br>        b = [GF(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> inp]<br>        <br>        b = <span class="hljs-variable language_">self</span>._add_key(b, <span class="hljs-variable language_">self</span>.subkeys[<span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.rnd):<br>            b = <span class="hljs-variable language_">self</span>._sub(b)<br>            b = <span class="hljs-variable language_">self</span>._shift(b)<br>            <span class="hljs-keyword">if</span> i &lt; <span class="hljs-variable language_">self</span>.rnd - <span class="hljs-number">1</span>:<br>                b = <span class="hljs-variable language_">self</span>._mix(b)<br>            b = <span class="hljs-variable language_">self</span>._add_key(b, <span class="hljs-variable language_">self</span>.subkeys[i + <span class="hljs-number">1</span>])<br>        <br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>([x.to_int() <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> b])<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">self, inp: <span class="hljs-built_in">bytes</span></span>):<br>        <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(inp) == <span class="hljs-number">9</span><br>        b = [GF(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> inp]<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.rnd)):<br>            b = <span class="hljs-variable language_">self</span>._sub_key(b, <span class="hljs-variable language_">self</span>.subkeys[i + <span class="hljs-number">1</span>])<br>            <span class="hljs-keyword">if</span> i &lt; <span class="hljs-variable language_">self</span>.rnd - <span class="hljs-number">1</span>:<br>                b = <span class="hljs-variable language_">self</span>._mix_inv(b)<br>            b = <span class="hljs-variable language_">self</span>._shift_inv(b)<br>            b = <span class="hljs-variable language_">self</span>._sub_inv(b)<br>        b = <span class="hljs-variable language_">self</span>._sub_key(b, <span class="hljs-variable language_">self</span>.subkeys[<span class="hljs-number">0</span>])<br>        <br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>([x.to_int() <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> b])<br></code></pre></td></tr></table></figure><p>ä¸€å¼€å§‹äº¤äº†å‡ æ¬¡ï¼Œå‘ç°flagè€å‡ºä¸å‡ºæ¥ã€‚ç»“æœæœ¬åœ°æµ‹è¯•åå‘ç°ï¼Œå› ä¸ºè¿™è¾¹åŸºæ•°æ˜¯ $3$ï¼Œéœ€è¦åŒºåˆ†æ­£è´Ÿäº†ï¼Œæœ€åä½ è®°å½•çš„å¯èƒ½çš„è½®å¯†é’¥çš„å€¼ï¼Œå…¶å®å–è´Ÿåæ‰æ˜¯çœŸæ­£çš„è½®å¯†é’¥ï¼ˆåŸºæ•° $2$ ä¸åŒºåˆ†æ­£è´Ÿï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Cipher <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> GF <span class="hljs-keyword">import</span> GF<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> getrandbits<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">invKey</span>(<span class="hljs-params">karr,T</span>):<br>    prevK=karr[:]<br>    <span class="hljs-keyword">while</span> T:<br>        T=T-<span class="hljs-number">1</span><br>        prevK=[GF(i) <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(i)==<span class="hljs-built_in">int</span> <span class="hljs-keyword">else</span> i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> prevK]<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>            prevK= [INV_SBOX[prevK[-<span class="hljs-number">1</span>] - prevK[-<span class="hljs-number">2</span>]]] + prevK[:-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> prevK<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">randomkey</span>(<span class="hljs-params">n</span>):<br>    ktmp=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        ktmp.append(getrandbits(<span class="hljs-number">8</span>)%<span class="hljs-number">243</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(ktmp)<br>key = randomkey(<span class="hljs-number">9</span>)<br>keyarr=[i%<span class="hljs-number">243</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> key]<br>cipher = BlockCipher(key, <span class="hljs-number">4</span>)<br><br>STime=datetime.now()<br>Msgg=[<span class="hljs-built_in">bytes</span>([i,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">243</span>)]<br>Ciph=[cipher.encrypt(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Msgg]<br><br>K=[]<br><span class="hljs-keyword">for</span> loc <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>    D=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">243</span>):<br>        res=GF(<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">243</span>):<br>            res=res+INV_SBOX[GF(i)+GF(Ciph[j][loc])]<br>        <span class="hljs-keyword">if</span>(res==GF(<span class="hljs-number">0</span>)):<br>            D.append(GF(<span class="hljs-number">0</span>)-GF(i)) <span class="hljs-comment">#è¿™ä¸ªåº”è¯¥æ˜¯è´Ÿçš„</span><br>    K.append(D)<br><br><br><span class="hljs-built_in">print</span>(cipher.subkeys[-<span class="hljs-number">1</span>]) <span class="hljs-comment">#for debug, blind for solving problems.</span><br><span class="hljs-built_in">print</span>(keyarr)<br><br>guessKey=<span class="hljs-literal">None</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs</span>(<span class="hljs-params">step,kkk</span>):<br>    <span class="hljs-keyword">global</span> guessKey<br>    <span class="hljs-keyword">if</span>(step==<span class="hljs-number">9</span>):<br>        kinit=invKey(kkk[:],<span class="hljs-number">4</span>)<br>        <span class="hljs-comment">#print(kinit,keyarr)</span><br>        kkk=[i.to_int() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> kinit]<br>        testkey=<span class="hljs-built_in">bytes</span>(kkk)<br>        tciph=BlockCipher(testkey,<span class="hljs-number">4</span>)<br>        <span class="hljs-keyword">if</span>(tciph.encrypt(Msgg[<span class="hljs-number">0</span>])==Ciph[<span class="hljs-number">0</span>]):<br>            guessKey=testkey<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> K[step]:<br>        dfs(step+<span class="hljs-number">1</span>,kkk+[i])<br>dfs(<span class="hljs-number">0</span>,[])<br><span class="hljs-built_in">print</span>(key.<span class="hljs-built_in">hex</span>(),guessKey.<span class="hljs-built_in">hex</span>(),key==guessKey)<br>TTime=datetime.now()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Time Cost:<span class="hljs-subst">&#123;TTime-STime&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¿è¡Œç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">[GF(<span class="hljs-number">132</span>), GF(<span class="hljs-number">129</span>), GF(<span class="hljs-number">104</span>), GF(<span class="hljs-number">77</span>), GF(<span class="hljs-number">103</span>), GF(<span class="hljs-number">174</span>), GF(<span class="hljs-number">168</span>), GF(<span class="hljs-number">120</span>), GF(<span class="hljs-number">231</span>)]<br>[<span class="hljs-number">161</span>, <span class="hljs-number">8</span>, <span class="hljs-number">145</span>, <span class="hljs-number">192</span>, <span class="hljs-number">109</span>, <span class="hljs-number">179</span>, <span class="hljs-number">62</span>, <span class="hljs-number">234</span>, <span class="hljs-number">29</span>]<br>a10891c06db33eea1d a10891c06db33eea1d <span class="hljs-literal">True</span><br>Time Cost:<span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">02.891690</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>24Nov1</title>
    <link href="/2024/11/08/24Nov1/"/>
    <url>/2024/11/08/24Nov1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-11æœˆçš„åˆ‡é¢˜1"><a href="#huangx607087-11æœˆçš„åˆ‡é¢˜1" class="headerlink" title="huangx607087 11æœˆçš„åˆ‡é¢˜1"></a>huangx607087 11æœˆçš„åˆ‡é¢˜1</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>ä¸Šä¸€ç¯‡æ˜¯ 5 æœˆçš„åˆ‡é¢˜ï¼Œè¿™ä¸€ç¯‡æ˜¯ 11 æœˆçš„åˆ‡é¢˜ã€‚çœ‹ä¼¼éš”äº†åŠå¹´ï¼Œå®é™…éš”äº† $3$ å¹´åŠï¼Œä¹Ÿå°±æ˜¯ $\mathrm{(1+kun) years}$ã€‚</p><h2 id="1-å¼ºç½‘æ¯2024-eazyRSA"><a href="#1-å¼ºç½‘æ¯2024-eazyRSA" class="headerlink" title="1.[å¼ºç½‘æ¯2024] eazyRSA"></a>1.[å¼ºç½‘æ¯2024] eazyRSA</h2><p>ä»é¢˜ç›®çš„æ¨¡æ•°ç”Ÿæˆä»£ç æ¥çœ‹ï¼Œå¯ä»¥çŸ¥é“ $n&#x3D;4g^2ab+2ga+2gb+1&#x3D;(2ga+1)(2gb+1)$ï¼Œå…¶ä¸­ $g$ æ˜¯ $500$ä½ï¼Œ$a,b$ æ˜¯ $524$ ä½ã€‚</p><p>å¯ä»¥æ¨å¼å­ï¼š$n-1&#x3D;4g^2ab+2g(a+b)$ï¼Œé‚£ä¹Ÿå°±æœ‰ï¼š</p><p>$$<br>\frac{n-1}{2g}&#x3D;2gab+(a+b)<br>$$<br>ä¹Ÿå°±æ˜¯ï¼š<br>$$<br>\frac{n-1}{2g} \equiv (a+b) \pmod {2g}<br>$$<br>å’Œ<br>$$<br>\frac{n-1}{4g^2}&#x3D;ab+\frac{a+b}{2g}<br>$$</p><p>è®¾<br>$$<br>s&#x3D;(a+b)\bmod 2g,t&#x3D;ab+\frac{a+b}{2g}<br>$$</p><p>å¦‚æœ $a+b&lt;2g$ï¼Œé‚£ä¹ˆæ„é€ æ–¹ç¨‹  $x^2-sx+t&#x3D;0$ å°±å·²ç»å‡ºäº†ã€‚ä½†è¿™é‡Œ $a+b&gt;2g$ã€‚æœ¬åœ°æµ‹äº†å‡ ç»„ï¼Œ$\frac{a+b}{2g}$ çš„å€¼å¤§æ¦‚æ˜¯ä¸¤åƒä¸‡($(2^{23}+2^{22})\sim 2^{25}$)å·¦å³ã€‚</p><p>å› æ­¤å†™ä¸ªè„šæœ¬çˆ†ç ´å°±å¯ä»¥ï¼Œè®¾ $(a+b)&#x3D;s+2kg$ï¼Œ$ab&#x3D;t-k$ï¼Œçˆ†ç ´$k$å³å¯ï¼Œå¤§æ¦‚éœ€è¦ 40 åˆ†é’Ÿã€‚</p><p>è§£å‡ºæ¥ä¹‹åï¼Œå¤åˆ¶ $a,b$ï¼Œå°±å¯ä»¥å®Œæˆè¿™ä¸ªé¢˜äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>n=<span class="hljs-number">282.</span>..<br>e=<span class="hljs-number">65537</span><br>g=<span class="hljs-number">169.</span>..<br>enc=<span class="hljs-number">713.</span>..<br>s=<span class="hljs-built_in">int</span>(((n-<span class="hljs-number">1</span>)//(<span class="hljs-number">2</span>*g))%(<span class="hljs-number">2</span>*g))<br>t=(n-<span class="hljs-number">1</span>)//(<span class="hljs-number">4</span>*g**<span class="hljs-number">2</span>)<br>PR.&lt;x&gt;=PolynomialRing(ZZ)<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">24</span>,<span class="hljs-number">2</span>**<span class="hljs-number">25</span>)):<br>    T=(n-<span class="hljs-number">1</span>)//(<span class="hljs-number">4</span>*g**<span class="hljs-number">2</span>)-k<br>    S=s+<span class="hljs-number">2</span>*k*g<br>   <span class="hljs-comment"># print(T,S)</span><br>    L=<span class="hljs-built_in">list</span>(factor(x**<span class="hljs-number">2</span>-S*x+T))<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(L)==<span class="hljs-number">2</span>):<br>        <span class="hljs-built_in">print</span>(L)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-comment">#About 33 minutes... ...</span><br><span class="hljs-comment">#[(x - 54722203851071002380640637783364295778615257147150541196711959753700451263333616989065849396687025501437950790074260319502675063161775706578982408368898972337, 1), (x - 44622831196150967536480715584711535584181586357962911905789372910901564430321427024174796137209528941353858108707886896337555315598122100856203421182547788460, 1)]</span><br></code></pre></td></tr></table></figure><p>è·å– $a,b$ åï¼Œç›´æ¥è§£å°±å¯ä»¥å¾—åˆ° flagäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">a=<span class="hljs-number">54722203851071002380640637783364295778615257147150541196711959753700451263333616989065849396687025501437950790074260319502675063161775706578982408368898972337</span><br>b=<span class="hljs-number">44622831196150967536480715584711535584181586357962911905789372910901564430321427024174796137209528941353858108707886896337555315598122100856203421182547788460</span><br>phi=<span class="hljs-number">4</span>*g**<span class="hljs-number">2</span>*a*b<br>d=inverse(<span class="hljs-built_in">int</span>(<span class="hljs-number">65537</span>),<span class="hljs-built_in">int</span>(phi))<br>long_to_bytes(<span class="hljs-built_in">pow</span>(<span class="hljs-built_in">int</span>(enc),<span class="hljs-built_in">int</span>(d),<span class="hljs-built_in">int</span>(n)))<br><span class="hljs-comment">#b&#x27;flag&#123;4bda6015-2fe8-43f2-96c3-0ce1d6c71ab2&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>è‡ªå·±çš„è„šæœ¬è·‘äº† $30$ åˆ†é’Ÿï¼Œå› ä¸ºç”¨äº†factorï¼Œä½†å…¶å®è¿˜æœ‰æ›´å¤šçš„æ–¹æ³•ï¼Œæ¯”å¦‚ç³–é†‹å°é¸¡å¿«çš„åšå®¢ä¸­çš„bsgsæ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#reference: https://tangcuxiaojikuai.xyz/post/df3f7032.html#more</span><br>N=<span class="hljs-number">186.</span>..<br>e=<span class="hljs-number">65537</span><br>g=<span class="hljs-number">215.</span>..<br>enc=<span class="hljs-number">170.</span>..<br>gamma = <span class="hljs-number">500</span>/(<span class="hljs-number">1024</span>*<span class="hljs-number">2</span>)<br>cbits = ceil(nbits * (<span class="hljs-number">0.5</span> - <span class="hljs-number">2</span> * gamma))<br><br>M = (N - <span class="hljs-number">1</span>) // (<span class="hljs-number">2</span> * g)<br>u = M // (<span class="hljs-number">2</span> * g)<br>v = M - <span class="hljs-number">2</span> * g * u<br>GF = Zmod(N)<br>x = GF.random_element()<br>y = x ^ (<span class="hljs-number">2</span> * g)<br><span class="hljs-comment"># cçš„èŒƒå›´å¤§æ¦‚ä¸N^(0.5-2*gamma)å¾ˆæ¥è¿‘</span><br>c = bsgs(y, y ^ u, (<span class="hljs-number">2</span>**(cbits-<span class="hljs-number">1</span>), <span class="hljs-number">2</span>**(cbits+<span class="hljs-number">1</span>)), operation=<span class="hljs-string">&#x27;*&#x27;</span>)<br><span class="hljs-comment">#(a, b, bounds, operation=&#x27;*&#x27;, identity=None, inverse=None, op=None)</span><br>ab = u - c<br>apb = v + <span class="hljs-number">2</span> * g * c<br>P.&lt;x&gt; = ZZ[]<br>f = x ^ <span class="hljs-number">2</span> - apb * x + ab<br>a = f.roots()<br><span class="hljs-keyword">if</span> a:<br>    a, b = a[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], a[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]<br>    p = <span class="hljs-number">2</span> * g * a + <span class="hljs-number">1</span><br>    q = <span class="hljs-number">2</span> * g * b + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">assert</span> p * q == N<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(enc,inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)),N))))<br></code></pre></td></tr></table></figure><h2 id="2-å¼ºç½‘æ¯2024-apbq"><a href="#2-å¼ºç½‘æ¯2024-apbq" class="headerlink" title="2. [å¼ºç½‘æ¯2024]apbq"></a>2. [å¼ºç½‘æ¯2024]apbq</h2><p>é¢˜ç›®ç¬¬ä¸€å…³å¾ˆç®€å•ï¼Œç»™å‡ºäº†$h&#x3D;p+q$ ï¼Œç»“åˆ $n&#x3D;pq$ï¼Œç›´æ¥è§£æ–¹ç¨‹ $x^2-hx+n&#x3D;0$ã€‚æ”¾åˆ° sageä¸­å› å¼åˆ†è§£ï¼Œå°±èƒ½å¾—åˆ°$p,q$ï¼Œç„¶åè§£å¯†å°±è¡Œäº†</p><p><img src="/2024/11/08/24Nov1/1.png" alt="1"></p><p>é¢˜ç›®ç¬¬äºŒå…³ç»™å‡ºäº†ä¸€ç™¾ç»„ $ap+bq$ï¼Œå…¶ä¸­$a,b$æœªçŸ¥ï¼Œè§„æ¨¡çº¦ä¸º $180$ä½ã€‚è¿™ä¸ªé¢˜å°±è·Ÿä»Šå¹´åä¸ºæ¯CTF å’Œ2023 å¹´ <a href="https://blog.maple3142.net/2023/09/03/downunderctf-2023-writeups/#apbq-rsa-ii">DownUnderCTF</a>çš„é‚£ä¸ªé¢˜ä¸€æ ·ã€‚ä¸è¿‡é‚£ä¸ªé¢˜æ˜¯è§£3ç»„ï¼Œè¿™è¾¹ç»™å‡ºäº†100ç»„ã€‚</p><p>çœ‹äº†ä¸‹é‚£ä¸ªé¢˜é¢˜è§£ï¼Œå…¶å®åŸç†å°±æ˜¯è§£ACDé—®é¢˜ã€‚å‡è®¾åªæœ‰ä¸‰ç»„æ•°æ®ï¼Œé‚£å°±æ˜¯ $x_1&#x3D;a_1p+b_1q,x_2&#x3D;a_2p+b_2q,x_3&#x3D;a_3p+b_3q$ï¼Œå¯¹è¿™ä¸‰ä¸ªæ•°æ¨¡$q$ï¼Œå°±ä¼šæœ‰<br>$$<br>x_1\equiv a_1p,x_2\equiv a_2p,x_3\equiv a_3p \pmod q<br>$$</p><p>å¦‚æœèƒ½å¤Ÿæ‰¾åˆ°ä¸€ç»„$u_1,u_2,u_3$ï¼Œä½¿å¾—<br>$$<br>u_1x_1+u_2x_2+u_3x_3\equiv 0\pmod q<br>$$<br>é‚£ä¹ˆå°±å¯ä»¥ä¸ $n$åš $\gcd$ å¾—åˆ°$q$ã€‚</p><p>æ ¹æ®<a href="https://www.preprints.org/manuscript/202306.0712/v1/download">å‚è€ƒæ–‡çŒ®</a>ä¸­çš„æ–¹æ³•ï¼Œæ„é€ $(t+1)\times (t+1)$çš„æ ¼($t$ä¸ºæ•°æ®ç»„æ•°)ï¼Œæˆ‘åœ¨è§£é¢˜æ—¶å–äº† 10 ç»„æ•°æ®ã€‚</p><p><img src="/2024/11/08/24Nov1/2.png" alt="2"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">Harr =  <span class="hljs-comment">#å¤åˆ¶é¢˜ç›®ä¸­ç»™å‡ºçš„æ•°æ®</span><br>n,e = (<span class="hljs-number">73566307488763122580179867626252642940955298748752818919017828624963832700766915409125057515624347299603944790342215380220728964393071261454143348878369192979087090394858108255421841966688982884778999786076287493231499536762158941790933738200959195185310223268630105090119593363464568858268074382723204344819</span>, <span class="hljs-number">65537</span>)<br>c = <span class="hljs-number">30332590230153809507216298771130058954523332140754441956121305005101434036857592445870499808003492282406658682811671092885592290410570348283122359319554197485624784590315564056341976355615543224373344781813890901916269854242660708815123152440620383035798542275833361820196294814385622613621016771854846491244</span><br><br>vh=Matrix(ZZ,Harr[:<span class="hljs-number">10</span>]).T<br>E100=Matrix(ZZ,[[i==j <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)])<br>L1=block_matrix([vh,E100],ncols=<span class="hljs-number">2</span>)<br>L1=<span class="hljs-built_in">list</span>(L1)<br>L1.append([<span class="hljs-number">0</span>]*<span class="hljs-number">10</span>+[n])<br>L1=Matrix(ZZ,L1)<br>V=L1.LLL()<br><br></code></pre></td></tr></table></figure><p>ç„¶åå¯¹è¿™ä¸ªæ ¼è¿›è¡ŒLLLä¹‹åï¼Œå¯ä»¥å‘ç°è¿™ä¸ªæ ¼å‰ $t-2$ ä¸ªå‘é‡éƒ½éå¸¸å°ï¼Œä¸”ç¬¬ä¸€ä¸ªåˆ†é‡éƒ½æ˜¯ $0$ï¼Œå› æ­¤å¯ä»¥ä¿ç•™è¿™ $t-2 $ä¸ªå‘é‡ï¼Œæ±‚è¿™$t-2 $ä¸ªå‘é‡çš„æ ¸ç©ºé—´ã€‚</p><p>ä¹‹æ‰€ä»¥ç¬¬ä¸€ä¸ªåˆ†é‡ä¸º $0$ï¼Œæ˜¯å› ä¸ºè¿™ t-2ä¸ªå‘é‡çš„ç¬¬ä¸€ä¸ªåˆ†é‡ä¸º $\sum_{i&#x3D;1}^t x_iu_i$ï¼Œåœ¨æˆ‘ä»¬çš„è®¾å®šä¸­ï¼Œè¿™ä¸ªå€¼æ¨¡ $q$ å°±åº”è¯¥ä¸º $0$ã€‚å‰©ä¸‹çš„å€¼å…¶å®å°±æ˜¯çº¦ç®€åçš„ $x$å€¼ã€‚ä½†æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¦æ±‚ $u$ï¼Œä¸”æ»¡è¶³ $\sum_{i&#x3D;1}^t x_iu_i&#x3D;0$ï¼Œå› æ­¤å¯¹è¿™ä¸ª $t-2 $ ä¸ªå‘é‡æ±‚æ ¸ç©ºé—´å³å¯ï¼Œç„¶åæ ¹æ®è®ºæ–‡ä¸­çš„æ–¹æ³•ï¼Œå¯¹æ ¸ç©ºé—´LLLã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">listV=<span class="hljs-built_in">list</span>(V)<br>listV=listV[:<span class="hljs-number">8</span>]<br>V2=Matrix(ZZ,listV)<br>B=V2.right_kernel().matrix()<br>B=B.LLL()<br><span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> B:<br>    <span class="hljs-built_in">print</span>(b)<br>C,D=B[<span class="hljs-number">1</span>],B[<span class="hljs-number">2</span>]<br><span class="hljs-comment">#(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)</span><br><span class="hljs-comment">#(0, 189054094845986711998601686638484899186928349869787764,-280260848759201243491139877993231433651309260321040422,-191419885782217555958459422458916080605185847352273281,80130022117941963164030469836409979879630589989718363,223374223525189873441521908177956783831422862962061407,-89593942049506075242290992587826902438240116945004863,30786784715283690213436728841096788963107064929499390,-366749089468309096269501995562509974553537779662708024,-318033151667809147614797636609797089137748229551489277,31066526775222212141169199486975191411844689712886217)</span><br><span class="hljs-comment">#(0,-1346279784706528250600681657984465653742744965149886725,-558376165928956918779997224381914383468803211678279444,-699816315320719608537550250769699566822298049653746205,-1593643074383414877869701641804189953765209179320460752,-1657915058789773997163001981126904902500418293868719109,-1053323500669935374421749709512602723352760224623425605,-1012154622528129384834327358953617453656985712746546759,-794684381522339277259854046745294719668955559599542526,-476952930272344315432888118863605062412545884787988052,-1040134187110594696346363876254412992508481258190444762)</span><br><br></code></pre></td></tr></table></figure><p>æ ¸ç©ºé—´ä¸­åŒ…å«ä¸‰ä¸ª $t+1$ç»´å‘é‡ï¼Œç¬¬ä¸€ä¸ªæ˜¯ $(1,0,0,â€¦,0)$ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªåˆ†é‡æ˜¯ $\sum_{i&#x3D;1}^t x_iu_i$ï¼Œå®ƒå½“ç„¶ç­‰äº $0$ã€‚å‰©ä¸‹ä¸¤ä¸ªå‘é‡è®°ä¸º $\vec C$ å’Œ $\vec D$ ï¼Œå…¶ä¸­  $\vec C$ çš„æ¯ä¸ªåˆ†é‡ï¼ˆé™¤ç¬¬ä¸€ä¸ªåˆ†é‡ï¼Œ$\vec D$ä¸‹åŒï¼‰å¤§çº¦ä¸º $175\sim178 \mathrm{bit}$ï¼Œ$\vec D$ çš„æ¯ä¸ªåˆ†é‡ä¸º $179\sim181 \mathrm{bit}$ã€‚ä½†å› ä¸º $ap+bq$ ä¸­ï¼Œ $a$æ˜¯$180\mathrm{bit}$ (å¯¹åº”æˆ‘ä»¬æƒ³æ±‚çš„ $u$)ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³æ±‚çš„å‘é‡ $\vec U$ åº”è¯¥æ˜¯ $\vec C$å’Œ$\vec D$ çº¿æ€§ç»„åˆï¼Œæšä¸¾ä¸€ä¸‹å°ç³»æ•°ï¼Œæ ¹æ®çº¿æ€§ç»„åˆç»“æœå°è¯•å¯¹ $n$æ±‚æœ€å¤§å…¬çº¦æ•°ï¼Œå°±å¯ä»¥å‡ºè§£äº†ã€‚ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">found=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">32</span>,<span class="hljs-number">33</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">32</span>,<span class="hljs-number">33</span>):<br>        w=i*C+j*D<br>        kq=<span class="hljs-built_in">abs</span>((w[<span class="hljs-number">1</span>])*Harr[<span class="hljs-number">1</span>]-w[<span class="hljs-number">2</span>]*Harr[<span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">if</span>(GCD(n,kq)!=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> GCD(n,kq)!=n):<br>            <span class="hljs-built_in">print</span>(GCD(n,kq))<br>            found=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span>(found):<br>        <span class="hljs-keyword">break</span><br><span class="hljs-comment">#9067773077510925207378520309595658022345214442920360440202890774224295250116442048990578009377300541280465330975931465993745130297479191298485033569345231</span><br>   <br></code></pre></td></tr></table></figure><p>æµ‹è¯•æ¯”ç‰¹æ•°ï¼š</p><p><img src="/2024/11/08/24Nov1/3.png" alt="3"></p><p><strong>Update 11.10</strong> ç„¶åè¿™ä¸ªé¢˜å°±å‡ºäº†ä¸€ä¸ªä¹Œé¾™ï¼Œå°±æ˜¯ç¬¬ä¸‰éƒ¨åˆ†ç”¨äº†ç¬¬äºŒéƒ¨åˆ†çš„åŠ å¯†å‚æ•°ï¼Œä¹Ÿå°±æ˜¯åªéœ€è¦è§£å‡ºç¬¬äºŒéƒ¨åˆ†ï¼Œå°±å¯ä»¥å®Œæˆè§£é¢˜ï¼Œç¬¬ä¸‰éƒ¨åˆ†å…¶å®å®Œå…¨å¤šä½™äº†ã€‚ä½†è¿™é‡Œè¿˜æ˜¯çœ‹ä¸€ä¸‹ç¬¬ä¸‰éƒ¨åˆ†å†…å®¹å§ã€‚</p><p>ç¬¬ä¸‰éƒ¨åˆ†ç»™å‡ºäº† $c_1&#x3D;ap+q$ å’Œ $c_2&#x3D;p+bq$ã€‚æ­¤å¤„ $a,b,p,q$ å‡ä¸º $512$ ä½ã€‚</p><p>å½“æ—¶è‡ªå·±åœ¨åšçš„æ—¶å€™ï¼Œæ‰“ç®—æŠŠ $c_1$ å’Œ $c_2$ ç›¸ä¹˜çš„ï¼Œä½†æ€»æ—¶çœ‹ä¸å‡ºæ¥ä¸œè¥¿ï¼Œåªèƒ½ä½œç½¢ã€‚ä½†å®é™…ä¸Šæ­£ç¡®åšæ³•æ˜¯ $(c_1-q)$ å’Œ $(c_2-p)$ ç›¸ä¹˜ï¼Œå±•å¼€å¾—åˆ° $c_1c_2-pc_1-qc_2$ã€‚</p><p>ç„¶åæ„é€ äº†ä¸€ä¸ªï¼Œè§£ä¸å‡ºæ¥ï¼Œ$K$ ä» $2^{800}$ æå‡åˆ° $2^{3840}$ æœ€ç»ˆä¹Ÿæ²¡æœ‰å‡º</p><p><img src="/2024/11/08/24Nov1/4.png" alt="4"></p><p>ç„¶åçœ‹äº† <a href="https://mp.weixin.qq.com/s/NNfJZd6qOfotRi_AvWgISw">N0WayBack é‚£è¾¹çš„é¢˜è§£</a>ï¼Œç»“æœå‘ç°è¦çˆ†ç ´ï¼Ÿ$512$ çš„ç•Œä¸å¤Ÿï¼Œä»€ä¹ˆé¬¼ï¼Ÿé‚£è¾¹çˆ†ç ´äº† $2$ ä½ï¼Œå‘é‡ä¸Šç•Œä¸º $2^{510}$ã€‚ï¼ˆæ‰€ä»¥ä¸ºå•¥ $2^{512}$ å°±è§£ä¸å‡ºæ¥å‘¢ï¼Œè¿™ä¸ªç•Œåˆå¾—æ€ä¹ˆç®—ï¼‰ã€‚ã€‚ã€‚</p><p>ä¹Ÿå°±æ˜¯çˆ†ç ´çš„æ—¶å€™ï¼Œä½¿ç”¨è¿™ä¸ªå…¬å¼çˆ†ç ´ $p_h$ å’Œ $q_h$ã€‚<br>$$<br>c_1c_2-c_1(2^2p_h+i)-c_2(2^2q_h+j)&#x3D;0<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment">#stage3</span><br><br>n3,e3 = (<span class="hljs-number">9478.</span>.., <span class="hljs-number">65537</span>)<br>enc3 = <br>c1 = ...<br>c2 = ...<br><br>brute = <span class="hljs-number">2</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**brute):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**brute):<br>        L = Matrix(ZZ, [<br>            [<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**brute*c1],<br>            [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**brute*c2],<br>            [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**(<span class="hljs-number">512</span>-brute),c1*i+c2*j-c1*c2],<br>            [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,n3]<br>        ])<br>        L[:,-<span class="hljs-number">1</span>:] *= n3<br>        res = L.LLL()[<span class="hljs-number">0</span>]<br><br>        p = <span class="hljs-number">2</span>**brute*<span class="hljs-built_in">abs</span>(res[<span class="hljs-number">0</span>])+i<br>        <span class="hljs-keyword">if</span>(n3 % p == <span class="hljs-number">0</span>):<br>            <span class="hljs-built_in">print</span>(p)<br></code></pre></td></tr></table></figure><h2 id="3-å¼ºç½‘æ¯2024-21-steps"><a href="#3-å¼ºç½‘æ¯2024-21-steps" class="headerlink" title="3.[å¼ºç½‘æ¯2024]21 steps"></a>3.[å¼ºç½‘æ¯2024]21 steps</h2><p>ç®—æ³•æ„é€ é¢˜ï¼Œå¦‚ä½•ä½¿ç”¨ $21$ æ­¥å•æ­¥è®¡ç®—æ±‚å‡ºä¸€ä¸ª $128\mathrm{bit}$ çš„æ•° $A$ é‡Œé¢æœ‰å‡ ä¸ª $1$ï¼Œæœ‰ä¸€ä¸ªå˜é‡ $B$ ä½œä¸ºè¾…åŠ©ã€‚</p><p>æ±‚ä¸€ä¸ªæ•°çš„bitcountï¼Œåœ¨ä¸ç”¨å¾ªç¯çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨æ¯”ç‰¹èšåˆæ³•ã€‚åŸç†åœ¨<a href="https://blog.csdn.net/weixin_42369079/article/details/139062482">è¿™ä¸ªç½‘ç«™ä¸­</a>è®²å¾—å¾ˆè¯¦ç»†ã€‚</p><p>å†™æˆCè¯­è¨€ä»£ç å°±æ˜¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">unsigned</span> <span class="hljs-title function_">countOnes</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> x)</span><br>&#123;<br>    x = (x &amp; <span class="hljs-number">0x55555555</span>) + ((x &gt;&gt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0x55555555</span>); <span class="hljs-comment">/* è®¡ç®—ç›¸é‚» 2 ä½ä¸­ 1 çš„ä¸ªæ•°ã€‚ */</span><br>    x = (x &amp; <span class="hljs-number">0x33333333</span>) + ((x &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x33333333</span>); <span class="hljs-comment">/* è®¡ç®—ç›¸é‚» 4 ä½ä¸­ 1 çš„ä¸ªæ•°ã€‚ */</span><br>    x = (x &amp; <span class="hljs-number">0x0F0F0F0F</span>) + ((x &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0x0F0F0F0F</span>); <span class="hljs-comment">/* è®¡ç®—ç›¸é‚» 8 ä½ä¸­ 1 çš„ä¸ªæ•°ã€‚ */</span><br>    x = (x &amp; <span class="hljs-number">0x00FF00FF</span>) + ((x &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0x00FF00FF</span>); <span class="hljs-comment">/* è®¡ç®—ç›¸é‚» 16 ä½ä¸­ 1 çš„ä¸ªæ•°ã€‚ */</span><br>    x = (x &amp; <span class="hljs-number">0x0000FFFF</span>) + ((x &gt;&gt;<span class="hljs-number">16</span>) &amp; <span class="hljs-number">0x0000FFFF</span>); <span class="hljs-comment">/* è®¡ç®—ç›¸é‚» 32 ä½ä¸­ 1 çš„ä¸ªæ•°ã€‚ */</span><br>    <span class="hljs-keyword">return</span> x;<br>&#125;       <br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå¼å­å†™æˆç®€å•æ­¥éª¤ï¼Œå°±æ˜¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C">B=A&gt;&gt;<span class="hljs-number">1</span>;<br>A&amp;=<span class="hljs-number">0x55555555</span>;<br>B&amp;=<span class="hljs-number">0X55555555</span>;<br>A=A+B;<br></code></pre></td></tr></table></figure><p>ä½†å¯¹äº128bitæ¥è¯´ï¼Œè¿™ä¹ˆåšè¿œè¿œè¶…è¿‡äº†21æ­¥ã€‚æ ¹æ®ä¸Šé¢çš„ä»£ç ï¼Œè¿™æ ·åšéœ€è¦28æ­¥ã€‚è€ƒè™‘æ”¹å–„ã€‚</p><p>æ³¨æ„åˆ°ç»“æœä¸€å®šä¸è¶…è¿‡128ï¼Œå› æ­¤åœ¨å…«ä½èšåˆä¹‹åï¼Œå¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•æŠ˜åŠç›¸åŠ ã€‚</p><p>ï¼ˆä¸‹å›¾æ˜¯å¯¹$\mathtt{0x00112233445566778899aabbccddeeff}$èšåˆå‰ä¸‰æ­¥çš„ç»“æœï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">0x001111224455556644555566889999AA</span><br><span class="hljs-number">0x00111122112222331122223322333344</span><br><span class="hljs-number">0x00020204020404060204040604060608</span><br></code></pre></td></tr></table></figure><p>æ¯”å¦‚ $\mathtt{0x0002020402040406}$ å¯ä»¥ç›´æ¥å’Œ $\mathtt{0x0204040604060608}$ï¼Œä¹Ÿå°±æ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">B=A&gt;&gt;<span class="hljs-number">64</span>;<br>A=A+B;<br><span class="hljs-comment">#0x00020204020404060206060A060A0A0E</span><br></code></pre></td></tr></table></figure><p>è¿™æ ·å…¶å®æœ€é«˜64ä½å°±ä¸ç®¡äº†ã€‚åŒç†ï¼Œ32ä½ã€16ä½ã€8ä½ä¹Ÿå¯ä»¥è¿™ä¹ˆç©ã€‚ä¹Ÿå°±æ˜¯åœ¨èšåˆçš„å4æ­¥ï¼Œä¸æ–­åœ°å°†è€ƒè™‘å†…å®¹å‡åŠï¼Œé€æ­¥èˆå¼ƒé«˜64ã€é«˜32ã€é«˜16ã€é«˜8ä½ã€‚è¿™æ ·å››ç»„ï¼Œä¼šç”¨æ‰8æ­¥ï¼ŒåŠ ä¸Šå‰é¢12æ­¥ï¼Œå°±æ˜¯20æ­¥äº†ã€‚</p><p>æœ€åä¸€æ­¥ä¸º<code>A=A&amp;255</code>ï¼Œä¸Šé¢ä¸è¦çš„ä¸œè¥¿æ¸…é›¶ï¼Œå¾—åˆ° $\mathtt{0x40}$ ä¸ºæœ€ç»ˆç­”æ¡ˆã€‚</p><p>ï¼ˆä¸‹å›¾æ˜¯å¯¹ $\mathtt{0x00112233445566778899aabbccddeeff}$ èšåˆå‰ä¸‰æ­¥çš„ç»“æœï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">0x00020204020404060206060A060A0A0E</span><br><span class="hljs-number">0x000202040206060A040A0A1008101018</span><br><span class="hljs-number">0x00020206040A08100A140E1A12201828</span><br><span class="hljs-number">0x000204080A0E12181A1E22282C323840</span><br><span class="hljs-number">0x00000000000000000000000000000040</span><br></code></pre></td></tr></table></figure><p>å› ä¸ºé¢˜ç›®è¦æ±‚å¸¸æ•°åªèƒ½ç”¨åè¿›åˆ¶è¡¨ç¤ºï¼Œå› æ­¤å¯ä»¥å¾—åˆ°payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">payload=<span class="hljs-string">&quot;B=A&gt;&gt;1;A=A&amp;113427455640312821154458202477256070485;B=B&amp;113427455640312821154458202477256070485;A=A+B;B=A&gt;&gt;2;A=A&amp;68056473384187692692674921486353642291;B=B&amp;68056473384187692692674921486353642291;A=A+B;B=A&gt;&gt;4;A=A&amp;20016609818878733144904388672456953615;B=B&amp;20016609818878733144904388672456953615;A=A+B;B=A&gt;&gt;64;A=A+B;B=A&gt;&gt;32;A=A+B;B=A&gt;&gt;16;A=A+B;B=A&gt;&gt;8;A=A+B;A=A&amp;255;&quot;</span><br></code></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š$\mathtt{113427455640312821154458202477256070485&#x3D;0x5555 5555 5555 5555 5555 5555 5555 5555}$</p><p>è´´ä¸€ä¸‹æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python">M1=<span class="hljs-number">0x55555555555555555555555555555555</span><br>M2=<span class="hljs-number">0x33333333333333333333333333333333</span><br>M4=<span class="hljs-number">0x0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f</span><br>M8=<span class="hljs-number">0x00ff00ff00ff00ff00ff00ff00ff00ff</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bc</span>(<span class="hljs-params">A</span>):<br>    B=A&gt;&gt;<span class="hljs-number">1</span><br>    A=A&amp;M1<br>    B=B&amp;M1<br>    A=A+B<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(A))<br>    B=A&gt;&gt;<span class="hljs-number">2</span><br>    A=A&amp;M2<br>    B=B&amp;M2<br>    A=A+B<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(A))<br>    B=A&gt;&gt;<span class="hljs-number">4</span><br>    A=A&amp;M4<br>    B=B&amp;M4<br>    A=A+B<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(A))<br>    B=A&gt;&gt;<span class="hljs-number">64</span><br>    A=A+B<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(A))<br>    B=A&gt;&gt;<span class="hljs-number">32</span><br>    A=A+B<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(A))<br>    B=A&gt;&gt;<span class="hljs-number">16</span><br>    A=A+B<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(A))<br>    B=A&gt;&gt;<span class="hljs-number">8</span><br>    A=A+B<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(A))<br>    A=A&amp;<span class="hljs-number">0xFF</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;:032X&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(A))<br>    <span class="hljs-keyword">return</span> A<br><span class="hljs-built_in">print</span>(bc(<span class="hljs-number">0x00112233445566778899aabbccddeeff</span>))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">001111224455556644555566889999AA</span><br><span class="hljs-string">00111122112222331122223322333344</span><br><span class="hljs-string">00020204020404060204040604060608</span><br><span class="hljs-string">00020204020404060206060A060A0A0E</span><br><span class="hljs-string">000202040206060A040A0A1008101018</span><br><span class="hljs-string">00020206040A08100A140E1A12201828</span><br><span class="hljs-string">000204080A0E12181A1E22282C323840</span><br><span class="hljs-string">00000000000000000000000000000040</span><br><span class="hljs-string">64</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="4-ç½‘é¼æ¯2024-Crypto01"><a href="#4-ç½‘é¼æ¯2024-Crypto01" class="headerlink" title="4.[ç½‘é¼æ¯2024] Crypto01"></a>4.[ç½‘é¼æ¯2024] Crypto01</h2><p>ä¸ªRSAé¢˜ç›®ï¼Œç»™å‡ºäº† $(n,e,c)$ï¼Œä»¥åŠ  $(p,q)$ çš„é«˜ $70$ ä½ã€‚å¯†é’¥ç”Ÿæˆæ—¶ï¼Œè§£å¯†æŒ‡æ•° $d$ çš„ä½æ•°ä¸º $299$ ï¼Œå¯¹åº”  $\ln d&#x3D;0.29199\ln n                               $ã€‚è¿™ä¸ªä¸Šé™å·²ç»è¾¾åˆ°äº†extend wiener attackå¯¹åº”çš„ $\ln d&#x3D;0.292\ln n$  æé™ã€‚</p><p>æ„Ÿè§‰åƒæ˜¯wiener attack å’Œcopperç»“åˆè§£é¢˜ï¼Œæœä¸€ä¸‹ï¼Œå‘ç°äº†é¸¡å¿«å¸ˆå‚…çš„åšå®¢ã€‚çœ‹æ¥ä»Šå¹´å¯†ç æŒ‘æˆ˜èµ›å‡ºè¿‡ç±»ä¼¼çš„é¢˜ç›®ã€‚</p><p>ç‚¹è¿›å»å¹¶å‚è€ƒ<a href="https://tangcuxiaojikuai.xyz/post/4a67318c.html">åšå®¢å†…å®¹</a>ï¼Œå‘ç°ç¬¬ä¸€ç« ç¬¬3æ¡ç¬¦åˆæ¡ä»¶ï¼Œåªä¸è¿‡é‚£ä¸ªéœ€è¦çˆ†ç ´é«˜ä½ï¼Œè¿™ä¸ªé«˜ä½ç›´æ¥ç»™äº†å‡ºæ¥ã€‚</p><p>åœ¨Linux ç¯å¢ƒ(Ubuntu20.04,Sagemath9.0,python3.8.10)ä¸‹ï¼Œä¸‹è½½å¹¶å®‰è£…flatter[2]ï¼Œå°±å¯ä»¥è§£å‡ºæ¥äº†ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> subprocess <span class="hljs-keyword">import</span> check_output<br><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Pool<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flatter</span>(<span class="hljs-params">M</span>):<br>    <span class="hljs-comment"># compile https://github.com/keeganryan/flatter and put it in $PATH</span><br>    z = <span class="hljs-string">&quot;[[&quot;</span> + <span class="hljs-string">&quot;]\n[&quot;</span>.join(<span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, row)) <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> M) + <span class="hljs-string">&quot;]]&quot;</span><br>    ret = check_output([<span class="hljs-string">&quot;flatter&quot;</span>], <span class="hljs-built_in">input</span>=z.encode())<br>    <span class="hljs-keyword">from</span> re <span class="hljs-keyword">import</span> findall<br>    <span class="hljs-keyword">return</span> matrix(M.nrows(), M.ncols(), <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, findall(<span class="hljs-string">b&quot;-?\\d+&quot;</span>, ret)))<br><br>debug = <span class="hljs-literal">False</span><br><br>strict = <span class="hljs-literal">False</span><br><br><br>helpful_only = <span class="hljs-literal">True</span><br>dimension_min = <span class="hljs-number">7</span> <span class="hljs-comment"># å¦‚æœæ ¼è¾¾åˆ°è¯¥å°ºå¯¸ï¼Œåˆ™åœæ­¢ç§»é™¤</span><br><br><span class="hljs-comment"># æ˜¾ç¤ºæœ‰ç”¨çŸ¢é‡çš„ç»Ÿè®¡æ•°æ®</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">helpful_vectors</span>(<span class="hljs-params">BB, modulus</span>):<br>    nothelpful = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        <span class="hljs-keyword">if</span> BB[ii,ii] &gt;= modulus:<br>            nothelpful += <span class="hljs-number">1</span><br><br>    <span class="hljs-built_in">print</span> (nothelpful, <span class="hljs-string">&quot;/&quot;</span>, BB.dimensions()[<span class="hljs-number">0</span>], <span class="hljs-string">&quot; vectors are not helpful&quot;</span>)<br><br><span class="hljs-comment"># æ˜¾ç¤ºå¸¦æœ‰ 0 å’Œ X çš„çŸ©é˜µ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_overview</span>(<span class="hljs-params">BB, bound</span>):<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        a = (<span class="hljs-string">&#x27;%02d &#x27;</span> % ii)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">1</span>]):<br>            a += <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">if</span> BB[ii,jj] == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;X&#x27;</span><br>            <span class="hljs-keyword">if</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">60</span>: <br>                a += <span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= bound:<br>            a += <span class="hljs-string">&#x27;~&#x27;</span><br>        <span class="hljs-comment">#print (a)</span><br><br><span class="hljs-comment"># å°è¯•åˆ é™¤æ— ç”¨çš„å‘é‡</span><br><span class="hljs-comment"># ä»å½“å‰ = n-1ï¼ˆæœ€åä¸€ä¸ªå‘é‡ï¼‰å¼€å§‹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">remove_unhelpful</span>(<span class="hljs-params">BB, monomials, bound, current</span>):<br>    <span class="hljs-comment"># æˆ‘ä»¬ä»å½“å‰ = n-1ï¼ˆæœ€åä¸€ä¸ªå‘é‡ï¼‰å¼€å§‹</span><br>    <span class="hljs-keyword">if</span> current == -<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt;= dimension_min:<br>        <span class="hljs-keyword">return</span> BB<br><br>    <span class="hljs-comment"># å¼€å§‹ä»åé¢æ£€æŸ¥</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(current, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        <span class="hljs-comment">#  å¦‚æœå®ƒæ²¡æœ‰ç”¨</span><br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= bound:<br>            affected_vectors = <span class="hljs-number">0</span><br>            affected_vector_index = <span class="hljs-number">0</span><br>             <span class="hljs-comment"># è®©æˆ‘ä»¬æ£€æŸ¥å®ƒæ˜¯å¦å½±å“å…¶ä»–å‘é‡</span><br>            <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ii + <span class="hljs-number">1</span>, BB.dimensions()[<span class="hljs-number">0</span>]):<br>                <span class="hljs-comment"># å¦‚æœå¦ä¸€ä¸ªå‘é‡å—åˆ°å½±å“ï¼š</span><br>                <span class="hljs-comment"># æˆ‘ä»¬å¢åŠ è®¡æ•°</span><br>                <span class="hljs-keyword">if</span> BB[jj, ii] != <span class="hljs-number">0</span>:<br>                    affected_vectors += <span class="hljs-number">1</span><br>                    affected_vector_index = jj<br><br>            <span class="hljs-comment"># ç­‰çº§ï¼š0</span><br>            <span class="hljs-comment"># å¦‚æœæ²¡æœ‰å…¶ä»–è½½ä½“æœ€ç»ˆå—åˆ°å½±å“</span><br>            <span class="hljs-comment"># æˆ‘ä»¬åˆ é™¤å®ƒ</span><br>            <span class="hljs-keyword">if</span> affected_vectors == <span class="hljs-number">0</span>:<br>                <span class="hljs-comment">#print (&quot;* removing unhelpful vector&quot;, ii)</span><br>                BB = BB.delete_columns([ii])<br>                BB = BB.delete_rows([ii])<br>                monomials.pop(ii)<br>                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="hljs-number">1</span>)<br>                <span class="hljs-keyword">return</span> BB<br><br>           <span class="hljs-comment"># ç­‰çº§ï¼š1</span><br>            <span class="hljs-comment">#å¦‚æœåªæœ‰ä¸€ä¸ªå—åˆ°å½±å“ï¼Œæˆ‘ä»¬ä¼šæ£€æŸ¥</span><br>            <span class="hljs-comment"># å¦‚æœå®ƒæ­£åœ¨å½±å“åˆ«çš„å‘é‡</span><br>            <span class="hljs-keyword">elif</span> affected_vectors == <span class="hljs-number">1</span>:<br>                affected_deeper = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(affected_vector_index + <span class="hljs-number">1</span>, BB.dimensions()[<span class="hljs-number">0</span>]):<br>                    <span class="hljs-comment"># å¦‚æœå®ƒå½±å“å“ªæ€•ä¸€ä¸ªå‘é‡</span><br>                    <span class="hljs-comment"># æˆ‘ä»¬æ”¾å¼ƒè¿™ä¸ª</span><br>                    <span class="hljs-keyword">if</span> BB[kk, affected_vector_index] != <span class="hljs-number">0</span>:<br>                        affected_deeper = <span class="hljs-literal">False</span><br>                <span class="hljs-comment"># å¦‚æœæ²¡æœ‰å…¶ä»–å‘é‡å—åˆ°å½±å“ï¼Œåˆ™å°†å…¶åˆ é™¤ï¼Œå¹¶ä¸”</span><br>                <span class="hljs-comment"># è¿™ä¸ªæœ‰ç”¨çš„å‘é‡ä¸å¤Ÿæœ‰ç”¨</span><br>                <span class="hljs-comment">#ä¸æˆ‘ä»¬æ— ç”¨çš„ç›¸æ¯”</span><br>                <span class="hljs-keyword">if</span> affected_deeper <span class="hljs-keyword">and</span> <span class="hljs-built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="hljs-built_in">abs</span>(bound - BB[ii, ii]):<br>                    <span class="hljs-comment">#print (&quot;* removing unhelpful vectors&quot;, ii, &quot;and&quot;, affected_vector_index)</span><br>                    BB = BB.delete_columns([affected_vector_index, ii])<br>                    BB = BB.delete_rows([affected_vector_index, ii])<br>                    monomials.pop(affected_vector_index)<br>                    monomials.pop(ii)<br>                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="hljs-number">1</span>)<br>                    <span class="hljs-keyword">return</span> BB<br>    <span class="hljs-comment"># nothing happened</span><br>    <span class="hljs-keyword">return</span> BB<br><br><span class="hljs-string">&quot;&quot;&quot; </span><br><span class="hljs-string">Returns:</span><br><span class="hljs-string">* 0,0   if it fails</span><br><span class="hljs-string">* -1ï¼Œ-1 å¦‚æœ &quot;strict=true&quot;ï¼Œå¹¶ä¸”è¡Œåˆ—å¼ä¸å—çº¦æŸ</span><br><span class="hljs-string">* x0,y0 the solutions of `pol`</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">boneh_durfee</span>(<span class="hljs-params">pol, modulus, mm, tt, XX, YY</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Boneh and Durfee revisited by Herrmann and May</span><br><span class="hljs-string">    </span><br><span class="hljs-string"> åœ¨ä»¥ä¸‹æƒ…å†µä¸‹æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼š</span><br><span class="hljs-string">* d &lt; N^delta</span><br><span class="hljs-string">* |x|&lt; e^delta</span><br><span class="hljs-string">* |y|&lt; e^0.5</span><br><span class="hljs-string">æ¯å½“ delta &lt; 1 - sqrtï¼ˆ2ï¼‰/2 ~ 0.292</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    <span class="hljs-comment"># substitution (Herrman and May)</span><br>    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)   <span class="hljs-comment">#å¤šé¡¹å¼ç¯</span><br>    Q = PR.quotient(x*y + <span class="hljs-number">1</span> - u)        <span class="hljs-comment">#  u = xy + 1</span><br>    polZ = Q(pol).lift()<br><br>    UU = XX*YY + <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># x-ç§»ä½</span><br>    gg = []<br>    <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm - kk + <span class="hljs-number">1</span>):<br>            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk<br>            gg.append(xshift)<br>    gg.sort()<br><br>    <span class="hljs-comment"># å•é¡¹å¼ x ç§»ä½åˆ—è¡¨</span><br>    monomials = []<br>    <span class="hljs-keyword">for</span> polynomial <span class="hljs-keyword">in</span> gg:<br>        <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> polynomial.monomials(): <span class="hljs-comment">#å¯¹äºå¤šé¡¹å¼ä¸­çš„å•é¡¹å¼ã€‚å•é¡¹å¼ï¼ˆï¼‰ï¼š</span><br>            <span class="hljs-keyword">if</span> monomial <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> monomials:  <span class="hljs-comment"># å¦‚æœå•é¡¹ä¸åœ¨å•é¡¹ä¸­</span><br>                monomials.append(monomial)<br>    monomials.sort()<br>    <br>    <span class="hljs-comment"># y-ç§»ä½</span><br>    <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, tt + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(floor(mm/tt) * jj, mm + <span class="hljs-number">1</span>):<br>            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)<br>            yshift = Q(yshift).lift()<br>            gg.append(yshift) <span class="hljs-comment"># substitution</span><br>    <br>    <span class="hljs-comment"># å•é¡¹å¼ y ç§»ä½åˆ—è¡¨</span><br>    <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, tt + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(floor(mm/tt) * jj, mm + <span class="hljs-number">1</span>):<br>            monomials.append(u^kk * y^jj)<br><br>    <span class="hljs-comment"># æ„é€ æ ¼ B</span><br>    nn = <span class="hljs-built_in">len</span>(monomials)<br>    BB = Matrix(ZZ, nn)<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>        BB[ii, <span class="hljs-number">0</span>] = gg[ii](<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, ii + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> monomials[jj] <span class="hljs-keyword">in</span> gg[ii].monomials():<br>                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)<br><br>    <span class="hljs-comment">#çº¦åŒ–æ ¼çš„åŸå‹</span><br>    <span class="hljs-keyword">if</span> helpful_only:<br>        <span class="hljs-comment">#  #è‡ªåŠ¨åˆ é™¤</span><br>        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># é‡ç½®ç»´åº¦</span><br>        nn = BB.dimensions()[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> nn == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;failure&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>,<span class="hljs-number">0</span><br><br>    <span class="hljs-comment"># æ£€æŸ¥å‘é‡æ˜¯å¦æœ‰å¸®åŠ©</span><br>    <span class="hljs-keyword">if</span> debug:<br>        helpful_vectors(BB, modulus^mm)<br>    <br>    <span class="hljs-comment"># æ£€æŸ¥è¡Œåˆ—å¼æ˜¯å¦æ­£ç¡®ç•Œå®š</span><br>    det = BB.det()<br>    bound = modulus^(mm*nn)<br>    <span class="hljs-keyword">if</span> det &gt;= bound:<br>        <span class="hljs-keyword">if</span> debug:<br>            diff = (log(det) - log(bound)) / log(<span class="hljs-number">2</span>)<br>            <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))<br>        <span class="hljs-keyword">if</span> strict:<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)<br><br>    <span class="hljs-comment"># display the lattice basis</span><br>    <span class="hljs-keyword">if</span> debug:<br>        matrix_overview(BB, modulus^mm)<br><br>    <span class="hljs-comment"># LLL</span><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)<br><br>    <span class="hljs-comment">#BB = BB.BKZ(block_size=25)</span><br>    BB = flatter(BB)<br>    <br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;LLL is done!&quot;</span>)<br><br>    <span class="hljs-comment"># æ›¿æ¢å‘é‡ i å’Œ j -&gt;å¤šé¡¹å¼ 1 å’Œ 2</span><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;åœ¨æ ¼ä¸­å¯»æ‰¾çº¿æ€§æ— å…³å‘é‡&quot;</span>)<br>    found_polynomials = <span class="hljs-literal">False</span><br>    <br>    pol1_idx = <span class="hljs-number">0</span><br>    pol2_idx = <span class="hljs-number">1</span><br>            <br>    <span class="hljs-comment"># å¯¹äºi and j, æ„é€ ä¸¤ä¸ªå¤šé¡¹å¼</span><br>    <br>    PR.&lt;w,z&gt; = PolynomialRing(ZZ)<br>    pol1 = pol2 = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>        pol1 += monomials[jj](w*z+<span class="hljs-number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)<br>        pol2 += monomials[jj](w*z+<span class="hljs-number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)<br><br>    <span class="hljs-comment"># ç»“æœ</span><br>    PR.&lt;q&gt; = PolynomialRing(ZZ)<br>    rr = pol1.resultant(pol2)<br><br>    <br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (rr.is_zero() <span class="hljs-keyword">or</span> rr.monomials() == [<span class="hljs-number">1</span>]):<br>        found_polynomials = <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found_polynomials:<br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    <br>    rr = rr(q, q)<br><br>    <span class="hljs-comment"># solutions</span><br>    soly = rr.roots()<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(soly) == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;Your prediction (delta) is too small&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br><br>    soly = soly[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    ss = pol1(q, soly)<br>    solx = ss.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">return</span> solx, soly<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">pM,qM</span>):<br>    t1 = time.time()<br><br>    size=<span class="hljs-number">512</span>     <span class="hljs-comment">#The size of p; size=1024 in Tables 10</span><br>    length_N = <span class="hljs-number">2</span>*size<br>    s=<span class="hljs-number">70</span>;      <span class="hljs-comment">#s is the number of MSBs exhaustion,  which can be chosen as we need.</span><br>    nw=<span class="hljs-number">3</span>     <span class="hljs-comment">#2^nw windows</span><br>    delta = <span class="hljs-number">0.292</span><br><br>    N = <span class="hljs-number">107892573713246099817538936816485851035053538530228178586297516104462355899705036416845549988000543254717342505493461294554541098637839010844819316344397595836466293908827352240852019945855020602201742694540642287347823025883131162483705106324646432257707195307227627208850506071985510840207212074649893852289</span>;<br>    e = <span class="hljs-number">106026779355993573435326995058838659695563314723896436315704944869047461810171317853485834578907922477225219563648678852066399786593146779733369104463848604460901829459576565561299893410357693816050012889075185831684944657633027210516389798278082334754603104594287285628025433146548664548308055805258965566543</span>;<br>    c = <span class="hljs-number">74801258971353592087655273561994005413765184821038662179717923534370360999501931581907306714940348903440446458261785275314423770475637996343903355116249112854972152857616186571871846360852766323423533588570164035716759526288174656142706806500076294386681134096440267098094279442917447969106043371238327287569</span>;<br>    <span class="hljs-comment"># The parameters (N, e) can be chosen as we need. </span><br>    m = <span class="hljs-number">12</span>   <span class="hljs-comment"># æ ¼å¤§å°ï¼ˆè¶Šå¤§è¶Šå¥½/è¶Šæ…¢ï¼‰</span><br>    <span class="hljs-comment">#guess=100</span><br>    <span class="hljs-comment"># you need to be a lattice master to tweak these</span><br>    t = <span class="hljs-built_in">round</span>(((<span class="hljs-number">1</span>-<span class="hljs-number">2</span>*delta) * m))  <span class="hljs-comment"># æ¥è‡ª Herrmann å’Œ May çš„ä¼˜åŒ–</span><br>    X = floor(N^delta)  <span class="hljs-comment"># </span><br>    Y = <span class="hljs-number">2</span>*floor(N^(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)/<span class="hljs-number">2</span>^s)    <span class="hljs-comment"># å¦‚æœ pã€ q å¤§å°ç›¸åŒï¼Œåˆ™æ­£ç¡®</span><br>    <br>    p0=pM*<span class="hljs-number">2</span>^(size-s)+<span class="hljs-number">2</span>^(size-s-<span class="hljs-number">1</span>);<br>    q0=qM*<span class="hljs-number">2</span>^(size-s)+<span class="hljs-number">2</span>^(size-s-<span class="hljs-number">1</span>)<br>    <span class="hljs-comment">#qM=int(q0/2^(size-s))</span><br>    A = N + <span class="hljs-number">1</span>-pM*<span class="hljs-number">2</span>^(size-s)-qM*<span class="hljs-number">2</span>^(size-s);<br>    P.&lt;x,y&gt; = PolynomialRing(ZZ)<br>    pol = <span class="hljs-number">1</span> + x * (A + y)  <span class="hljs-comment">#æ„å»ºçš„æ–¹ç¨‹</span><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-comment">##print (&quot;=== running algorithm ===&quot;)</span><br>        start_time = time.time()<br>            <br><br>    solx, soly = boneh_durfee(pol, e, m, t, X, Y)<br><br><br>    <span class="hljs-keyword">if</span> solx &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-comment">#print (&quot;=== solution found ===&quot;)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-literal">False</span>:<br>            <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;x:&quot;</span>, solx)<br>            <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;y:&quot;</span>, soly)<br><br>        d_sol = <span class="hljs-built_in">int</span>(pol(solx, soly) / e)<br>        <span class="hljs-comment">#print (&quot;ç§é’¥d:&quot;, d)</span><br>        <span class="hljs-comment">#if(d_sol==d):</span><br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;=== solution found ===&quot;</span>)<br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;pçš„é«˜æ¯”ç‰¹ä¸ºï¼š&quot;</span>,pM)<br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;qçš„é«˜æ¯”ç‰¹ä¸ºï¼š&quot;</span>,qM)<br>        <span class="hljs-comment">#print(&quot;pçš„çœŸå®é«˜æ¯”ç‰¹ï¼š&quot;,int(p/2^(512-s)))</span><br>        <span class="hljs-comment">#print(&quot;qçš„çœŸå®é«˜æ¯”ç‰¹ï¼š&quot;,int(q/2^(512-s)))</span><br>        <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;d=&quot;</span>,d_sol)<br>        <br>    t2 = time.time()<br>    <span class="hljs-built_in">print</span>(t2-t1)<br><br>example(<span class="hljs-number">895381917907042032873</span>,<span class="hljs-number">934258518638868635029</span>)<br><br></code></pre></td></tr></table></figure><p>è¾“å‡ºå†…å®¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)<br>=== solution found ===<br>pçš„é«˜æ¯”ç‰¹ä¸ºï¼š <span class="hljs-number">895381917907042032873</span><br>qçš„é«˜æ¯”ç‰¹ä¸ºï¼š <span class="hljs-number">934258518638868635029</span><br>d= <span class="hljs-number">686044856631363471654750621230244587429581968036750428251137157884014229839209884769622191</span><br><span class="hljs-number">225.63660335540771</span><br></code></pre></td></tr></table></figure><p><del>recå’Œé¸¡å—å¸ˆå‚…tqlï¼Œçœ‹æ¥è‡ªå·±è¿˜æ˜¯å¤ªèœäº†</del></p><h2 id="5-ç½‘é¼æ¯2024-Crypto02"><a href="#5-ç½‘é¼æ¯2024-Crypto02" class="headerlink" title="5.[ç½‘é¼æ¯2024] Crypto02"></a>5.[ç½‘é¼æ¯2024] Crypto02</h2><p>ä¸€ä¸ªç®€å•é¢˜:(ï¼Œæ··åˆäº†å¥½å‡ ä¸ªå¯†ç ï¼Œä¸»è¦æ˜¯ æ¤­åœ†æ›²çº¿ç­¾åä¸­çš„ éšæœºæ•° $k$ å¤ç”¨å¯¼è‡´ç§é’¥æ³„éœ²ã€‚</p><h3 id="5o01-é¢˜ç›®å›é¡¾"><a href="#5o01-é¢˜ç›®å›é¡¾" class="headerlink" title="5o01 é¢˜ç›®å›é¡¾"></a>5o01 é¢˜ç›®å›é¡¾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding: utf-8</span><br><span class="hljs-comment">#!/usr/bin/env python2</span><br><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> FLAG <span class="hljs-keyword">import</span> flag<br><span class="hljs-comment">#flag = &#x27;wdflag&#123;123&#125;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">victory_encrypt</span>(<span class="hljs-params">plaintext, key</span>):<br>    key = key.upper()<br>    key_length = <span class="hljs-built_in">len</span>(key)<br>    plaintext = plaintext.upper()<br>    ciphertext = <span class="hljs-string">&#x27;&#x27;</span><br><br>    <span class="hljs-keyword">for</span> i, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(plaintext):<br>        <span class="hljs-keyword">if</span> char.isalpha():<br>            shift = <span class="hljs-built_in">ord</span>(key[i % key_length]) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)<br>            encrypted_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) + shift) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>))<br>            ciphertext += encrypted_char<br>        <span class="hljs-keyword">else</span>:<br>            ciphertext += char<br><br>    <span class="hljs-keyword">return</span> ciphertext<br><br>victory_key = <span class="hljs-string">&quot;WANGDINGCUP&quot;</span><br>victory_encrypted_flag = victory_encrypt(flag, victory_key)<br><br>p = <span class="hljs-number">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span><br>a = <span class="hljs-number">0</span><br>b = <span class="hljs-number">7</span><br>xG = <span class="hljs-number">0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798</span><br>yG = <span class="hljs-number">0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span><br>G = (xG, yG)<br>n = <span class="hljs-number">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span><br>h = <span class="hljs-number">1</span><br>zero = (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<br><br>dA = nextprime(random.randint(<span class="hljs-number">0</span>, n))<br><br><span class="hljs-keyword">if</span> dA &gt; n:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;warning!!&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">addition</span>(<span class="hljs-params">t1, t2</span>):<br>    <span class="hljs-keyword">if</span> t1 == zero:<br>        <span class="hljs-keyword">return</span> t2<br>    <span class="hljs-keyword">if</span> t2 == zero:<br>        <span class="hljs-keyword">return</span> t2<br>    (m1, n1) = t1<br>    (m2, n2) = t2<br>    <span class="hljs-keyword">if</span> m1 == m2:<br>        <span class="hljs-keyword">if</span> n1 == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> n1 != n2:<br>            <span class="hljs-keyword">return</span> zero<br>        <span class="hljs-keyword">else</span>:<br>            k = (<span class="hljs-number">3</span> * m1 * m1 + a) % p * gmpy2.invert(<span class="hljs-number">2</span> * n1 , p) % p<br>    <span class="hljs-keyword">else</span>:<br>        k = (n2 - n1 + p) % p * gmpy2.invert((m2 - m1 + p) % p, p) % p<br>    m3 = (k * k % p - m1 - m2 + p * <span class="hljs-number">2</span>) % p<br>    n3 = (k * (m1 - m3) % p - n1 + p) % p<br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(m3),<span class="hljs-built_in">int</span>(n3))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">multiplication</span>(<span class="hljs-params">x, k</span>):<br>    ans = zero<br>    t = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>(t &lt;= k):<br>        <span class="hljs-keyword">if</span> (k &amp;t )&gt;<span class="hljs-number">0</span>:<br>            ans = addition(ans, x)<br>        x = addition(x, x)<br>        t &lt;&lt;= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> ans<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getrs</span>(<span class="hljs-params">z, k</span>):<br>    (xp, yp) = P<br>    r = xp<br>    s = (z + r * dA % n) % n * gmpy2.invert(k, n) % n<br>    <span class="hljs-keyword">return</span> r,s<br><br>z1 = random.randint(<span class="hljs-number">0</span>, p)<br>z2 = random.randint(<span class="hljs-number">0</span>, p)<br>k = random.randint(<span class="hljs-number">0</span>, n)<br>P = multiplication(G, k)<br>hA = multiplication(G, dA)<br>r1, s1 = getrs(z1, k)<br>r2, s2 = getrs(z2, k)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;r1 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(r1))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;r2 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(r2))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;s1 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(s1))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;s2 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(s2))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;z1 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(z1))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;z2 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(z2))<br><br>key = sha256(long_to_bytes(dA)).digest()<br>cipher = AES.new(key, AES.MODE_CBC)<br>iv = cipher.iv<br>encrypted_flag = cipher.encrypt(pad(victory_encrypted_flag.encode(), AES.block_size))<br>encrypted_flag_hex = binascii.hexlify(iv + encrypted_flag).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Encrypted flag (AES in CBC mode, hex):&quot;</span>, encrypted_flag_hex)<br><br><span class="hljs-comment"># output</span><br><span class="hljs-comment"># r1 = 79874160726532694994695169930412771917232180361879898603881940022649943683773</span><br><span class="hljs-comment"># r2 = 79874160726532694994695169930412771917232180361879898603881940022649943683773</span><br><span class="hljs-comment"># s1 = 29358608937016239753744265269188516080175172712689524937715100977220465955435</span><br><span class="hljs-comment"># s2 = 67554961634695394998835343503747996265453236901689755090159384880221643931064</span><br><span class="hljs-comment"># z1 = 111511522136129031618364434769531873844221489323948711851532783654702149742966</span><br><span class="hljs-comment"># z2 = 47212724661755436010060930908038151157054551065082199607150851950104041315615</span><br><span class="hljs-comment"># (&#x27;Encrypted flag (AES in CBC mode, hex):&#x27;, u&#x27;103fb6abfe2757b21f6f9ce6901af904cee9f46ce8adb7d42d0c52e968c6bb5ba0bd2b526db879c5e1fd2f452a2bb67eba3f45fac530f43d878408a763e900eb&#x27;)</span><br></code></pre></td></tr></table></figure><h3 id="5o02-WP"><a href="#5o02-WP" class="headerlink" title="5o02 WP"></a>5o02 WP</h3><p>é¢˜ç›®è¿‡äºç®€å•ï¼Œä¸ç»†è¯´äº†ï¼Œç›´æ¥ä¸Šä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># coding: utf-8</span><br><br><span class="hljs-comment"># In[1]:</span><br><br>p = <span class="hljs-number">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span><br>a = <span class="hljs-number">0</span><br>b = <span class="hljs-number">7</span><br>xG = <span class="hljs-number">0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798</span><br>yG = <span class="hljs-number">0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span><br>n = <span class="hljs-number">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span><br>h = <span class="hljs-number">1</span><br>E=EllipticCurve(GF(p),[a,b])<br>G = E(xG, yG)<br><br><br><span class="hljs-comment"># In[2]:</span><br><br>r1 = <span class="hljs-number">111817653331957669294460466848850458804857945556928458406600106150268654577388</span><br>r2 = <span class="hljs-number">111817653331957669294460466848850458804857945556928458406600106150268654577388</span><br>s1 = <span class="hljs-number">86614391420642776223990568523561232627667766343605236785504627521619587526774</span><br>s2 = <span class="hljs-number">99777373725561160499828739472284705447694429465579067222876023876942075279416</span><br>z1 = <span class="hljs-number">96525870193778873849147733081234547336150390817999790407096946391065286856874</span><br>z2 = <span class="hljs-number">80138688082399628724400273131729065525373481983222188646486307533062536927379</span><br><br><br><span class="hljs-comment"># In[3]:</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">assert</span> r1==r2<br>r=r1<br><span class="hljs-comment">#k*s1-r*dA=z1</span><br><span class="hljs-comment">#k*s2-r*dA=z2</span><br><span class="hljs-comment">#unknown k,dA</span><br>M=matrix(GF(n),[[s1,s2],[-r,-r]])<br>v=vector(GF(n),[z1,z2])<br>veckda=v*(M**(-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(veckda)<br>k,dA=<span class="hljs-built_in">int</span>(veckda[<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(veckda[<span class="hljs-number">1</span>])<br><span class="hljs-keyword">assert</span> isPrime(dA)<br><br><br><span class="hljs-comment"># In[4]:</span><br><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>key = sha256(long_to_bytes(dA)).digest()<br><br><br><span class="hljs-comment"># In[5]:</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>encFlagHex=<span class="hljs-string">&#x27;6c201c3c4e8b0a2cdd0eca11e7101d45d7b33147d27ad1b9d57e3d1e20c7b3c2e36b8da3142dfd5abe335a604ce7018878b9f157099211a7bbda56ef5285ec0b&#x27;</span><br>ivHex,ciph1=encFlagHex[:<span class="hljs-number">32</span>],encFlagHex[<span class="hljs-number">32</span>:]<br>cipher = AES.new(key, AES.MODE_CBC,iv=<span class="hljs-built_in">bytes</span>.fromhex(ivHex))<br>cipher.decrypt(<span class="hljs-built_in">bytes</span>.fromhex(ciph1))<br><br><span class="hljs-comment"># Out[5]:</span><br><span class="hljs-comment"># b&#x27;SDSRDO&#123;58UT00432L8228R9E3G927HDWS8D67G2&#125;\x08\x08\x08\x08\x08\x08\x08\x08&#x27;</span><br><br><span class="hljs-comment"># In[6]:</span><br><br>ciph2=<span class="hljs-string">&#x27;SDSRDO&#123;58UT00432L8228R9E3G927HDWS8D67G2&#125;&#x27;</span><br><br><br><span class="hljs-comment"># In[7]:</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">victory_encrypt</span>(<span class="hljs-params">plaintext, key</span>):<br>    key = key.upper()<br>    key_length = <span class="hljs-built_in">len</span>(key)<br>    plaintext = plaintext.upper()<br>    ciphertext = <span class="hljs-string">&#x27;&#x27;</span><br><br>    <span class="hljs-keyword">for</span> i, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(plaintext):<br>        <span class="hljs-keyword">if</span> char.isalpha():<br>            shift = <span class="hljs-built_in">ord</span>(key[i % key_length]) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)<br>            encrypted_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) + shift) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>))<br>            ciphertext += encrypted_char<br>        <span class="hljs-keyword">else</span>:<br>            ciphertext += char<br>    <span class="hljs-keyword">return</span> ciphertext<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">victory_decrypt</span>(<span class="hljs-params">plaintext, key</span>):<br>    key = key.upper()<br>    key_length = <span class="hljs-built_in">len</span>(key)<br>    plaintext = plaintext.upper()<br>    ciphertext = <span class="hljs-string">&#x27;&#x27;</span><br><br>    <span class="hljs-keyword">for</span> i, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(plaintext):<br>        <span class="hljs-keyword">if</span> char.isalpha():<br>            shift = <span class="hljs-built_in">ord</span>(key[i % key_length]) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)<br>            encrypted_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) - shift) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>))<br>            ciphertext += encrypted_char<br>        <span class="hljs-keyword">else</span>:<br>            ciphertext += char<br>    <span class="hljs-keyword">return</span> ciphertext<br>vk = <span class="hljs-string">&quot;WANGDINGCUP&quot;</span><br><span class="hljs-comment"># print(victory_decrypt(ciph2,vk))</span><br>flagg=victory_decrypt(ciph2,vk)<br><span class="hljs-keyword">assert</span> victory_encrypt(flagg,vk)==ciph2<br><span class="hljs-built_in">print</span>(flagg.lower())<br><span class="hljs-keyword">assert</span> victory_encrypt(flagg.lower(),vk)==ciph2<br><br><span class="hljs-comment"># Out[7]:</span><br><span class="hljs-comment"># wdflag&#123;58ae00432d8228c9e3a927bbcd8d67d2&#125;</span><br><br></code></pre></td></tr></table></figure><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6.æ€»ç»“"></a>6.æ€»ç»“</h2><p>ä¸¤ä¸ªæ¯”èµ›ï¼Œç½‘é¼æ¯å’Œå¼ºç½‘æ¯ï¼Œåªèƒ½è¯´ç½‘é¼æ¯å¯†ç é¢˜è´¨é‡ç¡®å®æŒºå·®çš„ï¼Œå¼ºç½‘æ¯é¢˜ç›®è´¨é‡å¾ˆå¥½ã€‚ã€‚</p><p>å¼ºç½‘æ¯å‡ºäº† 7 ä¸ªé¢˜ç›®ï¼Œè‡ªå·±åšäº† 3 ä¸ªï¼Œæœ€åé˜Ÿä¼ç¬¬ 98 åï¼Œè·ç¦» 32 åçº¿ç¡®å®è¿˜æ˜¯æŒºè¿œçš„ã€‚ã€‚ã€‚</p><p>åé¢ç­‰æœ‰ç©ºè¡¥ä¸€ä¸‹å¼ºç½‘æ¯çš„é¢˜ç›®ï¼Œç„¶åååŠå­¦æœŸè¿˜æœ‰ä¸¤ä¸ªpreâ€¦å’Œè€ƒè¯•ã€‚ã€‚ã€‚ä¹Ÿæ˜¯å¤Ÿå¿™çš„<code>:(</code></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BlockCipher4</title>
    <link href="/2024/11/06/BlockCipher4/"/>
    <url>/2024/11/06/BlockCipher4/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°4"><a href="#huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°4" class="headerlink" title="huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°4"></a>huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°4</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>38ä¸ªæœˆè¿‡å»äº†ï¼Œç»ˆäºä» 3 æ›´æ–°åˆ° 4 äº†ï¼Œå¥½è€¶ï¼ï¼</p><p>å› ä¸º0xGameå‡ºäº†ä¸€ä¸ªç®€å•çš„ä¸¤è½®DESå·®åˆ†ï¼Œä¹‹å‰å¯†ç å­¦è¯¾ç¨‹ä¸­ä¹Ÿè®²äº†DESå·®åˆ†ï¼Œå› æ­¤è‡ªå·±å†³å®šå°è¯•è‡ªè¡Œæ¢ç´¢ä¸€ä¸‹DESçš„å·®åˆ†æ”»å‡»</p><blockquote><p>Review:ä½ å½“å¹´å†™è¿™ä¸ªçš„æ—¶å€™ï¼Œåº”è¯¥ä¸ä¼šæ„è¯†åˆ°3å’Œ4ä¹‹é—´éš”äº†å¤šä¹…å§</p></blockquote><h2 id="4-DESçš„å·®åˆ†æ”»å‡»"><a href="#4-DESçš„å·®åˆ†æ”»å‡»" class="headerlink" title="4. DESçš„å·®åˆ†æ”»å‡»"></a>4. DESçš„å·®åˆ†æ”»å‡»</h2><h3 id="4o01-DESçš„å·®åˆ†æ”»å‡»ç®€ä»‹"><a href="#4o01-DESçš„å·®åˆ†æ”»å‡»ç®€ä»‹" class="headerlink" title="4o01 DESçš„å·®åˆ†æ”»å‡»ç®€ä»‹"></a>4o01 DESçš„å·®åˆ†æ”»å‡»ç®€ä»‹</h3><p>DESåœ¨ 8 è½®è¿­ä»£ä¹‹åï¼Œå…¶åŸæœ¬æ˜æ–‡çš„ç»Ÿè®¡è§„å¾‹å·²ç»æ¶ˆå¤±ï¼Œå¹¶ä¸”æ‰©æ•£æ€§è¾¾åˆ°äº†æœ€å¥½ã€‚ä¸ºä½•DESè¿˜è¦è®¾è®¡æˆ 16 è½®å‘¢ï¼ŸåŸå› å°±åœ¨äºï¼Œ8è½®DESå¾ˆå®¹æ˜“å—åˆ°å·®åˆ†æ”»å‡»ã€‚</p><p>æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹å•è½®DESçš„Festialç»“æ„ï¼šEæ‰©å±•ã€Pç½®æ¢ã€è½®å¯†é’¥åŠ ã€Sç›’å››ä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­åªæœ‰Sç›’ä¸ºéçº¿æ€§éƒ¨åˆ†ï¼Œå…¶ä½™å‡ä¸ºçº¿æ€§éƒ¨åˆ†ï¼Œå¯ä»¥æ ¹æ®å·²çŸ¥å†…å®¹å»é€†æ¨ã€‚è€Œå·®åˆ†æ”»å‡»ï¼Œå°±æ˜¯æ„å»ºä¸¤ä¸ªæ˜æ–‡ $M_1$ å’Œ $M_2$ï¼ŒåŠ å¯†åå¾—åˆ° $C_1$ å’Œ $C_2$ï¼Œæ ¹æ® $M_1\oplus M_2$ å’Œ $C_1\oplus C_2$ çš„å€¼ï¼Œå°è¯•åæ¨ $K$ çš„å€¼ã€‚è€Œå·®åˆ†æ”»å‡»ä¹‹æ‰€ä»¥èƒ½å¤Ÿèµ·ä½œç”¨ï¼Œå…¶åŸå› å°±æ˜¯ $S$ ç›’çš„ä¸å‡åŒ€æ€§ã€‚ä¸‹å›¾æ˜¾ç¤ºäº† $S_1$ çš„å·®åˆ†æƒ…å†µï¼Œå¯ä»¥çœ‹å‡ºï¼šå½“ $S_0$ ä¸¤ä¸ªè¾“å…¥å¼‚æˆ–å€¼ä¸º $01\text{H}$ æ—¶ï¼Œæœ‰ $6&#x2F;64$ çš„æ¦‚ç‡ä¸¤ä¸ªè¾“å‡ºçš„å¼‚æˆ–å€¼ä¸º $3$ï¼Œ$2&#x2F;64$ çš„æ¦‚ç‡ä¸¤ä¸ªè¾“å‡ºçš„å¼‚æˆ–å€¼ä¸º $5$ï¼Œ$12&#x2F;64$ çš„æ¦‚ç‡è¾“å‡º $\mathrm{10}$ã€‚è€Œå½“ $S_0$ çš„ä¸¤ä¸ªè¾“å…¥å¼‚æˆ–å€¼ä¸º $\mathrm{34H}$ æ—¶ï¼Œä¸¤ä¸ªè¾“å‡ºå¼‚æˆ–å€¼ä¸º $2$ çš„æ¦‚ç‡è¾¾åˆ°äº† $16&#x2F;64$ã€‚ å› æ­¤ï¼Œå·®åˆ†æ”»å‡»å±äº<strong>é€‰æ‹©æ˜æ–‡æ”»å‡»</strong>ï¼Œéœ€è¦åŠ å¯†æœºæ‰èƒ½å®ç°ã€‚</p><blockquote><p>p.s. æœ¬åšæ–‡åå…­è¿›åˆ¶æ•°å‡ä¼šå‡ºç° $\mathrm{0x}$ å‰ç¼€æˆ– $\mathrm H$ åç¼€ï¼Œè‹¥æ— å‰åç¼€æ ‡æ˜çš„ï¼Œåˆ™å‡æŒ‰ç…§åè¿›åˆ¶çœ‹å¾…ã€‚$S$ ç›’ç¼–å·å–å€¼ä¸º $0\sim 7$ã€‚</p></blockquote><img src="/2024/11/06/BlockCipher4/1.png" alt="1" style="zoom: 80%;"><p>æˆ‘ä»¬ä»¥ $S_0$ ç›’è¾“å…¥å·®åˆ†ä¸º $01\text H$ ä¸ºä¾‹ï¼Œç»è¿‡å®éªŒï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„å†…å®¹ï¼šä¹Ÿå°±æ˜¯å½“ $S_0$ 0è¾“å‡ºå·®åˆ†å€¼ä¸º $3$ æ—¶ï¼Œå¯èƒ½çš„è¾“å…¥<strong>å€¼</strong>ï¼ˆä¸æ˜¯è¾“å…¥å·®åˆ†ï¼‰ä¸º $29,61,60,28,45,44$ è¿™å…­ç§ï¼ˆä»”ç»†çš„äººå¯ä»¥æ³¨æ„åˆ°ï¼šæ¯ä¸€ç»„å†…éƒ½å­˜åœ¨å¼‚æˆ–å€¼ä¸º $1$ çš„ä¸€å¯¹æ•°ï¼Œå› ä¸ºä½ çš„è¾“å…¥å·®åˆ†ä¸º $1$ï¼‰ã€‚ </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">3</span>:&#123;<span class="hljs-number">29</span>, <span class="hljs-number">61</span>, <span class="hljs-number">60</span>, <span class="hljs-number">28</span>, <span class="hljs-number">45</span>, <span class="hljs-number">44</span>&#125;<br><span class="hljs-attribute">5</span>:&#123;<span class="hljs-number">6</span>, <span class="hljs-number">7</span>&#125;<br><span class="hljs-attribute">6</span>:&#123;<span class="hljs-number">37</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">36</span>&#125;<br><span class="hljs-attribute">7</span>:&#123;<span class="hljs-number">50</span>, <span class="hljs-number">51</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>&#125;<br><span class="hljs-attribute">9</span>:&#123;<span class="hljs-number">40</span>, <span class="hljs-number">41</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">54</span>, <span class="hljs-number">55</span>, <span class="hljs-number">56</span>, <span class="hljs-number">57</span>&#125;<br><span class="hljs-attribute">10</span>:&#123;<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">38</span>, <span class="hljs-number">39</span>, <span class="hljs-number">48</span>, <span class="hljs-number">49</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">52</span>, <span class="hljs-number">53</span>, <span class="hljs-number">58</span>, <span class="hljs-number">59</span>&#125;<br><span class="hljs-attribute">11</span>:&#123;<span class="hljs-number">32</span>, <span class="hljs-number">33</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125; <br><span class="hljs-attribute">12</span>:&#123;<span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">46</span>, <span class="hljs-number">47</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">27</span>&#125;<br><span class="hljs-attribute">13</span>:&#123;<span class="hljs-number">34</span>, <span class="hljs-number">35</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">62</span>, <span class="hljs-number">63</span>&#125;<br><span class="hljs-attribute">14</span>:&#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;<br><span class="hljs-attribute">15</span>:&#123;<span class="hljs-number">42</span>, <span class="hljs-number">43</span>, <span class="hljs-number">30</span>, <span class="hljs-number">31</span>&#125;<br></code></pre></td></tr></table></figure><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼Œæ„é€ ï¼š <code>int detSCnt[8][64][16]</code> å’Œ <code>set&lt;int&gt; detSREC[8][64][16]</code>ã€‚å…¶ä¸­ï¼š<code>detSCnt[i][j][k]</code> è¡¨ç¤ºç¬¬ $i$ ä¸ª $S$ ç›’è¾“å…¥å·®åˆ†ä¸º $j$ ï¼Œè¾“å‡ºå·®åˆ†ä¸º $k$ çš„æƒ…å†µæ•°é‡ã€‚ <code>detSREC[i][j][k]</code> è¡¨ç¤ºç¬¬ $i$ ä¸ª $S$ ç›’ï¼Œè¾“å…¥å·®åˆ†ä¸º $j$ï¼Œè¾“å‡ºå·®åˆ†ä¸º $k$ æ—¶æ‰€æœ‰å¯èƒ½çš„è¾“å…¥å€¼æ„æˆçš„é›†åˆã€‚ä¾‹å¦‚ï¼š $\mathtt{detSCnt[0][1][3]&#x3D;6}$ï¼Œ$\mathtt{detSRec[0][1][3]}&#x3D;{29,61,60,28,45,44}$ã€‚æ˜¾ç„¶ï¼Œæœ‰ $\mathtt{|detSRec[i][j][k]|&#x3D;detSCnt[i][j][k]}$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">detSCnt=[[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>detSRec=[[[<span class="hljs-built_in">set</span>() <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getS</span>(<span class="hljs-params">sid,val</span>):<br>    v1,v2=<span class="hljs-number">2</span>*(<span class="hljs-keyword">not</span> <span class="hljs-keyword">not</span> (val&amp;<span class="hljs-number">32</span>))+(val&amp;<span class="hljs-number">1</span>),(val&gt;&gt;<span class="hljs-number">1</span>)&amp;<span class="hljs-number">15</span><br>    <span class="hljs-keyword">return</span> S[sid][v1][v2]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calcS</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>                in1,in2=j,k <br>                out1,out2=getS(i,in1),getS(i,in2)<br>                detin=j^k<br>                detout=out1^out2<br>                detSCnt[i][detin][detout]+=<span class="hljs-number">1</span><br>                detSRec[i][detin][detout]|=<span class="hljs-built_in">set</span>([j])<br></code></pre></td></tr></table></figure><h3 id="4o02-0xGame2024-DESçš„å®ç°ä»£ç "><a href="#4o02-0xGame2024-DESçš„å®ç°ä»£ç " class="headerlink" title="4o02 0xGame2024 DESçš„å®ç°ä»£ç "></a>4o02 0xGame2024 DESçš„å®ç°ä»£ç </h3><p>åé¢æˆ‘ä»¬ä»¥ 0xGame 2024 é‚£ä¸ªç®€åŒ–ç‰ˆDESä¸ºä¾‹ï¼Œè¿™é‡Œæ²¡æœ‰è€ƒè™‘åˆå§‹ç½®æ¢ç›’è½®å¯†é’¥çš„ç”Ÿæˆï¼Œä½†å…¶å®åŠ ä¸Šè¿™ä¸¤ä¸ªè¿‡ç¨‹ï¼Œæœ¬è´¨ä¹Ÿä¸€æ ·ã€‚å› ä¸ºè¿™ä¸¤ä¸ªè¿‡ç¨‹ä»ç„¶æ˜¯çº¿æ€§å˜æ¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Util.py</span><br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> add<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><br>__s_box = [[[<span class="hljs-number">14</span>, <span class="hljs-number">4</span>, <span class="hljs-number">13</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">8</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">13</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">14</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">13</span>]], <br>           [[<span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">14</span>, <span class="hljs-number">6</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">14</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">11</span>, <span class="hljs-number">5</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>, <span class="hljs-number">13</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">15</span>], [<span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">11</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>]], <br>           [[<span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">14</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>], [<span class="hljs-number">13</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">14</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">3</span>, <span class="hljs-number">11</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>]], <br>           [[<span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>], [<span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">11</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">14</span>]], <br>           [[<span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>], [<span class="hljs-number">14</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>], [<span class="hljs-number">11</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>]], <br>           [[<span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">13</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">0</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">11</span>, <span class="hljs-number">6</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>]], <br>           [[<span class="hljs-number">4</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">3</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">11</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">12</span>, <span class="hljs-number">2</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">14</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">10</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">12</span>]], <br>           [[<span class="hljs-number">13</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">15</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">11</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">10</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">11</span>]]]<br>__ep = [<span class="hljs-number">31</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>, <span class="hljs-number">24</span>, <span class="hljs-number">23</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">27</span>, <span class="hljs-number">28</span>, <span class="hljs-number">27</span>, <span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">30</span>, <span class="hljs-number">31</span>, <span class="hljs-number">0</span>]<br>__p = [<span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">28</span>, <span class="hljs-number">11</span>, <span class="hljs-number">27</span>, <span class="hljs-number">16</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">22</span>, <span class="hljs-number">25</span>, <span class="hljs-number">4</span>, <span class="hljs-number">17</span>, <span class="hljs-number">30</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">23</span>, <span class="hljs-number">13</span>, <span class="hljs-number">31</span>, <span class="hljs-number">26</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">18</span>, <span class="hljs-number">12</span>, <span class="hljs-number">29</span>, <span class="hljs-number">5</span>, <span class="hljs-number">21</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">24</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">EP</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">return</span> [data[x] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> __ep]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">P</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">return</span> [data[x] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> __p]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">S_box</span>(<span class="hljs-params">data</span>):<br>    output = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">48</span>, <span class="hljs-number">6</span>):<br>        row = data[i] * <span class="hljs-number">2</span> + data[i + <span class="hljs-number">5</span>]<br>        col = reduce(add, [data[i + j] * (<span class="hljs-number">2</span> ** (<span class="hljs-number">4</span> - j)) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>)])<br>        output += [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">format</span>(__s_box[i // <span class="hljs-number">6</span>][row][col], <span class="hljs-string">&#x27;04b&#x27;</span>)]<br>    <span class="hljs-keyword">return</span> output<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bytes2bin</span>(<span class="hljs-params">m</span>):<br>    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(m.<span class="hljs-built_in">hex</span>(), <span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span> * <span class="hljs-built_in">len</span>(m))]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bin2bytes</span>(<span class="hljs-params">m</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m]), <span class="hljs-number">2</span>).to_bytes(length=<span class="hljs-built_in">len</span>(m)//<span class="hljs-number">8</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">plain, key,nrd=<span class="hljs-number">2</span></span>): <span class="hljs-comment">#è¿™è¾¹ä»¥å‰æ²¡æœ‰nrdå‚æ•°ï¼Œä¹Ÿç»™åŠ ä¸Šäº†ï¼Œä»¥å‰å°±æ˜¯ 2 è½®ã€‚</span><br>    pt = bytes2bin(plain)<br>    sub_key = bytes2bin(key)<br>    L, R = pt[:<span class="hljs-number">32</span>], pt[<span class="hljs-number">32</span>:]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrd):<br>        prev_L = L<br>        L = R<br>        expanded_R = EP(R)<br>        xor_result = [a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(expanded_R, sub_key)]<br>        substituted = S_box(xor_result)<br>        permuted = P(substituted)<br>        R = [a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(permuted, prev_L)]<br>    cipher = R + L<br>    <span class="hljs-keyword">return</span> bin2bytes(cipher)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">cipher, key,nrd=<span class="hljs-number">2</span></span>):<br>    ct = bytes2bin(cipher)<br>    sub_key = bytes2bin(key)<br>    L, R = ct[:<span class="hljs-number">32</span>], ct[<span class="hljs-number">32</span>:]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrd):<br>        prev_L = L<br>        L = R<br>        expanded_R = EP(R)<br>        xor_result = [a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(expanded_R, sub_key)]<br>        substituted = S_box(xor_result)<br>        permuted = P(substituted)<br>        R = [a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(permuted, prev_L)]<br>    cipher = R + L<br>    <span class="hljs-keyword">return</span> bin2bytes(cipher)<br><span class="hljs-comment"># ä»¥ä¸‹å†…å®¹0xGameåŸé¢˜æ²¡æœ‰ï¼Œä¸ºä½œè€…è‡ªåŠ å†…å®¹</span><br>S = __s_box.copy()<br>__pinv = [<span class="hljs-number">8</span>, <span class="hljs-number">16</span>, <span class="hljs-number">22</span>, <span class="hljs-number">30</span>, <span class="hljs-number">12</span>, <span class="hljs-number">27</span>, <span class="hljs-number">1</span>, <span class="hljs-number">17</span>, <span class="hljs-number">23</span>, <span class="hljs-number">15</span>, <span class="hljs-number">29</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>, <span class="hljs-number">19</span>, <span class="hljs-number">9</span>,<span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">24</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">28</span>, <span class="hljs-number">10</span>, <span class="hljs-number">18</span>, <span class="hljs-number">31</span>, <span class="hljs-number">11</span>, <span class="hljs-number">21</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">26</span>, <span class="hljs-number">14</span>, <span class="hljs-number">20</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Pinv</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-keyword">return</span> [data[x] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> __pinv]<br></code></pre></td></tr></table></figure><h3 id="4o02-2è½®DES"><a href="#4o02-2è½®DES" class="headerlink" title="4o02 2è½®DES"></a>4o02 2è½®DES</h3><img src="/2024/11/06/BlockCipher4/2.png" alt="2" style="zoom:60%;"><p>å¯¹äºä¸¤è½®DESè€Œè¨€ï¼Œè‹¥è¾“å…¥ $(L_0,R_0)$ ï¼Œå¯ä»¥å¾—åˆ°è¾“å‡ºä¸º $(R_0,R_1)$ï¼Œç„¶åç¬¬äºŒè½®å¾—åˆ°è¾“å…¥ $(R1,R_2)$ï¼Œæœ€åäº¤æ¢ä¸€ä¸‹å¾—åˆ°å¯†æ–‡ä¸º $R_2||R_1$ã€‚</p><p>ç”±äºæœ€åæœ‰ $R_1$ çš„å­˜åœ¨ï¼Œå› æ­¤å…¶å®‰å…¨æ€§å’Œä¸€è½® DES æ²¡æœ‰å·®åˆ«ã€‚</p><p>è€Œå·²çŸ¥ $L_0,R_0,R_1$ æ—¶ï¼Œè€ƒè™‘åˆ°æœ€åä¸€æ­¥å­˜åœ¨ $\oplus L_0$ çš„æ“ä½œï¼Œå› æ­¤åœ¨ä¸€è½®ä¸­ï¼Œå¯ä»¥ç›´æ¥æ„é€  $L_0&#x3D;00000000\mathrm H$ã€‚è¿™æ ·æœ€åä¸€æ­¥å°±å¯ä»¥è¢«æˆ‘ä»¬å¿½ç•¥æ‰äº†ã€‚</p><p>å‡è®¾æ„é€  <code>(00000000H,00000000H)</code> å’Œ <code>(00000000H,12345678H)</code> ä¸¤ä¸ªæ˜æ–‡ã€‚ç”±äº $E$ ç½®æ¢æ˜¯ç¡®å®šçš„ï¼Œå› æ­¤æœ‰<br>$$<br>E(\mathtt{00000000H})&#x3D;\mathtt{000000000000H}&#x3D;\mathtt{00H,00H,00H,00H,00H,00H,00H,00H}<br>$$</p><p>$$<br>E(\mathtt{12345678H})&#x3D;\mathtt{0A41A82AC3F0H}&#x3D;\mathtt{02H,24H,06H,28H,0AH,2CH,0FH,30H}<br>$$</p><p>å› æ­¤ï¼Œç»è¿‡ E æ‰©å±•åï¼Œä¸Šä¸‹å¼‚æˆ–ï¼Œå¯ä»¥å¾—åˆ°XORå‰çš„å·®åˆ†ä¸º $\mathtt{02H,24H,06H,28H,0AH,2CH,0FH,30H}$</p><p>ç”±äºå¼‚æˆ–çš„Keyæ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤ç»è¿‡è½®å¯†é’¥åŠ åï¼ŒS ç›’çš„è¾“å…¥å·®åˆ†ä¹Ÿä¸º $\mathtt{02H,24H,06H,28H,0AH,2CH,0FH,30H}$ã€‚</p><p>å‡è®¾å¯†é’¥ä¸º $\mathtt{76AD5C3FFB2EH}&#x3D;\mathtt{2EH,2CH,3FH,0FH,1CH,35H,2AH,1DH}$ï¼ˆè¿™ä¸ªæˆ‘ä»¬ä¸çŸ¥é“ï¼‰ã€‚ä½†ä¸€è½®åŠ å¯†åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸¤ç»„æ•°æ®ï¼š  $(R_0,R_1)&#x3D;\mathtt{00000000H,3213371EH}$  å’Œ $(R_0,R_1)&#x3D;\mathtt{12345678H,86C32DB5H}$ã€‚å› ä¸ºæˆ‘ä»¬ XOR çš„ $L_0$ ä¸ºå…¨ $0$ï¼Œå› æ­¤å°†ä¸¤ä¸ª $R_1$ è¿›è¡Œ $P^{-1}$ ç½®æ¢ï¼Œå¯ä»¥å¾—åˆ° $R_0&#x3D;\mathtt{00000000H}$ å¯¹åº”çš„ $S$ ç›’è¾“å‡ºå†…å®¹ä¸º $\mathtt{34E41D72H}$ï¼Œ$R_0&#x3D;\mathtt{12345678H}$ å¯¹åº”çš„ $S$ ç›’è¾“å‡ºå†…å®¹ä¸º $\mathtt{84F321B7H}$ï¼Œä¸¤ä¸ªåšå¼‚æˆ–ï¼Œå¾—åˆ° $S$ ç›’å·®åˆ†å€¼ä¸º $\mathtt{B0173CC5H}$ã€‚è¿™ä¹Ÿé¡ºåºå¯¹åº”äº†å…«ä¸ª $S$ ç›’å„è‡ªçš„è¾“å‡ºå·®åˆ†å€¼ã€‚ </p><p><img src="/2024/11/06/BlockCipher4/3.png" alt="3"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥è¿›è¡ŒæŸ¥è¡¨ï¼šä»¥ $S_0$ ä¸ºä¾‹ï¼š<code>detSRec[0][0x02][0xB]=&#123;63,61,40,42,29,31&#125;</code>ï¼Œ<font color="red">è€Œ $S_0$ çš„ <strong>è¾“å…¥å†…å®¹ä¸º</strong> $\mathtt{02H}$ </font>ã€‚å¯¹è¿™é‡Œé¢æ‰€æœ‰çš„å†…å®¹å¼‚æˆ–è¾“å…¥å†…å®¹$\mathtt{02H}$ï¼Œå¯ä»¥å¾—åˆ° <code>0x02 xor detSRec[0][0x02][0xB]=&#123;61,63,42,40,31,29&#125;</code>ã€‚åŒç†ï¼Œå…¶ä»–çš„ä¸ƒä¸ª $S$ ç›’çš„ç›¸å…³å†…å®¹ä¹Ÿèƒ½å¤Ÿè¢«æ¨å‡ºæ¥ã€‚æ¯”å¦‚åœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°äº† $K$ çš„ç¬¬ $0\sim5$ ä½çš„å…­ä¸ªå€™é€‰å€¼å’Œ $6\sim11$ ä½çš„åä¸ªå€™é€‰å€¼ã€‚å¤šæ¬¡é€‰å–ï¼Œå–äº¤é›†ï¼Œå°±å¯ä»¥å¾—åˆ°æœ€åå¯èƒ½çš„å¯†é’¥ $K$ äº†ã€‚</p><blockquote><p>ç‰¹åˆ«æé†’ï¼šæ¨å¯†é’¥çš„æ—¶å€™ï¼Œè€ƒè™‘çš„ä¸æ˜¯è¾“å…¥å·®åˆ†ï¼Œæ˜¯è¾“å…¥å†…å®¹ï¼è¿™é‡Œå› ä¸ºæ„é€ äº†å…¨0çš„æ˜æ–‡ï¼Œè¾“å…¥å·®åˆ†å°±æ˜¯è¾“å…¥å†…å®¹ï¼Œæ­¤å¤„å·§èµ·æ¥äº†ï¼Œè¿™é‡Œä¸€å®šè¦è€ƒè™‘è¾“å…¥çš„<strong>å†…å®¹</strong>ï¼Œå› ä¸ºåªæœ‰çŸ¥é“è¾“å…¥å†…å®¹ï¼Œæ‰èƒ½å°è¯•è·å–å¯†é’¥ï¼ï¼ï¼å¯¹è¾“å…¥å·®åˆ†çš„ä½¿ç”¨ä½“ç°åœ¨äº†æˆ‘ä»¬çš„æ•°ç»„ä¸‹æ ‡é‡Œé¢ã€‚</p></blockquote><p><img src="/2024/11/06/BlockCipher4/4.png" alt="4"></p><p>0xGameåŸé¢˜æ˜¯åæ¬¡æœºä¼šï¼Œä½†å…¶å®å®Œå…¨å¤Ÿç”¨äº†ï¼Œä¸‹é¢æ˜¯ä¸¤è½®æ”»å‡»çš„è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Util <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>detSCnt=[[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>detSRec=[[[<span class="hljs-built_in">set</span>() <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getS</span>(<span class="hljs-params">sid,val</span>):<br>    v1,v2=<span class="hljs-number">2</span>*(<span class="hljs-keyword">not</span> <span class="hljs-keyword">not</span> (val&amp;<span class="hljs-number">32</span>))+(val&amp;<span class="hljs-number">1</span>),(val&gt;&gt;<span class="hljs-number">1</span>)&amp;<span class="hljs-number">15</span><br>    <span class="hljs-keyword">return</span> S[sid][v1][v2]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calcS</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>                in1,in2=j,k <br>                out1,out2=getS(i,in1),getS(i,in2)<br>                detin=j^k<br>                detout=out1^out2<br>                detSCnt[i][detin][detout]+=<span class="hljs-number">1</span><br>                detSRec[i][detin][detout]|=<span class="hljs-built_in">set</span>([j])<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getrandpair</span>(<span class="hljs-params">x</span>):<br>    a=getrandbits(<span class="hljs-number">64</span>)<br>    b=a^x<br>    <span class="hljs-keyword">return</span> a,b<br><br>calcS()<br>myKey=urandom(<span class="hljs-number">6</span>)<br>Aarr=[<span class="hljs-number">0x00000000</span>,<span class="hljs-number">0x22222222</span>,<span class="hljs-number">0x44444444</span>,<span class="hljs-number">0x88888888</span>,<span class="hljs-number">0x11111111</span>,<span class="hljs-number">0x12481248</span>,<span class="hljs-number">0x84218421</span>,<span class="hljs-number">0xedb7edb7</span>,<span class="hljs-number">0xffffffff</span>]<br>n=<span class="hljs-built_in">len</span>(Aarr)<br>M=[Aarr[i].to_bytes(<span class="hljs-number">8</span>,byteorder=<span class="hljs-string">&#x27;big&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Aarr))]<br>C=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    C.append(encrypt(M[i],myKey))<br>bC=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    cval=bytes_to_long(C[i])<br>    bC.append(((cval&amp;<span class="hljs-number">0xffffffff</span>).to_bytes(<span class="hljs-number">4</span>,byteorder=<span class="hljs-string">&#x27;big&#x27;</span>),(cval&gt;&gt;<span class="hljs-number">32</span>).to_bytes(<span class="hljs-number">4</span>,byteorder=<span class="hljs-string">&#x27;big&#x27;</span>)))<br><br>Sinput=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    beforeS=M[i][<span class="hljs-number">4</span>:]<br>    beforeS=bytes_to_long(bin2bytes(EP(bytes2bin(beforeS))))<br>    arr=[]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        arr.append(beforeS&amp;<span class="hljs-number">63</span>)<br>        beforeS&gt;&gt;=<span class="hljs-number">6</span><br>    Sinput.append(arr[::-<span class="hljs-number">1</span>])<br>Soutput=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    afterE=C[i][<span class="hljs-number">4</span>:]<br>    afterE=bytes_to_long(bin2bytes(Pinv(bytes2bin(afterE))))<br>    arr=[]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        arr.append(afterE&amp;<span class="hljs-number">15</span>)<br>        afterE&gt;&gt;=<span class="hljs-number">4</span><br>    Soutput.append(arr[::-<span class="hljs-number">1</span>])<br><span class="hljs-keyword">import</span> copy<br>dSoutput=copy.deepcopy(Soutput)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        dSoutput[i][j]^=dSoutput[<span class="hljs-number">0</span>][j]<br><span class="hljs-built_in">print</span>(Sinput)<br><span class="hljs-built_in">print</span>(dSoutput)<br>K=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    D=<span class="hljs-built_in">set</span>(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)))<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n):<br>        x=Sinput[j][i]<br>        y=dSoutput[j][i]<br>        dtmp=<span class="hljs-built_in">list</span>(detSRec[i][x][y])<br>        ctmp=[i^x <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dtmp]<br>        D&amp;=<span class="hljs-built_in">set</span>(ctmp)<br>    K.append(<span class="hljs-built_in">list</span>(D))<br><span class="hljs-built_in">print</span>(K)<br>keyguess=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    keyguess&lt;&lt;=<span class="hljs-number">6</span><br>    keyguess|=K[i][<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(keyguess)[<span class="hljs-number">2</span>:],myKey.<span class="hljs-built_in">hex</span>())<br></code></pre></td></tr></table></figure><p>å¯èƒ½çš„è¾“å‡ºç»“æœï¼Œæœ€åä¸€è¡Œä¸ºçŒœæµ‹å¯†é’¥å’Œå®é™…å¯†é’¥ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯æ­£ç¡®çš„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">Sinput=dSinput=[[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>], [<span class="hljs-number">17</span>, <span class="hljs-number">17</span>, <span class="hljs-number">17</span>, <span class="hljs-number">17</span>, <span class="hljs-number">17</span>, <span class="hljs-number">17</span>, <span class="hljs-number">17</span>, <span class="hljs-number">17</span>], [<span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>, <span class="hljs-number">34</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">36</span>, <span class="hljs-number">9</span>, <span class="hljs-number">16</span>, <span class="hljs-number">2</span>, <span class="hljs-number">36</span>, <span class="hljs-number">9</span>, <span class="hljs-number">16</span>], [<span class="hljs-number">48</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">48</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">61</span>, <span class="hljs-number">27</span>, <span class="hljs-number">54</span>, <span class="hljs-number">47</span>, <span class="hljs-number">61</span>, <span class="hljs-number">27</span>, <span class="hljs-number">54</span>, <span class="hljs-number">47</span>], [<span class="hljs-number">63</span>, <span class="hljs-number">63</span>, <span class="hljs-number">63</span>, <span class="hljs-number">63</span>, <span class="hljs-number">63</span>, <span class="hljs-number">63</span>, <span class="hljs-number">63</span>, <span class="hljs-number">63</span>]]<br>dSoutput=[[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>, <span class="hljs-number">7</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">12</span>], [<span class="hljs-number">13</span>, <span class="hljs-number">3</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>], [<span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">11</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">10</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">13</span>, <span class="hljs-number">13</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">13</span>, <span class="hljs-number">7</span>]]<br>[[<span class="hljs-number">13</span>], [<span class="hljs-number">44</span>], [<span class="hljs-number">16</span>], [<span class="hljs-number">13</span>], [<span class="hljs-number">40</span>], [<span class="hljs-number">61</span>], [<span class="hljs-number">12</span>], [<span class="hljs-number">7</span>]]<br>36c40da3d307 36c40da3d307<br></code></pre></td></tr></table></figure><h3 id="4o03-3è½®DES"><a href="#4o03-3è½®DES" class="headerlink" title="4o03 3è½®DES"></a>4o03 3è½®DES</h3><p>è¿›å…¥ä¸‰è½® DESï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ $R_2$ å’Œ $R_3$ çš„å€¼ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦å¼€å§‹é‡è§† $E$ æ‰©å±•äº†ã€‚ $E$ æ‰©å±•æ˜¯å°†æ¯ç»„ 4bit å’Œå‰ä¸€ç»„çš„æœ€åä¸€bitã€åä¸€ç»„çš„æœ€é«˜ä¸€bitç»“åˆã€‚ä¹Ÿå°±æ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">PQRS ABCD WXYZ --&gt; ZPQRSA SABCDW DWXYZP<br></code></pre></td></tr></table></figure><p>å› æ­¤ï¼Œä¸ºäº†æ¯æ¬¡åªå½±å“ä¸€ä¸ª $S$ ç›’çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹© $S$ ç›’çš„è¾“å…¥å·®åˆ†ä¸º $4,8,12$ ï¼ˆè¿™ä¸ª $12$ æ²¡æœ‰åŠ ä»»ä½•å‰åç¼€å“¦ï¼‰ï¼Œå¯¹åº”çš„åå…­è¿›åˆ¶ä½ä¸º $2,4,6$ã€‚ä¸‹é¢æˆ‘ä»¬ç»§ç»­ä»¥ $S_0$ ä¸ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">detSCnt[<span class="hljs-number">0</span>][<span class="hljs-number">4</span>]=[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>]<br>detSCnt[<span class="hljs-number">0</span>][<span class="hljs-number">8</span>]=[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>]<br>detSCnt[<span class="hljs-number">0</span>][<span class="hljs-number">12</span>]=[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>]<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“ $S_0$ è¾“å…¥å·®åˆ†ä¸º $\mathtt{0CH}$ æ—¶ï¼Œè¾“å‡ºå·®åˆ†ä¸º $\mathtt{EH}$ çš„æ¦‚ç‡æœ€é«˜ï¼Œä¸º $14&#x2F;64$ã€‚è€Œå½“ $S_0$ è¾“å‡ºå·®åˆ†å€¼ $\mathtt{EH}$ æ—¶ï¼Œå¯¹åº”è¾“å‡ºå·®åˆ†ä¸º $\mathtt{E0000000H}$ï¼Œç»è¿‡ $P$ ç›’ç½®æ¢ï¼Œå¾—åˆ° $\mathtt{00808200H}$ã€‚ç„¶åè¿™ä¸ª $\mathtt{00808200H}$ è¿˜è¦å’Œ $L_0$ å¼‚æˆ–ã€‚</p><p>å› æ­¤ï¼Œå¯ä»¥æ„é€  $(L_0,R_0)&#x3D;\mathtt{(00808200H,60000000H)}$ï¼Œè¿™æ ·åœ¨ç¬¬ä¸€è½®ç»“æŸåï¼Œç¬¬äºŒè½®è¾“å…¥çš„ $R_1$ å·®åˆ†ä¸ºå…¨ $0$ï¼Œè¿™æ · $R_2$ åœ¨å¼‚æˆ–å‰çš„å·®åˆ†å°±æ˜¯å…¨ $0$ï¼Œå¼‚æˆ–åï¼Œå¯ä»¥æœ‰ $R_2&#x3D;\mathtt{60000000H}$ã€‚</p><p>åˆ†ææ¯ä¸€æ­¥çš„æ¦‚ç‡ï¼šç¬¬ä¸€è½®è¾“å…¥å·®åˆ† $(L_0,R_0)&#x3D;\mathtt{(00808200H,60000000H)}$ï¼Œè¾“å‡ºå·®åˆ†ä¸º $\mathtt{60000000H,00000000H}$ çš„æ¦‚ç‡ä¸º $14&#x2F;64$ï¼Œç¬¬äºŒè½®è¾“å…¥å·®åˆ† $\mathtt{60000000H,00000000H}$ï¼Œè¾“å‡ºå·®åˆ† $\mathtt{00000000H,60000000H}$ çš„æ¦‚ç‡ä¸º $1$ï¼Œç¬¬ä¸‰è½®è¾“å…¥å·®åˆ† $\mathtt{00000000H,60000000H}$ï¼Œè¾“å‡ºå·®åˆ† $\mathtt{60000000H,XXXXXXXXH}$ çš„æ¦‚ç‡ä¸º $1$ã€‚å› æ­¤ï¼Œè¯¢é—® $5$ æ¬¡å·®ä¸å¤šå°±èƒ½æœ‰ä¸€æ¬¡ç¬¦åˆæ¡ä»¶çš„ç»“æœã€‚è‡³äºè¾“å‡ºå·®åˆ†ä¸ç¬¦åˆæœŸæœ›çš„æƒ…å†µï¼Œæˆ‘ä»¬ç›´æ¥ä¸¢å¼ƒï¼Œé‡æ–°è¯¢é—®ã€‚</p><p><img src="/2024/11/06/BlockCipher4/5.png" alt="5"></p><p>å› æ­¤ï¼Œæœ€åæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ° $R_2&#x3D;\mathtt{60000000H}$ çš„è¾“å‡ºå³å¯ï¼Œå¯¹äºå…¶ä»– $S$ ç›’ä¹Ÿä¸€æ ·ï¼Œè¿™è¾¹ç»™å‡ºä¸€ç»„å‚è€ƒæ•°æ®å§ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">Sç›’çš„å‚è€ƒå€¼å¦‚ä¸‹ï¼š<br>S0  0ch eh <span class="hljs-number">14</span>/<span class="hljs-number">64</span> 00808200h 60000000h  00808200h=P(e0000000h)<br>S1  08h ah <span class="hljs-number">16</span>/<span class="hljs-number">64</span> 40080000h 04000000h  40080000h=P(0a000000h)<br>S2  04h 9h <span class="hljs-number">12</span>/<span class="hljs-number">64</span> 04000100h 00200000h  ... ... ... ... ... ..<br>S3  04h 7h <span class="hljs-number">12</span>/<span class="hljs-number">64</span> <span class="hljs-number">8040</span>1000h 00020000h<br>S4  0ch 3h <span class="hljs-number">10</span>/<span class="hljs-number">64</span> 20000080h 00006000h<br>S5  08h 6h <span class="hljs-number">16</span>/<span class="hljs-number">64</span> 00200008h 00000400h<br>S6  0ch ch <span class="hljs-number">14</span>/<span class="hljs-number">64</span> <span class="hljs-number">00</span>100001h 00000060h<br>S7  04h 7h <span class="hljs-number">12</span>/<span class="hljs-number">64</span> 00020820h 00000002h<br><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ä¸‰è½®çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Util <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br>detSCnt=[[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>detSRec=[[[<span class="hljs-built_in">set</span>() <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getS</span>(<span class="hljs-params">sid,val</span>):<br>    v1,v2=<span class="hljs-number">2</span>*(<span class="hljs-keyword">not</span> <span class="hljs-keyword">not</span> (val&amp;<span class="hljs-number">32</span>))+(val&amp;<span class="hljs-number">1</span>),(val&gt;&gt;<span class="hljs-number">1</span>)&amp;<span class="hljs-number">15</span><br>    <span class="hljs-keyword">return</span> S[sid][v1][v2]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calcS</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>                in1,in2=j,k <br>                out1,out2=getS(i,in1),getS(i,in2)<br>                detin=j^k<br>                detout=out1^out2<br>                detSCnt[i][detin][detout]+=<span class="hljs-number">1</span><br>                detSRec[i][detin][detout]|=<span class="hljs-built_in">set</span>([j])<br><span class="hljs-comment">#bin2bytes(P(bytes2bin(bytes.fromhex(&#x27;00070000&#x27;)))).hex()</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getrandpair</span>(<span class="hljs-params">x</span>):<br>    a=getrandbits(<span class="hljs-number">64</span>)<br>    b=a^x<br>    <span class="hljs-keyword">return</span> a,b<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">l2b</span>(<span class="hljs-params">x,l=-<span class="hljs-number">1</span></span>):<br>    bs=long_to_bytes(x)<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(bs)&lt;l):<br>        bs=<span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>]*(l-<span class="hljs-built_in">len</span>(bs)))+bs<br>    <span class="hljs-keyword">return</span> bs<br><br>calcS()<br>myKey=urandom(<span class="hljs-number">6</span>)<span class="hljs-comment">#b&#x27;F(x)=x&#x27;</span><br>xorNum=[<span class="hljs-number">0x0080820060000000</span>,<span class="hljs-number">0x4008000004000000</span>,<span class="hljs-number">0x0400010000200000</span>,<span class="hljs-number">0x8040100000020000</span>,<br>        <span class="hljs-number">0x2000008000006000</span>,<span class="hljs-number">0x0020000800000400</span>,<span class="hljs-number">0x0010000100000060</span>,<span class="hljs-number">0x0002082000000002</span>]<br>numxe=[(<span class="hljs-number">0x0c</span>,<span class="hljs-number">0xe</span>),(<span class="hljs-number">0x08</span>,<span class="hljs-number">0xa</span>),(<span class="hljs-number">0x04</span>,<span class="hljs-number">0x9</span>),(<span class="hljs-number">0x04</span>,<span class="hljs-number">0x7</span>),<br>       (<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x3</span>),(<span class="hljs-number">0x08</span>,<span class="hljs-number">0x6</span>),(<span class="hljs-number">0x0c</span>,<span class="hljs-number">0xc</span>),(<span class="hljs-number">0x04</span>,<span class="hljs-number">0x7</span>)]<br><br>tStart=datetime.now()<br>totalQuery=<span class="hljs-number">0</span><br>K=[<span class="hljs-literal">None</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br><span class="hljs-keyword">for</span> T <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    NCipher=<span class="hljs-number">7</span><br>    Aarr=[]<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(Aarr)&lt;NCipher:<br>        totalQuery+=<span class="hljs-number">1</span><br>        a,b=getrandpair(xorNum[T])<br>        ba,bb=l2b(a,<span class="hljs-number">8</span>),l2b(b,<span class="hljs-number">8</span>)<br>        x,y=encrypt(ba,myKey,<span class="hljs-number">3</span>),encrypt(bb,myKey,<span class="hljs-number">3</span>)<br>        ix,iy=bytes_to_long(x),bytes_to_long(y)<br>        <span class="hljs-keyword">if</span>(((ix^iy)&amp;<span class="hljs-number">0xffffffff</span>)==(xorNum[T]&amp;<span class="hljs-number">0xffffffff</span>)):<br>            Aarr.append((ba,bb))<br>    Sinput=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(NCipher):<br>        r2,r3=Aarr[i][<span class="hljs-number">1</span>][<span class="hljs-number">4</span>:],Aarr[i][<span class="hljs-number">1</span>][:<span class="hljs-number">4</span>]<br>        eb=bin2bytes(EP(bytes2bin(r2)))<br>        ebi=bytes_to_long(eb)<br>        tmparr=[]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            tmparr.append(ebi&amp;<span class="hljs-number">0x3f</span>)<br>            ebi&gt;&gt;=<span class="hljs-number">6</span><br>        Sinput.append(tmparr[::-<span class="hljs-number">1</span>])<br>    sarr=detSRec[T][numxe[T][<span class="hljs-number">0</span>]][numxe[T][<span class="hljs-number">1</span>]]<br>    D=<span class="hljs-built_in">set</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(NCipher):<br>        s0=Sinput[i][T]<br>        xarr=<span class="hljs-built_in">set</span>([s0^i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> sarr])<br>        D=D&amp;xarr<br>    K[T]=D<br><br>testM=urandom(<span class="hljs-number">8</span>)<br>testC=encrypt(testM,myKey,<span class="hljs-number">3</span>)<br>totalQuery+=<span class="hljs-number">1</span><br>guessKey=<span class="hljs-literal">None</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs</span>(<span class="hljs-params">step,keyarr</span>):<br>    <span class="hljs-keyword">global</span> guessKey<br>    <span class="hljs-keyword">if</span>(step==<span class="hljs-number">8</span>):<br>        keyval=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            keyval&lt;&lt;=<span class="hljs-number">6</span><br>            keyval|=keyarr[i]<br>        key2=<span class="hljs-built_in">int</span>.to_bytes(keyval,<span class="hljs-number">6</span>,byteorder=<span class="hljs-string">&#x27;big&#x27;</span>)<br>        cc=encrypt(testM,key2,<span class="hljs-number">3</span>)<br>        <span class="hljs-keyword">if</span>(cc==testC):<br>            guessKey=key2<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> K[step]:<br>        dfs(step+<span class="hljs-number">1</span>,keyarr+[i])<br>dfs(<span class="hljs-number">0</span>,[])<br><span class="hljs-built_in">print</span>(guessKey.<span class="hljs-built_in">hex</span>(),myKey.<span class="hljs-built_in">hex</span>(),guessKey==myKey)<br><span class="hljs-keyword">if</span>(guessKey==myKey):<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Success with queryed <span class="hljs-subst">&#123;totalQuery&#125;</span> times&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Fail&#x27;</span>)<br>tEnd=datetime.now()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Time Cost:<span class="hljs-subst">&#123;tEnd-tStart&#125;</span>&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªå¯èƒ½çš„è¿è¡Œç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">fd31f37d571f fd31f37d571f <span class="hljs-literal">True</span><br>Success <span class="hljs-keyword">with</span> queryed <span class="hljs-number">407</span> times<br>Time Cost:<span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.225095</span><br></code></pre></td></tr></table></figure><h3 id="4o04-4è½®DES"><a href="#4o04-4è½®DES" class="headerlink" title="4o04 4è½®DES"></a>4o04 4è½®DES</h3><p>å¯¹äº 4 è½® DES è€Œè¨€ï¼Œå…¶åœ¨ 3 è½®ä¸Šé¢åˆå¤šäº†ä¸€è½®ï¼Œæˆ‘ä»¬ä¹‹å‰å·²çŸ¥ï¼Œè¾“å…¥å·®åˆ†ä¸º $\mathtt{60000000H}$ æ—¶ï¼Œè¾“å‡ºå·®åˆ†ä¸º $\mathtt{00808200H}$ çš„æ¦‚ç‡ä¸º $14&#x2F;64$ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç¬¬ä¸‰è½®çš„åŸºç¡€ä¸Šï¼Œç»§ç»­è€ƒè™‘ è¿™ $14&#x2F;64$çš„æ¦‚ç‡ï¼šè¾“å‡º $R_3&#x3D;\mathtt{00808200H}$ ã€‚è¿™æ ·ï¼Œå¤§çº¦æ¯ $21$ æ¬¡æŸ¥è¯¢ï¼Œå°±å¯ä»¥è·å¾—ä¸€æ¬¡æ»¡è¶³$L_4&#x3D;R_3&#x3D;\mathtt{00808200H}$ çš„æƒ…å†µã€‚</p><p><img src="/2024/11/06/BlockCipher4/6.png" alt="6"></p><p>æ”»å‡»ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Util <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br>detSCnt=[[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>detSRec=[[[<span class="hljs-built_in">set</span>() <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getS</span>(<span class="hljs-params">sid,val</span>):<br>    v1,v2=<span class="hljs-number">2</span>*(<span class="hljs-keyword">not</span> <span class="hljs-keyword">not</span> (val&amp;<span class="hljs-number">32</span>))+(val&amp;<span class="hljs-number">1</span>),(val&gt;&gt;<span class="hljs-number">1</span>)&amp;<span class="hljs-number">15</span><br>    <span class="hljs-keyword">return</span> S[sid][v1][v2]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calcS</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>                in1,in2=j,k <br>                out1,out2=getS(i,in1),getS(i,in2)<br>                detin=j^k<br>                detout=out1^out2<br>                detSCnt[i][detin][detout]+=<span class="hljs-number">1</span><br>                detSRec[i][detin][detout]|=<span class="hljs-built_in">set</span>([j])<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getrandpair</span>(<span class="hljs-params">x</span>):<br>    a=getrandbits(<span class="hljs-number">64</span>)<br>    b=a^x<br>    <span class="hljs-keyword">return</span> a,b<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">l2b</span>(<span class="hljs-params">x,l=-<span class="hljs-number">1</span></span>):<br>    bs=long_to_bytes(x)<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(bs)&lt;l):<br>        bs=<span class="hljs-built_in">bytes</span>([<span class="hljs-number">0</span>]*(l-<span class="hljs-built_in">len</span>(bs)))+bs<br>    <span class="hljs-keyword">return</span> bs<br><br>calcS()<br>myKey=urandom(<span class="hljs-number">6</span>)<br>xorNum=[<span class="hljs-number">0x0080820060000000</span>,<span class="hljs-number">0x4008000004000000</span>,<span class="hljs-number">0x0400010000200000</span>,<span class="hljs-number">0x8040100000020000</span>,<br>        <span class="hljs-number">0x2000008000006000</span>,<span class="hljs-number">0x0020000800000400</span>,<span class="hljs-number">0x0010000100000060</span>,<span class="hljs-number">0x0002082000000002</span>]<br>T=<span class="hljs-number">0</span><br>totalQuery=<span class="hljs-number">0</span><br>NCipher=<span class="hljs-number">5</span><br>tStart=datetime.now()<br>K=[<span class="hljs-built_in">set</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>))<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br><span class="hljs-keyword">for</span> T <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    Aarr=[]<br>    Carr=[]<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">len</span>(Aarr)&lt;NCipher):<br>        totalQuery+=<span class="hljs-number">1</span><br>        a,b=getrandpair(xorNum[T])<br>        ba,bb=l2b(a,<span class="hljs-number">8</span>),l2b(b,<span class="hljs-number">8</span>)<br>        x,y=encrypt(ba,myKey,<span class="hljs-number">4</span>),encrypt(bb,myKey,<span class="hljs-number">4</span>)<br>        ix,iy=bytes_to_long(x),bytes_to_long(y)<br>        <span class="hljs-keyword">if</span>(((ix^iy)&amp;<span class="hljs-number">0xffffffff</span>)==(xorNum[T]&gt;&gt;<span class="hljs-number">32</span>)):<br>            Aarr.append((ba,bb))<br>            Carr.append((x,y))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        r3,r4=Carr[i][<span class="hljs-number">1</span>][<span class="hljs-number">4</span>:],Carr[i][<span class="hljs-number">1</span>][:<span class="hljs-number">4</span>]<br>        r30,r40=Carr[i][<span class="hljs-number">0</span>][<span class="hljs-number">4</span>:],Carr[i][<span class="hljs-number">0</span>][:<span class="hljs-number">4</span>]<br>        dr4=bytes_to_long(r4)^bytes_to_long(r40)<br>        dr4^=xorNum[T]&amp;<span class="hljs-number">0xffffffff</span><br>        bdr4=l2b(dr4,<span class="hljs-number">4</span>)<br>        din=xorNum[T]&gt;&gt;<span class="hljs-number">32</span><br>        X=EP(bytes2bin(l2b(din,<span class="hljs-number">4</span>)))<br>        dSin=[<span class="hljs-number">32</span>*X[<span class="hljs-number">6</span>*_]+<span class="hljs-number">16</span>*X[<span class="hljs-number">6</span>*_+<span class="hljs-number">1</span>]+<span class="hljs-number">8</span>*X[<span class="hljs-number">6</span>*_+<span class="hljs-number">2</span>]+<span class="hljs-number">4</span>*X[<span class="hljs-number">6</span>*_+<span class="hljs-number">3</span>]+<span class="hljs-number">2</span>*X[<span class="hljs-number">6</span>*_+<span class="hljs-number">4</span>]+X[<span class="hljs-number">6</span>*_+<span class="hljs-number">5</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>        iSout=bytes_to_long(bin2bytes(Pinv(bytes2bin(bdr4))))<br>        dSout=[]<br>        r3Sin=[]<br>        r3E=EP(bytes2bin(r3))<br>        r3Sin=[<span class="hljs-number">32</span>*r3E[<span class="hljs-number">6</span>*_]+<span class="hljs-number">16</span>*r3E[<span class="hljs-number">6</span>*_+<span class="hljs-number">1</span>]+<span class="hljs-number">8</span>*r3E[<span class="hljs-number">6</span>*_+<span class="hljs-number">2</span>]+<span class="hljs-number">4</span>*r3E[<span class="hljs-number">6</span>*_+<span class="hljs-number">3</span>]+<span class="hljs-number">2</span>*r3E[<span class="hljs-number">6</span>*_+<span class="hljs-number">4</span>]+r3E[<span class="hljs-number">6</span>*_+<span class="hljs-number">5</span>] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            dSout.append(iSout&amp;<span class="hljs-number">15</span>)<br>            iSout&gt;&gt;=<span class="hljs-number">4</span><br>        dSout=dSout[::-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            tmpset=<span class="hljs-built_in">list</span>(detSRec[j][dSin[j]][dSout[j]])<br>            keyset=<span class="hljs-built_in">set</span>([ts ^ r3Sin[j]<span class="hljs-keyword">for</span> ts <span class="hljs-keyword">in</span> tmpset])<br>            K[j]&amp;=keyset<br>testM=urandom(<span class="hljs-number">8</span>)<br>testC=encrypt(testM,myKey,<span class="hljs-number">3</span>)<br>totalQuery+=<span class="hljs-number">1</span><br>guessKey=<span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs</span>(<span class="hljs-params">step,keyarr</span>):<br>    <span class="hljs-keyword">global</span> guessKey<br>    <span class="hljs-keyword">if</span>(step==<span class="hljs-number">8</span>):<br>        keyval=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            keyval&lt;&lt;=<span class="hljs-number">6</span><br>            keyval|=keyarr[i]<br>        key2=<span class="hljs-built_in">int</span>.to_bytes(keyval,<span class="hljs-number">6</span>,byteorder=<span class="hljs-string">&#x27;big&#x27;</span>)<br>        cc=encrypt(testM,key2,<span class="hljs-number">3</span>)<br>        <span class="hljs-keyword">if</span>(cc==testC):<br>            guessKey=key2<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> K[step]:<br>        dfs(step+<span class="hljs-number">1</span>,keyarr+[i])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;K=<span class="hljs-subst">&#123;K&#125;</span>&#x27;</span>)<br>dfs(<span class="hljs-number">0</span>,[])<br><span class="hljs-built_in">print</span>(guessKey.<span class="hljs-built_in">hex</span>(),myKey.<span class="hljs-built_in">hex</span>(),guessKey==myKey)<br><span class="hljs-keyword">if</span>(guessKey==myKey):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Success with queryed <span class="hljs-subst">&#123;totalQuery&#125;</span> times&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Fail&#x27;</span>)<br>tEnd=datetime.now()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Time Cost:<span class="hljs-subst">&#123;tEnd-tStart&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªå¯èƒ½çš„è¿è¡Œç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">K=[&#123;<span class="hljs-number">52</span>&#125;, &#123;<span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">18</span>&#125;, &#123;<span class="hljs-number">33</span>&#125;, &#123;<span class="hljs-number">14</span>&#125;, &#123;<span class="hljs-number">58</span>&#125;, &#123;<span class="hljs-number">43</span>&#125;, &#123;<span class="hljs-number">10</span>&#125;]<br>d004a13baaca d004a13baaca <span class="hljs-literal">True</span><br>Success <span class="hljs-keyword">with</span> queryed <span class="hljs-number">2255</span> times<br>Time Cost:<span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.565169</span><br></code></pre></td></tr></table></figure><p>5 åˆ° 8 è½®çš„æƒ…å†µå°±å¾ˆå¤æ‚äº†ï¼Œç­‰ä»¥åé‡åˆ°é¢˜ç›®å†æ›´æ–°å§:(</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SUSCTF2024</title>
    <link href="/2024/10/23/SUSCTF2024/"/>
    <url>/2024/10/23/SUSCTF2024/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-SUSCTF-WriteUp"><a href="#huangx607087-SUSCTF-WriteUp" class="headerlink" title="huangx607087-SUSCTF WriteUp"></a>huangx607087-SUSCTF WriteUp</h1><blockquote><p>Crypto 9 é¢˜åšäº† 7 é¢˜ï¼Œä¸¤å¹´æ²¡ç¢°CTFï¼Œå¥½å¤šéƒ½ä¸ä¼šäº†ï¼Œæ‰‹æ„Ÿå…¨æŸã€‚ã€‚ã€‚</p></blockquote><h2 id="1-RSAæ•™å­¦"><a href="#1-RSAæ•™å­¦" class="headerlink" title="1.RSAæ•™å­¦"></a>1.RSAæ•™å­¦</h2><p><del>ä¸€å¼€å§‹çœ‹åˆ°è¿˜ä»¥ä¸ºæ˜¯padéƒ¨åˆ†æ˜¯ä¸‰Lï¼Œç„¶åä¸€ä¸ªEasyé¢˜ä¸€å¤©å¤š0è§£ï¼Œæ²¡æƒ³åˆ°ç«Ÿç„¶æ˜¯ä¸ªé”™é¢˜ã€‚æ›´æ–°çš„æ—¶å€™åˆšå¥½æœ¬ç§‘å‡ ä¸ªèˆå‹æ‰¾æˆ‘ç©ï¼ŒæŠ¢è¡€å¤±è´¥</del></p><p>æ‰“å¼€å®¹å™¨ï¼Œè¿æ¥17æ¬¡ï¼Œè·å–17ç»„ $n$ å’Œ $c$ï¼Œç„¶åç›´æ¥CRTå³å¯ã€‚</p><p>ç”¨sagemathå¯ä»¥ä¸€æŠŠæ¢­ï¼Œä»£ç è¿‡äºç®€å•</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> gmpy2 import iroot<br><span class="hljs-keyword">from</span> Crypto.Util.number improt *<br>N=[<span class="hljs-built_in">..</span>.] #å¾—åˆ°çš„17ä¸ªn<br>C=[<span class="hljs-built_in">..</span>.] #å¾—åˆ°çš„17ä¸ªc<br><span class="hljs-attribute">m17</span>=crt(C,N)<br>msg,<span class="hljs-attribute">judg</span>=iroot(m17,17)<br>assert judg<br><span class="hljs-built_in">print</span>(long_to_bytes(msg))<br></code></pre></td></tr></table></figure><h2 id="2-pell"><a href="#2-pell" class="headerlink" title="2.pell"></a>2.pell</h2><p>ç­¾åˆ°é¢˜ï¼Œè§£æ–¹ç¨‹ $x^2-114514y^2&#x3D;1$ï¼Œå¾ˆç®€å•çš„pellæ–¹ç¨‹</p><p>ç›´æ¥ä»ç½‘ä¸Šdownä¸€ä¸ªä»£ç ï¼ŒOKã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<br><br>d =<span class="hljs-number">114514</span><br>m = <span class="hljs-built_in">int</span>(np.sqrt(d))<br>dq = deque()<br>dq.append(m)<br>n0 = n1 = d - m * m<br>m1 = m<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    q, m2 = <span class="hljs-built_in">divmod</span>(m1 + m, n1)<br>    dq.appendleft(q)<br>    m1 = -m2+m<br>    n1 = (d-m1*m1)//n1<br>    <span class="hljs-keyword">if</span> m1 == m <span class="hljs-keyword">and</span> n1 == n0:<br>        <span class="hljs-keyword">break</span><br><br>dq.popleft()<br>x = <span class="hljs-number">1</span><br>y = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dq:<br>    x1 = y + x * i<br>    y = x<br>    x = x1<br>    y1=y<br><span class="hljs-keyword">if</span> x*x-d*y*y==-<span class="hljs-number">1</span>:<br>   b=(x**<span class="hljs-number">2</span>+d*y**<span class="hljs-number">2</span>)<br>   y1=<span class="hljs-number">2</span>*x*y<br>   x1=b<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;x1=&#x27;</span>,x1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;y1=&#x27;</span>,y1)<br></code></pre></td></tr></table></figure><h2 id="3-fermat"><a href="#3-fermat" class="headerlink" title="3.fermat"></a>3.fermat</h2><p>é¢˜ç›®ç»™å‡ºäº† $n&#x3D;pq$ å’Œ $g&#x3D;p^3+q^3$ï¼Œè®¾ $P&#x3D;p^3,Q&#x3D;q^3$ï¼Œæœ‰ $n^3&#x3D;PQ,g&#x3D;P+Q$ã€‚<br>æ„é€ äºŒæ¬¡æ–¹ç¨‹ $x^2-gx+n$ï¼Œä½¿ç”¨æ±‚æ ¹å…¬å¼å¯ä»¥å¾—åˆ° $x_1&#x3D;P,x_2&#x3D;Q$ï¼Œå†å¯¹ $P,Q$  å¼€ç«‹æ–¹ï¼Œå¾—åˆ° $p$ å’Œ $q$ã€‚<br>ç”±äº $p,q$ å‡ä¸ºæ¨¡ $4$ ä½™ $1$ çš„ç´ æ•°ï¼Œå› æ­¤å®ƒä»¬å‡å¯è¡¨ç¤ºä¸ºä¸¤ä¸ªå¹³æ–¹å’Œçš„å½¢å¼ï¼Œè®¾ $p&#x3D;a^2+b^2,q&#x3D;u^2+v^2$ã€‚<br>å¯ä»¥å¾—åˆ°<br>$$<br>n&#x3D;pq&#x3D;(a^2+b^2)(u^2+v^2)&#x3D;(ua+vb)^2+(va-ub)^2<br>$$<br>ç”¨é€’é™æ³•æ±‚å‡º $a,b,u,v$ å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyanzhengma</span>(<span class="hljs-params">s16len, s64len</span>):<br>    LTSNMS = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s16len) == <span class="hljs-number">12</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(s64len) == <span class="hljs-number">64</span><br>    <span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> LTSNMS:<br>        <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> LTSNMS:<br>            <span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> LTSNMS:<br>                <span class="hljs-keyword">for</span> i4 <span class="hljs-keyword">in</span> LTSNMS:<br>                    <span class="hljs-keyword">if</span> sha256((i1+i2+i3+i4+s16len).encode()).hexdigest() == s64len:<br>                        <span class="hljs-keyword">return</span> i1+i2+i3+i4<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getA</span>(<span class="hljs-params">p</span>):<br>    <span class="hljs-keyword">assert</span>(p % <span class="hljs-number">4</span> == <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        t = bytes_to_long(urandom(<span class="hljs-number">195</span>)) % p<br>        s = <span class="hljs-built_in">pow</span>(t, (p-<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, p)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">pow</span>(s, <span class="hljs-number">2</span>, p) == p-<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> s<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getAns</span>(<span class="hljs-params">A, B, M, p</span>):<br>    <span class="hljs-comment"># print(A,B,M,p)</span><br>    <span class="hljs-keyword">if</span>(M == <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">abs</span>(A), <span class="hljs-built_in">abs</span>(B))<br>    <span class="hljs-comment"># print(A,B,M,p)</span><br>    u, v = A % M, B % M<br>    <span class="hljs-keyword">if</span>(u &gt; M//<span class="hljs-number">2</span>):<br>        u -= M<br>    <span class="hljs-keyword">if</span>(v &gt; M//<span class="hljs-number">2</span>):<br>        v -= M<br>    <span class="hljs-keyword">assert</span>((u**<span class="hljs-number">2</span>+v**<span class="hljs-number">2</span>) % M == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> (A**<span class="hljs-number">2</span>+B**<span class="hljs-number">2</span>) % M == <span class="hljs-number">0</span>)<br>    r = (u**<span class="hljs-number">2</span>+v**<span class="hljs-number">2</span>)//M<br>    A2 = (u*A+v*B)//M<br>    B2 = (-u*B+v*A)//M<br>    <span class="hljs-keyword">return</span> getAns(A2, B2, r, p)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">p</span>):<br>    A = getA(p)<br>    B = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">assert</span>(A**<span class="hljs-number">2</span>+B**<span class="hljs-number">2</span>) % p == <span class="hljs-number">0</span><br>    M = (A**<span class="hljs-number">2</span>+B**<span class="hljs-number">2</span>)//p<br>    <span class="hljs-keyword">return</span> getAns(A, B, M, p)<br><br><br>sh = remote(<span class="hljs-string">&#x27;game.ctf.seusus.com&#x27;</span>, <span class="hljs-number">57718</span>)<br>cc = sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>s64 = cc[-<span class="hljs-number">64</span>:].decode()<br>s16 = cc[<span class="hljs-number">12</span>:<span class="hljs-number">24</span>].decode()<br><span class="hljs-built_in">print</span>(cc)<br><span class="hljs-built_in">print</span>(s64)<br><span class="hljs-built_in">print</span>(s16)<br>yanzhengma = getyanzhengma(s16, s64)<br><span class="hljs-built_in">print</span>(yanzhengma)<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(yanzhengma.encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>n = sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>g = sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(g)<br>n, g = <span class="hljs-built_in">int</span>(n), <span class="hljs-built_in">int</span>(g)<br>PmulQ = n**<span class="hljs-number">3</span><br>PaddQ = g<br>A, B, C = <span class="hljs-number">1</span>, -PaddQ, PmulQ<br>sqrtdet, judg = iroot(B**<span class="hljs-number">2</span>-<span class="hljs-number">4</span>*A*C, <span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;J:&#x27;</span>, judg)<br>P = (-B+sqrtdet) &gt;&gt; <span class="hljs-number">1</span><br>Q = (-B-sqrtdet) &gt;&gt; <span class="hljs-number">1</span><br>p, q = iroot(P, <span class="hljs-number">3</span>)[<span class="hljs-number">0</span>], iroot(Q, <span class="hljs-number">3</span>)[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(p, q, n % p, n % q)<br>u, v = (solve(p))<br>a, b = (solve(q))<br><br><br>Ans = <span class="hljs-built_in">abs</span>(u*a+v*b)<br>Bns = <span class="hljs-built_in">abs</span>(v*a-u*b)<br><span class="hljs-built_in">print</span>(Ans)<br><span class="hljs-built_in">print</span>(Bns)<br><span class="hljs-built_in">print</span>(Ans**<span class="hljs-number">2</span>+Bns**<span class="hljs-number">2</span> == n)<br>sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>sh.sendline(<span class="hljs-built_in">str</span>(Ans).encode())<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>sh.sendline(<span class="hljs-built_in">str</span>(Bns).encode())<br>sh.interactive()<br><br></code></pre></td></tr></table></figure><h2 id="4-Fibonacii"><a href="#4-Fibonacii" class="headerlink" title="4.Fibonacii"></a>4.Fibonacii</h2><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªå·²çŸ¥å€¼ $A&#x3D;\mathtt{target}$ï¼Œè¦æ±‚ç»™å‡º $p$ å’Œ $n$ï¼Œä½¿å¾— $F_{n}\equiv A \pmod p$ã€‚</p><p>æ³¨æ„åˆ°æ–æ³¢é‚£å¥‘æ•°åˆ—çš„çŸ©é˜µå¿«é€Ÿå¹‚å½¢å¼ï¼ˆä»¤ $F_0&#x3D;0,F_1&#x3D;F_2&#x3D;1$ï¼‰ï¼š</p><p><img src="/2024/10/23/SUSCTF2024/4-1.png" alt="4-1"></p><p>å…¶ä¸­çŸ©é˜µ $\mathbf M$ æœ‰ç‰¹å¾å€¼ $t_1&#x3D;\dfrac{1+\sqrt 5}{2}$ å’Œ $t_2&#x3D;\dfrac{1-\sqrt 5}{2}$ï¼Œå…¶å¯¹åº”çš„ç‰¹å¾å‘é‡åˆ†åˆ«ä¸º $\vec v_1&#x3D;(1,\dfrac{1+\sqrt5}{2})$ å’Œ  $\vec v_2&#x3D;(1,\dfrac{1-\sqrt5}{2})$ã€‚<br>å†æ³¨æ„åˆ°æ–æ³¢é‚£å¥‘æ•°åˆ—çš„é€šé¡¹å…¬å¼ $F_n &#x3D; \dfrac{1}{\sqrt{5}} \left[ \left( \dfrac{1 + \sqrt{5}}{2} \right)^n - \left( \dfrac{1 - \sqrt{5}}{2} \right)^n \right]$ã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªé¢˜æœ‰ $\sqrt5$ã€$n$ æ¬¡æ–¹ä¸¤ä¸ªè¦ç´ ã€‚é‚£å°±è¦ä»ç¦»æ•£å¯¹æ•°ã€äºŒæ¬¡å‰©ä½™çš„åœ°æ–¹å»æƒ³ã€‚</p><p>æ ¹æ®ä¿¡å®‰æ•°åŸºçš„çŸ¥è¯†å¯ä»¥çŸ¥é“ï¼š</p><blockquote><ol><li>è‹¥ $5$ æ˜¯ $p$ çš„äºŒæ¬¡å‰©ä½™ï¼Œåˆ™ $p\equiv Â±1\pmod5$</li><li>è‹¥ $p-1$ æåº¦å…‰æ»‘ï¼Œåˆ™ç¦»æ•£å¯¹æ•°æåº¦æ˜“è§£ã€‚</li></ol></blockquote><p>å› æ­¤ï¼Œæ„é€  $p&#x3D;754Ã—10^{74}+1$ ï¼Œæ˜¾ç„¶ $p-1$ æåº¦å…‰æ»‘ï¼Œä¸” $p\equiv 1\pmod 5$ã€‚ç„¶åç”¨ä¸‹é¢çš„ä»£ç æ±‚å‡º $x \equiv \sqrt 5 \pmod p$  çš„å€¼ã€‚è¿™ä¸ªä»£ç ä¸»è¦æ˜¯ç”¨æ¥æ±‚æ¨¡ 8 ä½™ 1 çš„ç´ æ•°åŸŸå¼€å¹³æ–¹çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># luogu P5491</span><br><span class="hljs-comment"># P.S. è‡ªå·±é«˜ä¸­æè¿‡OI(çœ2)ï¼Œluoguå…¶å®å¸¦ç€åˆ·è¿‡ä¸€äº›ç®—æ³•é¢˜ï¼Œä¸»è¦è¿˜æ˜¯åæ¨¡æ¿å’Œæ•°æ®ç»“æ„ä¸€ç‚¹ï¼Œæ¥è§¦CTFåä¸ºäº†ç†Ÿæ‚‰å’ŒéªŒè¯ç®—æ³•ä¹Ÿåšè¿‡éš¾ä¸€ç‚¹çš„æ•°è®ºã€‚æœ¬ç§‘æ²¡æ‰“è¿‡ACMï¼ŒACMè‚¯å®šä¸è¡Œçš„ã€‚</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Complex</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,x=<span class="hljs-number">0</span>,y=<span class="hljs-number">0</span></span>):<br>        <span class="hljs-variable language_">self</span>.real=x<br>        <span class="hljs-variable language_">self</span>.imag=y<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">isqr</span>(<span class="hljs-params">x,p</span>): <span class="hljs-comment">#å‹’è®©å¾·ç¬¦å·</span><br>    <span class="hljs-keyword">if</span> p==<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    sgn=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> x&amp;<span class="hljs-number">1</span>==<span class="hljs-number">0</span>:<br>        x&gt;&gt;=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> p&amp;<span class="hljs-number">7</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">or</span> p&amp;<span class="hljs-number">7</span>==<span class="hljs-number">5</span>:<br>            sgn=-sgn<br>    <span class="hljs-keyword">if</span> x&lt;p:<br>        x,p=p,x<br>        <span class="hljs-keyword">if</span> x&amp;<span class="hljs-number">3</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">and</span> p&amp;<span class="hljs-number">3</span>==<span class="hljs-number">3</span> :<br>            sgn=-sgn<br>    <span class="hljs-keyword">return</span> sgn*isqr(x%p,p)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Rand</span>(<span class="hljs-params">p</span>): <span class="hljs-comment">#éšæœºæ•°</span><br>    <span class="hljs-keyword">return</span> bytes_to_long(urandom(<span class="hljs-number">80</span>))%p<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Cmul</span>(<span class="hljs-params">a,b,nr,p</span>): <span class="hljs-comment">#å¤æ•°ä¹˜</span><br>    Real=a.real*b.real+a.imag*b.imag*nr<br>    Imag=a.real*b.imag+b.real*a.imag<br>    Res=Complex(Real%p,Imag%p)<br>    <span class="hljs-keyword">return</span> Res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Cpow</span>(<span class="hljs-params">a,e,nr,p</span>):<br>    Res=Complex(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> e:<br>        <span class="hljs-keyword">if</span> e&amp;<span class="hljs-number">1</span>:<br>            Res=Cmul(a,Res,nr,p)<br>        a=Cmul(a,a,nr,p)<br>        e&gt;&gt;=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> Res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_M8R1</span>(<span class="hljs-params">n,p</span>): <span class="hljs-comment">#æ¨¡8ä½™1å¼€å¹³æ–¹</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        a=Rand(p)<br>        nr=(a*a-n)%p<br>        <span class="hljs-keyword">if</span> isqr(nr,p)==-<span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">break</span><br>    Res=Complex(a,<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> Cpow(Res,(p+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>,nr,p)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">n,p</span>): <br>    A=<span class="hljs-literal">None</span><br>    <span class="hljs-keyword">if</span> n==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">if</span> isqr(n,p)==-<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hola!&quot;</span><br>    <span class="hljs-keyword">if</span> p&amp;<span class="hljs-number">3</span>==<span class="hljs-number">3</span>: <span class="hljs-comment">#æœ‰å…¬å¼çš„å¥—å…¬å¼</span><br>        A=<span class="hljs-built_in">pow</span>(n,(p+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,p)<br>    <span class="hljs-keyword">elif</span> p&amp;<span class="hljs-number">7</span>==<span class="hljs-number">5</span>:<br>        A=<span class="hljs-built_in">pow</span>(n,(p+<span class="hljs-number">3</span>)//<span class="hljs-number">8</span>,p)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(A,<span class="hljs-number">2</span>,p)!=n:<br>            A=<span class="hljs-number">2</span>*n*<span class="hljs-built_in">pow</span>(<span class="hljs-number">4</span>*n,(p-<span class="hljs-number">5</span>)//<span class="hljs-number">8</span>,p)%p<br>    <span class="hljs-keyword">elif</span> p&amp;<span class="hljs-number">7</span>==<span class="hljs-number">1</span>: <span class="hljs-comment">#æ²¡å…¬å¼çš„å°±é‚£ä¹ˆåš</span><br>        A=solve_M8R1(n,p).real<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(<span class="hljs-built_in">min</span>(A,p-A))+<span class="hljs-string">&quot; &quot;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">max</span>(A,p-A))<br>T=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>()) <br><span class="hljs-keyword">while</span> T: <span class="hljs-comment">#OIç‰¹æœ‰çš„code style</span><br>    T=T-<span class="hljs-number">1</span><br>    n,p=<span class="hljs-built_in">input</span>().split()<br>    <span class="hljs-built_in">print</span>(solve(<span class="hljs-built_in">int</span>(n),<span class="hljs-built_in">int</span>(p)))<br></code></pre></td></tr></table></figure><p>ç„¶åä¸€äº›å¸¦ $\sqrt 5$ çš„å€¼å°±è§£å‡ºæ¥äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p=<span class="hljs-number">75400000000000000000000000000000000000000000000000000000000000000000000000001</span> <br><span class="hljs-comment">#very weak prime,p-1=2^75 * 5^74 * 13 * 29</span><br>sq5=<span class="hljs-number">16392361170112101659662823978726961447340641722259199851531537362443024593275</span><br>half=<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,p-<span class="hljs-number">2</span>,p)<br>t1,t2=half*(<span class="hljs-number">1</span>+sq5)%p,half*(<span class="hljs-number">1</span>-sq5)%p<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">half=37700000000000000000000000000000000000000000000000000000000000000000000000001</span><br><span class="hljs-string">t1=8196180585056050829831411989363480723670320861129599925765768681221512296638</span><br><span class="hljs-string">t2=67203819414943949170168588010636519276329679138870400074234231318778487703364</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure><p>æ ¹æ®ç‰¹å¾å€¼çš„æ¦‚å¿µï¼Œå¯ä»¥å¾—åˆ°ï¼š<br>$$<br>\mathbf M^n v_0&#x3D;t_1^n k_1\vec v_1+t_2^nk_2\vec v_2<br>$$<br>å…¶ä¸­ $\vec v_0&#x3D;(1,1)$ï¼Œå¯ä»¥å†™æˆ $\vec v_0&#x3D;k_1\vec v_1+k_2\vec v_2$ çš„å½¢å¼ï¼Œ$k_1,k_2$ ç›´æ¥åˆ—äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹è§£å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">k1=(<span class="hljs-number">1</span>-t2)*inverse(Integer(t1-t2),p)%p<br>k2=(<span class="hljs-number">1</span>-k1)%p<br><span class="hljs-built_in">print</span>(k1)<br><span class="hljs-built_in">print</span>(k2)<br>v1=vector([<span class="hljs-number">1</span>,t1])<br>v2=vector([<span class="hljs-number">1</span>,t2])<br><span class="hljs-built_in">print</span>(k1*t1**<span class="hljs-number">1</span>+k2*t2**<span class="hljs-number">1</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">k1=1639236117011210165966282397872696144734064172225919985153153736244302459328 k2=73760763882988789834033717602127303855265935827774080014846846263755697540674</span><br><span class="hljs-string">check=1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„åˆ°ä¸¤ä¸ªç‰¹å¾å€¼ä¹‹é—´çš„å…³ç³»ï¼š $t_1t_2&#x3D;-1$ï¼Œå› æ­¤è®¾ $t_2&#x3D;\dfrac{-1}{t_1}$ã€‚ç”±äº $A$ æ˜¯ç¬¬ $x$ é¡¹ï¼Œå› æ­¤æœ‰ï¼š<br>$$<br>k_1t_1^x+k_2t_2^x&#x3D;A<br>$$<br>ä»¤ $t_1^x&#x3D;t$ï¼Œæ¶ˆå…ƒå»åˆ†æ¯å¯ä»¥å¾—åˆ°<br>$$<br>k_1t^2-At-k_2&#x3D;0<br>$$<br>æ”¾åˆ°sagemathä¸­åˆ†è§£è¿™ä¸ªå¼å­ï¼Œå¯ä»¥å¾—åˆ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#t1*t2=1</span><br><span class="hljs-comment"># let t1=g t2=-1/g</span><br><span class="hljs-comment"># k1*g^x-k2/g^x=A</span><br><span class="hljs-comment"># let g^x=t</span><br><span class="hljs-comment"># k1*t-k2/t=A</span><br><span class="hljs-comment"># k1*t^2-A*t-k2=0</span><br>var(<span class="hljs-string">&quot;t&quot;</span>)<br>TRR.&lt;t&gt;=PolynomialRing(GF(p))<br>factor(k1*t**<span class="hljs-number">2</span>-A*t-k2)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">(1639236117011210165966282397872696144734064172225919985153153736244302459328) * </span><br><span class="hljs-string">(t + 1733149324186367358509713307996813388922147363320953556627453856871464344817) * </span><br><span class="hljs-string">(t + 63058247527559997808754465715771715540382722221120268489624945332318694664669)</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">å¯ä»¥æ¨å‡ºï¼ˆæ³¨æ„è´Ÿå·ï¼‰ï¼š</span><br><span class="hljs-string">X1=-1733149324186367358509713307996813388922147363320953556627453856871464344817</span><br><span class="hljs-string">X2=-63058247527559997808754465715771715540382722221120268489624945332318694664669</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure><p>ç”±äº $t&#x3D;t_1^x$ï¼Œç›´æ¥ä¸Šç¦»æ•£å¯¹æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">U1=-<span class="hljs-number">1733149324186367358509713307996813388922147363320953556627453856871464344817</span><br>U2=-<span class="hljs-number">63058247527559997808754465715771715540382722221120268489624945332318694664669</span><br>discrete_log(U1,Mod(t1,p))<br><span class="hljs-comment">#59164940663412913403923154565404322432501032178958345904039356200875940871519</span><br></code></pre></td></tr></table></figure><p>ç„¶åéªŒè¯ä¸€ä¸‹ï¼Œå‘ç°æ­£ç¡®ç»“æœæ¯”å®é™…è§£å‡ºæ¥çš„å€¼å¤š 1ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(M**<span class="hljs-number">59164940663412913403923154565404322432501032178958345904039356200875940871519</span>)<br><span class="hljs-built_in">print</span>(M**<span class="hljs-number">59164940663412913403923154565404322432501032178958345904039356200875940871520</span>)<br></code></pre></td></tr></table></figure><p>å› æ­¤å¾—åˆ°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">index=<span class="hljs-number">59164940663412913403923154565404322432501032178958345904039356200875940871520</span><br>prime=<span class="hljs-number">75400000000000000000000000000000000000000000000000000000000000000000000000001</span><br></code></pre></td></tr></table></figure><p>å…¶å®æ„Ÿè§‰æ„é€  $p\equiv 11 {\text{ or }} 19\pmod{20}$ çš„ç´ æ•°å¯èƒ½æ›´å¥½ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥æ»¡è¶³ $p \equiv 3 \pmod 4$ï¼Œå¼€å¹³æ–¹æ ¹æœ‰å…¬å¼ã€‚</p><h2 id="5-AES-Plus"><a href="#5-AES-Plus" class="headerlink" title="5.AES-Plus"></a>5.AES-Plus</h2><p>Meet in the middle æ”»å‡»ï¼Œæšä¸¾ä¸¤ä¸ªå¯†é’¥å…± $16^2$ ç§ç»„åˆï¼Œå¯¹å·²çŸ¥æ˜æ–‡åŠ å¯† 16 æ¬¡ï¼Œå·²çŸ¥å¯†æ–‡è§£å¯† 16 æ¬¡ã€‚å¾—åˆ°ä½¿ç”¨çš„ä¸¤ä¸ªå¯†é’¥åˆ†åˆ«æ˜¯ 4 å’Œ 11ï¼Œç„¶å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>flagC=long_to_bytes(<span class="hljs-number">0xba099276411c24b734948053cea63b4f</span>)<br>knownP=long_to_bytes(<span class="hljs-number">0xd66fe087038cf381d3bcfe6bcf8c6a1b</span>)<br>knownC=long_to_bytes(<span class="hljs-number">0x6a0b644af7b11a267f8b97399e8bee39</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_encrypt</span>(<span class="hljs-params">key: <span class="hljs-built_in">bytes</span>, data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    <span class="hljs-keyword">return</span> cipher.encrypt(data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_decrypt</span>(<span class="hljs-params">key: <span class="hljs-built_in">bytes</span>, data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    <span class="hljs-keyword">return</span> cipher.decrypt(data)<br><br>DIC=&#123;&#125;<br>TABLE=<span class="hljs-string">&quot;0123456789abcdef&quot;</span><br>KEYPRF=<span class="hljs-string">&quot;SUSCTF-AESPLUS-&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>):<span class="hljs-comment"># æˆ‘å¼€äº†4ä¸ªï¼Œåˆ†åˆ«æ˜¯0~3ï¼Œ4~7ï¼Œ8~11ï¼Œ12~15ï¼Œå››ä¸ªä¸€èµ·è·‘çš„ã€‚</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        <span class="hljs-built_in">print</span>(i,j)<br>        DIC=&#123;&#125;<br>        key1=(KEYPRF+TABLE[i]).encode()<br>        key2=(KEYPRF+TABLE[j]).encode()<br>        <br>        <br>        <span class="hljs-keyword">for</span> encid <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">16</span>)):<br>            m=knownP<br>            <span class="hljs-keyword">for</span> bitno <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>                bit=(<span class="hljs-number">1</span>&lt;&lt;bitno)&amp;encid<br>                <span class="hljs-keyword">if</span>(bit):<br>                    m=aes_encrypt(key1,m)<br>                <span class="hljs-keyword">else</span>:<br>                    m=aes_encrypt(key2,m)<br>            DIC[m]=encid<br>        <span class="hljs-keyword">for</span> decid <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">16</span>)):<br>            c=knownC<br>            <span class="hljs-keyword">for</span> bitno <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>                bit=(<span class="hljs-number">1</span>&lt;&lt;bitno)&amp;decid<br>                <span class="hljs-keyword">if</span>(bit):<br>                    c=aes_decrypt(key1,c)<br>                <span class="hljs-keyword">else</span>:<br>                    c=aes_decrypt(key2,c)<br>            <span class="hljs-keyword">if</span>(DIC.get(c,-<span class="hljs-number">1</span>)!=-<span class="hljs-number">1</span>):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;decid=&#x27;</span>,decid)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;encid=&#x27;</span>,DIC.get(c,-<span class="hljs-number">1</span>))<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;i=&#x27;</span>,i)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;j=&#x27;</span>,j)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>(DIC)))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    <span class="hljs-built_in">input</span>()<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">ç¬¬äºŒä¸ªç¨‹åºï¼ˆ4-7ï¼‰çš„è·‘å‡ºæ¥äº†ç»“æœï¼š</span><br><span class="hljs-string">encid=7896</span><br><span class="hljs-string">decid=51186</span><br><span class="hljs-string">i=4</span><br><span class="hljs-string">j=11</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure><p>ç„¶åè§£å¯†å°±æœ‰flagäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_encrypt</span>(<span class="hljs-params">key: <span class="hljs-built_in">bytes</span>, data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    <span class="hljs-keyword">return</span> cipher.encrypt(data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_decrypt</span>(<span class="hljs-params">key: <span class="hljs-built_in">bytes</span>, data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    <span class="hljs-keyword">return</span> cipher.decrypt(data)<br><br>encid=<span class="hljs-number">7896</span><span class="hljs-comment">#0b0000101101111000#7896</span><br>decid=<span class="hljs-number">51186</span><br>ID=(decid&lt;&lt;<span class="hljs-number">16</span>)|encid<br>key1=<span class="hljs-string">b&quot;SUSCTF-AESPLUS-4&quot;</span><br>key2=<span class="hljs-string">b&quot;SUSCTF-AESPLUS-b&quot;</span><br><br>flagC=long_to_bytes(<span class="hljs-number">0xba099276411c24b734948053cea63b4f</span>)<br><br>knownC=long_to_bytes(<span class="hljs-number">0x6a0b644af7b11a267f8b97399e8bee39</span>)<br>c=flagC<br><span class="hljs-comment">#c=knownC</span><br><span class="hljs-keyword">for</span> bitno <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    bit=(<span class="hljs-number">1</span>&lt;&lt;bitno)&amp;ID<br>    <span class="hljs-keyword">if</span>(bit):<br>        c=aes_decrypt(key1,c)<br>    <span class="hljs-keyword">else</span>:<br>        c=aes_decrypt(key2,c)<br><span class="hljs-built_in">print</span>(c.<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#6c524b66b5434c85b73da8e2e768a9ce</span><br></code></pre></td></tr></table></figure><h2 id="6-nfsr1"><a href="#6-nfsr1" class="headerlink" title="6.nfsr1"></a>6.nfsr1</h2><p>ç»™å‡º30ç»„æŒ‘æˆ˜ï¼Œé—®ä½ ç»™å‡ºçš„å­—ç¬¦ä¸²æ˜¯éšæœºç”Ÿæˆçš„ï¼Œè¿˜æ˜¯ç»è¿‡NFSRå¤„ç†è¿‡çš„ã€‚</p><p>æ³¨æ„åˆ°NFSRä¼šå°†ä¸€ä¸ª16å­—èŠ‚çš„å†…å®¹å˜æˆ 32 å­—èŠ‚ï¼Œå…¶ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, msg: <span class="hljs-built_in">bytes</span></span>):<br>    enc = <span class="hljs-built_in">list</span>()<br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> msg:<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.lfsr0(<span class="hljs-number">1</span>):<br>            enc += [m &amp; <span class="hljs-variable language_">self</span>.lfsr1(<span class="hljs-number">8</span>), m | <span class="hljs-variable language_">self</span>.lfsr1(<span class="hljs-number">8</span>)]<br>        <span class="hljs-keyword">else</span>:<br>            enc += [m | <span class="hljs-variable language_">self</span>.lfsr1(<span class="hljs-number">8</span>), m &amp; <span class="hljs-variable language_">self</span>.lfsr1(<span class="hljs-number">8</span>)]<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(enc)<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œbitor æ“ä½œå¤§æ¦‚ç‡ä¼šå¯¼è‡´æ•°å€¼ä¸­ 1 æ¯”ç‰¹å¢åŠ ï¼Œbitand æ“ä½œå¤§æ¦‚ç‡å›å¯¼è‡´æ•°å€¼ä¸­ 1 æ¯”ç‰¹å‡å°‘ï¼Œå†™ä¸ªå‡½æ•°æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params">hexlv</span>):<br>    Q = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        x1 = <span class="hljs-built_in">int</span>(hexlv[<span class="hljs-number">4</span>*i:<span class="hljs-number">4</span>*i+<span class="hljs-number">2</span>], <span class="hljs-number">16</span>)<br>        x2 = <span class="hljs-built_in">int</span>(hexlv[<span class="hljs-number">4</span>*i+<span class="hljs-number">2</span>:<span class="hljs-number">4</span>*i+<span class="hljs-number">4</span>], <span class="hljs-number">16</span>)<br>        Q += <span class="hljs-built_in">abs</span>(bitcount(x1)-bitcount(x2))<br>    <span class="hljs-keyword">return</span> Q/<span class="hljs-number">16</span><br></code></pre></td></tr></table></figure><p>å‘ç°éšæœºç”Ÿæˆçš„å­—ç¬¦ä¸²ä¸­ï¼Œ å‡½æ•°å€¼å¤šä¸ºä¸€ç‚¹å‡ ï¼Œæœ€é«˜ä¸è¶…è¿‡2.25ã€‚è€Œå¤„ç†è¿‡çš„å­—ç¬¦ä¸²å‡½æ•°å€¼å‡è¶…è¿‡äº†3ã€‚</p><p>é‚£å°±ç›´æ¥ä¸Šexpï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyanzhengma</span>(<span class="hljs-params">s16len, s64len</span>):<br>    LTSNMS = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s16len) == <span class="hljs-number">12</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(s64len) == <span class="hljs-number">64</span><br>    <span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> LTSNMS:<br>        <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> LTSNMS:<br>            <span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> LTSNMS:<br>                <span class="hljs-keyword">for</span> i4 <span class="hljs-keyword">in</span> LTSNMS:<br>                    <span class="hljs-keyword">if</span> sha256((i1+i2+i3+i4+s16len).encode()).hexdigest() == s64len:<br>                        <span class="hljs-keyword">return</span> i1+i2+i3+i4<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bitcount</span>(<span class="hljs-params">x</span>):<br>    c = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span>(x):<br>        c += (x &amp; <span class="hljs-number">1</span>)<br>        x &gt;&gt;= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> c<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params">hexlv</span>):<br>    Q = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        x1 = <span class="hljs-built_in">int</span>(hexlv[<span class="hljs-number">4</span>*i:<span class="hljs-number">4</span>*i+<span class="hljs-number">2</span>], <span class="hljs-number">16</span>)<br>        x2 = <span class="hljs-built_in">int</span>(hexlv[<span class="hljs-number">4</span>*i+<span class="hljs-number">2</span>:<span class="hljs-number">4</span>*i+<span class="hljs-number">4</span>], <span class="hljs-number">16</span>)<br>        Q += <span class="hljs-built_in">abs</span>(bitcount(x1)-bitcount(x2))<br>    <span class="hljs-keyword">return</span> Q/<span class="hljs-number">16</span><br><br><br>sh = remote(<span class="hljs-string">&#x27;game.ctf.seusus.com&#x27;</span>, <span class="hljs-number">57317</span>)<br><br>cc = sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>s64 = cc[-<span class="hljs-number">64</span>:].decode()<br>s16 = cc[<span class="hljs-number">12</span>:<span class="hljs-number">24</span>].decode()<br><span class="hljs-built_in">print</span>(cc)<br><span class="hljs-built_in">print</span>(s64)<br><span class="hljs-built_in">print</span>(s16)<br>yanzhengma = getyanzhengma(s16, s64)<br><span class="hljs-built_in">print</span>(yanzhengma)<br>sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>sh.sendline(yanzhengma.encode())<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (<span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Round &#x27;</span>, i, <span class="hljs-string">&#x27;:&#x27;</span>)<br>    sh.recvuntil(<span class="hljs-string">b&#x27;:&#x27;</span>)<br>    datarecv = sh.recvline(keepends=<span class="hljs-literal">False</span>).strip().decode()<br>    <span class="hljs-built_in">print</span>(datarecv)<br>    judg = calc(datarecv)<br>    <span class="hljs-built_in">print</span>(judg)<br>    sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>    <span class="hljs-keyword">if</span>(judg &gt; <span class="hljs-number">2.5</span>):<br>        sh.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        sh.sendline(<span class="hljs-string">b&#x27;0&#x27;</span>)<br><br>sh.interactive()<br><br></code></pre></td></tr></table></figure><h2 id="7-signin-in-sys"><a href="#7-signin-in-sys" class="headerlink" title="7.signin_in_sys"></a>7.signin_in_sys</h2><h3 id="7x01-solution"><a href="#7x01-solution" class="headerlink" title="7x01 solution"></a>7x01 solution</h3><p>ä¸€ä¸ªå¡äº†æˆ‘ä¸€å¤å¤©çš„é¢˜ã€‚ä¸€å¼€å§‹å¼„äº†ä¸ªä¹±æåšæ³•ï¼Œ60%æ¦‚ç‡èƒ½è¿‡ 256 çš„ä¸Šé™ã€‚ç„¶åè‡ªå·±æ¨å¼å­æ¨äº†å¥½ä¹…ï¼Œç»ˆäºæŠŠ 128 çš„ä¸Šé™è¿‡æ‰äº†ã€‚ã€‚ã€‚ã€‚</p><p>è¿™ä¸ªé¢˜é¦–å…ˆæ³¨æ„åˆ°ç®—æ³•å…¶å®æ˜¯ DSA ç­¾åç®—æ³•ï¼Œæ²¡æœ‰å‡ºç°å…±ç”¨éšæœºæ•°çš„æƒ…å†µï¼Œä½†ä½¿ç”¨çš„Hå‡½æ•°æœ‰ç‚¹å¥‡æ€ªï¼Œå¹¶ä¸”<del>æ³¨æ„åŠ›æ¶£æ•£çš„äººä¹Ÿ</del>å¯ä»¥æ³¨æ„åˆ° <code>H(s)=H(&#39;\x00&#39;+s)</code> ã€‚</p><p>é¢˜ç›®è¦æ±‚æ˜¯æ±‚å‡ºsus_hexçš„ä¸€ç»„åˆæ³•ç­¾åï¼Œä½†ä¸€å¼€å§‹ä¸çŸ¥é“sus_hexçš„å€¼ï¼Œéœ€è¦é€šè¿‡hintï¼Œè€Œhintå°±éœ€è¦æ±‚å‡ºéªŒè¯å…¬é’¥ã€‚æ ¹æ®ä¸Šé¢æˆ‘æ³¨æ„åˆ°çš„å†…å®¹ï¼Œæ„é€  <code>00</code> å’Œ <code>0000</code>ï¼Œè¿™ä¸¤ä¸ªçš„ H å€¼ä¸€æ ·ã€‚</p><p>è®¾ $A$ æ˜¯ç›¸åŒçš„ $H$ å€¼ï¼Œæ ¹æ® $r_i\equiv g^{k_i}\pmod p$ å’Œ $s_i\equiv\dfrac{A+xr_i}{k_i} \pmod q,i&#x3D;1,2$ï¼Œå¯ä»¥è§£å‡º<br>$$<br>g^x&#x3D; \left(\dfrac{r_1^{s_1}}{r_2^{s_2}}\right)^{(r_1-r_2)^{-1} \bmod q} \bmod p<br>$$<br>(æœ‰ç‚¹å¤æ‚ï¼Œä½†åæ­£æŒ‡æ•°ä¸Šçš„ä¸œè¥¿å…¨æ¨¡ $q$ï¼Œä¸æ˜¯æŒ‡æ•°ä¸Šçš„ä¸œè¥¿å…¨æ¨¡ $p$ å°±è¡Œ)ã€‚</p><p>æ‹¿åˆ° pk åï¼Œå°±å¯ä»¥æ‹¿åˆ°sus_hexã€‚</p><p>æ”¾ä¸€ä¸‹æ±‚è¿™ä¸€éƒ¨åˆ†çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python">dat=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>p,q,g,t=<span class="hljs-built_in">eval</span>(dat)<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(q)<br><span class="hljs-built_in">print</span>(g)<br><span class="hljs-built_in">print</span>(t)<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;s&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;0000&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;) =&#x27;</span>)<br>r1,s1=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-built_in">print</span>(r1,s1)<br><br><br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;s&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;00000000&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;) =&#x27;</span>)<br>r2,s2=<span class="hljs-built_in">eval</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-built_in">print</span>(r2,s2)<br><br>cpk=<span class="hljs-built_in">pow</span>(r1,s1,p)*inverse(<span class="hljs-built_in">pow</span>(r2,s2,p),p)%p<br>pk=<span class="hljs-built_in">pow</span>(cpk,inverse(r1-r2,q),p)<br><span class="hljs-built_in">print</span>(pk)<br><br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.sendline(<span class="hljs-string">b&#x27;h&#x27;</span>)<br>sh.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>sh.sendline(<span class="hljs-built_in">str</span>(pk).encode())<br>sh.recvuntil(<span class="hljs-string">b&#x27;=&#x27;</span>)<br>Msghex=sh.recvline(keepends=<span class="hljs-literal">False</span>).strip()[<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(Msghex)==<span class="hljs-number">256</span><br><span class="hljs-built_in">print</span>(Msghex)<br><br>sh.interactive() <span class="hljs-comment">#åé¢ç›´æ¥æ‰‹æ“äº†</span><br><br></code></pre></td></tr></table></figure><p>å†å…³æ³¨ä¸€ä¸‹è¿™ä¸ª $H$ å‡½æ•°ï¼Œå¯ä»¥å‘ç°ç”±äº $m_i$ å¾ˆå°ï¼Œå› æ­¤ $h \oplus m_i$ å¯ä»¥å†™æˆ $h+\delta_i$ï¼Œå…¶ä¸­ $\delta_i$ ä¹Ÿå¾ˆå°ã€‚æŠŠå¼‚æˆ–æ¢åŠ ï¼Œå°±å¯ä»¥å‘ç°ï¼Œæœ€å $H$ å¯ä»¥å†™æˆä¸€ä¸ªå…³äº $t$ çš„å¤šé¡¹å¼ï¼Œå…¶ä¸­ $\delta_i $ å¾ˆå° ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># sage</span><br><span class="hljs-comment"># notice that ^^ in sage means xor, ^ in sage means power, ^ in python means xor.</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">H</span>(<span class="hljs-params"> m: <span class="hljs-built_in">bytes</span></span>):<br>    h = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> mi <span class="hljs-keyword">in</span> m :<br>        h = (h ^^ mi) * t % q<br></code></pre></td></tr></table></figure><p>ä¸‹é¢å°±ä»¥ $n&#x3D;4$ ä¸¾ä¾‹äº†ï¼Œå…¶å® $n&#x3D;128$ åŒç†ã€‚<br>$$<br>H(m)\equiv \delta_1t^4+\delta_2t^3+\delta_3t^2+\delta_4t\pmod q \tag {8.1}<br>$$</p><p>è‹¥ç›®æ ‡å­—ç¬¦ä¸²çš„ hash å€¼ä¸º $D$ï¼Œåˆ™ $(8.1)$ å¯ä»¥å†™æˆ<br>$$<br>D\equiv \delta_1t^4+\delta_2t^3+\delta_3t^2+\delta_4t\pmod q \tag {8.2}<br>$$<br>å»åŒä½™ï¼Œå¾—<br>$$<br>\delta_1t^4+\delta_2t^3+\delta_3t^2+\delta_4t-D-k q &#x3D;0\tag {8.3}<br>$$<br>ç„¶åå°±å¯ä»¥æ„é€ LLLï¼š</p><p><img src="/2024/10/23/SUSCTF2024/7-1.png" alt="1"></p><p>ä¸­é—´çš„çŸ©é˜µæ˜¯ $(n+2)$ è¡Œ $(n+3)$ åˆ—çš„ï¼Œå› æ­¤å¯¹ä¸­é—´çš„çŸ©é˜µLLLä¹‹åï¼Œæ‰¾åˆ°ä¸€ä¸ªå€’æ•°ç¬¬ä¸‰ä¸ªæ•°æ˜¯ $1$ï¼Œæœ€åä¸€ä¸ªæ•°æ˜¯ $0$ çš„è¡Œå‘é‡ï¼Œå°±å¯ä»¥è§£å‡ºæ¥äº†ã€‚</p><p>è¿™ä¸ªå¸¸æ•° $K$ å…¶å®æ˜¯æ ¹æ®é—µå¯å¤«æ–¯åŸºå®šç†ï¼Œè¦ä¿è¯æ ¼ä¸­çš„å‘é‡è¶³å¤Ÿå¤§ï¼ˆåŸç†å¾ˆç„å­¦ï¼Œæœ‰æ—¶å€™å¿…é¡»åŠ ï¼Œä¸åŠ å¯èƒ½æ±‚ä¸å‡ºæ­£ç¡®ç»“æœï¼‰ã€‚è¿™é‡Œå–çš„æ˜¯ $K&#x3D;2^{900}$ï¼Œæ³¨æ„åˆ°æœ€åä¸€åˆ—æ˜¯ $0$ ï¼Œæ‰€ä»¥ä¹˜ä¸Šä¸€ä¸ª $K$ ä¸å½±å“ç»“æœã€‚</p><p>ä¸‹é¢æ˜¯LLLéƒ¨åˆ†ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#SAGE</span><br><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># coding: utf-8</span><br><br><span class="hljs-comment"># In[1]:</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>q=<span class="hljs-number">244309567133428459339052233620763590631</span><br>t=<span class="hljs-number">139116278922633292045835908998748980746</span><br>n=<span class="hljs-number">128</span><br>mmm=long_to_bytes(<span class="hljs-number">0x6532303734613033336462373133663863653039303532636265316338306631393031356163336534386136646664313433303636623330373637663931326633343331323133643539383064646136643131663361613831663639663139656533623033383033303332623734633063343632663635323834373631346132</span>)<br>C=[]   <span class="hljs-comment">#è¿™ä¸ªCæ˜¯ä»¥å‰ä¹±æç”¨çš„ï¼Œè¿™é‡Œè¢«åºŸå¼ƒäº†</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">H</span>(<span class="hljs-params"> m: <span class="hljs-built_in">bytes</span></span>):<br>    h = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> mi <span class="hljs-keyword">in</span> m :<br><span class="hljs-comment">#       C.append((h&amp;(2**300-256))|0x55) </span><br>        h = (h ^^ mi) * t % q<br>    <span class="hljs-keyword">return</span> h<br>D=(H(mmm))<br><span class="hljs-built_in">print</span>(D)<br><span class="hljs-comment">#86818520128168117392109372309780328095</span><br><br><span class="hljs-comment"># In[2]:</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getVec</span>(<span class="hljs-params">mod,g,targ</span>):<br>    K=<span class="hljs-number">2</span>**<span class="hljs-number">900</span><br>    M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">3</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>):<br>        M[i][i]=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i][n+<span class="hljs-number">2</span>]=Integer(<span class="hljs-built_in">pow</span>(g,n-i,mod))*K<br>    M[n][n+<span class="hljs-number">2</span>]=-targ*K<br>    M[n+<span class="hljs-number">1</span>][n+<span class="hljs-number">2</span>]=mod*K<br>    M=matrix(ZZ,M)<br>    <span class="hljs-keyword">return</span> M.LLL()<br>A=getVec(q,t,D)<br><span class="hljs-built_in">print</span>(A[<span class="hljs-number">0</span>]) <span class="hljs-comment">#a0ä¸ç¬¦åˆè¦æ±‚</span><br>vv=A[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>):<br>    <span class="hljs-keyword">if</span>(A[i][-<span class="hljs-number">3</span>]==<span class="hljs-number">1</span>):<br>        vv=A[i]<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(vv)<br><span class="hljs-comment">#(-3, -1, 1, -2, 2, -2, -1, -1, 1, 0, 1, 1, -1, 4, 2, -1, -1, -1, 1, -2, 1, -2, 2, 3, -3, -3, 1, 0, 2, -2, -2, 0, -1, 1, 1, 3, 2, 1, 1, -2, -1, 0, -1, 1, -2, 0, -2, 0, -1, 0, 0, 0, -1, 1, 1, -1, 1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)</span><br><span class="hljs-comment">#(3, -5, 1, 2, -4, -1, 1, -2, 1, -3, 0, 0, -1, -2, 1, 3, 2, 1, 4, 2, 0, 0, 3, -2, -1, 4, 0, 1, -2, -1, 0, -1, 3, 1, 0, -1, -3, -1, -1, 1, 1, 1, 0, 0, -1, 3, 2, 0, 1, 0, 1, -1, 1, -2, -1, 2, -1, -1, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0)</span><br><br><span class="hljs-comment"># In[3]:</span><br>R=vv <span class="hljs-keyword">if</span> vv[<span class="hljs-number">0</span>]&gt;=<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> -vv<br>s=[]<br>h=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>    ich=((h+R[i])^^h)<br>    s.append(ich)<br>    h=(h+R[i])*t%q<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-built_in">print</span>(h,D)<br><span class="hljs-comment">#[3, 5, 1, 2, 28, 15, 15, 2, 1, 29, 0, 0, 1, 2, 1, 3, 2, 1, 12, 6, 0, 0, 5, 6, 1, 12, 0, 3, 2, 3, 0, 1, 13, 3, 0, 1, 5, 3, 1, 31, 3, 31, 0, 0, 1, 5, 6, 0, 7, 0, 1, 1, 1, 14, 15, 2, 1, 3, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span><br><span class="hljs-comment">#86818520128168117392109372309780328095 86818520128168117392109372309780328095</span><br><br><span class="hljs-comment"># In[4]:</span><br><span class="hljs-built_in">bytes</span>(s).<span class="hljs-built_in">hex</span>()<br><span class="hljs-comment">#030501021c0f0f02011d00000102010302010c0600000506010c0003020300010d0300010503011f031f00000105060007000101010e0f02010300000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br><br><br></code></pre></td></tr></table></figure><h3 id="7x02-ä¹±æåšæ³•ï¼Œ60-æ¦‚ç‡èƒ½è¿‡-m-i-256-ï¼Œä½†åŸºæœ¬è¿‡ä¸æ‰æœ¬é¢˜çš„-128"><a href="#7x02-ä¹±æåšæ³•ï¼Œ60-æ¦‚ç‡èƒ½è¿‡-m-i-256-ï¼Œä½†åŸºæœ¬è¿‡ä¸æ‰æœ¬é¢˜çš„-128" class="headerlink" title="7x02 ä¹±æåšæ³•ï¼Œ60% æ¦‚ç‡èƒ½è¿‡ $m_i&lt; 256$ï¼Œä½†åŸºæœ¬è¿‡ä¸æ‰æœ¬é¢˜çš„ $128$"></a>7x02 ä¹±æåšæ³•ï¼Œ60% æ¦‚ç‡èƒ½è¿‡ $m_i&lt; 256$ï¼Œä½†åŸºæœ¬è¿‡ä¸æ‰æœ¬é¢˜çš„ $128$</h3><p>å…¶å®ä¸€å¼€å§‹æˆ‘çš„æƒ³æ³•æ˜¯çœ‹sus_hexåœ¨æ±‚hash çš„æ—¶å€™å¯¹åº”çš„ $\delta$ï¼Œç„¶åæ„é€ ä¸€ç»„å·®å€¼ï¼ŒLLLåé¦–è¡Œå°±æ˜¯è§£ï¼Œä½†è¿™ä¹ˆåšå…¶å®å¹¶ä¸å¤ªå¯¹ï¼Œå› ä¸º åŸæœ¬çš„ $\delta$ å†åŠ ä¸Šå¾—åˆ°çš„ $\vec v$ å¯èƒ½ä¼šè¶…æ‰ã€‚ï¼ˆæ¯”å¦‚ <code>h&amp;0xff=82</code>ï¼Œä½† $\delta+v&#x3D;-83$ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„å­—ç¬¦å€¼è¶…è¿‡äº† $256$ã€‚</p><p>ç„¶åæˆ‘å°±æäº†ä¸€ä¸ªéå¸¸ç„å­¦çš„åšæ³•ï¼Œæ ¹æ®ä¸‰é‡å¾ªç¯ï¼Œæšä¸¾å‘é‡ï¼Œæ‰¾ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„å­—ç¬¦ä¸²ï¼Œç”šè‡³è¿˜èƒ½ä»¥ 60% çš„æ¦‚ç‡è¿‡ $m_i&lt;256$ çš„ä¸Šç•Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python 3</span><br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">SOLVE</span>(<span class="hljs-params">q,t,mmm,mode=<span class="hljs-number">1</span></span>):<br>    n=<span class="hljs-number">128</span><br>    C=[]<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recH</span>(<span class="hljs-params"> m: <span class="hljs-built_in">bytes</span></span>):<br>        h = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> mi <span class="hljs-keyword">in</span> m :<br>            C.append((h^mi)-h)<br>            h = (h ^ mi) * t % q<br>        <span class="hljs-keyword">return</span> h<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">H</span>(<span class="hljs-params"> m: <span class="hljs-built_in">bytes</span></span>):<br>        h = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> mi <span class="hljs-keyword">in</span> m :<br>            h = (h ^ mi) * t % q<br>        <span class="hljs-keyword">return</span> h<br>    msg=recH(mmm)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getVec</span>(<span class="hljs-params">mod,g</span>):<br>        K,n=<span class="hljs-number">2</span>^<span class="hljs-number">900</span>,<span class="hljs-number">128</span><br>        M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>)]<span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>):<br>            ge=ZZ(<span class="hljs-built_in">pow</span>(g,n-i,mod))<br>            M[i][i]=<span class="hljs-number">1</span><br>            M[i][n+<span class="hljs-number">1</span>]=ZZ(ge*K)<br>        M[n][n+<span class="hljs-number">1</span>]=ZZ(K*mod)<br>        M=matrix(ZZ,M)<br>        <span class="hljs-keyword">if</span>(mode==<span class="hljs-number">1</span>):<br>            padC=C+[<span class="hljs-number">0</span>]*<span class="hljs-number">500</span><br>            listm=<span class="hljs-built_in">list</span>(M)<br>            listm.append(padC[:n+<span class="hljs-number">2</span>])<br>            M=matrix(listm)<br>        A=M.LLL()<br>        <span class="hljs-keyword">return</span> A[<span class="hljs-number">0</span>],A[<span class="hljs-number">1</span>],A[<span class="hljs-number">2</span>]<br>    A0,A1,A2=getVec(q,t)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">v</span>):<br>        C2=[(C[i]+v[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)] <br>        s=<span class="hljs-string">&#x27;&#x27;</span><br>        h=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            ich=((h+C2[i])^h)<br>            <span class="hljs-keyword">if</span>(ich&gt;<span class="hljs-number">127</span> <span class="hljs-keyword">or</span> ich&lt;<span class="hljs-number">0</span>):<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>            ch=<span class="hljs-built_in">chr</span>(ich)<br>            s+=ch<br>            h=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">int</span>(h) +<span class="hljs-built_in">int</span>(C2[i])) * t % q<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    finded=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(-<span class="hljs-number">30</span>,<span class="hljs-number">30</span>)):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">30</span>,<span class="hljs-number">30</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">30</span>,<span class="hljs-number">30</span>):<br>                <span class="hljs-keyword">if</span>(i==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> j==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> k==<span class="hljs-number">0</span>):<br>                    <span class="hljs-keyword">continue</span><br>                b=i*A0+j*A1+k*A2<br>                <span class="hljs-keyword">if</span>(check(b)):<br>                    finded=<span class="hljs-literal">True</span><br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span>(finded):<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span>(finded):<br>            <span class="hljs-keyword">break</span><br>    C2=[(C[i]+b[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)] <br>    s=[]<br>    h=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            ch=((h+C2[i])^h)<br>            s.append(ch)<br>            h=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">int</span>(h) +<span class="hljs-built_in">int</span>(C2[i])) * t % q<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(s).<span class="hljs-built_in">hex</span>()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br></code></pre></td></tr></table></figure><h2 id="8-goodwell-èµ›åè¡¥é¢˜"><a href="#8-goodwell-èµ›åè¡¥é¢˜" class="headerlink" title="8.goodwell(èµ›åè¡¥é¢˜)"></a>8.goodwell(èµ›åè¡¥é¢˜)</h2><p>ä¸€ä¸ªAES-GCM.nonce-reuseçš„é¢˜ç›®ï¼Œéœ€è¦å…ˆæ³¨æ„åˆ°<code>safe_random</code> æ¯32è½®å°±é‡å¤ä¸€æ¬¡ï¼Œå› æ­¤å­˜åœ¨nonce-reuseã€‚</p><p>è¿™è¾¹æ”¾ä¸€ä¸‹é‡ç”¨éƒ¨åˆ†çš„ä»£ç ï¼Œæ³¨æ„æ˜¯åœ¨Sageä¸­è¿è¡Œçš„ï¼Œå› æ­¤ <code>^^</code> æ˜¯å¼‚æˆ–ï¼Œ<code>^</code> æ˜¯ä¹˜å¹‚ï¼ŒGHASHç»™å‡ºäº†GCMæ ¡éªŒçš„è¿‡ç¨‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#In [1]:</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">data, nonce</span>):<br>    cipher = AES.new(key, AES.MODE_GCM, nonce)<br>    <span class="hljs-keyword">return</span> nonce + cipher.encrypt(data) + cipher.digest()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data</span>):<br>    cipher = AES.new(key, AES.MODE_GCM, data[:<span class="hljs-number">16</span>])<br>    <span class="hljs-keyword">return</span> cipher.decrypt_and_verify(data[<span class="hljs-number">16</span>:-<span class="hljs-number">16</span>], data[-<span class="hljs-number">16</span>:])<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">s1, s2</span>): <span class="hljs-comment"># used to attack aes-ctr</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(s1) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(s1) == <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>([<span class="hljs-built_in">ord</span>(s1) ^ <span class="hljs-built_in">ord</span>(s2)])<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(x ^^ y <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(s1, s2))<br>enonce=<span class="hljs-string">b&#x27;9ijn8uhb7ygv6tfc&#x27;</span><br>key=<span class="hljs-string">b&#x27;1qaz2wsx3edc4rfv&#x27;</span><br>ciph1=encrypt(<span class="hljs-string">b&quot;prefixprefixprefix66666666&quot;</span>,enonce)<br>ciph2=encrypt(<span class="hljs-string">b&quot;prefixprefixprefix88888888&quot;</span>,enonce)<br>C1=ciph1[<span class="hljs-number">16</span>:-<span class="hljs-number">16</span>]<br>T1=ciph1[-<span class="hljs-number">16</span>:]<br>C2=ciph2[<span class="hljs-number">16</span>:-<span class="hljs-number">16</span>]<br>T2=ciph2[-<span class="hljs-number">16</span>:]<br><span class="hljs-built_in">print</span>(C1)<br><span class="hljs-built_in">print</span>(T1)<br><span class="hljs-built_in">print</span>(C2)<br><span class="hljs-built_in">print</span>(T2)<br>C3=xor(<span class="hljs-string">b&#x27;123456&#x27;</span>,xor(<span class="hljs-string">b&#x27;prefix&#x27;</span>,C1[:<span class="hljs-number">6</span>]))<br><span class="hljs-built_in">print</span>(C3.<span class="hljs-built_in">hex</span>())<br><span class="hljs-built_in">print</span>(enonce.<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#Out [1]:</span><br><span class="hljs-string">b&quot;\x12\xc5=J&#x27;\x9c)\xf4\x96\xd1\x1e=LX\xc81D\x95\xd9:\xf3\xf6\x01\x8e\xa5 &quot;</span><br><span class="hljs-string">b&#x27;-\xb0h\xf8\x82/&#125;\xa9\x84\nE`L&#125;]o&#x27;</span><br><span class="hljs-string">b&quot;\x12\xc5=J&#x27;\x9c)\xf4\x96\xd1\x1e=LX\xc81D\x95\xd74\xfd\xf8\x0f\x80\xab.&quot;</span><br><span class="hljs-string">b&#x27;\x10\x03l\x9d\x84^\x98\xf4\x05\xaf\x19\xae$\xb1\xc6w&#x27;</span><br>53856b187bd2<br>39696a6e387568623779677636746663<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#In [2]:</span><br>F.&lt;t&gt;=GF(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>,modulus=(([<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]+[<span class="hljs-number">0</span>]*<span class="hljs-number">500</span>)[:<span class="hljs-number">128</span>]+[<span class="hljs-number">1</span>]))<br>R.&lt;x&gt;=PolynomialRing(F)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convert_to_blocks</span>(<span class="hljs-params">ciphertext</span>):<br>    <span class="hljs-keyword">return</span> [ciphertext[i:i + <span class="hljs-number">16</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span> , <span class="hljs-built_in">len</span>(ciphertext), <span class="hljs-number">16</span>)]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b2p</span>(<span class="hljs-params">block, a</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(block) != <span class="hljs-number">16</span>:<br>        block = block + <span class="hljs-string">b&quot;\0&quot;</span> * (<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(block))<br>    poly = <span class="hljs-number">0</span> <br>    bin_block = <span class="hljs-built_in">bin</span>(bytes_to_long(block))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">128</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(bin_block)):<br>        poly += a**i * <span class="hljs-built_in">int</span>(bin_block[i])<br>    <span class="hljs-keyword">return</span> poly<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">p2b</span>(<span class="hljs-params">poly</span>):<br>    <span class="hljs-keyword">return</span> long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">bin</span>(poly.integer_representation())[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">128</span>)[::-<span class="hljs-number">1</span>], <span class="hljs-number">2</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">GHASH</span>(<span class="hljs-params">C,T=<span class="hljs-string">b&quot;&quot;</span></span>):<br>    Cb=convert_to_blocks(C)<br>    Cp= [b2p(Cb[i], t) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Cb))]<br>    Tp=b2p(T,t)<br>    L = struct.pack(<span class="hljs-string">&quot;&gt;QQ&quot;</span>, <span class="hljs-number">0</span> * <span class="hljs-number">8</span>, <span class="hljs-built_in">len</span>(C) * <span class="hljs-number">8</span>)<br>    Lp = b2p(L, t)<br>    G = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Cb)):<br>        G=(G+Cp[i])*x<br>    G=(G+Lp)*x+Tp<br>    <span class="hljs-keyword">return</span> G<br>G1=GHASH(C1,T1)<br>G2 =GHASH(C2, T2)<br>G3 =GHASH(C3)<br><span class="hljs-built_in">print</span>(G1)<br><span class="hljs-built_in">print</span>(G2)<br><span class="hljs-built_in">print</span>(G3)<br><span class="hljs-comment">#Out [2]:</span><br>(t^<span class="hljs-number">127</span> + t^<span class="hljs-number">123</span> + t^<span class="hljs-number">122</span> + t^<span class="hljs-number">116</span> + t^<span class="hljs-number">113</span> + t^<span class="hljs-number">112</span> + t^<span class="hljs-number">108</span> + t^<span class="hljs-number">107</span> + t^<span class="hljs-number">105</span> + t^<span class="hljs-number">101</span> + t^<span class="hljs-number">100</span> + t^<span class="hljs-number">97</span> + t^<span class="hljs-number">95</span> + t^<span class="hljs-number">93</span> + t^<span class="hljs-number">92</span> + t^<span class="hljs-number">91</span> + t^<span class="hljs-number">90</span> + t^<span class="hljs-number">86</span> + t^<span class="hljs-number">85</span> + t^<span class="hljs-number">84</span> + t^<span class="hljs-number">83</span> + t^<span class="hljs-number">79</span> + t^<span class="hljs-number">75</span> + t^<span class="hljs-number">73</span> + t^<span class="hljs-number">72</span> + t^<span class="hljs-number">70</span> + t^<span class="hljs-number">69</span> + t^<span class="hljs-number">67</span> + t^<span class="hljs-number">64</span> + t^<span class="hljs-number">61</span> + t^<span class="hljs-number">59</span> + t^<span class="hljs-number">58</span> + t^<span class="hljs-number">57</span> + t^<span class="hljs-number">56</span> + t^<span class="hljs-number">55</span> + t^<span class="hljs-number">52</span> + t^<span class="hljs-number">50</span> + t^<span class="hljs-number">45</span> + t^<span class="hljs-number">44</span> + t^<span class="hljs-number">43</span> + t^<span class="hljs-number">40</span> + t^<span class="hljs-number">39</span> + t^<span class="hljs-number">38</span> + t^<span class="hljs-number">37</span> + t^<span class="hljs-number">34</span> + t^<span class="hljs-number">30</span> + t^<span class="hljs-number">28</span> + t^<span class="hljs-number">25</span> + t^<span class="hljs-number">23</span> + t^<span class="hljs-number">21</span> + t^<span class="hljs-number">20</span> + t^<span class="hljs-number">19</span> + t^<span class="hljs-number">18</span> + t^<span class="hljs-number">15</span> + t^<span class="hljs-number">13</span> + t^<span class="hljs-number">9</span> + t^<span class="hljs-number">8</span> + t^<span class="hljs-number">6</span> + t^<span class="hljs-number">3</span>)*x^<span class="hljs-number">3</span> + (t^<span class="hljs-number">74</span> + t^<span class="hljs-number">71</span> + t^<span class="hljs-number">69</span> + t^<span class="hljs-number">66</span> + t^<span class="hljs-number">64</span> + t^<span class="hljs-number">62</span> + t^<span class="hljs-number">61</span> + t^<span class="hljs-number">60</span> + t^<span class="hljs-number">56</span> + t^<span class="hljs-number">55</span> + t^<span class="hljs-number">46</span> + t^<span class="hljs-number">45</span> + t^<span class="hljs-number">43</span> + t^<span class="hljs-number">42</span> + t^<span class="hljs-number">41</span> + t^<span class="hljs-number">40</span> + t^<span class="hljs-number">39</span> + t^<span class="hljs-number">38</span> + t^<span class="hljs-number">35</span> + t^<span class="hljs-number">34</span> + t^<span class="hljs-number">33</span> + t^<span class="hljs-number">32</span> + t^<span class="hljs-number">30</span> + t^<span class="hljs-number">28</span> + t^<span class="hljs-number">27</span> + t^<span class="hljs-number">26</span> + t^<span class="hljs-number">23</span> + t^<span class="hljs-number">20</span> + t^<span class="hljs-number">19</span> + t^<span class="hljs-number">17</span> + t^<span class="hljs-number">16</span> + t^<span class="hljs-number">15</span> + t^<span class="hljs-number">13</span> + t^<span class="hljs-number">11</span> + t^<span class="hljs-number">8</span> + t^<span class="hljs-number">5</span> + t)*x^<span class="hljs-number">2</span> + (t^<span class="hljs-number">123</span> + t^<span class="hljs-number">121</span> + t^<span class="hljs-number">120</span>)*x + t^<span class="hljs-number">127</span> + t^<span class="hljs-number">126</span> + t^<span class="hljs-number">125</span> + t^<span class="hljs-number">124</span> + t^<span class="hljs-number">122</span> + t^<span class="hljs-number">121</span> + t^<span class="hljs-number">119</span> + t^<span class="hljs-number">117</span> + t^<span class="hljs-number">116</span> + t^<span class="hljs-number">115</span> + t^<span class="hljs-number">113</span> + t^<span class="hljs-number">111</span> + t^<span class="hljs-number">109</span> + t^<span class="hljs-number">108</span> + t^<span class="hljs-number">107</span> + t^<span class="hljs-number">106</span> + t^<span class="hljs-number">105</span> + t^<span class="hljs-number">101</span> + t^<span class="hljs-number">100</span> + t^<span class="hljs-number">97</span> + t^<span class="hljs-number">90</span> + t^<span class="hljs-number">89</span> + t^<span class="hljs-number">87</span> + t^<span class="hljs-number">85</span> + t^<span class="hljs-number">81</span> + t^<span class="hljs-number">78</span> + t^<span class="hljs-number">76</span> + t^<span class="hljs-number">69</span> + t^<span class="hljs-number">64</span> + t^<span class="hljs-number">63</span> + t^<span class="hljs-number">60</span> + t^<span class="hljs-number">58</span> + t^<span class="hljs-number">56</span> + t^<span class="hljs-number">55</span> + t^<span class="hljs-number">53</span> + t^<span class="hljs-number">52</span> + t^<span class="hljs-number">51</span> + t^<span class="hljs-number">50</span> + t^<span class="hljs-number">49</span> + t^<span class="hljs-number">47</span> + t^<span class="hljs-number">46</span> + t^<span class="hljs-number">45</span> + t^<span class="hljs-number">44</span> + t^<span class="hljs-number">42</span> + t^<span class="hljs-number">38</span> + t^<span class="hljs-number">32</span> + t^<span class="hljs-number">28</span> + t^<span class="hljs-number">27</span> + t^<span class="hljs-number">26</span> + t^<span class="hljs-number">25</span> + t^<span class="hljs-number">24</span> + t^<span class="hljs-number">20</span> + t^<span class="hljs-number">18</span> + t^<span class="hljs-number">17</span> + t^<span class="hljs-number">11</span> + t^<span class="hljs-number">10</span> + t^<span class="hljs-number">8</span> + t^<span class="hljs-number">7</span> + t^<span class="hljs-number">5</span> + t^<span class="hljs-number">4</span> + t^<span class="hljs-number">2</span><br>(t^<span class="hljs-number">127</span> + t^<span class="hljs-number">123</span> + t^<span class="hljs-number">122</span> + t^<span class="hljs-number">116</span> + t^<span class="hljs-number">113</span> + t^<span class="hljs-number">112</span> + t^<span class="hljs-number">108</span> + t^<span class="hljs-number">107</span> + t^<span class="hljs-number">105</span> + t^<span class="hljs-number">101</span> + t^<span class="hljs-number">100</span> + t^<span class="hljs-number">97</span> + t^<span class="hljs-number">95</span> + t^<span class="hljs-number">93</span> + t^<span class="hljs-number">92</span> + t^<span class="hljs-number">91</span> + t^<span class="hljs-number">90</span> + t^<span class="hljs-number">86</span> + t^<span class="hljs-number">85</span> + t^<span class="hljs-number">84</span> + t^<span class="hljs-number">83</span> + t^<span class="hljs-number">79</span> + t^<span class="hljs-number">75</span> + t^<span class="hljs-number">73</span> + t^<span class="hljs-number">72</span> + t^<span class="hljs-number">70</span> + t^<span class="hljs-number">69</span> + t^<span class="hljs-number">67</span> + t^<span class="hljs-number">64</span> + t^<span class="hljs-number">61</span> + t^<span class="hljs-number">59</span> + t^<span class="hljs-number">58</span> + t^<span class="hljs-number">57</span> + t^<span class="hljs-number">56</span> + t^<span class="hljs-number">55</span> + t^<span class="hljs-number">52</span> + t^<span class="hljs-number">50</span> + t^<span class="hljs-number">45</span> + t^<span class="hljs-number">44</span> + t^<span class="hljs-number">43</span> + t^<span class="hljs-number">40</span> + t^<span class="hljs-number">39</span> + t^<span class="hljs-number">38</span> + t^<span class="hljs-number">37</span> + t^<span class="hljs-number">34</span> + t^<span class="hljs-number">30</span> + t^<span class="hljs-number">28</span> + t^<span class="hljs-number">25</span> + t^<span class="hljs-number">23</span> + t^<span class="hljs-number">21</span> + t^<span class="hljs-number">20</span> + t^<span class="hljs-number">19</span> + t^<span class="hljs-number">18</span> + t^<span class="hljs-number">15</span> + t^<span class="hljs-number">13</span> + t^<span class="hljs-number">9</span> + t^<span class="hljs-number">8</span> + t^<span class="hljs-number">6</span> + t^<span class="hljs-number">3</span>)*x^<span class="hljs-number">3</span> + (t^<span class="hljs-number">78</span> + t^<span class="hljs-number">77</span> + t^<span class="hljs-number">76</span> + t^<span class="hljs-number">74</span> + t^<span class="hljs-number">71</span> + t^<span class="hljs-number">70</span> + t^<span class="hljs-number">68</span> + t^<span class="hljs-number">66</span> + t^<span class="hljs-number">64</span> + t^<span class="hljs-number">56</span> + t^<span class="hljs-number">55</span> + t^<span class="hljs-number">54</span> + t^<span class="hljs-number">53</span> + t^<span class="hljs-number">52</span> + t^<span class="hljs-number">44</span> + t^<span class="hljs-number">43</span> + t^<span class="hljs-number">42</span> + t^<span class="hljs-number">41</span> + t^<span class="hljs-number">40</span> + t^<span class="hljs-number">39</span> + t^<span class="hljs-number">37</span> + t^<span class="hljs-number">36</span> + t^<span class="hljs-number">35</span> + t^<span class="hljs-number">34</span> + t^<span class="hljs-number">33</span> + t^<span class="hljs-number">32</span> + t^<span class="hljs-number">29</span> + t^<span class="hljs-number">27</span> + t^<span class="hljs-number">26</span> + t^<span class="hljs-number">23</span> + t^<span class="hljs-number">22</span> + t^<span class="hljs-number">21</span> + t^<span class="hljs-number">19</span> + t^<span class="hljs-number">17</span> + t^<span class="hljs-number">16</span> + t^<span class="hljs-number">15</span> + t^<span class="hljs-number">13</span> + t^<span class="hljs-number">11</span> + t^<span class="hljs-number">8</span> + t^<span class="hljs-number">5</span> + t)*x^<span class="hljs-number">2</span> + (t^<span class="hljs-number">123</span> + t^<span class="hljs-number">121</span> + t^<span class="hljs-number">120</span>)*x + t^<span class="hljs-number">127</span> + t^<span class="hljs-number">126</span> + t^<span class="hljs-number">125</span> + t^<span class="hljs-number">123</span> + t^<span class="hljs-number">122</span> + t^<span class="hljs-number">121</span> + t^<span class="hljs-number">118</span> + t^<span class="hljs-number">117</span> + t^<span class="hljs-number">113</span> + t^<span class="hljs-number">112</span> + t^<span class="hljs-number">111</span> + t^<span class="hljs-number">107</span> + t^<span class="hljs-number">106</span> + t^<span class="hljs-number">104</span> + t^<span class="hljs-number">101</span> + t^<span class="hljs-number">98</span> + t^<span class="hljs-number">94</span> + t^<span class="hljs-number">93</span> + t^<span class="hljs-number">92</span> + t^<span class="hljs-number">90</span> + t^<span class="hljs-number">88</span> + t^<span class="hljs-number">87</span> + t^<span class="hljs-number">84</span> + t^<span class="hljs-number">83</span> + t^<span class="hljs-number">79</span> + t^<span class="hljs-number">78</span> + t^<span class="hljs-number">77</span> + t^<span class="hljs-number">76</span> + t^<span class="hljs-number">74</span> + t^<span class="hljs-number">72</span> + t^<span class="hljs-number">71</span> + t^<span class="hljs-number">69</span> + t^<span class="hljs-number">61</span> + t^<span class="hljs-number">59</span> + t^<span class="hljs-number">58</span> + t^<span class="hljs-number">57</span> + t^<span class="hljs-number">56</span> + t^<span class="hljs-number">52</span> + t^<span class="hljs-number">51</span> + t^<span class="hljs-number">48</span> + t^<span class="hljs-number">46</span> + t^<span class="hljs-number">45</span> + t^<span class="hljs-number">44</span> + t^<span class="hljs-number">43</span> + t^<span class="hljs-number">41</span> + t^<span class="hljs-number">37</span> + t^<span class="hljs-number">32</span> + t^<span class="hljs-number">31</span> + t^<span class="hljs-number">29</span> + t^<span class="hljs-number">28</span> + t^<span class="hljs-number">27</span> + t^<span class="hljs-number">24</span> + t^<span class="hljs-number">21</span> + t^<span class="hljs-number">20</span> + t^<span class="hljs-number">18</span> + t^<span class="hljs-number">17</span> + t^<span class="hljs-number">15</span> + t^<span class="hljs-number">14</span> + t^<span class="hljs-number">3</span><br>(t^<span class="hljs-number">46</span> + t^<span class="hljs-number">43</span> + t^<span class="hljs-number">41</span> + t^<span class="hljs-number">40</span> + t^<span class="hljs-number">39</span> + t^<span class="hljs-number">38</span> + t^<span class="hljs-number">36</span> + t^<span class="hljs-number">35</span> + t^<span class="hljs-number">34</span> + t^<span class="hljs-number">33</span> + t^<span class="hljs-number">28</span> + t^<span class="hljs-number">27</span> + t^<span class="hljs-number">23</span> + t^<span class="hljs-number">22</span> + t^<span class="hljs-number">20</span> + t^<span class="hljs-number">18</span> + t^<span class="hljs-number">17</span> + t^<span class="hljs-number">15</span> + t^<span class="hljs-number">13</span> + t^<span class="hljs-number">8</span> + t^<span class="hljs-number">7</span> + t^<span class="hljs-number">6</span> + t^<span class="hljs-number">3</span> + t)*x^<span class="hljs-number">2</span> + (t^<span class="hljs-number">123</span> + t^<span class="hljs-number">122</span>)*x<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#In [3]:</span><br>P=G1+G2<br><span class="hljs-built_in">print</span>(P)<br>auth_keys = [r <span class="hljs-keyword">for</span> r, _ <span class="hljs-keyword">in</span> P.roots()]<br><span class="hljs-built_in">print</span>(auth_keys)<br><span class="hljs-keyword">for</span> H, _ <span class="hljs-keyword">in</span> P.roots():<br>    EJ = G1(H)<br>    T3 = G3(H) + EJ<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;H: &quot;</span> + <span class="hljs-built_in">str</span>(H) + <span class="hljs-string">&quot;\nT3: &quot;</span> + <span class="hljs-built_in">str</span>(p2b(T3).<span class="hljs-built_in">hex</span>()))<br><span class="hljs-comment">#Out [3]:</span><br>(t^<span class="hljs-number">78</span> + t^<span class="hljs-number">77</span> + t^<span class="hljs-number">76</span> + t^<span class="hljs-number">70</span> + t^<span class="hljs-number">69</span> + t^<span class="hljs-number">68</span> + t^<span class="hljs-number">62</span> + t^<span class="hljs-number">61</span> + t^<span class="hljs-number">60</span> + t^<span class="hljs-number">54</span> + t^<span class="hljs-number">53</span> + t^<span class="hljs-number">52</span> + t^<span class="hljs-number">46</span> + t^<span class="hljs-number">45</span> + t^<span class="hljs-number">44</span> + t^<span class="hljs-number">38</span> + t^<span class="hljs-number">37</span> + t^<span class="hljs-number">36</span> + t^<span class="hljs-number">30</span> + t^<span class="hljs-number">29</span> + t^<span class="hljs-number">28</span> + t^<span class="hljs-number">22</span> + t^<span class="hljs-number">21</span> + t^<span class="hljs-number">20</span>)*x^<span class="hljs-number">2</span> + t^<span class="hljs-number">124</span> + t^<span class="hljs-number">123</span> + t^<span class="hljs-number">119</span> + t^<span class="hljs-number">118</span> + t^<span class="hljs-number">116</span> + t^<span class="hljs-number">115</span> + t^<span class="hljs-number">112</span> + t^<span class="hljs-number">109</span> + t^<span class="hljs-number">108</span> + t^<span class="hljs-number">105</span> + t^<span class="hljs-number">104</span> + t^<span class="hljs-number">100</span> + t^<span class="hljs-number">98</span> + t^<span class="hljs-number">97</span> + t^<span class="hljs-number">94</span> + t^<span class="hljs-number">93</span> + t^<span class="hljs-number">92</span> + t^<span class="hljs-number">89</span> + t^<span class="hljs-number">88</span> + t^<span class="hljs-number">85</span> + t^<span class="hljs-number">84</span> + t^<span class="hljs-number">83</span> + t^<span class="hljs-number">81</span> + t^<span class="hljs-number">79</span> + t^<span class="hljs-number">77</span> + t^<span class="hljs-number">74</span> + t^<span class="hljs-number">72</span> + t^<span class="hljs-number">71</span> + t^<span class="hljs-number">64</span> + t^<span class="hljs-number">63</span> + t^<span class="hljs-number">61</span> + t^<span class="hljs-number">60</span> + t^<span class="hljs-number">59</span> + t^<span class="hljs-number">57</span> + t^<span class="hljs-number">55</span> + t^<span class="hljs-number">53</span> + t^<span class="hljs-number">50</span> + t^<span class="hljs-number">49</span> + t^<span class="hljs-number">48</span> + t^<span class="hljs-number">47</span> + t^<span class="hljs-number">43</span> + t^<span class="hljs-number">42</span> + t^<span class="hljs-number">41</span> + t^<span class="hljs-number">38</span> + t^<span class="hljs-number">37</span> + t^<span class="hljs-number">31</span> + t^<span class="hljs-number">29</span> + t^<span class="hljs-number">26</span> + t^<span class="hljs-number">25</span> + t^<span class="hljs-number">21</span> + t^<span class="hljs-number">15</span> + t^<span class="hljs-number">14</span> + t^<span class="hljs-number">11</span> + t^<span class="hljs-number">10</span> + t^<span class="hljs-number">8</span> + t^<span class="hljs-number">7</span> + t^<span class="hljs-number">5</span> + t^<span class="hljs-number">4</span> + t^<span class="hljs-number">3</span> + t^<span class="hljs-number">2</span><br>[t^<span class="hljs-number">126</span> + t^<span class="hljs-number">124</span> + t^<span class="hljs-number">123</span> + t^<span class="hljs-number">116</span> + t^<span class="hljs-number">114</span> + t^<span class="hljs-number">110</span> + t^<span class="hljs-number">109</span> + t^<span class="hljs-number">108</span> + t^<span class="hljs-number">106</span> + t^<span class="hljs-number">102</span> + t^<span class="hljs-number">101</span> + t^<span class="hljs-number">99</span> + t^<span class="hljs-number">98</span> + t^<span class="hljs-number">94</span> + t^<span class="hljs-number">92</span> + t^<span class="hljs-number">90</span> + t^<span class="hljs-number">88</span> + t^<span class="hljs-number">87</span> + t^<span class="hljs-number">82</span> + t^<span class="hljs-number">80</span> + t^<span class="hljs-number">77</span> + t^<span class="hljs-number">75</span> + t^<span class="hljs-number">73</span> + t^<span class="hljs-number">72</span> + t^<span class="hljs-number">67</span> + t^<span class="hljs-number">64</span> + t^<span class="hljs-number">63</span> + t^<span class="hljs-number">62</span> + t^<span class="hljs-number">61</span> + t^<span class="hljs-number">60</span> + t^<span class="hljs-number">59</span> + t^<span class="hljs-number">58</span> + t^<span class="hljs-number">52</span> + t^<span class="hljs-number">50</span> + t^<span class="hljs-number">49</span> + t^<span class="hljs-number">48</span> + t^<span class="hljs-number">46</span> + t^<span class="hljs-number">43</span> + t^<span class="hljs-number">42</span> + t^<span class="hljs-number">40</span> + t^<span class="hljs-number">38</span> + t^<span class="hljs-number">37</span> + t^<span class="hljs-number">36</span> + t^<span class="hljs-number">32</span> + t^<span class="hljs-number">31</span> + t^<span class="hljs-number">26</span> + t^<span class="hljs-number">25</span> + t^<span class="hljs-number">21</span> + t^<span class="hljs-number">19</span> + t^<span class="hljs-number">17</span> + t^<span class="hljs-number">16</span> + t^<span class="hljs-number">15</span> + t^<span class="hljs-number">12</span> + t^<span class="hljs-number">8</span> + t^<span class="hljs-number">5</span> + <span class="hljs-number">1</span>]<br>H: t^<span class="hljs-number">126</span> + t^<span class="hljs-number">124</span> + t^<span class="hljs-number">123</span> + t^<span class="hljs-number">116</span> + t^<span class="hljs-number">114</span> + t^<span class="hljs-number">110</span> + t^<span class="hljs-number">109</span> + t^<span class="hljs-number">108</span> + t^<span class="hljs-number">106</span> + t^<span class="hljs-number">102</span> + t^<span class="hljs-number">101</span> + t^<span class="hljs-number">99</span> + t^<span class="hljs-number">98</span> + t^<span class="hljs-number">94</span> + t^<span class="hljs-number">92</span> + t^<span class="hljs-number">90</span> + t^<span class="hljs-number">88</span> + t^<span class="hljs-number">87</span> + t^<span class="hljs-number">82</span> + t^<span class="hljs-number">80</span> + t^<span class="hljs-number">77</span> + t^<span class="hljs-number">75</span> + t^<span class="hljs-number">73</span> + t^<span class="hljs-number">72</span> + t^<span class="hljs-number">67</span> + t^<span class="hljs-number">64</span> + t^<span class="hljs-number">63</span> + t^<span class="hljs-number">62</span> + t^<span class="hljs-number">61</span> + t^<span class="hljs-number">60</span> + t^<span class="hljs-number">59</span> + t^<span class="hljs-number">58</span> + t^<span class="hljs-number">52</span> + t^<span class="hljs-number">50</span> + t^<span class="hljs-number">49</span> + t^<span class="hljs-number">48</span> + t^<span class="hljs-number">46</span> + t^<span class="hljs-number">43</span> + t^<span class="hljs-number">42</span> + t^<span class="hljs-number">40</span> + t^<span class="hljs-number">38</span> + t^<span class="hljs-number">37</span> + t^<span class="hljs-number">36</span> + t^<span class="hljs-number">32</span> + t^<span class="hljs-number">31</span> + t^<span class="hljs-number">26</span> + t^<span class="hljs-number">25</span> + t^<span class="hljs-number">21</span> + t^<span class="hljs-number">19</span> + t^<span class="hljs-number">17</span> + t^<span class="hljs-number">16</span> + t^<span class="hljs-number">15</span> + t^<span class="hljs-number">12</span> + t^<span class="hljs-number">8</span> + t^<span class="hljs-number">5</span> + <span class="hljs-number">1</span><br>T3: 2b10dad9688ea6dab1b06fbdea3db46b<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#In [4]:</span><br>A=enonce.<span class="hljs-built_in">hex</span>()+C3.<span class="hljs-built_in">hex</span>()+<span class="hljs-string">&#x27;2b10dad9688ea6dab1b06fbdea3db46b&#x27;</span><br>decrypt(<span class="hljs-built_in">bytes</span>.fromhex(A))<br><span class="hljs-comment">#Out [4]:</span><br><span class="hljs-string">b&#x27;123456&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="9-nfsr2-èµ›åè¡¥é¢˜ï¼ŒUpdate-10-24"><a href="#9-nfsr2-èµ›åè¡¥é¢˜ï¼ŒUpdate-10-24" class="headerlink" title="9.nfsr2 (èµ›åè¡¥é¢˜ï¼ŒUpdate 10.24)"></a>9.nfsr2 (èµ›åè¡¥é¢˜ï¼ŒUpdate 10.24)</h2><p>2024.10.24è¡¥é¢˜ï¼Œæœ€ç»ˆèƒ½å¤Ÿåšåˆ°æ¦‚ç‡æ€§åœ°æˆåŠŸæ¢å¤lfsrçš„seedã€‚</p><p>P.S. è¯¥é¢˜ä¸ºé”™é¢˜ï¼Œå’Œå‡ºé¢˜äººè®¨è®ºäº†ä¸€ä¸‹ï¼Œä»»åŠ¡ä¸­çš„andNumå’ŒorNumåº”è¯¥å–åŒä¸€ä¸ªå€¼ï¼Œå¦åˆ™ä¼šå‡ºç°å¤šè§£ï¼ˆè§æˆ‘æœ€åçš„å›¾ç‰‡ï¼‰ã€‚</p><p>ä¸è¿‡è¿˜æ˜¯å¾ˆæƒ³åæ§½ä¸€ä¸‹è¿™ä¸ªé¢˜ï¼Œä»¥å‰æˆ‘ä¹Ÿè§è¿‡ä¸¤ä¸‰ä¸ªLFSRé¢˜ç”¨ <code>getrandbits</code> ç„¶åé¢˜ç›®è¶Šåšè¶Šå¤æ‚çš„ã€‚å‘ƒï¼Œä¸ºå•¥ä¸ç”¨ <code>getPrime</code> æˆ–è€… <code>((1&lt;&lt;(nbits-1))+1)|getrandbits(nbits)</code> æ¥ä¿è¯ä¸€ä¸‹æœ€é«˜ä½å’Œæœ€ä½ä½éƒ½æ˜¯ $1$ å‘¢ã€‚</p><p>å…¶å®è¿™ä¸ªé¢˜ä¸»è¦è€ƒå¯ŸLFSRçš„çŠ¶æ€è½¬ç§»è¡¨ç¤ºä¸º $\mathrm{GF}(2)$ ä¸Šçš„çŸ©é˜µæ–¹ç¨‹ï¼Œæ¯”å¦‚ä¸€ä¸ª 4 é˜¶çš„LFSRï¼Œå…¶è¡¨è¾¾å¼ä¸º $y&#x3D;x_4\oplus x_2\oplus x_1$ï¼Œé‚£ä¹ˆå…¶è½¬ç§»çŸ©é˜µå¦‚ä¸‹ï¼š</p><p><img src="/2024/10/23/SUSCTF2024/9-1.png" alt="9-1"></p><p>å› æ­¤ï¼Œå¯¹äºä»»æ„åˆå§‹çŠ¶æ€å‘é‡ï¼ˆç§å­ï¼‰ $\vec v \neq \vec 0$ï¼Œæ‰§è¡Œ $k$ æ¬¡LFSRä¹‹åï¼Œå…¶çŠ¶æ€ä¸º $\vec v\mathbf M^{k}$ã€‚</p><p>ç»§ç»­çœ‹ä¸€ä¸‹é¢˜ç›®ä¸­é™„ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># util.py</span><br>nbit = <span class="hljs-number">128</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bitcount</span>(<span class="hljs-params">x</span>):<br>    c=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span>(x):<br>        c+=(x&amp;<span class="hljs-number">1</span>)<br>        x&gt;&gt;=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> c<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LFSR</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed: <span class="hljs-built_in">int</span>, mask: <span class="hljs-built_in">int</span></span>):<br>        <span class="hljs-variable language_">self</span>.state = seed &amp; (<span class="hljs-number">2</span>**nbit - <span class="hljs-number">1</span>)<br>        <span class="hljs-variable language_">self</span>.mask = mask &amp; (<span class="hljs-number">2</span>**nbit - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__next__</span>(<span class="hljs-params">self</span>):<br>        out = bitcount(<span class="hljs-variable language_">self</span>.state &amp; <span class="hljs-variable language_">self</span>.mask) &amp; <span class="hljs-number">1</span><br>        <span class="hljs-variable language_">self</span>.state = ((<span class="hljs-variable language_">self</span>.state &lt;&lt; <span class="hljs-number">1</span>) | out) &amp; (<span class="hljs-number">2</span>**nbit - <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> out<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, bits: <span class="hljs-built_in">int</span></span>):<br>        out = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits):<br>            out = (out &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-built_in">next</span>(<span class="hljs-variable language_">self</span>)<br>        <span class="hljs-keyword">return</span> out<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">NFSR</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, lfsr0: LFSR, lfsr1: LFSR</span>):<br>        <span class="hljs-variable language_">self</span>.lfsr0 = lfsr0<br>        <span class="hljs-variable language_">self</span>.lfsr1 = lfsr1<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, msg: <span class="hljs-built_in">bytes</span></span>):<br>        enc = <span class="hljs-built_in">list</span>()<br>        <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> msg:<br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.lfsr0(<span class="hljs-number">1</span>):<br>                enc += [m &amp; <span class="hljs-variable language_">self</span>.lfsr1(<span class="hljs-number">8</span>), m | <span class="hljs-variable language_">self</span>.lfsr1(<span class="hljs-number">8</span>)]<br>            <span class="hljs-keyword">else</span>:<br>                enc += [m | <span class="hljs-variable language_">self</span>.lfsr1(<span class="hljs-number">8</span>), m &amp; <span class="hljs-variable language_">self</span>.lfsr1(<span class="hljs-number">8</span>)]<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(enc)<br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#task.py</span><br><span class="hljs-keyword">import</span> secrets<br><span class="hljs-keyword">from</span> utils <span class="hljs-keyword">import</span> nbit, LFSR, NFSR<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>():<br>    <span class="hljs-keyword">import</span> string, hashlib, random<br><br>    alphabet = string.ascii_letters + string.digits<br>    proof = <span class="hljs-string">&#x27;&#x27;</span>.join(random.choices(alphabet, k=<span class="hljs-number">16</span>))<br>    digest = hashlib.sha256(proof.encode()).hexdigest()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;sha256(XXXX+<span class="hljs-subst">&#123;proof[<span class="hljs-number">4</span>:]&#125;</span>)==<span class="hljs-subst">&#123;digest&#125;</span>&quot;</span>)<br>    x = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Give me XXXX:&quot;</span>)<br>    h = hashlib.sha256((x + proof[<span class="hljs-number">4</span>:]).encode()).hexdigest()<br>    <span class="hljs-keyword">return</span> h == digest<br><br><span class="hljs-keyword">assert</span> proof_of_work()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Good luck&quot;</span>)<br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        seeds = [secrets.randbits(nbit) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>        masks = [secrets.randbits(nbit) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>        lfsrs = [LFSR(seed, mask) <span class="hljs-keyword">for</span> seed, mask <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(seeds, masks)]<br>        nfsr = NFSR(*lfsrs)<br><br>        msg = secrets.token_bytes(<span class="hljs-number">200</span>)<br>        enc = nfsr(msg)<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Round <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span>: <span class="hljs-subst">&#123;enc.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;masks = &#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;&gt;&#x27;</span>)) == msg:<br>            <span class="hljs-keyword">raise</span> Exception<br>    flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>).read()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Congratulations: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br><span class="hljs-keyword">except</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Not this time&quot;</span>)<br></code></pre></td></tr></table></figure><p>è¿™ä¸€æ¬¡å¾ˆæ˜æ˜¾ï¼Œé•¿åº¦ä¸º $200$ å­—èŠ‚çš„ä¿¡æ¯åŠ å¯†åå˜æˆäº†é•¿åº¦ä¸º $400$ çš„å†…å®¹ï¼Œå¯¹äºå­—èŠ‚ $m$ï¼Œæ‰§è¡Œ <code>m&amp;x</code> å’Œ <code>m|y</code>ï¼Œå¹¶ä¸”ä¸¤ä¸ªlfsrçš„maskå·²çŸ¥ï¼Œè¦æ±‚æ±‚å‡ºåŸå§‹ä¿¡æ¯ï¼Œ5 è½®è·å¾—flagã€‚å› æ­¤ï¼Œå¯ä»¥æ ¹æ®æ¯ä¸€ç»„è¾“å‡ºä¸¤å­—èŠ‚çš„ $1$ æ¯”ç‰¹æ•°é‡æ¥ç¡®å®š bitand å’Œ bitor çš„ç»“æœã€‚</p><blockquote><p>æ³¨ï¼š<code>bitcount(m|x)==bitcount(m|y)</code> çš„æ¦‚ç‡å…¶å®å¾ˆä½ï¼Œå› ä¸ºæˆ‘ä¸€å¼€å§‹æ²¡æ³¨æ„åˆ°è¿™ä¸ªè½¬ç§»çŸ©é˜µï¼Œå› æ­¤é‡åˆ°è¿™ç§æƒ…å†µæˆ‘ç›´æ¥è·³è¿‡äº†ã€‚å…¶å®å¯ä»¥å°†å¯¹åº”çš„ä½ç½®æ ‡è®°ä¸º <code>?</code>ï¼Œåˆ°æ—¶å€™åˆ©ç”¨è½¬ç§»çŸ©é˜µï¼Œåœ¨ mask å·²çŸ¥çš„æƒ…å†µä¸‹ï¼ŒçŸ¥é“ $n$ ä¸ªè¾“å‡ºå°±å¯ä»¥æ¢å¤LFSRï¼Œè¿™ $n$ ä¸ªæ¯”ç‰¹çš„è¾“å‡ºå…¶å®ä¸éœ€è¦è¿ç»­ã€‚å› æ­¤ï¼Œlfsr0è¿˜æ˜¯éå¸¸å®¹æ˜“æ¢å¤çš„</p></blockquote><p>ç„¶åæ˜¯æ¢å¤LFSR1ï¼ŒLFSR1ç´¯è®¡è¾“å‡ºäº† $3200$ <strong>æ¯”ç‰¹</strong>ï¼Œæ¶ˆæ¯ä¸€å…± $1600$ æ¯”ç‰¹ã€‚ç„¶åå¯†æ–‡çš„ $3200$ æ¯”ç‰¹æœ‰LFSR1è¾“å‡ºå’Œæ¶ˆæ¯ bitand,bitor å¾—åˆ°ã€‚å› æ­¤æ ¹æ®ä¸‹é¢çš„çŸ¥è¯†ï¼Œå¯ä»¥å¾—åˆ° $1&#x2F;4$ çš„LFSR1è¾“å‡ºå’Œ $1&#x2F;2$ çš„æ˜æ–‡å†…å®¹ï¼š</p><blockquote><ol><li>è‹¥ <code>m|x</code> å¯¹åº”ä½ä¸º $0$ ï¼Œåˆ™ $m$ å’Œ $x$ çš„å¯¹åº”ä½å‡ä¸º $0$ã€‚</li><li>è‹¥ <code>m&amp;x</code> å¯¹åº”ä½ ä¸º $1$ï¼Œåˆ™ $m$ å’Œ $x$ çš„å¯¹åº”ä½å‡ä¸º $1$ã€‚</li></ol></blockquote><p>æœŸæœ›æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿå¾—åˆ°çº¦ $800$ ä¸ªLFSR1 è¾“å‡ºçš„å€¼å’Œ $800$ ä¸ªæ˜æ–‡æ¯”ç‰¹ã€‚å…ˆå°†æœªçŸ¥å†…å®¹å…¨éƒ¨æ ‡è®°ä¸º <code>?</code>ï¼Œç„¶åæ ¹æ®ä¸Šé¢ä¸¤æ¡è§„åˆ™é€æ­¥ç¡®å®šï¼Œç„¶åå–ä¸ä¸º <code>?</code> çš„å€¼æ„é€ çŸ©é˜µå³å¯ã€‚</p><p>è¿™æ ·å°±æœ‰å¯èƒ½èƒ½å¤Ÿæ¢å¤ä¸¤ä¸ªLFSRçš„seedäº†ï¼Œä½†ç”±äºè¿™ä¸¤ä¸ªLFSRå¯èƒ½ä¸æ»¡ç§©ï¼Œå› æ­¤å¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›å¾®æ“ã€‚</p><p>P.Sï¼šå…«é˜¶LFSRåŸºäºçš„å¤šé¡¹å¼ $x^8+x^4+x^3+x^2+1$ ä¸­ï¼Œå‡è®¾é‡Œé¢çŠ¶æ€æ˜¯ $b_8b_7b_6b_5b_4b_3b_2b_1$ï¼Œæ˜¯ $8,4,3,2$ å››ä¸ªæ•°å¼‚æˆ–ï¼Œé‚£ä¸ª $1$ æ‰æ˜¯å¤šä½™çš„ï¼ï¼ˆä½ å¯ä»¥ç†è§£ä¸ºæ¯ç§»ä½ä¸€æ¬¡ç›¸å½“äºä¹˜ä¸€ä¸ª $x$ï¼Œæœ€åçš„ $1$ å±äºè¾“å‡ºç»“æœçš„ç³»æ•°ï¼‰ã€‚å› æ­¤ï¼Œ$\mathrm{lowbit(mask)\ne1}$ä¸å½±å“ï¼Œä½†æœ€maskçš„é«˜ä½ä¸ä¸º $1$ åˆ™ä¼šå¯¼è‡´LFSRå¤±ç§©ã€‚</p><p>å…·ä½“æœ¬åœ°è§£é¢˜ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#solve.py</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Testans <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Testinput <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> utils <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lowbit</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> ((x) &amp; (-x))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bitcount</span>(<span class="hljs-params">x</span>):<br>    count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span>(x):<br>        count += <span class="hljs-number">1</span><br>        x ^= ((x) &amp; (-x))<br>    <span class="hljs-keyword">return</span> count<br><br><br>T = <span class="hljs-number">125</span> <span class="hljs-comment">#Tè¡¨ç¤ºæ•°æ®çš„ç¼–å·ï¼Œæœ‰çš„æ•°æ®ä¸ä¸€å®šèƒ½è¿è¡Œèµ·æ¥ã€‚</span><br>nfsr = NFSR(<span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>)<br>m0, m1 = maskRec0[T], maskRec1[T]<br>nfsr.lfsr0 = LFSR(<span class="hljs-number">0</span>, m0)<br>nfsr.lfsr1 = LFSR(<span class="hljs-number">0</span>, m1)<br>ciph = hexEnc[T]<br>output = []<br>outstat0 = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">200</span>):<br>    op1, op2 = <span class="hljs-built_in">int</span>(ciph[<span class="hljs-number">4</span>*i:<span class="hljs-number">4</span>*i+<span class="hljs-number">2</span>], <span class="hljs-number">16</span>), <span class="hljs-built_in">int</span>(ciph[<span class="hljs-number">4</span>*i+<span class="hljs-number">2</span>:<span class="hljs-number">4</span>*i+<span class="hljs-number">4</span>], <span class="hljs-number">16</span>)<br>    output.append((op1, op2))<br><span class="hljs-keyword">for</span> op1, op2 <span class="hljs-keyword">in</span> output:<br>    <span class="hljs-keyword">assert</span>(bitcount(op1) != bitcount(op2))<br>    <span class="hljs-keyword">if</span>(bitcount(op1) &gt; bitcount(op2)):<br>        outstat0 += <span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        outstat0 += <span class="hljs-string">&#x27;1&#x27;</span><br>realLen0 = m0.bit_length()<br>btn0 = m0 &amp; (-m0)<br>cur0 = <span class="hljs-built_in">int</span>(outstat0[:realLen0], <span class="hljs-number">2</span>)<br>inistat0 = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>    curt = cur0 &amp; <span class="hljs-number">1</span><br>    cur0 &gt;&gt;= <span class="hljs-number">1</span><br>    preb = (bitcount(cur0 &amp; m0) ^ curt) &amp; <span class="hljs-number">1</span><br>    inistat0 = <span class="hljs-built_in">str</span>(preb)+inistat0<br>    cur0 |= (preb &lt;&lt; (realLen0-<span class="hljs-number">1</span>))<br>    <span class="hljs-comment"># print(cur0)</span><br>bciph = <span class="hljs-built_in">list</span>((<span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">3200</span>+(<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(ciph, <span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:]))[-<span class="hljs-number">3200</span>:])<br>msg = [<span class="hljs-string">&#x27;?&#x27;</span>]*<span class="hljs-number">1600</span><br>outstat1 = [<span class="hljs-string">&#x27;?&#x27;</span>]*<span class="hljs-number">3200</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">200</span>):<br>    msg8ind = <span class="hljs-number">8</span>*i<br>    or8ind, and8ind = <span class="hljs-number">16</span>*i, <span class="hljs-number">16</span>*i+<span class="hljs-number">8</span><br>    <span class="hljs-keyword">if</span>(outstat0[i] == <span class="hljs-string">&#x27;1&#x27;</span>):<br>        or8ind, and8ind = <span class="hljs-number">16</span>*i+<span class="hljs-number">8</span>, <span class="hljs-number">16</span>*i<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">if</span>(bciph[or8ind+j] == <span class="hljs-string">&#x27;0&#x27;</span>):<br>            msg[msg8ind+j] = <span class="hljs-string">&#x27;0&#x27;</span><br>            outstat1[or8ind+j] = <span class="hljs-string">&#x27;0&#x27;</span><br>        <span class="hljs-keyword">if</span> (bciph[and8ind+j] == <span class="hljs-string">&#x27;1&#x27;</span>):<br>            msg[msg8ind+j] = <span class="hljs-string">&#x27;1&#x27;</span><br>            outstat1[and8ind+j] = <span class="hljs-string">&#x27;1&#x27;</span><br><br><br>realLen1 = m1.bit_length()+<span class="hljs-number">1</span>-(m1 &amp; (-m1)).bit_length()<br>M = [[i == (j+<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(realLen1)]<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(realLen1)]<br>realm1 = m1//lowbit(m1)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(realLen1):<br>    M[realLen1-<span class="hljs-number">1</span>-i][-<span class="hljs-number">1</span>] = ((realm1) &amp; (<span class="hljs-number">1</span> &lt;&lt; i)) != <span class="hljs-number">0</span><br>M = Matrix(GF(<span class="hljs-number">2</span>), M)<br>A = []<br>vecb = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(outstat1)):<br>    <span class="hljs-keyword">if</span>(outstat1[i] != <span class="hljs-string">&#x27;?&#x27;</span>):<br>        vecb.append(<span class="hljs-built_in">int</span>(outstat1[i]))<br>        xpi = (i+(lowbit(m1).bit_length()))<br>        <span class="hljs-comment"># print(i,xpi)</span><br>        Mcur = (M**xpi).T<br>        A.append(<span class="hljs-built_in">list</span>(Mcur)[-<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(A) == realLen1):<br>        <span class="hljs-keyword">break</span><br><br>A = Matrix(GF(<span class="hljs-number">2</span>), A)<br>vecb = vector(GF(<span class="hljs-number">2</span>), vecb)<br>Ainv = (A.T)**(-<span class="hljs-number">1</span>)<br>inistat1v = (vecb*Ainv)<br><br>inistat1s = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(inistat1v)):<br>    inistat1s += <span class="hljs-built_in">str</span>(inistat1v[i])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, lowbit(m1).bit_length()):<br>    inistat1s += <span class="hljs-built_in">str</span>(inistat1v*(M**i)[-<span class="hljs-number">1</span>])<br><br>inistat1 = <span class="hljs-built_in">int</span>(inistat1s, <span class="hljs-number">2</span>)<br>inistat0 = <span class="hljs-built_in">int</span>(inistat0, <span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(lowbit(m0), lowbit(m1))<br><span class="hljs-built_in">print</span>(inistat0, inistat1)<br><span class="hljs-built_in">print</span>(seed0Rec[T], seed1Rec[T])<br>nfsr.lfsr0.state = inistat0<br>nfsr.lfsr1.state = inistat1<br><br><span class="hljs-comment">#begin test part#</span><br><span class="hljs-comment"># sb=bytes.fromhex(hexMsg[T])</span><br><span class="hljs-comment"># print(len(sb),sb)</span><br><span class="hljs-comment"># C1=ciph</span><br><span class="hljs-comment"># C2=nfsr(sb).hex()</span><br><span class="hljs-comment"># print(C1==C2)</span><br><span class="hljs-comment">#end test part#</span><br><br>testout0 = []<br>testout1 = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">200</span>):<br>    judg = nfsr.lfsr0(<span class="hljs-number">1</span>)<br>    out1a = nfsr.lfsr1(<span class="hljs-number">8</span>)<br>    out1b = nfsr.lfsr1(<span class="hljs-number">8</span>)<br>    testout0.append(judg)<br>    testout1.append((out1a, out1b))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getByte</span>(<span class="hljs-params">andNum, andRes, orNum, orRes</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">if</span>((x &amp; andNum) == andRes <span class="hljs-keyword">and</span> (x | orNum) == orRes):<br>            <span class="hljs-keyword">return</span> x<br>    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getByte2</span>(<span class="hljs-params">andNum, andRes, orNum, orRes, pipeistr=<span class="hljs-literal">None</span></span>):<br>    C = []<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">if</span>((x &amp; andNum) == andRes <span class="hljs-keyword">and</span> (x | orNum) == orRes):<br>            C.append(x)<br>    <span class="hljs-keyword">return</span> C<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>): <span class="hljs-comment">#æ²¡åšåˆ°æœ€åäº†ï¼Œè¾“å‡º5ä¸ªï¼Œçœ‹çœ‹å¤šè§£çš„æƒ…å†µå§ã€‚</span><br>    pipeis = <span class="hljs-string">&#x27;&#x27;</span>.join(msg[i*<span class="hljs-number">8</span>:i*<span class="hljs-number">8</span>+<span class="hljs-number">8</span>])<br>    <span class="hljs-built_in">print</span>(pipeis)<br>    o1, o2 = testout1[i]<br>    r1, r2 = output[i]<br>    <span class="hljs-built_in">print</span>(o1, o2, r1, r2)<br>    <span class="hljs-keyword">if</span>(testout0[i] == <span class="hljs-number">0</span>):<br>        <span class="hljs-built_in">print</span>(testout0[i], (getByte2(o2, r2, o1, r1)),<br>              <span class="hljs-built_in">int</span>(hexMsg[T][i*<span class="hljs-number">2</span>:i*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>], <span class="hljs-number">16</span>))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(testout0[i], (getByte2(o1, r1, o2, r2)),<br>              <span class="hljs-built_in">int</span>(hexMsg[T][i*<span class="hljs-number">2</span>:i*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>], <span class="hljs-number">16</span>))<br><br></code></pre></td></tr></table></figure><p>é€ä¸€ä¸ªæ•°æ®ç”Ÿæˆå™¨çš„ä»£ç ï¼Œæ•°æ®ç”Ÿæˆå™¨çš„è¾“å‡ºæ–‡ä»¶å¯ä»¥ç›´æ¥è¢«ä¸Šè¿°ä»£ç importã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#datagen.py</span><br><span class="hljs-keyword">import</span> secrets<br><span class="hljs-keyword">from</span> utils <span class="hljs-keyword">import</span> nbit, LFSR, NFSR<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Generating Data...&quot;</span>)<br>hexEnc=[]<br>maskRec0=[]<br>maskRec1=[]<br>hexMsg=[]<br>seed0Rec=[]<br>seed1Rec=[]<br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">300</span>)):<br>        seeds = [secrets.randbits(nbit) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>        masks = [secrets.randbits(nbit) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>        lfsrs = [LFSR(seed, mask) <span class="hljs-keyword">for</span> seed, mask <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(seeds, masks)]<br>        nfsr = NFSR(*lfsrs)<br><br>        msg = secrets.token_bytes(<span class="hljs-number">200</span>)<br>        enc = nfsr(msg)<br>        hexEnc.append(enc.<span class="hljs-built_in">hex</span>())<br>        maskRec0.append(masks[<span class="hljs-number">0</span>])<br>        maskRec1.append(masks[<span class="hljs-number">1</span>])<br>        hexMsg.append(msg.<span class="hljs-built_in">hex</span>())<br>        seed0Rec.append(seeds[<span class="hljs-number">0</span>])<br>        seed1Rec.append(seeds[<span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;Testinput.py&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;hexEnc=&#125;</span>\n&#x27;</span>)<br>            f.write(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;maskRec0=&#125;</span>\n&#x27;</span>)<br>            f.write(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;maskRec1=&#125;</span>\n&#x27;</span>)<br>            f.write(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;seed0Rec=&#125;</span>\n&#x27;</span>)<br>            f.write(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;seed1Rec=&#125;</span>\n&#x27;</span>)<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;Testans.py&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;hexMsg=&#125;</span>\n&quot;</span>)<br><br><span class="hljs-keyword">except</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Not this time&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>æœ€ç»ˆè¿è¡Œç»“æœï¼Œå¯ä»¥å‘ç°æœ€åå‡ºç°äº†å¤šè§£ï¼Œè€Œæ­£ç¡®æ˜æ–‡çš„å€¼æ°å¥½æ˜¯å…¶ä¸­ä¸€ä¸ªè§£ï¼Œå› æ­¤æœ¬é¢˜æ¦‚ç‡æ€§åœ°æ¢å¤äº†seedä¹Ÿç®—æ˜¯åšæˆåŠŸäº†ã€‚</p><img src="/2024/10/23/SUSCTF2024/9-2.png" alt="9-2" style="zoom:80%;"><h2 id="10-æ€»ç»“"><a href="#10-æ€»ç»“" class="headerlink" title="10. æ€»ç»“"></a>10. æ€»ç»“</h2><p>ä¸¤å¹´æ²¡æ‰“CTFäº†ï¼Œä»¥å‰ä¸€èµ·æ‰“CTFçš„é˜Ÿå‹åŸºæœ¬ä¸Šéƒ½æ‰¾åˆ°äº†å¾ˆå¥½çš„å·¥ä½œï¼Œä¸è¿‡è¿˜å¥½ï¼Œè‡ªå·±ä¹Ÿæœ€ç»ˆé ç€4.43çš„GPAä¿ç ”åˆ°äº†SEUï¼Œä¹Ÿç®—æ˜¯å¤§å­¦å·G.å·äº†3å¹´çš„ç»“æœå§ã€‚</p><p>å¤§å››ä¿ç ”åï¼Œå‰å‰ååç©äº†12ä¸ªåŸå¸‚ï¼Œä¸œå—è¥¿åŒ—éƒ½è·‘äº†ä¸€è¶Ÿï¼Œä¹Ÿç®—æ˜¯ç©å¾—å°½å…´äº†å§ã€‚ç°åœ¨è§‰å¾—ç”µå­æ¸¸æˆå°±æ˜¯ä¸€å †æ•°æ®ï¼Œåœ¨å—äº¬ç©å’Œå‡ºå—äº¬æ—…æ¸¸éƒ½æ²¡æ„æ€äº†ï¼Œç»§ç»­å¼€å·ï¼</p><p>åœ¨ç ”ç©¶ç”Ÿé˜¶æ®µï¼Œèƒ½å¤Ÿåœ¨SUSç»§ç»­å’Œå¿—åŒé“åˆçš„æœ‹å‹ä¸€èµ·æ‰“CTFï¼Œè®¨è®ºæŠ€æœ¯ï¼Œå…¶å®ä¹ŸæŒºä¸é”™çš„ï¼Œäº‰å–æŠŠCTFæ¡å›æ¥ã€‚</p><p>è€ƒè™‘åˆ°è‡ªå·±è¯»åšæ¦‚ç‡ä¸é«˜ï¼Œå› æ­¤ç ” 1 å…ˆä»¥åšé¡¹ç›®å’Œæ‰“ç«èµ›ä¸ºä¸»å§ã€‚ç ” 2 äº‰å–èƒ½å‘ 2 ç¯‡è®ºæ–‡ï¼ˆå“ï¼Œæ²¡ç§‘ç ”ç»å†ä¿ç ”æ˜¯çœŸä¼¤ï¼Œé¢è¯•æ—¶è€å¸ˆé—®äº†æˆ‘å¾ˆå¤šå¾ˆéš¾çš„å¯†ç å­¦é—®é¢˜ï¼Œæˆ‘éƒ½ç­”ä¸Šæ¥äº†ï¼Œç»“æœSEUä¼˜è¥è¿˜æ²¡è¿›å‰100ï¼Œæœ€åé€’è¡¥ä¸Šäº†å­¦ç¡•ï¼‰<del>ç¬‘æ­»ï¼Œå»å¹´SEUä¿ç ”ç©¿äº†ï¼Œä»Šå¹´ä¿ç ”åˆç©¿äº†ï¼Œ300+åçš„ä¸€ä¸ªå­¦å¦¹é€’è¡¥ä¸Šäº†</del>ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason4</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0xGame2021PartCrypto</title>
    <link href="/2021/10/25/0xGame2021PartCryptoDiv1/"/>
    <url>/2021/10/25/0xGame2021PartCryptoDiv1/</url>
    
    <content type="html"><![CDATA[<h1 id="0xGameéƒ¨åˆ†Cryptoé¢˜ç›®å‡ºé¢˜æ‰‹è®°"><a href="#0xGameéƒ¨åˆ†Cryptoé¢˜ç›®å‡ºé¢˜æ‰‹è®°" class="headerlink" title="0xGameéƒ¨åˆ†Cryptoé¢˜ç›®å‡ºé¢˜æ‰‹è®°"></a>0xGameéƒ¨åˆ†Cryptoé¢˜ç›®å‡ºé¢˜æ‰‹è®°</h1><h2 id="Week-1"><a href="#Week-1" class="headerlink" title="Week 1"></a>Week 1</h2><h3 id="1-MyFunction"><a href="#1-MyFunction" class="headerlink" title="1: MyFunction"></a>1: MyFunction</h3><p>é¢˜ç›®åŠ å¯†ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> log<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x*log(x) <span class="hljs-comment">#log(x) is &quot;y=ln(x)&quot; used in maths</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    <span class="hljs-built_in">print</span>(f(<span class="hljs-built_in">ord</span>(i)))<br><span class="hljs-comment">#è¾“å‡ºéƒ¨åˆ†ç•¥å»</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜ç›®å‡ºçš„ç›®çš„æ˜¯è®©æ–°ç”Ÿç†Ÿæ‚‰ä¸€ä¸‹Pythonçš„ä»£ç ï¼Œé¡ºä¾¿é€šè¿‡ä¸€ä¸ªç®€å•çš„pythonä»£ç ï¼Œäº†è§£ä¸€ä¸‹pythonçš„åŸºæœ¬è¯­æ³•ï¼Œæ˜¯æ¨¡ä»¿çš„è¥¿ç”µçš„æ–°ç”Ÿèµ›å‡ºçš„ã€‚è¥¿ç”µçš„æ–°ç”Ÿèµ›å‡ºçš„ç”¨çš„å‡½æ•°æ˜¯$y&#x3D;e^x$ï¼Œä¹Ÿç»™å‡ºäº†å¾ˆå¤šæ•°å­—ã€‚å› ä¸º$y&#x3D;e^x$æœ‰å¾ˆæ˜æ˜¾çš„åå‡½æ•°ï¼Œæ‰€ä»¥é‚£ä¸ªé¢˜å¯ä»¥ç›´æ¥å¯¹æ‰€æœ‰çš„è¾“å‡ºå–å¯¹æ•°ï¼Œå°±å¯ä»¥è·å¾—æ˜æ–‡ã€‚ä½†è¿™ä¸ªé¢˜ç›®ä¸è¡Œï¼Œå› ä¸º$y&#x3D;x\ln x$æ²¡æœ‰å¯ä»¥å†™å‡ºæ¥çš„åå‡½æ•°å½¢å¼<del>åˆ«é—®ï¼Œå› ä¸ºæˆ‘æ•°å­¦ä¸è¡Œï¼Œæˆ‘æ±‚ä¸å‡ºæ¥</del>ã€‚å› æ­¤è¿™ä¸ªé¢˜ç›®çš„æ­£ç¡®åšæ³•æ˜¯æšä¸¾å¯èƒ½çš„å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> log<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x*log(x)<br><br>arr=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>).readlines()<br>s=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> arr:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">128</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(f(i)-<span class="hljs-built_in">float</span>(y))&lt;<span class="hljs-number">0.0003</span>:<br>            s+=<span class="hljs-built_in">chr</span>(i)<br>            <span class="hljs-keyword">continue</span><br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-comment">#0xGame&#123;YouH4veKn0wedPy7honL081s&lt;y=ln(x)&gt;InM47hs&#125;</span><br></code></pre></td></tr></table></figure><p>ä¸è¿‡å®é™…çš„è§£é¢˜ä¸­ï¼ŒçœŸæ­£å†™è„šæœ¬çš„æ–°ç”Ÿå¹¶ä¸å¤šï¼Œæœ‰çš„æ˜¯é€šè¿‡excelæ‰“è¡¨ï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªè§£çš„ã€‚æŠŠæ‰€æœ‰çš„$x$æ±‚å‡ºæ¥ä¹‹åï¼Œç„¶åæŸ¥ASCIIç è¡¨ä¸€ä¸ªä¸€ä¸ªæ‰‹åŠ¨å¯¹ç…§çš„ã€‚</p><p>ä¹‹å‰éªŒé¢˜çš„æ—¶å€™ï¼Œæˆ‘è€ƒè™‘åˆ°äº†æµ®ç‚¹è¯¯å·®ï¼Œå› æ­¤è¿™è¾¹ç”¨çš„æ˜¯<code>abs(f(i)-float(y))&lt;0.0003</code>åˆ¤æ–­çš„ã€‚å®é™…ä¸Šåœ¨$x&gt;40$çš„æ—¶å€™ï¼Œ$(x+1)\ln(x+1)-x\ln x$çš„å·®å€¼å·²ç»è¶…è¿‡äº†$2$ã€‚å› æ­¤ç›´æ¥å–æ•´ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä¸è¿‡æœ€åæˆ‘å‘ç°ä¸è€ƒè™‘æµ®ç‚¹è¯¯å·®çš„é—®é¢˜ç…§æ ·ä¹Ÿæ˜¯å¯ä»¥åšçš„ã€‚</p><h3 id="2-Class-8"><a href="#2-Class-8" class="headerlink" title="2.Class 8"></a>2.Class 8</h3><p>ä¸€ä¸ªäº‰è®®æ€§æŒºå¤§çš„é¢˜ç›®ã€‚å› ä¸ºå½“æ—¶å‡ºé¢˜çš„æ—¶å€™ï¼Œæˆ‘å¹¶ä¸æƒ³å‡ºå¤å…¸å¯†ç é¢˜â€”â€”å±å®æ²¡æ„æ€ã€‚ä½†æ—¢ç„¶è¦æ±‚å‡ºä¸€ä¸ªå¤å…¸å¯†ç ï¼Œé‚£å°±åªèƒ½å‡ºä¸€ä¸ªã€‚ã€‚</p><p>æœ€åå‡ºé¢˜çš„æ—¶å€™ç¡®å®æ˜¯å‡ºéš¾äº†ï¼Œè™½ç„¶To1iné‚£ä¸ªManyCodeé‚£ä¸ªé¢˜ä¹Ÿå‡ºéš¾äº†ï¼Œä½†ä»–æœ€åç®€åŒ–äº†ï¼Œç„¶åæˆ‘çœ‹åˆ°å½“æ—¶å·²ç»æœ‰2ã€3ä¸ªäººè§£å‡ºæ¥äº†ï¼Œå°±æ²¡æœ‰ç®€åŒ–ã€‚å…«ç§å¤å…¸å¯†ç æ”¾åœ¨ä¸€èµ·ã€‚æœ‰çš„è¿˜æœ‰æ­§ä¹‰ã€‚ã€‚ã€‚ï¼ˆä¸è¿‡è™½ç„¶è¿˜æ˜¯æœ‰å­¦å¼Ÿæ²¡æœ‰è·Ÿæˆ‘äº¤æµï¼Œä¹Ÿåšå‡ºæ¥äº†ã€‚</p><p><img src="/2021/10/25/0xGame2021PartCryptoDiv1/Class8.png" alt="Class8"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs">ç¬¬1ã€6ä½æ˜¯ç›²æ–‡<br>ç¬¬2ã€7ä½æ˜¯è·³èˆçš„å°äºº<br>ç¬¬3ä½æ˜¯çŒªåœˆå¯†ç <br>ç¬¬4ã€11ã€16ä½æ˜¯æ‰‹æœºä¹é”®é”®ç›˜<br>ç¬¬5ã€9ã€14ä½æ˜¯è«å°”æ–¯ç”µç <br>ç¬¬8ã€12ä½æ˜¯é“¶æ²³å­—æ¯<br>ç¬¬10ã€15ä½æ˜¯åŸ¹æ ¹å¯†ç <br>ç¬¬13ä½æ˜¯ç”µè„‘é”®ç›˜ï¼Œcfgbä¹‹é—´å›´ç€çš„æ˜¯V<br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ä¸€å¼€å§‹æ‰“ç®—å‡ºè§„åˆ™çš„å•è¯çš„ï¼Œä½†åé¢å°±å‡ºå¾—ä¸è§„åˆ™äº†ã€‚ä¸»è¦æ˜¯ç¬¬13ä½ã€ç¬¬15ä½å‡ºé—®é¢˜å‡ºå¾—éå¸¸å¤šã€‚ç¬¬15ä½ç¡®å®æœ‰ä¸¤ç§è§£æ³•ï¼Œå› æ­¤ç¬¬15ä½æ˜¯ <code>O</code> æœ€åä¹Ÿç®—å¯¹äº†ã€‚</p><p>flag: <code>0xGame&#123;CLASSLNRDDLDVTNB&#125;</code> æˆ–<code> 0xGame&#123;CLASSLNRDDLDVTOB&#125;</code></p><p><del>ä»¥åå†ä¹Ÿä¸å‡ºè¿™ç§æ— èŠçš„å¤å…¸å¯†ç é¢˜äº†ã€‚ã€‚ã€‚ã€‚</del></p><h3 id="3-ABC-Of-RSA"><a href="#3-ABC-Of-RSA" class="headerlink" title="3.ABC Of RSA"></a>3.ABC Of RSA</h3><p>è¿™ä¸ªé¢˜ä¸»è¦æ˜¯ç”¨äºç»™æ–°ç”Ÿå…¥é—¨ä¸€ä¸‹RSAç›¸å…³çŸ¥è¯†ã€‚ã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf">åœ¨RSAåŠ å¯†ä¸­ï¼Œå·²çŸ¥ï¼š<br><span class="hljs-attribute">p</span><span class="hljs-operator">=</span><span class="hljs-number">9677</span><br><span class="hljs-attribute">q</span><span class="hljs-operator">=</span><span class="hljs-number">9241</span><br><span class="hljs-attribute">e</span><span class="hljs-operator">=</span><span class="hljs-number">10009</span><br>æ±‚è§£å¯†æŒ‡æ•°dï¼ŒåŒ…ä¸Š<span class="hljs-number">0</span>xGame&#123;&#125;æäº¤ã€‚<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå¦‚æœä¸‹è½½Pythonçš„å¯†ç å­¦ä¸“ç”¨åŒ…ï¼Œå†™èµ·æ¥ä¼šéå¸¸å¿«ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p=<span class="hljs-number">9677</span><br>q=<span class="hljs-number">9241</span><br>e=<span class="hljs-number">10009</span><br><span class="hljs-built_in">print</span>(inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)))<br><span class="hljs-comment">#39982249</span><br></code></pre></td></tr></table></figure><p>ä¸è¿‡å‘ç°å¾ˆå¤šå­¦å¼Ÿå­¦å¦¹æ²¡æœ‰è£…åŒ…çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨$ed&#x3D;k\phi+1$ï¼Œæš´åŠ›æšä¸¾$k$çš„ã€‚è¿™ä¸ªè™½ç„¶è¿™é“é¢˜æ˜¯å¯è¡Œçš„ã€‚ä½†ä¸‹ä¸€ä¸ªé¢˜ï¼Œå½“æ•°å­—å¤§èµ·æ¥çš„æ—¶å€™ï¼Œå°±æ˜¾å¾—ä¸å¯è¡Œäº†ã€‚ã€‚</p><h3 id="4-BlackGiveRSA"><a href="#4-BlackGiveRSA" class="headerlink" title="4.BlackGiveRSA"></a>4.BlackGiveRSA</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag,p,q<br><span class="hljs-keyword">assert</span> q&gt;p <br>n=p*q<br>e=<span class="hljs-number">10007</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)==<span class="hljs-number">42</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>    m=bytes_to_long(flag[i*<span class="hljs-number">7</span>:i*<span class="hljs-number">7</span>+<span class="hljs-number">7</span>])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m,e,n))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Encryption using modulus n=&quot;</span>,n)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">OutPut:</span><br><span class="hljs-string">1150947306854980854</span><br><span class="hljs-string">243703926267532432</span><br><span class="hljs-string">1069319314811079682</span><br><span class="hljs-string">688582941857504686</span><br><span class="hljs-string">670683629344243145</span><br><span class="hljs-string">1195068175327355214</span><br><span class="hljs-string">Encryption using modulus n= 1687126110378632809</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>RSAå…¥é—¨é¢˜ï¼Œç›´æ¥æ”¾åˆ°yafu&#x2F;factordbä¸Šåˆ†è§£å‡º$p&#x3D;1175078221,q&#x3D;1435756429$ï¼Œåˆ†åˆ«æ˜¯Am4çš„QQå’Œè‡ªå·±çš„QQå·ã€‚ã€‚</p><p>ç„¶åç›´æ¥æŒ‰ç…§RSAçš„è§£å¯†æ–¹æ³•åˆ†è§£å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p,q=<span class="hljs-number">1175078221</span>,<span class="hljs-number">1435756429</span><br>n,phi=p*q,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=inverse(<span class="hljs-number">10007</span>,phi)<br>cipher=[<br>    <span class="hljs-number">1150947306854980854</span>,<br>    <span class="hljs-number">243703926267532432</span>,<br>    <span class="hljs-number">1069319314811079682</span>,<br>    <span class="hljs-number">688582941857504686</span>,<br>    <span class="hljs-number">670683629344243145</span>,<br>    <span class="hljs-number">1195068175327355214</span><br>    ]<br>m=<span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> cipher:<br>    m+=long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n))<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-comment">#0xGame&#123;ChuTiRenDeQQShiJiShangJiuShiQDeZhi&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Week-2"><a href="#Week-2" class="headerlink" title="Week 2"></a>Week 2</h2><h3 id="Equation"><a href="#Equation" class="headerlink" title="Equation"></a>Equation</h3><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">è§£æ–¹ç¨‹é¢˜ï¼ŒRSAåŠ å¯†ï¼Œæ²¡æœ‰é™„ä»¶ï¼Œè¿œç¨‹è¿æ¥ä¸€æ¬¡è¿‡å»å°±å¯ä»¥æ¥æ”¶åŠ å¯†æ•°æ®ã€‚è§£å‡ºæ¥çš„æ˜æ–‡ç»“æœè¦long_to_bytes<br>p,qâˆˆ(<span class="hljs-number">2</span>**<span class="hljs-number">1407</span>,<span class="hljs-number">2</span>**<span class="hljs-number">1408</span>) <br>nc <span class="hljs-number">47.101</span><span class="hljs-number">.38</span><span class="hljs-number">.213</span> <span class="hljs-number">60718</span><br><span class="hljs-symbol">Author:</span>huangx607087<br><span class="hljs-symbol">QQ:</span><span class="hljs-number">1435756429</span><br></code></pre></td></tr></table></figure><p>linuxè™šæ‹Ÿæœºä¸­ï¼Œç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥<code>nc 47.101.38.213 60718</code> ï¼Œå¯ä»¥è·å¾—$n,e,c,f$ï¼Œå…¶ä¸­$f&#x3D;ap+bq$ã€‚</p><p>ï¼ˆå½“ç„¶ï¼Œæœ¬é¢˜ä¸ºé˜²ä½œå¼Šï¼Œæ¯æ¬¡è¿æ¥åå‘å‡ºçš„$a,b$å†…å®¹éƒ½ä¸ä¸€æ ·ï¼Œä½†$f&#x3D;ap+bq$çš„æ ¼å¼æ˜¯è‚¯å®šçš„ï¼Œä½ è·å–çš„ ç³»æ•°å¯èƒ½ä¸æ­¤ä¸åŒï¼Œä½†ä¸å½±å“è§£é¢˜ï¼‰ã€‚</p><p>éšæœºè¿æ¥ä¸Šå»ï¼Œè·å–ä¸€ç»„æ•°æ®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">n =<br><span class="hljs-number">32366272889292879088882195998253721958216118427319043123590736165426820884306499725050727749537295796623781690886255268016096819542474814457437532341958464848643200659916387692563367270923362263462485626863278634698636219570995613163637857962196938268241034329466928075048970301826587646917598116612437415879221437295531628513384414258368369916946742389703355179727112580592683439416261547865491725025586248605272291584028774967553627942724579632389254496409849216841409604686980557654983994405692268823696566554514932549687234389560838939048535333918846662927374585386766723838290671937789073306966759191649325746073717288252462817952734597692830994622255635546908058581524477518532518924112976563197010192251929746445312969880127879576958492529042343256141675368594461418257288354657105617752796615735654975200326101463143024542800708390095145361</span><br>e = <span class="hljs-number">906371</span><br>c =<br><span class="hljs-number">15326438748659000169738486078886997781541935909035823368289334280968233481809714574428064879237827914760740438396085818400100752918474657858554388771724064383701395897618045276281398824434274848557653909089994244435972710632336639335300023667869547648881808002952139588112935030846125601449819192271492110196773991802015580978532663199706950910343070008368979693052990985227852719668245569238857908655227385682414319846321429428810022909530050444105837210601614933221417662986725539709495237298445020038006845869543594704774018595363714269915863872404761678621066244387220449270355482924374014811790125751689511923646410269665459941400645007655696532244986604521949477159649748754760874919743902307824198126893002486445262315126416725774433901321311453440889692050265638750239216391568288836776466397695369910655394827082589725264284100323144743368</span><br>f = <span class="hljs-number">4071</span> * p + <span class="hljs-number">7840</span> * q = <span class="hljs-number">70609572383507708646716591625555712379946460153989879089689539734922903656784859764618771054881882855097217363252911229485210947514270593649999198018427595733868497208821457315913778178532267217419587556519640009047854707649751663514017094626487619210733938544175505589938842947647526503757953723232894419183885106501307587792888770406913619606926851412157084401688469130571174114717305950501097282446764439401475500746719477183</span><br></code></pre></td></tr></table></figure><h4 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h4><p>æœ‰Sagemathçš„ï¼Œå½•å…¥4ä¸ªå·²çŸ¥æ•°æ®åï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨ä»¥ä¸‹çš„ä»£ç æ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">var(<span class="hljs-string">&#x27;p q&#x27;</span>)<br>solve([p * q == n, <span class="hljs-number">4071</span> * p + <span class="hljs-number">7840</span> * q == f],(p, q))<br></code></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥è§£å‡ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">p == <span class="hljs-number">5083858928708691100777959116505887333680880438073587959441589817260857392095426280573595409516065652457557087257582498766032467943842309357363106558257787135298633883829312431320375735688577512605869266440855676882837431188700856046398782182742328211552394159944490832515415689088811946496781884336421281783780403089383634369539994631626195420357561861396522278697114564263369128050977173067291911354418900362132140587209993</span><br>q == <span class="hljs-number">6366477383256967751970602048757684316904540292167385523826891274088514440505660634745365324329334130604911028192256744516414894198327621461246682553540834732916805952519429388776598030426539306581772164902923029140028510877621234508817302597008112380293895652938964720761299193541705748669586055114709614928841209888319746463583093400709614547276940953368857424121494354522321223778287994763284682566699629595310657706146377</span><br></code></pre></td></tr></table></figure><h4 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h4><p>æ²¡æœ‰Sagemathçš„ï¼Œå¯ä»¥ç¼–ç¨‹æ±‚è§£ã€‚</p><p>ç”±äº$pq&#x3D;n,4071p+7840q&#x3D;f$ï¼Œå› æ­¤$4071p&#x3D;f-7840q$ï¼Œç„¶åæœ‰$4071n&#x3D;4071pq&#x3D;(f-7840q)q$ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ æ–¹ç¨‹$7840x^2-fx+4071n&#x3D;0$ï¼Œæ ¹æ®äºŒæ¬¡å‡½æ•°å¯¹ç§°è½´çš„ä½ç½®ï¼Œå‘ç°æˆ‘ä»¬éœ€è¦çš„å€¼ä½äºå¯¹ç§°è½´å³ä¾§ã€‚å› æ­¤æˆ‘ä»¬ç›´æ¥äºŒåˆ†æ±‚è§£å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">y</span>(<span class="hljs-params">x</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-number">7840</span>*x*x-f*x+<span class="hljs-number">4071</span>*n<br>L, R = <span class="hljs-number">2</span>**<span class="hljs-number">1407</span>, <span class="hljs-number">2</span>**<span class="hljs-number">1408</span><br><span class="hljs-keyword">while</span> L &lt;= R:<br>M = (L+R)//<span class="hljs-number">2</span><br><span class="hljs-keyword">if</span> y(M) &lt; <span class="hljs-number">0</span>:<br>L = M+<span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> y(M) &gt; <span class="hljs-number">0</span>:<br>R = M-<span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> y(M) == <span class="hljs-number">0</span>:<br><span class="hljs-built_in">print</span>(M)<br><span class="hljs-keyword">break</span><br><span class="hljs-comment">#6366477383256967751970602048757684316904540292167385523826891274088514440505660634745365324329334130604911028192256744516414894198327621461246682553540834732916805952519429388776598030426539306581772164902923029140028510877621234508817302597008112380293895652938964720761299193541705748669586055114709614928841209888319746463583093400709614547276940953368857424121494354522321223778287994763284682566699629595310657706146377</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜ç›®è¿˜å¯ä»¥ç”¨z3åšã€‚ä¸è¿‡å¾ˆå¤šäººçš„æ€è·¯æ˜¯æ ¹æ®äºŒæ¬¡æ–¹ç¨‹æ±‚æ ¹å…¬å¼ï¼Œæƒ³è¦æ±‚$\sqrt{b^2-4ac}$çš„å€¼ã€‚è€Œè¿™ä¸ªå€¼ä¹Ÿå¯ä»¥é€šè¿‡å‡½æ•°çš„å•è°ƒæ€§ï¼ŒäºŒåˆ†æ±‚è§£ã€‚ã€‚</p><h2 id="Week-3"><a href="#Week-3" class="headerlink" title="Week 3"></a>Week 3</h2><h3 id="CryptoSignin3"><a href="#CryptoSignin3" class="headerlink" title="CryptoSignin3"></a>CryptoSignin3</h3><p>é¢˜ç›®æ˜¯ç»™å‡ºäº†RSAåŠ å¯†ä¸­çš„$e,n,c$ï¼Œè®©ä½ æ±‚å‡º$5m$çš„åŠ å¯†ç»“æœï¼ˆé»˜è®¤$c$æ˜¯$m$çš„åŠ å¯†ç»“æœï¼‰ã€‚</p><p>è¿™é“é¢˜ä¸»è¦è€ƒå¯ŸRSAçš„ä¹˜æ³•åŒæ€æ€§ï¼Œç”±äº$m^e \equiv c \pmod n$ï¼Œå› æ­¤æˆ‘ä»¬æœ‰<br>$$<br>(5m)^e\equiv 5^em^e\equiv 5^ec \pmod n<br>$$<br>å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—$5^{e}c \mod n$çš„å€¼å³å¯ã€‚ç„¶åè½¬ä¸€ä¸‹<code>str</code>ç±»å‹ï¼Œå–æœ€å25ä½å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">2422711508900009723470102727278184898228579351729629175495904760516536114771819178772843940622693480942295987032442940867670858858530606887743557817380121361626756206355705110299827107648704348792184242506797212331641569408152865458082131811787893384573565771304686373397987779236692592582009393836324438173880350455958049987506807351970912049246353746635267159741115761548052126938491673479606393396100458729618059852813438444299361468512008386975558106274324688665963516424534366163011821633197140729560513838981241752422348968312410911097523311183305812013220724215584901550592570168096761576532621840320623463208702401829189862290303098674021012353400081288819532365151476738751064469957971192132666136590103567843662591585345483671185892760751481722342403025068374371716176981888876927119331602694699049322860285991375002326127401769287658952682585275891296760732815680898653162425658904911584903825163141576325803464119867837508173795728753701563149748508464162635777787788266240105654089919642728171076155284842273517797069725130328742992830894075552022372717019366081516680737</span><br>e=<span class="hljs-number">10007</span><br>c=<span class="hljs-number">1285901843278876234855607310979623200548989981628646673003523113580651626686523566799395153922258813222744927018205882436414589516795415393990321785993777190284046937462277341231780571523062023964463963139910673601962881978696384360480028132774373962893042697866284303407898274683337284548529324550392212212259945699167254341062208031468355814520907121576009140399280898693924706067921614961798886587174234822238887374399666546113213239071736098162263227821798099750616137755055435397986788792824117529508255014392344357337010003489080209442530630893119917536518243474797351694663533728052713570044084663268350004738561234330890283895430742958255842196396542672482459665354739161276178850775803757753274712331067038077233072381051447436014423088822190073982228377699578821863871042501139434131053044240618505423456248872825597521393564957261041606004454706987978944644129728005540587982321571481413548381251589071459468890948819121023006292105804319208332473499823959882524985324120811768843639294924500467781666073366713198751960913508720530656411097981933156605831180926219778514434</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">5</span>,e,n)*c%n)[-<span class="hljs-number">25</span>:])<br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸ºï¼š<code>8489769636593649908538102</code>ï¼Œå› æ­¤flagä¸º<code>0xGame&#123;8489769636593649908538102&#125;</code></p><p>RSAçš„åŒæ€æ€§æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„çŸ¥è¯†ç‚¹ï¼Œåœ¨å¯ä»¥è·å¾—è§£å¯†æœåŠ¡çš„æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥åˆ©ç”¨RSAçš„åŒæ€æ€§ï¼Œå‘é€$2^ec,3^ec,â€¦$ç­‰ç»“æœï¼Œè·å–è§£å¯†æœåŠ¡ï¼Œè¿›è€Œè·å–æ˜æ–‡çš„ä¸€äº›æ€§è´¨ï¼Œæ¯”å¦‚$2m$çš„æƒ…å†µã€$3m$çš„æƒ…å†µç­‰ç­‰ã€‚æ¯”å¦‚ç¬¬å››å‘¨çš„ParityOracleBase5å°±æ˜¯ç”¨åˆ°äº†è¿™ä¸ªçš„ç®—æ³•</p><p>å‡ºè¿™ä¸ªé¢˜çš„åŸå› ï¼Œæ˜¯å› ä¸ºå»å¹´çš„0xGameå°±æ˜¯å› ä¸ºå…ˆå‡ºäº†ParityOracleï¼Œç„¶åå‡ºäº†ä¸ªSigninRSAï¼Œç›´æ¥å¯¼è‡´è‡ªå·±æ ¹æœ¬å°±æ²¡æ„è¯†åˆ°$2^ec$çš„è§£å¯†ç»“æœæ˜¯$2m$ã€‚ã€‚ã€‚</p><p>è™½ç„¶è¿™ä¸ªé¢˜è§£å‡ºæ¥çš„äººæŒºå¤šï¼Œä½†è¿™ä¸ªé¢˜æ˜¯ä¸ºäº†ç»™ä¸‹å‘¨çš„ParityOracleBase5åšå‡†å¤‡ç”¨çš„ã€‚ã€‚</p><h3 id="Predict-1"><a href="#Predict-1" class="headerlink" title="Predict 1"></a>Predict 1</h3><p>ä¸€ä¸ªæ±‚LCGå‚æ•°çš„é¢˜ç›®ã€‚</p><p>æ ¹æ®é¢˜ç›®çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æœ‰19æ¬¡æœºä¼šå¯ä»¥è·å¾—é‡Œé¢çš„stateï¼Œç„¶åå†è¿›è¡Œé¢„æµ‹ã€‚ä½†å®é™…ä¸Šï¼Œä¸€èˆ¬è·å–8ç»„æ•°æ®ï¼Œå°±å¯ä»¥è·å–$a,b,p$çš„å€¼ï¼ˆæ­¤å¤„ä¿è¯äº†$a,p$æ˜¯ç´ æ•°ï¼‰ã€‚å½“ç„¶ä¸ºäº†ä¿é™©ï¼Œ15ç»„æ•°æ®ä¹Ÿæ˜¯è¶³å¤Ÿçš„ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬è·å–çš„æ•°å­—ä¸º$x_1,x_2,â€¦,x_8$ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æœ‰ï¼š<br>$$<br>x_i\equiv ax_{i-1}+b \pmod p<br>$$<br>é‚£ä¹ˆåŒ–ç®€ä¸€ä¸‹ï¼Œå°±æ˜¯ï¼š<br>$$<br>x_2\equiv ax_1+b\pmod p \tag1<br>$$</p><p>$$<br>x_3\equiv  ax_2+b\pmod p\tag 2<br>$$</p><p>$$<br>x_4\equiv  ax_3+b \pmod p \tag 3<br>$$</p><p>ç„¶åï¼Œç”±$(2)-(1),(3)-(2)$ï¼Œæ¶ˆå»$b$ï¼Œå¯ä»¥å¾—åˆ°ï¼š<br>$$<br>x_3-x_2\equiv a(x_2-x_1)\pmod p \tag{S1}<br>$$</p><p>$$<br>x_4-x_3\equiv a(x_3-x_2)\pmod p \tag{S2}<br>$$</p><p>ç”±äºåœ¨$\mod p$çš„æ¡ä»¶ä¸‹ï¼Œé™¤å·è¡¨ç¤ºä¹˜ä¸ŠæŸä¸ªæ•°çš„é€†å…ƒï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æŠŠ$a$æå‡ºæ¥ï¼Œå°±æ˜¯<br>$$<br>a\equiv \dfrac{x_3-x_2}{x_2-x_1}\equiv \dfrac{x_4-x_3}{x_3-x_2} \pmod p \tag{T}<br>$$<br>${(T)}$ä¸­æ¶ˆå»$a$ï¼Œå»åˆ†æ¯ï¼Œå¾—ï¼š<br>$$<br>(x_3-x_2)^2\equiv(x_4-x_3)(x_2-x_1) \pmod p \tag{R1â€™}<br>$$<br>å»æ‰åŒä½™å·ä¹Ÿå°±æ˜¯<br>$$<br>(x_3-x_2)^2-(x_4-x_3)(x_2-x_1) &#x3D;D_1p \tag{R1}<br>$$<br>ç„¶åï¼Œç”±æ­¤å¯çŸ¥ï¼š<br>$$<br>(x_4-x_3)^2-(x_5-x_4)(x_3-x_2) &#x3D;D_2p \tag{R2}<br>$$<br>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¤šä¸ªæ•°æ®$\text{(R1)(R2)(R3)(R4)(R5)}$ï¼Œç„¶åè®¡ç®—æ‰€æœ‰ç»“æœå¾—æœ€å¤§å…¬å› æ•°å°±å¯ä»¥å¾—åˆ°$p$ã€‚(ä¸€èˆ¬7ä¸ªå€¼æ±‚å‡ºæ¥çš„å‡†ç¡®åº¦å°±æ¯”è¾ƒé«˜äº†)</p><p>$p$å¾—åˆ°ä¹‹åï¼Œæˆ‘ä»¬æ ¹æ®æ¶ˆå»$b$çš„å¼å­ï¼Œå°±å¯ä»¥è®¡ç®—å‡º$a\equiv \dfrac{x_3-x_2}{x_2-x_1} \pmod p$äº†ã€‚æ±‚å‡º$a$ä»¥åï¼Œå°±å¯ä»¥æ ¹æ®$x_1,x_2$å¾ˆå¿«åœ°æ±‚å‡º$b$ã€‚</p><p>åœ¨æ•´ä¸ªåšé¢˜çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½æœ‰äººæŸ¥çœ‹äº†ç™¾åº¦çš„æ–¹æ³•ï¼Œç»“æœåˆ°æœ€åé¢„æµ‹é”™äº†ã€‚åŸå› å¾ˆç®€å•ï¼šå› ä¸ºè¿™è¾¹åªæ˜¯æœ‰$\gcd(D_1p,D_2p)$ï¼Œè™½ç„¶$p$æ˜¯ä¸€å®šçš„ï¼Œä½†$\gcd(D_1,D_2)$çš„å€¼å´ä¸ä¸º$1$ã€‚æœ‰ä¸¤ç§åŠæ³•è§£å†³ï¼šä¸€æ˜¯å¤šé€‰å–å‡ ç»„æ•°æ®ï¼Œæ±‚å…¬çº¦æ•°æ›´ä¿é™©ï¼ŒäºŒæ˜¯æˆ‘æµ‹äº†ä¸€ä¸‹ï¼Œ$\gcd(D_1,D_2)$çš„å€¼å®é™…ä¸Šå¹¶ä¸å¤§ï¼ˆå¾ˆå¤§æ¦‚ç‡å°äº$1000$ï¼‰ï¼Œå› æ­¤å¯ä»¥å†™ä¸ª$2$åˆ°$999$çš„å¾ªç¯ï¼Œå°†$\gcd(D_1p,D_2p)$é‡Œé¢å¤šä½™çš„å› æ•°é™¤æ‰å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>sh=remote(<span class="hljs-string">&quot;47.101.38.213&quot;</span>,<span class="hljs-number">60709</span>)<br>u,detla=[],[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    sh.recvuntil(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    sh.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    sh.recvuntil(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    sh.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    numb=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    numb=numb.split(<span class="hljs-string">b&quot;is&quot;</span>)[<span class="hljs-number">1</span>]<br>    u.append(<span class="hljs-built_in">int</span>(numb))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>):<br>    detla.append(<span class="hljs-built_in">abs</span>((u[i+<span class="hljs-number">2</span>]-u[i+<span class="hljs-number">1</span>])*(u[i+<span class="hljs-number">2</span>]-u[i+<span class="hljs-number">1</span>])-(u[i+<span class="hljs-number">3</span>]-u[i+<span class="hljs-number">2</span>])*(u[i+<span class="hljs-number">1</span>]-u[i])))<br>p=detla[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> detla:<br>    p=GCD(p,i)<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-keyword">assert</span> isPrime(p)<br>a=(u[<span class="hljs-number">3</span>]-u[<span class="hljs-number">2</span>])*inverse(u[<span class="hljs-number">2</span>]-u[<span class="hljs-number">1</span>],p)%p<br>b=(u[<span class="hljs-number">1</span>]-a*u[<span class="hljs-number">0</span>])%p<br><span class="hljs-built_in">print</span>(a,b,p)<br>x=u[-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">205</span>):<br>    <span class="hljs-keyword">if</span> i%<span class="hljs-number">15</span>==<span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(i)<br>    x=(a*x+b)%p<br>    sh.recvuntil(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    sh.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    sh.recvuntil(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    sh.sendline(<span class="hljs-built_in">str</span>(x).encode())<br>sh.recvuntil(<span class="hljs-string">b&quot;0xGame&#123;&quot;</span>)<br>flag=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;0xGame&#123;&quot;</span>+flag.decode())<br>sh.close()<br></code></pre></td></tr></table></figure><p><code>0xGame&#123;86767788-6000-7608-6777-5454a581d836&#125;</code></p><p>ä¸è¿‡æœ€åçœ‹äº†ä¸€ä¸‹åšå‡ºæ¥çš„äººçš„WPï¼Œæœ‰çš„äººé—®è¿‡æˆ‘ï¼Œå¤šè·å–äº†å‡ ç»„æ•°æ®ï¼Œå¤šæ±‚äº†å‡ æ¬¡æœ€å¤§å…¬çº¦æ•°æŠŠé¢˜ç›®åšå‡ºæ¥äº†ã€‚ä¹Ÿæœ‰äººæ²¡æœ‰æ„è¯†åˆ°è¿™ä¸ªé—®é¢˜ï¼Œé€šè¿‡å¤šæ¬¡è¿æ¥æœåŠ¡å™¨ï¼Œæœ€ç»ˆè·å–äº†ä¸€ç»„$\gcd(D_1,D_2)&#x3D;1$çš„æƒ…å†µï¼Œå¾ˆé¡ºåˆ©åœ°è§£å‡ºäº†$p$ã€‚</p><p>å®é™…ä¸Šè¿™é‡Œå¯ä»¥ç»™å¤§å®¶æ‰©å±•ä¸€ä¸‹ï¼šä»»æ„ä¸¤ä¸ªæ­£æ•´æ•°äº’ç´ çš„æ¦‚ç‡æ˜¯$\dfrac{6}{\pi^2}$ï¼Œè¿™ä¸ªæ•°å­—çš„å€’æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆè‘—åçš„çº§æ•°å’Œï¼š<br>$$<br>\sum_{i&#x3D;1}^{+âˆ}\dfrac{1}{i^2}&#x3D;\dfrac{\pi^2}{6}<br>$$</p><h2 id="Week-4-Update-11-4"><a href="#Week-4-Update-11-4" class="headerlink" title="Week 4[Update 11.4]"></a>Week 4[Update 11.4]</h2><h3 id="ParityOracleBase5"><a href="#ParityOracleBase5" class="headerlink" title="ParityOracleBase5"></a>ParityOracleBase5</h3><p>RSAçš„PariyOracleæ”»å‡»ï¼Œæ˜¯åœ¨<strong>è·å¾—äº†è§£å¯†æœåŠ¡</strong>çš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ å¯¹æœåŠ¡å™¨å‘é€ä»»æ„å¯†æ–‡ï¼ŒæœåŠ¡å™¨ä¼šå‘Šè¯‰ä½ è§£å¯†åæ˜æ–‡çš„<strong>æœ€åä¸€ä½</strong>ã€‚</p><p>ç”±äºå¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯äºŒè¿›åˆ¶ä½ï¼Œå› æ­¤æœ€åä¸€ä½äºŒè¿›åˆ¶ä½å°±æ˜¯$0$æˆ–$1$ã€‚è‹¥æ˜æ–‡$m$çš„å¯†æ–‡æ˜¯$c$ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘é€$2^e c$ï¼Œè§£å¯†å°±å¯ä»¥å¾—åˆ°$2m$ã€‚å¾ˆæ˜¾ç„¶ï¼Œç”±äº$2m$æ˜¯å¶æ•°ï¼Œ$n$æ˜¯å¥‡æ•°ã€‚å› æ­¤å¦‚æœæœåŠ¡å™¨è¿”å›$0$ï¼Œè¯´æ˜$2m$æ²¡æœ‰è¶…è¿‡$n$ï¼Œè€Œå¦‚æœæœåŠ¡å™¨è¿”å›$1$ï¼Œè¯´æ˜$2m$è¶…è¿‡äº†$n$ï¼Œç”±äº$2m$æ˜¯å¶æ•°ï¼Œ$n$æ˜¯å¥‡æ•°ï¼Œå› æ­¤è¿™é‡Œæ¨¡$n$ä½¿å¾—$2m$å‡å»äº†ä¸€ä¸ª$n$.ã€‚</p><p>åœ¨è·å–$2m$çš„ç»“æœåï¼Œæˆ‘ä»¬å¯ä»¥å‘é€$4m$çš„å¯†æ–‡ ç»™æœåŠ¡å™¨ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªè¡¨æ¥åˆ¤æ–­$m$çš„å–å€¼èŒƒå›´ï¼š</p><table><thead><tr><th align="center">$m$èŒƒå›´</th><th align="center">ç¬¬ä¸€æ¬¡è¿”å›å€¼</th><th align="center">ç¬¬äºŒæ¬¡è¿”å›å€¼</th></tr></thead><tbody><tr><td align="center">$4m&lt;n$</td><td align="center">$0$</td><td align="center">$0$</td></tr><tr><td align="center">$n&lt;4m&lt;2n$</td><td align="center">$0$</td><td align="center">$1$</td></tr><tr><td align="center">$2n&lt;4m&lt;3n$</td><td align="center">$1$</td><td align="center">$0$</td></tr><tr><td align="center">$3n&lt;4m&lt;4n$</td><td align="center">$1$</td><td align="center">$1$</td></tr></tbody></table><p>å› æ­¤ï¼Œæˆ‘ä»¬å‘ç°ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡äºŒåˆ†æ³•é€¼å‡º$m$çš„å€¼ï¼Œå¦‚æœæœåŠ¡å™¨è¿”å›$0$å–å‰åŠæ®µï¼Œè¿”å›$1$å–ååŠæ®µã€‚</p><p>æ­¤æ—¶ï¼Œå¦‚æœæˆ‘ä»¬æŠŠäºŒè¿›åˆ¶æ‰©å±•åˆ°äº”è¿›åˆ¶ï¼Œå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å°±ä»è®¨è®º$2m$å˜æˆè®¨è®º$5m$ï¼Œä¹Ÿå°±æ˜¯$5^km$æ¨¡$5$çš„å€¼ã€‚ä½†è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬å·²çŸ¥$m$ä½äº$[L,R]$ä¸­ï¼Œ$b&#x3D;\dfrac {R-L} 5$ï¼Œé‚£å¯¹äºè¿”å›çš„å¯èƒ½å€¼$0,1,2,3,4$ä¸€å®šæ˜¯æŒ‰é¡ºåºå¯¹åº”çš„å—ï¼Ÿæ˜¾ç„¶ä¸æ˜¯ã€‚</p><p>å¦‚æœ5ğ‘šåœ¨$[0,\frac n 5]$çš„èŒƒå›´å†…ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›0 ä½†å¦‚æœ$5ğ‘š$åœ¨ $[\frac n 5,\frac{2n} 5]$ ä¸­ï¼Œå¾ˆæ˜¾ç„¶ï¼ŒçœŸæ­£çš„æ˜æ–‡æ˜¯$5ğ‘š âˆ’ ğ‘›$ã€‚å› æ­¤ï¼Œè¿™é‡Œçš„è¿” å›å€¼æ˜¯ $âˆ’ğ‘› \mod 5$ çš„å€¼ã€‚å› æ­¤ï¼Œ1-4å¯¹åº”çš„åŒºé—´é¡ºåºï¼Œä¸$n \mod 5$çš„å€¼æœ‰å…³ã€‚</p><table><thead><tr><th align="center">$n \mod 5$</th><th align="center">$[0,\frac n 5]$</th><th align="center">$[\frac n 5,\frac{2n} 5]$</th><th align="center">$[\frac {2n} 5,\frac{3n} 5]$</th><th align="center">$[\frac {3n} 5,\frac{4n} 5]$</th><th align="center">$[\frac {4n} 5,n]$</th></tr></thead><tbody><tr><td align="center">$1$</td><td align="center">$0$</td><td align="center">$4$</td><td align="center">$3$</td><td align="center">$2$</td><td align="center">$1$</td></tr><tr><td align="center">$2$</td><td align="center">$0$</td><td align="center">$3$</td><td align="center">$1$</td><td align="center">$4$</td><td align="center">$2$</td></tr><tr><td align="center">$3$</td><td align="center">$0$</td><td align="center">$2$</td><td align="center">$4$</td><td align="center">$1$</td><td align="center">$3$</td></tr><tr><td align="center">$4$</td><td align="center">$0$</td><td align="center">$1$</td><td align="center">$2$</td><td align="center">$3$</td><td align="center">$4$</td></tr></tbody></table><p>å› æ­¤ï¼Œ$n\equiv 4 \pmod 5$çš„æƒ…å†µæ˜¯å¾ˆå®¹æ˜“è¢«æƒ³åˆ°çš„ã€‚å¯ä»¥æ ¹æ®è¿™ä¸ªè¡¨è¿›è¡Œè®¨è®ºï¼Œ ä¹Ÿå¯ä»¥å°±è®¤å®š$n\equiv 4 \pmod 5$çš„æƒ…å†µï¼Œå¤šè¿å‡ æ¬¡æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥æ‹¿åˆ°flagã€‚ è¿™ä¸ªæ˜¯é«˜å¼ºåº¦çš„äº¤äº’ï¼Œä»é¢˜ç›®ä¸­nçš„è§„æ¨¡æ¥çœ‹ï¼Œä¸€å…±è¦äº¤äº’1750- 2100æ¬¡ï¼Œè€—æ—¶12åˆ†é’Ÿå·¦å³ã€‚</p><p>æœ‰å­¦å¼Ÿçœ‹åˆ°äº†ç½‘ä¸Šbase2çš„é¢˜ç›®ï¼Œå‘ç°æœ€åflagä¼šå‡ºç°è¯¯å·®ã€‚ä½†è¿™é“é¢˜æˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘è¯¯å·®ã€‚å› ä¸ºflagåœ¨æ–‡æœ¬çš„ä¸­é—´ï¼Œè¿™è¾¹çš„è¯¯å·®ä¸ä¼šå½±å“åˆ°flagã€‚å¹¶ä¸”ï¼Œè¿™ä¸ªé¢˜ç›®è€ƒè™‘åˆ°ä¸‡ä¸€å½±å“åˆ°äº†çš„æƒ…å†µï¼Œflagæ²¡æœ‰è®¾ç½®æˆmd5çš„é‚£ç§æ ¼å¼ï¼Œè€Œæ˜¯åœ¨æœ€ååšäº†äº›æ‰‹è„šã€‚å› æ­¤flagå³ä½¿å‡ºç°3ä½æœ‰é—®é¢˜ï¼Œä¹ŸåŸºæœ¬ä¸Šéƒ½èƒ½çŒœå‡ºæ¥æ˜¯å•¥ã€‚</p><p>EXP:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>sh = remote(<span class="hljs-string">&quot;47.101.38.213&quot;</span>, <span class="hljs-number">60713</span>)<br>sh.recvuntil(<span class="hljs-string">b&quot;&gt; &quot;</span>)<br>sh.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>n, e, c = [sh.recvline(keepends=<span class="hljs-literal">False</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>n, e, c = <span class="hljs-built_in">int</span>(n[<span class="hljs-number">2</span>:]), <span class="hljs-built_in">int</span>(e[<span class="hljs-number">2</span>:]), <span class="hljs-built_in">int</span>(c[<span class="hljs-number">2</span>:])<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(e)<br><span class="hljs-built_in">print</span>(c)<br>L, R, Clk = <span class="hljs-number">0</span>, n, <span class="hljs-number">1</span><br>judge = n % <span class="hljs-number">5</span><br>Table = [[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<br>    <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]<br>j0, j1, j2, j3, j4 = Table[judge]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;judge=<span class="hljs-subst">&#123;judge&#125;</span>&quot;</span>)<br><span class="hljs-keyword">while</span> L &lt; R:<br>    <span class="hljs-comment"># for i in range(1):</span><br>    D = (R-L)//<span class="hljs-number">5</span><br>    <span class="hljs-keyword">if</span> Clk % <span class="hljs-number">35</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(Clk)<br>        <span class="hljs-built_in">print</span>(R-L)<br>    P20, P40, P60, P80 = L+D, L+<span class="hljs-number">2</span>*D, L+<span class="hljs-number">3</span>*D, L+<span class="hljs-number">4</span>*D<br>    a = c*(<span class="hljs-built_in">pow</span>(<span class="hljs-number">5</span>, e*Clk, n)) % n<br>    sh.recvuntil(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    sh.sendline(<span class="hljs-string">b&quot;3&quot;</span>)<br>    sh.recvuntil(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    sh.sendline(<span class="hljs-built_in">str</span>(a).encode())<br>    Rem = sh.recvline(keepends=<span class="hljs-literal">False</span>)[-<span class="hljs-number">1</span>]-<span class="hljs-number">48</span><br>    <span class="hljs-keyword">if</span> Rem == j0:<br>        L, R = L, P20<br>    <span class="hljs-keyword">elif</span> Rem == j1:<br>        L, R = P20, P40<br>    <span class="hljs-keyword">elif</span> Rem == j2:<br>        L, R = P40, P60<br>    <span class="hljs-keyword">elif</span> Rem == j3:<br>        L, R = P60, P80<br>    <span class="hljs-keyword">elif</span> Rem == j4:<br>        L, R = P80, R<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">b&quot;Error&quot;</span>)<br>        <span class="hljs-keyword">break</span><br>    Clk += <span class="hljs-number">1</span><br>L = long_to_bytes(L)<br>L = L.split(<span class="hljs-string">b&quot;          &quot;</span>)<br><span class="hljs-built_in">print</span>(L[<span class="hljs-number">1</span>])<br>sh.close()<br></code></pre></td></tr></table></figure><p>flag:<code>0xGame&#123;31b52022-6076-8067-8848-taijinshouji&#125;</code> </p><p>è¿™ä¸ªé¢˜ä¸€å…±æœ‰7ä½æ–°ç”Ÿåšå‡ºæ¥ï¼Œtqlã€‚</p><h3 id="Predict-2"><a href="#Predict-2" class="headerlink" title="Predict 2"></a>Predict 2</h3><p>æ—¢ç„¶ä¸Šå‘¨å‡ºäº†ä¸ªPredict 1ï¼Œé‚£å°±ä¼šå‡ºä¸ªPredict 2ã€‚</p><p>LFSRï¼Œåˆç§°çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ã€‚å®ƒæ˜¯é€šè¿‡ $ğ‘¦ â‰¡ \sum_{i&#x3D;1}^ ğ‘› ğ‘_ğ‘–ğ‘¥_ğ‘– \pmod p$ çš„å½¢å¼ï¼Œè·å¾—è¾“å‡º$ğ‘¦$ã€‚è¾“å‡ºåï¼Œå°†$ğ‘¥_0$å»æ‰ï¼ŒæŠŠ$y$æ¥åœ¨$x$æ•°ç»„çš„æœ€åï¼Œç»„æˆæ–°çš„$x$æ•°ç»„ï¼Œé•¿åº¦ä¸åŸæ¥$x$æ•°ç»„ä¸€è‡´ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œ$a$æ•°ç»„å§‹ç»ˆä¸å˜ã€‚</p><p>é¢˜ç›®åˆå§‹æœ‰97æ¬¡è·å¾—stateçš„æœºä¼šï¼ŒLFSRçš„é•¿åº¦ä¸º45ã€‚å½“ä½ é¢„æµ‹åˆ°åé¢600 ä¸ªstateåï¼Œå°±å¯ä»¥è·å¾—flagã€‚ æ ¹æ®è¿­ä»£å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™ä¸ªè§„å¾‹ï¼š<br>$$<br>x_{45}\equiv \sum_{i&#x3D;0}^{44} a_ix_i \pmod p<br>$$</p><p>$$<br>x_{46}\equiv \sum_{i&#x3D;0}^{44} a_ix_{i+1} \pmod p<br>$$</p><p>å¾ˆæ˜¾ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æŠŠ$a$çœ‹ä½œæœªçŸ¥æ•°ï¼Œé‚£ä¹ˆå°±æ˜¯è¦è§£å«æœ‰$45$ä¸ªæœªçŸ¥æ•°çš„æ–¹ç¨‹ã€‚éœ€è¦æ„é€ $45$ä¸ªç­‰å¼ã€‚</p><p>è€Œåœ¨çº¿æ€§ä»£æ•°ä¸­ï¼Œè§£çº¿æ€§æ–¹ç¨‹ç»„å®é™…ä¸Šéƒ½å¯ä»¥åŒ–ä¸ºçŸ©é˜µçš„è¿ç®—ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸‹é¢çš„çŸ©é˜µï¼š</p><p><img src="/2021/10/25/0xGame2021PartCryptoDiv1/Predict2.png" alt="Predict2"></p><p>è¿™ä¸ªçŸ©é˜µæœ‰å½¢å¦‚$\vec aM&#x3D;\vec b$çš„æ ¼å¼ã€‚æ ¹æ®é¢˜ç›®æ¥çœ‹ï¼Œå¾ˆæ˜¾ç„¶æ–¹ç¨‹æœ‰å”¯ä¸€è§£ã€‚ æ‰€ä»¥è¿ç”¨çº¿æ€§ä»£æ•°çŸ¥è¯†ï¼Œæœ‰$\vec a &#x3D; \vec bM^{âˆ’ğŸ}$ ã€‚ä¸è¿‡è¿™é‡Œçš„é€†çŸ©é˜µæ˜¯åœ¨æ¨¡$p$æ„ä¹‰ ä¸‹çš„é€†çŸ©é˜µã€‚</p><p>æ±‚é€†çŸ©é˜µå¯ä»¥ç”¨Sagemathï¼Œä¹Ÿå¯ä»¥æ ¹æ®çº¿æ€§ä»£æ•° è¯¾ä¸Šè®²è¿‡çš„åˆ©ç”¨å¢å¹¿çŸ©é˜µæ³•æ±‚è§£é€†çŸ©é˜µï¼Œå°† $(ğ‘€| ğ¸)$ åŒ–ä¸º$( ğ¸ |ğ‘€^{-1})$ ï¼Œé™¤æ³•å˜æˆä¹˜ä¸Šå¯¹åº”æ•°å­—çš„é€†å…ƒã€‚å…·ä½“çš„åšæ³•è§é¢˜ç›®ç»™å‡ºçš„é™„ä»¶2ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>sh = remote(<span class="hljs-string">&quot;47.101.38.213&quot;</span>, <span class="hljs-number">60710</span>)<br>states = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">90</span>):<br>    sh.recvuntil(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    sh.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    sh.recvuntil(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    sh.sendline(<span class="hljs-string">b&quot;1500000000&quot;</span>)<br>    sh.recvuntil(<span class="hljs-string">b&quot;is&quot;</span>)<br>    states.append(<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>)))<br>M = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">45</span>):<br>    M.append(states[i:i+<span class="hljs-number">45</span>])<br>v = states[<span class="hljs-number">45</span>:<span class="hljs-number">90</span>]<br>M = matrix(Zmod(<span class="hljs-number">1435756429</span>), M)<br>v = vector(Zmod(<span class="hljs-number">1435756429</span>), v)<br>mask = v*(M**(-<span class="hljs-number">1</span>))<br>v, mask = <span class="hljs-built_in">list</span>(v), <span class="hljs-built_in">list</span>(mask)<br><span class="hljs-built_in">print</span>(mask)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">601</span>):<br>    s = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">45</span>):<br>        s += v[j]*mask[j]<br>    s %= <span class="hljs-number">1435756429</span><br>    <span class="hljs-built_in">print</span>(i, s)<br>    v = v[<span class="hljs-number">1</span>:]+[s]<br>    sh.recvuntil(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    sh.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    sh.recvuntil(<span class="hljs-string">b&quot;&gt;&quot;</span>)<br>    sh.sendline(<span class="hljs-built_in">str</span>(s).encode())<br>sh.interactive()<br><br></code></pre></td></tr></table></figure><p>é™„ä»¶2ï¼šæ±‚æ¨¡æ„ä¹‰ä¸‹çš„é€†çŸ©é˜µä»£ç ï¼Œç”¨çš„æ˜¯å¢å¹¿çŸ©é˜µæ³•æ±‚é€†çŸ©é˜µï¼Œæ—¶é—´å¤æ‚åº¦$O(n^3)$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">InvMatrixWithModulus</span>(<span class="hljs-params">_matrix, p</span>):<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> isPrime(p)) <span class="hljs-keyword">or</span> (<span class="hljs-built_in">len</span>(_matrix) != <span class="hljs-built_in">len</span>(_matrix[<span class="hljs-number">0</span>])):<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;matrix must be a square and p must be a prime&quot;</span>)<br>    l = <span class="hljs-built_in">len</span>(_matrix)<br>    matrix = [[] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l):<br>            matrix[i].append(_matrix[i][j])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l):<br>        matrix[i] = matrix[i]+[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l)]<br>        matrix[i][l+i] = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l):<br>        inv = inverse(matrix[i][i], p)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i, <span class="hljs-number">2</span>*l):<br>            matrix[i][j] = matrix[i][j]*inv % p<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>, l):<br>            timz = matrix[j][i]<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>*l):<br>                matrix[j][k] = (matrix[j][k]-timz*matrix[i][k]) % p<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l):<br>        <span class="hljs-keyword">assert</span> matrix[i][i] == <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>            timz = matrix[j][i]<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i, <span class="hljs-number">2</span>*l):<br>                matrix[j][k] = (matrix[j][k]-timz*matrix[i][k]) % p<br>    J = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> matrix:<br>        J.append(i[l:])<br>    <span class="hljs-keyword">return</span> J<br></code></pre></td></tr></table></figure><p><code>flag:0xGame&#123;87087788-7777-baa5-340d-512844320391&#125;</code>ã€‚</p><p>è¿™ä¸ªé¢˜ç›®ä½¿ç”¨äº†åŠ¨æ€flagï¼ˆä¸Šä¸ªé¢˜ç›®ä¹Ÿæ˜¯ï¼‰ï¼Œä¸€å…±æœ‰3ä¸ªå­¦å¼Ÿåšå‡ºæ¥äº†ï¼Œè¿™ä¸ªé¢˜ä¹Ÿç®—æ˜¯å†³å®šAKçš„é¢˜ç›®å§ã€‚åœ¨è¿™è¾¹æ”¾ä¸€ä¸‹ä»–ä»¬è§£å‡ºæ¥çš„flagï¼Œä½œä¸ºçºªå¿µã€‚</p><table><thead><tr><th>Schen</th><th><code>0xGame&#123;87087788-7777-5b55-3ef6-512844325201&#125;</code></th></tr></thead><tbody><tr><td>Louis Youssef</td><td><code>0xGame&#123;87087788-7777-1035-3e02-512844326801&#125;</code></td></tr><tr><td>å¶æ˜Ÿ</td><td><code>0xGame&#123;87087788-7777-1fb5-3aad-512844329565&#125;</code></td></tr></tbody></table><h2 id="Week-5-å‡ºé¢˜åè®°"><a href="#Week-5-å‡ºé¢˜åè®°" class="headerlink" title="Week 5(å‡ºé¢˜åè®°)"></a>Week 5(å‡ºé¢˜åè®°)</h2><p>è¿™æ¬¡0xGameè‡ªå·±å‡ºäº†11ä¸ªé¢˜ç›®ï¼Œæ€»ä½“æ¥è¯´è¿˜æ˜¯ä»æ˜“åˆ°éš¾çš„ã€‚ä¸ªäººè®¤ä¸ºä¸å»å¹´ç›¸æ¯”ï¼Œç¬¬4å‘¨å¯èƒ½è¦æ¯”å»å¹´éš¾ä¸€ç‚¹ï¼Œå…¶ä»–3å‘¨è¿˜æ˜¯æ¯”å»å¹´åç®€å•çš„ã€‚</p><p>ä¸€å…±æœ‰3äººAKäº†å¯†ç å­¦çš„å…¨éƒ¨é¢˜ç›®ï¼Œä¹Ÿå¸Œæœ›ä»–ä»¬èƒ½åœ¨åé¢CTFçš„å­¦ä¹ ä¸­ï¼Œæ— è®ºæ˜¯å¦ä¼šèµ°å¯†ç å­¦æ–¹å‘ï¼Œèƒ½å¤Ÿæ”¶è·æ›´å¤šçš„çŸ¥è¯†å§ã€‚</p><p>10æœˆ12-14æ—¥è‡ªå·±è¿æ¥äº†ç¬¬ä¸€ä¸ªçº¿ä¸‹èµ›ï¼Œåœ¨éƒ‘å·ã€‚è™½ç„¶æ²¡æœ‰å¯†ç å­¦é¢˜ç›®ï¼Œæ˜¯å»ç™½ç»™çš„ï¼Œä½†è¿˜æ˜¯æ”¶è·äº†å¾ˆå¤šï¼Œæ¶¨äº†è§è¯†ï¼Œ<del>æ°äº†380çƒ‚é’±ã€‚ã€‚ã€‚</del> ä¸è¿‡è‡ªå·±10æœˆä»½è¿˜æ˜¯éå¸¸å¿™çš„ä¸€ä¸ªæœˆï¼Œæ¯å‘¨éƒ½å‡ºç°äº†ä¸€å †äº‹æƒ…ï¼Œå¸Œæœ›è‡ªå·±11æœˆçš„äº‹æƒ…ç¨å¾®å°‘ä¸€ç‚¹ï¼Œç„¶åå¤ä¹ å¤ä¹ æˆ‘çš„ç¦»æ•£ã€æ¦‚ç‡è®ºã€ä¿¡å®‰æ•°åŸºå’Œå¤§ç‰©ï¼Œå¸Œæœ›è‡ªå·±æœŸæœ«è€ƒè¯•è¿™4é—¨è¯¾éƒ½èƒ½è€ƒåˆ°60åˆ†ã€‚</p><p>è¿˜å¥½è‡ªå·±å»å¹´6çº§è¿‡äº†ï¼Œè¦æ˜¯ä¸è¿‡çš„è¯ï¼Œä»Šå¹´çš„äº‹æƒ…ç»å¯¹ä¼šå¿™åˆ°æˆ‘ç ´é˜²ã€‚10æœˆç¬¬ä¸€å‘¨è¿æ–°ï¼Œç¬¬äºŒå‘¨çº¿ä¸‹ï¼Œç¬¬ä¸‰å‘¨ä¸ºSASTå’ŒSACCæ‹›æ–°æ‰¹å·ï¼Œç¬¬å››å‘¨å®‰å…¨ç»„æˆè¯¾ï¼Œ11æœˆç¬¬ä¸€å‘¨å†™ä»»é€‰è¯¾è®ºæ–‡å’Œå¤§ç‰©æœŸä¸­è€ƒï¼Œè¿˜æœ‰æ˜Ÿç›Ÿåˆ†äº«åˆåšäº†ä¸ªpptã€‚ã€‚ã€‚ã€‚</p><p><del>å¸Œæœ›è‡ªå·±2å¹´åèƒ½å¤Ÿè€ƒå—é‚®çš„ç ”ç©¶ç”Ÿå§ï¼Œä»¥åå†ç¤¾ä¼šä¸Šæ··å£é¥­åƒä¸é”™äº†ã€‚</del></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BlockCipher3</title>
    <link href="/2021/09/04/BlockCipher3/"/>
    <url>/2021/09/04/BlockCipher3/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°3"><a href="#huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°3" class="headerlink" title="huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°3"></a>huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°3</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>æœ¬ç¯‡åšå®¢æ¥ç€å‰ä¸€ç¯‡çš„å†…å®¹ï¼Œåœ¨è®²è¿‡DES AESåï¼Œå¯¹å…¶åŠ å¯†æ¨¡å¼è¿›è¡Œåˆ†æã€‚</p><h2 id="3-DES-AESçš„åŠ å¯†æ¨¡å¼"><a href="#3-DES-AESçš„åŠ å¯†æ¨¡å¼" class="headerlink" title="3.DES,AESçš„åŠ å¯†æ¨¡å¼"></a>3.DES,AESçš„åŠ å¯†æ¨¡å¼</h2><p>åœ¨DES å’ŒAESçš„å„ç§åŠ å¯†æ¨¡å¼ä¸­ï¼Œ æœ‰äº”ç§æ“ä½œæ¨¡å¼æœ€ä¸ºå¸¸ç”¨ï¼Œä¸‹é¢å°†é€ä¸€ä»‹ç»ä¸‹é¢çš„å„ç§åŠ å¯†æ¨¡å¼ã€‚</p><h3 id="0o01-ç”µå­å¯†ç æœ¬æ¨¡å¼-ECB"><a href="#0o01-ç”µå­å¯†ç æœ¬æ¨¡å¼-ECB" class="headerlink" title="0o01 ç”µå­å¯†ç æœ¬æ¨¡å¼ ECB"></a>0o01 ç”µå­å¯†ç æœ¬æ¨¡å¼ ECB</h3><p>ECBæ¨¡å¼æ˜¯æœ€ç®€å•çš„ä¸€ç§æ¨¡å¼ï¼Œå®é™…ä¸Šå°±æ˜¯ç›´æ¥åŠ å¯†å’Œç›´æ¥è§£å¯†ï¼Œä¸éœ€è¦å…¶ä»–çš„ä»»ä½•æˆåˆ†ï¼Œä»…éœ€è¦æ˜æ–‡$x$å’Œå¯†é’¥$k$ï¼Œå°±å¯ä»¥è·å¾—å¯†æ–‡$y$ï¼Œå½“ç„¶ï¼Œç”¨$y$å’Œ$k$ä¹Ÿå¯ä»¥é€šè¿‡è§£å¯†å¾—åˆ°$x$ã€‚</p><p><img src="/2021/09/04/BlockCipher3/1.png" alt="1"></p><p>åœ¨ECBæ¨¡å¼ä¸­ï¼Œæ¯ä¸ªåˆ†ç»„çš„é•¿åº¦éƒ½æ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚$16$ä¸ªå­—èŠ‚æˆ–è€…$8$ä¸ªå­—èŠ‚ã€‚å¦‚æœæœ€åä¸æ»¡$16$ä¸ªå­—èŠ‚ï¼Œé‚£å°±éœ€è¦å¯¹æœ€åä¸€ç»„æ˜æ–‡è¿›è¡Œå¡«å……ååŠ å¯†ã€‚ä¸€ç§å¸¸è§çš„å¡«å……æ¨¡å¼å°±æ˜¯åé¢å·®å‡ ä¸ªï¼Œå°±å¾€åé¢å¡«å‡ ä¸ªå¯¹åº”å­—ç¬¦ã€‚ä¾‹å¦‚ï¼šåœ¨$8$å­—èŠ‚çš„åˆ†ç»„ä¸‹ï¼Œå¯¹å­—ç¬¦ä¸²<code>doge</code>è¿›è¡ŒåŠ å¯†ï¼Œç”±äºå·®$4$ä¸ªæ‰èƒ½æ»¡è¶³ä¸€ç»„å…«ä¸ªçš„è¦æ±‚ï¼Œé‚£å°±åœ¨åé¢å¡«å……å››ä¸ª<code>\x04</code>å†åŠ å¯†ï¼Œä¹Ÿå°±æ˜¯æœ€åæ˜æ–‡å˜æˆäº†<code>doge\x04\x04\x04\x04</code>ã€‚å½“ç„¶ï¼Œå¦‚æœåˆšå¥½æ˜¯å…«ä¸ªå­—èŠ‚äº†ï¼Œé‚£å°±å¡«å……ä¸€æ•´ä¸²ã€‚ä¾‹å¦‚ï¼š<code>nuptsacc</code>åœ¨å¡«å……åï¼Œä»ä¸€ç»„å˜æˆäº†ä¸¤ç»„ï¼Œå†…å®¹æ˜¯ï¼š<code>nuptsacc\x08\x08\x08\x08\x08\x08\x08\x08</code></p><p>ECBæ¨¡å¼çš„ä¼˜ç‚¹å°±æ˜¯å¦‚æœåœ¨åŠ å¯†æ—¶ï¼ŒæŸä¸ªåˆ†ç»„çš„å†…å®¹å‡ºç°äº†é”™è¯¯ï¼Œåé¢çš„å†…å®¹ä¸ä¼šå› ä¸ºè¿™ä¸ªé”™è¯¯è€Œå—åˆ°å½±å“ï¼Œå¹¶ä¸”åŠ å¯†é€Ÿåº¦å¿«ã€æ•ˆç‡é«˜ã€æ˜“æ“ä½œã€‚</p><p>ä½†ECBæ¨¡å¼çš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯è¯¥æ¨¡å¼ç”±äºæ“ä½œè¿‡äºç®€å•ï¼Œå…·æœ‰é«˜åº¦ç¡®å®šæ€§ã€‚å¦‚æœåœ¨keyä¸€å®šçš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆä¸€æ—¦$x$ç¡®å®šäº†ï¼Œ$y$ä¹Ÿå°±ç¡®å®šäº†ã€‚å› æ­¤å¦‚æœæ”»å‡»è€…çŸ¥é“äº†æ–‡ä»¶å¼€å¤´éƒ¨åˆ†ï¼Œæˆ–è€…æ˜¯æ˜¯æ–‡ä»¶çš„é«˜é¢‘å†…å®¹ï¼Œå°±æœ‰å¯èƒ½ç ´è§£å‡ºå¯èƒ½çš„å¯†é’¥ã€‚</p><p>ç”±äºå†…å®¹çš„é«˜åº¦ç¡®å®šæ€§ï¼Œå› æ­¤ECBåœ¨å¯¹äºå›¾ç‰‡åŠ å¯†çš„æƒ…å†µä¸‹ï¼Œæœ‰å¯èƒ½ä¼šæ³„éœ²ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾:</p><p><img src="/2021/09/04/BlockCipher3/2.png" alt="2"></p><h3 id="0o02-å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼-CBC"><a href="#0o02-å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼-CBC" class="headerlink" title="0o02 å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼(CBC)"></a>0o02 å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼(CBC)</h3><p>CBCæ¨¡å¼è·ŸECBæ¨¡å¼ä¸åŒï¼šé¦–å…ˆï¼Œå¯¹äºæŸä¸€ç»„çš„åŠ å¯†ä¸ä»…ä¾èµ–äºè¿™ä¸€ç»„çš„å†…å®¹ï¼Œè¿˜ä¾èµ–äºå‰é¢æ‰€æœ‰çš„æ˜æ–‡åˆ†ç»„ã€‚å¹¶ä¸”ä¼šä½¿ç”¨åˆå§‹å‘é‡IVå¯¹åŠ å¯†è¿›è¡ŒéšæœºåŒ–ã€‚è®¾$\mathrm {IV}&#x3D;y_0$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰<br>$$<br>y_i&#x3D;e(x_i+y_{i-1})<br>$$<br>æ­¤å¤„çš„åŠ å·ä»ç„¶è¡¨ç¤ºå¼‚æˆ–ï¼Œä½ ä¼šå‘ç°æ¯ä¸€ç»„çš„åŠ å¯†å†…å®¹æ˜¯æŠŠè¿™ä¸€ç»„çš„æ˜æ–‡å’Œä¸Šä¸€ç»„çš„å¯†æ–‡å¼‚æˆ–ä¹‹åï¼Œå†å¯ç”¨åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†ã€‚åŠ å¯†ç®—æ³•å¯ä»¥ç”¨è¿™å¼ å›¾è¡¨ç¤º</p><p><img src="/2021/09/04/BlockCipher3/3.png" alt="3"></p><p>å› æ­¤ï¼Œè¿™ä¸ªåŠ å¯†æœ‰ä¸ªæ€§è´¨ï¼šå°±æ˜¯ç”±äº$y_i&#x3D;E_k(x_i,y_{i-1})$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$x_i&#x3D;D_k(y_i,y_{i-1})$ï¼Œç”±äºå¼‚æˆ–çš„å¯äº¤æ¢æ€§ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—åˆ°<br>$$<br>y_{i-1}&#x3D;D_k(y_i,x_{i})<br>$$<br>ä¹Ÿå°±æ˜¯å‡­å€Ÿä¸€ç»„æ˜æ–‡$x$å’Œä¸€ç»„å¯†æ–‡$y$ï¼Œå½“ç„¶è¿˜æœ‰å¯†é’¥$k$ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡º$iv$çš„å€¼ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥ç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªfakeiv $f$ï¼Œè®¡ç®—ï¼š<br>$$<br>xâ€™&#x3D;D_k(y,f)<br>$$<br>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼šï¼ˆåŠ å·è¡¨ç¤ºå¼‚æˆ–ï¼‰<br>$$<br>yâ€™&#x3D;xâ€™+f<br>$$<br>ç„¶åæˆ‘ä»¬å¯ä»¥å¾—åˆ°çœŸæ­£çš„IVï¼Œä¹Ÿå°±æ˜¯$y_0$çš„å€¼ä¸º<br>$$<br>y_0&#x3D;yâ€™+x<br>$$</p><p>æ•´åˆèµ·æ¥ï¼Œé‚£å°±åœ¨å·²çŸ¥æ˜æ–‡$x$ã€å¯†æ–‡$y$ã€å¯†é’¥$k$çš„æƒ…å†µä¸‹ï¼Œåˆå§‹å‘é‡$y_0$å¾ˆå¿«å°±èƒ½ç›´æ¥æ±‚å‡ºï¼ˆåŠ å·è¡¨ç¤ºå¼‚æˆ–ï¼‰<br>$$<br>y_0&#x3D;D_k(y,f)+f+x<br>$$</p><h3 id="0o03-è¾“å‡ºåé¦ˆæ¨¡å¼-OFB"><a href="#0o03-è¾“å‡ºåé¦ˆæ¨¡å¼-OFB" class="headerlink" title="0o03 è¾“å‡ºåé¦ˆæ¨¡å¼(OFB)"></a>0o03 è¾“å‡ºåé¦ˆæ¨¡å¼(OFB)</h3><p>OFBæ¨¡å¼æ˜¯å¯¹åˆå§‹åŒ–å‘é‡$iv$è¿›è¡ŒåŠ å¯†ï¼Œç„¶åæ¯æ¬¡å¯¹åŠ å¯†åçš„$iv$ç›´æ¥å¼‚æˆ–æ˜æ–‡$x$ï¼Œä»è€Œè·å¾—å¯†æ–‡$y$çš„ä¸€ç§æ¨¡å¼ã€‚</p><p><img src="/2021/09/04/BlockCipher3/4.png" alt="4"></p><p>å› æ­¤ï¼Œæˆ‘ä»¬è§£å¯†æ—¶ï¼Œä¹Ÿç›´æ¥ä½¿ç”¨IVè¿›è¡Œè§£å¯†å³å¯ï¼Œä¸è¿‡æ³¨æ„å¯¹äºIVæ¥æ”¶ï¼Œä»ç„¶æ˜¯åŠ å¯†æ“ä½œï¼Œè€Œä¸æ˜¯è§£å¯†æ“ä½œã€‚æ¢å¥è¯è¯´å°±æ˜¯å¯¹äºIVè€Œè¨€ï¼Œä¸å­˜åœ¨è§£å¯†æ“ä½œã€‚</p><p><img src="/2021/09/04/BlockCipher3/5.png" alt="5"></p><h3 id="0o04-å¯†ç åé¦ˆæ¨¡å¼-CFB"><a href="#0o04-å¯†ç åé¦ˆæ¨¡å¼-CFB" class="headerlink" title="0o04 å¯†ç åé¦ˆæ¨¡å¼(CFB)"></a>0o04 å¯†ç åé¦ˆæ¨¡å¼(CFB)</h3><p>CFBï¼Œå³å¯†æ–‡åé¦ˆæ¨¡å¼ï¼Œä»ç„¶æ˜¯å¯¹IVè¿›è¡ŒåŠ å¯†ï¼Œç„¶åä¸æ˜æ–‡$x$è¿›è¡Œå¼‚æˆ–å¾—åˆ°å¯†æ–‡$y$ã€‚ç„¶å$E(IV)$ä¼šç»§æ‰¿ååŠéƒ¨åˆ†å†…å®¹ä½œä¸ºæ–°çš„å‰åŠéƒ¨åˆ†ï¼Œè€Œæ–°çš„ååŠéƒ¨åˆ†åˆ™ç”±å¯†æ–‡çš„ååŠéƒ¨åˆ†ç»„æˆã€‚å¦‚æœæ˜¯$16$ä½ï¼Œæ›¿æ¢$8$ä½ã€‚é‚£ä¹ˆå°±æ˜¯æ–°çš„IVçš„å‰$8$ä½æ˜¯æ—§çš„IVçš„å$8$ä½ï¼Œç„¶åæ–°çš„IVçš„å$8$ä½æ˜¯å¯†æ–‡çš„å$8$ä½ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯å‰$8$ä½ï¼‰</p><p><img src="/2021/09/04/BlockCipher3/6.png" alt="6"></p><p>è§£å¯†æ—¶ï¼Œä¹Ÿç›´æ¥å°±æ˜¯åˆ†ç»„è§£å¯†ï¼Œå¯¹IVåŠ å¯†åä¸å¯†æ–‡å¼‚æˆ–å¾—åˆ°æ˜æ–‡ã€‚ä¸OFBæ¨¡å¼ä¸€æ ·ï¼Œä¸å­˜åœ¨å¯¹IVè§£å¯†çš„æƒ…å½¢ã€‚</p><h3 id="0o05-è®¡æ•°å™¨æ¨¡å¼-CTR"><a href="#0o05-è®¡æ•°å™¨æ¨¡å¼-CTR" class="headerlink" title="0o05 è®¡æ•°å™¨æ¨¡å¼(CTR)"></a>0o05 è®¡æ•°å™¨æ¨¡å¼(CTR)</h3><p>CTRæ¨¡å¼è¿™é‡Œæœ‰ä¸€ä¸ªè®¡æ•°å™¨ã€‚æ¯”å¦‚åœ¨$64$ä½çš„åˆ†ç»„åŠ å¯†ä¸­ï¼ŒIVåªæä¾›$48$ä½ï¼Œå‰©ä¸‹çš„$16$ä½åˆ†é…ç»™è®¡æ•°å™¨ã€‚ä¾‹å¦‚ï¼šå¦‚æœæˆ‘ä»¬è®¾$\text{IV &#x3D; 86 43 23 6A 46 57H}$ï¼Œé‚£ä¹ˆä¸€å¼€å§‹çš„$\text{IV&#x3D;86 43 23 6A 46 57 00 00H}$ï¼Œç¬¬äºŒè½®åŠ å¯†æ—¶ç”¨$\text{IV&#x3D;86 43 23 6A 46 57 00 01H}$ã€‚æ¯ä¸€æ¬¡åŠ å¯†æ—¶ï¼Œè®¡æ•°å™¨ä¼šä¿æŒé€’å¢ï¼Œä½†IVä¼šä¸€ç›´ä¸å˜ã€‚å› æ­¤ï¼Œåå…­ä½çš„è®¡æ•°å™¨å¯ä»¥åŠ å¯†å…­ä¸‡å¤šç»„æ•°æ®ã€‚</p><p>å½“ç„¶ï¼ŒIV|CTRçš„å€¼å®é™…ä¸Šä¸å¿…ä¿å¯†ï¼Œè€ŒCTRä¹Ÿå¹¶ä¸ä¸€å®šæ˜¯<code>+1</code>å½¢ï¼Œå¯ä»¥æ˜¯æœ€å¤§é•¿åº¦LFSRï¼Œä¹Ÿå¯ä»¥æ˜¯ç¦»æ•£å¯¹æ•°çš„è§„å¾‹ï¼Œæ¯”å¦‚$  3^{T} \equiv \mathrm{CTR} \pmod {2^{64}}$ã€‚</p><p><img src="/2021/09/04/BlockCipher3/7.png" alt="7"></p><p>è¿™ç§æ¨¡å¼è¿˜æœ‰ä¸ªå¥½å¤„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡128ä½çš„å†…å®¹æ¥åŠ å¯†$256$ä½çš„åˆ†ç»„å¯†ç ã€‚æˆ‘ä»¬åªéœ€è¦æ¯æ¬¡è®©è®¡æ•°å™¨$+2$ï¼Œä¸€ç»„åŠ å¯†å‰$128$ä½ï¼Œä¸€ç»„åŠ å¯†å$128$ä½ã€‚ä¸¤ç»„åŠ å¯†åŒæ—¶è¿›è¡Œï¼Œå¯ä»¥èŠ‚çœè¾ƒå¤šçš„æ—¶é—´æˆæœ¬ã€‚</p><h3 id="0o06-GFåŸŸè®¡æ•°å™¨æ¨¡å¼-GCM"><a href="#0o06-GFåŸŸè®¡æ•°å™¨æ¨¡å¼-GCM" class="headerlink" title="0o06 GFåŸŸè®¡æ•°å™¨æ¨¡å¼(GCM)"></a>0o06 GFåŸŸè®¡æ•°å™¨æ¨¡å¼(GCM)</h3><p>GCMæ¨¡å¼ï¼Œä½¿ç”¨ä¼½ç½—ç“¦åŸŸä¹˜æ³•ï¼Œè¿™é‡Œæ˜¯$GF(2^{128})$ã€‚åœ¨è®¡ç®—æ¯ä¸ªæ˜æ–‡æ—¶éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªä¸­é—´è®¤è¯å‚æ•°$g$ï¼Œ$g_{i}$ä¸ºå½“å‰å¯†æ–‡$y_i$å¼‚æˆ–åï¼Œä¸ä¸€ä¸ªå¸¸æ•°$h$ç›¸ä¹˜ã€‚è¿™é‡Œä½¿ç”¨ä¸å¯çº¦å¤šé¡¹å¼$x^{128}+x^7+x^2+x+1$ã€‚å› ä¸ºè¿™é‡Œé¢åªæœ‰ä¸€ä¸ªä¹˜æ³•ï¼Œå› æ­¤GCMçš„è®¡ç®—å¼€é”€ä¸ä¼šå¾ˆå¤§ã€‚</p><p><img src="/2021/09/04/BlockCipher3/8.png" alt="8"></p><p><img src="/2021/09/04/BlockCipher3/9.png" alt="9"></p><p>æ•°æ®åŒ…$[y,T,ADD]$çš„æ¥æ”¶è€…ä¹Ÿæ˜¯ä½¿ç”¨è®¡æ•°å™¨æ¨¡å¼è§£å¯†å¯†æ–‡ã€‚ä¸ºäº†æ£€æŸ»æ•°æ®çš„å¯é æ€§ï¼Œæ¥æ”¶è€…ä¹Ÿä½¿ç”¨æ”¶åˆ°çš„å¯†æ–‡$ADD$ä¸ $Tâ€™$ â€”èµ·è®¡ç®—è®¤è¯æ ‡ç­¾ r,è€Œä¸”æ¥æ”¶è€…çš„è®¡ç®—æ­¥éª¤ ä¸å‘é€è€…å®Œå…¨ç›¸åŒã€‚å¦‚æœ $T$ä¸$Tâ€™$ åŒ¹é…ï¼Œæ¥æ”¶è€…åˆ™å¯ç¡®å®šå¯†æ–‡(å’Œ åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢« ç¯¡æ”¹ï¼Œå¹¶ä¸”çš„ç¡®æ˜¯å‘é€è€…ç”Ÿæˆäº†è¯¥æ¶ˆæ¯ã€‚</p><p>äº†è§£è¿™äº›åŠ å¯†æ¨¡å¼ çš„åŸç†å›¾ï¼Œå¯¹æˆ‘ä»¬ä»¥ååœ¨åšåˆ°åˆ†ç»„å¯†ç çš„é¢˜ç›®æ—¶ï¼Œå¯ä»¥ä»åŸç†å‡ºå‘ï¼Œæ›´åŠ æ·±å…¥åœ°å¯¹å…¶ç®—æ³•è¿›è¡Œç ”ç©¶ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BlockCipher2</title>
    <link href="/2021/09/01/BlockCipher2/"/>
    <url>/2021/09/01/BlockCipher2/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°2"><a href="#huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°2" class="headerlink" title="huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°2"></a>huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°2</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>9æœˆ1æ—¥ï¼Œè‡ªå·±çš„ç¬¬äºŒä¸ª90å¤©è®¡åˆ’å¼€å§‹ï¼Œè‡ªå·±ä¸Šå­¦æœŸçš„ç¬¬ä¸€ä¸ª90å¤©è®¡åˆ’å¾ˆæˆåŠŸï¼Œè‡ªå·±ä»æ¥æ²¡æƒ³è¿‡è‡ªå·±å…­çº§èƒ½è€ƒ587ã€‚ã€‚ã€‚æ‰€ä»¥è‡ªå·±ç¬¬äºŒä¸ª90å¤©è®¡åˆ’ä¸»è¦æ˜¯ä¸ºäº†æå‡è‡ªå·±çš„CTFæ°´å¹³ï¼Œäº‰å–èƒ½å¤Ÿæ‰“å…¥çº¿ä¸‹ï¼Œç„¶åå†æ°ç‚¹çƒ‚é’±ã€‚ã€‚ã€‚ã€‚ã€‚ï¼ˆå¯¹äºæˆ‘è¿™ä¸ªfwè¿˜æ˜¯å¾ˆéš¾çš„ã€‚ä»Šå¹´ä¸‰é—¨æ•°å­¦ä¸€é—¨ç‰©ç†ï¼Œå¸Œæœ›è‡ªå·±è¿™å››é—¨è¯¾éƒ½èƒ½è€ƒåˆ°60<del>H</del>å§ã€‚ã€‚ã€‚</p><p>è¿™ç¯‡åšå®¢ä¸»è¦æ˜¯è®²ä¸€ä¸‹AESçš„ç®—æ³•ï¼Œä¸Šæ‰¿æ¥ä¸€ä¸‹DESç›¸å…³å†…å®¹ï¼Œä¸‹å¯ä¸€ä¸‹åé¢ä¸¤ç¯‡ç¬”è®°ï¼š<strong>ç¬”è®°3: åŠ å¯†æ¨¡å¼ ã€ç¬”è®°4: Sç›’å·®åˆ†æ”»å‡»</strong></p><p><strong>æ³¨ï¼šè‹¥æ•°å­—æ— åç¼€ï¼Œé»˜è®¤è®¤ä¸ºæ˜¯åè¿›åˆ¶ã€‚åå…­è¿›åˆ¶åç¼€ä¼šåŠ $\text H$ï¼Œä¾‹å¦‚$\text{60H}&#x3D;96$</strong></p><h2 id="2-AES"><a href="#2-AES" class="headerlink" title="2.AES"></a>2.AES</h2><h3 id="0o01-å¯¹DESçš„è¡¥å……å†…å®¹"><a href="#0o01-å¯¹DESçš„è¡¥å……å†…å®¹" class="headerlink" title="0o01 å¯¹DESçš„è¡¥å……å†…å®¹"></a>0o01 å¯¹DESçš„è¡¥å……å†…å®¹</h3><p>åœ¨æ­£å¼è¿›å…¥AESä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¯¹ä¸Šä¸€ç¯‡ç¬”è®°ä¸­çš„DESè¿›è¡Œä¸€äº›è¡¥å……ã€‚</p><p>ç”±äºDESçš„å®‰å…¨æ€§åœ¨ç›®å‰æ¥çœ‹å·²ç»ä¸æ˜¯å¾ˆé«˜äº†ï¼Œ1999å¹´1æœˆï¼Œæœ‰ä¸€ä¸ªè›®åŠ›ç ´è§£DESæŒ‘æˆ˜èµ›ï¼Œæœ‰äººè§£å’ŒDeep Track Internet ä¸Šçš„åˆ†å¸ƒæ”»å‡»ï¼Œè€—æ—¶22å°æ—¶å°±ç ´è§£äº†DESçš„å¯†é’¥ã€‚è€Œåœ¨2006å¹´çš„4æœˆï¼Œå¾·å›½æœ‰ä¸¤æ‰€å¤§å­¦åŸºäºä½å»‰çš„FPGAï¼Œä»…ä»…è€—è´¹äº†ä¸åˆ°70000äººæ°‘å¸çš„ä»·æ ¼ï¼Œæ„å»ºäº†å¯†é’¥æœç´¢æœºå™¨ï¼Œå¹³å‡æœç´¢æ—¶é—´ä»…ä»…7å¤©ã€‚</p><p>å› æ­¤ï¼Œå‡ºç°äº†ä¸€äº›DESçš„æ›¿æ¢ç®—æ³•ï¼Œå…¶ä¸­æœ€å…¸å‹çš„å°±æ˜¯3DESï¼Œæœ‰çš„3DESä½¿ç”¨ä¸‰ä¸ªä¸åŒçš„å¯†é’¥ï¼Œå¯¹æ˜æ–‡è¿ç»­åŠ å¯†ä¸‰æ¬¡ã€‚å½“ç„¶ä¹Ÿæœ‰ä½¿ç”¨ä¸¤ä¸ªå¯†é’¥çš„3DESï¼Œä½¿ç”¨å‡½æ•°å¦‚ä¸‹<br>$$<br>c&#x3D;E_1(D_2(E_1(m)))<br>$$<br>ä¹Ÿå°±æ˜¯å…ˆç”¨å¯†é’¥$k_1$å¯¹æ˜æ–‡è¿›è¡ŒåŠ å¯†ï¼Œç„¶åç”¨å¯†é’¥$k_2$å¯¹åŠ å¯†åå†…å®¹è¿›è¡Œè§£å¯†ï¼Œæœ€åå†ç”¨å¯†é’¥$k_1$å¯¹å†…å®¹è¿›è¡ŒåŠ å¯†ï¼Œè¾“å‡ºæœ€ç»ˆçš„å¯†æ–‡ã€‚</p><p>å½“ç„¶ï¼Œè¿™ç§åŠ å¯†æ–¹æ³•ä¹Ÿä»…ä»…æ˜¯åœ¨DESä¸ŠåŠ äº†ä¸ªå˜ä½“ï¼Œè§£å¯†å‡½æ•°ä¹Ÿæ˜¯ä¸‰æ¬¡<br>$$<br>m&#x3D;D_1(E_2(D_1(c)))<br>$$<br>ä½†è¿™è¾¹æœ‰ä¸ªé—®é¢˜å°±æ˜¯3DESè€—æ—¶å¢åŠ è‡³åŸæ¥çš„$3$å€ï¼Œæ¯”è¾ƒå½±å“æ•ˆç‡</p><p>DESåŠ å¯†ç®—æ³•æœ‰å‡ ä¸ªå¼±å¯†é’¥ï¼Œè¿™äº›å¯†é’¥æœ‰ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯åœ¨åˆ†ç»„åï¼Œä¼šä½¿å¾—$C$å’Œ$D$æ— è®ºæ€ä¹ˆå·¦ç§»ï¼Œå‡ä¸ºå…¨$0$æˆ–è€…å…¨$1$çš„128ä½åºåˆ—ã€‚</p><p>DESçš„å¼±å¯†é’¥åœ¨ä¸è€ƒè™‘ç¬¬å…«ä½æ ¡éªŒä½çš„æƒ…å†µä¸‹ï¼Œä¸€å…±æœ‰å…«ä¸ªå¼±å¯†é’¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">0x0101010101010101</span><br><span class="hljs-number">0xFEFEFEFEFEFEFEFE</span><br><span class="hljs-number">0xE0E0E0E0F1F1F1F1</span><br><span class="hljs-number">0x1F1F1F1F0E0E0E0E</span><br><span class="hljs-number">0x0000000000000000</span><br><span class="hljs-number">0xFFFFFFFFFFFFFFFF</span><br><span class="hljs-number">0xE1E1E1E1F0F0F0F0</span><br><span class="hljs-number">0x1E1E1E1E0F0F0F0F</span><br></code></pre></td></tr></table></figure><p>å¦‚æœç”¨è¿™$8$ä¸ªå¼±å¯†é’¥åŠ å¯†æ˜æ–‡$m$ï¼Œä¼šå‡ºç°ä¸€ä¸ªå¾ˆå¥½ç©çš„ç°è±¡ï¼š<br>$$<br>m&#x3D;E(c)&#x3D;E(E(m))<br>$$<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹æ˜æ–‡ä¸¤æ¬¡åŠ å¯†ï¼Œå°±å¯ä»¥å¾—åˆ°åŸæ¥çš„æ˜æ–‡ã€‚</p><h3 id="0o02-AESç®€ä»‹"><a href="#0o02-AESç®€ä»‹" class="headerlink" title="0o02 AESç®€ä»‹:"></a>0o02 AESç®€ä»‹:</h3><p>AESä¸DESä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€ç§å¯¹ç§°åˆ†ç»„å¯†ç ã€‚å…¶åˆ†ç»„å¤§å°æ¯”DESè¦å¤§ï¼Œæœ‰$128,192,256$ä½ä¸‰ç§é•¿åº¦çš„å¯†é’¥ï¼Œä½†AESä¸­æ¯ä¸ªåˆ†ç»„ä¸€èˆ¬å‡ä¸º$128$ä½ï¼Œå…¶ä¸»è¦æ“ä½œç®€å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2021/09/01/BlockCipher2/1.png" alt="1"></p><p>è€ŒåŠ å¯†è½®æ•°ä¸€èˆ¬ä¹Ÿæœ‰å›ºå®šè§„åˆ™â€”â€”åœ¨$128$ä½å¯†é’¥ä¸‹åŠ å¯†$10$æ¬¡ï¼Œ$192$ä½å¯†é’¥ä¸‹åŠ å¯†$12$æ¬¡ï¼Œ$256$ä½å¯†é’¥ä¸‹åŠ å¯†$14$æ¬¡ã€‚è€ŒåŠ å¯†è½®æ•°è¾ƒå°‘çš„ä¸€ä¸ªä¸»è¦åŸå› å°±æ˜¯AESä¸DESä¸ä¸€æ ·ï¼Œæ¯æ¬¡ç›´æ¥å¯¹æ‰€æœ‰çš„$128$ä½è¿›è¡Œäº†å¤„ç†ã€‚</p><p>AESçš„æ€»ä½“åŠ å¯†æ¡†å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2021/09/01/BlockCipher2/2.png" alt="2"></p><p>AESä¸­ï¼Œå¯¹äºæ¯ä¸€è½®åŠ å¯†æœ‰ä¸‰å±‚ï¼Œç¬¬ä¸€å±‚æ˜¯å­—èŠ‚ä»£æ¢å±‚ï¼Œåœ¨è¿™é‡Œä½¿ç”¨$S$ç›’ï¼Œå¯¹æ¯ä¸ªå­—èŠ‚å…ƒç´ (8bit)æ ¹æ®$S$ç›’çš„å˜æ¢è§„åˆ™è¿›è¡Œéçº¿æ€§å˜æ¢ã€‚</p><p>ç¬¬äºŒå±‚æ˜¯æ‰©æ•£å±‚ï¼Œç”±ShiftRowså’ŒMixColumnã€‚å…¶ä¸­ShiftRowsæ˜¯å¯¹è¡Œçš„ä½ç§»å˜åŒ–ï¼Œåœ¨ä½çº§åˆ«è¿›è¡Œæ•°æ®ç½®æ¢ã€‚è€ŒMixColumnæ˜¯å¯¹åˆ—çš„æ··æ·†å˜æ¢ï¼Œåˆå¹¶é•¿åº¦ä¸ºå››ä¸ªå­—èŠ‚(32bit)çš„æ•°æ®ã€‚</p><p>ç¬¬ä¸‰å±‚æ˜¯å¯†é’¥åŠ æ³•å±‚ï¼Œè¿™é‡Œä¸»è¦æ˜¯é€šè¿‡$128$ä½çš„è½®å¯†é’¥ï¼Œä¸çŠ¶æ€è¿›è¡Œå¼‚æˆ–æ“ä½œçš„è¿‡ç¨‹ã€‚</p><p>åœ¨AESä¸­ï¼Œæˆ‘ä»¬è¿˜ä¼šæ¶‰åŠåˆ°åœ¨$GF(256)$ä¸­çš„æ“ä½œï¼Œè¿™é‡Œç”¨çš„æ˜¯ä¸å¯çº¦å¤šé¡¹å¼$x^8+x^4+x^3+x+1$ã€‚$GF(256)$ä¸‹å¯¹äºè¯¥å¤šé¡¹å¼æœ‰å¦‚ä¸‹çš„é€†å…ƒè¡¨ï¼ˆä¸ºæ–¹ä¾¿æœŸé—´ä¸é¿å…äº‰è®®ï¼Œç‰¹åˆ«è§„å®š$0$çš„é€†å…ƒä¸º$0$ï¼‰ã€‚</p><p><img src="/2021/09/01/BlockCipher2/3.png" alt="3"></p><p>ä¸¾ä¸ªä¾‹å­ï¼šä¸Šè¡¨ä¸­$\mathrm{00H}$è¡¨ç¤º$0$ï¼Œ$\mathrm{C2H}$è¡¨ç¤ºäºŒè¿›åˆ¶çš„$\text{1100 0010B}$ï¼Œå¯¹åº”å¤šé¡¹å¼å°±æ˜¯$x^7+x^6+x$ï¼Œå®ƒçš„é€†å…ƒä¸º$\mathrm{25H}$ï¼Œå…¶è¡¨ç¤ºå¤šé¡¹å¼ä¸º$x^5+x^3+x^2+1$ï¼Œè¿™ä¸¤ä¸ªå¼å­ç›¸ä¹˜ï¼Œå¹¶å¯¹$x^8+x^4+x^3+x+1$å–æ¨¡ï¼Œç»“æœæ°å¥½æ˜¯$1$ã€‚</p><h3 id="0o03-AESåŠ å¯†è¿‡ç¨‹"><a href="#0o03-AESåŠ å¯†è¿‡ç¨‹" class="headerlink" title="0o03 AESåŠ å¯†è¿‡ç¨‹"></a>0o03 AESåŠ å¯†è¿‡ç¨‹</h3><h4 id="Step-1-AESå†…éƒ¨ç»“æ„"><a href="#Step-1-AESå†…éƒ¨ç»“æ„" class="headerlink" title="Step 1 AESå†…éƒ¨ç»“æ„"></a>Step 1 AESå†…éƒ¨ç»“æ„</h4><p><img src="/2021/09/01/BlockCipher2/4.png" alt="4"></p><h4 id="Step-2å­—èŠ‚ä»£æ¢å±‚"><a href="#Step-2å­—èŠ‚ä»£æ¢å±‚" class="headerlink" title="Step 2å­—èŠ‚ä»£æ¢å±‚"></a>Step 2å­—èŠ‚ä»£æ¢å±‚</h4><p>ç”±äº$128$ä½å¯¹åº”åå…­ä¸ªå­—èŠ‚ï¼Œå› æ­¤å­—èŠ‚ä»£æ¢ä¸­ï¼Œæœ‰ç‰¹å®šçš„$S$ç›’ã€‚å…¶æ•°å€¼å¦‚ä¸‹ï¼ˆåè¿›åˆ¶ï¼‰ï¼š</p><p><img src="/2021/09/01/BlockCipher2/5.png" alt="5"></p><p>è¿™ä¸ª$S$ç›’æœ‰ä¸ªç‰¹ç‚¹å°±æ˜¯ï¼šä¸å­˜åœ¨$x\in [0,255]$ä½¿å¾—$S(x)&#x3D;x$ã€‚</p><p>å› æ­¤ï¼Œå³ä½¿æˆ‘ä»¬è¾“å…¥çš„å†…å®¹æ˜¯$(0,0,0,â€¦,0)$ï¼Œåˆ°ä¸€æ¬¡$S$ç›’æœ€åä¹Ÿä¼šè¾“å‡ºåè¿›åˆ¶$(99,99,99,â€¦,99)$ï¼Œç„¶åå†ç»è¿‡$S$ç›’å˜æˆåè¿›åˆ¶$(251,251,251,â€¦,251)$ã€‚å› æ­¤ï¼ŒAESä¸DESä¸åŒï¼Œ<strong>å®ƒä¸å­˜åœ¨å¼±å¯†é’¥</strong>ã€‚</p><h4 id="Step-3-æ‰©æ•£å±‚å’Œå¯†é’¥åŠ æ³•å±‚"><a href="#Step-3-æ‰©æ•£å±‚å’Œå¯†é’¥åŠ æ³•å±‚" class="headerlink" title="Step 3 æ‰©æ•£å±‚å’Œå¯†é’¥åŠ æ³•å±‚"></a>Step 3 æ‰©æ•£å±‚å’Œå¯†é’¥åŠ æ³•å±‚</h4><p>åœ¨æ‰©æ•£å±‚ä¸­ï¼Œå¯¹åå…­ä¸ª$B$ï¼Œè¿›è¡Œäº†å¦‚ä¸‹çš„æ“ä½œï¼š</p><p>é¦–å…ˆæ˜¯ä½ç½®æ›¿æ¢ï¼Œä¸‹æ ‡å€¼æŒ‰ç…§$(0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11)$çš„è§„åˆ™é‡æ–°æ’åˆ—æˆæ–°çš„é¡ºåºã€‚</p><p>ç„¶åæ˜¯åˆ—ç½®æ¢ï¼Œ$B_0,B_5,B_{10},B_{15}$é€šè¿‡ä¸‹é¢çš„æ“ä½œï¼Œè·å¾—äº†$C_0$åˆ°$C_4$</p><p><img src="/2021/09/01/BlockCipher2/6.png" alt="6"></p><p>è¿™è¾¹è¯´ä¸€ä¸‹ï¼Œè¿™é‡Œçš„$01,02,03$ä»£è¡¨ç€$(1,x,x+1)$ï¼Œæ•´ä¸ªå¼å­çš„è®¡ç®—æ˜¯åŸºäº$GF(256)$çš„å¤šé¡¹å¼è¿ç®—ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœ$B_0&#x3D;99$ï¼Œé‚£ä¹ˆå°±æ˜¯è½¬åŒ–æˆ$x^6+x^5+x+1$ï¼Œç„¶åæœ€åè¿˜æ˜¯å¯¹$x^8+x^4+x^3+x+1$å–æ¨¡å³å¯ã€‚è®¡ç®—å‡ºæ¥çš„å¤šé¡¹å¼å†è½¬åŒ–æˆæ•°å­—å³å¯å¾—åˆ°$C_0$åˆ°$C_3$çš„å€¼ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡$B_4,B_9,B_{14},B_3$ï¼Œç”¨ç»„åˆæˆåˆ—å‘é‡ï¼Œç„¶åç”¨ç›¸åŒçš„çŸ©é˜µå¾—åˆ°$C_4$åˆ°$C_7$çš„å€¼ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>æœ€åå¯¹å¾—åˆ°çš„åå…­ä¸ª$C$å€¼ï¼ˆæ¯ä¸ªæ•°å…«ä½ï¼Œå› æ­¤ä¸€å…±æ˜¯$128$ä½ï¼‰ç»„åˆåœ¨ä¸€èµ·ï¼Œå¯¹å¯†é’¥å¼‚æˆ–å³å¯ã€‚å®Œæˆä¸€è½®çš„åŠ å¯†ã€‚</p><h3 id="0o04-å¯†é’¥ç¼–æ’"><a href="#0o04-å¯†é’¥ç¼–æ’" class="headerlink" title="0o04 å¯†é’¥ç¼–æ’"></a>0o04 å¯†é’¥ç¼–æ’</h3><p>ä¸‹é¢æˆ‘ä»¬ä»¥$128$ä½å¯†é’¥ç¼–æ’ä¸ºä¾‹ï¼Œ$192,256$ä½å¯†é’¥ç¼–æ’åªéœ€è¦æŠŠä¸€è¡Œå››ç»„æ¢æˆå…­ç»„ã€å…«ç»„å³å¯ï¼Œæ€»è½®æ•°æ¢æˆåäºŒè½®å’Œåå››è½®å³å¯ã€‚</p><p><img src="/2021/09/01/BlockCipher2/7.png" alt="7"></p><p>è¿™è¾¹$RC[i]$ä¹Ÿæä¸€ä¸‹ï¼Œå®é™…ä¸Šå°±æ˜¯$x$çš„$i$æ¬¡æ–¹ï¼Œè¿™é‡Œåˆ†åˆ«éœ€è¦ç”¨åˆ°$0,x^1,x^2,â€¦,x^9$ï¼Œæ¨¡å¤šé¡¹å¼ä¸º$x^8+x^4+x^3+x+1$ã€‚å› æ­¤$x^8\equiv x^4+x^3+x+1$ï¼Œ$x^9\equiv x^5+x^4+x^2+x$ã€‚è¿™è¾¹è¿™ä¸ª$g$å‡½æ•°çš„ç›®çš„ä¹Ÿæ˜¯å¢åŠ å¯†é’¥ç¼–æ’çš„éçº¿æ€§å†…å®¹ã€‚ </p><h3 id="0o05-è§£å¯†è¿‡ç¨‹"><a href="#0o05-è§£å¯†è¿‡ç¨‹" class="headerlink" title="0o05 è§£å¯†è¿‡ç¨‹"></a>0o05 è§£å¯†è¿‡ç¨‹</h3><p>ä½œä¸ºå¯¹ç§°å¯†ç ï¼Œè§£å¯†è¿‡ç¨‹ä¸ä¸åŠ å¯†è¿‡ç¨‹å·®ä¸å¤šæ˜¯ä¸€è‡´çš„ã€‚</p><p><img src="/2021/09/01/BlockCipher2/8.png" alt="8"></p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æˆ‘ä»¬åŠ å¯†ä¸­æ‰€åšçš„å†…å®¹é€†å›å»å³å¯ã€‚</p><p>ä¸‹é¢æ˜¯è§£å¯†è¿‡ç¨‹</p><p><img src="/2021/09/01/BlockCipher2/9.png" alt="9"></p><p>å› æ­¤å¯†é’¥åŠ æ³•è¿˜æ˜¯è½®å¯†é’¥ä¸å¯†æ–‡å¼‚æˆ–ï¼Œé€†å‘MixColumnä¸é€†å‘ShiftRowä¹Ÿæ˜¯ä¸€ä¸ªå¯é€†è¿‡ç¨‹ï¼Œç›´æ¥ä¹˜ä¸Šé€†çŸ©é˜µï¼Œåšé€†å˜æ¢å³å¯ã€‚</p><p><img src="/2021/09/01/BlockCipher2/10.png" alt="10"></p><p>é€†çŸ©é˜µçš„å†…å®¹å¦‚ä¸‹ï¼Œè¿™è¾¹çš„$0EH,0BH,0DH,09H$ä»ç„¶æ˜¯$GF(256)$ä¸­çš„å¤šé¡¹å¼ï¼Œå¯ä»¥é€†å›$B$ã€‚</p><p>ç„¶åæ ¹æ®å˜æ¢$(0,13,10,7,4,1,14,11,8,5,2,15,12,9,6,3)$çš„å˜æ¢è§„åˆ™ï¼Œå¾—åˆ°æ‰€æœ‰é€†å‘shiftrowåçš„$B$å€¼ï¼Œæœ€åæ ¹æ®é€†å‘åçš„æ‰€æœ‰$B$å€¼è·å–$A$å€¼ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥è·å¾—$S^{-1}$</p><p><img src="/2021/09/01/BlockCipher2/11.png" alt="11"></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XiangYunCupWP</title>
    <link href="/2021/08/30/XiangYunCupWP/"/>
    <url>/2021/08/30/XiangYunCupWP/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-ç¥¥äº‘æ¯å¯†ç é¢˜wp"><a href="#huangx607087-ç¥¥äº‘æ¯å¯†ç é¢˜wp" class="headerlink" title="huangx607087 ç¥¥äº‘æ¯å¯†ç é¢˜wp"></a>huangx607087 ç¥¥äº‘æ¯å¯†ç é¢˜wp</h1><h2 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0. ç®€ä»‹"></a>0. ç®€ä»‹</h2><p>å‰å‡ å¤©æ‰“äº†ä¸€ä¸‹ç¥¥äº‘æ¯çš„å¯†ç é¢˜ï¼Œ4é“é¢˜ç›®ï¼Œåœ¨åˆ«äººæŒ‡æŒ‡ç‚¹ç‚¹ä¸‹ï¼Œå†™äº†ä¸‰é“é¢˜ï¼Œè¿™å‡ å¤©å®Œå–„ä¸€ä¸‹è‡ªå·±çš„wp</p><h2 id="1-Guess"><a href="#1-Guess" class="headerlink" title="1.Guess"></a>1.Guess</h2><p>æ‹¿åˆ°é¢˜ç›®åï¼Œå…ˆå®¡è®¡ä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#task.py</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> (<br>    bytes_to_long,<br>    getPrime,<br>    long_to_bytes,<br>    getRandomNBitInteger,<br>)<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd<br><span class="hljs-keyword">import</span> socketserver<br>KEYSIZE = <span class="hljs-number">512</span><br>WELCOME = <span class="hljs-string">&quot;welcome to my funny challenge !!! Can you guess right 32 times in a row? &quot;</span><br>String = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exgcd</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, a<br>    <span class="hljs-keyword">else</span>:<br>        x, y, q = exgcd(b, a % b)<br>        x, y = y, (x - (a // b) * y)<br>        <span class="hljs-keyword">return</span> x, y, q<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">invert</span>(<span class="hljs-params">a,p</span>):<br>    x, y, q = exgcd(a,p)<br>    <span class="hljs-keyword">if</span> q != <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;No solution.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> (x + p) % p<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lcm</span>(<span class="hljs-params">a,b</span>):<br>    <span class="hljs-keyword">return</span> a*b // gcd(a,b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>():<br>    STR = <span class="hljs-string">&quot;&quot;</span>.join([String[random.randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(String) - <span class="hljs-number">1</span>)] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)])<br>    HASH = hashlib.sha256(STR.encode()).hexdigest()<br>    <span class="hljs-keyword">return</span> STR[:<span class="hljs-number">4</span>], STR[<span class="hljs-number">4</span>:], HASH<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>():<br>    <span class="hljs-comment"># part 1</span><br>    p, q = getPrime(KEYSIZE), getPrime(KEYSIZE)<br>    n = p * q<br>    g = n + <span class="hljs-number">1</span><br>    LAMBDA = lcm(p - <span class="hljs-number">1</span>, q - <span class="hljs-number">1</span>)<br>    <span class="hljs-comment"># part 2</span><br>    _key = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;key&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).read()<br>    key = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> _key.split(<span class="hljs-string">&quot;\n&quot;</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> i[<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>].split(<span class="hljs-string">&quot; &quot;</span>):<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(j) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> key:<br>                key.append(<span class="hljs-built_in">int</span>(j))<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(key) == <span class="hljs-number">80</span><br>    <span class="hljs-keyword">assert</span> key[<span class="hljs-number">0</span>] == <span class="hljs-number">119</span> <span class="hljs-keyword">and</span> key[<span class="hljs-number">1</span>] ==  <span class="hljs-number">241</span> <span class="hljs-keyword">and</span> key[<span class="hljs-number">2</span>] ==  <span class="hljs-number">718</span> <span class="hljs-keyword">and</span> key[<span class="hljs-number">3</span>] == <span class="hljs-number">647</span><br>    <span class="hljs-keyword">return</span> n, g, LAMBDA, key<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">enc</span>(<span class="hljs-params">n, g, m</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        r = random.randint(<span class="hljs-number">2</span>, n - <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> gcd(r, n) == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">break</span><br>    c = (<span class="hljs-built_in">pow</span>(g, m, n ** <span class="hljs-number">2</span>) * <span class="hljs-built_in">pow</span>(r, n, n ** <span class="hljs-number">2</span>)) % (n ** <span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">return</span> c<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dec</span>(<span class="hljs-params">n, g, LAMBDA, c</span>):<br>    L1 = (<span class="hljs-built_in">pow</span>(c, LAMBDA, n ** <span class="hljs-number">2</span>) - <span class="hljs-number">1</span>) // n<br>    L2 = (<span class="hljs-built_in">pow</span>(g, LAMBDA, n ** <span class="hljs-number">2</span>) - <span class="hljs-number">1</span>) // n<br>    m = (invert(L2, n) * L1) % n<br>    <span class="hljs-keyword">return</span> m<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">server</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recv</span>(<span class="hljs-params">self</span>):<br>        data = <span class="hljs-variable language_">self</span>.request.recv(<span class="hljs-number">1024</span>)<br>        <span class="hljs-keyword">return</span> data.strip()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(msg, <span class="hljs-built_in">bytes</span>):<br>            msg += <span class="hljs-string">b&quot;\n&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            msg += <span class="hljs-string">&quot;\n&quot;</span><br>            msg = msg.encode()<br>        <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Service start.&quot;</span>)<br>        START, END, HASH = proof_of_work()<br>        <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;SHA-256(?+&#123;&#125;) == &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(END, HASH))<br>        RCV = <span class="hljs-variable language_">self</span>._recv().decode()<br>        <span class="hljs-keyword">if</span> RCV != START:<br>            <span class="hljs-keyword">return</span><br>        flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read()<br>        <span class="hljs-variable language_">self</span>._send(WELCOME)<br>        <span class="hljs-comment"># step 1. KeyGen</span><br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;round &quot;</span> + <span class="hljs-built_in">str</span>(_+<span class="hljs-number">1</span>))<br>            n, g, LAM, KEY = keygen()<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;Step 1 - KeyGen. This is my public key.&quot;</span>)<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;n = &quot;</span> + <span class="hljs-built_in">str</span>(n))<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;g = &quot;</span> + <span class="hljs-built_in">str</span>(g))<br>            <span class="hljs-comment"># step 2. Phase 1</span><br>            <span class="hljs-variable language_">self</span>._send(<br>                <span class="hljs-string">&quot;Step 2 - Phase 1. Now, you can give me one ciphertexts,I will return the corresponding plaintext.&quot;</span><br>            )<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;Please give me one decimal ciphertext.&quot;</span>)<br>            cipher = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>._recv().decode())<br>            plaintext = <span class="hljs-built_in">str</span>(dec(n, g, LAM, cipher))<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;This is the corresponding plaintext.&quot;</span>)<br>            <span class="hljs-variable language_">self</span>._send(plaintext)<br><br>            <span class="hljs-comment"># step 3. challenge</span><br>            <span class="hljs-variable language_">self</span>._send(<br>                <span class="hljs-string">&quot;Step 3 - Challenge. Now, you must give me two decimal plaintexts(m0,m1), I will encry them and return a ciphertext randomly&quot;</span><br>            )<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;Give me m0.&quot;</span>)<br>            plaintext1 = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>._recv().decode())<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;Give me m1.&quot;</span>)<br>            plaintext2 = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>._recv().decode())<br><br>            <span class="hljs-keyword">if</span> (<br>                plaintext1 &lt;= <span class="hljs-number">2</span><br>                <span class="hljs-keyword">or</span> plaintext2 &lt;= <span class="hljs-number">2</span><br>                <span class="hljs-keyword">or</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(plaintext1)) != <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(plaintext2))<br>            ):<br>                <span class="hljs-keyword">return</span><br>            R = <span class="hljs-number">2</span> * random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">39</span>)<br>            I = random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>            cipher1 = enc(n, g, plaintext1 * plaintext2 * KEY[R])<br>            cipher2 = enc(n, g, plaintext1 * plaintext2 * KEY[R + <span class="hljs-number">1</span>])<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;This is a ciphertext.&quot;</span>)<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-built_in">str</span>([cipher1, cipher2][I]))<br>            <span class="hljs-comment"># step 4. Phase 2</span><br>            <span class="hljs-variable language_">self</span>._send(<br>                <span class="hljs-string">&quot;Step 4 - Phase 2. Now, you can give me some ciphertexts,I will return the corresponding plaintext.But you can not give me the ciphertext that I give you in step 3.&quot;</span><br>            )<br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;Please give me one decimal ciphertext &quot;</span>)<br>            cipher = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>._recv().decode())<br>            plaintext = <span class="hljs-built_in">str</span>(dec(n, g, LAM, cipher))<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(plaintext) == plaintext1 * plaintext2 * KEY[R] <span class="hljs-keyword">or</span> <span class="hljs-built_in">int</span>(plaintext) == plaintext1 * plaintext2 * KEY[R+<span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">return</span><br>            <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;This is the corresponding plaintext.&quot;</span>)<br>            <span class="hljs-variable language_">self</span>._send(plaintext)<br>            <span class="hljs-comment"># step.5 Guess</span><br>            <span class="hljs-variable language_">self</span>._send(<br>                <span class="hljs-string">&quot;Step 5 - Guess. You must tell me which ciphertext was I give you in step 3, 0 or 1(m0 -&gt; c0 , m1 -&gt; c1)?&quot;</span><br>            )<br>            Guess = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>._recv().decode())<br>            <span class="hljs-keyword">if</span> Guess == I:<br>                <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;Good! You are right&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;Sorry!&quot;</span>)<br>                <span class="hljs-keyword">return</span><br>        <span class="hljs-variable language_">self</span>._send(flag)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&quot;0.0.0.0&quot;</span>, <span class="hljs-number">10001</span><br>    server = ForkedServer((HOST, PORT), server)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br></code></pre></td></tr></table></figure><p>ç„¶åé¢˜ç›®è¿˜ç»™å‡ºäº†ä¸€ä¸ªkeyçš„åŠ å¯†æ–¹æ³•ï¼Œå¹¶ç»™å‡ºäº†hintæ–‡ä»¶ç”¨äºæ±‚keyã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getRandomNBitInteger<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    A = []<br>    key = random_matrix(ZZ, <span class="hljs-number">20</span>, <span class="hljs-number">4</span>, x = <span class="hljs-number">100</span>, y =<span class="hljs-number">1000</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            <span class="hljs-keyword">if</span> key[i,j] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> A:   <br>                A.append(key[i,j])<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(A) == <span class="hljs-number">80</span>:<br>        <span class="hljs-keyword">break</span><br>hint = Matrix(key * vector([getRandomNBitInteger(<span class="hljs-number">1024</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>))<br>Matrix(M* vector([randint(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>))<br><span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;key&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>).write(<span class="hljs-built_in">str</span>(key))<br><span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;hint&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>).write(<span class="hljs-built_in">str</span>(hint))<br></code></pre></td></tr></table></figure><p><code>    key = random_matrix(ZZ, 20, 4, x = 100, y =1000)</code>è¿™ä¸ªä»£ç è¡¨ç¤ºåœ¨æ•´æ•°å®šä¹‰åŸŸå†…ç”Ÿæˆä¸€ä¸ª$20$è¡Œ$4$åˆ—ï¼Œå®šä¹‰åŸŸä¸ºæ•´æ•°çš„çŸ©é˜µï¼Œå…¶ä¸­çŸ©é˜µä¸­æœ€å°æ•°å­—ä¸å°äº$100$ï¼Œæœ€å¤§æ•°å­—ä¸è¶…è¿‡$1000$ã€‚ç„¶ååˆæ³¨æ„åˆ°hintåˆæ˜¯ä¸€ä¸ª<code>key*vector</code>çš„çŸ©é˜µï¼Œå…¶ä¸­<code>vector</code>ä¸­çš„æ‰€æœ‰æ•°å­—éƒ½æ˜¯$1024$ä¸ªæ¯”ç‰¹ã€‚</p><p>å› æ­¤ï¼Œé€šè¿‡è¿™ä¸ªkeyçš„åŠ å¯†æ–¹æ³•æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼šç”±äºè¿™é‡Œæ˜¯å³ä¹˜å‘é‡ï¼Œå› æ­¤è¿™è¾¹æ‰€æœ‰çš„å‘é‡éƒ½æ˜¯åˆ—å‘é‡ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç†è§£æˆä¸€ä¸ª$20$è¡Œ$4$åˆ—çš„çŸ©é˜µï¼Œä¹˜ä¸Šä¸€ä¸ª$4$è¡Œ$12$åˆ—çš„çŸ©é˜µï¼Œå¾—åˆ°ä¸€ä¸ª$20$è¡Œ$12$åˆ—çš„çŸ©é˜µã€‚è€Œæœ€åçš„hintæ˜¯$12$è¡Œ$20$åˆ—ã€‚å› æ­¤æˆ‘ä»¬è¯»å…¥æ•°æ®åï¼Œéœ€è¦è½¬ç½®ä¸€ä¸‹ã€‚</p><p>çœ‹åˆ°çŸ©é˜µã€åˆçœ‹åˆ°äº†éå¸¸å°çš„æ•°å­—ï¼ˆå‡ ç™¾ï¼‰å’Œéå¸¸å¤§çš„æ•°å­—ï¼ˆ$O(2^{1024})$çº§åˆ«çš„æ•°å­—ï¼‰ï¼Œå› æ­¤å¾ˆæ˜¾ç„¶è¿™é‡Œéœ€è¦ä¸Šä¸€ä¸‹LLLâ€”â€”é—®é¢˜æ˜¯æ€ä¹ˆä¸Šè¿™ä¸ªLLLè¿˜æ˜¯ä¸ªé—®é¢˜ã€‚</p><p>æˆ‘ä»¬è¿™å°±æ¥ç®€å•åœ°è¯´ä¸€ä¸‹è¿™ä¸ªæ˜¯æ€ä¹ˆåšçš„ã€‚</p><p>ç”±äºå°æ•°ä¸å¤§æ•°çš„çº¿æ€§ç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<br>$$<br>\sum_{i&#x3D;1}^{20} a_ix_i&#x3D;S_H<br>$$<br>å› æ­¤ï¼Œ$(a_1,a_2,a_3,a_4,â€¦,a_{20},0)$ä¹Ÿæ˜¯ä¸€ä¸ªå°å‘é‡ï¼Œå¹¶ä¸”åœ¨æ•°æ®è§„æ¨¡ç›¸å·®å·¨å¤§çš„æƒ…å†µä¸‹â€”â€”å¯ä»¥è®¤ä¸ºè¿™ä¸ªæ˜¯æœ€çŸ­å‘é‡ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹è¯»å…¥åçš„$M$çŸ©é˜µå…ˆè¿›è¡Œéšæ„æ‰“ä¹±ï¼Œç„¶åéšå³è°ƒæ•´LLLæ—¶çš„å‚æ•°å°±å¯ä»¥å¾—åˆ°é¢˜ç›®ä¸­ç»™å‡ºçš„å››ç»„è§£äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">L</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> L:<br>        <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>,<span class="hljs-number">1001</span>):<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;hint.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>D=f.readlines()<br>Numbers=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> D:<br>    dataln=i[<span class="hljs-number">1</span>:-<span class="hljs-number">2</span>].split(<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> dataln:<br>        Numbers.append(<span class="hljs-built_in">int</span>(j))<br>M=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(Numbers),<span class="hljs-number">20</span>):<br>    M.append(Numbers[i:i+<span class="hljs-number">20</span>])<br>Lns=[]<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(Lns)&lt;<span class="hljs-number">4</span>:<br>    shuffle(M)<br>    Mlll=matrix(<span class="hljs-number">12</span>,<span class="hljs-number">20</span>,M).LLL(delta=<span class="hljs-built_in">float</span>(randint(<span class="hljs-number">25000</span>, <span class="hljs-number">99999</span>)/<span class="hljs-number">100000</span>))<br>    <span class="hljs-keyword">for</span> dataln <span class="hljs-keyword">in</span> Mlll:<br>        <span class="hljs-keyword">if</span> dataln[<span class="hljs-number">0</span>]&lt;<span class="hljs-number">0</span>:<br>            dataln=-dataln<br>        <span class="hljs-keyword">if</span> dataln <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> Lns <span class="hljs-keyword">and</span> check(dataln):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(Lns),dataln)<br>            Lns.append(dataln)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">0 (241, 232, 548, 400, 186, 333, 646, 727, 286, 877, 810, 121, 237, 745, 201, 542, 244, 396, 158, 641)</span><br><span class="hljs-string">1 (119, 521, 142, 637, 614, 746, 299, 416, 638, 288, 995, 498, 639, 585, 114, 885, 558, 783, 899, 751)</span><br><span class="hljs-string">2 (718, 550, 349, 939, 148, 355, 942, 685, 313, 577, 184, 130, 307, 983, 611, 903, 271, 530, 566, 427)</span><br><span class="hljs-string">3 (647, 918, 613, 936, 461, 281, 977, 888, 128, 653, 309, 780, 526, 216, 944, 123, 430, 860, 113, 129)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>è§£å‡ºæ‰€æœ‰çš„keyä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®é¢˜ç›®assertçš„å†…å®¹ï¼Œé‡æ–°è°ƒæ•´keyä¸­æ‰€æœ‰æ•°å­—çš„å†…å®¹ï¼Œè¿™æ˜¯æœ€ç»ˆè°ƒæ•´å‡ºæ¥çš„çœŸæ­£çš„keyæ•°ç»„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">key=[<span class="hljs-number">119</span>, <span class="hljs-number">241</span>, <span class="hljs-number">718</span>, <span class="hljs-number">647</span>, <span class="hljs-number">521</span>, <span class="hljs-number">232</span>, <span class="hljs-number">550</span>, <span class="hljs-number">918</span>, <span class="hljs-number">142</span>, <span class="hljs-number">548</span>, <span class="hljs-number">349</span>, <span class="hljs-number">613</span>, <span class="hljs-number">637</span>, <span class="hljs-number">400</span>, <span class="hljs-number">939</span>, <span class="hljs-number">936</span>, <span class="hljs-number">614</span>, <span class="hljs-number">186</span>, <span class="hljs-number">148</span>, <span class="hljs-number">461</span>, <span class="hljs-number">746</span>, <span class="hljs-number">333</span>, <span class="hljs-number">355</span>, <span class="hljs-number">281</span>, <span class="hljs-number">299</span>, <span class="hljs-number">646</span>, <span class="hljs-number">942</span>, <span class="hljs-number">977</span>, <span class="hljs-number">416</span>, <span class="hljs-number">727</span>, <span class="hljs-number">685</span>, <span class="hljs-number">888</span>, <span class="hljs-number">638</span>, <span class="hljs-number">286</span>, <span class="hljs-number">313</span>, <span class="hljs-number">128</span>, <span class="hljs-number">288</span>, <span class="hljs-number">877</span>, <span class="hljs-number">577</span>, <span class="hljs-number">653</span>, <span class="hljs-number">995</span>, <span class="hljs-number">810</span>, <span class="hljs-number">184</span>, <span class="hljs-number">309</span>, <span class="hljs-number">498</span>, <span class="hljs-number">121</span>, <span class="hljs-number">130</span>, <span class="hljs-number">780</span>, <span class="hljs-number">639</span>, <span class="hljs-number">237</span>, <span class="hljs-number">307</span>, <span class="hljs-number">526</span>, <span class="hljs-number">585</span>, <span class="hljs-number">745</span>, <span class="hljs-number">983</span>, <span class="hljs-number">216</span>, <span class="hljs-number">114</span>, <span class="hljs-number">201</span>, <span class="hljs-number">611</span>, <span class="hljs-number">944</span>, <span class="hljs-number">885</span>, <span class="hljs-number">542</span>, <span class="hljs-number">903</span>, <span class="hljs-number">123</span>, <span class="hljs-number">558</span>, <span class="hljs-number">244</span>, <span class="hljs-number">271</span>, <span class="hljs-number">430</span>, <span class="hljs-number">783</span>, <span class="hljs-number">396</span>, <span class="hljs-number">530</span>, <span class="hljs-number">860</span>, <span class="hljs-number">899</span>, <span class="hljs-number">158</span>, <span class="hljs-number">566</span>, <span class="hljs-number">113</span>, <span class="hljs-number">751</span>, <span class="hljs-number">641</span>, <span class="hljs-number">427</span>, <span class="hljs-number">129</span>]<br></code></pre></td></tr></table></figure><p>è§£å‡ºè¿™ä¸ªkeyä¹‹åï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†é‡Œé¢æ‰€æœ‰çš„å†…å®¹ï¼Œç„¶åçœ‹åˆ°é¢˜ç›®ä¸­çš„ä»£ç æ˜¯PaillieråŒæ€åŠ å¯†ç®—æ³•ï¼Œè¿™ä¸ªç®—æ³•æœ‰ä¸ªç‰¹ç‚¹å°±æ˜¯å®ƒå…·æœ‰åŒæ€æ€§ã€‚å› ä¸ºå®ƒçš„åŠ å¯†è¡¨è¾¾å¼ä¸ºï¼š<br>$$<br>c\equiv g^{m}r^{n} \pmod {n^{2}}<br>$$<br>å…¶ä¸­$g,r$å‡ä¸ºä¸$n$äº’è´¨çš„éšæœºæ•° ï¼Œæ˜¯åŠ å¯†å‰å·²ç»ç¡®å®šå¥½çš„å†…å®¹äº†ã€‚å› æ­¤æˆ‘ä»¬å¦‚æœå·²çŸ¥$c_1$æ˜¯$m_1$çš„åŠ å¯†ç»“æœï¼Œ$c_2$æ˜¯$m_2$çš„åŠ å¯†ç»“æœï¼Œé‚£ä¹ˆ$m_1+m_2$çš„åŠ å¯†çš„ç»“æœå°±æ˜¯$c_1c_2$ã€‚</p><p>æ‰€ä»¥åˆ©ç”¨è¿™ä¸€æ€§è´¨ï¼Œæˆ‘ä»¬åªéœ€è¦æ¯æ¬¡å‘é€ä¸€ä¸ª$m_{99}$ï¼Œå°†$c$æ¥æ”¶åå‘é€ä¸ª$c^2$è¿‡å»ï¼Œç„¶åé™¤ä»¥$2m_{99}^2$ï¼Œåˆ¤æ–­ä¸€ä¸‹æœ€åè§£å¯†å‡ºçš„å€¼åœ¨keyæ•°ç»„ä¸­ä¸‹æ ‡çš„å¥‡å¶æ€§å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> KEY3 <span class="hljs-keyword">import</span> key<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyzm</span>(<span class="hljs-params">s12,s64</span>):<br>s12,s64=s12.decode(),s64.decode()<br>Table=<span class="hljs-string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Table:<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> Table:<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> Table:<br><span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> Table:<br>s4=i+j+k+l<br>s16=s4+s12<br><span class="hljs-keyword">if</span>(sha256(s16.encode()).hexdigest()==s64):<br><span class="hljs-keyword">return</span> s4<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recpas</span>(<span class="hljs-params">sh,T=<span class="hljs-number">1</span></span>):<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(T):<br>s=sh.recvline()<br><span class="hljs-keyword">return</span> s<br><span class="hljs-comment">#----------MAIN BELOW----------#</span><br>sh=remote(<span class="hljs-string">&quot;47.104.85.225&quot;</span>,<span class="hljs-number">57811</span>)<br>s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(s1)<br>sh.sendline(getyzm(s1[<span class="hljs-number">10</span>:<span class="hljs-number">22</span>],s1[<span class="hljs-number">27</span>:<span class="hljs-number">91</span>]))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>m99=randint(<span class="hljs-number">3</span>,<span class="hljs-number">9001</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Round <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span>/32 Begins with using m99=<span class="hljs-subst">&#123;m99&#125;</span>&quot;</span>)<br>sh.recvuntil(<span class="hljs-string">b&quot;n = &quot;</span>)<br>n=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>sh.recvuntil(<span class="hljs-string">b&quot;g = &quot;</span>)<br>g=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>recpas(sh,<span class="hljs-number">2</span>)<br>sh.send(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;m99&#125;</span>\n&quot;</span>)<br>c99=<span class="hljs-built_in">int</span>(recpas(sh,<span class="hljs-number">2</span>))<br><span class="hljs-comment">#print(m99,c99)</span><br>recpas(sh,<span class="hljs-number">2</span>)<br>sh.send(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;m99&#125;</span>\n&quot;</span>)<br>recpas(sh)<br>sh.send(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;m99&#125;</span>\n&quot;</span>)<br>c=<span class="hljs-built_in">int</span>(recpas(sh,<span class="hljs-number">2</span>))<br><span class="hljs-comment">#print(c)</span><br>recpas(sh,<span class="hljs-number">2</span>)<br>sh.send(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;<span class="hljs-built_in">pow</span>(c,<span class="hljs-number">2</span>,n**<span class="hljs-number">2</span>)&#125;</span>\n&quot;</span>)<br>m=<span class="hljs-built_in">int</span>(recpas(sh,<span class="hljs-number">2</span>))<br><span class="hljs-comment">#print(f&quot;&#123;m&#125;&quot;)</span><br>recpas(sh)<br>sh.send(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;key.index(m//(<span class="hljs-number">2</span>*m99**<span class="hljs-number">2</span>))%<span class="hljs-number">2</span>&#125;</span>\n&quot;</span>)<br><span class="hljs-built_in">print</span>(recpas(sh))<br>sh.interactive()<br><span class="hljs-comment">#flag&#123;e87fdfb6-8007-4e1c-861f-5bde3c8badb3&#125;</span><br></code></pre></td></tr></table></figure><h2 id="2-myRSA"><a href="#2-myRSA" class="headerlink" title="2.myRSA"></a>2.myRSA</h2><p>é¢˜ç›®ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># myRSA</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime,bytes_to_long <span class="hljs-keyword">as</span> b2l<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> socketserver<br>KEYSIZE = <span class="hljs-number">512</span><br>alpha = <span class="hljs-number">2.0314159265358979</span><br>WELCOME = <span class="hljs-string">&#x27;Welcome to use my better RSA!!!!!!So, what do you want now?&#x27;</span><br>menu = <span class="hljs-string">&#x27;1. encry \n2. getflag\n3. exit&#x27;</span><br>String = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>():<br>    STR = <span class="hljs-string">&#x27;&#x27;</span>.join([String[random.randint(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(String)-<span class="hljs-number">1</span>)] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>) ])<br>    HASH = hashlib.sha256(STR.encode()).hexdigest()<br>    <span class="hljs-keyword">return</span> STR[:<span class="hljs-number">4</span>],STR[<span class="hljs-number">4</span>:],HASH<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">key_gen</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p,q = getPrime(KEYSIZE),getPrime(KEYSIZE)<br>        e = <span class="hljs-number">0x10001</span><br>        <span class="hljs-keyword">if</span> gcd(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)):<br>            <span class="hljs-keyword">break</span><br>    key = [getPrime(<span class="hljs-built_in">int</span>(KEYSIZE*alpha)) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>)]<br>    <span class="hljs-keyword">return</span> (p,q,e),key<br><span class="hljs-comment"># encrypto</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encry</span>(<span class="hljs-params">message,key,p,q,e</span>):<br>    k1,k2 = key[random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">127</span>)],key[random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">127</span>)]<br>    x = p**<span class="hljs-number">2</span> * (p + <span class="hljs-number">3</span>*q - <span class="hljs-number">1</span> ) + q**<span class="hljs-number">2</span> * (q + <span class="hljs-number">3</span>*p - <span class="hljs-number">1</span>) <br>    y = <span class="hljs-number">2</span>*p*q + p + q<br>    z = k1 + k2 <br>    c = <span class="hljs-built_in">pow</span>(b2l(message),e,p*q)<br>    <span class="hljs-keyword">return</span> x * c + y * c + z<br><span class="hljs-comment"># get flag</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getflag</span>(<span class="hljs-params">flag,key,p,q,e</span>):<br>    <span class="hljs-keyword">return</span> encry(flag,key,p,q,e)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">server</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recv</span>(<span class="hljs-params">self</span>):<br>        data = <span class="hljs-variable language_">self</span>.request.recv(<span class="hljs-number">1024</span>)<br>        <span class="hljs-keyword">return</span> data.strip()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(msg , <span class="hljs-built_in">bytes</span>):<br>            msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            msg += <span class="hljs-string">&#x27;\n&#x27;</span><br>            msg = msg.encode()<br>        <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        START,END,HASH = proof_of_work()<br>        <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&#x27;SHA-256(?+&#123;&#125;) == &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(END,HASH))<br>        RCV = <span class="hljs-variable language_">self</span>._recv().decode()<br>        <span class="hljs-keyword">if</span> RCV != START:<br>            <span class="hljs-keyword">return</span><br>        <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&quot;I&#x27;m a CryptoRookie,so my Crypto system take time, please wait a minute XD!&quot;</span>)<br>        (p,q,e),key = key_gen()<br>        flag  = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>        <span class="hljs-variable language_">self</span>._send(WELCOME)<br>        <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&#x27;This is my public key:\nn = &#123;&#125;\ne = &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(p*q),<span class="hljs-built_in">str</span>(e)))<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-variable language_">self</span>._send(menu)<br>            COI = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>._recv().decode())<br>            <span class="hljs-keyword">if</span> COI == <span class="hljs-number">1</span> :<br>                <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&#x27;Give me your message&#x27;</span>)<br>                message = <span class="hljs-variable language_">self</span>._recv()<br>                <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&#x27;Your encry message:&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>._send(<span class="hljs-built_in">str</span>(encry(message,key,p,q,e)))<br>            <span class="hljs-keyword">elif</span> COI == <span class="hljs-number">2</span>:<br>                <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&#x27;This is your favourite:\n&#x27;</span>)<br>                <span class="hljs-variable language_">self</span>._send(<span class="hljs-built_in">str</span>(encry(flag,key,p,q,e)))<br>            <span class="hljs-keyword">elif</span> COI == <span class="hljs-number">3</span>:<br>                <span class="hljs-variable language_">self</span>._send(<span class="hljs-string">&#x27;Bye~&#x27;</span>)<br>                <span class="hljs-keyword">break</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">10001</span><br>    server = ForkedServer((HOST, PORT), server)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br></code></pre></td></tr></table></figure><p>å…ˆç¡®å®šä¸€ä¸‹è¿™äº›æ•°å­—çš„å¤§å°ï¼š$p,q$éƒ½æ˜¯$512$ä½ï¼Œ<code>key</code>æ•°ç»„ä¸­çš„æ‰€æœ‰æ•°å­—éƒ½æ˜¯$1040$ä½ã€‚$x&#x3D;p^2 (p + 3q - 1 ) + q^2  (q + 3p - 1)$ï¼Œæ•°é‡çº§å¤§æ¦‚æ˜¯$1500$å¤šä½ï¼Œ$y&#x3D;2pq + p + q$ï¼Œæ•°é‡çº§å¤§çº¦æ˜¯$1030$ä½ã€‚</p><p>æ‰€ä»¥$x+y&#x3D;(p+q)^3-(p+q)^2+(p+q)-4pq$ã€‚è€Œ$(p+q-1)^3&#x3D;(p+q)^3-3(p+q)^2+3(p+q)-1$ï¼Œä¸¤è€…çš„å€¼éå¸¸æ¥è¿‘ã€‚</p><p>æ‰€ä»¥å¯ä»¥è®¤ä¸º$\sqrt[3]{x+y}&#x3D;p+q-1$ã€‚ç„¶åå¯¹<code>flag</code>çš„å€¼é™¤ä»¥$(x+y)$å³å¯ã€‚è€Œ$\dfrac{\ln z}{\ln 2}&#x3D;129$ï¼Œå› æ­¤$z$çš„å€¼å¯ä»¥ç›´æ¥å¿½ç•¥ã€‚</p><h2 id="3-RandomRSA"><a href="#3-RandomRSA" class="headerlink" title="3.RandomRSA"></a>3.RandomRSA</h2><p>é¢˜ç›®å°±æ˜¯é€šè¿‡è®¾ç½®randomçš„seedçš„æ–¹æ³•ï¼Œé€šè¿‡ä¸æ–­ç”Ÿæˆéšæœºæ•°ï¼Œæ¯ä¸€è½®è®¡ç®—ä¸€ä¸ªç‰¹å®šçš„éšæœºæ•°ä¸<code>str(dp)</code>è¿›è¡Œå¼‚æˆ–çš„å€¼ã€‚</p><p>åŸºæœ¬æ²¡ä»€ä¹ˆéš¾çš„å†…å®¹ï¼Œç›´æ¥é€†å›å»å°±è¡Œäº†ï¼Œç„¶åç›´æ¥å¥—å·²çŸ¥dpçš„è„šæœ¬ï¼Œä¸è¿‡è¦ç”¨python2.7ã€‚</p><p><strong>chall.py</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> os<br>flag=<span class="hljs-string">r&#x27;flag&#123;&#125;&#x27;</span><br>p=getPrime(<span class="hljs-number">512</span>)<br>q=getPrime(<span class="hljs-number">512</span>)<br>e=<span class="hljs-number">0x10001</span><br>n=p*q<br>ct=<span class="hljs-built_in">pow</span>(flag,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n=&quot;</span>+ n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ct=&quot;</span>+ ct)<br>dp=<span class="hljs-string">r&#x27;&#x27;</span><br>seeds = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(dp)):<br>    seeds.append(random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">10000</span>))<br>res = [] <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(dp)):<br>    random.seed(seeds[i])<br>    rands = []<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>):<br>        rands.append(random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">255</span>))<br><br>    res.append(<span class="hljs-built_in">ord</span>(dp[i]) ^ rands[i%<span class="hljs-number">4</span>])<br>    <span class="hljs-keyword">del</span> rands[i%<span class="hljs-number">4</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(rands))<br><span class="hljs-built_in">print</span>(res) <br><span class="hljs-built_in">print</span>(seeds)<br><span class="hljs-comment"># n=81196282992606113591233615204680597645208562279327854026981376917977843644855180528227037752692498558370026353244981467900057157997462760732019372185955846507977456657760125682125104309241802108853618468491463326268016450119817181368743376919334016359137566652069490881871670703767378496685419790016705210391</span><br><span class="hljs-comment"># ct=61505256223993349534474550877787675500827332878941621261477860880689799960938202020614342208518869582019307850789493701589309453566095881294166336673487909221860641809622524813959284722285069755310890972255545436989082654705098907006694780949725756312169019688455553997031840488852954588581160550377081811151</span><br><span class="hljs-comment"># [58, 53, 122] [145, 124, 244] [5, 19, 192] [255, 23, 64] [57, 113, 194] [246, 205, 162] [112, 87, 95] [215, 147, 105] [16, 131, 38] [234, 36, 46] [68, 61, 146] [148, 61, 9] [139, 77, 32] [96, 56, 160] [121, 76, 17] [114, 246, 92] [178, 206, 60] [168, 147, 26] [168, 41, 68] [24, 93, 84] [175, 43, 88] [147, 97, 153] [42, 94, 45] [150, 103, 127] [68, 163, 62] [165, 37, 89] [219, 248, 59] [241, 182, 8] [140, 211, 146] [88, 226, 2] [48, 150, 56] [87, 109, 255] [227, 216, 65] [23, 190, 10] [5, 25, 64] [6, 12, 124] [53, 113, 124] [255, 192, 158] [61, 239, 5] [62, 108, 86] [123, 44, 64] [195, 192, 30] [30, 82, 95] [56, 178, 165] [68, 77, 239] [106, 247, 226] [17, 46, 114] [91, 71, 156] [157, 43, 182] [146, 6, 42] [148, 143, 161] [108, 33, 139] [139, 169, 157] [71, 140, 25] [28, 153, 26] [241, 221, 235] [28, 131, 141] [159, 111, 184] [47, 206, 11] [220, 152, 157] [41, 213, 97] [4, 220, 10] [77, 13, 248] [94, 140, 110] [25, 250, 226] [218, 102, 109] [189, 238, 66] [91, 18, 131] [23, 239, 190] [159, 33, 72] [183, 78, 208] [209, 213, 101] [111, 50, 220] [166, 104, 233] [170, 144, 10] [187, 87, 175] [195, 59, 104] [165, 179, 179] [99, 247, 153] [195, 61, 100] [223, 159, 165] [230, 93, 184] [87, 28, 35] [35, 122, 38] [158, 188, 163] [229, 192, 222] [12, 12, 192] [207, 95, 224] [127, 113, 137] [22, 114, 143] [13, 45, 144] [70, 140, 211] [57, 101, 42] [132, 62, 129] [40, 128, 124] [1, 132, 161] [164, 33, 133] [252, 201, 32] [8, 18, 247] [1, 88, 55] [201, 135, 186] [101, 254, 125] [236, 196, 39] [148, 24, 103] [101, 29, 253] [97, 156, 64] [90, 103, 91] [50, 48, 80] [206, 22, 93] [11, 114, 174] [61, 132, 247] [215, 32, 232] [95, 128, 90] [57, 35, 228] [163, 143, 107] [178, 250, 28] [64, 107, 225] [106, 115, 207] [85, 134, 21] [118, 201, 76] [234, 34, 22] [241, 236, 122] [111, 185, 127] [1, 26, 164] [254, 57, 117] [243, 27, 32] [161, 88, 80] [50, 165, 93] [87, 182, 216] [184, 159, 63] [167, 166, 123] [37, 78, 33] [186, 81, 58] [48, 3, 239] [70, 186, 13] [56, 108, 178] [54, 55, 235] [105, 180, 105] [16, 194, 98] [136, 11, 41] [18, 203, 79] [185, 114, 170] [148, 181, 223] [118, 57, 160] [23, 250, 181] [235, 219, 228] [44, 151, 38] [185, 224, 134] [42, 162, 122] [3, 9, 158] [129, 245, 2] [66, 241, 92] [80, 124, 36]</span><br><span class="hljs-comment"># [55, 5, 183, 192, 103, 32, 211, 116, 102, 120, 118, 54, 120, 145, 185, 254, 77, 144, 70, 54, 193, 73, 64, 0, 79, 244, 190, 23, 215, 187, 53, 176, 27, 138, 42, 89, 158, 254, 159, 133, 78, 11, 155, 163, 145, 248, 14, 179, 23, 226, 220, 201, 5, 71, 241, 195, 75, 191, 237, 108, 141, 141, 185, 76, 7, 113, 191, 48, 135, 139, 100, 83, 212, 242, 21, 143, 255, 164, 146, 119, 173, 255, 140, 193, 173, 2, 224, 205, 68, 10, 77, 180, 24, 23, 196, 205, 108, 28, 243, 80, 140, 4, 98, 76, 217, 70, 208, 202, 78, 177, 124, 10, 168, 165, 223, 105, 157, 152, 48, 152, 51, 133, 190, 202, 136, 204, 44, 33, 58, 4, 196, 219, 71, 150, 68, 162, 175, 218, 173, 19, 201, 100, 100, 85, 201, 24, 59, 186, 46, 130, 147, 219, 22, 81]</span><br><span class="hljs-comment"># [4827, 9522, 552, 880, 7467, 7742, 9425, 4803, 6146, 4366, 1126, 4707, 1138, 2367, 1081, 5577, 4592, 5897, 4565, 2012, 2700, 1331, 9638, 7741, 50, 824, 8321, 7411, 6145, 1271, 7637, 5481, 8474, 2085, 2421, 590, 7733, 9427, 3278, 5361, 1284, 2280, 7001, 8573, 5494, 7431, 2765, 827, 102, 1419, 6528, 735, 5653, 109, 4158, 5877, 5975, 1527, 3027, 9776, 5263, 5211, 1293, 5976, 7759, 3268, 1893, 6546, 4684, 419, 8334, 7621, 1649, 6840, 2975, 8605, 5714, 2709, 1109, 358, 2858, 6868, 2442, 8431, 8316, 5446, 9356, 2817, 2941, 3177, 7388, 4149, 4634, 4316, 5377, 4327, 1774, 6613, 5728, 1751, 8478, 3132, 4680, 3308, 9769, 8341, 1627, 3501, 1046, 2609, 7190, 5706, 3627, 8867, 2458, 607, 642, 5436, 6355, 6326, 1481, 9887, 205, 5511, 537, 8576, 6376, 3619, 6609, 8473, 2139, 3889, 1309, 9878, 2182, 8572, 9275, 5235, 6989, 6592, 4618, 7883, 5702, 3999, 925, 2419, 7838, 3073, 488, 21, 3280, 9915, 3672, 579]</span><br></code></pre></td></tr></table></figure><p><strong>6.py</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> *<span class="hljs-keyword">import</span> random<br>s=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(res)):<br>random.seed(seeds[i])<br>arr=[]<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>arr.append(random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">255</span>))<br>s+=<span class="hljs-built_in">chr</span>(res[i]^arr[i%<span class="hljs-number">4</span>])<br><span class="hljs-built_in">print</span>(s)<span class="hljs-comment">#dp</span><br><span class="hljs-comment">#5372007426161196154405640504110736659190183194052966723076041266610893158678092845450232508793279585163304918807656946147575280063208168816457346755227057</span><br></code></pre></td></tr></table></figure><p><strong>1.py</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>e = <span class="hljs-number">65537</span><br>n = <span class="hljs-number">81196282992606113591233615204680597645208562279327854026981376917977843644855180528227037752692498558370026353244981467900057157997462760732019372185955846507977456657760125682125104309241802108853618468491463326268016450119817181368743376919334016359137566652069490881871670703767378496685419790016705210391</span><br>c = <span class="hljs-number">61505256223993349534474550877787675500827332878941621261477860880689799960938202020614342208518869582019307850789493701589309453566095881294166336673487909221860641809622524813959284722285069755310890972255545436989082654705098907006694780949725756312169019688455553997031840488852954588581160550377081811151</span><br>dp=<span class="hljs-number">5372007426161196154405640504110736659190183194052966723076041266610893158678092845450232508793279585163304918807656946147575280063208168816457346755227057</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, e):<br>    <span class="hljs-keyword">if</span>(e*dp%x==<span class="hljs-number">1</span>):<br>        p=(e*dp-<span class="hljs-number">1</span>)//x+<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span>(n%p!=<span class="hljs-number">0</span>):<br>            <span class="hljs-keyword">continue</span><br>        q=n//p<br>        phin=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>        d=invert(e, phin)<br>        m=powmod(c, d, n)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:])%<span class="hljs-number">2</span>==<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">continue</span><br>            <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;m:&quot;</span>,m)<br>        <span class="hljs-comment">#print(hex(m)[2:])</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag:&quot;</span>,<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:]))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Result:</span><br><span class="hljs-string">m: 56006392793406549012915975207582000335336081517127286295437299100128144059518792192004013138662286717</span><br><span class="hljs-string">flag: b&#x27;flag&#123;74281db3-c6f0-e59a-4da6-39b8c71250fe&#125;&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="4-æ€»ç»“"><a href="#4-æ€»ç»“" class="headerlink" title="4. æ€»ç»“"></a>4. æ€»ç»“</h2><p>è¿™ä¸‰é“é¢˜è¿˜æ˜¯æœ‰ç‚¹éš¾åº¦çš„ï¼Œç¥¥äº‘æ¯å¯†ç å­¦æ˜¯4é“é¢˜ç›®ï¼Œè¿˜æœ‰ä¸€é¢˜ä¸<del>æ˜¯å¾ˆ</del>ä¼šåšï¼Œç­‰å¾…ç€åæœŸå¤ç°å§ã€‚ã€‚ã€‚</p><p>æƒ³ä¸åˆ°å¤§äºŒå°±è¿™ä¹ˆå¼€å§‹äº†ï¼Œ8æœˆ30æ—¥ç¬¬ä¸€å¤©ä¸Šè¯¾ï¼Œä¹Ÿåœ¨è¡¥æˆ‘ä¹‹å‰æ‘¸çš„é±¼ï¼Œæœ‰ç‚¹ç´¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BlockCipher1</title>
    <link href="/2021/08/30/BlockCipher1/"/>
    <url>/2021/08/30/BlockCipher1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°-1"><a href="#huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®°-1" class="headerlink" title="huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®° 1"></a>huangx607087å­¦ä¹ åˆ†ç»„å¯†ç çš„ç¬”è®° 1</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>æœ€è¿‘è¿™ç§é¢˜å‹åœ¨CTFä¸­å‡ºç°å¾—è¶Šæ¥è¶Šå¤šï¼Œçœ‹æ¥è¿˜æ˜¯æœ‰å¿…è¦å…³æ³¨ä¸€ä¸‹çš„ï¼Œåœ¨è¿™é‡Œå†™å‡ ç¯‡ç¬”è®°ã€‚</p><h2 id="1-DES"><a href="#1-DES" class="headerlink" title="1. DES"></a>1. DES</h2><h3 id="1o01-ä»€ä¹ˆæ˜¯DES"><a href="#1o01-ä»€ä¹ˆæ˜¯DES" class="headerlink" title="1o01 ä»€ä¹ˆæ˜¯DES"></a>1o01 ä»€ä¹ˆæ˜¯DES</h3><p>DESæ˜¯ä¸€ç§ä½¿ç”¨$56$ä½å¯†é’¥å¯¹$64$ä½é•¿åˆ†ç»„è¿›è¡ŒåŠ å¯†çš„å¯†ç ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¯¹ç§°å¯†ç ï¼Œä¹Ÿå°±æ˜¯å…¶åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå› æ­¤DESä¹Ÿæ˜¯ä¸€ç§è¿­ä»£ç®—æ³•ã€‚DESå¯¹é“­æ–‡ä¸­æ¯ä¸ªåˆ†ç»„çš„åŠ å¯†è¿‡ç¨‹éƒ½åŒ…å«16è½®ï¼Œä¸”æ¯ä¸€è½®çš„æ“ä½œå®Œå…¨ç›¸åŒï¼Œæ¯ä¸€è½®çš„å¯†é’¥éƒ½ä¸åŒï¼Œä½†æ¯ä¸€è½®çš„å¯†é’¥éƒ½æ˜¯ç”±ä¸Šä¸€è½®çš„å¯†é’¥ä¸­æ¨å¯¼å‡ºæ¥çš„ã€‚</p><p>DESåŠ å¯†ä¸­ï¼Œä¸»è¦æ€æƒ³è¿˜æ˜¯æ··æ·†ä¸æ‰©æ•£ï¼šæ··æ·†æ˜¯å°†å¯†é’¥ä¸å¯†æ–‡ä¹‹é—´çš„å…³ç³»å°½å¯èƒ½æ¨¡ç³Šâ€”â€”å› æ­¤å¤šæ•°æƒ…å†µä¸‹çš„æ··æ·†å°±æ˜¯å…ƒç´ æ›¿æ¢ã€‚è€Œæ‰©æ•£æ˜¯ä¸ºäº†éšè—æ˜æ–‡çš„ç»Ÿè®¡å±æ€§ï¼Œä»è€Œå°†ä¸€ä¸ªæ˜æ–‡ç¬¦å·æ‰©æ•£é“å¤šä¸ªå¯†æ–‡ç¬¦å·è¿›è¡ŒåŠ å¯†ï¼Œå…¶ä¸­æœ€ç®€å•çš„ä¸€ä¸ªæ–¹æ³•å°±æ˜¯æŸå‡ ä½ä¸Šè¿›è¡Œç½®æ¢ã€‚</p><p>ä¸‹é¢æ˜¯DESçš„æµç¨‹å›¾ï¼Œå¯ä»¥çœ‹å‡ºä¸€æ¬¡DES åŠ å¯†å…±ä½¿ç”¨äº†$16$æ¬¡è¿­ä»£ï¼Œä¸‹é¢å¯¹å›¾ä¸­çš„å„éƒ¨åˆ†è¿›è¡Œåˆ†æã€‚<strong>è¯¥å›¾ä¹Ÿè¢«ç§°ä¸ºFeistelç½‘ç»œ</strong></p><p><img src="/2021/08/30/BlockCipher1/1.png" alt="1"></p><h3 id="1o02-DESå†…éƒ¨åŠ å¯†åˆ†æ"><a href="#1o02-DESå†…éƒ¨åŠ å¯†åˆ†æ" class="headerlink" title="1o02 DESå†…éƒ¨åŠ å¯†åˆ†æ"></a>1o02 DESå†…éƒ¨åŠ å¯†åˆ†æ</h3><h4 id="Step-1-IPç½®æ¢"><a href="#Step-1-IPç½®æ¢" class="headerlink" title="Step 1 IPç½®æ¢"></a>Step 1 IPç½®æ¢</h4><p>é¦–å…ˆæ˜¯å¯¹æ˜æ–‡çš„ä¸€ä¸ªåˆå§‹ç½®æ¢$\mathrm{IP}(x)$è¿›è¡Œç½®æ¢ï¼Œå…¶IPç½®æ¢è¡¨å¦‚ä¸‹ï¼Œä¹Ÿå°±æ˜¯å°†æ˜æ–‡$64$ä½çš„ç¬¬ä¸€ä½å˜æˆç¬¬$58$ä½ï¼Œç¬¬äºŒä½å˜æˆç¬¬$50$ä½çš„ä¸€ä¸ªæ¶‰åŠæ¯”ç‰¹ä½ç½®æ¢çš„ç®—æ³•ã€‚</p><p><img src="/2021/08/30/BlockCipher1/2.png" alt="2"></p><p>ä¸ä¹‹å¯¹åº”åœ°ï¼Œç”±äºæ˜¯ä¸€å¯¹ä¸€çš„ç½®æ¢ï¼Œæ•…$\mathrm{IP}(x)$å­˜åœ¨é€†è¿ç®—$\mathrm{IP}^{-1}(x)$ï¼Œç½®æ¢è¡¨å¦‚ä¸‹å›¾</p><p><img src="/2021/08/30/BlockCipher1/3.png" alt="3"></p><p>ä¸è¿‡åœ¨è¿™è¾¹å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯ï¼šä¸è®¡æ•°ä¸åŒï¼Œç¬¬ä¸€ä½æ˜¯æœ€å·¦è¾¹çš„ä¸€ä½ï¼Œä¹Ÿå°±æ˜¯è®¡æ•°ä¸­ä»£è¡¨ç€$2^{63}$çš„é‚£ä¸€ä½ã€‚</p><h4 id="Step-2-f-å‡½æ•°"><a href="#Step-2-f-å‡½æ•°" class="headerlink" title="Step 2 $f$å‡½æ•°"></a>Step 2 $f$å‡½æ•°</h4><p>$f$å‡½æ•°å†…éƒ¨ç»“æ„æ¯”è¾ƒå¤æ‚ï¼Œå¦‚å›¾</p><p><img src="/2021/08/30/BlockCipher1/4.png" alt="4"></p><p>é¦–å…ˆå°†å³åŠéƒ¨åˆ†$R$é€šè¿‡æ‰©å±•$E$å‡½æ•°æ‰©å±•åˆ°$48$ä½ï¼Œç„¶åä¸è½®å¯†é’¥å¼‚æˆ–åï¼Œåˆ†æˆ$8$ç»„ï¼Œæ¯ç»„$6$æ¯”ç‰¹ï¼Œç„¶åç»è¿‡$s$ç›’ç½®æ¢åå¯ä»¥å¾—åˆ°ä¸€ä¸ª$32$æ¯”ç‰¹ä½çš„å€¼ï¼Œç»è¿‡$p$ç½®æ¢åè·å¾—åŠ å¯†åçš„å¯†æ–‡ã€‚</p><p>æ‰©å±•è§„åˆ™å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºæœ‰ä¸€åŠçš„æ¯”ç‰¹ä½é‡å¤äº†$2$æ¬¡â€”â€”å› ä¸ºè¿™æ ·æ‰èƒ½å°†$32$ä½å†…å®¹æ‰©å±•æˆ$48$ä½</p><p><img src="/2021/08/30/BlockCipher1/5.png" alt="5"></p><p>åˆ†ç»„åï¼Œæ¯ä¸€ç»„éƒ½æ˜¯$6$æ¯”ç‰¹ï¼Œ$6$æ¯”ç‰¹è½¬åŒ–æˆ$4$æ¯”ç‰¹çš„æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼šç¬¬ä¸€ä½å’Œç¬¬å…­ä½ç»„åˆæˆè¡Œæ•°ï¼Œç¬¬äºŒä½åˆ°ç¬¬äº”ä½ç»„åˆæˆåˆ—æ•°ï¼Œå¦‚$\mathrm{101100B}$æ‹†è§£åå°±æ˜¯$\mathrm{10B}$å’Œ$\mathrm{0110B}$ï¼Œå¯¹åº”$s$ç›’ä¸­çš„ç¬¬äºŒè¡Œç¬¬å…­åˆ—</p><p>å…«ä¸ª$s$ç›’å†…çš„å†…å®¹å¦‚å›¾æ‰€ç¤º</p><p><img src="/2021/08/30/BlockCipher1/6.png" alt="6"></p><p><img src="/2021/08/30/BlockCipher1/7.png" alt="7"></p><p>$s$ç›’ä¹Ÿæ˜¯DESä¸­å”¯ä¸€çš„éçº¿æ€§å…ƒç´ ï¼Œå› ä¸º$s(a)+s(b)$ä¸$s(a+b)$ä¸åŒã€‚ï¼ˆæ­¤å¤„çš„åŠ å·è¡¨ç¤ºå¼‚æˆ–ï¼‰</p><h3 id="1o03-DESå¯†é’¥ç¼–æ’"><a href="#1o03-DESå¯†é’¥ç¼–æ’" class="headerlink" title="1o03 DESå¯†é’¥ç¼–æ’"></a>1o03 DESå¯†é’¥ç¼–æ’</h3><p>DESçš„å¯†é’¥ç¼–æ’ï¼Œæ˜¯å…ˆä»åŸå§‹çš„$56$ä½å¯†é’¥ä¸­å¾—åˆ°$16$ä¸ªè½®å¯†é’¥$k_1,k_2,â€¦k_{16}$ï¼Œæ¯ä¸ªå¯†é’¥$k_i$éƒ½æ˜¯$48$ä½ã€‚ä¸è¿‡åœ¨è¿™é‡Œä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç‰¹ç‚¹å°±æ˜¯ï¼šDESä¸€å¼€å§‹çš„è¾“å…¥å¯†é’¥æ˜¯$64$ä½ï¼Œå…«ä½ä¸€ç»„ï¼Œæ¯ä¸€ç»„çš„ç¬¬å…«ä½æ˜¯è¿™ä¸€ç»„çš„ä¸€ä¸ªæ ¡éªŒä½ï¼ˆä½†è¿™ä¸€ä½çš„æ„ä¹‰ä½•åœ¨ä¸å¾—è€ŒçŸ¥ï¼‰ã€‚å› æ­¤å®é™…ä¸Šä¸¥æ ¼åœ°è¯´ï¼ŒDESå®é™…ä¸Šæ˜¯$56$ä½ï¼Œè€Œä¸æ˜¯$64$ä½ã€‚å› ä¸ºåœ¨å¯†é’¥ç½®æ¢çš„æ—¶å€™ï¼Œ$64$ä½ç¼©çŸ­ä¸º$56$ä½æ—¶ï¼Œç›´æ¥å¿½ç•¥äº†æ¯ä¸€ç»„çš„ç¬¬å…«ä½ã€‚ä¸‹è¡¨æ˜¯DESåˆå§‹å¯†é’¥ç½®æ¢çš„è¡¨æ ¼ã€‚</p><p><img src="/2021/08/30/BlockCipher1/8.png" alt="8"></p><p>å¾—åˆ°$56$ä½çš„å¯†é’¥åï¼Œæˆ‘ä»¬å°†å¯†é’¥åˆ†ä¸º$C_0$å’Œ$D_0$ä¸¤ä¸ªéƒ¨åˆ†ï¼Œç„¶åæ¯ä¸€è½®å°†æ¯ä¸ªé•¿åº¦ä¸º$28$ä½çš„å¯†é’¥éƒ¨åˆ†åˆ†åˆ«å¾ªç¯å·¦ç§»ä¸€è‡³ä¸¤ä½ã€‚ï¼ˆå…·ä½“æ˜¯åœ¨ç¬¬$1,2,9,16$è½®æ˜¯å¾ªç¯å·¦ç§»ä¸€ä½ï¼Œå…¶ä»–çš„è½®éƒ½æ˜¯å¾ªç¯å·¦ç§»ä¸¤ä½ã€‚ï¼‰è€Œè¿™æ ·ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°åœ¨æœ€ååŠ å¯†å®Œæˆè¿‡åâ€”â€”$C_0&#x3D;C_{16},D_0&#x3D;D_{16}$ã€‚ä¸‹å›¾å¾ˆæ¸…æ¥šåœ°è¡¨ç¤ºäº†è¿™ä¸€è¿‡ç¨‹ï¼š</p><p><img src="/2021/08/30/BlockCipher1/9.png" alt="9"></p><p>åœ¨è¿™é‡Œï¼ŒPC-2ç½®æ¢æ˜¯å°†$56$ä½çš„è½®å¯†é’¥è½¬åŒ–æˆ$48$ä½çš„è½®å¯†é’¥ï¼Œè½¬æ¢è§„åˆ™å¦‚ä¸‹</p><p><img src="/2021/08/30/BlockCipher1/10.png" alt="10"></p><h3 id="1o04-DESè§£å¯†è¿‡ç¨‹"><a href="#1o04-DESè§£å¯†è¿‡ç¨‹" class="headerlink" title="1o04 DESè§£å¯†è¿‡ç¨‹"></a>1o04 DESè§£å¯†è¿‡ç¨‹</h3><p>åœ¨è§£å¯†è¿‡ç¨‹ä¸­ï¼Œç”±äºæˆ‘ä»¬åœ¨ä¹‹å‰æ³¨æ„åˆ°$C_0&#x3D;C_{16},D_0&#x3D;D_{16}$çš„ç‰¹ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨PC-1åç›´æ¥å¾—åˆ°$k_{16}$ã€‚</p><p><strong>å›¾ç‰‡S1ä¹‹å‰æ–‡å­—æ¸²æŸ“æœ‰ä¹±ç é—®é¢˜ï¼Œæ•…ä½¿ç”¨å›¾ç‰‡ä¿®æ­£</strong></p><p><img src="/2021/08/30/BlockCipher1/S1.png" alt="S1"></p><p>è€Œåœ¨è§£å¯†è¿‡ç¨‹ä¸­ï¼Œç¬¬ä¸€è½®å¯†é’¥ä¸ç§»ä½ï¼Œç¬¬äºŒã€ä¹ã€åå…­è½®å¯†é’¥ç§»ä½ä¸€ä½ï¼Œå…¶ä»–è½®å¯†é’¥ç§»ä½ä¸¤ä½ã€‚ç”¨å…¬å¼å¯ä»¥è¡¨ç¤ºä¸º<br>$$<br>k_{15}&#x3D;\mathrm{PC_2}(C_ {15},D_ {15})&#x3D;\mathrm{PC_2}(\mathrm{ror}(C_ {0}),\mathrm{ror}(D_ {0}))&#x3D;\mathrm{PC_2}(\mathrm{ror}(C_ {16}),\mathrm{ror}(D_ {16}))<br>$$<br>ä¸Šé¢å…¬å¼ä¸­ï¼Œ$\mathrm {ror,lor}$åˆ†åˆ«è¡¨ç¤ºå¾ªç¯å³ç§»å’Œå¾ªç¯å·¦ç§»ï¼Œç§»åŠ¨ä½æ•°è§„åˆ™åˆšæ‰å·²ç»æåˆ°è¿‡äº†ã€‚</p><p>æ•´ä¸ªè§£å¯†è¿‡ç¨‹å·®ä¸å¤šæ˜¯è¿™å¼ å›¾ï¼š</p><p><img src="/2021/08/30/BlockCipher1/11.png" alt="11"></p><p>è€Œåœ¨æˆ‘ä»¬ä¸Šé¢æåˆ°çš„Feistelç½‘ç»œä¸­ï¼šæˆ‘ä»¬éœ€è¦ç”¨åˆ°IPç½®æ¢çš„é€†ç½®æ¢æ¥è§£å†³é—®é¢˜ã€‚å³<br>$$<br>(L_{D0},R_{D0})&#x3D;\mathrm{IP}(\mathrm{IP}^{-1}(R_{16},L_{16}))&#x3D;(R_{16},L_{16})<br>$$<br>å…¶ä¸­ä¸‹æ ‡æœ‰$D$çš„è¡¨ç¤ºè§£å¯†è¿‡ç¨‹ä¸­çš„å˜é‡ã€‚æ³¨æ„åˆ°ä¸Šé¢çš„Feistelç½‘ç»œä¸­ï¼Œæœ‰$L_{16}&#x3D;R_{15}$ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æ¨å‡ºï¼š<br>$$<br>(L_{D0},R_{D0})&#x3D;(R_{16},L_{16})&#x3D;(R_{16},R_{15})<br>$$<br>å¯¹åº”åœ°ï¼Œæ ¹æ®åŠ å¯†çš„Feistelç½‘ç»œï¼Œæˆ‘ä»¬è§£å¯†çš„Feistelç½‘ç»œå¯†é’¥ï¼Œå¾ˆå®¹æ˜“å¯ä»¥å¾—åˆ°<br>$$<br>L_{D1}&#x3D;R_{D0}&#x3D;L_{16}&#x3D;R_{15}<br>$$<br>ä¸è¿‡$R_{D1}$å°±ä¸æ˜¯é‚£ä¹ˆå¥½ç®—äº†ï¼Œè¿™é‡Œè¿˜æ˜¯è¦ç”¨åˆ°ä¸Šé¢æåˆ°è¿‡çš„åˆšæ‰çš„$f$å‡½æ•°ã€‚ï¼ˆ<strong>ä»¥ä¸‹å‡ºç°å¾—åŠ å·è¡¨ç¤ºå¼‚æˆ–</strong>ï¼‰ï¼Œè¯¥è®¡ç®—æ–¹æ³•å¯ä»¥æ ¹æ®å¼‚æˆ–çš„ç‰¹æ€§å¾—åˆ°ã€‚<br>$$<br>R_{D1}&#x3D;L_{D0}+f(R_{D0},k_{16})&#x3D;R_{16}+f(L_{16},k_{16})<br>$$<br>å¸¦å…¥$R_{16}&#x3D;L_{15}+f(R_{15},k_{16})$ï¼Œå› æ­¤æœ‰<br>$$<br>R_{D1}&#x3D;L_{15}+f(R_{15},k_{16})+f(L_{16},k_{16})<br>$$<br>åˆå› ä¸º$R_{15}&#x3D;L_{16}$ï¼Œå› æ­¤$f(R_{15},k_{16})+f(L_{16},k_{16})&#x3D;0$ã€‚æ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°<br>$$<br>R_{D1}&#x3D;L_{15}<br>$$<br>å› æ­¤ï¼Œå³ä½¿$f$å‡½æ•°çœ‹ä¼¼å¤æ‚ï¼Œä½†æœ€åå¾—å‡ºæ¥çš„ç»“æœå´å¯ä»¥æ¶ˆå»$f$å‡½æ•°ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥è¿­ä»£ï¼Œæœ€ç»ˆå¾—åˆ°<br>$$<br>(L_{Di},R_{Di})&#x3D;(R_{16-i},L_{16-i})<br>$$<br>å› æ­¤è¿™æ˜¯ä¸€ä¸ªéå¸¸å®¹æ˜“çš„è¿‡ç¨‹ã€‚</p><p>æœ€ç»ˆï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹è§£å¯†åçš„ç»“æœè®¡ç®—$\mathrm{IP}^{-1}(x)$å‡½æ•°çš„å¤„ç†å³å¯è·å¾—æ˜æ–‡ã€‚æ³¨æ„åˆ°ä¸€å¼€å§‹å·²ç»æåˆ°ï¼Œç”±äº$\mathrm{IP}(x)$æ˜¯å¯¹$64$ä¸ªæ¯”ç‰¹ä½ä¸€å¯¹ä¸€çš„ç½®æ¢ï¼Œå› æ­¤ç›´æ¥å¯¹ç…§$\mathrm{IP}^{-1}(x)$çš„è¡¨æ ¼ç½®æ¢å›å»å³å¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CryptoCTF Wp 3</title>
    <link href="/2021/08/09/CryptoCTFWriteUp3/"/>
    <url>/2021/08/09/CryptoCTFWriteUp3/</url>
    
    <content type="html"><![CDATA[<h1 id="CryptoCTF-WriteUp-3-By-huangx607087"><a href="#CryptoCTF-WriteUp-3-By-huangx607087" class="headerlink" title="CryptoCTF WriteUp 3 By huangx607087"></a>CryptoCTF WriteUp 3 By huangx607087</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>è¿™ä¸¤å¤©åˆè¯•ç€åšäº†ä¸¤é¢˜ï¼Œè¶Šæ¥è¶Šéš¾ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆçªç„¶æƒ³å‡ºå»ç©äº†ï¼Œæ•´å¤©å°±æƒ³ç€æ‘¸é±¼ï¼Œè¿˜æœ‰ç©è‡ªå·±çš„botã€‚è‡ªå·±ä¹Ÿè§‰å¾—ç›®å‰è¿™ç§é«˜å‹ä¸‹ç¡®å®ä¹Ÿå­¦ä¸ä¸‹å»äº†ã€‚ã€‚CryptoCTFï¼Œ10å¤©æ—¶é—´ï¼Œå…±27é¢˜ï¼ˆä¸åŒ…æ‹¬ä¸¤ä¸ªç­¾åˆ°é¢˜ï¼‰ï¼Œåšäº†12é¢˜ï¼Œæ‰å‘ç°è‡ªå·±AESè¿˜æ²¡æ€ä¹ˆå­¦ï¼Œè¿‡å‡ å¤©å¾—å­¦äº†ã€‚</p><h2 id="1-Ferman"><a href="#1-Ferman" class="headerlink" title="1.Ferman"></a>1.Ferman</h2><p>é¢˜ç›®æ²¡æœ‰ç»™ä»€ä¹ˆé™„ä»¶ï¼Œä¹Ÿæ²¡ç»™ä»€ä¹ˆåˆ«çš„ä¸œè¥¿ï¼Œè¿ä¸Šå»ä¹Ÿå°±æ˜¯è·å¾—äº†è¿™äº›å†…å®¹ï¼šäº‹åå‘ç°æ¯æ¬¡è¿ä¸Šå»çš„å†…å®¹éƒ½ä¸ä¸€æ ·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>e = <span class="hljs-number">65537</span><br>isPrime(p) = <span class="hljs-literal">True</span><br>isPrime(q) = <span class="hljs-literal">True</span><br>n = p * q<br>(p - <span class="hljs-number">68</span>)**<span class="hljs-number">2</span> + (q - <span class="hljs-number">21</span>)**<span class="hljs-number">2</span> = <span class="hljs-number">3269551398869642512241103339368232143434651590868728507355028871910904078338475713578589303262711916750081690332228411866186437460090515664367924851061597536376468220126174928460974557959918017310829528466648372027415953708229130137453296795856556992151797166136297164760842319106620707383001374254866888310103550740311206689346583293426983738736830982428061012656462973476605155219794719926468254375880711360433969868621585139970748294149897216559703209916963866764044804843930101</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br>encrypt(flag) = <span class="hljs-number">1129211205327521826941184390751899392925131920702773335891856613366505909410806899952280135028258342388876508412491223980744621251519356334925886554708700046795586651759818594942792724304963126886525647156824946261462652999258718878583493830408651605063608560126743568477583982018994138693209851132638425082838330606425689175153335674463330275554714300992424492537349839226295570411855545265032582057186364143746536638616951994802510125990494183100416729103612848938139639080478806</span><br><br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå¹³æ–¹å’Œçš„å½¢å¼$(p-68)^{2}+(q-21)^{2}$ï¼Œæƒ³åˆ°ä¹‹å‰åœ¨æ•°è®ºæ¦‚è®ºä¸Šçœ‹åˆ°è¿‡å…³äºå°†æŸä¸ªç´ æ•°æ‹†æˆ$2$ä¸ªæ•°çš„å¹³æ–¹å’Œçš„ç®—æ³•ï¼Œå› æ­¤çŒœæµ‹è¿™é‡Œå¯èƒ½ä¼šç”¨å¾—åˆ°ã€‚</p><p>ä½†æ˜¯å¾ˆæ˜¾ç„¶ï¼Œç­‰å·å³è¾¹çš„è¿™ä¸ªæ•°å­—<del>æˆ‘æ„Ÿè§‰çœ‹èµ·æ¥</del>ä¸æ˜¯ç´ æ•°â€”â€”å› æ­¤æˆ‘åˆ†è§£äº†ä¸€ä¸‹å®ƒï¼šè¿™ä¸ªæ•°çš„è¡¨è¾¾å¼ä¸º<br>$$<br>p^7q^7&#x3D;881^7Ã—501130658240331371910024384924248009800259836627015214670629231821^7<br>$$<br>çœ‹æ¥æ˜¯ä¸€ä¸ªæ•°çš„$7$æ¬¡æ–¹ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªç´ æ•°éƒ½æ»¡è¶³æ¨¡$4$ä½™$1$çš„æ¡ä»¶ï¼Œå› æ­¤å¯ä»¥åˆ†è§£æˆä¸¤ä¸ªå¹³æ–¹å’Œã€‚</p><p>å…¶ä¸­ï¼š$p&#x3D;25^2+16^2$ï¼Œ$q&#x3D;707783305101597694376018027941686^2+13170089589294489230801449847315^2$ã€‚</p><p>ç„¶åè‡ªå·±å°±æ ¹æ®æ•°ä¸Šçš„æ–¹æ³•ï¼Œè®¾$g&#x3D;p^3q^3$ï¼Œç„¶åç”¨å…¬å¼$(u^2+v^2)(a^2+b^2)&#x3D;(ua+vb)^2+(va-ub)^2$ï¼Œç„¶åå°†ä¸¤ä¸ªå¹³æ–¹é¡¹åŒæ—¶ä¹˜ä¸Š$g$ï¼Œç„¶åæ£€éªŒçš„æ—¶å€™å‘ç°äº†é—®é¢˜â€”â€”æ„é€ å‡ºæ¥çš„å¹³æ–¹å’Œç¡®å®ç­‰äºç­‰å·å³è¾¹çš„æ•°å€¼ï¼ˆè®¾ä¸º$x$ï¼‰ï¼Œä½†ä¸¤ä¸ªæ•°æ— è®ºæ˜¯åŠ ä¸Š$68$è¿˜æ˜¯åŠ ä¸Š$21$ï¼Œéƒ½ä¸æ˜¯ç´ æ•°ã€‚</p><p>ç„¶åæˆ‘è°ƒæ¢äº†ä¸€ä¸‹$a,b,u,v$çš„ä½ç½®ï¼Œç”¨åŒæ ·çš„æ–¹æ³•è¯•äº†ä¸€ä¸‹ï¼Œè²Œä¼¼è¿˜æ˜¯ä¸å¯¹â€”â€”æˆ–è®¸ï¼Œä¸€äº›åˆæ•°æ‹†è§£æˆå¹³æ–¹å’Œçš„æ—¶å€™ï¼Œä¹Ÿè®¸æœ‰ä¸åŒçš„æ–¹æ³•ã€‚ä»åŸç†ä¸Šæ¥è®²ï¼Œå°†ä¸€ä¸ªç´ æ•°æ‹†è§£å¹³æ–¹å’Œçš„åŸç†æ˜¯åŸºäºçš„å¤æ•°è®¡ç®—ï¼š$p&#x3D;(a+b\mathrm i)(a-b\mathrm i)&#x3D;a^2+b^2$ã€‚å› æ­¤ï¼Œå¯¹äºä¸Šé¢ä¸¤ä¸ªæ•°æ¥è¯´ï¼Œå¯ä»¥å†™æˆå¦‚æ­¤çš„å½¢å¼ï¼š$x&#x3D;p^7q^7&#x3D;(a+b\mathrm i)^7(a-b\mathrm i)^7(c+d\mathrm i)^7(c-d\mathrm i)^7$ã€‚å› æ­¤ï¼Œæœ€ç»ˆçš„$x$å¯ä»¥ç”±è¿™4ä¸ªå¤æ•°å¯ä»¥è‡ªç”±ç»„åˆã€‚æ„æˆä¸€å †å…±è½­å¤æ•°ï¼Œå…¶ä¹˜ç§¯ä¸º$x$ã€‚</p><p>å› æ­¤æˆ‘ä»¬ç›´æ¥æšä¸¾å…¶æŒ‡æ•°å³å¯ï¼Œä½†è€ƒè™‘åˆ°æ¯ä¸€æ¬¡çš„$(a,b),(u,v)$çš„å–å€¼ä¸æ•¢å®šï¼Œå› æ­¤è¿™$4$ç§æƒ…å†µä¹Ÿè¦è€ƒè™‘ä¸€ä¸‹ï¼Œæ‰€ä»¥åˆ°æœ€åä¸€å…±å¤§æ¦‚æ˜¯$16384$ç§æƒ…å†µï¼Œç›´æ¥æšä¸¾æŒ‡æ•°å³å¯ã€‚</p><p>ä¸è¿‡æ®è¯´sagemathå¯ä»¥è§£$x^2+y^2&#x3D;k$çš„æƒ…å†µï¼Œä½†è§£ä¸å‡º$x^2+y^2&#x3D;k^7$çš„æƒ…å†µï¼Œæˆ‘è¿™é‡Œæœªå®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Complex</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,x,y=<span class="hljs-number">0</span></span>):<br>        <span class="hljs-variable language_">self</span>.real=x<br>        <span class="hljs-variable language_">self</span>.imag=y<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Pr</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-variable language_">self</span>.real,<span class="hljs-variable language_">self</span>.imag)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Cmul</span>(<span class="hljs-params">a,b</span>):<br>    Real=a.real*b.real-a.imag*b.imag<br>    Imag=a.real*b.imag+b.real*a.imag<br>    <span class="hljs-keyword">return</span> Complex(Real,Imag)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Cpow</span>(<span class="hljs-params">a,e</span>):<br>    Res=Complex(<span class="hljs-number">1</span>)<br>    e=<span class="hljs-built_in">bin</span>(e)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> e:<br>        Res=Cmul(Res,Res)<br>        <span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;1&#x27;</span>:<br>            Res=Cmul(Res,a)<br>    <span class="hljs-keyword">return</span> Res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Extract</span>(<span class="hljs-params">a</span>):<br>    <span class="hljs-keyword">if</span> a.imag*a.real==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">max</span>(<span class="hljs-built_in">abs</span>(a.imag),<span class="hljs-built_in">abs</span>(a.real))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">p,q</span>):<br>    <span class="hljs-keyword">if</span> p==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> q==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> (p&amp;<span class="hljs-number">1</span>)==(q&amp;<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> p&amp;<span class="hljs-number">1</span>&gt;q&amp;<span class="hljs-number">1</span>:<br>        p,q=q,p<br>    <span class="hljs-comment">#print(p+21,q+68)</span><br>    <span class="hljs-keyword">if</span> isPrime(p+<span class="hljs-number">21</span>) <span class="hljs-keyword">and</span> isPrime(q+<span class="hljs-number">68</span>):<br>        <span class="hljs-keyword">return</span> p+<span class="hljs-number">21</span>,q+<span class="hljs-number">68</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">combine</span>(<span class="hljs-params">a,b,u,v</span>):<br>    z1,z2,z3,z4=Complex(a,b),Complex(a,-b),Complex(u,v),Complex(u,-v)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>                <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>                   r,s=Complex(<span class="hljs-number">1</span>),Complex(<span class="hljs-number">1</span>)<br>                   r=Cmul(Cmul(Cmul(Cpow(z1,i),Cpow(z2,j)),Cpow(z3,k)),Cpow(z4,l))<br>                   s=Cmul(Cmul(Cmul(Cpow(z1,<span class="hljs-number">7</span>-i),Cpow(z2,<span class="hljs-number">7</span>-j)),Cpow(z3,<span class="hljs-number">7</span>-k)),Cpow(z4,<span class="hljs-number">7</span>-l))<br>                   <span class="hljs-keyword">assert</span> Extract(Cmul(r,s))==<span class="hljs-number">3269551398869642512241103339368232143434651590868728507355028871910904078338475713578589303262711916750081690332228411866186437460090515664367924851061597536376468220126174928460974557959918017310829528466648372027415953708229130137453296795856556992151797166136297164760842319106620707383001374254866888310103550740311206689346583293426983738736830982428061012656462973476605155219794719926468254375880711360433969868621585139970748294149897216559703209916963866764044804843930101</span><br>                   <span class="hljs-comment">#p,q=Extract(r),Extract(s)</span><br>                   p,q=r.real,r.imag<br>                   <span class="hljs-keyword">if</span> check(p,q):<br>                       <span class="hljs-built_in">print</span>(check(p,q))<br>a,b=<span class="hljs-number">25</span>, <span class="hljs-number">16</span><br>u,v=<span class="hljs-number">13170089589294489230801449847315</span>,<span class="hljs-number">707783305101597694376018027941686</span><br>combine(a,b,u,v)<br>combine(a,b,v,u)<br>combine(b,a,u,v)<br>combine(b,a,v,u)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p=1367291984765267853480661817191973536196367067942219441094381051490756487227187103253395714048175579203366540871321878072980687796968653546138925128020808999936761834389329636911488062911510719917508501565645614971839792438943508734857447351</span><br><span class="hljs-string">q=1183243012768846673615661480426536150503870303790817990055385067161241136558606680343879248138238749140297647629816389281594627601494973568019878375082598163753648048811668067008108623661611923189136565406992832328516940073816055184727720669</span><br><span class="hljs-string">&#x27;CCTF&#123;Congrats_Y0u_5OLv3d_x**2+y**2=z**7&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œ<code>combine</code>å‡½æ•°ä¹Ÿå¯ä»¥è¿™æ ·ä¼˜åŒ–ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">combine</span>(<span class="hljs-params">a,b,u,v</span>):<br>    z1,z2,z3,z4=Complex(a,b),Complex(a,-b),Complex(u,v),Complex(u,-v)<br>    <span class="hljs-built_in">print</span>(Extract(Cmul(z1,z2)),Extract(Cmul(z3,z4)))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            r,s=Complex(<span class="hljs-number">1</span>),Complex(<span class="hljs-number">1</span>)<br>            r=Cmul(Cmul(Cmul(Cpow(z1,i),Cpow(z2,<span class="hljs-number">7</span>-i)),Cpow(z3,k)),Cpow(z4,<span class="hljs-number">7</span>-k))<br>            s=Cmul(Cmul(Cmul(Cpow(z1,<span class="hljs-number">7</span>-i),Cpow(z2,i)),Cpow(z3,<span class="hljs-number">7</span>-k)),Cpow(z4,k))<br>            <span class="hljs-keyword">assert</span> r.imag == -s.imag<br>            <span class="hljs-keyword">assert</span> r.real == s.real<br>            <span class="hljs-keyword">if</span> check(<span class="hljs-built_in">abs</span>(r.real),<span class="hljs-built_in">abs</span>(r.imag)):<br>                <span class="hljs-built_in">print</span>(check(<span class="hljs-built_in">abs</span>(r.real),<span class="hljs-built_in">abs</span>(r.imag)))<br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¿™é‡Œå†é‡ç°ä¸€ä¸‹ä¸Šæ¬¡çš„å°†ä¸€å…±æ¨¡$4$ä½™$1$çš„ç´ æ•°åˆ†è§£æˆä¸¤ä¸ªå¹³æ–¹å’Œçš„æƒ…å½¢ï¼Œå³$p&#x3D;a^2+b^2$è§£$(a,b)$çš„æƒ…å†µï¼Œè¿™ä¸ªè„šæœ¬ä¹‹å‰åœ¨<strong>NumberTheory 3</strong>ä¸­å‡ºç°è¿‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getA</span>(<span class="hljs-params">p</span>):<br>    <span class="hljs-keyword">assert</span>(p%<span class="hljs-number">4</span>==<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        t=bytes_to_long(urandom(<span class="hljs-number">195</span>))%p<br>        s=<span class="hljs-built_in">pow</span>(t,(p-<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,p)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">pow</span>(s,<span class="hljs-number">2</span>,p)==p-<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> s<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getAns</span>(<span class="hljs-params">A,B,M,p</span>):<br>    <span class="hljs-comment">#print(A,B,M,p)</span><br>    <span class="hljs-keyword">if</span>(M==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">abs</span>(A),<span class="hljs-built_in">abs</span>(B))<br>    <span class="hljs-comment">#print(A,B,M,p)</span><br>    u,v=A%M,B%M<br>    <span class="hljs-keyword">if</span>(u&gt;M//<span class="hljs-number">2</span>):<br>        u-=M<br>    <span class="hljs-keyword">if</span>(v&gt;M//<span class="hljs-number">2</span>):<br>        v-=M<br>    <span class="hljs-keyword">assert</span>((u**<span class="hljs-number">2</span>+v**<span class="hljs-number">2</span>)%M==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> (A**<span class="hljs-number">2</span>+B**<span class="hljs-number">2</span>)%M==<span class="hljs-number">0</span> )<br>    r=(u**<span class="hljs-number">2</span>+v**<span class="hljs-number">2</span>)//M<br>    A2=(u*A+v*B)//M<br>    B2=(-u*B+v*A)//M<br>    <span class="hljs-keyword">return</span> getAns(A2,B2,r,p)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">p</span>):<br>    A=getA(p)<br>    B=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">assert</span>(A**<span class="hljs-number">2</span>+B**<span class="hljs-number">2</span>)%p==<span class="hljs-number">0</span><br>    M=(A**<span class="hljs-number">2</span>+B**<span class="hljs-number">2</span>)//p<br>    <span class="hljs-keyword">return</span> getAns(A,B,M,p)<br><span class="hljs-built_in">print</span>(solve(<span class="hljs-number">881</span>))<br><span class="hljs-comment">#(25, 16)</span><br></code></pre></td></tr></table></figure><p>æ‰©å±•ï¼šå½¢å¦‚<br>$$<br>m&#x3D;M^2\prod_{i&#x3D;1}^n p_i<br>$$<br>çš„æ•´æ•°$m$å¯ä»¥å†™æˆä¸¤ä¸ªå¹³æ–¹å’Œçš„å½¢å¼ï¼Œå…¶ä¸­$p_i$æ˜¯å„ä¸ç›¸åŒä¸”æ¨¡$4$ä½™$1$çš„ç´ æ•°ï¼Œ$M$æ˜¯æ•´æ•°</p><h2 id="2-maid"><a href="#2-maid" class="headerlink" title="2.maid"></a>2.maid</h2><p>å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">global</span> nbit<br>nbit = <span class="hljs-number">1024</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>(<span class="hljs-params">nbit</span>):<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>p, q = [getStrongPrime(nbit) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;01&#x27;</span>]<br><span class="hljs-keyword">if</span> p % <span class="hljs-number">4</span> == q % <span class="hljs-number">4</span> == <span class="hljs-number">3</span>:<br><span class="hljs-keyword">return</span> (p**<span class="hljs-number">2</span>)*q, p<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m, pubkey</span>):<br><span class="hljs-keyword">if</span> GCD(m, pubkey) != <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> m &gt;= <span class="hljs-number">2</span>**(<span class="hljs-number">2</span>*nbit - <span class="hljs-number">2</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">2</span>, pubkey)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flag_encrypt</span>(<span class="hljs-params">flag, p, q</span>):<br>m = bytes_to_long(flag)<br><span class="hljs-keyword">assert</span> m &lt; p * q<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">65537</span>, p * q)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">die</span>(<span class="hljs-params">*args</span>):<br>pr(*args)<br>quit()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>(<span class="hljs-params">*args</span>):<br>s = <span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, args))<br>sys.stdout.write(s + <span class="hljs-string">&quot;\n&quot;</span>)<br>sys.stdout.flush()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sc</span>():<br><span class="hljs-keyword">return</span> sys.stdin.readline().strip()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>border = <span class="hljs-string">&quot;+&quot;</span><br>pr(border*<span class="hljs-number">72</span>)<br>pr(border, <span class="hljs-string">&quot;  hi all, welcome to Rooney Oracle, you can encrypt and decrypt any &quot;</span>, border)<br>pr(border, <span class="hljs-string">&quot;  message in this oracle, but the flag is still encrypted, Rooney   &quot;</span>, border)<br>pr(border, <span class="hljs-string">&quot;  asked me to find the encrypted flag, I&#x27;m trying now, please help! &quot;</span>, border)<br>pr(border*<span class="hljs-number">72</span>)<br>pubkey, privkey = keygen(nbit)<br>p, q = privkey, pubkey // (privkey ** <span class="hljs-number">2</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>pr(<span class="hljs-string">&quot;| Options: \n|\t[E]ncrypt message \n|\t[D]ecrypt ciphertext \n|\t[S]how encrypted flag \n|\t[Q]uit&quot;</span>)<br>ans = sc().lower()<br><span class="hljs-keyword">if</span> ans == <span class="hljs-string">&#x27;e&#x27;</span>:<br>pr(<span class="hljs-string">&quot;| Send the message to encrypt: &quot;</span>)<br>msg = sc()<br><span class="hljs-keyword">try</span>:<br>msg = <span class="hljs-built_in">int</span>(msg)<br><span class="hljs-keyword">except</span>:<br>die(<span class="hljs-string">&quot;| your message is not integer!!&quot;</span>)<br>pr(<span class="hljs-string">f&quot;| encrypt(msg, pubkey) = <span class="hljs-subst">&#123;encrypt(msg, pubkey)&#125;</span> &quot;</span>)<br><span class="hljs-keyword">elif</span> ans == <span class="hljs-string">&#x27;d&#x27;</span>:<br>pr(<span class="hljs-string">&quot;| Send the ciphertext to decrypt: &quot;</span>)<br>enc = sc()<br><span class="hljs-keyword">try</span>:<br>enc = <span class="hljs-built_in">int</span>(enc)<br><span class="hljs-keyword">except</span>:<br>die(<span class="hljs-string">&quot;| your message is not integer!!&quot;</span>)<br>pr(<span class="hljs-string">f&quot;| decrypt(enc, privkey) = <span class="hljs-subst">&#123;decrypt(enc, privkey)&#125;</span> &quot;</span>)<br><span class="hljs-keyword">elif</span> ans == <span class="hljs-string">&#x27;s&#x27;</span>:<br>pr(<span class="hljs-string">f&#x27;| enc = <span class="hljs-subst">&#123;flag_encrypt(flag, p, q)&#125;</span>&#x27;</span>)<br><span class="hljs-keyword">elif</span> ans == <span class="hljs-string">&#x27;q&#x27;</span>:<br>die(<span class="hljs-string">&quot;Quitting ...&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">&quot;Bye ...&quot;</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>main()<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼š$p\equiv q\equiv 3 \pmod 4$ï¼Œå› æ­¤è‹¥$x^2\equiv a \pmod p$ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥å¾—åˆ°$x\equiv a^{(p+1)&#x2F;4} \pmod p$ã€‚</p><p>é¢˜ç›®ç»™å‡ºäº†å…¬é’¥æ˜¯$n&#x3D;p^2q$ï¼Œç§é’¥æ˜¯$p$ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ˜æ–‡$m$ï¼Œé¢˜ç›®è¿”å›$c\equiv m^2 \pmod n$ï¼Œå¹¶ä¸”å¦‚æœæˆ‘ä»¬å‘é€$c$ï¼ŒæœåŠ¡å™¨ä¹Ÿå¯ä»¥ç»™æˆ‘ä»¬è¿”å›è§£å¯†çš„ç»“æœ$m$ã€‚â€”â€”ä¸è¿‡è§£å¯†å‡½æ•°è¿™é‡Œå¹¶æ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬ã€‚</p><p>æˆ‘ä»¬å‘ç°è¿™é‡Œçš„æŒ‡æ•°æ˜¯$2$ï¼Œä¸€å¼€å§‹æˆ‘æ‰‹åŠ¨å‘é€äº†ä¸ª$10$è¿›è¡ŒåŠ å¯†ï¼ŒæœåŠ¡å™¨è¿”å›äº†$100$ï¼Œè¯´æ˜ä¹Ÿä»…ä»…æ˜¯å¹³æ–¹è€Œå·²ï¼Œå¦‚æœä¸å–æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡äºŒåˆ†çš„æ–¹æ³•çˆ†ç ´$n&#x3D;p^2q$â€”â€”å› ä¸ºæ€»å­˜åœ¨ä¸€ä¸ªä¸´ç•Œç‚¹$r$ä½¿å¾—$r^2&lt;n,(r+1)^2&gt;n$ï¼Œè€Œè¿™é‡Œ$(r+1)^2$ï¼ˆçœŸå®å€¼ï¼‰å‡å»æœåŠ¡å™¨è¿”å›çš„å–æ¨¡åçš„å€¼ï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€è¦æ±‚çš„$n$äº†ã€‚</p><p>ä¸è¿‡æ®è¯´ä¹Ÿå¯ä»¥å¯¹æœåŠ¡å™¨å‘é€$m_0,k_1m_0,k_2m_0$ï¼Œç„¶åæ±‚å…¬çº¦æ•°ä¹Ÿå¯ä»¥ï¼Œä½†è¿™é‡Œ$m$ä¼¼ä¹å¾ˆå¤§çš„æ ·å­ï¼Œå› æ­¤æˆ‘æ²¡æœ‰å°è¯•è¿‡â€”â€”ä½†è¿™ç¡®å®åªéœ€è¦$3$æ¬¡äº¤äº’å°±èƒ½æ±‚å‡º$n$ï¼ŒåæœŸä¼šå°è¯•ä¸€ä¸‹â€”â€”å› ä¸ºæ•´ä¸ªäºŒåˆ†çˆ†ç ´è¿‡ç¨‹å¾ˆé•¿ï¼Œç”¨äº†$10$åˆ†é’Ÿã€‚</p><p>ç„¶åæˆ‘ä»¬å°±åªéœ€è¦ä¸€æ¬¡è§£å¯†å³å¯â€”â€”å¯¹æœåŠ¡å™¨å‘é€æˆ‘ä»¬è‡ªå·±çš„å¯†æ–‡$câ€™$ï¼Œè·å¾—å…¶è§£å¯†ç»“æœ$mâ€™$ï¼Œè®¡ç®—$\gcd(n,mâ€™^2-câ€™)$ã€‚å°±æœ‰å¯èƒ½è·å¾—$p^2$çš„å€¼ï¼Œç„¶åå°±èƒ½è§£å¯†äº†ã€‚ä½†è¿™æ˜¯ä¸ªæ¦‚ç‡ç®—æ³•ï¼Œæ®è¯´æˆåŠŸä¸å¦ä¸$câ€™$æ˜¯å¦æ˜¯$q$çš„äºŒæ¬¡å‰©ä½™æœ‰å…³ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getsqrt</span>(<span class="hljs-params">x</span>):<br>L,R=<span class="hljs-number">0</span>,x<br><span class="hljs-keyword">while</span> L&lt;=R:<br>M=(L+R)//<span class="hljs-number">2</span><br><span class="hljs-keyword">if</span> M**<span class="hljs-number">2</span> &gt;x:<br>R=M-<span class="hljs-number">1</span><br><span class="hljs-keyword">elif</span> M**<span class="hljs-number">2</span>&lt;x:<br>L=M+<span class="hljs-number">1</span><br><span class="hljs-keyword">else</span>:<br><span class="hljs-keyword">return</span> M<br>T1=<span class="hljs-built_in">str</span>(datetime.now())<br><span class="hljs-built_in">print</span>(T1)<br>sh=remote(<span class="hljs-string">&quot;04.cr.yp.toc.tf&quot;</span>,<span class="hljs-number">38010</span>)<br>sh.recvuntil(<span class="hljs-string">b&quot;]uit&quot;</span>)<br>sh.send(<span class="hljs-string">b&quot;s\n&quot;</span>)<br>sh.recvuntil(<span class="hljs-string">b&quot;c = &quot;</span>)<br>c=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-comment">#print(c)</span><br>L=<span class="hljs-number">1000000000000</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>sh.recvuntil(<span class="hljs-string">b&quot;]uit&quot;</span>)<br>sh.send(<span class="hljs-string">b&quot;e\n&quot;</span>)<br>sh.recvuntil(<span class="hljs-string">b&quot;rypt:&quot;</span>)<br>sh.send((<span class="hljs-built_in">str</span>(L)+<span class="hljs-string">&quot;\n&quot;</span>).encode())<br>sh.recvuntil(<span class="hljs-string">b&quot;key) =&quot;</span>)<br>rec=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;rec=&quot;</span>,rec)<br><span class="hljs-keyword">if</span> rec%<span class="hljs-number">100000000000000</span>!=<span class="hljs-number">0</span>:<br><span class="hljs-built_in">print</span>(L)<br><span class="hljs-keyword">break</span><br>L=L*<span class="hljs-number">1000</span><br>L,R=L//<span class="hljs-number">1000</span>,L<br><span class="hljs-keyword">while</span> L&lt;=R:<br><span class="hljs-built_in">print</span>(L,R)<br>M=(L+R)//<span class="hljs-number">2</span><br>sh.recvuntil(<span class="hljs-string">b&quot;]uit&quot;</span>)<br>sh.send(<span class="hljs-string">b&quot;e\n&quot;</span>)<br>sh.recvuntil(<span class="hljs-string">b&quot;rypt:&quot;</span>)<br>sh.send((<span class="hljs-built_in">str</span>(M)+<span class="hljs-string">&quot;\n&quot;</span>).encode())<br>sh.recvuntil(<span class="hljs-string">b&quot;key) =&quot;</span>)<br>rec=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-keyword">if</span> rec==M**<span class="hljs-number">2</span>:<br>L=M+<span class="hljs-number">1</span><br><span class="hljs-keyword">else</span>:<br>R=M-<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">8</span>,<span class="hljs-number">8</span>):<br><span class="hljs-built_in">print</span>(i)<br>x=M+i<br>sh.recvuntil(<span class="hljs-string">b&quot;]uit&quot;</span>)<br>sh.send(<span class="hljs-string">b&quot;e\n&quot;</span>)<br>sh.recvuntil(<span class="hljs-string">b&quot;rypt:&quot;</span>)<br>sh.send((<span class="hljs-built_in">str</span>(x)+<span class="hljs-string">&quot;\n&quot;</span>).encode())<br>sh.recvuntil(<span class="hljs-string">b&quot;key) =&quot;</span>)<br>rec1=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br><span class="hljs-keyword">if</span> rec1!=x*x:<br>n=x*x-rec1<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n=&#x27;</span>,x*x-rec1)<br><span class="hljs-keyword">break</span><br>Count,Judge=<span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> Judge==<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> Judge==n:<br>Count+=<span class="hljs-number">1</span><br>testc=bytes_to_long(urandom(<span class="hljs-number">99</span>))<br>sh.recvuntil(<span class="hljs-string">b&quot;]uit&quot;</span>)<br>sh.send(<span class="hljs-string">b&quot;d\n&quot;</span>)<br>sh.recvuntil(<span class="hljs-string">b&quot;rypt:&quot;</span>)<br>sh.send((<span class="hljs-built_in">str</span>(testc)+<span class="hljs-string">&quot;\n&quot;</span>).encode())<br>sh.recvuntil(<span class="hljs-string">b&quot;key) =&quot;</span>)<br>testm=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>Judge=GCD(n,testm*testm-testc)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Judge Found After&#x27;</span>+<span class="hljs-built_in">str</span>(Count)+<span class="hljs-string">&#x27;Times:&#x27;</span>,Judge)<br>p=getsqrt(Judge)<br>q=n//(p*p)<br><span class="hljs-keyword">assert</span> isPrime(p) <span class="hljs-keyword">and</span> isPrime(q)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,inverse(<span class="hljs-number">65537</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)),p*q)))<br>T2=<span class="hljs-built_in">str</span>(datetime.now())<br><span class="hljs-built_in">print</span>(T1)<br><span class="hljs-built_in">print</span>(T2)<br>sh.close()<br><span class="hljs-comment">#CCTF&#123;___Ra8!N_H_Cryp70_5YsT3M___&#125;</span><br><span class="hljs-comment">#Start Time: 2021-08-09 13:04:49.819341</span><br><span class="hljs-comment">#End Time  : 2021-08-09 13:16:40.294261</span><br><br></code></pre></td></tr></table></figure><p>æ•´ä¸ªäº¤äº’è¿‡ç¨‹è·‘ä¸€æ¬¡$12$åˆ†é’Ÿï¼Œè°ƒäº†æˆ‘$3$ä¸ªå¤šå°æ—¶ã€‚</p><h2 id="3-æ€»ç»“"><a href="#3-æ€»ç»“" class="headerlink" title="3.æ€»ç»“"></a>3.æ€»ç»“</h2><p>CryptoCTFçš„è¿™ä¸¤é“é¢˜ç›®ç¡®å®æŒºéš¾çš„â€”â€”ä¸»è¦æ˜¯æœ‰çš„åŸç†å¯èƒ½è‡ªå·±ä»¥å‰ç¡®å®æ²¡æœ‰æ‡‚ï¼ŒåŠ ä¸Šè‡ªå·±å¤ªèœæ‰€å¯¼è‡´çš„ã€‚</p><p>æ„Ÿè§‰åé¢çš„ä¸€äº›é¢˜ç›®è¿˜æ˜¯éå¸¸éš¾çš„ï¼Œè‡³å°‘åˆ°ç°åœ¨å¯èƒ½è¿˜æ˜¯è¶…å‡ºäº†è‡ªå·±çš„èŒƒå›´äº†ï¼Œæ˜å¤©å¾—å¼€å§‹å­¦AESäº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CryptoCTF Wp 2</title>
    <link href="/2021/08/07/CryptoCTFWriteUp2/"/>
    <url>/2021/08/07/CryptoCTFWriteUp2/</url>
    
    <content type="html"><![CDATA[<h1 id="CryptoCTF-WriteUp-2-By-huangx607087"><a href="#CryptoCTF-WriteUp-2-By-huangx607087" class="headerlink" title="CryptoCTF WriteUp 2 By huangx607087"></a>CryptoCTF WriteUp 2 By huangx607087</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>å†æ¢CryptoCTFï¼Œè¿™é‡Œé¢æœ‰äº›é¢˜ç›®éš¾åº¦ç¡®å®è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œè¿™å‡ å¤©çš„è§£é¢˜è¿›åº¦ä¹ŸåŸºæœ¬ä¸Šæ˜¯ä¸€å¤©ä¸€é¢˜çš„è¿›åº¦å§ï¼Œä¸è¿‡ç¡®å®éå¸¸æ‰©å±•æ€ç»´çš„ã€‚<del>ç„¶è€Œæˆ‘è¿™ä¹ˆèœçš„è‚¯å®šæ¯”ä¸ä¸Šç¾¤é‡Œé‚£äº›å¤§ä½¬ä»¬</del>ã€‚ä»Šå¤©çš„RARCTFè¿˜æœ‰å¾ˆå¤šä¸œè¥¿æ²¡çœ‹å‘¢ï¼Œäº‹æƒ…çš„ç¡®å¤šå¾—æœ‰äº¿ç‚¹ç‚¹å¿™ä¸è¿‡æ¥äº†ã€‚</p><p>å¥½åœ¨æœ€è¿‘å¤–é¢ç–«æƒ…ä¸¥é‡ï¼Œè‡ªå·±åŸºæœ¬ä¸Šä¹Ÿå°±ä¸€å¤©å¾…åœ¨å®¶é‡Œï¼Œæ‰“CTFï¼Œé…ç½®Blockbotï¼Œæ‘¸é±¼æ‘¸é±¼åœ¨æ‘¸é±¼ï¼Œ<del>Hadoopçš„é¡¹ç›®è¿˜æ²¡æµ‹è¯•å‘¢</del>ï¼Œé™¢ç§‘åä¹Ÿæœ‰ä¸¤å¤©æ²¡æ‰“å¡ï¼Œ<del>å¥½åœ¨è¿˜æ˜¯è¡¥ä¸Šäº†</del>ã€‚</p><p>å¸Œæœ›æ–°å­¦æœŸèƒ½æ­£å¸¸å¼€å­¦ï¼Œæˆ‘ä¸æƒ³ä¸Šç½‘è¯¾ï¼Œæˆ‘åªæ˜¯æœŸæœ«æƒ³è€ƒ61è€Œå·²ã€‚</p><h2 id="1-Tuti"><a href="#1-Tuti" class="headerlink" title="1.Tuti"></a>1.Tuti</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br>l = <span class="hljs-built_in">len</span>(flag)<br>m_1, m_2 = flag[: l // <span class="hljs-number">2</span>], flag[l // <span class="hljs-number">2</span>:]<br>x, y = bytes_to_long(m_1), bytes_to_long(m_2)<br>k = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">000bfdc32162934ad6a054b4b3db8578674e27a165113f8ed018cbe91124fbd63144ab6923d107eee2bc0712fcbdb50d96fdf04dd1ba1b69cb1efe71af7ca08ddc7cc2d3dfb9080ae56861d952e8d5ec0ba0d3dfdf2d12764</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>.replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">assert</span>((x**<span class="hljs-number">2</span> + <span class="hljs-number">1</span>)*(y**<span class="hljs-number">2</span> + <span class="hljs-number">1</span>) - <span class="hljs-number">2</span>*(x - y)*(x*y - <span class="hljs-number">1</span>) == <span class="hljs-number">4</span>*(<span class="hljs-built_in">int</span>(k, <span class="hljs-number">16</span>) + x*y))<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™é“é¢˜å‘Šè¯‰ä½ äº†ä¸¤æ®µå¯†æ–‡ä¹‹é—´çš„å…³ç³»ï¼š$(x^2+1)(y^2+1)-2(x-y)(xy-1)&#x3D;4(k+xy)$ã€‚</p><p>ç¬¬ä¸€ååº”è‚¯å®šæ˜¯è¦æŠŠ$xy$ä¹‹ç±»çš„æœªçŸ¥é‡ç§»åˆ°ç­‰å·ä¸€è¾¹ï¼Œç„¶åç­‰å·ä¸¤è¾¹å±•å¼€ï¼Œè‡ªå·±å°±ä»€ä¹ˆä¹Ÿçœ‹ä¸å‡ºæ¥äº†ã€‚</p><p>ç„¶åæˆ‘æƒ³åˆ°äº†sagemathï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥åˆ†è§£å› æ•°ï¼Œè¯´ä¸å®šå¯ä»¥åˆ†è§£å› å¼å‘¢â€”â€”è²Œä¼¼ç¡®å®å¯è¡Œï¼Œ$4xy$ç§»åˆ°å·¦è¾¹åå¯¹å·¦è¾¹å¼å­çš„åˆ†è§£å› å¼ç»“æœæ˜¯$(x+1)^2(y+1)^2$ï¼Œè¿™ç¡®å®æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ç»“æœï¼Œå¾ˆå¤šå¤§ä½¬éƒ½æ˜¯æ‰‹æ“çš„â€”â€”ç„¶è€Œè‡ªå·±å°±ä¸è¡Œäº†ï¼Œå› ä¸ºè‡ªå·±è§£ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹å¦‚æœäºŒæ¬¡é¡¹ä¸ä¸º$1$è‡ªå·±å°±åˆ†è§£ä¸å‡ºè¿™ä¸ªå¼å­äº†ï¼ˆæ¯”å¦‚$2x^2+7x+3&#x3D;0$ï¼Œç¬”è€…é‡åˆ°ç›´æ¥ä¸Šæ±‚æ ¹å…¬å¼â€”â€”<code>define huangx607087 fw</code>ï¼‰ã€‚</p><p>ç„¶åå¯¹å³è¾¹ç›´æ¥å¼€å¹³æ–¹å°±æ˜¯$(x+1)(y+1)$çš„å€¼äº†ï¼Œè‡³äºåˆ†è§£å³è¾¹çš„é‚£ä¸ªæ•°å­—ï¼ˆå®æµ‹æ˜¯$14$ä¸ªå› æ•°ï¼‰ï¼Œæ ¹æ®$x,y$çš„ä½æ•°å·®ä¸å¤šï¼Œåœ¨åŠ ä¸Šflagä¸€å®šæ˜¯å¯è¯»å­—ç¬¦ï¼Œç›´æ¥æšä¸¾å„ç§å¯èƒ½æ€§å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">a,b</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">len</span>(a)-<span class="hljs-built_in">len</span>(b))&gt;<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> printable:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b:<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">chr</span>(i)) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> printable:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>k = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">000bfdc32162934ad6a054b4b3db8578674e27a165113f8ed018cbe9112</span><br><span class="hljs-string">4fbd63144ab6923d107eee2bc0712fcbdb50d96fdf04dd1ba1b69cb1efe</span><br><span class="hljs-string">71af7ca08ddc7cc2d3dfb9080ae56861d952e8d5ec0ba0d3dfdf2d12764</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>.replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>k=<span class="hljs-built_in">int</span>(k,<span class="hljs-number">16</span>)<br>mul=iroot(<span class="hljs-number">4</span>*k,<span class="hljs-number">2</span>)<br><span class="hljs-keyword">assert</span> mul[<span class="hljs-number">1</span>]<br>mul=mul[<span class="hljs-number">0</span>]<br>S=[<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">11</span>,<span class="hljs-number">11</span>,<span class="hljs-number">19</span>,<span class="hljs-number">47</span>,<span class="hljs-number">71</span>,<span class="hljs-number">3449</span>,<span class="hljs-number">11953</span>,<span class="hljs-number">5485619</span>,<span class="hljs-number">2035395403834744453</span>,<span class="hljs-number">17258104558019725087</span>,<span class="hljs-number">1357459302115148222329561139218955500171643099</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">14</span>):<br>    M1,M2=<span class="hljs-number">1</span>,<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>):<br>        <span class="hljs-keyword">if</span> i&amp;(<span class="hljs-number">1</span>&lt;&lt;j):<br>            M1*=S[j]<br>        <span class="hljs-keyword">else</span>:<br>            M2*=S[j]<br>    a,b=long_to_bytes(M1-<span class="hljs-number">1</span>),long_to_bytes(M2+<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">if</span>(check(a,b)):<br>        <span class="hljs-built_in">print</span>(a+b)<br><span class="hljs-comment">#CCTF&#123;S1mPL3_4Nd_N!cE_Diophantine_EqUa7I0nS!&#125;</span><br></code></pre></td></tr></table></figure><p>æœ€åè§£å‡ºæ¥ä¸ºä»€ä¹ˆåˆæ˜¯ä¸¢ç•ªå›¾æ–¹ç¨‹ï¼Œçœ‹æ¥CryptoCTFå‡ºé¢˜äººå¯¹ä¸¢ç•ªå›¾æƒ…æœ‰ç‹¬é’Ÿå•Šï¼Œè¿™è®©æˆ‘æƒ³èµ·æ¥å½“å¹´é‚£ä¸ªç§‘åé‡Œçš„é‚£ä¸ªå¯¹è¯</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">A:</span>è®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹ä¸¢ç•ªå›¾<br><span class="hljs-symbol">B:</span>ç•ªå›¾æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦ä¸¢æ‰<br></code></pre></td></tr></table></figure><h2 id="2-RSAphantine"><a href="#2-RSAphantine" class="headerlink" title="2.RSAphantine"></a>2.RSAphantine</h2><p><del>çœ‹åå­—ï¼Œå¾ˆæ˜æ˜¾ï¼Œåˆæ˜¯è·Ÿä¸¢ç•ªå›¾æœ‰å…³çš„</del></p><p>é¢˜ç›®å°±ç»™å‡ºäº†ä¸€ä¸ªæ–¹ç¨‹ç»„ï¼Œå’Œä¸€ä¸ªRSAåŠ å¯†çš„ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">2</span>*z**<span class="hljs-number">5</span> - x**<span class="hljs-number">3</span> + y*z = <span class="hljs-number">47769864706750161581152919266942014884728504309791272300873440765010405681123224050402253883248571746202060439521835359010439155922618613520747411963822349374260144229698759495359592287331083229572369186844312169397998958687629858407857496154424105344376591742814310010312178029414792153520127354594349356721</span><br>x**<span class="hljs-number">4</span> + y**<span class="hljs-number">5</span> + x*y*z = <span class="hljs-number">89701863794494741579279495149280970802005356650985500935516314994149482802770873012891936617235883383779949043375656934782512958529863426837860653654512392603575042842591799236152988759047643602681210429449595866940656449163014827637584123867198437888098961323599436457342203222948370386342070941174587735051</span><br>y**<span class="hljs-number">6</span> + <span class="hljs-number">2</span>*z**<span class="hljs-number">5</span> + z*y = <span class="hljs-number">47769864706750161581152919266942014884728504309791272300873440765010405681123224050402253883248571746202060439521835359010439155922618613609786612391835856376321085593999733543104760294208916442207908167085574197779179315081994735796390000652436258333943257231020011932605906567086908226693333446521506911058</span><br>p = nextPrime(x**<span class="hljs-number">2</span> + z**<span class="hljs-number">2</span> + y**<span class="hljs-number">2</span> &lt;&lt; <span class="hljs-number">76</span>)<br>q = nextPrime(z**<span class="hljs-number">2</span> + y**<span class="hljs-number">3</span> - y*x*z ^ <span class="hljs-number">67</span>)<br>n, e = p * q, <span class="hljs-number">31337</span><br>m = bytes_to_long(FLAG)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br>c = <span class="hljs-number">486675922771716096231737399040548486325658137529857293201278143425470143429646265649376948017991651364539656238516890519597468182912015548139675971112490154510727743335620826075143903361868438931223801236515950567326769413127995861265368340866053590373839051019268657129382281794222269715218496547178894867320406378387056032984394810093686367691759705672</span><br><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡ä¹ä¸€çœ‹ï¼Œä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆæ€è·¯ï¼Œå› ä¸ºä¸‰ä¸ªéƒ½æ˜¯é«˜æ¬¡æ–¹ç¨‹çš„ç»„åˆï¼Œä¸‰ä¸ªæœªçŸ¥æ•°ï¼Œç¡®å®æ˜¯æ±‚ä¸å‡ºæ¥äº†çš„ã€‚æƒ³è¦æ¶ˆå…ƒé™æ¬¡ä¹Ÿå‡ ä¹ä¸å¯èƒ½â€”â€”å› ä¸ºè‡ªå·±å®æµ‹è¿‡äº†ï¼ˆ</p><p>ä¸è¿‡è¿™ä¸ªæ—¶å€™å¯ä»¥æŠŠé‡ç‚¹èšç„¦åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªå¼å­ä¸Šï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå¼å­å’Œç¬¬ä¸‰ä¸ªå¼å­éƒ½æœ‰å…¬å…±çš„éƒ¨åˆ†å°±æ˜¯$2z^5$ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªå¼å­ç®—å‡ºæ¥çš„ç»“æœæœ‰å¾ˆé•¿çš„é«˜ä½æ—¶ç›¸åŒçš„ï¼Œè¿™ç¡®å®æ˜¯ä¸€ä¸ªä»¤äººæ€€ç–‘çš„åœ°æ–¹â€”â€”å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹ï¼šå¯¹è¿™ä¸¤ä¸ªæ•°å­—é™¤ä»¥$2$åç›´æ¥å¼€äº”æ¬¡æ–¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—å‡º$z$çš„å‡†ç¡®å€¼ã€‚</p><p>äº‹å®ä¸Šç¡®å®å¦‚æ­¤ï¼Œå€ŸåŠ©pythonä¸­çš„irootç›´æ¥å¼€æ ¹â€”â€”å¯ä»¥å‘ç°è¿™ä¸¤ä¸ªæ•°å­—é™¤ä»¥$2$åå¼€äº”æ¬¡æ–¹æ ¹çš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œè€Œè¿™ä¸ªæ•°å­—æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯è§£å‡ºæ¥çš„$z$å€¼â€”â€”äº‹å®ä¸Šè§£å‡ºæ¥ç¡®å®å¦‚æ­¤ã€‚</p><p>è§£å‡ºæ¥ä¹‹åï¼Œ$x,y$ä¸¤ä¸ªæ•°å­—å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°æ±‚å‡ºæ¥äº†â€”â€”æˆ‘è¿™è¾¹ç”¨çš„æ˜¯$y^6+zy&#x3D;a_3-2z^5$è¿™ä¸ªå¼å­é€šè¿‡äºŒåˆ†å¾—å‡ºç»“æœçš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–çš„åŠæ³•æ±‚$y$ï¼Œæ±‚å‡º$y$åå°±å¯ä»¥ç›´æ¥æ±‚$x$äº†ï¼Œä¸è¿‡æœ€å$x$æ˜¯è´Ÿçš„ä»¤æˆ‘æ²¡æƒ³åˆ°ï¼Œä½†assertå¯¹äº†é‚£å°±è¯´æ˜æ²¡é—®é¢˜äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot,next_prime<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>a1=<span class="hljs-number">47769864706750161581152919266942014884728504309791272300873440765010405681123224050402253883248571746202060439521835359010439155922618613520747411963822349374260144229698759495359592287331083229572369186844312169397998958687629858407857496154424105344376591742814310010312178029414792153520127354594349356721</span><br>a2=<span class="hljs-number">89701863794494741579279495149280970802005356650985500935516314994149482802770873012891936617235883383779949043375656934782512958529863426837860653654512392603575042842591799236152988759047643602681210429449595866940656449163014827637584123867198437888098961323599436457342203222948370386342070941174587735051</span><br>a3=<span class="hljs-number">47769864706750161581152919266942014884728504309791272300873440765010405681123224050402253883248571746202060439521835359010439155922618613609786612391835856376321085593999733543104760294208916442207908167085574197779179315081994735796390000652436258333943257231020011932605906567086908226693333446521506911058</span><br>Tz1,Tz3=iroot(a1//<span class="hljs-number">2</span>,<span class="hljs-number">5</span>)[<span class="hljs-number">0</span>],iroot(a3//<span class="hljs-number">2</span>,<span class="hljs-number">5</span>)[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">assert</span> Tz1==Tz3<br>z=Tz1<br>x,y=<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span><br>L,R=<span class="hljs-number">0</span>,<span class="hljs-number">10</span>**<span class="hljs-number">1000</span><br><span class="hljs-keyword">while</span> L&lt;=R:<br>    M=(L+R)//<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span>(M**<span class="hljs-number">6</span>+M*z&lt;a3-<span class="hljs-number">2</span>*z**<span class="hljs-number">5</span>):<br>        L=M+<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span>(M**<span class="hljs-number">6</span>+M*z&gt;a3-<span class="hljs-number">2</span>*z**<span class="hljs-number">5</span>):<br>        R=M-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span>(M**<span class="hljs-number">6</span>+M*z==a3-<span class="hljs-number">2</span>*z**<span class="hljs-number">5</span>):<br>        y=M<br>        <span class="hljs-keyword">break</span><br><span class="hljs-keyword">assert</span> y**<span class="hljs-number">6</span>+<span class="hljs-number">2</span>*z**<span class="hljs-number">5</span>+z*y==a3<br>x=iroot(a1-<span class="hljs-number">2</span>*z**<span class="hljs-number">5</span>-y*z,<span class="hljs-number">3</span>)<br><span class="hljs-keyword">assert</span> x[<span class="hljs-number">1</span>]<br>x=-x[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">assert</span> x**<span class="hljs-number">4</span> + y**<span class="hljs-number">5</span> + x*y*z ==a2<br>p = next_prime(x**<span class="hljs-number">2</span> + z**<span class="hljs-number">2</span> + y**<span class="hljs-number">2</span> &lt;&lt; <span class="hljs-number">76</span>)<br>q = next_prime(z**<span class="hljs-number">2</span> + y**<span class="hljs-number">3</span> - y*x*z ^ <span class="hljs-number">67</span>)<br>c=<span class="hljs-number">486675922771716096231737399040548486325658137529857293201278143425470143429646265649376948017991651364539656238516890519597468182912015548139675971112490154510727743335620826075143903361868438931223801236515950567326769413127995861265368340866053590373839051019268657129382281794222269715218496547178894867320406378387056032984394810093686367691759705672</span><br>d=inverse(<span class="hljs-number">31337</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,p*q)))<br><span class="hljs-built_in">print</span>(x)<br><span class="hljs-built_in">print</span>(y)<br><span class="hljs-built_in">print</span>(z)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">flag=CCTF&#123;y0Ur_jO8_C4l13D_Diophantine_An4LySI5!&#125;</span><br><span class="hljs-string">x=-97319611529501810510904538298668204056042623868316550440771307534558768612892</span><br><span class="hljs-string">y=311960913464334198969500852124413736815</span><br><span class="hljs-string">z=29896806674955692028025365368202021035722548934827533460297089</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="3-Onlude"><a href="#3-Onlude" class="headerlink" title="3.Onlude"></a>3.Onlude</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">global</span> p, alphabet<br>p = <span class="hljs-number">71</span><br>alphabet = <span class="hljs-string">&#x27;=0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$!?_&#123;&#125;&lt;&gt;&#x27;</span><br>flag = flag.lstrip(<span class="hljs-string">&#x27;CCTF&#123;&#x27;</span>).rstrip(<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">24</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cross</span>(<span class="hljs-params">m</span>):<br><span class="hljs-keyword">return</span> alphabet.index(m)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">prepare</span>(<span class="hljs-params">msg</span>):<br>A = zero_matrix(GF(p), <span class="hljs-number">11</span>, <span class="hljs-number">11</span>)<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(msg)):<br>i, j = <span class="hljs-number">5</span>*k // <span class="hljs-number">11</span>, <span class="hljs-number">5</span>*k % <span class="hljs-number">11</span><br>A[i, j] = cross(msg[k])<br><span class="hljs-keyword">return</span> A<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>():<br>R = random_matrix(GF(p), <span class="hljs-number">11</span>, <span class="hljs-number">11</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>S = random_matrix(GF(p), <span class="hljs-number">11</span>, <span class="hljs-number">11</span>)<br><span class="hljs-keyword">if</span> S.rank() == <span class="hljs-number">11</span>:<br>_, L, U = S.LU()<br><span class="hljs-keyword">return</span> R, L, U<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">A, key</span>):<br>R, L, U = key<br>S = L * U<br>X = A + R<br>Y = S * X<br>E = L.inverse() * Y<br><span class="hljs-keyword">return</span> E<br>A = prepare(flag)<br>key = keygen()<br>R, L, U = key<br>S = L * U<br>E = encrypt(A, key)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;E = \n<span class="hljs-subst">&#123;E&#125;</span>&#x27;</span>)<span class="hljs-comment">#E</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;L * U * L = \n<span class="hljs-subst">&#123;L * U * L&#125;</span>&#x27;</span>)<span class="hljs-comment">#M1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;L^(-1) * S^2 * L = \n<span class="hljs-subst">&#123;L.inverse() * S**<span class="hljs-number">2</span> * L&#125;</span>&#x27;</span>)<span class="hljs-comment">#M2</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;R^(-1) * S^8 = \n<span class="hljs-subst">&#123;R.inverse() * S**<span class="hljs-number">8</span>&#125;</span>&#x27;</span>)<span class="hljs-comment">#M10</span><br></code></pre></td></tr></table></figure><p>ä¸€é“çŸ©é˜µé¢˜ï¼ŒåŠ å¯†æ–¹æ³•ä¸éš¾ï¼Œæ¶‰åŠçŸ©é˜µè¿ç®—ã€‚</p><p>é¢˜ç›®ç»™å‡ºäº†å¯†æ–‡$E$ï¼Œè¿˜æœ‰ä¸‰ä¸ªè¾…åŠ©é‡$M_1&#x3D;LUL,M_2&#x3D;L^{-1}S^2L,M_{10}&#x3D;R^{-1}S^8$ã€‚ å…¶ä¸­$R$æ˜¯ä¸€ä¸ªéšæœºçŸ©é˜µï¼Œ$L,U$æ˜¯$S$çš„$LU$åˆ†è§£ï¼Œå³$S&#x3D;LU$ã€‚åŠ å¯†æ–¹æ³•ä¸º$E&#x3D;L^{-1}S(A+R)$ï¼Œ$A$å°±æ˜¯æ˜æ–‡</p><p>è¿™è¾¹ç®€å•åœ°æä¸€ä¸‹ä»€ä¹ˆæ˜¯çŸ©é˜µçš„$LU$åˆ†è§£ï¼Œå°±æ˜¯å¯¹äºä»»æ„ä¸€ä¸ªçŸ©é˜µ$M$ï¼Œå¯ä»¥å°†å…¶æ²¿ä¸»å¯¹è§’çº¿æ‹†åˆ†æˆä¸€ä¸ªä¸Šä¸‰è§’çŸ©é˜µ$U$å’Œä¸€ä¸ªä¸‹ä¸‰è§’çŸ©é˜µ$L$ï¼Œä½¿å¾—$LU&#x3D;S$ï¼Œå…¶ä¸­$\det L&#x3D;1,\det U&#x3D;\det S$ï¼Œå› æ­¤è¿™ç§åˆ†è§£æ–¹æ³•æ˜¯å”¯ä¸€çš„ã€‚</p><p>ç”±äº$M_1&#x3D;LUL&#x3D;SL,M_2&#x3D;L^{-1}S^2L$ï¼Œæ ¹æ®çŸ©é˜µçš„é€†è¿ç®—ï¼Œå› æ­¤$M_2^{-1}&#x3D;L^{-1}S^{-2}L$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æœ‰ï¼š<br>$$<br>M_3&#x3D;M_1M_2^{-1}&#x3D;SLL^{-1}S^{-2}L&#x3D;S^{-1}L&#x3D;U^{-1}L^{-1}L&#x3D;U^{-1}<br>$$<br>å¾ˆæ˜¾ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å‡‘$S$å‡ºæ¥ï¼Œé‚£å°±è¦æ¶ˆå»$L$ï¼Œç”±äºæˆ‘ä»¬å‘ç°$M_3&#x3D;S^{-1}L,M_1&#x3D;SL$ï¼Œå› æ­¤æˆ‘ä»¬è®¡ç®—$M_1M_3^{-1}$ï¼Œæœ‰<br>$$<br>M_1M_3^{-1}&#x3D;SLL^{-1}S&#x3D;S^2<br>$$<br>æœ‰äº†$S^2$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡º$S^8$ï¼Œè¿›è€Œè®¡ç®—å‡º$S^{-8}$ã€‚æ•…<br>$$<br>R&#x3D;(M_{10}(S^{-8}))^{-1}&#x3D;S^8M_{10}^{-1}<br>$$<br>ç”±äº$M_3&#x3D;U^{-1}$ï¼Œå› æ­¤å¯¹$M_3$ç›´æ¥æ±‚é€†å°±å¾—åˆ°äº†$U$ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œ$R,U$éƒ½å¾—åˆ°äº†ï¼Œè€Œ$E&#x3D;L^{-1}S(A+R)&#x3D;U(A+R)&#x3D;UA+UR$ï¼Œå› æ­¤$A$å¾ˆå®¹æ˜“å°±å¯ä»¥å¾—åˆ°äº†ã€‚ç„¶åæ ¹æ®ä»–çš„è§„åˆ™ï¼Œå°†çŸ©é˜µé‡Œå¯¹åº”çš„æ•°å­—è½¬åŒ–æˆå­—å…¸ä¸­çš„å†…å®¹ï¼Œè¿™é“é¢˜å°±è§£å‡ºæ¥äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>E=[[<span class="hljs-number">25</span>,<span class="hljs-number">55</span>,<span class="hljs-number">61</span>,<span class="hljs-number">28</span>,<span class="hljs-number">11</span>,<span class="hljs-number">46</span>,<span class="hljs-number">19</span>,<span class="hljs-number">50</span>,<span class="hljs-number">37</span>,<span class="hljs-number">5</span>,<span class="hljs-number">21</span>],[<span class="hljs-number">20</span>,<span class="hljs-number">57</span>,<span class="hljs-number">39</span>,<span class="hljs-number">9</span>,<span class="hljs-number">25</span>,<span class="hljs-number">37</span>,<span class="hljs-number">63</span>,<span class="hljs-number">31</span>,<span class="hljs-number">70</span>,<span class="hljs-number">15</span>,<span class="hljs-number">47</span>],[<span class="hljs-number">56</span>,<span class="hljs-number">31</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">50</span>,<span class="hljs-number">67</span>,<span class="hljs-number">38</span>,<span class="hljs-number">14</span>,<span class="hljs-number">42</span>,<span class="hljs-number">46</span>,<span class="hljs-number">14</span>],[<span class="hljs-number">42</span>,<span class="hljs-number">54</span>,<span class="hljs-number">38</span>,<span class="hljs-number">22</span>,<span class="hljs-number">19</span>,<span class="hljs-number">55</span>,<span class="hljs-number">7</span>,<span class="hljs-number">18</span>,<span class="hljs-number">45</span>,<span class="hljs-number">53</span>,<span class="hljs-number">39</span>],[<span class="hljs-number">55</span>,<span class="hljs-number">26</span>,<span class="hljs-number">42</span>,<span class="hljs-number">15</span>,<span class="hljs-number">48</span>,<span class="hljs-number">6</span>,<span class="hljs-number">24</span>,<span class="hljs-number">4</span>,<span class="hljs-number">17</span>,<span class="hljs-number">60</span>,<span class="hljs-number">64</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">38</span>,<span class="hljs-number">50</span>,<span class="hljs-number">10</span>,<span class="hljs-number">19</span>,<span class="hljs-number">57</span>,<span class="hljs-number">26</span>,<span class="hljs-number">48</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>,<span class="hljs-number">14</span>],[<span class="hljs-number">13</span>,<span class="hljs-number">4</span>,<span class="hljs-number">38</span>,<span class="hljs-number">54</span>,<span class="hljs-number">23</span>,<span class="hljs-number">34</span>,<span class="hljs-number">54</span>,<span class="hljs-number">42</span>,<span class="hljs-number">15</span>,<span class="hljs-number">56</span>,<span class="hljs-number">29</span>],[<span class="hljs-number">26</span>,<span class="hljs-number">66</span>,<span class="hljs-number">8</span>,<span class="hljs-number">48</span>,<span class="hljs-number">6</span>,<span class="hljs-number">70</span>,<span class="hljs-number">44</span>,<span class="hljs-number">8</span>,<span class="hljs-number">67</span>,<span class="hljs-number">68</span>,<span class="hljs-number">65</span>],[<span class="hljs-number">56</span>,<span class="hljs-number">67</span>,<span class="hljs-number">49</span>,<span class="hljs-number">61</span>,<span class="hljs-number">18</span>,<span class="hljs-number">34</span>,<span class="hljs-number">53</span>,<span class="hljs-number">21</span>,<span class="hljs-number">7</span>,<span class="hljs-number">48</span>,<span class="hljs-number">32</span>],[<span class="hljs-number">15</span>,<span class="hljs-number">70</span>,<span class="hljs-number">10</span>,<span class="hljs-number">34</span>,<span class="hljs-number">1</span>,<span class="hljs-number">57</span>,<span class="hljs-number">70</span>,<span class="hljs-number">27</span>,<span class="hljs-number">12</span>,<span class="hljs-number">33</span>,<span class="hljs-number">46</span>],[<span class="hljs-number">25</span>,<span class="hljs-number">29</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">30</span>,<span class="hljs-number">55</span>,<span class="hljs-number">63</span>,<span class="hljs-number">49</span>,<span class="hljs-number">11</span>,<span class="hljs-number">36</span>,<span class="hljs-number">7</span>]]<br>M1=[[<span class="hljs-number">50</span>,<span class="hljs-number">8</span>,<span class="hljs-number">21</span>,<span class="hljs-number">16</span>,<span class="hljs-number">13</span>,<span class="hljs-number">33</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">35</span>,<span class="hljs-number">20</span>,<span class="hljs-number">14</span>],[<span class="hljs-number">36</span>,<span class="hljs-number">55</span>,<span class="hljs-number">36</span>,<span class="hljs-number">34</span>,<span class="hljs-number">27</span>,<span class="hljs-number">28</span>,<span class="hljs-number">23</span>,<span class="hljs-number">21</span>,<span class="hljs-number">62</span>,<span class="hljs-number">17</span>,<span class="hljs-number">8</span>],[<span class="hljs-number">56</span>,<span class="hljs-number">26</span>,<span class="hljs-number">49</span>,<span class="hljs-number">39</span>,<span class="hljs-number">43</span>,<span class="hljs-number">30</span>,<span class="hljs-number">35</span>,<span class="hljs-number">46</span>,<span class="hljs-number">0</span>,<span class="hljs-number">58</span>,<span class="hljs-number">43</span>],[<span class="hljs-number">11</span>,<span class="hljs-number">25</span>,<span class="hljs-number">25</span>,<span class="hljs-number">35</span>,<span class="hljs-number">29</span>,<span class="hljs-number">0</span>,<span class="hljs-number">22</span>,<span class="hljs-number">38</span>,<span class="hljs-number">53</span>,<span class="hljs-number">51</span>,<span class="hljs-number">58</span>],[<span class="hljs-number">34</span>,<span class="hljs-number">14</span>,<span class="hljs-number">69</span>,<span class="hljs-number">68</span>,<span class="hljs-number">5</span>,<span class="hljs-number">32</span>,<span class="hljs-number">27</span>,<span class="hljs-number">4</span>,<span class="hljs-number">27</span>,<span class="hljs-number">62</span>,<span class="hljs-number">15</span>],[<span class="hljs-number">46</span>,<span class="hljs-number">49</span>,<span class="hljs-number">36</span>,<span class="hljs-number">42</span>,<span class="hljs-number">26</span>,<span class="hljs-number">12</span>,<span class="hljs-number">28</span>,<span class="hljs-number">60</span>,<span class="hljs-number">54</span>,<span class="hljs-number">66</span>,<span class="hljs-number">23</span>],[<span class="hljs-number">69</span>,<span class="hljs-number">55</span>,<span class="hljs-number">30</span>,<span class="hljs-number">65</span>,<span class="hljs-number">56</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">36</span>,<span class="hljs-number">26</span>,<span class="hljs-number">46</span>,<span class="hljs-number">48</span>],[<span class="hljs-number">25</span>,<span class="hljs-number">48</span>,<span class="hljs-number">16</span>,<span class="hljs-number">20</span>,<span class="hljs-number">34</span>,<span class="hljs-number">57</span>,<span class="hljs-number">64</span>,<span class="hljs-number">62</span>,<span class="hljs-number">61</span>,<span class="hljs-number">25</span>,<span class="hljs-number">62</span>],[<span class="hljs-number">68</span>,<span class="hljs-number">39</span>,<span class="hljs-number">11</span>,<span class="hljs-number">40</span>,<span class="hljs-number">25</span>,<span class="hljs-number">11</span>,<span class="hljs-number">7</span>,<span class="hljs-number">40</span>,<span class="hljs-number">24</span>,<span class="hljs-number">43</span>,<span class="hljs-number">65</span>],[<span class="hljs-number">54</span>,<span class="hljs-number">20</span>,<span class="hljs-number">40</span>,<span class="hljs-number">59</span>,<span class="hljs-number">52</span>,<span class="hljs-number">60</span>,<span class="hljs-number">37</span>,<span class="hljs-number">14</span>,<span class="hljs-number">32</span>,<span class="hljs-number">44</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">45</span>,<span class="hljs-number">20</span>,<span class="hljs-number">7</span>,<span class="hljs-number">26</span>,<span class="hljs-number">45</span>,<span class="hljs-number">45</span>,<span class="hljs-number">50</span>,<span class="hljs-number">17</span>,<span class="hljs-number">41</span>,<span class="hljs-number">59</span>,<span class="hljs-number">50</span>]]<br>M2=[[<span class="hljs-number">34</span>,<span class="hljs-number">12</span>,<span class="hljs-number">70</span>,<span class="hljs-number">21</span>,<span class="hljs-number">36</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">43</span>,<span class="hljs-number">7</span>,<span class="hljs-number">14</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">54</span>,<span class="hljs-number">59</span>,<span class="hljs-number">12</span>,<span class="hljs-number">64</span>,<span class="hljs-number">35</span>,<span class="hljs-number">9</span>,<span class="hljs-number">7</span>,<span class="hljs-number">49</span>,<span class="hljs-number">11</span>,<span class="hljs-number">49</span>],[<span class="hljs-number">69</span>,<span class="hljs-number">14</span>,<span class="hljs-number">10</span>,<span class="hljs-number">19</span>,<span class="hljs-number">16</span>,<span class="hljs-number">27</span>,<span class="hljs-number">11</span>,<span class="hljs-number">9</span>,<span class="hljs-number">26</span>,<span class="hljs-number">10</span>,<span class="hljs-number">45</span>],[<span class="hljs-number">70</span>,<span class="hljs-number">17</span>,<span class="hljs-number">41</span>,<span class="hljs-number">13</span>,<span class="hljs-number">35</span>,<span class="hljs-number">58</span>,<span class="hljs-number">19</span>,<span class="hljs-number">29</span>,<span class="hljs-number">70</span>,<span class="hljs-number">5</span>,<span class="hljs-number">30</span>],[<span class="hljs-number">68</span>,<span class="hljs-number">69</span>,<span class="hljs-number">67</span>,<span class="hljs-number">37</span>,<span class="hljs-number">63</span>,<span class="hljs-number">69</span>,<span class="hljs-number">15</span>,<span class="hljs-number">64</span>,<span class="hljs-number">66</span>,<span class="hljs-number">28</span>,<span class="hljs-number">26</span>],[<span class="hljs-number">18</span>,<span class="hljs-number">29</span>,<span class="hljs-number">64</span>,<span class="hljs-number">38</span>,<span class="hljs-number">63</span>,<span class="hljs-number">67</span>,<span class="hljs-number">15</span>,<span class="hljs-number">27</span>,<span class="hljs-number">64</span>,<span class="hljs-number">6</span>,<span class="hljs-number">26</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">12</span>,<span class="hljs-number">40</span>,<span class="hljs-number">41</span>,<span class="hljs-number">48</span>,<span class="hljs-number">30</span>,<span class="hljs-number">46</span>,<span class="hljs-number">52</span>,<span class="hljs-number">39</span>,<span class="hljs-number">48</span>,<span class="hljs-number">58</span>],[<span class="hljs-number">22</span>,<span class="hljs-number">3</span>,<span class="hljs-number">28</span>,<span class="hljs-number">35</span>,<span class="hljs-number">55</span>,<span class="hljs-number">30</span>,<span class="hljs-number">15</span>,<span class="hljs-number">17</span>,<span class="hljs-number">22</span>,<span class="hljs-number">49</span>,<span class="hljs-number">55</span>],[<span class="hljs-number">50</span>,<span class="hljs-number">55</span>,<span class="hljs-number">55</span>,<span class="hljs-number">61</span>,<span class="hljs-number">45</span>,<span class="hljs-number">23</span>,<span class="hljs-number">24</span>,<span class="hljs-number">32</span>,<span class="hljs-number">10</span>,<span class="hljs-number">59</span>,<span class="hljs-number">69</span>],[<span class="hljs-number">27</span>,<span class="hljs-number">21</span>,<span class="hljs-number">68</span>,<span class="hljs-number">56</span>,<span class="hljs-number">67</span>,<span class="hljs-number">49</span>,<span class="hljs-number">64</span>,<span class="hljs-number">53</span>,<span class="hljs-number">42</span>,<span class="hljs-number">46</span>,<span class="hljs-number">14</span>],[<span class="hljs-number">42</span>,<span class="hljs-number">66</span>,<span class="hljs-number">16</span>,<span class="hljs-number">29</span>,<span class="hljs-number">42</span>,<span class="hljs-number">42</span>,<span class="hljs-number">23</span>,<span class="hljs-number">49</span>,<span class="hljs-number">43</span>,<span class="hljs-number">3</span>,<span class="hljs-number">23</span>]]<br>M10=[[<span class="hljs-number">51</span>,<span class="hljs-number">9</span>,<span class="hljs-number">22</span>,<span class="hljs-number">61</span>,<span class="hljs-number">63</span>,<span class="hljs-number">14</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">18</span>,<span class="hljs-number">18</span>,<span class="hljs-number">23</span>],[<span class="hljs-number">33</span>,<span class="hljs-number">53</span>,<span class="hljs-number">31</span>,<span class="hljs-number">31</span>,<span class="hljs-number">62</span>,<span class="hljs-number">21</span>,<span class="hljs-number">66</span>,<span class="hljs-number">7</span>,<span class="hljs-number">66</span>,<span class="hljs-number">68</span>,<span class="hljs-number">7</span>],[<span class="hljs-number">59</span>,<span class="hljs-number">19</span>,<span class="hljs-number">32</span>,<span class="hljs-number">21</span>,<span class="hljs-number">13</span>,<span class="hljs-number">34</span>,<span class="hljs-number">16</span>,<span class="hljs-number">43</span>,<span class="hljs-number">49</span>,<span class="hljs-number">25</span>,<span class="hljs-number">7</span>],[<span class="hljs-number">44</span>,<span class="hljs-number">37</span>,<span class="hljs-number">4</span>,<span class="hljs-number">29</span>,<span class="hljs-number">70</span>,<span class="hljs-number">50</span>,<span class="hljs-number">46</span>,<span class="hljs-number">39</span>,<span class="hljs-number">55</span>,<span class="hljs-number">4</span>,<span class="hljs-number">65</span>],[<span class="hljs-number">29</span>,<span class="hljs-number">63</span>,<span class="hljs-number">29</span>,<span class="hljs-number">43</span>,<span class="hljs-number">47</span>,<span class="hljs-number">28</span>,<span class="hljs-number">40</span>,<span class="hljs-number">33</span>,<span class="hljs-number">0</span>,<span class="hljs-number">62</span>,<span class="hljs-number">8</span>],[<span class="hljs-number">45</span>,<span class="hljs-number">62</span>,<span class="hljs-number">36</span>,<span class="hljs-number">68</span>,<span class="hljs-number">10</span>,<span class="hljs-number">66</span>,<span class="hljs-number">26</span>,<span class="hljs-number">48</span>,<span class="hljs-number">10</span>,<span class="hljs-number">6</span>,<span class="hljs-number">61</span>],[<span class="hljs-number">43</span>,<span class="hljs-number">30</span>,<span class="hljs-number">25</span>,<span class="hljs-number">18</span>,<span class="hljs-number">23</span>,<span class="hljs-number">38</span>,<span class="hljs-number">61</span>,<span class="hljs-number">0</span>,<span class="hljs-number">52</span>,<span class="hljs-number">46</span>,<span class="hljs-number">35</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">40</span>,<span class="hljs-number">6</span>,<span class="hljs-number">45</span>,<span class="hljs-number">20</span>,<span class="hljs-number">55</span>,<span class="hljs-number">35</span>,<span class="hljs-number">67</span>,<span class="hljs-number">25</span>,<span class="hljs-number">14</span>,<span class="hljs-number">63</span>],[<span class="hljs-number">15</span>,<span class="hljs-number">30</span>,<span class="hljs-number">61</span>,<span class="hljs-number">66</span>,<span class="hljs-number">25</span>,<span class="hljs-number">33</span>,<span class="hljs-number">14</span>,<span class="hljs-number">20</span>,<span class="hljs-number">60</span>,<span class="hljs-number">50</span>,<span class="hljs-number">50</span>],[<span class="hljs-number">29</span>,<span class="hljs-number">15</span>,<span class="hljs-number">53</span>,<span class="hljs-number">22</span>,<span class="hljs-number">55</span>,<span class="hljs-number">64</span>,<span class="hljs-number">69</span>,<span class="hljs-number">56</span>,<span class="hljs-number">44</span>,<span class="hljs-number">40</span>,<span class="hljs-number">8</span>],[<span class="hljs-number">28</span>,<span class="hljs-number">40</span>,<span class="hljs-number">69</span>,<span class="hljs-number">60</span>,<span class="hljs-number">28</span>,<span class="hljs-number">41</span>,<span class="hljs-number">9</span>,<span class="hljs-number">14</span>,<span class="hljs-number">29</span>,<span class="hljs-number">4</span>,<span class="hljs-number">29</span>]]<br>E,M1,M2,M10=matrix(GF(<span class="hljs-number">71</span>),E),matrix(GF(<span class="hljs-number">71</span>),M1),matrix(GF(<span class="hljs-number">71</span>),M2),matrix(GF(<span class="hljs-number">71</span>),M10)<br>M3=M1*(M2^-<span class="hljs-number">1</span>)<br>S2=M1*(M3^-<span class="hljs-number">1</span>)<br>R=(M10*S2^-<span class="hljs-number">4</span>)^-<span class="hljs-number">1</span><br>U=M3^-<span class="hljs-number">1</span><br>UA=E-U*R<br>A=M3*UA<br>Dic=<span class="hljs-string">&#x27;=0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$!?_&#123;&#125;&lt;&gt;&#x27;</span><br>F,K=<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(F)&lt;<span class="hljs-number">24</span>:<br>    F+=Dic[A[K//<span class="hljs-number">11</span>][K%<span class="hljs-number">11</span>]]<br>    K+=<span class="hljs-number">5</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;CCTF&#123;&#x27;</span>+F+<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br><span class="hljs-comment">#CCTF&#123;LU__D3c0mpO517Ion__4L90?&#125;</span><br></code></pre></td></tr></table></figure><h2 id="4-Triplet"><a href="#4-Triplet" class="headerlink" title="4.Triplet"></a>4.Triplet</h2><p>ä¸€ä¸ªè¿œç¨‹äº¤äº’çš„é¢˜ç›®ï¼Œçœ‹èµ·æ¥ä¼¼ä¹æœ‰ç‚¹éš¾åº¦ï¼Œä¹Ÿæœ‰ç‚¹è„‘æ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> FLAG<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">die</span>(<span class="hljs-params">*args</span>):<br>pr(*args)<br>quit()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>(<span class="hljs-params">*args</span>):<br>s = <span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, args))<br>sys.stdout.write(s + <span class="hljs-string">&quot;\n&quot;</span>)<br>sys.stdout.flush()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sc</span>():<br><span class="hljs-keyword">return</span> sys.stdin.readline().strip()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>border = <span class="hljs-string">&quot;+&quot;</span><br>pr(border*<span class="hljs-number">72</span>)<br>pr(border, <span class="hljs-string">&quot; hi talented cryptographers, the mission is to find the three RSA   &quot;</span>, border)<br>pr(border, <span class="hljs-string">&quot; modulus with the same public and private exponent! Try your chance!&quot;</span>, border)<br>pr(border*<span class="hljs-number">72</span>)<br>nbit = <span class="hljs-number">160</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>pr(<span class="hljs-string">&quot;| Options: \n|\t[S]end the three nbit prime pairs \n|\t[Q]uit&quot;</span>)<br>ans = sc().lower()<br>order = [<span class="hljs-string">&#x27;first&#x27;</span>, <span class="hljs-string">&#x27;second&#x27;</span>, <span class="hljs-string">&#x27;third&#x27;</span>]<br><span class="hljs-keyword">if</span> ans == <span class="hljs-string">&#x27;s&#x27;</span>:<br>P, N = [], []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>pr(<span class="hljs-string">&quot;| Send the &quot;</span> + order[i] + <span class="hljs-string">&quot; RSA primes such that nbit &gt;= &quot;</span> + <span class="hljs-built_in">str</span>(nbit) + <span class="hljs-string">&quot;: p_&quot;</span> + <span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>) + <span class="hljs-string">&quot;, q_&quot;</span> + <span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>) + <span class="hljs-string">&quot; &quot;</span>)<br>params = sc()<br><span class="hljs-keyword">try</span>:<br>p, q = params.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>p, q = <span class="hljs-built_in">int</span>(p), <span class="hljs-built_in">int</span>(q)<br><span class="hljs-keyword">except</span>:<br>die(<span class="hljs-string">&quot;| your primes are not valid!!&quot;</span>)<br><span class="hljs-keyword">if</span> isPrime(p) <span class="hljs-keyword">and</span> isPrime(q) <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:]) &gt;= nbit <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(q)[<span class="hljs-number">2</span>:]) &gt;= nbit:<br>P.append((p, q))<br>n = p * q<br>N.append(n)<br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">&quot;| your input is not desired prime, Bye!&quot;</span>)<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">set</span>(N)) == <span class="hljs-number">3</span>:<br>pr(<span class="hljs-string">&quot;| Send the public and private exponent: e, d &quot;</span>)<br>params = sc()<br><span class="hljs-keyword">try</span>:<br>e, d = params.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>e, d = <span class="hljs-built_in">int</span>(e), <span class="hljs-built_in">int</span>(d)<br><span class="hljs-keyword">except</span>:<br>die(<span class="hljs-string">&quot;| your parameters are not valid!! Bye!!!&quot;</span>)<br>phi_1 = (P[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] - <span class="hljs-number">1</span>)*(P[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] - <span class="hljs-number">1</span>)<br>phi_2 = (P[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - <span class="hljs-number">1</span>)*(P[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] - <span class="hljs-number">1</span>)<br>phi_3 = (P[<span class="hljs-number">2</span>][<span class="hljs-number">0</span>] - <span class="hljs-number">1</span>)*(P[<span class="hljs-number">2</span>][<span class="hljs-number">1</span>] - <span class="hljs-number">1</span>)<br><span class="hljs-keyword">if</span> <span class="hljs-number">1</span> &lt; e &lt; <span class="hljs-built_in">min</span>([phi_1, phi_2, phi_3]) <span class="hljs-keyword">and</span> <span class="hljs-number">1</span> &lt; d &lt; <span class="hljs-built_in">min</span>([phi_1, phi_2, phi_3]):<br>b = (e * d % phi_1 == <span class="hljs-number">1</span>) <span class="hljs-keyword">and</span> (e * d % phi_2 == <span class="hljs-number">1</span>) <span class="hljs-keyword">and</span> (e * d % phi_3 == <span class="hljs-number">1</span>)<br><span class="hljs-keyword">if</span> b:<br>die(<span class="hljs-string">&quot;| You got the flag:&quot;</span>, FLAG)<br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">&quot;| invalid exponents, bye!!!&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">&quot;| the exponents are too small or too large!&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">&quot;| kidding me?!!, bye!&quot;</span>)<br><span class="hljs-keyword">elif</span> ans == <span class="hljs-string">&#x27;q&#x27;</span>:<br>die(<span class="hljs-string">&quot;Quitting ...&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">&quot;Bye ...&quot;</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>main()<br></code></pre></td></tr></table></figure><p>ç®€å•çœ‹è¿‡ä»£ç åï¼Œå°±æ˜¯ä½ è¦æ„é€ ä¸‰ä¸ªä¸åŒçš„RSAæ¨¡æ•°$n_1,n_2,n_3$ï¼Œå¤§å°å¿…é¡»è¶…è¿‡$320$ä½ï¼ˆä¹Ÿå°±æ˜¯ä¸¤ä¸ª$160$ä½çš„ç´ æ•°ç›¸ä¹˜ï¼‰ã€‚ä½¿å¾—è¿™ä¸‰ä¸ªæ¨¡æ•°æ‹¥æœ‰ä¸€ç»„ç›¸åŒçš„$(e,d)$ï¼Œä½¿å¾—$(e,d)$å‡å°äºä¸‰ä¸ª$\phi$å€¼ã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯è¦è®©$ed$çš„å€¼å¾ˆå°ä¸”ä¸èƒ½ä¸º$1$ã€‚</p><p>ç”±äº$ed\equiv 1 \pmod \phi$ã€‚æ ¹æ®æ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼Œç”±äºä¸‰ä¸ª$\phi$ä¸åŒï¼Œä½†$ed$ç›¸åŒï¼Œå› æ­¤è¿™é‡Œ$ed$é™¤äº†$1$ï¼Œåªèƒ½è®©$\mathrm{lcm}(\phi_1,\phi_2,\phi_3)$çš„å€¼è¶³å¤Ÿå°ã€‚æ¢å¥è¯å°±æ˜¯è®©$\gcd(\phi_1,\phi_2,\phi_3)$è¶³å¤Ÿå¤§ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸‰ä¸ªç´ æ•°$p,q,r&#x3D;k_ig+1$ï¼Œå…¶ä¸­$i$å–å€¼ä¸º$1$åˆ°$3$ï¼Œ$k_i$è¿œå°äº$g$ï¼Œè€Œè¿™ä¸ª$g$ï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€æƒ³è¦çš„$\gcd(\phi_1,\phi_2,\phi_3)$ã€‚æˆ‘ä»¬å¯ä»¥æ„é€ $g&#x3D;2^{158},2^{159},2^{160}$ï¼Œå½“ç„¶è¿™è¾¹ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘åœ¨è¿™é‡Œçš„$g$é€‰æ‹©äº†$10$çš„æ¬¡å¹‚ï¼Œå› ä¸ºè¿™æ ·çœ‹èµ·æ¥é¡ºçœ¼ï¼ˆx</p><p>äºæ˜¯å¯ä»¥æ„é€ ï¼š $p&#x3D;1537000000000000000000000000000000000000000000001$ï¼Œ$q&#x3D;1545000000000000000000000000000000000000000000001$ï¼Œ$r&#x3D;1591000000000000000000000000000000000000000000001$</p><p>ï¼Œè¿™æ ·å­ä¸‰ä¸ª$\phi$çš„å…¬çº¦æ•°å°±å¾ˆå¤§äº†ã€‚ç„¶åæˆ‘ä»¬åˆ†åˆ«å¯¹æœåŠ¡å™¨å‘é€$p,q$ï¼Œ$p,r$ï¼Œ$q,r$ï¼Œå®Œæˆç¬¬ä¸€æ­¥ã€‚</p><p>ç„¶åæˆ‘ä»¬è®¡ç®—$L&#x3D;\mathrm{lcm}(\phi_1,\phi_2,\phi_3)$ï¼Œå¾—ï¼š<br>$$<br>L&#x3D;3778092015000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001<br>$$<br>åˆ†è§£è¿™ä¸ª$L$ï¼Œæœ‰<br>$$<br>31Ã—32251Ã—3778919598392047858481007340607593062880770888824652598919163296761990876001844403924459456621<br>$$<br>å› æ­¤æˆ‘ä»¬æœ‰$e&#x3D;31Ã—32251&#x3D;999781$ï¼Œ$d&#x3D;3778919598392047858481007340607593062880770888824652598919163296761990876001844403924459456621$ã€‚ç›´æ¥å‘é€è¿‡å»å°±å¯ä»¥å¾—åˆ°æœ€åçš„ç»“æœ</p><p><img src="/2021/08/07/CryptoCTFWriteUp2/1.jpg" alt="1"></p><h2 id="5-Tiny-ECC"><a href="#5-Tiny-ECC" class="headerlink" title="5.Tiny ECC"></a>5.Tiny ECC</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> mini_ecdsa <span class="hljs-keyword">import</span> *<span class="hljs-comment">#è¿™ä¸ªåŒ…é‡Œé›†æˆäº†ä¸€äº›ECCçš„ç®—æ³•ï¼Œä¸é¢˜ç›®æ— å…³ï¼Œæ­¤å¤„ç•¥å»</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tonelli_shanks</span>(<span class="hljs-params">n, p</span>):<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(n, <span class="hljs-built_in">int</span>((p-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>), p) == <span class="hljs-number">1</span>:<br>s = <span class="hljs-number">1</span><br>q = <span class="hljs-built_in">int</span>((p-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br><span class="hljs-keyword">if</span> q % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>q = q // <span class="hljs-number">2</span><br>s += <span class="hljs-number">1</span><br><span class="hljs-keyword">else</span>:<br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">if</span> s == <span class="hljs-number">1</span>:<br>r1 = <span class="hljs-built_in">pow</span>(n, <span class="hljs-built_in">int</span>((p+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>), p)<br>r2 = p - r1<br><span class="hljs-keyword">return</span> r1, r2<br><span class="hljs-keyword">else</span>:<br>z = <span class="hljs-number">2</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(z, <span class="hljs-built_in">int</span>((p-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>), p) == p - <span class="hljs-number">1</span>:<br>c = <span class="hljs-built_in">pow</span>(z, q, p)<br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>z += <span class="hljs-number">1</span><br>r = <span class="hljs-built_in">pow</span>(n, <span class="hljs-built_in">int</span>((q+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>), p)<br>t = <span class="hljs-built_in">pow</span>(n, q, p)<br>m = s<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br><span class="hljs-keyword">if</span> t == <span class="hljs-number">1</span>:<br>r1 = r<br>r2 = p - r1<br><span class="hljs-keyword">return</span> r1, r2<br><span class="hljs-keyword">else</span>:<br>i = <span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(t, <span class="hljs-number">2</span>**i, p) == <span class="hljs-number">1</span>:<br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>i += <span class="hljs-number">1</span><br>b = <span class="hljs-built_in">pow</span>(c, <span class="hljs-number">2</span>**(m-i-<span class="hljs-number">1</span>), p)<br>r = r * b % p<br>t = t * b ** <span class="hljs-number">2</span> % p<br>c = b ** <span class="hljs-number">2</span> % p<br>m = i<br><span class="hljs-keyword">else</span>:<br><span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">random_point</span>(<span class="hljs-params">p, a, b</span>):<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>gx = getRandomRange(<span class="hljs-number">1</span>, p-<span class="hljs-number">1</span>)<br>n = (gx**<span class="hljs-number">3</span> + a*gx + b) % p<br>gy = tonelli_shanks(n, p)<br><span class="hljs-keyword">if</span> gy == <span class="hljs-literal">False</span>:<br><span class="hljs-keyword">continue</span><br><span class="hljs-keyword">else</span>:<br><span class="hljs-keyword">return</span> (gx, gy[<span class="hljs-number">0</span>])<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">die</span>(<span class="hljs-params">*args</span>):<br>pr(*args)<br>quit()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>(<span class="hljs-params">*args</span>):<br>s = <span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, args))<br>sys.stdout.write(s + <span class="hljs-string">&quot;\n&quot;</span>)<br>sys.stdout.flush()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sc</span>():<br><span class="hljs-keyword">return</span> sys.stdin.readline().strip()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>border = <span class="hljs-string">&quot;+&quot;</span><br>pr(border*<span class="hljs-number">72</span>)<br>pr(border, <span class="hljs-string">&quot;  Dual ECC means two elliptic curve with same coefficients over the &quot;</span>, border)<br>pr(border, <span class="hljs-string">&quot;  different fields or ring! You should calculate the discrete log   &quot;</span>, border)<br>pr(border, <span class="hljs-string">&quot;  in dual ECCs. So be smart in choosing the first parameters! Enjoy!&quot;</span>, border)<br>pr(border*<span class="hljs-number">72</span>)<br>bool_coef, bool_prime, nbit = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-number">128</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>pr(<span class="hljs-string">f&quot;| Options: \n|\t[C]hoose the <span class="hljs-subst">&#123;nbit&#125;</span>-bit prime p \n|\t[A]ssign the coefficients \n|\t[S]olve DLP \n|\t[Q]uit&quot;</span>)<br>ans = sc().lower()<br><span class="hljs-keyword">if</span> ans == <span class="hljs-string">&#x27;a&#x27;</span>:<br>pr(<span class="hljs-string">&#x27;| send the coefficients a and b separated by comma: &#x27;</span>)<br>COEFS = sc()<br><span class="hljs-keyword">try</span>:<br>a, b = [<span class="hljs-built_in">int</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> COEFS.split(<span class="hljs-string">&#x27;,&#x27;</span>)]<br><span class="hljs-keyword">except</span>:<br>die(<span class="hljs-string">&#x27;| your coefficients are not valid, Bye!!&#x27;</span>)<br><span class="hljs-keyword">if</span> a*b == <span class="hljs-number">0</span>:<br>die(<span class="hljs-string">&#x27;| Kidding me?!! a*b should not be zero!!&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>bool_coef = <span class="hljs-literal">True</span><br><span class="hljs-keyword">elif</span> ans == <span class="hljs-string">&#x27;c&#x27;</span>:<br>pr(<span class="hljs-string">&#x27;| send your prime: &#x27;</span>)<br>p = sc()<br><span class="hljs-keyword">try</span>:<br>p = <span class="hljs-built_in">int</span>(p)<br><span class="hljs-keyword">except</span>:<br>die(<span class="hljs-string">&#x27;| your input is not valid :(&#x27;</span>)<br><span class="hljs-keyword">if</span> isPrime(p) <span class="hljs-keyword">and</span> p.bit_length() == nbit <span class="hljs-keyword">and</span> isPrime(<span class="hljs-number">2</span>*p + <span class="hljs-number">1</span>):<br>q = <span class="hljs-number">2</span>*p + <span class="hljs-number">1</span><br>bool_prime = <span class="hljs-literal">True</span><br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">f&#x27;| your integer p is not <span class="hljs-subst">&#123;nbit&#125;</span>-bit prime or 2p + 1 is not prime, bye!!&#x27;</span>)<br><span class="hljs-keyword">elif</span> ans == <span class="hljs-string">&#x27;s&#x27;</span>:<br><span class="hljs-keyword">if</span> bool_coef == <span class="hljs-literal">False</span>:<br>pr(<span class="hljs-string">&#x27;| please assign the coefficients.&#x27;</span>)<br><span class="hljs-keyword">if</span> bool_prime == <span class="hljs-literal">False</span>:<br>pr(<span class="hljs-string">&#x27;| please choose your prime first.&#x27;</span>)<br><span class="hljs-keyword">if</span> bool_prime <span class="hljs-keyword">and</span> bool_coef:<br>Ep = CurveOverFp(<span class="hljs-number">0</span>, a, b, p)<br>Eq = CurveOverFp(<span class="hljs-number">0</span>, a, b, q)<br>xp, yp = random_point(p, a, b)<br>P = Point(xp, yp)<br>xq, yq = random_point(q, a, b)<br>Q = Point(xq, yq)<br>k = getRandomRange(<span class="hljs-number">1</span>, p &gt;&gt; <span class="hljs-number">1</span>)<br>kP = Ep.mult(P, k)<br>l = getRandomRange(<span class="hljs-number">1</span>, q &gt;&gt; <span class="hljs-number">1</span>)<br>lQ = Eq.mult(Q, l)<br>pr(<span class="hljs-string">&#x27;| We know that: &#x27;</span>)<br>pr(<span class="hljs-string">f&#x27;| P = <span class="hljs-subst">&#123;P&#125;</span>&#x27;</span>)<br>pr(<span class="hljs-string">f&#x27;| k*P = <span class="hljs-subst">&#123;kP&#125;</span>&#x27;</span>)<br>pr(<span class="hljs-string">f&#x27;| Q = <span class="hljs-subst">&#123;Q&#125;</span>&#x27;</span>)<br>pr(<span class="hljs-string">f&#x27;| l*Q = <span class="hljs-subst">&#123;lQ&#125;</span>&#x27;</span>)<br>pr(<span class="hljs-string">&#x27;| send the k and l separated by comma: &#x27;</span>)<br>PRIVS = sc()<br><span class="hljs-keyword">try</span>:<br>priv, qriv = [<span class="hljs-built_in">int</span>(s) <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> PRIVS.split(<span class="hljs-string">&#x27;,&#x27;</span>)]<br><span class="hljs-keyword">except</span>:<br>die(<span class="hljs-string">&#x27;| your input is not valid, Bye!!&#x27;</span>)<br><span class="hljs-keyword">if</span> priv == k <span class="hljs-keyword">and</span> qriv == l:<br>die(<span class="hljs-string">f&#x27;| Congrats, you got the flag: <span class="hljs-subst">&#123;flag&#125;</span>&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">&#x27;| sorry, your keys are not correct! Bye!!!&#x27;</span>)<br><span class="hljs-keyword">elif</span> ans == <span class="hljs-string">&#x27;q&#x27;</span>:<br>die(<span class="hljs-string">&quot;Quitting ...&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">&quot;Bye ...&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>main()<br></code></pre></td></tr></table></figure><p>åˆæ˜¯ä¸€ä¸ªäº¤äº’é¢˜ï¼Œé¢˜ç›®æ˜¯å‘é€ä¸€ä¸ªç´ æ•°$p$ï¼Œä¸”$q&#x3D;2p+1$ä¹Ÿæ˜¯ç´ æ•°ï¼Œå¹¶è‡ªå®šæ¤­åœ†æ›²çº¿ç³»æ•°$a,b$ï¼Œæœ€ååœ¨$GF(p),GF(q)$ä¸Šåˆ†åˆ«è§£ä¸€æ¬¡æ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°å³å¯è·å¾—flagã€‚</p><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™è¾¹å°±æ˜¯è¦æ„é€ ä¸€ä¸ªç‰¹æ®Šçš„æ›²çº¿ï¼Œè¿™æ ·æ‰èƒ½å¾ˆå®¹æ˜“åœ°è§£å‡ºECDLPã€‚å¾ˆæ˜¾ç„¶ï¼Œæœ€ç®€å•çš„æ¤­åœ†æ›²çº¿å°±æ˜¯$y^2&#x3D;x^3$ï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶$(0,0)$ç‚¹åœ¨æ¤­åœ†æ›²çº¿ä¸Šã€‚</p><p>è¿™é‡Œæˆ‘é€‰æ‹©äº†$p&#x3D;207700000000000000000000000000000000001$ï¼Œ$q&#x3D;2p+1&#x3D;415400000000000000000000000000000000003$ï¼Œç¬¦åˆé¢˜ç›®æ¡ä»¶ã€‚</p><p>ä½†é¢˜ç›®è§„å®šï¼š$a,b$å‡ä¸èƒ½ä¸º$0$ï¼Œä½†æ˜¯é¢˜ç›®åªè¯´äº†$abâ‰ 0$â€”â€”å¾ˆæ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¼æ´ï¼Œå› ä¸ºå®ƒè¿™è¾¹æ²¡æœ‰å–æ¨¡ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦è®¡ç®—$n&#x3D;pq$ï¼Œç„¶åå°†$a,b$çš„å€¼éƒ½å®šä¸º$n$å³å¯ï¼Œæ­¤å¤„æœ‰<br>$$<br>n&#x3D;86278580000000000000000000000000000001038500000000000000000000000000000000003<br>$$<br>ç„¶åæˆ‘ä»¬åˆ©ç”¨æœ‰é™åŸŸä¸Šçš„æå…¶ç‰¹æ®Šçš„æ¤­åœ†æ›²çº¿$y^2&#x3D;x^3$çš„æ±‚è§£dlpçš„å…¬å¼ï¼Œå°±å¯ä»¥æ±‚å‡ºæœ€ç»ˆçš„ç»“æœäº†ã€‚</p><p>è¿™ä¸ªå…¬å¼å¾ˆç®€å•ï¼Œè®¾$P(x,y),Q&#x3D;kP$ï¼Œå®š$f(P)&#x3D;\dfrac x y$ï¼Œé‚£ä¹ˆï¼š<br>$$<br>k&#x3D;\dfrac {f(Q)}{f(P)}<br>$$<br>æ‰€ä»¥æœ€åçš„è§£é¢˜è¿‡ç¨‹å°±å¾ˆç®€å•äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">p,P,kP</span>):<br>    fP = P[<span class="hljs-number">0</span>]*inverse(P[<span class="hljs-number">1</span>],p)%p<br>    fkP = kP[<span class="hljs-number">0</span>]*inverse(kP[<span class="hljs-number">1</span>],p)%p<br>    <span class="hljs-keyword">return</span> fkP*inverse(fP,p)%p<br>p,q=<span class="hljs-number">207700000000000000000000000000000000001</span>,<span class="hljs-number">415400000000000000000000000000000000003</span><br>n=<span class="hljs-number">86278580000000000000000000000000000001038500000000000000000000000000000000003</span><br><span class="hljs-keyword">assert</span> n==p*q<br>P = (<span class="hljs-number">203229899779000076314358233714424355341</span>,<span class="hljs-number">60440074750241244164201445769817870587</span>)<br>kP = (<span class="hljs-number">52410058339877917624863834128227223795</span>,<span class="hljs-number">49211699144775676781683504862929553688</span>)<br>Q = (<span class="hljs-number">172334393951679208280736138845997145361</span>,<span class="hljs-number">20443831011651348736860400696145266671</span>)<br>lQ = (<span class="hljs-number">145705507629923190180573378828332340194</span>,<span class="hljs-number">79769406366840777802969722053757749656</span>)<br><span class="hljs-built_in">print</span>(solve(p,P,kP),solve(q,Q,lQ))<br><span class="hljs-comment">#27870828690899416876383090452513900161 495768251079805627828936776109738300</span><br></code></pre></td></tr></table></figure><p> æœ€ç»ˆè§£é¢˜ç»“æœï¼š</p><p><img src="/2021/08/07/CryptoCTFWriteUp2/2.jpg" alt="2"></p><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6.æ€»ç»“"></a>6.æ€»ç»“</h2><p>è¿™5é“é¢˜çš„æ€ç»´é‡æ˜æ˜¾è¦æ¯”å‰5é¢˜çš„æ€ç»´é‡éš¾åº¦å¤§çš„ï¼Œå°¤å…¶æ˜¯ç¬¬4é¢˜å’Œç¬¬5é¢˜ï¼Œæ˜¯ä¸€ç§å…¨æ–°çš„é¢˜å‹ï¼Œç›´æ¥å°±æ˜¯è®©ä½ æ„é€ ç‰¹æ®Šçš„ç´ æ•°å’Œç‰¹æ®Šçš„æ›²çº¿ï¼Œå¹¶åœ¨ç‰¹æ®Šçš„æ¡ä»¶ä¸‹æ±‚è§£ä¸€äº›éš¾é¢˜â€”â€”è¿™ç§å‡ºé¢˜æ€ç»´è¿˜æ˜¯å¾ˆä¸å¹³å¸¸çš„ï¼Œé•¿è§è¯†äº†ã€‚è€Œç¬¬1ï¼Œ2é¢˜å¯¹æ•°æ„Ÿçš„è¦æ±‚è¦éå¸¸çš„å¥½ï¼Œæ¯”å¦‚è¿‘ä¼¼æ•°ï¼Œè¿˜æœ‰é‚£ä¸ªåˆ†è§£å› å¼<del>ï¼ˆè‡ªå·±çš„çŸ­æ¿ï¼Œè§£äºŒæ¬¡é¡¹ä¸ä¸º1çš„æ–¹ç¨‹ç›´æ¥ä¸Šå…¬å¼äº†ï¼‰</del></p><p>å“¦å¯¹ï¼Œé¡ºä¾¿æä¸€ä¸‹æˆ‘åœ¨4ï¼Œ5ä¸¤é¢˜é‡Œé¢æ„é€ çš„è¿™ç§ç‰¹æ®Šç´ æ•°ï¼šå‰é¢$4$ä½æ˜¯éšæœºçš„ï¼Œä¸­é—´ä¸€å †$0$ï¼Œæœ€åä¸€ä¸ª$1$ï¼Œè¿™ç§ç´ æ•°è¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯$p-1$æåº¦å…‰æ»‘â€”â€”å› ä¸ºä½ é™¤æ‰æ‰€æœ‰çš„$10$å› æ•°å°±è¿˜å‰©å‡ åƒäº†ï¼Œè¯´ä¸å®šä»¥åä¼šåœ¨ä»€ä¹ˆé¢˜é‡Œé‡åˆ°ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CryptoCTF Wp 1</title>
    <link href="/2021/08/03/CryptoCTFWriteUp1/"/>
    <url>/2021/08/03/CryptoCTFWriteUp1/</url>
    
    <content type="html"><![CDATA[<h1 id="CryptoCTF-WriteUp-1-By-huangx607087"><a href="#CryptoCTF-WriteUp-1-By-huangx607087" class="headerlink" title="CryptoCTF WriteUp 1 By huangx607087"></a>CryptoCTF WriteUp 1 By huangx607087</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>8æœˆçš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä¹‹å‰ç„äº†ä¸€çœ¼ï¼Œå‘ç°7æœˆå¹¶æ²¡æœ‰å½¢æˆä¸€ä¸ªæ›´åšå®¢çš„é«˜å³°æœŸâ€”â€” å› ä¸ºè‡ªå·±æ‘¸é±¼å¤ªå¤šäº†<del>å®é™…ä¸Šæ˜¯å› ä¸ºè‡ªå·±å¤ªåºŸäº†</del>ï¼Œè¿™å‡ å¤©æœ‰ä¸ªCryptoCTFï¼Œåšäº†å‡ é¢˜ï¼Œå‰©ä¸‹çš„å†…å®¹è¿˜åœ¨ç ”ç©¶ä¸­ï¼Œå‡†å¤‡å†å†™ä¸€ç¯‡Wpï¼Œä¹Ÿæ˜¯5é“é¢˜ã€‚</p><p>è¿›å…¥å…«æœˆäº‹æƒ…è«åå…¶å¦™åœ°å¼€å§‹å¤šäº†èµ·æ¥ï¼Œä¸€æ˜¯å…«æœˆä»½è¿˜æœ‰å¾ˆå¤šCTFè¦æ‰“ï¼ŒäºŒæ˜¯æˆ‘è¿˜è¦å‡†å¤‡ä¸€ç¯‡2000å­—å®ä¹ æŠ¥å‘Šï¼Œä¸‰æ˜¯ä¹‹å‰åœ¨é™¢ç§‘åæäº†ä¸ªä»€ä¹ˆé¡¹ç›®ï¼Œåˆ°æ—¶å€™è¦å¯åŠ¨é›†ç¾¤åšé¡¹ç›®</p><p> ä¸€å¼€å§‹æ„Ÿè§‰æœ‰äº›é¢˜ç›®ä¼¼ä¹ç¡®å®è¿˜æ˜¯æ¯”è¾ƒéš¾çš„ï¼Œä¸è¿‡æœ€ç»ˆæ„Ÿè§‰å¯èƒ½è¿˜æ˜¯å› ä¸ºè‡ªå·±å¤ªèœäº†æ‰€ä»¥å¯¼è‡´æ²¡åšå‡ºæ¥ã€‚</p><p>å“¦å¯¹è¿˜æœ‰ä¸€ä¸ªAESæ²¡å­¦ï¼Œè¿™ç©æ„æœ€è¿‘ä¼¼ä¹å‡ºç°é¢‘ç‡è¶Šæ¥è¶Šé«˜ã€‚ã€‚ã€‚</p><h2 id="1-Farm"><a href="#1-Farm" class="headerlink" title="1.  Farm"></a>1.  Farm</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env sage </span><br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> string, base64, math<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br>ALPHABET = string.printable[:<span class="hljs-number">62</span>] + <span class="hljs-string">&#x27;\\=&#x27;</span><br>F = <span class="hljs-built_in">list</span>(GF(<span class="hljs-number">64</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>(<span class="hljs-params">l</span>):<br>key = [F[randint(<span class="hljs-number">1</span>, <span class="hljs-number">63</span>)] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l)] <br>key = math.prod(key) <span class="hljs-comment"># Optimization the key length :D</span><br><span class="hljs-keyword">return</span> key<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">maptofarm</span>(<span class="hljs-params">c</span>):<br><span class="hljs-keyword">assert</span> c <span class="hljs-keyword">in</span> ALPHABET<br><span class="hljs-keyword">return</span> F[ALPHABET.index(c)]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg, key</span>):<br>m64 = base64.b64encode(msg)<br>enc, pkey = <span class="hljs-string">&#x27;&#x27;</span>, key**<span class="hljs-number">5</span> + key**<span class="hljs-number">3</span> + key**<span class="hljs-number">2</span> + <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> m64:<br>enc += ALPHABET[F.index(pkey * maptofarm(<span class="hljs-built_in">chr</span>(m)))]<br><span class="hljs-keyword">return</span> enc<br><span class="hljs-comment"># KEEP IT SECRET </span><br>key = keygen(<span class="hljs-number">14</span>) <span class="hljs-comment"># I think 64**14 &gt; 2**64 is not brute-forcible :P</span><br>enc = encrypt(flag, key)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;enc = <span class="hljs-subst">&#123;enc&#125;</span>&#x27;</span>)<br><span class="hljs-comment">#805c9GMYuD5RefTmabUNfS9N9YrkwbAbdZE0df91uCEytcoy9FDSbZ8Ay8jj</span><br></code></pre></td></tr></table></figure><p>ä¸€å¼€å§‹æ‹¿åˆ°è¿™ä¸ªé¢˜ç›®ï¼Œä¼¼ä¹æ²¡ä»€ä¹ˆå¤´ç»ªâ€”â€”æ„Ÿè§‰å¥½åƒæ˜¯ä¸€ä¸ªæœ‰é™åŸŸå¤šé¡¹å¼çš„ç©æ„ï¼Œä¸è¿‡ç»†ä¸€çœ‹â€”â€”åŸæ¥æ˜¯å…ˆå¯¹æ˜æ–‡$m$è¿›è¡Œäº†base64æ“ä½œï¼Œç„¶åå¯¹base64åçš„å†…å®¹è¿›è¡Œäº†ä¸€ä¸ªç›¸å½“äºå¤šé¡¹å¼çš„ä½ç§»â€”â€”å¹¶ä¸”è¿™ä¸ªä½ç§»æ˜¯ä¸€å®šçš„ã€‚å†åŠ ä¸Šæˆ‘ä»¬çŸ¥é“äº†å·²çŸ¥æ˜æ–‡çš„å¼€å¤´å¼<code>CCTF</code>ï¼Œå› æ­¤å°±å¯ä»¥æ ¹æ®æœ€å‰é¢å‡ ä½çš„å†…å®¹åˆ¤æ–­ä¸€ä¸‹ä½ç§»é‡å³å¯â€”â€”è¿™é‡Œçš„ä½ç§»é‡æ˜¯$44$ã€‚</p><p>ä¸è¿‡è¿™è¾¹è¿˜æœ‰ä¸€äº›ç»†èŠ‚éœ€è¦æ³¨æ„ï¼šä¸Šé¢ä»£ç ä¸­ï¼š<code>F=list(GF(64))</code>æ˜¯$GF_{64}$ä¸Šçš„ä¸€ä¸ªå¤šé¡¹å¼ç¯ï¼Œé‡Œé¢è®°å½•äº†$x$çš„å¤šå°‘æ¬¡æ–¹çš„å†…å®¹ï¼Œsagemathä¸­è²Œä¼¼ç”¨çš„æ˜¯ä¸å¯çº¦å¤šé¡¹å¼$x^{6}+x^4+x^3+x+1$ã€‚<strong>ï¼ˆæ³¨ï¼šè¿™å®é™…ä¸Šæ˜¯æœ¬æºå¤šé¡¹å¼ï¼‰</strong>ï¼Œå› ä¸ºæµ‹è¯•ä¸­å‘ç°$x^5Â·x&#x3D;x^4+x^3+x+1$ã€‚è€Œæ›´å¥½ç©çš„æ˜¯ï¼šé¢˜ç›®ä¸­å‡ºç°çš„å¤šé¡¹å¼$x^5+x^3+x^2+1$æ°å¥½æ˜¯$x^{62}$çš„å€¼â€”â€”ä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯$x^{-1}$çš„å€¼ã€‚ä½†è¿™é‡Œæœ‰ä¸ªé—®é¢˜å°±æ˜¯<code>F[0]=0,F[63]=1</code>ã€‚æ‰€ä»¥æœ‰äº›åœ°æ–¹éœ€è¦ç®€å•æ“ä½œä¸€ä¸‹ï¼šä¸€æ˜¯ç”±äºå­—ç¬¦<code>0</code>åœ¨é¢˜ç›®ç»™å‡ºçš„å­—å…¸ä¸­ä¸‹æ ‡æ˜¯$0$ï¼Œå› æ­¤é‡åˆ°<code>0</code>è¦ä¿æŒä¸å˜ã€‚äºŒæ˜¯å½“ä¸‹æ ‡è¶…è¿‡$64$ï¼Œå¯¹$64$è¿›è¡Œå–æ¨¡åï¼Œä¸‹æ ‡å€¼è¦ç»§ç»­åŠ ä¸Š$1$ï¼Œè¿™æ ·æ˜¯ä¸ºäº†è·³è¿‡<code>ALPHABET[0]</code>ä¸­çš„é‚£ä¸ª<code>&#39;0&#39;</code></p><p>è§£é¢˜ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br>cipher=<span class="hljs-string">&#x27;805c9GMYuD5RefTmabUNfS9N9YrkwbAbdZE0df91uCEytcoy9FDSbZ8Ay8jj&#x27;</span><br>alphabet=<span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\=&#x27;</span><br>message=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cipher:<br>    C=alphabet.index(i)<br>    <span class="hljs-keyword">if</span>(C==<span class="hljs-number">0</span>):<br>        message+=<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">elif</span>(C+<span class="hljs-number">44</span>&gt;=<span class="hljs-number">64</span>):<br>        message+=alphabet[(C+<span class="hljs-number">44</span>)%<span class="hljs-number">64</span>+<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">else</span>:<br>        message+=alphabet[C+<span class="hljs-number">44</span>]<br><span class="hljs-built_in">print</span>(b64decode(message))<br><span class="hljs-comment">#CCTF&#123;EnCrYp7I0n_4nD_5u8STitUtIn9_iN_Fi3Ld!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="2-hyper-normal"><a href="#2-hyper-normal" class="headerlink" title="2.hyper_normal"></a>2.hyper_normal</h2><p>å†™åœ¨å‰é¢çš„å†…å®¹ï¼šä½œä¸ºä¸€ä¸ªCryptoæ‰“äº†å¿«ä¸€å¹´çš„äººåº”è¯¥æœ‰åŸºæœ¬çš„æ•°å­¦ç´ å…»â€”â€”æ¯”å¦‚åœ¨è§£é¢˜è¿‡ç¨‹ä¸­çœ‹åˆ°å¤šé‡æ•°ç»„å°±è¦æƒ³åˆ°çŸ©é˜µï¼Œçœ‹åˆ°äºŒå…ƒç»„ä¹‹é—´çš„è¿ç®—å°±è¦æƒ³åˆ°æ¤­åœ†æ›²çº¿ï¼Œè€Œä¸æ˜¯<del>åƒhuangx607087ä¸€æ ·ä»€ä¹ˆä¹Ÿä¸æ‡‚</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> FLAG<br>p = <span class="hljs-number">8443</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">transpose</span>(<span class="hljs-params">x</span>):<br>result = [[x[j][i] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(x))] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(x[<span class="hljs-number">0</span>]))]<br><span class="hljs-keyword">return</span> result<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">vsum</span>(<span class="hljs-params">u, v</span>):<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(u) == <span class="hljs-built_in">len</span>(v)<br>l, w = <span class="hljs-built_in">len</span>(u), []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l):<br>w += [(u[i] + v[i]) % p]<br><span class="hljs-keyword">return</span> w<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sprod</span>(<span class="hljs-params">a, u</span>):<br>w = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(u)):<br>w += [a*u[i] % p]<br><span class="hljs-keyword">return</span> w<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg</span>):<br>l = <span class="hljs-built_in">len</span>(msg)<br>hyper = [<span class="hljs-built_in">ord</span>(m)*(i+<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> (m, i) <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(<span class="hljs-built_in">list</span>(msg), <span class="hljs-built_in">range</span>(l))]<br>V, W = [], []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l):<br>v = [<span class="hljs-number">0</span>]*i + [hyper[i]] + [<span class="hljs-number">0</span>]*(l - i - <span class="hljs-number">1</span>)<br>V.append(v)<br>random.shuffle(V)<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l):<br>R, v = [random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">126</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l)], [<span class="hljs-number">0</span>]*l<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l):<br>v = vsum(v, sprod(R[j], V[j]))<br>W.append(v)<br>random.shuffle(transpose(W))<br><span class="hljs-keyword">return</span> W<br>enc = encrypt(FLAG)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;W=&#x27;</span>,enc)<br><span class="hljs-comment">#è¾“å‡ºæ–‡ä»¶ä¿å­˜åœ¨given.pyå†…</span><br></code></pre></td></tr></table></figure><p>æ‰“å¼€<code>given.py</code>çœ‹äº†ä¸€ä¸‹ï¼Œ<code>W</code>æ˜¯ä¸€ä¸ª$55Ã—55$çš„çŸ©é˜µâ€”â€”åˆæ­¥è¯»å®Œä»£ç åï¼Œå¯ä»¥åˆ¤æ–­flagæœ‰$55$ä½ã€‚æœ¬åœ°æµ‹è¯•äº†ä¸€ä¸‹<code>transpose,vsum,sprod</code>ä¸‰ä¸ªå‡½æ•°ï¼šå…¶ä¸­<code>transpose</code>å‡½æ•°æ˜¯å°†ä¸€ä¸ªçŸ©é˜µè½¬ç½®ï¼Œ<code>vsum</code>æ˜¯ä¸¤ä¸ªè¡Œå‘é‡ç›¸åŠ ï¼Œ<code>sprod</code>æ˜¯å¯¹ä¸€ä¸ªè¡Œå‘é‡è¿›è¡Œæ•°ä¹˜æ“ä½œã€‚å½“ç„¶è¿™ä¸€åˆ‡éƒ½æ˜¯åœ¨$GF(8443)$ä¸Šè¿›è¡Œçš„ã€‚</p><p>ç»§ç»­é˜…è¯»ä»£ç ï¼Œå¯ä»¥å‘ç°$V$å®é™…ä¸Šå¯ä»¥è®¤ä¸ºæ˜¯çŸ©é˜µ$\mathrm{diag}(m_1,m_2,â€¦,m_{55})$ä¸çŸ©é˜µ$\mathrm{diag}(1,2,â€¦,55)$çš„ä¹˜ç§¯ï¼Œå…¶ä¸­$m_i$è¡¨ç¤ºflagç¬¬$i$ä½çš„ASCIIç å€¼ã€‚è®¡ç®—è¿‡åï¼Œå°†$V$æ¯ä¸€è¡Œéƒ½æ‰“ä¹±äº†ã€‚è€Œå…³äºåŠ å¯†ä¸­å‡ºç°çš„$R$ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸º$R$æ˜¯ä¸€ä¸ªéšæœºçŸ©é˜µï¼Œæœ€åçš„åŠ å¯†ç»“æœ$W$ä¸º$RV$çš„å€¼ã€‚</p><p>è¿™é“é¢˜çš„ä¸€ä¸ªçªç ´å£å°±æ˜¯$R$æ˜¯ä¸€ä¸ªéšæœºçŸ©é˜µï¼Œæ ¹æ®ä»¥å‰çš„åšé¢˜ç»éªŒâ€”â€”é‡åˆ°äº†éšæœºæ•°ï¼Œå°±è¦æƒ³åŠæ³•æ¶ˆé™¤éšæœºæ•°å¸¦æ¥çš„å½±å“ã€‚ç”±äºé‚£å¤©ä¸‹åˆåˆšå¥½ä¸ºäº†æ˜Ÿç›Ÿæ™šä¸Šçš„åˆ†äº«ï¼Œå¯¹æ¤­åœ†æ›²çº¿ä¸Šçš„å‡ ç§æœ€ç®€å•çš„åŠ å¯†ç®—æ³•è¿›è¡Œäº†ç ”ç©¶ï¼Œæäº†ä¸€ä¸‹æ¤­åœ†æ›²çº¿ä¸Šçš„å¤šé¡¹å¼ï¼Œæ³¨æ„åˆ°äº†æœ‰é™åŸŸå†…ä¸¤ä¸ªé«˜æ¬¡å¤šé¡¹å¼æ˜¯å¯ä»¥é€šè¿‡æ¬§å‡ é‡Œå¾—è¾—è½¬ç›¸é™¤æ³•ï¼Œå°†å…¶åŒ–ç®€æˆä¸€ä¸ªä¸€æ¬¡å¤šé¡¹å¼çš„ã€‚â€”â€”ç„¶åå°±æ„Ÿè§‰è¿™ä¼šä¸ä¼šä¹Ÿæ˜¯æœ‰é™åŸŸå†…æ±‚æ‰€è°“çš„â€å…¬çº¦å¼â€ã€‚</p><p>ç„¶åå‘ç°è¿™ä¸ªæ–¹æ³•ä¼¼ä¹å¹¶ä¸é‚£ä¹ˆå¯è¡Œâ€”â€”å› ä¸ºç»è¿‡å¾ˆç®€å•çš„åˆ†æå°±çŸ¥é“è¿™ä¸ªæ–¹æ³•ä¸€å®šæ˜¯æ— æ³•æˆåŠŸçš„ï¼ˆã€‚ç„¶åæˆ‘æ³¨æ„åˆ°è¿™ä¸ªæ•°æ®è§„æ¨¡ä¼¼ä¹å¹¶ä¸å¤§â€”â€”ä¹Ÿå°±æ˜¯å¯ä»¥ä¸€ä½ä¸€ä½çš„çˆ†ç ´ã€‚</p><p>è¯•çˆ†äº†ä¸‰ä¸ªï¼š<code>CCT</code>ï¼Œä½†è¯•çˆ†ç¬¬$4$ä¸ªçš„æ—¶å€™ï¼Œå‘ç”Ÿäº†å¤šè§£çš„æƒ…å†µâ€”â€”ä½†å†…éƒ¨ç«Ÿç„¶å­˜åœ¨<code>F</code>ï¼Œå¹¶ä¸”<code>F</code>å¯¹åº”çš„ä¹˜æ•°æ°å¥½æ˜¯$4$ã€‚æˆ‘åˆè¯•çˆ†äº†å‡ ä¸ªï¼Œç¡®å®ï¼Œè¿™ä¸ªè²Œä¼¼éƒ½æ˜¯æŒ‰é¡ºåºæ¥çš„ã€‚ç„¶åå°±å¯ä»¥å†™å‡ºä¸‹é¢çš„è§£é¢˜ä»£ç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> W<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br>p=<span class="hljs-number">8443</span><br>arr=[]<br>S=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> _t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">55</span>):<br>    <span class="hljs-built_in">print</span>(_t)<br>    <span class="hljs-built_in">print</span>(S)<br>    arr=[]<br>    <span class="hljs-keyword">for</span> __r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">55</span>):<br>        arr.append(W[__r][_t])<br>    <span class="hljs-comment">#print(arr)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> printable:<br>        <span class="hljs-comment">#for j in range(1,56):</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> [_t+<span class="hljs-number">1</span>]<br>            T,fail=[],<span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">127</span>):<br>                checker=(<span class="hljs-built_in">ord</span>(i)*j*k)%<span class="hljs-number">8443</span><br>                T.append(checker)<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> arr:<br>                <span class="hljs-keyword">if</span> k <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> T:<br>                    fail=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span>(fail==<span class="hljs-number">0</span>):<br>                S+=i     <br><span class="hljs-built_in">print</span>(S)<br><span class="hljs-comment">#CCTF&#123;H0w_f1Nd_th3_4lL_3I9EnV4Lu35_iN_FiN173_Fi3lD5!???&#125;</span><br></code></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆä»–æœ€åè¿˜æ˜¯å¯ä»¥è§£å‡ºæ¥æ­£ç¡®çš„é¡ºåºå‘¢â€”â€”é€šè¿‡ç®€å•çš„ç†è®ºåˆ†æä¸€ä¸‹å°±çŸ¥é“ï¼šç”±äº$R$æ˜¯éšæœºæ•°ç»„ï¼Œè€Œä¸ºäº†ä¿è¯ä¸$R$æ— å…³ï¼Œæˆ‘ä»¬å°±å¯ä»¥éšæ„å˜æ¢$R$ã€‚è€Œå¯¹äº$n$é˜¶çš„ä¸€ä¸ªçŸ©é˜µ$E&#x3D;\mathrm {diag}(1,1,1,â€¦,1,1)$ï¼Œå°†$E$è¡Œæ‰“ä¹±ï¼Œå¾—åˆ°çŸ©é˜µ$M$ï¼Œé‚£ä¹ˆ$M^{-1}$ä¸€å®šæ˜¯$E$çš„å¦ä¸€ç§è¡Œæ‰“ä¹±æ–¹æ³•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç†è®ºä¸Šæ¨å‡ºï¼š$RV&#x3D;RVâ€™M$ï¼Œå…¶ä¸­$Vâ€™$æ˜¯æ‰“ä¹±ä¹‹å‰çš„çŸ©é˜µã€‚ä½†ç”±äº$R$æ˜¯éšæœºçŸ©é˜µï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠ$R$è§†ä¸º$M^{-1}Râ€™$ã€‚ç”±äº$MNM^{-1}$æ˜¯ä¸€å®šå¯ä»¥äº¤æ¢çš„ï¼Œå› æ­¤æˆ‘ä»¬å°±æŠŠæ— åºçš„çŸ©é˜µ$RV$åŒ–æˆæœ‰åºçš„çŸ©é˜µ$Râ€™Vâ€™$ï¼Œè¿™æ ·ä»ç„¶å¯ä»¥å¾—åˆ°åŸæ¥çš„ç»“æœäº†ã€‚</p><p>å½“ç„¶æ®è¯´å¯ä»¥ä¸è¿›è¡Œå¯¹å­—ç¬¦çš„çˆ†ç ´ï¼Œ13è¡Œä»£ç å°±èƒ½è§£å†³é—®é¢˜â€”â€”è¿™ä¸ªè¿˜æœ‰å¾…è€ƒè¯ã€‚ä½†åˆšæ‰çš„ç†è®ºåˆ†æç¡®å®æŠŠ<code>for j in range(1,56):</code>çš„ä¸€é‡å¾ªç¯å»æ‰äº†ã€‚è‡³äºå†å»ä¸€é‡å¾ªç¯ï¼Œå¯èƒ½çœŸçš„ä¸æ˜¯ç‰¹åˆ«å¥½æƒ³åˆ°ã€‚</p><h2 id="3-Rima"><a href="#3-Rima" class="headerlink" title="3.Rima"></a>3.Rima</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> FLAG<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">nextPrime</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        n += (n % <span class="hljs-number">2</span>) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> isPrime(n):<br>            <span class="hljs-keyword">return</span> n<br>f = [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(FLAG.<span class="hljs-built_in">hex</span>(), <span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:]]<br>f.insert(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(f)-<span class="hljs-number">1</span>): f[i] += f[i+<span class="hljs-number">1</span>]<br>a = nextPrime(<span class="hljs-built_in">len</span>(f))<br>b = nextPrime(a)<br>g, h = [[_ <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(x) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> f] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> [a, b]]<br>c = nextPrime(<span class="hljs-built_in">len</span>(f) &gt;&gt; <span class="hljs-number">2</span>)<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> [g, h]:<br>    <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c): _.insert(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(_) -  c): _[i] += _[i+c]<br>g, h = [<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">str</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> __]), <span class="hljs-number">5</span>) <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> [g, h]]<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> [g, h]:<br>    <span class="hljs-keyword">if</span> _ == g:<br>        fname = <span class="hljs-string">&#x27;g&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        fname = <span class="hljs-string">&#x27;h&#x27;</span><br>    of = <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;fname&#125;</span>.enc&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>)<br>    of.write(long_to_bytes(_))<br>    of.close()<br><span class="hljs-comment">#è¾“å‡ºæ–‡ä»¶g.enc 19115å­—èŠ‚</span><br><span class="hljs-comment">#è¾“å‡ºæ–‡ä»¶f.enc 19561å­—èŠ‚</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°é¢˜ç›®çš„ç¬¬ä¸€æ„Ÿè§‰å°±æ˜¯è¦æŠŠé‡Œé¢çš„å‚æ•°$a,b,c$å…¨ç»™æ±‚å‡ºæ¥â€”â€”è™½ç„¶ä¸€å¼€å§‹å¹¶æ²¡æœ‰çœ‹æ‡‚ä»£ç ï¼Œä½†æœ‰ä¸¤ä¸ªåŸºæœ¬äº‹å®æ˜¯å¯ä»¥ç¡®å®šçš„ï¼šä¸€æ˜¯flagä¸€å®šæ˜¯<code>CCTF&#123;xxxxxxxx&#125;</code>çš„æ ¼å¼ï¼ŒäºŒæ˜¯flagè¶Šé•¿ï¼Œé‚£ä¹ˆè¾“å‡ºçš„<code>g.enc</code>å’Œ<code>h.enc</code>æ–‡ä»¶ä¹Ÿè¶Šé•¿ã€‚å› æ­¤è¿™é‡Œæˆ‘ä»¬å¯ä»¥å†å¼€ä¸€ä¸ªç›¸åŒçš„åŠ å¯†è„šæœ¬ï¼Œè®¾flagä¸º<code>CCTF&#123;000...000&#125;</code>ï¼Œé€šè¿‡ä¸æ–­åŠ é•¿é‡Œé¢$0$å­—ç¬¦åŠ å¯†åè¾“å‡ºçš„æ–‡ä»¶é•¿åº¦å¯¹æ¯”ï¼Œæœ€åç¡®å®šflagçš„æ€»é•¿åº¦ä¸º$32$ï¼Œ$(a,b,c)&#x3D;(257,263,67)$ã€‚</p><p>ç¡®å®šäº†é‡Œé¢çš„å†…å®¹ä¹‹åï¼Œè¿™ä¸ªæ—¶å€™å°±ç›´æ¥ä¸€æ­¥ä¸€æ­¥åœ°æ±‚é€†å°±è¡Œäº†ï¼Œå°±æ˜¯ä¸€ä½ä¸€ä½çš„å‡è€Œå·²ï¼Œéš¾åº¦ä¸æ˜¯å¾ˆå¤§ï¼Œå¹¶ä¸”æ•´ä¸ªè¿‡ç¨‹å°±ç”¨äº†<code>g.enc</code>ä¸€ä¸ªæ–‡ä»¶ã€‚</p><p>å½“ç„¶ï¼Œä¸ªäººè®¤ä¸ºé¢˜ç›®ç»™äº†ä½ ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¯èƒ½æ˜¯å­˜åœ¨é€šè¿‡ä¸çˆ†ç ´<code>flag</code>çš„é•¿åº¦ï¼Œè€Œæ˜¯çœŸæ­£é€šè¿‡æ–‡ä»¶<code>g,h</code>æ¥è®¡ç®—flagçš„é•¿åº¦ï¼Œè¿›è€Œè®¡ç®—ç²—è¯ä¸‰ä¸ªå‚æ•°çš„å€¼çš„ã€‚å¾…è€ƒè¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>Cg=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;g.enc&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read()<br>Cg=bytes_to_long(Cg)<br>Garr=[]<br><span class="hljs-keyword">while</span> Cg:<br>    Garr.append(Cg%<span class="hljs-number">5</span>)<br>    Cg//=<span class="hljs-number">5</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">67</span>,<span class="hljs-built_in">len</span>(Garr)):<br>    Garr[i]=Garr[i]-Garr[i-<span class="hljs-number">67</span>]<br>Garr=Garr[::-<span class="hljs-number">1</span>][<span class="hljs-number">67</span>:]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>*<span class="hljs-number">256</span>):<br>    <span class="hljs-keyword">assert</span> Garr[i]==Garr[i+<span class="hljs-number">256</span>]<br>Garr=Garr[:<span class="hljs-number">256</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">254</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    Garr[i]-=Garr[i+<span class="hljs-number">1</span>]    <br><span class="hljs-keyword">assert</span> Garr.count(<span class="hljs-number">2</span>)==<span class="hljs-number">0</span><br>m=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Garr:<br>    m&lt;&lt;=<span class="hljs-number">1</span><br>    m|=i<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#CCTF&#123;_how_finD_7h1s_1z_s3cr3T?!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="4-hamul"><a href="#4-hamul" class="headerlink" title="4.hamul"></a>4.hamul</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br>nbit = <span class="hljs-number">64</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>p, q = getPrime(nbit), getPrime(nbit)<br>P = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(q))<br>Q = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(p))<br>PP = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(P) + <span class="hljs-built_in">str</span>(Q))<br>QQ = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(Q) + <span class="hljs-built_in">str</span>(P))<br><span class="hljs-keyword">if</span> isPrime(PP) <span class="hljs-keyword">and</span> isPrime(QQ):<br><span class="hljs-built_in">print</span>(PP,QQ)<br><span class="hljs-keyword">break</span><br>n = PP * QQ<br>m = bytes_to_long(flag.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><span class="hljs-keyword">if</span> m &lt; n:<br>c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">65537</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n =&#x27;</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c =&#x27;</span>, c)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œåˆæ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„RSAçš„é¢˜ç›®â€”â€”åœ¨ç”Ÿæˆ$p,q$çš„æ—¶å€™ï¼Œå…ˆç”Ÿæˆä¸¤ä¸ª$64$æ¯”ç‰¹çš„è¾ƒå°ç´ æ•°ï¼Œç„¶ååŸºäºè¿™ä¸¤ä¸ªå°ç´ æ•°ç›´æ¥è¿æ¥å¼ç»„åˆï¼Œå¾—åˆ°äº†å¤§ç´ æ•°ï¼Œæœ€åä¹˜èµ·æ¥å¾—åˆ°äº†æœ€åçš„$n$ã€‚</p><p>ç”±äºè¿™ç§ç›´æ¥ç»„åˆä»–æ˜¯å—åˆ°äº†åè¿›åˆ¶ä½æ•°çš„å½±å“çš„ï¼Œä½†$2^{63}&#x3D;9223372036854775808$ï¼Œ$2^{64}&#x3D;18446744073709551616$ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”Ÿæˆçš„ç´ æ•°æœ‰æ˜¯$20$ä½åè¿›åˆ¶æ•°çš„å¯èƒ½ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯$19$ä½åè¿›åˆ¶æ•°çš„å¯èƒ½ã€‚è¿™æ ·æ ¹æ®æ’åˆ—ç»„åˆå°±æœ‰ä¸‰ç§æƒ…å†µï¼šä¸¤ä¸ª$20$ä½åè¿›åˆ¶æ•°çš„ç´ æ•°ã€ä¸€ä¸ª$19$ä½ï¼Œä¸€ä¸ª$20$ä½åè¿›åˆ¶æ•°çš„ç´ æ•°ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸¤ä¸ª$19$ä½åè¿›åˆ¶æ•°çš„ç´ æ•°ã€‚ç”±äºç›´æ¥è¿æ¥ï¼Œå› æ­¤ä¹˜æ•°ä¼šä¸ä¸€æ ·ï¼Œå› æ­¤å¿…é¡»å…ˆå®šæ€§ã€‚</p><p>é¦–å…ˆè®¾$p,q$å‡ä¸º$10^{19}$ï¼Œå‘ç°ç»„åˆåæ•°å€¼æ¯”$n$å¤§ï¼Œç„¶åè®¾$p,q$å‡ä¸º$10^{19}-1$ï¼Œå‘ç°ç»„åˆåæ•°å€¼æ¯”$n$å°äº†ã€‚å› æ­¤æœ€ç»ˆå®šæ€§â€”â€”$p,q$çš„åè¿›åˆ¶ä½æ•°ï¼Œä¸€ä¸ªæ˜¯$20$ï¼Œä¸€ä¸ªæ˜¯$19$ã€‚ä¸å¦¨è®¾$\dfrac{\ln p}{\ln 10}&#x3D;20,\dfrac{\ln q}{\ln 10}&#x3D;19$ã€‚è®°<code>int(str(p)+str(q))</code>ä¸º$[pq]$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹é¢$4$ä¸ªå¼å­ï¼š<br>$$<br>[pq]&#x3D;10^{19}p+q<br>$$</p><p>$$<br>[qp]&#x3D;10^{20}q+p<br>$$</p><p>$$<br>[pqqp]&#x3D;10^{58}p+10^{39}q+10^{20}q+p<br>$$</p><p>$$<br>[qppq]&#x3D;10^{59}q+10^{39}p+10^{19}p+q<br>$$</p><p>ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¾—åˆ°ï¼š$\dfrac{\ln pq}{\ln10}&#x3D;\dfrac{\ln q^2}{\ln10}&#x3D;38$ï¼Œ$\dfrac{\ln p^2}{\ln10}&#x3D;39$ã€‚ä¹Ÿå°±æ˜¯ï¼Œæ‰€æœ‰çš„å·²çŸ¥é‡å¯ä»¥ç›´æ¥ç”¨ä¸‹é¢è¿™ä¸ªå›¾æ¥è¡¨ç¤º</p><p><img src="/2021/08/03/CryptoCTFWriteUp1/1.png" alt="1"></p><p>å› æ­¤ï¼Œ$n&#x3D;[pqqp]Ã—[qppq]&#x3D;((10^{58}+1)p+(10^{39}+10^{20})q)Ã—((10^{39}+10^{19})p+(10^{59}+1)q)$ã€‚</p><p>åŒ–ç®€ä¸€ä¸‹ï¼Œå¯ä»¥å¾—åˆ°ï¼š $p^2$çš„ç³»æ•°æ˜¯$(10^{58}+1)(10^{39}+10^{19})&#x3D;10^{97}+10^{77}+10^{39}+10^{19}$<br>$q^2$çš„ç³»æ•°æ˜¯$(10^{39}+10^{20})(10^{59}+1)&#x3D;10^{98}+10^{79}+10^{39}+10^{20}$<br>$pq$çš„ç³»æ•°æ˜¯$(10^{58}+1)(10^{59}+1)+(10^{39}+10^{20})(10^{39}+10^{19})$ï¼Œè¯¥ç»“æœåŒ–ç®€ä¸º$10^{117}+10^{78}+2Ã—10^{59}+2Ã—10^{58}+10^{39}+1$</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸‹é¢è¿™ä¸ªå›¾äº†</p><p><img src="/2021/08/03/CryptoCTFWriteUp1/2.png" alt="2"></p><p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºåœ¨$10^{137}$å¾€ä¸Šå’Œ$10^{18}$å¾€ä¸‹éƒ½æ˜¯åªæœ‰$pq$çš„é«˜ä½å’Œä½ä½çš„ï¼Œä½†è¿™æ ·ä¸€ç»„åˆåï¼Œ$pq$çš„å€¼çš„ä¸­é—´ä¸€ä½æ˜¯ä¸çŸ¥é“çš„ã€‚å› æ­¤è€ƒè™‘åˆ°$n$çš„$10^{136}$çš„ä¸€ä½å¯èƒ½æœ‰ä¸€ä½è¿›ä½ï¼Œå› æ­¤æˆ‘ä»¬æˆªå–$n-10^{136}$æ•´é™¤$10^{136}$çš„å€¼å’Œ$n \mod 10^{19}$çš„å€¼ï¼Œå°±å¯ä»¥å¾—å‡º$pq$äº†ï¼Œç„¶ååˆ†è§£å³å¯å¾—åˆ°$p,q$ã€‚æœ€åæŒ‰ç…§é¢˜ç›®çš„æ„é€ æ–¹æ³•æ±‚è§£å°±è¡Œäº†ã€‚(ä¹Ÿå¯ä»¥ç›²çŒœ$p^2$çš„æœ€ä½ä½ï¼Œå› ä¸º$p^2$çš„æœ€ä½ä½åªæœ‰å¯èƒ½æ˜¯$1$æˆ–è€…$9$ï¼‰ï¼Œç„¶ååˆ©ç”¨$n$çš„$10^{19}$é‚£ä¸€ä½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br>n=<span class="hljs-number">9802.</span>.<span class="hljs-number">.4043</span><br>n-=<span class="hljs-number">10</span>**<span class="hljs-number">136</span><br>H,L=n//<span class="hljs-number">10</span>**<span class="hljs-number">136</span>,n%<span class="hljs-number">10</span>**<span class="hljs-number">19</span><br>factor(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(H)+<span class="hljs-built_in">str</span>(L)))<br><span class="hljs-comment">#9324884768249686093 * 10512422984265378151</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> n,c<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getpq</span>(<span class="hljs-params">p,q</span>):<br>    P = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(p) + <span class="hljs-built_in">str</span>(q))<br>    Q = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(q) + <span class="hljs-built_in">str</span>(p))<br>    PP = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(P) + <span class="hljs-built_in">str</span>(Q))<br>    QQ = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(Q) + <span class="hljs-built_in">str</span>(P))<br>    <span class="hljs-keyword">return</span> PP,QQ<br>p,q=<span class="hljs-number">9324884768249686093</span> , <span class="hljs-number">10512422984265378151</span><br>p,q=getpq(p,q)<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=inverse(<span class="hljs-number">65537</span>,phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br><span class="hljs-comment">#CCTF&#123;wH3Re_0Ur_Br41N_Iz_5uP3R_4CtIVe_bY_RSA!!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="5-KEYBASE"><a href="#5-KEYBASE" class="headerlink" title="5.KEYBASE"></a>5.KEYBASE</h2><p>ä¸€ä¸ªè¿œç¨‹äº¤äº’é¢˜ï¼Œå…ˆçœ‹çœ‹æ˜¯ä»€ä¹ˆå†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util <span class="hljs-keyword">import</span> number<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os, sys, random<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>():<br>iv, key = [os.urandom(<span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;01&#x27;</span>]<br><span class="hljs-keyword">return</span> iv, key<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg, iv, key</span>):<br>aes = AES.new(key, AES.MODE_CBC, iv)<br><span class="hljs-keyword">return</span> aes.encrypt(msg)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">enc, iv, key</span>):<br>aes = AES.new(key, AES.MODE_CBC, iv)<br><span class="hljs-keyword">return</span> aes.decrypt(enc)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">die</span>(<span class="hljs-params">*args</span>):<br>pr(*args)<br>quit()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>(<span class="hljs-params">*args</span>):<br>s = <span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, args))<br>sys.stdout.write(s + <span class="hljs-string">&quot;\n&quot;</span>)<br>sys.stdout.flush()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sc</span>():<br><span class="hljs-keyword">return</span> sys.stdin.readline().strip()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>border = <span class="hljs-string">&quot;+&quot;</span><br>pr(border*<span class="hljs-number">72</span>)<br>pr(border, <span class="hljs-string">&quot; hi all, welcome to the simple KEYBASE cryptography task, try to    &quot;</span>, border)<br>pr(border, <span class="hljs-string">&quot; decrypt the encrypted message and get the flag as a nice prize!    &quot;</span>, border)<br>pr(border*<span class="hljs-number">72</span>)<br>iv, key = keygen()<br>flag_enc = encrypt(flag, iv, key).<span class="hljs-built_in">hex</span>()<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>pr(<span class="hljs-string">&quot;| Options: \n|\t[G]et the encrypted flag \n|\t[T]est the encryption \n|\t[Q]uit&quot;</span>)<br>ans = sc().lower()<br><span class="hljs-keyword">if</span> ans == <span class="hljs-string">&#x27;g&#x27;</span>:<br>pr(<span class="hljs-string">&quot;| encrypt(flag) =&quot;</span>, flag_enc)<br><span class="hljs-keyword">elif</span> ans == <span class="hljs-string">&#x27;t&#x27;</span>:<br>pr(<span class="hljs-string">&quot;| Please send your 32 bytes message to encrypt: &quot;</span>)<br>msg_inp = sc()<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(msg_inp) == <span class="hljs-number">32</span>:<br>enc = encrypt(msg_inp, iv, key).<span class="hljs-built_in">hex</span>()<br>r = random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>)<br>s = <span class="hljs-number">4</span> - r<br>mask_key = key[:-<span class="hljs-number">2</span>].<span class="hljs-built_in">hex</span>() + <span class="hljs-string">&#x27;*&#x27;</span> * <span class="hljs-number">4</span><br>mask_enc = enc[:r] + <span class="hljs-string">&#x27;*&#x27;</span> * <span class="hljs-number">28</span> + enc[<span class="hljs-number">32</span>-s:]<br>pr(<span class="hljs-string">&quot;| enc =&quot;</span>, mask_enc)<br>pr(<span class="hljs-string">&quot;| key =&quot;</span>, mask_key)<br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">&quot;| SEND 32 BYTES MESSAGE :X&quot;</span>)<br><span class="hljs-keyword">elif</span> ans == <span class="hljs-string">&#x27;q&#x27;</span>:<br>die(<span class="hljs-string">&quot;Quitting ...&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>die(<span class="hljs-string">&quot;Bye ...&quot;</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>main()<br></code></pre></td></tr></table></figure><p>ç®—æ³•å®é™…ä¸Šçœ‹èµ·æ¥è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå°±æ˜¯ä¸€ä¸ªAESCBCçš„ä¸»åŠ¨æ”»å‡»ï¼Œå…ˆè¿ä¸Šå»çœ‹çœ‹ï¼Œä»¥ä¸‹æ˜¯è¿ä¸Šå»åçš„ç»“æœ</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs coq">huangx607087@huangx607087-virtual-machine:~/æ¡Œé¢/CTF/Apr-Jul <span class="hljs-number">21</span>$ python <span class="hljs-number">7.</span>py<br>[+] Opening connection to <span class="hljs-number">01.</span>cr.yp.toc.tf on port <span class="hljs-number">17010</span>: Done<br>[*] Switching to interactive mode<br>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<br>+  hi all, welcome to the <span class="hljs-built_in">simple</span> KEYBASE cryptography task, <span class="hljs-built_in">try</span> to     +<br>+  decrypt the encrypted message and get the flag <span class="hljs-built_in">as</span> a nice prize!     +<br>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<br>| <span class="hljs-type">Options</span>: <br>|    <span class="hljs-type">[G</span>]et the encrypted flag <br>|    <span class="hljs-type">[T</span>]est the encryption <br>|    <span class="hljs-type">[Q</span>]uit<br>$ g<br>| <span class="hljs-type">encrypt</span>(flag) = b27e9095ded98a14bdb678e3a30fbbfc79b9cefc9a71b2c963804ce692e0b61e<br>| <span class="hljs-type">Options</span>: <br>|    <span class="hljs-type">[G</span>]et the encrypted flag <br>|    <span class="hljs-type">[T</span>]est the encryption <br>|    <span class="hljs-type">[Q</span>]uit<br>$ t<br>| <span class="hljs-type">Please</span> send your <span class="hljs-number">32</span> bytes message to encrypt: <br>$ <span class="hljs-number">00000000000000000000000000000000</span><br>| <span class="hljs-type">enc</span> = <span class="hljs-number">9</span>a****************************<span class="hljs-number">3</span>d531aec9dfc944f408d4df08e8f25aeaa<br>| <span class="hljs-type">key</span> = <span class="hljs-number">52</span>ab970fd21f2526aa7421630068****<br>| <span class="hljs-type">Options</span>: <br>|    <span class="hljs-type">[G</span>]et the encrypted flag <br>|    <span class="hljs-type">[T</span>]est the encryption <br>|    <span class="hljs-type">[Q</span>]uit<br>[*] Got EOF while reading <span class="hljs-built_in">in</span> interactive<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¾—åˆ°äº†flagçš„å¯†æ–‡ï¼ŒåŒæ—¶ä¹Ÿå¾—åˆ°äº†è‡ªå·±å‘è¿‡å»çš„ä¸€ç»„æ˜æ–‡çš„åŠ å¯†ç»“æœâ€”â€”ä½†æˆ‘ä»¬å‘ç°åˆ°æœ€åæˆ‘ä»¬åªçŸ¥é“é€‰æ‹©æ˜æ–‡çš„ååŠæ®µçš„åŠ å¯†ç»“æœï¼Œå‰åŠæ®µçš„åŠ å¯†ç»“æœæˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„ã€‚</p><p>å…ˆæ¥çœ‹ä¸€ä¸‹AESCBCçš„åŠ å¯†ç»“æ„ï¼š</p><p><img src="/2021/08/03/CryptoCTFWriteUp1/3.png" alt="3"></p><p>å¾ˆæ˜¾ç„¶ï¼Œç”±äºå¯†é’¥åªè¢«çœç•¥äº†4ä½ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥çˆ†ç ´è¿™ä¸ªå¯†é’¥ï¼Œç„¶åå°†flagå¯†æ–‡çš„å‰åŠæ®µå†…å®¹ä½œä¸ºivï¼ŒååŠæ®µå†…å®¹ä½œä¸ºAESè§£å¯†å¯†æ–‡ï¼Œç„¶åè¿›è¡Œè§£å¯†ï¼Œå¦‚æœå‡ºç°äº†å¯è¯»çš„å†…å®¹ï¼Œé‚£å°±ç®—è§£å¯†æˆåŠŸâ€”â€”å› æ­¤æˆ‘ä»¬å¾ˆå¿«åœ°å¾—åˆ°äº†flagçš„ååŠæ®µï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br>cipher=<span class="hljs-number">0xb27e9095ded98a14bdb678e3a30fbbfc79b9cefc9a71b2c963804ce692e0b61e</span><br>key=<span class="hljs-number">0x52ab970fd21f2526aa74216300680000</span><br>cipher=long_to_bytes(cipher)<br>c1,c2=cipher[:<span class="hljs-number">16</span>],cipher[<span class="hljs-number">16</span>:]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s[:<span class="hljs-number">15</span>]:<br>        <span class="hljs-comment">#print(chr(i))</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> printable:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65536</span>):<br>    K=long_to_bytes(key+i)<br>    aes=AES.new(K, AES.MODE_CBC, c1)<br>    m2=aes.decrypt(c2)<br>    <span class="hljs-keyword">if</span>(check(m2)):<br>        <span class="hljs-built_in">print</span>(m2,K)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">m2=b&#x27;_7He_5eCrET_1V?&#125;&#x27;</span><br><span class="hljs-string">K=b&#x27;R\xab\x97\x0f\xd2\x1f%&amp;\xaat!c\x00h\x86\xeb&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æ±‚flagçš„å‰åŠæ®µï¼Œå°±éœ€è¦ç”¨åˆ°æ±‚ä¸€å¼€å§‹çš„iväº†ã€‚è¿™å°±éœ€è¦ç”¨åˆ°æˆ‘ä»¬å¯¹æœåŠ¡å™¨å‘é€çš„ç»“æœè¿›è¡Œè§£äº†ã€‚</p><p>æ³¨æ„åˆ°ç¬¬äºŒæ®µæ˜æ–‡åœ¨åŠ å¯†å‰ä¸ç¬¬ä¸€æ®µå¯†æ–‡è¿›è¡Œäº†å¼‚æˆ–ï¼Œè€Œæ ¹æ®å¼‚æˆ–çš„æ€§è´¨ï¼Œå¦‚æœæˆ‘ä»¬ivæ˜¯ç¬¬ä¸€æ®µå¯†æ–‡ï¼Œè§£å¯†å‡ºæ¥å°±æ˜¯ç¬¬äºŒæ®µæ˜æ–‡â€”â€”æ‰€ä»¥ivå¦‚æœä½¿ç¬¬äºŒæ®µæ˜æ–‡ï¼Œè§£å¯†å‡ºæ¥å°±æ˜¯ç¬¬ä¸€æ®µå¯†æ–‡ã€‚è€Œæˆ‘ä»¬å‘é€çš„32ä¸ªå­—ç¬¦<code>0</code>æ˜¯å·²çŸ¥çš„å†…å®¹ï¼Œç¬¬äºŒæ®µå¯†æ–‡ä¹Ÿæ˜¯å·²çŸ¥å†…å®¹ã€‚å› æ­¤æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ç¬¬ä¸€æ®µçš„å®Œæ•´å¯†æ–‡ã€‚</p><p>æ ¹æ®å®Œæ•´å¯†æ–‡ã€keyã€å®Œæ•´æ˜æ–‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ±‚å‡ºiväº†ï¼Œè¿™ä¸ªå†…å®¹æˆ‘ä»¬ä¼šåœ¨åé¢ä¸€ç¯‡ä¸“é—¨ç ”ç©¶AESçš„åšå®¢é‡Œè®²è§£ç›¸å…³å†…å®¹ï¼Œè¿™æ¬¡å°±å…ˆä¸Šä¸ªä»£ç ï¼ˆPART 3ï¼‰ï¼Œå¯ä»¥å…ˆè‡ªå·±äº†è§£ä¸€ä¸‹æ˜¯æ€ä¹ˆä¸€å›äº‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br>cipher=<span class="hljs-number">0xb27e9095ded98a14bdb678e3a30fbbfc79b9cefc9a71b2c963804ce692e0b61e</span><br>key=<span class="hljs-number">0x52ab970fd21f2526aa74216300680000</span><br>cipher=long_to_bytes(cipher)<br>c1,c2=cipher[:<span class="hljs-number">16</span>],cipher[<span class="hljs-number">16</span>:]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s[:<span class="hljs-number">15</span>]:<br>        <span class="hljs-comment">#print(chr(i))</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> printable:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65536</span>):<br>    K=long_to_bytes(key+i)<br>    aes=AES.new(K, AES.MODE_CBC, c1)<br>    m2=aes.decrypt(c2)<br>    <span class="hljs-keyword">if</span>(check(m2)):<br>        <span class="hljs-built_in">print</span>(m2,K.<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#------PART 2 BELOW----------#</span><br>m2=<span class="hljs-string">b&#x27;_7He_5eCrET_1V?&#125;&#x27;</span><br>m10,m11=<span class="hljs-string">b&#x27;0&#x27;</span>*<span class="hljs-number">16</span>,<span class="hljs-string">b&#x27;0&#x27;</span>*<span class="hljs-number">16</span><br>c11=long_to_bytes(<span class="hljs-number">0x531aec9dfc944f408d4df08e8f25aeaa</span>)<br>K=<span class="hljs-string">b&#x27;R\xab\x97\x0f\xd2\x1f%&amp;\xaat!c\x00h\x86\xeb&#x27;</span><br>aes=AES.new(K, AES.MODE_CBC,m11)<br>c10=aes.decrypt(c11)<br><span class="hljs-built_in">print</span>(c10.<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#------PART 3 BELOW----------#</span><br>fakeiv=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">16</span><br>fakeivaes=AES.new(K,AES.MODE_CBC,fakeiv)<br>fakem=fakeivaes.decrypt(c10)<br>encmsg=long_to_bytes(bytes_to_long(fakem)^bytes_to_long(fakeiv))<br>iv=long_to_bytes(bytes_to_long(encmsg)^bytes_to_long(m10))<br><span class="hljs-built_in">print</span>(iv.<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#------PART 4 BELOW----------#</span><br>aesfinal=AES.new(K,AES.MODE_CBC,iv)<br>m1=aesfinal.decrypt(c1)<br><span class="hljs-built_in">print</span>(m1+m2)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;_7He_5eCrET_1V?&#125;&#x27; 52ab970fd21f2526aa742163006886eb</span><br><span class="hljs-string">9a941fc86867bc19161554cc6f08a73d</span><br><span class="hljs-string">1c27639adabb0672f976a6d979d0d981</span><br><span class="hljs-string">b&#x27;CCTF&#123;h0W_R3cOVER_7He_5eCrET_1V?&#125;&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6.æ€»ç»“"></a>6.æ€»ç»“</h2><p>è¿™å‡ é“é¢˜è¿˜æ˜¯ç¨å¾®æœ‰ä¸€ç‚¹éš¾åº¦çš„â€”â€”å°¤å…¶æ˜¯ç¬¬4é¢˜å’Œç¬¬5é¢˜ã€‚</p><p>7æœˆæ‘¸äº†å‡ æ¬¡ğŸŸï¼Œå¼€å‘äº†æœºå™¨äººblockbotï¼Œè¿›å…¥8æœˆçªç„¶æ„Ÿè§‰äº‹æƒ…çœŸçš„å¥½å¤šå•Šï¼Œä¸èƒ½å†æ‘¸é±¼äº†ã€‚ã€‚ã€‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Lattice Notes 7</title>
    <link href="/2021/07/25/LatticeNotes7/"/>
    <url>/2021/07/25/LatticeNotes7/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å¯¹æ„é€ æ ¼åŠå¤šé¡¹å¼çš„ç¬”è®°-7"><a href="#huangx607087å¯¹æ„é€ æ ¼åŠå¤šé¡¹å¼çš„ç¬”è®°-7" class="headerlink" title="huangx607087å¯¹æ„é€ æ ¼åŠå¤šé¡¹å¼çš„ç¬”è®° 7"></a>huangx607087å¯¹æ„é€ æ ¼åŠå¤šé¡¹å¼çš„ç¬”è®° 7</h1><h2 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0.ç®€ä»‹"></a>0.ç®€ä»‹</h2><p>ä¹‹å‰é‡åˆ°è¿‡å¾ˆå¤šä»¥åŠè¿‘æœŸé‡åˆ°è¿‡çš„å‡ ä¸ªCTFé¢˜ç›®ä¸­ï¼Œéƒ½å‡ºç°äº†éœ€è¦æ„é€ æ ¼æˆ–è€…å¤šé¡¹å¼æ±‚å°æ ¹çš„é¢˜ç›®ï¼Œåœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹ä»¥å¤‡ç”¨ã€‚</p><p>æ³¨ï¼šç”±äºåšå®¢æŠ€æœ¯é™åˆ¶ï¼Œä¸€äº›å¤æ‚æŒ‡æ•°çš„è¡¨è¾¾å¼å‘ˆç°å®¹æ˜“å‡ºç°é”™è¯¯ã€‚æ•…æœ¬åšå®¢ä¸­éƒ¨åˆ†æŒ‡æ•°è¡¨ç¤ºæ–¹æ³•æ”¹ç”¨å¯¹æ•°$\ln$è¡¨ç¤ºã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœé¢˜ç›®ä¸­ç»™å‡ºäº†æœªçŸ¥é‡ç»„$x_s$ä¸å·²çŸ¥é‡$a_t$çš„å…³ç³»ï¼Œä»¥åŠæ€»æ¨¡æ•°ä¸º$n$ã€‚å¦‚æœå‡ºç°å¤§çº¦$4\ln x&lt;\ln n$ï¼Œä¸”å¯ä»¥æ„é€ å‡ºçŸ©é˜µ$A$å’Œè¡Œå‘é‡$\vec X$ã€‚å…¶ä¸­$A$ä¸­åªå«æœ‰å·²çŸ¥æ•°ï¼Œ$\vec X$ä¸­åŒ…å«äº†æ‰€æœ‰çš„æœªçŸ¥æ•°ï¼Œä¸”å¯ä»¥ç¡®å®šæ—¢å®šçš„å…³ç³»$\vec XA&#x3D;\vec Y$ï¼Œé‚£ä¹ˆè¿™é“é¢˜å°±å¯ä»¥è€ƒè™‘æ„é€ æ ¼æ¥è§£å†³ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯é¢˜ç›®ä¸­å‡ºç°äº†éå¸¸å°æœªçŸ¥æ•°ä¸éå¸¸å¤§</p><p>è€Œå°†é—®é¢˜é€€åŒ–ä¸€ä¸ªå±‚æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Coppersmithå®šç†æ¥è·å–æœ‰é™åŸŸå†…å¤šé¡¹å¼çš„å°æ ¹ã€‚</p><p>Coppersmithå®šç†ï¼šåœ¨å®šä¹‰åŸŸä¸º$Z_n$çš„$e$é˜¶å¤šé¡¹å¼$f(x)$ä¸­ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ ¹$x$æ»¡è¶³$e\ln x&lt;\ln n$ ï¼Œå°±å¯ä»¥è¿ç”¨ä¸€ä¸ª$O(\ln n)$çš„ç®—æ³•æ±‚å‡ºè¿™äº›æ ¹ã€‚</p><p><strong>Update 2021.8.2 å¢åŠ äº†ä¸€äº›å…³äºECCçš„è§£é¢˜æ–¹æ³•</strong></p><h2 id="1-å‡ ç§ç®€å•çš„æ„é€ å¤šé¡¹å¼çš„æƒ…å†µ"><a href="#1-å‡ ç§ç®€å•çš„æ„é€ å¤šé¡¹å¼çš„æƒ…å†µ" class="headerlink" title="1.å‡ ç§ç®€å•çš„æ„é€ å¤šé¡¹å¼çš„æƒ…å†µ"></a>1.å‡ ç§ç®€å•çš„æ„é€ å¤šé¡¹å¼çš„æƒ…å†µ</h2><h3 id="1o01-å·²çŸ¥æ˜æ–‡é«˜ä½"><a href="#1o01-å·²çŸ¥æ˜æ–‡é«˜ä½" class="headerlink" title="1o01 å·²çŸ¥æ˜æ–‡é«˜ä½"></a>1o01 å·²çŸ¥æ˜æ–‡é«˜ä½</h3><p>å‡è®¾åœ¨RSAä¼ æ’­è¿‡ç¨‹ä¸­é€ æˆ$m$çš„é«˜ä½æ³„éœ²ï¼Œå¦‚æœ$e$æ˜¯$3$ï¼Œå‡è®¾å·²çŸ¥éƒ¨åˆ†æ˜¯$m_0$ï¼ŒæœªçŸ¥éƒ¨åˆ†æ˜¯$x$ï¼Œæ»¡è¶³$m&#x3D;m_0+x$ä¸”$3\ln x &lt; \ln n$ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨Coppersmithè¿›è¡Œæ”»å‡»ï¼Œæ­¤æ—¶æˆ‘ä»¬åªéœ€è¦æ„é€ å¤šé¡¹å¼<br>$$<br>f(x)&#x3D;(m_0+x)^{3}<br>$$<br>ä»¤$f(x)&#x3D;0$ï¼Œç”±äº$3\ln x&lt;\ln n$ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Sagemathä¸­ç›´æ¥æ¥<code>f.small_roots()</code>æ¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚è¿™ä¹Ÿæ˜¯ç›®å‰æœ€ç®€å•çš„ä¸€ä¸ªé—®é¢˜äº†ã€‚åŒç†ï¼Œå¦‚æœæˆ‘æŠŠ$e$ä¸Šå‡è‡³$5$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦çŸ¥é“å…«æˆçš„æ¯”ç‰¹ä½æ•°ï¼Œæ»¡è¶³$5\ln x &lt; \ln n$å³å¯ã€‚</p><p>åŒç†ï¼Œå¦‚æœRSAä¸­æ˜æ–‡$m$æ»¡è¶³$e\ln m &lt;\ln n$ã€‚ï¼ˆ$e&#x3D;3$æ—¶å³$3\ln m &lt; \ln n$ï¼‰ï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬çŸ¥é“äº†$c_1\equiv m^3 \pmod n$å’Œ$c_2\equiv (m+1)^{3} \pmod n$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨å®šä¹‰åŸŸ$Z_n$ä¸­å®šä¹‰å¤šé¡¹å¼$f(x)&#x3D;x^3-c_1$å’Œ$g(x)&#x3D;(x+1)^3 -c_2$ï¼Œæ±‚è¿™ä¸¤ä¸ªç®—å¼çš„å…¬çº¦æ•°å…¬çº¦å¼å³å¯ã€‚ï¼ˆä¸€èˆ¬æ˜¯ä¸€ä¸ªå½¢å¦‚$x-a$çš„ä¸€æ¬¡å¼ï¼‰ è¿™æ ·å°±å¯ä»¥æ±‚å‡ºæœ€ç»ˆçš„ç»“æœäº†ã€‚å½“ç„¶ï¼Œå¦‚æœå·²çŸ¥çš„æ˜¯$(Ax+B)^3$å’Œ$(Cx+D)^3$çš„ç»“æœï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ±‚æœ€å°å…¬å€æ•°çš„æ–¹æ³•æ±‚å‡ºå°æ ¹$x$ã€‚</p><h3 id="1o02-ä½æŒ‡æ•°å¡«å……å¹¿æ’­æ”»å‡»çš„æƒ…å†µ"><a href="#1o02-ä½æŒ‡æ•°å¡«å……å¹¿æ’­æ”»å‡»çš„æƒ…å†µ" class="headerlink" title="1o02 ä½æŒ‡æ•°å¡«å……å¹¿æ’­æ”»å‡»çš„æƒ…å†µ"></a>1o02 ä½æŒ‡æ•°å¡«å……å¹¿æ’­æ”»å‡»çš„æƒ…å†µ</h3><p>ç”±äºå·²çŸ¥ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»å¯ä»¥ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†ç›´æ¥è§£å†³ï¼Œæˆ‘ä»¬è®¾æƒ³ä¸€ä¸ªè¿™æ ·çš„æƒ…å½¢ï¼š</p><p>å‡è®¾åœ¨æŸç§æƒ…å†µä¸‹ï¼Œä¸ºäº†æŠŠåŒä¸€ä¸ªä¿¡æ¯å‘é€ç»™å¤šäººï¼Œå¦‚æœæˆ‘ä»¬å¯¹æ˜æ–‡$m$è¿›è¡Œä¸€ä¸ªè¾ƒä¸ºå¤æ‚çš„å¡«å……$r(\mathrm{id})$ï¼Œè¯¥å¡«å……å¼å¯ä¸ºå¤šé¡¹å¼ï¼Œä¹Ÿå¯ä¸ºæŒ‡æ•°å¼å¦‚$2^{\mathrm{id}}$ï¼Œä¼¼ä¹è¿™æ ·å°±ä¸ä¼šäº§ç”Ÿé—®é¢˜ã€‚</p><p>ä¸è¿‡è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡æ„é€ å¤šé¡¹å¼çš„æ–¹æ³•ï¼Œé€šè¿‡å¤šé¡¹å¼æ±‚æ ¹è®¡ç®—æ¥è·å¾—ã€‚</p><p>è®¾æƒ³$m_i&#x3D;x^r+i2^k$ï¼ŒåŠ å¯†æŒ‡æ•°$e$ä¸€å®šï¼ˆæ¯”å¦‚ä¸º$3$ï¼‰ï¼Œ$i$å·²çŸ¥ã€‚æ­¤æ—¶ä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å¤šé¡¹å¼æ¥è¿›è¡Œä½æŒ‡æ•°å¹¿æ’­æ”»å‡»</p><p>ä¸‹é¢çœ‹ä¸€ä¸‹è¿™é“é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, bytes_to_long<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">s,i</span>):<br>    <span class="hljs-keyword">return</span> i * <span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>,s.bit_length()) + s**<span class="hljs-number">2</span>  <span class="hljs-comment">#s.bit_length()=431</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_N</span>():<br>    <span class="hljs-keyword">return</span> getPrime(<span class="hljs-number">512</span>) * getPrime(<span class="hljs-number">512</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">54</span><br>invite = bytes_to_long(flag)<br>e_list = [random.choice([<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>)]<br>N_list = [gen_N() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>)]<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./invitations&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>):<br>        invis = <span class="hljs-built_in">pow</span>(pad(invite,i+<span class="hljs-number">1</span>),e_list[i],N_list[i])<br>        f.write(<span class="hljs-string">&#x27;Invitation%d: %d \n&#x27;</span>%(i+<span class="hljs-number">1</span>,invis))<br>    f.write(<span class="hljs-string">&#x27;Wait a minute! \n&#x27;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>):<br>        f.write(<span class="hljs-string">&#x27;[e%d,N%d]: [%d,%d]\n&#x27;</span>%(i+<span class="hljs-number">1</span>,i+<span class="hljs-number">1</span>,e_list[i],N_list[i]))<br></code></pre></td></tr></table></figure><p>é¢˜ç›®çš„å¡«å……$m_i&#x3D;x^{2}+3^{341}i$ï¼Œä¹Ÿæ˜¯ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼Œä¸€å…±ç»™äº†$14$ç»„æ•°æ®ã€‚å…¶ä¸­$e&#x3D;3$å››ç»„ï¼Œ$e&#x3D;5,7$å„äº”ç»„ã€‚</p><p>ç”±äºè¦ä¿è¯$e$ä¸€å®šï¼Œæ­¤å¤„é€‰æ‹©$e&#x3D;3$çš„$4$ç»„æ•°æ®æƒ…å†µã€‚</p><p>æ¨¡ä»¿ä¹‹å‰çš„ä¸­å›½å‰©ä½™å®šç†çš„æ­¥éª¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®¾$N&#x3D;\prod_{i&#x3D;1}^4 n_i$ã€‚ç„¶åè®¾$N_i$ï¼Œä½¿$N_i$æ»¡è¶³$N_i \equiv 0 \pmod {\dfrac{N}{n_i}}$ä¸”$N_i \equiv 1 \pmod n_i$ã€‚ä¹Ÿå°±æ˜¯$N_i$é™¤ä»¥$n_i$çš„ä½™æ•°æ˜¯$1$ï¼Œé™¤ä»¥$N$çš„å…¶ä»–å› æ•°çš„ä½™æ•°æ˜¯$0$ã€‚</p><p>ç”±äºè¿™é‡Œ$\dfrac{\ln N}{\ln 2}&#x3D;4096,\dfrac{\ln x}{\ln 2}&#x3D;342$ï¼Œå¤šé¡¹å¼æ¬¡æ•°ä¸º$6$ï¼Œæ»¡è¶³$6\ln x&lt;\ln n$ï¼Œå› æ­¤å¯ä»¥æ±‚å‡ºå¯¹åº”çš„æ ¹ã€‚</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨$Z_N$ä¸­æ„é€ $f(x)&#x3D;\sum_{i&#x3D;1}^{4}N_i((x^2+a_i3^{341})^3-c_i)$çš„ä¸€ä¸ªå…­æ¬¡å¤šé¡¹å¼ï¼Œç›´æ¥æ±‚å°æ ¹å³ä¸ºæœ€ç»ˆç­”æ¡ˆã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath 9.2</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br>c=[<br>    <span class="hljs-number">1292</span>****<span class="hljs-number">3823</span> ,<br>    <span class="hljs-number">814</span>****<span class="hljs-number">8214</span> ,<br>    <span class="hljs-number">2543</span>****<span class="hljs-number">4080</span> ,<br>    <span class="hljs-number">943</span>****<span class="hljs-number">1346</span> <br>]<br>n=[<br>    <span class="hljs-number">1466</span>****<span class="hljs-number">8391</span>,<br>    <span class="hljs-number">650</span>****<span class="hljs-number">6029</span>,<br>    <span class="hljs-number">1261</span>****<span class="hljs-number">1901</span>,<br>    <span class="hljs-number">756</span>****0471<br>]<br>MulNs=n[<span class="hljs-number">0</span>]*n[<span class="hljs-number">1</span>]*n[<span class="hljs-number">2</span>]*n[<span class="hljs-number">3</span>]<br>padd=[<span class="hljs-number">3</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    padd[i]=padd[i]*<span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>,<span class="hljs-number">431</span>)<br>Anscrts=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    Rem=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>    Rem[i]=<span class="hljs-number">1</span><br>    Anscrts[i]=crt(Rem,n)<br>R.&lt;x&gt;=PolynomialRing(Zmod(MulNs))<br>Gxs,Gx=[<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span>],<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    Gxs[i]=Anscrts[i]*(<span class="hljs-built_in">pow</span>(x*x+padd[i],<span class="hljs-number">3</span>)-c[i])<br>    Gx+=Gxs[i]<br>Gx=Gx.monic()<br>Flag=Gx.small_roots(epsilon=<span class="hljs-number">0.035</span>)<br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(Flag)!=<span class="hljs-number">0</span>):<br>    Flag.sort()<br><span class="hljs-built_in">print</span>(long_to_bytes(Flag[<span class="hljs-number">0</span>]))<br><span class="hljs-comment">#b&#x27;GWHT&#123;e959e3f8e7242954b43e1b91de9886e1&#125;Welc0metomyp4rty&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="2-ç®€å•çš„æ ¼æ„é€ æƒ…å†µ"><a href="#2-ç®€å•çš„æ ¼æ„é€ æƒ…å†µ" class="headerlink" title="2.ç®€å•çš„æ ¼æ„é€ æƒ…å†µ"></a>2.ç®€å•çš„æ ¼æ„é€ æƒ…å†µ</h2><h3 id="2o01-ç›´æ¥æ„é€ æ³•"><a href="#2o01-ç›´æ¥æ„é€ æ³•" class="headerlink" title="2o01 ç›´æ¥æ„é€ æ³•"></a>2o01 ç›´æ¥æ„é€ æ³•</h3><p>å½“ç„¶ï¼Œæœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç»„å»ºå¤šä¸ªæœªçŸ¥æ•°ä¸å·²çŸ¥æ•°ä¹‹é—´çš„å…³ç³»ï¼Œè€Œåœ¨è¿™å…¶ä¸­ï¼Œæœ‰æå°é‡çš„å‡ºç°</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™é“é¢˜ï¼šï¼ˆè‡ªå·±å‡ºçš„ä¸€ä¸ªLatticeå…¥é—¨é¢˜ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>m=bytes_to_long(flag)<br>p=getPrime(<span class="hljs-number">256</span>)<br>q=getPrime(<span class="hljs-number">2048</span>)<br>e=<span class="hljs-number">10007</span><br>n=p*q<br>f=getPrime(<span class="hljs-number">200</span>)<br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>r=getPrime(<span class="hljs-number">7500</span>)<br>h=(p-<span class="hljs-number">60708760708733</span>)*inverse(f,r)%r<br>ooo=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;given.py&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)<br>ooo.write(<span class="hljs-string">&quot;e=&quot;</span>+<span class="hljs-built_in">str</span>(e)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>ooo.write(<span class="hljs-string">&quot;n=&quot;</span>+<span class="hljs-built_in">str</span>(n)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>ooo.write(<span class="hljs-string">&quot;r=&quot;</span>+<span class="hljs-built_in">str</span>(r)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>ooo.write(<span class="hljs-string">&quot;h=&quot;</span>+<span class="hljs-built_in">str</span>(h)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>ooo.write(<span class="hljs-string">&quot;c=&quot;</span>+<span class="hljs-built_in">str</span>(c)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>ooo.close()<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œæœ¬é¢˜æœ‰æ˜æ˜¾çš„æ¼æ´ï¼Œå°±æ˜¯$\dfrac{\ln p}{\ln 2}&#x3D;256,\dfrac{\ln q}{\ln 2}&#x3D;2048,\dfrac{\ln r}{\ln 2}&#x3D;7500,\dfrac{\ln f}{\ln 2}&#x3D;200$ã€‚å·²çŸ¥é‡æ˜¯$(e,n,r,h,c)$ã€‚å¦‚æ­¤å·¨å¤§çš„å·®å¼‚ï¼Œé‚£å°±è¦è€ƒè™‘ä¸€ä¸‹åŸºæœ¬çš„æ ¼çš„å…³ç³»äº†ï¼š</p><p>æ ¹æ®<br>$$<br>h\equiv (p-60708760708733)f^{-1} \pmod r<br>$$<br>æˆ‘ä»¬å¯ä»¥å¾—åˆ°<br>$$<br>fh\equiv p-60708760708733 \pmod r<br>$$<br>ä¹Ÿå°±æ˜¯<br>$$<br>fh-kr&#x3D;p-60708760708733<br>$$<br>ç›˜ç‚¹ä¸€ä¸‹ï¼šæˆ‘ä»¬å·²ç»æœ‰äº†ä¸‰ä¸ªæœªçŸ¥é‡$f,k,p$ï¼Œä¸¤ä¸ªå·²çŸ¥é‡ã€‚ä¸ºäº†æ±‚å‡ºæœ‰æ„ä¹‰çš„æœªçŸ¥é‡$f,p$ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜å¯ä»¥å¢åŠ ä¸€å…±å¼å­$1f+0k\equiv f$ã€‚è¿™æ ·æˆ‘ä»¬å°±æ„é€ å‡ºæ¥$\vec xA &#x3D;\vec y$çš„æƒ…å½¢äº†ã€‚å…¶ä¸­$A$é‡Œé¢å‡ä¸ºå·²çŸ¥é‡ï¼Œ$\vec x,\vec y$é‡Œé¢åŒ…å«äº†æ‰€æœ‰çš„æœªçŸ¥é‡ã€‚ç„¶åå°±å¯ä»¥æ±‚å‡º$p$ï¼Œåˆ†è§£$n$ï¼Œå¾—å‡ºæœ€ç»ˆçš„å€¼äº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š$h,r$çš„æ¯”ç‰¹ä½éƒ½æ˜¯$7500$ï¼Œ$f$çš„æ¯”ç‰¹ä½æ˜¯$200$ï¼Œ$p$çš„æ¯”ç‰¹ä½æ˜¯$256$ã€‚å‘é‡$(f,-k),(1,h),(0,r)$çš„é•¿åº¦éƒ½æ˜¯è¶…è¿‡$7000$ä½çš„ã€‚è€Œæœ€åçš„å‘é‡$(f,p-60708760708733)$çš„å‘é‡é•¿åº¦ä»…ä¸º$300$ä½ä¸åˆ°ã€‚è¯¥æ•°å€¼è¿œå°äº$\sqrt{2 \det A}$ã€‚è€Œæ¯ä¸ªæ ¼$L$ä¸­ä¸€å®šæ˜¯å«æœ‰ä¸€ä¸ªé•¿åº¦å°äº$\sqrt n \sqrt[n]{\det L}$çš„å‘é‡çš„ã€‚$n$æ˜¯æ ¼$L$çš„ç»´æ•°</p><p><img src="/2021/07/25/LatticeNotes7/1.png" alt="1"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br>r=<span class="hljs-number">3488391316101515024972590.</span>.....<br>h=<span class="hljs-number">3143155356724417989594202.</span>.....<br>M=matrix([[<span class="hljs-number">1</span>,h],[<span class="hljs-number">0</span>,r]])<br>p=M.LLL()[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]<br>p+=<span class="hljs-number">60708760708733</span><br><span class="hljs-built_in">print</span>(p,is_prime(p))<br><span class="hljs-comment">#75287619124953899281094544588134588339526984734091359573347610235691729399693 True</span><br></code></pre></td></tr></table></figure><h3 id="2o02-è§’æœ€å¤§å€¼-å¯¹è§’-1-k-å¯¹å€¼æ„é€ æ³•"><a href="#2o02-è§’æœ€å¤§å€¼-å¯¹è§’-1-k-å¯¹å€¼æ„é€ æ³•" class="headerlink" title="2o02 è§’æœ€å¤§å€¼+å¯¹è§’$(1,-k)$å¯¹å€¼æ„é€ æ³•"></a>2o02 è§’æœ€å¤§å€¼+å¯¹è§’$(1,-k)$å¯¹å€¼æ„é€ æ³•</h3><p>æœ‰äº›æ—¶å€™ï¼Œè‹¥æˆ‘ä»¬çŸ¥é“çš„æœªçŸ¥æ•°$x_i$å’Œå·²çŸ¥æ•°$a_i$çš„å…³ç³»å‡ä¸ºçº¿æ€§å…³ç³»ï¼Œç”šè‡³å¯èƒ½å…·æœ‰ä¸€å®šçš„åŒæ€æ€§ï¼Œå¹¶ä¸”å¯èƒ½å‡ºç°çš„æœ€å¤§æ•°å­—éƒ½ä¸è¶…è¿‡æŸä¸ªç‰¹å®šçš„å€¼ï¼ˆæ¯”å¦‚$2^{128}$ï¼‰ä¹‹ç±»çš„å€¼ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨æ­¤æ–¹æ³•æ„é€ ã€‚</p><p>æ­¤ç±»é—®é¢˜ä¸­æœ€å…¸å‹çš„ä¸€ä¸ªå°±æ˜¯æˆ‘ä¹‹å‰åœ¨<strong>LatticeNotes5</strong>ä¸­æåŠçš„ä¸€ä¸ªLCGé—®é¢˜ï¼šå‡è®¾ä½ çŸ¥é“äº†ä¸€ä¸ª$128$ä½çš„LCGçš„å‚æ•°åŠå…¶è¾“å‡ºï¼Œä½†æ¯ä¸€ä¸ªLCGæœ€åçš„$40$ä½è¢«éšå»äº†ã€‚è®©ä½ æ±‚è¿™ä¸ªæ•°åˆ—çš„å®Œæ•´å€¼ã€‚</p><p>å‡è®¾æˆ‘ä»¬çŸ¥é“çš„æ‰€æœ‰çš„è¾“å‡ºæ•°åˆ—å¯è¡¨ç¤ºä¸º$u_n&#x3D;a_n+x_n$ã€‚å…¶ä¸­$a_n$æ˜¯å·²çŸ¥çš„é«˜$88$ä½ï¼Œ$x_n$æ˜¯æœªçŸ¥çš„ä½$40$ä½ã€‚$u_{n}$å’Œ$u_{n+1}$ä¹‹é—´çš„å…³ç³»æ˜¯$u_{n+1} \equiv Au_n+B \pmod M$ã€‚</p><p>ä¹Ÿå°±æ˜¯ï¼š<br>$$<br>a_{n+1}+x_{n+1} &#x3D;Aa_{n}+B+x_n+k_nM<br>$$<br>å»ºç«‹å·²çŸ¥æ•°å’ŒæœªçŸ¥æ•°ä¹‹é—´çš„å…³ç³»ï¼Œå¾—ï¼š</p><p><strong>Update 7.30 åŸå…ˆå…¬å¼$x_n$å‰å°‘äº†ä¸ªç³»æ•°$A$ï¼Œå·²è¡¥ä¸Š</strong><br>$$<br>x_{n+1}&#x3D;Aa_n+B-a_{n+1}+Ax_n+k_nM<br>$$<br>ç”±äºå‡ä¸ºçº¿æ€§æ“ä½œï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®¾$f_2(x)&#x3D;f(f(x)),f_3(x)&#x3D;f(f(f(x)))$ï¼Œè‹¥$f(x)&#x3D;Ax+B$ï¼Œåˆ™$f_2(x),f_3(x)$ä»ç„¶å…·æœ‰çº¿æ€§è§„å¾‹ã€‚ä¸”è§„å¾‹ä¸º$A_{n+1}&#x3D;AA_{n},B_{n+1}&#x3D;AB_{n}+Aa_n+B-a_{n+1}$ï¼Œä¸æ–­è¿­ä»£å³å¯ã€‚</p><p>è‹¥æˆ‘ä»¬å·²çŸ¥äº†$6$ç»„æ•°æ®ï¼Œå°±å¯ä»¥æ„é€ è¿™æ ·å¾—ä¸€ä¸ªæ ¼</p><p><strong>Update 8.2ï¼š è¿™é‡ŒåŸæ¥å³ä¸‹è§’çš„$2^{40}$æ˜¯é”™è¯¯çš„ï¼Œæ­£è§£æ˜¯$2^{128}$</strong></p><p><img src="/2021/07/25/LatticeNotes7/2.png" alt="2"></p><p>å¾ˆæ˜¾ç„¶ï¼Œä¾ç„¶æ˜¯$\vec xL&#x3D;\vec y$çš„å½¢å¼ï¼Œ$\vec x,\vec y$è¦†ç›–äº†æ‰€æœ‰çš„æœªçŸ¥é‡$x$å’Œ$k$ï¼Œ$L$ä¸­æ‰€æœ‰çš„å†…å®¹éƒ½æ˜¯å·²çŸ¥é‡ã€‚</p><p>è€Œæ­¤å¤„è¿™ä¸ª$2^{40}$å°±èµ·åˆ°äº†ä¸€ä¸ªé™ä½çš„ä½œç”¨ï¼Œè¯¥æ“ä½œä½¿å¾—æœ€åæ‰€æœ‰çš„$x$éƒ½ä¸è¶…è¿‡$2^{40}$ï¼Œä¹Ÿä½œä¸ºäº†ä¸€ä¸ªæ ‡å¿—æ€§çš„äº‹ç‰©ï¼Œå‘Šè¯‰æˆ‘ä»¬ä»¥$2^{40}$ç»“å°¾çš„é‚£ä¸€è¡Œæ‰æ˜¯ç­”æ¡ˆã€‚</p><p>æˆ‘ä»¬å¯ä»¥å†æ¥çœ‹ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ„é€ çš„æ ¼æ˜¯$7$ç»´çš„ï¼Œ$M,A,B$å‡ä¸º$128$ä½ï¼Œ$k$ä¹Ÿä¸º$128$ä½ã€‚$\vec x$å’ŒçŸ©é˜µ$L$ä¸­çš„æ¯ä¸€ä¸ªè¡Œå‘é‡çš„é•¿åº¦å‡ä¸º$130$ä½ä»¥ä¸Šã€‚è€Œå³è¾¹çš„$\vec y$ç”±äºæ¯ä¸ªæ•°å­—å‡ä¸º$40$ä½ï¼Œå› æ­¤é•¿åº¦çº¦ä¸º$42$ä½ã€‚æ­¤å¤„$\dfrac {\ln}{\ln 2}\det A$çš„å€¼çº¦ä¸º$680$ï¼Œè€ŒçŸ­å‘é‡çš„é•¿åº¦$\dfrac {\ln}{\ln 2}|\vec y|$çš„å€¼ä»…ä»…ä¸º$42$ï¼Œ$ \dfrac \ln {\ln 2}\sqrt 7 \sqrt[7]{\det A}&gt;97$ã€‚å› æ­¤æˆ‘ä»¬æ‰€æ„é€ çš„çŸ­å‘é‡æ˜¯ç¬¦åˆè¦æ±‚çš„ï¼ŒLLLç«‹åˆ»å‡ºè§£ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå…¸å‹çš„é¢˜ç›®å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> namedtuple<br>PublicKey = namedtuple(<span class="hljs-string">&#x27;PublicKey&#x27;</span>, [<span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>])<br>SecretKey = namedtuple(<span class="hljs-string">&#x27;SecretKey&#x27;</span>, [<span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-string">&#x27;q&#x27;</span>, <span class="hljs-string">&#x27;A&#x27;</span>])<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>():<br>    p = random_prime(<span class="hljs-number">2</span>^<span class="hljs-number">512</span>, lbound=<span class="hljs-number">2</span>^<span class="hljs-number">511</span>)<br>    q = random_prime(<span class="hljs-number">2</span>^<span class="hljs-number">512</span>, lbound=<span class="hljs-number">2</span>^<span class="hljs-number">511</span>)<br>    n = p * q<br>    a11, a12, a21 = [random_prime(<span class="hljs-number">2</span>^<span class="hljs-number">100</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>    a22 = random_prime(<span class="hljs-number">2</span>^<span class="hljs-number">100</span>)<br>    <span class="hljs-keyword">while</span> a11 * a22 == a12 * a21:<br>        a22 = random_prime(<span class="hljs-number">2</span>^<span class="hljs-number">100</span>)<br>    A = Matrix(ZZ, [[a11, a12], [a21, a22]])<br>    a1 = crt([a11, a21], [p, q])<br>    a2 = crt([a12, a22], [p, q])<br>    b = a1 * inverse_mod(a2, n) % n<br>    PK = PublicKey(n, b)<br>    SK = SecretKey(p, q, A)<br>    <span class="hljs-keyword">return</span> (PK, SK)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m, pk</span>):<br>    <span class="hljs-keyword">assert</span> <span class="hljs-number">0</span> &lt; m &lt; <span class="hljs-number">2</span>^<span class="hljs-number">400</span><br>    r = randint(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>^<span class="hljs-number">400</span>-<span class="hljs-number">1</span>)<br>    c = (pk.b*m + r) % pk.n<br>    <span class="hljs-keyword">return</span> c<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">c, sk</span>):<br>    a2 = crt([sk.A[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>], sk.A[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]], [sk.p, sk.q])<br>    s1 = a2 * c % sk.p<br>    s2 = a2 * c % sk.q<br>    m, r = sk.A.solve_right(vector([s1, s2]))<br>    <span class="hljs-keyword">return</span> m<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">pk, sk, num=<span class="hljs-number">3</span></span>):<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num):<br>        m = randint(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>^<span class="hljs-number">400</span>-<span class="hljs-number">1</span>)<br>        c = encrypt(m, pk)<br>        mm = decrypt(c, sk)<br>        <span class="hljs-keyword">assert</span> m == mm<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>    <span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> m, FLAG<br>    <span class="hljs-keyword">assert</span> FLAG == <span class="hljs-string">&#x27;d3ctf&#123;%s&#125;&#x27;</span> % sha256(<span class="hljs-built_in">int</span>(m).to_bytes(<span class="hljs-number">50</span>, <span class="hljs-string">&#x27;big&#x27;</span>)).hexdigest()<br>    PK, SK = gen_key()<br>    test(PK, SK)<br>    c = encrypt(m, PK)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;PK = <span class="hljs-subst">&#123;PK&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">PK = PublicKey(n=*, b=*)</span><br><span class="hljs-string">c = *</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure><p>é€šè¿‡å®¡è®¡ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªæœ€ç®€å•çš„çº¿æ€§å†…å®¹ï¼š$r&#x3D;bm-c-kn$ï¼Œå…¶ä¸­$r$æ˜¯ä¸€ä¸ª$400$ä½çš„éšæœºæ•°ï¼Œè€Œæˆ‘ä»¬è¦æ±‚çš„æ•°å­—å°±æ˜¯$m$ã€‚</p><p>ä½†æˆ‘ä»¬åªèƒ½å¾—åˆ°ä¸¤ä¸ªå¼å­(å¦ä¸€ä¸ªæ˜¯$1m&#x3D;m$)ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æ ¹æ®$m,r$å‡ä¸è¶…è¿‡$400$ä½çš„æ¡ä»¶ï¼Œæ”¾ä¸€ä¸ª$2^{400}$è¿›è¡Œå ä½ã€‚ç„¶åLLLå³å¯ã€‚</p><p><img src="/2021/07/25/LatticeNotes7/3.png" alt="3"></p><p><strong>LatticeNotes5</strong>è¿˜æœ‰ä¸€ä¸ªè§£å†³å“ˆå¸Œå†²çªçš„é¢˜ç›®ï¼Œä¹Ÿæ˜¯æ­¤ç±»é—®é¢˜çš„å…¸å‹ã€‚</p><p>è¿™ç§æ–¹æ³•å°±æ˜¯åœ¨å®šä¸Šé™çš„æƒ…å†µä¸‹ï¼Œè‹¥æˆ‘ä»¬æ„é€ çš„è¡Œå‘é‡$\vec x$ä¸­æ¶‰åŠåˆ°å¸¸æ•°$1$ï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡$\vec x$ä¸­çš„é‚£ä¸ª$1$ä¸çŸ©é˜µ$L$ä¸­çš„ä¸Šé™å€¼ç›¸ä¹˜å¾—åˆ°ä¸Šé™å€¼æ”¾å…¥ç»“æœå‘é‡$\vec y$ä¸­ã€‚</p><p>è¿˜å¯ä»¥ç‚¹å‡»[è¿™é‡Œ](<a href="https://blog.soreatu.com/posts/intended-solution-to-nhp-in-gxzyctf-2020/">Intended Solution to NHP in GxzyCTF 2020 | Soreat_uâ€™s Blog (soreatu.com)</a>)å¯¹æ­¤æ–¹æ³•èº«ä»·äº†è§£ã€‚</p><h3 id="2o03-æ„é€ å¤§æ•°ï¼ŒåŒ–å¤§ä¸ºå°"><a href="#2o03-æ„é€ å¤§æ•°ï¼ŒåŒ–å¤§ä¸ºå°" class="headerlink" title="2o03 æ„é€ å¤§æ•°ï¼ŒåŒ–å¤§ä¸ºå°"></a>2o03 æ„é€ å¤§æ•°ï¼ŒåŒ–å¤§ä¸ºå°</h3><p>æ ¹æ®Coppersmithå®šç†ï¼šè‹¥å¤šé¡¹å¼$f(x)$æ¨¡æ•°ä¸º$n$ï¼Œæ¬¡æ•°ä¸º$e$ï¼Œå¦‚æœå­˜åœ¨$x$æ»¡è¶³$f(x)&#x3D;0$ä¸”$e\ln x&lt;\ln n$ï¼Œé‚£ä¹ˆç¬¦åˆæ¡ä»¶çš„è¿™ä¸ª$x$å€¼æ˜¯å¯ä»¥è¢«å¿«é€Ÿè§£å‡ºçš„ã€‚</p><p>æ¯”å¦‚çœ‹ä¸€ä¸‹è¿™é“é¢˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> m1,m2<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Enc</span>(<span class="hljs-params">Mx,My</span>):<br>    p=getPrime(<span class="hljs-number">400</span>)<br>    a=bytes_to_long(urandom(<span class="hljs-number">80</span>))%p<br>    b=(My**<span class="hljs-number">2</span>-Mx**<span class="hljs-number">3</span>-a*Mx)%p<br>    E=EllipticCurve(GF(p),[a,b])<br>    M=E(Mx,My)<br>    C=<span class="hljs-number">3</span>*M<br>    <span class="hljs-keyword">return</span> C[<span class="hljs-number">0</span>],C[<span class="hljs-number">1</span>],a,b,p<br>m1,m2=*,* <span class="hljs-comment">#To Solve</span><br>Cipher=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">87</span>):<br>    Cipher.append(Enc(m1,m2))<br><span class="hljs-built_in">print</span>(Cipher)<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼Œæ˜æ–‡ç‚¹$M(x,y)$ï¼Œé€šè¿‡æ„é€ ä¸åŒçš„æ¤­åœ†æ›²çº¿$E$ï¼Œå¯¹è¿™ä¸ª$M$ç‚¹è¿›è¡Œäº†åŠ å¯†ï¼Œä½†åŠ å¯†æŒ‡æ•°ç»Ÿä¸€ä¸º$3$ï¼Œä¹Ÿå°±æ˜¯æœ€åç»™å‡ºäº†åœ¨ä¸åŒæ›²çº¿ä¸Šçš„$3P$å€¼ã€‚</p><p>æ ¹æ®æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹$x_{3P}(&#x3D;c)$ä¸$x{_P}(&#x3D;x)$çš„å…³ç³»å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>c&#x3D;\dfrac{x^9 - 12ax^7 - 96bx^6 + 30a^2x^5 - 24abx^4 + (36a^3 + 48b^2)x^3 + 48a^2bx^2 + (a^4 + 32ab^2 + 8(a^3 + 8b^2)a)x + 8(a^3 + 8b^2)b}{9x^8 + 36ax^6 + 72bx^5 + 30a^2x^4 + 144abx^3 + (-12a^3 + 144b^2)x^2 - 24a^2bx + a^4}<br>$$<br>å› æ­¤ï¼Œå¯¹äºé¢˜ç›®ä¸­ç»™å‡ºçš„$87$ä¸ªä¸åŒæ›²çº¿ä¸Šçš„$3P$ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡æ„é€ ä¸Šé¢çš„å¤šé¡¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœè®¾ä¸Šé¢å…¬å¼ä¸­ç­‰å·å³è¾¹çš„åˆ†å­éƒ¨åˆ†æ˜¯$S$ï¼Œåˆ†æ¯éƒ¨åˆ†æ˜¯$D$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ $9$æ¬¡å¤šé¡¹å¼<br>$$<br>f_n(x)\equiv S-Dc \pmod {p_n}<br>$$<br>å…¶ä¸­$n$ä»$1$å–åˆ°$87$ï¼Œè¿™æ ·å°±æœ‰äº†$87$ä¸ªä¸åŒçš„å¤šé¡¹å¼äº†ï¼Œä½†è¿™äº›å¤šé¡¹å¼çš„ä½œç”¨åŸŸéƒ½ä¸ç›¸åŒã€‚</p><p>è¿™ä¸ªæ—¶å€™è·ŸRSAä¸­çš„å¹¿æ’­æ”»å‡»ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†äº†ã€‚ä½†è¿™ä¸€æ¬¡çš„ä¸­å›½å‰©ä½™å®šç†çš„è¿ç”¨ç•¥æœ‰ä¸åŒï¼šé¦–å…ˆæˆ‘ä»¬è®¡ç®—$N&#x3D;\prod_{i&#x3D;1}^{87}p_i$ï¼Œå³æ‰€æœ‰$p$çš„ä¹˜ç§¯ã€‚ç”±äº$\dfrac{\ln p}{\ln 2}&#x3D;400$ï¼Œå› æ­¤è¿™é‡Œå·®ä¸å¤šæ˜¯$\ln n&#x3D;87\ln p$ï¼Œ$n$çš„æ¯”ç‰¹ä½æ•°è¿…é€Ÿä¸Šæ¶¨åˆ°äº†$34000$ä»¥ä¸Šâ€”â€”è¿™æ¯”ä»»ä½•æ•°éƒ½å¤§ã€‚</p><p>ç„¶åå¯¹äºæ‰€æœ‰$f_n(x)$ä¸­ï¼Œä»å¸¸æ•°é¡¹åˆ°$9$æ¬¡é¡¹ï¼Œæ¯ä¸€é¡¹å‡ä½¿ç”¨ä¸€æ¬¡ä¸­å›½å‰©ä½™å®šç†ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰å¸¸æ•°é¡¹æ„æˆçš„æ•°ç»„å¯¹æ‰€æœ‰$p$æ„æˆçš„æ•°ç»„è¿›è¡Œè®¡ç®—ã€‚å¹¶æœ€åæ±‡æ€»$Z_N$ä¸Šçš„ä¸€ä¸ªéå¸¸å¤§çš„ä¹æ¬¡å¤šé¡¹å¼$F(x)$ï¼Œè¯¥å¼ä¸ä»…å¤„äºä¸€ä¸ªå¾ˆå¤§çš„ç¯$Z_N$ä¸Šï¼Œå¸¸æ•°é¡¹åˆ°$x^8$é¡¹æ¯ä¸€é¡¹çš„ç³»æ•°éƒ½éå¸¸å¤§ï¼ˆ$x^9$çš„ç³»æ•°æ’å®šä¸º$1$ï¼‰ã€‚è€Œæˆ‘ä»¬æƒ³æ±‚çš„$x_P$ï¼Œä»ç„¶æ»¡è¶³$F(x_P)\equiv 0 \pmod N$ã€‚å¹¶ä¸”è¿™é‡Œä¸€å®šæ»¡è¶³$9\ln x_P&lt;\ln N$ï¼Œå¯ä»¥ç›´æ¥ç”¨Coppersmithå®šç†æ±‚è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br>Cipher=[]<br>Cxarr,Cyarr,Aarr,Barr,Parr=[[[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">87</span>)]<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">87</span>):<br>    Cxarr[i],Cyarr[i],Aarr[i],Barr[i],Parr[i]=Cipher[i]<br>N=prod(Parr)<br>F=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">87</span>):<br>    a,b,p=Aarr[i],Barr[i],Parr[i]<br>    R.&lt;x&gt;=PolynomialRing(Zmod(p))<br>    Fz=x^<span class="hljs-number">9</span> - <span class="hljs-number">12</span>*a*x^<span class="hljs-number">7</span> - <span class="hljs-number">96</span>*b*x^<span class="hljs-number">6</span> + <span class="hljs-number">30</span>*a^<span class="hljs-number">2</span>*x^<span class="hljs-number">5</span> - <span class="hljs-number">24</span>*a*b*x^<span class="hljs-number">4</span> + (<span class="hljs-number">36</span>*a^<span class="hljs-number">3</span> + <span class="hljs-number">48</span>*b^<span class="hljs-number">2</span>)*x^<span class="hljs-number">3</span> + <span class="hljs-number">48</span>*a^<span class="hljs-number">2</span>*b*x^<span class="hljs-number">2</span> + (a^<span class="hljs-number">4</span> + <span class="hljs-number">32</span>*a*b^<span class="hljs-number">2</span> + <span class="hljs-number">8</span>*(a^<span class="hljs-number">3</span> + <span class="hljs-number">8</span>*b^<span class="hljs-number">2</span>)*a)*x + <span class="hljs-number">8</span>*(a^<span class="hljs-number">3</span> + <span class="hljs-number">8</span>*b^<span class="hljs-number">2</span>)*b<br>    Fm=<span class="hljs-number">9</span>*x^<span class="hljs-number">8</span> + <span class="hljs-number">36</span>*a*x^<span class="hljs-number">6</span> + <span class="hljs-number">72</span>*b*x^<span class="hljs-number">5</span> + <span class="hljs-number">30</span>*a^<span class="hljs-number">2</span>*x^<span class="hljs-number">4</span> + <span class="hljs-number">144</span>*a*b*x^<span class="hljs-number">3</span> + (-<span class="hljs-number">12</span>*a^<span class="hljs-number">3</span> + <span class="hljs-number">144</span>*b^<span class="hljs-number">2</span>)*x^<span class="hljs-number">2</span> - <span class="hljs-number">24</span>*a^<span class="hljs-number">2</span>*b*x + a^<span class="hljs-number">4</span><br>    Fx=(Fz-Cxarr[i]*Fm)<br>    F.append(Fx)<br>R.&lt;x&gt;=PolynomialRing(Zmod(N))<br>G=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    Arrcrt=[]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">87</span>):<br>        Arrcrt.append(Integer(F[j][i]))<br>    G+=crt(Arrcrt,Parr)*x**i<br>m1=G.small_roots(epsilon=<span class="hljs-number">1</span>/<span class="hljs-number">13</span>)[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(m1)<br>E=EllipticCurve(GF(Parr[<span class="hljs-number">0</span>]),[Aarr[<span class="hljs-number">0</span>],Barr[<span class="hljs-number">0</span>]])<br>O=E(<span class="hljs-number">483680648326747026189680</span>, <span class="hljs-number">119181855961981</span>)<br>(m1^<span class="hljs-number">3</span>+Aarr[<span class="hljs-number">0</span>]*m1+Barr[<span class="hljs-number">0</span>])%Parr[<span class="hljs-number">0</span>],<span class="hljs-number">119181855961981</span>**<span class="hljs-number">2</span>%Parr[<span class="hljs-number">0</span>]<br>m2=<span class="hljs-built_in">min</span>(Parr[<span class="hljs-number">0</span>]-<span class="hljs-built_in">pow</span>(<span class="hljs-number">14204314790542386034917444361</span>,(Parr[<span class="hljs-number">0</span>]+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,Parr[<span class="hljs-number">0</span>]),<span class="hljs-built_in">pow</span>(<span class="hljs-number">14204314790542386034917444361</span>,(Parr[<span class="hljs-number">0</span>]+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,Parr[<span class="hljs-number">0</span>]))<br><span class="hljs-built_in">print</span>(m2)<br><span class="hljs-built_in">print</span>(long_to_bytes(m1)+long_to_bytes(m2))<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">483680648326747026189680</span><br><span class="hljs-string">119181855961981</span><br><span class="hljs-string">flag&#123;Example003&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure><p>è‡³äº$y_{P}$æ€ä¹ˆæ±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€‰ä¸€ç»„å¸¦æ¨¡$4$ä½™$3$çš„$p$çš„æ•°æ®ï¼Œæ ¹æ®æœ‰é™åŸŸå†…å¼€å¹³æ–¹å…¬å¼ï¼Œç›´æ¥è®¡ç®—$(x^{3}+ax+b)^{(p+1)&#x2F;4} \mod p$çš„å€¼å³å¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Blockbot beginning</title>
    <link href="/2021/07/17/Blockbot-beginning/"/>
    <url>/2021/07/17/Blockbot-beginning/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087åŸºäºGoCqçš„QQ-Bot-å¼€å‘æ—¥è®°"><a href="#huangx607087åŸºäºGoCqçš„QQ-Bot-å¼€å‘æ—¥è®°" class="headerlink" title="huangx607087åŸºäºGoCqçš„QQ-Bot å¼€å‘æ—¥è®°"></a>huangx607087åŸºäºGoCqçš„QQ-Bot å¼€å‘æ—¥è®°</h1><h2 id="0x00-About"><a href="#0x00-About" class="headerlink" title="0x00.About"></a>0x00.About</h2><p>å…ˆæ¥è¯´è¯´è‡ªå·±ä¸ºä»€ä¹ˆè¿™ä¹ˆæƒ³è¦ä¸ªæœºå™¨äººã€‚</p><p>2014å¹´åˆï¼Œè‡ªå·±å®¶é‡Œå®‰è£…äº†wifiï¼Œç„¶åè‡ªå·±å½“å¹´çš„ä¸€éƒ¨å°æ‰‹æœºè”æƒ³A278tå°±å¯ä»¥è”ç½‘äº†ã€‚äºæ˜¯æˆ‘å°±å¯ä»¥ä¸‹è½½äº†ä¸€ä¸ªæ‰‹æœºQQå¼€å§‹ç©ï¼ˆæ³¨ï¼šè‡ªå·±QQè™½ç„¶æ˜¯2010å¹´ç”³è¯·çš„ï¼Œä½†è‡ªå·±åœ¨2010-2013å¹´å¹´åº•åŸºæœ¬æ²¡ç”¨è¿‡QQï¼‰ã€‚ç„¶åå½“å¹´è‡ªå·±å–œæ¬¢ç©å¼€ç½—æ¸¸æˆï¼Œå•æœºçš„ï¼Œä¸€ä¸ªæ¸¸æˆä¸åˆ°10Mï¼Œç„¶ååŠ äº†å‡ ä¸ªè®¨è®ºç¾¤ã€‚å…¶ä¸­æœ‰ä¸ªè®¨è®ºç¾¤é‡Œä¸€ä¸ªè‡ªåŠ¨èŠå¤©æœºå™¨äººï¼Œå¸¦ç­¾åˆ°åŠŸèƒ½å’Œå„ç§å¨±ä¹åŠŸèƒ½çš„ã€‚è‡ªå·±å°±æ„Ÿè§‰å¾ˆå¥½ç©ã€‚ç„¶åå½“æ—¶å°±ä¸‹äº†ä¸ªcoolQï¼Œé¡ºå¸¦ç€æäº†ç‚¹æ’ä»¶ï¼Œæ”¾åœ¨ä¸€ä¸ªç¾¤é‡Œé¢ã€‚åˆ°ç°åœ¨æ‰“å¼€å®¶é‡ŒWindows 7çš„æ—§ç”µè„‘ï¼Œå½“å¹´çš„ç£ç›˜å†…éƒ¨æ–‡ä»¶éƒ½è¿˜åœ¨å‘¢ï¼</p><img src="/2021/07/17/Blockbot-beginning/0-1.png" alt="0-1" style="zoom:80%;"><p><del>ç„¶åé«˜è€ƒç»“æŸå‘ç°coolQè¿™ä¸ªç©æ„SPFAäº†</del>ï¼Œæ„Ÿå¹è‡ªå·±ä»¥å‰ç”Ÿæ´»å›ä¸å»ä¹‹ä½™ï¼Œä¹Ÿå°±æ²¡å•¥æçš„äº†ï¼ˆã€‚ä¸è¿‡å¼€å­¦å‘ç°Lakphyå’ŒPiCpoä¸¤ä½å¼€å‘å¤§ä½¬ç©æ ‘è“æ´¾æäº†ä¸ªåŸºäºMiraiçš„æœºå™¨äººé©®è½½åœ¨Ubuntuç³»ç»Ÿçš„æ ‘è“æ´¾ä¸Šï¼Œè‡ªå·±ä¹Ÿå¾ˆç¾¡æ…•ï¼Œ7æœˆ4æ—¥Lakphyå¸®æˆ‘æçš„æ—¶å€™æå´©äº†ã€‚ä¸­é—´ä¹Ÿæäº†å‡ æ¬¡å¾ˆçƒ¦èºï¼Œå› ä¸ºéƒ½å¤±è´¥äº†ã€‚æ˜¨å¤©æœ‰å¹¸åœ¨å®˜æ–¹ç¾¤é‡Œæœ‰å¤§ä½¬æ‰‹æŠŠæ‰‹æ•™æˆ‘æï¼Œåœ¨ç¾¤é‡Œå¤§ä½¬ä»¬çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ææˆåŠŸäº†ã€‚ã€‚ç‰¹æ­¤å†™ä¸‹è¿™ç¯‡æ–‡ç« ç»™ä»¥åè¿˜æƒ³å¼€å‘æœºå™¨äººçš„äººè¿›è¡Œå‚è€ƒå­¦ä¹ ï¼Œæˆ–è€…ç»™å·²ç»å¼€å‘å¥½è‡ªå·±botçš„äººå¼€è¾Ÿå¦ä¸€æ¡é“è·¯ã€‚</p><p>ç”±äºè‡ªå·±ä¸»æœºå·²ç»è£…æœ‰Python3.7.4å’Œå¾ˆå¤šä¸ºäº†æ‰“CTFçš„åŒ…ï¼ŒåŠ ä¸Šå¾ˆå¤šå¤æ‚çš„ç¯å¢ƒå˜é‡ï¼Œä¸ºäº†ä¸ä¸è‡ªå·±çš„Windows 10å®ä½“æœºä¸Šçš„å†…å®¹å†²çªï¼Œæœºå™¨äººé©®è½½åœ¨äº†è™šæ‹Ÿæœºä¸Šã€‚<del>ï¼ˆå› ä¸ºWin10çš„æ¿€æ´»è„šæœ¬æˆ‘æ²¡æåˆ°åŠ ä¸Šé…ç½®è¦æ±‚å¤ªé«˜ï¼ŒWin7å¾ˆå¤šç³»ç»Ÿä¸Šçš„å†…å®¹å¤ªæ—§äº†ï¼Œå¹¶ä¸”ç”¨å¾—ä¸ä¹ æƒ¯ï¼ŒLinuxæˆ‘ä¹Ÿä¸æ€ä¹ˆç†Ÿæ‚‰ï¼‰</del>ã€‚äºæ˜¯é€‰æ‹©ä¸Windows 10å…±åŒç‚¹è¾ƒå¤šçš„ Windows 8ç³»ç»Ÿä½œä¸ºè‡ªå·±Botçš„Serverã€‚</p><p><strong>æœ¬æ•™ç¨‹åŸºæœ¬ä¸Šæ˜¯è‡ªå·±åšè¿‡ä¸€éåç„¶åæ‰‹æŠŠæ‰‹æ•™çš„ï¼Œä¸€åˆ‡ä»0ç¯å¢ƒå¼€å§‹é…èµ·ï¼æœºå™¨äººæœåŠ¡Serverä½¿ç”¨Windows7&#x2F;8&#x2F;10ç³»ç»Ÿã€‚<del>11çš„å¯ä»¥æ•ˆä»¿ï¼ŒæŒ‰é“ç†æ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡æˆ‘æ²¡è¯•è¿‡</del></strong></p><p>nonebotæ‰‹å†Œç½‘å€ <a href="https://v2.nonebot.dev/guide/">ç‚¹è¿™é‡Œ</a></p><h2 id="0x01-ç¯å¢ƒçš„å‡†å¤‡ä¸é…ç½®"><a href="#0x01-ç¯å¢ƒçš„å‡†å¤‡ä¸é…ç½®" class="headerlink" title="0x01.ç¯å¢ƒçš„å‡†å¤‡ä¸é…ç½®"></a>0x01.ç¯å¢ƒçš„å‡†å¤‡ä¸é…ç½®</h2><h3 id="1o01-å¼€å‘ç¯å¢ƒä¸€è§ˆ"><a href="#1o01-å¼€å‘ç¯å¢ƒä¸€è§ˆ" class="headerlink" title="1o01 å¼€å‘ç¯å¢ƒä¸€è§ˆ"></a>1o01 å¼€å‘ç¯å¢ƒä¸€è§ˆ</h3><p><strong>Windows 7&#x2F;8&#x2F;10 ç³»ç»Ÿï¼Œæœ¬åšå®¢ä½¿ç”¨çš„æ˜¯Windows 8è™šæ‹Ÿæœºç³»ç»Ÿã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä½ Windows 7&#x2F;8&#x2F;10å®ä½“æœºï¼ŒLinuxå¤§ä½¬å¯ä»¥ä½¿ç”¨æ ‘è“æ´¾çš„Linuxç³»ç»Ÿã€‚</strong></p><p><del>ä¸ªäººå»ºè®®å¦‚æœä½¿ç”¨è™šæ‹Ÿæœºï¼Œæ‰¾ä¸åˆ°Windows 10è¿˜æ˜¯é€‰æ‹©Windows 7æ¯”è¾ƒå¥½ï¼ŒWindows 8å®‰è£…æ¯”è¾ƒéº»çƒ¦</del></p><p><font color="red"><strong>Python 3.9+å’ŒVsCode</strong></font>ï¼Œæœ¬æ ·ä¾‹ä¸­ä½¿ç”¨çš„æ˜¯Python 3.9.6ï¼Œä¸€å®šè¦ä¿è¯Pythonç‰ˆæœ¬é«˜äº3.9</p><p>å¦‚æœä½ å·²ç»æ»¡è¶³äº†å¼€å‘ç¯å¢ƒï¼Œè¯·è·³è¿‡æ•´ä¸ª<strong>0x01</strong>ç¯å¢ƒé…ç½®é˜¶æ®µ ã€‚</p><p>ä¸‹å›¾æ˜¯ç©ºç©ºçš„ä¸€ä¸ªWindows 8 çš„æˆªå›¾ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥ä¸€æ­¥ä¸€æ­¥é…ç½®ç¯å¢ƒäº†ã€‚<del>å¯ä»¥çœ‹å‡ºï¼ŒWindows 8ç•Œé¢è·ŸWindows 7è¿˜æ˜¯æŒºåƒçš„</del></p><p>æ³¨ï¼šå¦‚æœæƒ³ä½¿ç”¨Windowsè™šæ‹Ÿæœºä½œä¸ºæœºå™¨äººçš„Serverçš„è¯ï¼Œå¯ä»¥åœ¨<a href="https://www.moerats.com/kms/">è¿™é‡Œ</a>å¯»æ‰¾æ¿€æ´»è„šæœ¬ã€‚</p><p>ç”±äºWindows 8è‡ªå¸¦æµè§ˆå™¨æ˜¯IE 11ï¼Œç”¨çš„æ¯”è¾ƒlowï¼Œæˆ‘ä¸‹äº†ä¸ªEdgeæµè§ˆå™¨</p><p><img src="/2021/07/17/Blockbot-beginning/1-1.png" alt="1-1"></p><h3 id="1o02-Pythonçš„ä¸‹è½½ä¸é…ç½®-åŒ…æ‹¬pip"><a href="#1o02-Pythonçš„ä¸‹è½½ä¸é…ç½®-åŒ…æ‹¬pip" class="headerlink" title="1o02 Pythonçš„ä¸‹è½½ä¸é…ç½®(åŒ…æ‹¬pip)"></a>1o02 Pythonçš„ä¸‹è½½ä¸é…ç½®(åŒ…æ‹¬pip)</h3><p>ç™»å½•<a href="https://www.python.org/downloads/">Pythonä¸‹è½½å®˜ç½‘</a>,é€‰æ‹© Python 3.9.6 ï¼Œä¸‹è½½é¡µé¢å»ºè®®é€‰æ‹©Windows Installer(64-bit)</p><p><img src="/2021/07/17/Blockbot-beginning/1-2-1.png" alt="1-2-1"></p><p>å¼€å§‹å®‰è£…çš„æ—¶å€™ï¼Œå»ºè®®æŠŠä¸‹é¢ä¸¤ä¸ªå‹¾éƒ½æ‰“ä¸Šï¼Œç„¶åç‚¹Install Nowç­‰å¾…å®‰è£…æˆåŠŸ</p><p><img src="/2021/07/17/Blockbot-beginning/1-2-2.png" alt="1-2-2"></p><p>åœ¨æ¡Œé¢ä¸Šåˆ›å»ºä¸€ä¸ª<code>1.py</code>æ–‡ä»¶å³å‡»ç”¨IDLEè¿›è¡Œç¼–è¾‘ï¼Œå¦‚æœèƒ½æŒ‰<code>F5</code>è¿è¡ŒæˆåŠŸå°±ç®—å®‰è£…æˆåŠŸäº†ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/1-2-3.png" alt="1-2-3"></p><p>å½“ç„¶ï¼ŒPythonåˆ°ç°åœ¨è¿˜æ²¡æœ‰ç»“æŸï¼Œæˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹Python pipã€‚</p><p>ç›´æ¥åœ¨Cç›˜æ ¹ç›®å½•ä¸‹æœpython39ï¼Œç„¶åæ‰“å¼€å°±è¡Œäº†</p><p><img src="/2021/07/17/Blockbot-beginning/1-2-4.png" alt="1-2-4"></p><p>æ‰“å¼€Python39è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå†æ‰“å¼€Scriptsï¼Œå¯ä»¥çœ‹åˆ°pipåœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/1-2-5.png" alt="1-2-5"></p><p>å³å‡»pipï¼Œå¯ä»¥çœ‹åˆ°pipçš„ä½ç½®ï¼Œå°†è¿™ä¸ªä½ç½®å®Œå…¨å¤åˆ¶ä¸‹æ¥ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/1-2-6.png" alt="1-2-6"></p><p>å³å‡»â€œè¿™å°ç”µè„‘â€ï¼Œï¼ˆWin7æ˜¯æˆ‘çš„ç”µè„‘&#x2F;Win10æ˜¯æ­¤ç”µè„‘ï¼‰ï¼Œç„¶åä¾æ¬¡ç‚¹å‡»â€é«˜çº§ç³»ç»Ÿè®¾ç½®â€œã€â€ç¯å¢ƒå˜é‡â€œã€‚ç„¶ååœ¨ç¯å¢ƒå˜é‡ä¸­æ‰¾åˆ°Pathï¼Œç‚¹ç¼–è¾‘ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/1-2-7.png" alt="1-2-7"></p><p>å°†é¼ æ ‡å…‰æ ‡ç§»åˆ°æœ€å<font color="red"><strong>å‰é¢çš„æ˜¯ç³»ç»Ÿå˜é‡ï¼Œåƒä¸‡ä¸è¦åˆ ã€‚ä¸è¿‡Windows 10çš„ç³»ç»Ÿå˜é‡æ˜¯è¡¨æ ¼çš„å½¢å¼ï¼Œå¾ˆæ–¹ä¾¿</strong></font>ã€‚</p><p>åœ¨åé¢åŠ ä¸€ä¸ªåˆ†å·ï¼Œç„¶åæŠŠåˆšæ‰å¤åˆ¶pipçš„ä½ç½®åŠ åˆ°åé¢å°±è¡Œäº†ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/1-2-8.png" alt="1-2-8"></p><p>ç„¶åæˆ‘ä»¬æ‰“å¼€cmdï¼Œè¾“å…¥pipï¼Œå¦‚æœèƒ½å‡ºç°pipèœå•è¯´æ˜pipé…ç½®æˆåŠŸã€‚é…ç½®æˆåŠŸæˆªå›¾å¦‚ä¸‹</p><p><img src="/2021/07/17/Blockbot-beginning/1-2-9.png" alt="1-2-9"></p><h3 id="1o03-VSCodeçš„ä¸‹è½½ä¸é…ç½®"><a href="#1o03-VSCodeçš„ä¸‹è½½ä¸é…ç½®" class="headerlink" title="1o03 VSCodeçš„ä¸‹è½½ä¸é…ç½®"></a>1o03 VSCodeçš„ä¸‹è½½ä¸é…ç½®</h3><p>ä½¿ç”¨VSCodeï¼Œæ˜¯ä¸ºäº†åœ¨åé¢èƒ½å¤Ÿæ›´å¥½çš„ç¼–è¾‘<code>Python</code>æ–‡ä»¶å’Œå„ç§é…ç½®æ–‡ä»¶</p><p><img src="/2021/07/17/Blockbot-beginning/1-3-1.png" alt="1-3-1"></p><p>ç›´æ¥ç‚¹æœºå³ä¸Šè§’Downloadï¼Œç„¶åé€‰æ‹©Windows 64ç‰ˆæœ¬ï¼ˆLinuxé€‰æ‹©Linuxç‰ˆæœ¬ï¼‰è¿›è¡Œä¸‹è½½å®‰è£…å³å¯ã€‚è¿™é‡Œå®‰è£…æ—¶å¯ä»¥ç›´æ¥æ— è„‘åœ°Nextã€‚</p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„å¿…è¦ç¯å¢ƒé…ç½®å®Œæˆã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥çœŸæ­£åœ°æ¥å‡†å¤‡æˆ‘ä»¬çš„æœºå™¨äººå§ã€‚</p><h2 id="0x02-æœºå™¨äººçš„é…ç½®"><a href="#0x02-æœºå™¨äººçš„é…ç½®" class="headerlink" title="0x02 æœºå™¨äººçš„é…ç½®"></a>0x02 æœºå™¨äººçš„é…ç½®</h2><h3 id="2o01-åˆå§‹å†…å®¹"><a href="#2o01-åˆå§‹å†…å®¹" class="headerlink" title="2o01 åˆå§‹å†…å®¹"></a>2o01 åˆå§‹å†…å®¹</h3><p>é…ç½®æœºå™¨äººé¦–å…ˆæˆ‘ä»¬ä¼šé€‰æ‹©æˆ‘ä»¬æœºå™¨äººçš„æ–‡ä»¶å¤¹ã€‚ï¼ˆæ­¤å¤„æˆ‘ç›´æ¥é€‰æ‹©äº†Dç›˜æ ¹ç›®å½•ä¸‹é¢<del>å› ä¸ºæˆ‘ç”¨çš„æ˜¯è™šæ‹Ÿæœº</del>ï¼‰ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/2-1-1.png" alt="2-1-1"></p><p>æ‰“å¼€æˆ‘ä»¬éœ€è¦çš„æ–‡ä»¶å¤¹ï¼Œä¸ºæ–¹ä¾¿æœŸé—´ï¼Œæœ€å¥½ä¿è¯æ–‡ä»¶å¤¹ä¸€å¼€å§‹ä¸ºç©º</p><p><img src="/2021/07/17/Blockbot-beginning/2-1-2.png" alt="2-1-2"></p><h3 id="2o02-é€šè¿‡è„šæ‰‹æ¶å®‰è£…nonebot"><a href="#2o02-é€šè¿‡è„šæ‰‹æ¶å®‰è£…nonebot" class="headerlink" title="2o02 é€šè¿‡è„šæ‰‹æ¶å®‰è£…nonebot"></a>2o02 é€šè¿‡è„šæ‰‹æ¶å®‰è£…nonebot</h3><p>æ‰“å¼€cmdï¼Œåœ¨cmdä¸­è¾“å…¥ <code>pip install nb-cli </code>ã€‚éç®¡ç†å‘˜ç”¨æˆ·éœ€è¦åœ¨åé¢åŠ ä¸Š<code>--user</code>ï¼ŒWindowsåé¢æ‰€æœ‰å‘½ä»¤å‡å¦‚æ­¤ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/2-2-1.png" alt="2-2-1"></p><p>ç„¶åä»–å°±ä¼šç»™ä½ å®‰è£…ä¸€å¤§å †å¿…è¦çš„ä¸œè¥¿ã€‚ã€‚ã€‚</p><p>å®‰è£…æˆåŠŸçš„æ ‡å‡†æ˜¯ä½ åœ¨pythonä¸­è¾“å…¥<code>import nonebot</code> ä¸æŠ¥é”™å¹¶ä¸”ä½ åœ¨cmdä¸­è¾“å…¥<code>nb</code> ä¼šå‡ºç°å¦‚ä¸‹ç•Œé¢</p><p><img src="/2021/07/17/Blockbot-beginning/2-2-2.png" alt="2-2-2"></p><p>åŒç†ï¼Œæˆ‘ä»¬è¿˜è¦å®‰è£…é€‚é…å™¨ï¼Œè¾“å…¥å‘½ä»¤ï¼š<code>pip install nonebot-adapter-cqhttp</code>ï¼ŒæŒ‰å›è½¦å®‰è£…ã€‚è£…å®Œè¿™ä¸ªååŒæ—¶è£…ä¸€ä¸‹<code>pip install nonebot-adapter-gocq</code>ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/2-2-3.png" alt="2-2-3"></p><p>è¿™ä¸¤ä¸ªä¸œè¥¿å®‰è£…å¥½ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å°†å†…å®¹åˆ‡æ¢åˆ°æˆ‘ä»¬çš„æ–‡ä»¶å¤¹ä¸­äº†</p><p>Windows CMDä¸­æœ‰å‡ ä¸ªå‘½ä»¤æ³¨æ„ä¸€ä¸‹</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim">d: ï¼ˆè¡¨ç¤ºç›´æ¥å°†cmdæ‰€åœ¨ç£ç›˜åˆ‡æ¢åˆ°Dç›˜ï¼‰<br><span class="hljs-keyword">cd</span> <span class="hljs-keyword">abc</span> ï¼ˆè¡¨ç¤ºæ‰“å¼€æ‰€åœ¨ä½ç½®çš„<span class="hljs-keyword">abc</span>æ–‡ä»¶å¤¹ï¼‰<br>dir ï¼ˆæŸ¥çœ‹è¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œä¸æ˜¯<span class="hljs-keyword">ls</span>ï¼‰<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥åˆ‡æ¢åˆ°æˆ‘ä»¬è¦é…ç½®æœºå™¨äººçš„åœ°æ–¹äº†ã€‚æˆ‘è¿™è¾¹é€‰æ‹©çš„å°±æ˜¯Dç›˜æ ¹ç›®å½•ã€‚å¹¶åœ¨æ­¤è¾“å…¥<code>nb create</code>åæŒ‰å›è½¦</p><p><img src="/2021/07/17/Blockbot-beginning/2-2-4.png" alt="2-2-4"></p><p>ç„¶åè¾“å…¥æˆ‘ä»¬çš„é¡¹ç›®åç§°ï¼Œè¿™é‡Œå«example,ç„¶åæŒ‰å›è½¦</p><p><img src="/2021/07/17/Blockbot-beginning/2-2-5.png" alt="2-2-5"></p><p>ç¬¬äºŒæ­¥é—®ä½ æ–‡ä»¶å¤¹åå­—æ˜¯ä»€ä¹ˆï¼Œé€‰1å’Œ2éƒ½è¡Œï¼Œä¸è¿‡å»ºè®®é€‰1ï¼Œå› æ­¤å¦‚æœå·¦è¾¹ç°è‰²çš„aåœ¨1æ—è¾¹ï¼Œç›´æ¥æŒ‰å›è½¦å³å¯</p><p><img src="/2021/07/17/Blockbot-beginning/2-2-6.png" alt="2-2-6"></p><p>ç¬¬ä¸‰æ­¥ï¼Œåœ¨é‡Œé¢è¾“å…¥ä¸€ä¸ªyå†æŒ‰å›è½¦ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/2-2-7.png" alt="2-2-7"></p><p>ç¬¬å››æ­¥ï¼šå½“ç°è‰²çš„aåœ¨cqhttpå·¦è¾¹æ—¶ï¼Œå…ˆæŒ‰ç©ºæ ¼ï¼Œç„¶åæŒ‰å›è½¦</p><p><img src="/2021/07/17/Blockbot-beginning/2-2-8.png" alt="2-2-8"></p><p>ç„¶åæˆ‘ä»¬çš„ç›®å½•ä¸‹å°±å¤šäº†ä¸ªæ–‡ä»¶å¤¹ï¼Œæ‰“å¼€çœ‹çœ‹æœ‰è¿™äº›ä¸œè¥¿ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/2-2-9.png" alt="2-2-9"></p><h3 id="2o03-é…ç½®Gocq"><a href="#2o03-é…ç½®Gocq" class="headerlink" title="2o03 é…ç½®Gocq"></a>2o03 é…ç½®Gocq</h3><p>è®¿é—®æˆªå›¾ä¸­çš„ç½‘å€ä¸‹è½½ï¼Œä¸‹è½½go-cqhttp_windows_amd64.exe,19.9Mçš„é‚£ä¸ª</p><p><img src="/2021/07/17/Blockbot-beginning/2-3-1.png" alt="2-3-1"></p><p>ç„¶åexeä¸‹è½½å¥½åï¼Œåœ¨exampleå¤–é¢å»ºç«‹ä¸€ä¸ªgocqï¼Œå°†ä¸‹è½½ä¸‹æ¥çš„exeæ”¾è¿›å»</p><p><img src="/2021/07/17/Blockbot-beginning/2-3-2.png" alt="2-3-2"></p><p>ç„¶åæŠŠè¯¥exeåœ¨cmdä¸­è¿è¡Œã€‚å¦‚æœå®ƒè®©ä½ è¾“æ•°å­—çš„è¯ï¼Œåªè¾“å…¥ä¸€ä¸ª<code>3</code>å°±è¡Œäº†ï¼</p><p><img src="/2021/07/17/Blockbot-beginning/2-3-3.png" alt="2-3-3"></p><p>ç„¶åä¸‹é¢å°±è¦æ³¨æ„äº†ï¼Œæ‰“å¼€æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰ä¸ª<code>config.yml</code>æ–‡ä»¶ï¼Œç”¨VSCodeæ‰“å¼€ã€‚ç„¶ååœ¨æœ€å‰é¢çš„æŒ‡å®šä½ç½®è¾“å…¥ä½ çš„æœºå™¨äººçš„QQè´¦å·ï¼Œå¯†ç ä¿æŒç©ºç€</p><p><img src="/2021/07/17/Blockbot-beginning/2-3-4.png" alt="2-3-4"></p><p>ç„¶ååœ¨æœ€åçš„ws-reverseä¸€æ é‡Œçš„å†…å®¹æ”¹æˆè¿™ä¸ªæ ·å­ï¼Œä¿å­˜å³å¯ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/2-3-5.png" alt="2-3-5"></p><p>ç„¶åæ‰€æœ‰è¯¥é…ç½®çš„å†…å®¹æˆ‘ä»¬å°±éƒ½é…ç½®å¥½äº†ã€‚</p><h3 id="2o04-å¯åŠ¨bot"><a href="#2o04-å¯åŠ¨bot" class="headerlink" title="2o04 å¯åŠ¨bot"></a>2o04 å¯åŠ¨bot</h3><p>é‡å¯gocqï¼Œç¬¬ä¸€æ¬¡è¿è¡Œéœ€è¦æ‰«ç ç™»å½•</p><p><img src="/2021/07/17/Blockbot-beginning/2-4-1.png" alt="2-4-1"></p><p>ç™»å½•æˆåŠŸåœºæ™¯ã€‚æ­¤æ—¶å¦‚æœæŒ‚ç€è‚¯å®šä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿˜æœ‰ä¸ªä¸œè¥¿æ²¡å¼€</p><p><img src="/2021/07/17/Blockbot-beginning/2-4-2.png" alt="2-4-2"></p><p>å†å¼€ä¸€ä¸ªcmdï¼Œè¿›å…¥exampleæ–‡ä»¶å¤¹ï¼Œç„¶åç»™å‘½ä»¤<code>nb run</code></p><p><img src="/2021/07/17/Blockbot-beginning/2-4-3.png" alt="2-4-3"></p><p>å¦‚æœå‡ºç°acceptedçš„å­—æ ·ï¼Œå¹¶ä¸”æˆ‘ä»¬å¼€çš„ç¬¬ä¸€ä¸ªcmdä¸å†å‡ºç°æ–°çš„â€æ— æ³•è¿æ¥â€çš„æŠ¥é”™ï¼Œè¯´æ˜æ­¤æ—¶å·²ç»å¥½äº†ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/2-4-4.png" alt="2-4-4"></p><p>ç§èŠæˆ–è€…åœ¨ç¾¤é‡Œ@æœºå™¨äºº å‘é€<code>/echo hello world</code>ï¼Œé‚£æˆ‘ä»¬å°±æœ‰ç¬¬ä¸€æ¬¡å¯¹è¯äº†ã€‚</p><p><img src="/2021/07/17/Blockbot-beginning/2-4-5.jpg" alt="2-4-5"></p><h2 id="0x03-æœºå™¨äººæ’ä»¶å¼€å‘"><a href="#0x03-æœºå™¨äººæ’ä»¶å¼€å‘" class="headerlink" title="0x03 æœºå™¨äººæ’ä»¶å¼€å‘"></a>0x03 æœºå™¨äººæ’ä»¶å¼€å‘</h2><p>æ’ä»¶æ¨¡æ¿ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> nonebot <span class="hljs-keyword">import</span> on_command<br><span class="hljs-keyword">from</span> nonebot.rule <span class="hljs-keyword">import</span> to_me<br><span class="hljs-keyword">from</span> nonebot.typing <span class="hljs-keyword">import</span> T_State<br><span class="hljs-keyword">from</span> nonebot.adapters <span class="hljs-keyword">import</span> Bot, Event<br><br>weather = on_command(<span class="hljs-string">&quot;å¤©æ°”&quot;</span>, rule=to_me(), priority=<span class="hljs-number">5</span>)<br><br><br><span class="hljs-meta">@weather.handle()</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_first_receive</span>(<span class="hljs-params">bot: Bot, event: Event, state: T_State</span>):<br>    args = <span class="hljs-built_in">str</span>(event.get_message()).strip()  <span class="hljs-comment"># é¦–æ¬¡å‘é€å‘½ä»¤æ—¶è·Ÿéšçš„å‚æ•°ï¼Œä¾‹ï¼š/å¤©æ°” ä¸Šæµ·ï¼Œåˆ™argsä¸ºä¸Šæµ·</span><br>    <span class="hljs-keyword">if</span> args:<br>        state[<span class="hljs-string">&quot;city&quot;</span>] = args  <span class="hljs-comment"># å¦‚æœç”¨æˆ·å‘é€äº†å‚æ•°åˆ™ç›´æ¥èµ‹å€¼</span><br><br><br><span class="hljs-meta">@weather.got(<span class="hljs-params"><span class="hljs-string">&quot;city&quot;</span>, prompt=<span class="hljs-string">&quot;ä½ æƒ³æŸ¥è¯¢å“ªä¸ªåŸå¸‚çš„å¤©æ°”å‘¢ï¼Ÿ&quot;</span></span>)</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_city</span>(<span class="hljs-params">bot: Bot, event: Event, state: T_State</span>):<br>    city = state[<span class="hljs-string">&quot;city&quot;</span>]<br>    <span class="hljs-keyword">if</span> city <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> [<span class="hljs-string">&quot;ä¸Šæµ·&quot;</span>, <span class="hljs-string">&quot;åŒ—äº¬&quot;</span>]:<br>        <span class="hljs-keyword">await</span> weather.reject(<span class="hljs-string">&quot;ä½ æƒ³æŸ¥è¯¢çš„åŸå¸‚æš‚ä¸æ”¯æŒï¼Œè¯·é‡æ–°è¾“å…¥ï¼&quot;</span>)<br>    city_weather = <span class="hljs-keyword">await</span> get_weather(city)<br>    <span class="hljs-keyword">await</span> weather.finish(city_weather)<br><br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span></span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;city&#125;</span>çš„å¤©æ°”æ˜¯...&quot;</span><br></code></pre></td></tr></table></figure><p>æ‰“å¼€æˆ‘ä»¬çš„exampleæœºå™¨äººç›®å½•ï¼Œç„¶åå‘ç°é‡Œé¢è¿˜æœ‰ä¸ªexampleï¼Œå†æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å¤¹è¿˜æœ‰ä¸ªpluginsï¼Œå°†è¿™ä¸ªä»£ç ä¿å­˜æˆpyæ–‡ä»¶ï¼Œæ‹–å…¥å°±å¯ä»¥ç”¨äº†ã€‚</p><p>å¯ä»¥çœ‹åˆ°åŠ è½½äº†weatherçš„æ’ä»¶</p><p><img src="/2021/07/17/Blockbot-beginning/3-1-1.png" alt="3-1-1"></p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„botå°±å¯ä»¥æŒ‰ç…§é‡Œé¢çš„ç®—æ³•æ¥åšäº‹äº†ã€‚å½“ç„¶ï¼Œä»¥è¿™ä¸ªæ’ä»¶ä¸ºæ¨¡æ¿ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å‘æ›´å¤šçš„æ’ä»¶ã€‚</p><p><font color="red"><strong>ä¸€å®šè¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰stringç±»å‹çš„ä¸œè¥¿æ‰èƒ½è¢«å‘é€å‡ºå»ï¼Œå¦‚æœä¸æ˜¯stringç±»å‹ï¼ˆæ¯”å¦‚æƒ³å‘é€æ•°å­—ï¼‰è¦å…ˆè½¬æˆstringç±»å‹ï¼ç„¶åæ‰èƒ½å‘å‡ºå»ï¼</strong></font></p><p><img src="/2021/07/17/Blockbot-beginning/3-1-2.jpg" alt="3-1-2"></p>]]></content>
    
    
    <categories>
      
      <category>SelfSkills</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Skills</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>An Interesting Problem-RSAOS</title>
    <link href="/2021/07/15/An-Interesting-Problem-RSAOS/"/>
    <url>/2021/07/15/An-Interesting-Problem-RSAOS/</url>
    
    <content type="html"><![CDATA[<h1 id="An-Interesting-Problem-RSAOS"><a href="#An-Interesting-Problem-RSAOS" class="headerlink" title="An Interesting Problem - RSAOS"></a>An Interesting Problem - RSAOS</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>æœ€è¿‘è‡ªå·±åœ¨BUUä¸Šé¢åˆ·é¢˜çš„æ—¶å€™å‘ç°äº†ä¸€ä¸ªå¾ˆå¥½ç©çš„é¢˜ç›®â€”â€”RSAOSï¼Œè™½ç„¶åšé¢˜è¿‡ç¨‹ä¸­è¿˜æ˜¯ç„äº†å‡ çœ¼wpï¼ˆå› ä¸ºè‡ªå·±å¤ªèœäº†ï¼‰ï¼Œä½†è¿˜æ˜¯å†³å®šè·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹â€”â€”å› ä¸ºç¡®å®éå¸¸çš„å¥½ç©</p><p>7æœˆ14æ—¥ï¼ŒBUUCTFä¸Šäº†5000åˆ†ï¼Œä»¥åè¿˜è¦ç»§ç»­åŠªåŠ›ã€‚</p><h2 id="Part-1-Beginning"><a href="#Part-1-Beginning" class="headerlink" title="Part 1 Beginning"></a>Part 1 Beginning</h2><img src="/2021/07/15/An-Interesting-Problem-RSAOS/1.png" alt="1" style="zoom:80%;"><p>é¢˜ç›®ä»€ä¹ˆé™„ä»¶éƒ½æ²¡æœ‰ç»™ï¼Œå°±æ˜¯ä¸€ä¸ªæ™®æ™®é€šé€šçš„è¿œç¨‹é¢˜ç›®ï¼Œç›´æ¥æ‰“å¼€è™šæ‹Ÿæœºè¿œç¨‹è¿æ¥ä¸Šå»ï¼ˆ</p><p>ç„¶åè¿œç¨‹è¿æ¥ä¸Šå»ä¹‹åï¼Œä¼¼ä¹ä»€ä¹ˆä¸œè¥¿éƒ½æ²¡æœ‰ï¼ˆï¼Œå¹¶æ²¡æœ‰è®©ä½ è¾“å‡ºä»€ä¹ˆ<code>sha256</code>éªŒè¯çš„ï¼Œä¹Ÿæ²¡æœ‰è¾“å‡ºä»€ä¹ˆRSAå¿…è¦çš„$c,e,n$çš„å¿…è¦è§£å¯†æ¡ä»¶ã€‚éšä¾¿è¾“å…¥ä¸€ä¸ª<code>e</code>ï¼Œ<code>n</code>ï¼Œ<code>ls</code>ä¹‹ç±»çš„ä¸œè¥¿éƒ½æ˜¾ç¤ºâ€Commond Not Foundâ€ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/2.png" alt="2" style="zoom:80%;"><p>è¿™å°±æ˜¯ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„ç©æ„äº†â€”â€”ä¸ä»…æ²¡æœ‰æºç ï¼Œè¿˜æ²¡ç»™ä»€ä¹ˆå…¶ä»–çš„ä¸œè¥¿ï¼ˆ</p><p><del>äºæ˜¯æœ¬fwæ¯«ä¸è¦è„¸åœ°å»ç„äº†ä¸€çœ¼è¿™é“é¢˜çš„wp</del>ï¼ŒåŸæ¥ç¬¬ä¸€æ­¥è¦å…ˆè¾“å…¥helpè·å–èœå•â€”â€”è¡Œå§ï¼Œæ€ªæˆ‘è‡ªå·±æ²¡æœ‰å¼€å‘ç»éªŒï¼Œè°å«è‡ªå·±æ˜¯ä¸€ä¸ªè¿æœºå™¨äººéƒ½é…ä¸å¥½çš„fwå‘¢?ä¸‹äº¿æ¬¡æˆ‘æ‹¿åˆ°ä¸€ä¸ªæœªçŸ¥çš„ç³»ç»Ÿä¸€å®šè¦å…ˆè¾“ä¸€ä¸‹<code>help</code>æˆ–è€…<code>menu</code>ç­‰åŠŸèƒ½æ€§å‘½ä»¤ï¼Œ<del>ï¼ˆæ‹¿å°æœ¬æœ¬è®°ä¸‹æ¥</del></p><p>è¾“å…¥äº†helpä¹‹åï¼Œä¼¼ä¹å¾ˆå¤šäº‹æƒ…å°±å¥½èµ·æ¥äº†ï¼ˆï¼Œå¾—åˆ°äº†ä¸€è¿ä¸²çš„å‘½ä»¤â€”â€”</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/3.png" alt="3" style="zoom:80%;"><h2 id="Part-2-Attempt-1"><a href="#Part-2-Attempt-1" class="headerlink" title="Part 2 Attempt 1"></a>Part 2 Attempt 1</h2><p><del>ä¹±æé˜¶æ®µ</del></p><p>å¾ˆæ˜¾ç„¶ï¼Œè¦è¾“å…¥<code>get-flag</code>æˆ–è€…<code>get-privatekey</code>ï¼Œæˆ‘ä»¬æ‰èƒ½è·å¾—æœ€ç»ˆç­”æ¡ˆã€‚å› æ­¤å…ˆè¾“ä¸€ä¸‹get-flagæ¥çœ‹çœ‹éœ€è¦ä»€ä¹ˆæ¡ä»¶ï¼ˆ</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/4.png" alt="4" style="zoom:80%;"><p>ç„¶åå®ƒç»™æˆ‘å†’å‡ºæ¥äº†ä¸€ä¸ªä»€ä¹ˆfoldhashçš„ä¸œè¥¿ï¼ˆçœ‹æ¥è¿™ç©æ„è¿˜æ˜¯æœ‰ç‚¹ä¸œè¥¿çš„ã€‚å¯èƒ½æƒé™å‘½ä»¤éœ€è¦æŸä¸ªå¯†ç æ‰èƒ½å®Œæˆå§â€”â€”è¦è®°ä½è¿™æ˜¯Cryptoé¢˜ç›®ä¸æ˜¯Pwn&#x2F;Reé¢˜ç›®ï¼Œä¼°è®¡å…¶ä»–çš„å†…å®¹ä¸ä¼šå¾ˆéš¾</p><p>è¾“å…¥<code>get-publickey</code>ï¼ŒæœåŠ¡å™¨è¿”å›äº†è¿™æ ·ä¸€ä¸ªä¸œè¥¿ï¼š<del>è²Œä¼¼é‡è¿å‡ éå†…å®¹ä¸€ç›´ä¸å˜</del></p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-keyword">Public</span> <span class="hljs-keyword">key</span> parameters:<br><span class="hljs-symbol">N:</span> <span class="hljs-number">0</span>xd888075370effdb016d85de8c894ee7ac2764527210d8ce1d8bd14a06c67de148b4680781366002f9649e3885e18ab950120c660970ab9a499ea74ea7aa38fe732940b5204300ef7b96a608efec1a74007a4b1d592cf9eb23890d8fa416202857d0e0f9ebad79324d03d09db0502ff4bae0b2dfc0b150ddea806a5ff24e2d32f<br><span class="hljs-symbol">E:</span> <span class="hljs-number">0</span>x10001<br></code></pre></td></tr></table></figure><p><code>duck</code>ä¸å¿…ç®¡é‚£ä¹ˆå¤šï¼Œæˆ–è®¸å…¶ä»–çš„ä¸œè¥¿åº”è¯¥è¯•è¯•çœ‹ï¼ˆï¼Œæ¯”å¦‚æ²¡è¯•è¿‡çš„å‘½ä»¤éƒ½å°è¯•æ—¥ä¸€éçœ‹çœ‹ï¼ˆï¼Œå°¤å…¶æ˜¯è¿™ä¸ªdebugï¼Œæˆ‘çœ‹ä½ å¾ˆä¸å¯¹åŠ²[ä¸¥è‚ƒ]</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/5.png" alt="5" style="zoom:80%;"><p>æœç„¶debugè¿™è¾¹ç¡®å®æœ‰ä»€ä¹ˆç„æœºåœ¨é‡Œé¢ï¼æˆ–è®¸æˆ‘ä»¬åº”å½“enableä¸€ä¸‹è¿™ä¸ªdebugæ‰å¯¹</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/6.png" alt="6" style="zoom:80%;"><p>æœç„¶åœ¨<code>debug enable</code>ä¹‹åï¼Œä¼¼ä¹æ¯æ¬¡è¾“å‡ºå‘½ä»¤éƒ½ä¼šç»™ä½ ä¸€ä¸ªä»€ä¹ˆ<code>DBG-CRC32() SIG()</code>çš„æ¨¡å¼ã€‚ä¸è¿‡è¿™ä¸ªç©¶ç«Ÿæ˜¯ä»€ä¹ˆä¸œè¥¿å•Šï¼ˆ</p><p>ç™¾åº¦äº†ä¸€ä¸‹ï¼ŒåŸæ¥<code>CRC32()</code>æ˜¯ä¸€ä¸ª$32$ä¸ªæ¯”ç‰¹ä½çš„å“ˆå¸Œå€¼ï¼Œè€Œ<code>SIG</code>æ˜¯ç­¾åç»“æœã€‚</p><p>ä¸è¿‡è¿™ä¸ªæ—¶å€™è‡ªå·±çš„å‘å±•åˆé™·å…¥åƒµå±€ã€‚ã€‚ã€‚ã€‚<del>ï¼ˆäºæ˜¯å†ä¸€æ¬¡ç„äº†çœ¼åˆ«äººçš„wpï¼‰</del></p><p>ç»“æœå‘ç°è¿™æ˜¯ä¸ªè„‘æ´é¢˜â€”â€”åŸæ¥helpåé¢è¿˜å¯ä»¥è·Ÿä¸Šå‘½ä»¤åç§°æ¥å‘Šè¯‰ä½ è¿™ä¸ªå‘½ä»¤ç©¶ç«Ÿæ˜¯å¹²ä»€ä¹ˆç”¨çš„</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/7.png" alt="7" style="zoom:80%;"><p>åœ¨<code>help security</code>è¿™è¾¹ï¼Œæˆ‘ä»¬å‘ç°äº†æ¯”è¾ƒæœ‰ä»·å€¼çš„ä¿¡æ¯ï¼š</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/8.png" alt="8" style="zoom:80%;"><p>ç®€å•ç¿»è¯‘ä¸€ä¸‹å¹¶æ¦‚æ‹¬ï¼Œå·®ä¸å¤šæ˜¯è¿™ä¸¤æ¡å†…å®¹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>.éç‰¹æƒå‘½ä»¤çš„ç­¾åå†…å®¹æ˜¯å¯¹ä½ è¾“å…¥å†…å®¹çš„CRC32è¿›è¡Œç­¾åï¼Œè€Œç‰¹æƒå‘½ä»¤çš„ç­¾åå†…å®¹æ˜¯å…¶FoldHashè¿›è¡Œç­¾åçš„å†…å®¹<br><span class="hljs-attribute">2</span>.FoldHashæ˜¯é€šè¿‡è¾“å…¥å†…å®¹sha1è·å¾—çš„<span class="hljs-number">160</span>ä¸ªæ¯”ç‰¹ä½çš„å‰<span class="hljs-number">80</span>ä¸ªå’Œå<span class="hljs-number">80</span>æ¯”ç‰¹ä½å¼‚æˆ–åå¾—åˆ°çš„ç»“æœ<br><span class="hljs-attribute">3</span>.æ¯æ¬¡ç»™å‡ºçš„ç­¾åå’ŒCRC32çš„å€¼æ˜¯ä¸€æ•´è¡Œçš„å†…å®¹ï¼Œå¦‚æœå‘½ä»¤ä¸­æœ‰ç©ºæ ¼ï¼Œé‚£ä¹ˆæœ€åå®é™…æ‰§è¡Œçš„å†…å®¹ä»…ä»…æ˜¯ç¬¬ä¸€ä¸ªå‘½ä»¤(argument)<br></code></pre></td></tr></table></figure><p>ç»è¿‡æŸ¥è¯¢ï¼ŒCRC32æ˜¯ä¸€ç§hashæ–¹æ³•ï¼Œå…¶hashåå–å€¼èŒƒå›´æ˜¯$0$åˆ°$2^{32}-1$ï¼Œè¯¥æ–¹æ³•å“ˆå¸Œå†²çªç‡æ¯”è¾ƒé«˜ã€‚</p><h2 id="Part-3-Analyzation"><a href="#Part-3-Analyzation" class="headerlink" title="Part 3 Analyzation"></a>Part 3 Analyzation</h2><p>äºæ˜¯ä¹±æåˆ°è¿™é‡Œå·®ä¸å¤šå¯ä»¥ç»“æŸäº†ï¼ˆï¼Œå¾—æ­£å¼åœ°åšé¢˜äº†ï¼ˆ</p><p>é¦–å…ˆå…ˆæ¥å›é¡¾ä¸€ä¸‹ä¸€ä¸‹RSAçš„æ•°å­—ç­¾å</p><p>ç­¾åæ–¹å¼ï¼š<br>$$<br>\mathrm{SIG}(x)\equiv x^d \pmod n<br>$$<br>éªŒè¯æ–¹å¼ï¼š<br>$$<br>\mathrm{Verify}(x)\equiv \mathrm{SIG}^e(x)\pmod n<br>$$<br>å¾ˆæ˜¾ç„¶ï¼Œç”¨äºéªŒè¯çš„å†…å®¹æ—¶ç§é’¥ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°è¯•ä¼ªé€ ä¸€ä¸ªç­¾åæ‰å¯ä»¥å®Œæˆã€‚</p><p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œä¸éš¾åˆ†æå‡ºå…¶<code>foldhash</code>çš„åŸç†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">foldhash</span>(<span class="hljs-params">s</span>):<br>    s=sha1(s.encode()).digest()<br>    a,b=bytes_to_long(s[:<span class="hljs-number">10</span>]),bytes_to_long(s[<span class="hljs-number">10</span>:])<br>    <span class="hljs-keyword">return</span> a^^b<br><span class="hljs-comment"># Different from Python: in Sagemath, ^^ means xor and ^ means power</span><br></code></pre></td></tr></table></figure><p>å…³æ³¨åˆ°foldhashå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•°å­—ï¼ŒCRC32ä¹Ÿæ˜¯ä¸€ä¸ªæ•°å­—ï¼Œåªä¸è¿‡foldhashçš„æ¯”ç‰¹ä½æ˜¯$80$ï¼Œè€ŒCRC32çš„ç»“æœæ˜¯$32$ä½ã€‚å¦‚æœä½¿ç”¨ç‰¹æƒå‘½ä»¤ï¼Œé‚£ä¹ˆä½ éœ€è¦æå‡ºä½ è¾“å…¥çš„<strong>é‚£ä¸€è¡Œå†…å®¹</strong>çš„æ•°å­—ç­¾åã€‚</p><p><strong>æ³¨æ„åˆ°ä¸Šé¢åˆ†æçš„ç¬¬ä¸‰æ¡</strong>ï¼Œæš—ç¤ºç€æˆ‘ä»¬å¯ä»¥åœ¨ç‰¹æƒå‘½ä»¤åé¢åŠ ä¸€ä¸‹ä¸œè¥¿ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°å¿…è¦çš„ç‰¹æƒå‘½ä»¤foldhashçš„ç­¾åäº†ï¼Œä¹Ÿå°±æ˜¯ç‰¹æƒå‘½ä»¤çš„$\mathrm{foldhash}(x)\equiv x^d \pmod n$çš„å€¼ã€‚</p><p>ä¸è¿‡æˆ‘ä»¬è¿™è¾¹æœ‰ä¸ªé—®é¢˜æ¥äº†ï¼š$x$æ˜¯$80$ä½çš„å†…å®¹ï¼Œä½†CRC32æœ€åæ˜¯$32$ä½å†…å®¹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶æ ¼å¼ä¸º<code>&quot;get-flag &quot;+padding</code>ï¼Œä½¿å¾—è¯¥å­—ç¬¦ä¸²çš„foldhashå€¼æ»¡è¶³$\mathrm{FFFFFFFFH}$å…‰æ»‘ï¼Œæœ€åæ ¹æ®<strong>RSAçš„åŒæ€æ€§</strong>å°†æ‰€æœ‰SIGå€¼ç›¸ä¹˜åå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å†…å®¹äº†</p><p>æœç„¶ï¼Œ<del>ç„äº†ä¸€çœ¼WP</del>ï¼ŒWPä¹Ÿæ˜¯è¿™ä¹ˆå†™çš„ï¼Œä¸è¿‡ä»–ç›´æ¥ç”¨çš„<code>get-flag 0</code>ï¼Œè¯¥å‘½ä»¤çš„foldhashçš„å€¼ä¸º$637185588446528046742504$ã€‚å…¶åˆ†è§£è´¨å› æ•°ç»“æœä¸ºï¼š<br>$$<br>637185588446528046742504&#x3D;2^3Ã—250091Ã—244079963Ã—1304805461<br>$$<br>ä¸è¿‡ç›´æ¥æŠ„wpè‚¯å®šæ˜¯æ²¡æ„æ€çš„ï¼Œä½†é—®é¢˜æ˜¯è¿™ä¸ª<code>get-flag 0</code>çœŸçš„è¿™ä¹ˆå¥½æ„é€ å‡ºæ¥å—ï¼Ÿäºæ˜¯æˆ‘åœ¨Sagemathä¸­æµ‹è¯•äº†ä»¥ä¸‹ä»£ç ï¼Œéšæœºåœ¨å­—ç¬¦ä¸²<code>get flag </code>åé¢å¡«å……$8$ä½åå…­è¿›åˆ¶æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha1<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">foldhash</span>(<span class="hljs-params">s</span>):<br>    s=sha1(s.encode()).digest()<br>    a,b=bytes_to_long(s[:<span class="hljs-number">10</span>]),bytes_to_long(s[<span class="hljs-number">10</span>:])<br>    <span class="hljs-keyword">return</span> a^^b<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padding</span>(<span class="hljs-params">s,n</span>):<br>    TABLE=<span class="hljs-string">&quot;abcdef0123456789&quot;</span><br>    t=<span class="hljs-string">&quot; &quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        t+=choice(TABLE)<br>    <span class="hljs-keyword">return</span> s+t<br>NUMBERS=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    NUMBERS+=<span class="hljs-number">1</span><br>    s=padding(<span class="hljs-string">&quot;get-flag&quot;</span>,<span class="hljs-number">8</span>)<br>    q=foldhash(s)<br>    li=<span class="hljs-built_in">list</span>(factor(q))<br>    <span class="hljs-keyword">if</span>(li[-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]&lt;=<span class="hljs-number">0xffffffff</span>):<br>        <span class="hljs-built_in">print</span>(s)<br>        <span class="hljs-built_in">print</span>(q)<br>        <span class="hljs-built_in">print</span>(li)<br>        <span class="hljs-built_in">print</span>(NUMBERS)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>ä¸‹å›¾æ˜¯ä¸€æ¬¡è¿è¡Œç»“æœã€‚</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/9.png" alt="9" style="zoom:80%;"><p>äºæ˜¯æˆ‘æ„é€ äº†ä¸€ä¸ªä¸åŒå¹¶ä¸”æ›´ç®€å•çš„å­—ç¬¦ä¸²ï¼š<code>get-flag 8c5fdf74</code>ï¼Œå…¶foldhashå€¼ä¸º$123923881117703856573281$ï¼Œè´¨å› æ•°åˆ†è§£ç»“æœä¸º$2719Ã—574657Ã—931169Ã—85174303$ï¼Œéšæœºç”Ÿæˆäº†$5$æ¬¡åå¾—åˆ°äº†è¿™ä¸ªç»“æœã€‚</p><p>ç„¶åæˆ‘åˆé‡å¤è¿è¡Œäº†è¿™ä¸ªä»£ç æ•°æ¬¡ï¼Œå‘ç°æœ€å¤šçš„ä¸€æ¬¡ä¸º$21$æ¬¡å°è¯•è·å¾—ç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²ï¼Œæœ€å°‘ä¸€æ¬¡å¯ä»¥ä¸€å‘å‘½ä¸­ç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²ï¼Œå¹³å‡å¤§æ¦‚$6$åˆ°$7$æ¬¡å·¦å³çš„å°è¯•å³å¯äº§ç”Ÿç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²â€”â€”è¯´æ˜ç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²å¹¶ä¸éš¾æ‰¾ã€‚</p><p>äºæ˜¯æ‰¾å­—ç¬¦ä¸²è¿™ä¸ªé—®é¢˜å°±è¿™æ ·è§£å†³äº†ã€‚ä¸‹é¢å°±æ˜¯å¯»æ‰¾$4$ä¸ªç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²$s_1,s_2,s_3,s_4$ï¼Œè®©å…¶CRC32å€¼åˆ†åˆ«ä¸º$2719,574657,931169,85174303$â€”â€”çœ‹æ¥è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªæœ‰éš¾åº¦çš„äº‹æƒ…ã€‚</p><p>å®é™…ä¸Šæšä¸¾$6$ä½å†…å®¹çš„å¯è§å­—ç¬¦ä¸²åœ¨åŸåˆ™ä¸Šæ˜¯å¯è¡Œçš„ã€‚ä¸è¿‡githubä¸Šè¿˜æ˜¯èƒ½æ‰¾åˆ°ä¸€ä¸ªåŒ…ï¼ˆ[æˆ³è¿™é‡Œ](<a href="https://github.com/theonlypwner/crc32">theonlypwner&#x2F;crc32: CRC32 tools: reverse, undo&#x2F;rewind, and calculate hashes (github.com)</a>)ï¼‰ï¼Œç›´æ¥ä¸‹è½½å³å¯ã€‚</p><h2 id="Part-4-Attempt-2"><a href="#Part-4-Attempt-2" class="headerlink" title="Part 4 Attempt 2"></a>Part 4 Attempt 2</h2><p><del>çœŸæ­£çš„å°è¯•é˜¶æ®µ</del></p><p>é˜…è¯»è¿‡è¿™ä¸ªåŒ…çš„å†…å®¹åï¼Œå¼€å§‹äº†å°è¯•ã€‚</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/10.png" alt="10" style="zoom:80%;"><p>ç„¶åæˆ‘è¿ç»­å‘é€äº†ä¸‰ä¸ªè¿‡å»ï¼Œç»“æœå‘ç°ä¸å¯¹ï¼ˆï¼Œé‚£è¾¹çš„éªŒè¯ç»“æœæ˜¯<code>0xe0db37ee</code>ã€‚è¿™ä¸¤ä¸ªå†…å®¹ä¹‹é—´æ˜¯ä¸æ˜¯æœ‰ä»€ä¹ˆè”ç³»åœ¨é‡Œé¢å•Šï¼ˆ</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/11.png" alt="11" style="zoom:80%;"><p>é‚£æˆ‘æ‰¾ä¸ª<code>0xe0db37ee</code>çš„å€¼å‘è¿‡å»è¯•è¯•çœ‹å‘¢ï¼Ÿ</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/12.png" alt="12" style="zoom:80%;"><p>æœç„¶ï¼Œæœ€åçš„ç»“æœæ˜¯æ­£ç¡®çš„ï¼Œæ­¤æ—¶è®°å½•ä¸‹ç­¾åç»“æœ</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/13.png" alt="13" style="zoom:80%;"><p>äºæ˜¯é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å¾—å¦å¤–ä¸‰ä¸ªçš„å†…å®¹äº†ï¼ˆ</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/14.png" alt="14" style="zoom:80%;"><p>å°†å¾—åˆ°çš„$4$ä¸ªSIGä¹˜èµ·æ¥æ¨¡$n$ï¼Œè·å¾—æœ€ç»ˆçš„ç»“æœã€‚å‘é€è¿‡å»å¾—åˆ°flagã€‚</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/15.png" alt="15" style="zoom:80%;"><h2 id="5-More-Exploration"><a href="#5-More-Exploration" class="headerlink" title="5.More Exploration"></a>5.More Exploration</h2><p>æå‡ºæ¥flagä¹‹åï¼Œæœ¬fwå¾ˆå½¢è±¡å†å»çœ‹çœ‹å¦å¤–ä¸¤ä¸ªå‘½ä»¤æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œäºæ˜¯å†³å®šå¦‚æ³•ç‚®åˆ¶ä¼ªé€ å­—ç¬¦ä¸²</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„å­—ç¬¦ä¸²å¦‚ä¸‹ï¼š</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/16.png" alt="16" style="zoom:80%;"><p>æ ¹æ®ä¸Šé¢çš„å†…å®¹å¯ä»¥è·å¾—å…¶ç§é’¥ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">N</span>: <span class="hljs-number">0</span>xd888075370effdb016d85de8c894ee7ac2764527210d8ce1d8bd14a06c67de148b4680781366002f9649e3885e18ab950120c660970ab9a499ea74ea7aa38fe732940b5204300ef7b96a608efec1a74007a4b1d592cf9eb23890d8fa416202857d0e0f9ebad79324d03d09db0502ff4bae0b2dfc0b150ddea806a5ff24e2d32f<br><span class="hljs-attribute">E</span>: <span class="hljs-number">0</span>x10001<br><span class="hljs-attribute">P</span>: <span class="hljs-number">0</span>xf0d4aa4868305cdbabba679014f940c0233ca0b10c9db62e3d829dd289103b21143da614b361c6043711956ff2ffd3bf7dcea0418a1e0bbf74784512f99733cd<br><span class="hljs-attribute">Q</span>: <span class="hljs-number">0</span>xe62b8ad7f10d9921a3be7b0c74a81107b5fa704900f94028c6a6e401a00729f6ed961dabbc65878ba5b7f34ca406c7b27577fe5153909d036ecf7e028b555eeb<br><span class="hljs-attribute">D</span>: <span class="hljs-number">0</span>x77de15f0233d37fb1b2a7c1239b7f8ad0ca9dc6e64e5d36fd34418ff160409f4e58509e96f13b056a7a40fc9960da22ec2891a48ae54c9a04d747574b89f83313d1902224cb7e90bf74a30a6e0201e3081c33ea14786adec8f7e05c898f9f55c7e332f7cc7a12263eac1ae60e2122e548207fe3c035e03eaf36798c62c3f6e41<br></code></pre></td></tr></table></figure><p>è€Œsecurityå‘½ä»¤çš„è¾“å‡ºä¸help-securityçš„è¾“å‡ºä¸€æ¨¡ä¸€æ ·ã€‚ã€‚ã€‚</p><h2 id="6-Review"><a href="#6-Review" class="headerlink" title="6.Review"></a>6.Review</h2><p>ä¸€é“å¾ˆå¥½ç©çš„é¢˜ç›®è¿˜æ˜¯å€¼å¾—æŠŠç©ä»¥ä¸‹çš„ï¼Œæ„Ÿè§‰æ”¶è·å¾ˆå¤§ã€‚</p><p>æœ€åé™„ä¸€ä¸‹ç½‘ä¸Šç»™çš„CRC32åŠ å¯†åŸç†ï¼Œä»¥åç ”ç©¶ã€‚</p><img src="/2021/07/15/An-Interesting-Problem-RSAOS/17.png" alt="17" style="zoom:100%;"><img src="/2021/07/15/An-Interesting-Problem-RSAOS/18.png" alt="18" style="zoom:100%;">]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GKCTF2021 WriteUp</title>
    <link href="/2021/07/12/GKCTF2021-WriteUp/"/>
    <url>/2021/07/12/GKCTF2021-WriteUp/</url>
    
    <content type="html"><![CDATA[<h1 id="GKCTF-WriteUp-By-huangx607087"><a href="#GKCTF-WriteUp-By-huangx607087" class="headerlink" title="GKCTF WriteUp By huangx607087"></a>GKCTF WriteUp By huangx607087</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>6æœˆ22æ—¥çš„GKCTFï¼Œç”±äºå¿™äºæœŸæœ«è€ƒè¯•ç›´æ¥æ‘¸äº†ï¼Œ20å¤©åå›æ¥å¤ç°æ¥äº†ã€‚å¥½åœ¨è‡ªå·±æœŸæœ«æ¯é—¨è¯¾éƒ½è¿‡äº†ï¼Œæ­»è€Œæ— æ†¾ã€‚</p><p>è‡ªå·±6æœˆåˆç”³è¯·ç•™ä»»äº†æ ¡ç§‘åå’Œé™¢ç§‘åï¼Œçœ‹æ¥ä»¥åä¸èƒ½å†æ‘¸é±¼äº†ã€‚å¹¶ä¸”å¦‚æœCTFå’Œå¹³æ—¶æ–‡åŒ–è¯¾åŒå¼€çš„è¯ï¼Œåº”è¯¥éš¾åº¦å¹¶ä¸å°ï¼Œ<del>ä¸è¿‡å¸Œæœ›è‡ªå·±å¯ä»¥åšåˆ°</del>ã€‚</p><h2 id="1-GKCTF-2021-Random"><a href="#1-GKCTF-2021-Random" class="headerlink" title="1.[GKCTF 2021]Random"></a>1.[GKCTF 2021]Random</h2><p>é€šè¿‡è§‚å¯Ÿé¢˜ç›®ä»£ç å¯ä»¥çŸ¥é“ï¼Œåˆæ˜¯ä¸€é“å…¸å‹çš„MT19937é¢„æµ‹éšæœºæ•°çš„é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_mask</span>():<br>    file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;random.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">104</span>):<br>        file.write(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">32</span>))+<span class="hljs-string">&quot;\n&quot;</span>)<br>        file.write(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">64</span>))+<span class="hljs-string">&quot;\n&quot;</span>)<br>        file.write(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">96</span>))+<span class="hljs-string">&quot;\n&quot;</span>)<br>    file.close()<br>get_mask()<br>flag = md5(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">32</span>)).encode()).hexdigest()<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ä¸€æ¬¡ç»™å‡ºäº†$104$ç»„æ•°å­—ï¼Œæ¯ç»„æ•°å­—ç”±$32$ä½ã€$64$ä½ã€$96$ä½çš„äºŒè¿›åˆ¶æ•°å„ä¸€ä¸ªã€‚æ¯ä¸€ç»„ç­‰ä»·äº$6$ç»„$32$ä½äºŒè¿›åˆ¶æ•°ï¼Œæ€»å…±$624$ç»„$32$ä½äºŒè¿›åˆ¶æ•°ï¼Œå› æ­¤å¯ä»¥è¿›è¡Œé¢„æµ‹ã€‚</p><p>ä¸è¿‡è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹é¢„æµ‹çš„é¡ºåºï¼Œè®¾ä¸€æ¬¡ç»™å‡ºçš„åˆ†åˆ«æ˜¯$^{32}A,^{64}B,^{96}C$ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¢„æµ‹é¡ºåºåº”è¯¥æ˜¯ï¼š$^{32}A_{[31,0]}$,$^{64}B_{[31,0]}$,$^{64}B_{[63,32]}$,$^{96}C_{[31,0]}$,$^{96}C_{[63,32]}$,$^{96}C_{[95,64]}$ï¼Œå…¶ä¸­$^{64}B_{[31,0]}$è¡¨ç¤º$B$ä¸€å…±æœ‰$64$ä½ï¼Œå–å…¶ä»£è¡¨ç€$2^{31}$åˆ°$2^{0}$çš„æ¯”ç‰¹ä½ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¯¼å…¥ä¸Šä¸€ä¸ªåšå®¢æˆ‘ä»¬æ¢ç©¶å‡ºæ¥çš„åŒ…ã€‚å°†å…¶å‘½åä¸º<code>MT19937tools</code>æ”¾å…¥æˆ‘ä»¬çš„è§£é¢˜æ–‡ä»¶å¤¹ä¸­ï¼Œé€šè¿‡<code>import</code>åˆ°æˆ‘ä»¬çš„è§£é¢˜è„šæœ¬ä¸­æ¥å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> MT19937tools <span class="hljs-keyword">import</span> *<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;random.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>S=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">104</span>):<br>    a32=<span class="hljs-built_in">int</span>(f.readline())<br>    a64=<span class="hljs-built_in">int</span>(f.readline())<br>    a96=<span class="hljs-built_in">int</span>(f.readline())<br>    S.append(a32)<br>    S.append(a64&amp;<span class="hljs-number">0xffffffff</span>)<br>    S.append(a64&gt;&gt;<span class="hljs-number">32</span>)<br>    S.append(a96&amp;<span class="hljs-number">0xffffffff</span>)<br>    S.append((a96&gt;&gt;<span class="hljs-number">32</span>)&amp;<span class="hljs-number">0xffffffff</span>)<br>    S.append(a96&gt;&gt;<span class="hljs-number">64</span>)<br>f.close()<br>D=MT19937(<span class="hljs-number">0</span>)<br>flag= md5(<span class="hljs-built_in">str</span>(D.predict(S)).encode()).hexdigest()<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#14c71fec812b754b2061a35a4f6d8421</span><br></code></pre></td></tr></table></figure><h2 id="2-GKCTF-2021-RRRRsa"><a href="#2-GKCTF-2021-RRRRsa" class="headerlink" title="2.[GKCTF 2021]RRRRsa"></a>2.[GKCTF 2021]RRRRsa</h2><h3 id="Step-1-åˆæ­¥å®¡é¢˜"><a href="#Step-1-åˆæ­¥å®¡é¢˜" class="headerlink" title="Step 1 åˆæ­¥å®¡é¢˜"></a>Step 1 åˆæ­¥å®¡é¢˜</h3><p>æŒ‰ç…§æƒ¯ä¾‹å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ä»£ç ï¼Œç„¶åå°†é¢˜ç›®åé¢ç»™å‡ºæ¥çš„æ‰€æœ‰æ•°æ®æ”¾å…¥<code>given.py</code>æ–‡ä»¶ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> gcd<br>flag = <span class="hljs-string">b&#x27;xxxxxxxxxxxxx&#x27;</span><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>m = bytes_to_long(flag)<br>n = p*q<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c))<br>p1 = getPrime(<span class="hljs-number">512</span>)<br>q1 = getPrime(<span class="hljs-number">512</span>)<br>n1 = p1*q1<br>e1 = <span class="hljs-number">65537</span><br><span class="hljs-keyword">assert</span> gcd(e1,(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)) == <span class="hljs-number">1</span><br>c1 = <span class="hljs-built_in">pow</span>(p,e1,n1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n1=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(n1))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c1=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c1))<br>hint1 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2020</span> * p1 + q1, <span class="hljs-number">202020</span>, n1)<br>hint2 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2021</span> * p1 + <span class="hljs-number">212121</span>, q1, n1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hint1=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(hint1))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hint2=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(hint2))<br>p2 = getPrime(<span class="hljs-number">512</span>)<br>q2 = getPrime(<span class="hljs-number">512</span>)<br>n2 = p2*q2<br>e2 = <span class="hljs-number">65537</span><br><span class="hljs-keyword">assert</span> gcd(e1,(p2-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>)) == <span class="hljs-number">1</span><br>c2 = <span class="hljs-built_in">pow</span>(q,e2,n2)<br>hint3 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2020</span> * p2 + <span class="hljs-number">2021</span> * q2, <span class="hljs-number">202020</span>, n2)<br>hint4 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2021</span> * p2 + <span class="hljs-number">2020</span> * q2, <span class="hljs-number">212121</span>, n2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n2=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(n2))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c2=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c2))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hint3=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(hint3))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hint4=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(hint4))<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ•´ä¸ªè¿‡ç¨‹ä¸­å…ˆåŠ å¯†äº†$\mathrm {flag}$ï¼Œç„¶åå¯¹åŠ å¯†$\mathrm{flag}$çš„$p,q$è¿›è¡Œäº†äºŒæ¬¡åŠ å¯†ã€‚å¯¹äºç¬¬ä¸€ç»„å¼å­æˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>h_1\equiv (2020p_1+q_1)^{202020} \pmod{n_1}<br>$$</p><p>$$<br>h_2\equiv (2021p_1+212121)^{q_1} \pmod {n_1}<br>$$</p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥æ ¹æ®ä»£ç æç‚¼å‡ºç¬¬äºŒç»„å¼å­ï¼š<br>$$<br>h_3\equiv (2020p_2+2021q_2)^{202020} \pmod{n_2}<br>$$</p><p>$$<br>h_4\equiv (2021p_2+2020q_2)^{212121} \pmod {n_2}<br>$$</p><p>é‰´äºç¬¬äºŒç»„å¼å­ç•¥å¾®ç®€å•ä¸€ç‚¹ï¼Œæˆ‘ä»¬å…ˆåŒ–ç®€ç¬¬äºŒç»„å¼å­</p><h3 id="Step-2-ç¬¬äºŒç»„å¼å­çš„åŒ–ç®€"><a href="#Step-2-ç¬¬äºŒç»„å¼å­çš„åŒ–ç®€" class="headerlink" title="Step 2 ç¬¬äºŒç»„å¼å­çš„åŒ–ç®€"></a>Step 2 ç¬¬äºŒç»„å¼å­çš„åŒ–ç®€</h3><p>å¯¹äºç¬¬äºŒç»„å¼å­ï¼š<br>$$<br>h_3\equiv (2020p_2+2021q_2)^{202020} \pmod{n_2}<br>$$</p><p>$$<br>h_4\equiv (2021p_2+2020q_2)^{212121} \pmod {n_2}<br>$$</p><p>æ ¹æ®äºŒé¡¹å¼å®šç†ï¼ŒåŠ ä¸Š$n_2&#x3D;p_2q_2$ï¼Œå¯¹è¿™ä¸¤ä¸ªå¼å­å±•å¼€ï¼Œç”±äºä¸­é—´é¡¹å…¨æ²¡æœ‰äº†ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>h_3\equiv 2020^{202020}p_2^{202020} + 2021^{202020} q_2^{202020}\pmod{n_2}<br>$$</p><p>$$<br>h_4\equiv 2021^{212121}p_2^{212121}+2020^{212121}q_2^{212121}\pmod{n_2}<br>$$</p><p>è®¾$t&#x3D;202020Ã—212121$,é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—åˆ°ï¼š<br>$$<br>h_3^{212121}\equiv 2020^tp_2^t+2021^tq_2^t\pmod{n_2}<br>$$</p><p>$$<br>h_4^{202020}\equiv 2021^tp_2^t +2020^tq_2^t\pmod{n_2}<br>$$</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥ç»§ç»­å¾—åˆ°<br>$$<br>2021^th_3^{212121} \equiv 2020^t2021^tp_2^t+2021^{2t}q_2^t\pmod{n_2}<br>$$</p><p>$$<br>2020^{t}h_4^{202020}\equiv 2020^t2021^tp_2^t+2020^{2t}q_2^t \pmod{n_2}<br>$$</p><p>ä¸¤å¼ç›¸å‡ï¼Œå¾—<br>$$<br>2021^th_3^{212121}-2020^{t}h_4^{202020} \equiv 2021^{2t}q_2^t-2020^{2t}q_2^t&#x3D;(2021^{2t}-2020^{2t})q_2^t \pmod {n_2}<br>$$<br>å¯ä»¥çœ‹å‡ºè¿™ä¸ªæ•°å­—è‚¯å®šæ˜¯$q_2$çš„å€æ•°ï¼Œå°†å…¶è®°ä¸º$kq_2$,ç”±äº$n_2&#x3D;p_2q_2$ï¼Œä¸”$p_2,q_2$å‡ä¸ºç´ æ•°ï¼Œå› æ­¤å¯ä»¥å¾—åˆ°$\gcd(n,kq_2)&#x3D;q_2$ï¼Œè¿›è€Œåˆ†è§£$n_2$ï¼Œè§£å¯†åå¾—åˆ°$q$ã€‚</p><h3 id="Step-3-ç¬¬ä¸€ç»„å¼å­çš„åŒ–ç®€"><a href="#Step-3-ç¬¬ä¸€ç»„å¼å­çš„åŒ–ç®€" class="headerlink" title="Step 3 ç¬¬ä¸€ç»„å¼å­çš„åŒ–ç®€"></a>Step 3 ç¬¬ä¸€ç»„å¼å­çš„åŒ–ç®€</h3><p>æˆ‘ä»¬å†å›è¿‡æ¥çœ‹ä¸€ä¸‹ç¬¬ä¸€ç»„å¼å­ï¼š<br>$$<br>h_1\equiv (2020p_1+q_1)^{202020} \pmod{n_1}<br>$$</p><p>$$<br>h_2\equiv (2021p_1+212121)^{q_1} \pmod {n_1}<br>$$</p><p>æ ¹æ®äºŒé¡¹å¼å®šç†ï¼Œå¾ˆå®¹æ˜“å°†ç¬¬ä¸€ä¸ªå¼å­åŒ–ç®€<br>$$<br>h_1\equiv 2020^{202020}p_1^{202020}+q_1^{202020}\pmod {n_1}<br>$$<br>ä½†å¯¹äºç¬¬äºŒä¸ªå¼å­ï¼Œå±•å¼€åŒ–ç®€å¾ˆæ˜¾ç„¶æ˜¯ä¸å¤ªå¯èƒ½çš„äº‹æƒ…</p><p>ç”±äº$n_1&#x3D;p_1q_1$ï¼Œæƒ³åˆ°ç¦»æ•£å¯¹æ•°ä¸­çš„ä¸€äº›å†…å®¹ï¼Œå¾ˆæ˜¾ç„¶ï¼Œåœ¨è¿™é‡Œ$\mathrm{ord}(p_1) &#x3D; q_1$ï¼Œå› ä¸º$p_1^x \mod n_1$çš„å€¼åªæœ‰$q_1$ç§ç»“æœã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">æ³¨ï¼šè¿™ä¸ªç»“è®ºå¾ˆå¥½è¯æ˜ï¼Œéšä¾¿æå‡ ä¸ªç‰¹æ®Šæ•°æ®è¯•è¯•å°±å‡ºæ¥äº†<br></code></pre></td></tr></table></figure><p>å› æ­¤ï¼Œå±•å¼€å¼ä¸­ç¬¬ä¸€é¡¹å³ä¸º$2021^{q_1}p_1$ï¼Œä½†è¿™è¾¹è¿˜æ˜¯å‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯$q_1$æ€»æ˜¯åœ¨æŒ‡æ•°ä¸Šï¼Œå¾ˆéš¾å»æ‰ã€‚</p><p>ç”±äº$p$æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆæ ¹æ®è´¹é©¬å°å®šç†$a^{p}\equiv a \pmod p$å’ŒäºŒé¡¹å¼å±•å¼€å®šç†ï¼Œå¯ä»¥å¾—åˆ°ï¼š<br>$$<br>h_2\equiv \sum_{i&#x3D;0}^{q} \mathrm C_q^{i}2021^ip^i212121^{q-i} \pmod {n_1}<br>$$<br>ç®€å•åŒ–ç®€ä¸€ä¸‹ï¼š<br>$$<br>h_2\equiv 2021^{q_1}p_1+\sum_{i&#x3D;0}^{q-1}  212121^{-i}\mathrm C_q^{i}2021^ip^i212121^{q} \pmod {n_1}<br>$$<br>å¹²è„†åˆ«ç®¡å¸¸æ•°äº†ï¼ˆ<br>$$<br>h_2\equiv 2021^{q_1}p_1+\sum_{i&#x3D;0}^{q-1}  K_ip^i212121^{q} \pmod {n_1}<br>$$<br>å†æ¨¡ä¸€ä¸‹$q_1$ï¼š<br>$$<br>H&#x3D;h_2 \mod q_1 \equiv 2021p_1+212121+Kq_1 \mod q_1 \pmod {n_1}<br>$$<br>å¦‚æœæˆ‘ä»¬å‡å»$212121$ï¼Œé‚£ä¹ˆ$H&#x3D;2021p_1+Kq_1$ï¼Œå°†$H$å‡é«˜åˆ°$202020$æ¬¡æ–¹ï¼Œç„¶åå†ç”¨Step2ä¸­ä¸€æ ·çš„æ–¹æ³•æ¶ˆå…ƒï¼Œå°±å¯ä»¥å¾—åˆ°$kq_1$ï¼Œç„¶åä¸$n_1$æ±‚GCDå°±å‡ºç»“æœäº†ã€‚</p><h3 id="Step-4-è§£é¢˜ä»£ç "><a href="#Step-4-è§£é¢˜ä»£ç " class="headerlink" title="Step 4 è§£é¢˜ä»£ç "></a>Step 4 è§£é¢˜ä»£ç </h3><p>æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œä¸éš¾å†™å‡ºè§£é¢˜ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> *<br>l=<span class="hljs-number">202020</span>*<span class="hljs-number">212121</span><br>H3,H4=<span class="hljs-built_in">pow</span>(hint3,<span class="hljs-number">212121</span>,n2),<span class="hljs-built_in">pow</span>(hint4,<span class="hljs-number">202020</span>,n2)<br>HH3,HH4=<span class="hljs-built_in">pow</span>(<span class="hljs-number">2021</span>,l,n2)*H3%n2,<span class="hljs-built_in">pow</span>(<span class="hljs-number">2020</span>,l,n2)*H4%n2<br>kq2=HH4-HH3<br>q2=GCD(kq2,n2)<br>p2=n2//q2<br><span class="hljs-keyword">assert</span> isPrime(p2) <span class="hljs-keyword">and</span> isPrime(q2)<br>Q=<span class="hljs-built_in">pow</span>(c2,inverse(e2,(p2-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>)),n2)<br><span class="hljs-keyword">assert</span> isPrime(Q)<br>t=<span class="hljs-built_in">pow</span>(hint2-<span class="hljs-number">212121</span>,<span class="hljs-number">202020</span>,n1)<br>HH1=<span class="hljs-built_in">pow</span>(<span class="hljs-number">2021</span>,<span class="hljs-number">202020</span>,n1)*hint1%n1<br>HH2=<span class="hljs-built_in">pow</span>(<span class="hljs-number">2020</span>,<span class="hljs-number">202020</span>,n1)*t%n1<br>kq1=<span class="hljs-built_in">abs</span>(HH1-HH2)<br>q1=GCD(kq1,n1)<br>p1=n1//q1<br><span class="hljs-keyword">assert</span> isPrime(p1) <span class="hljs-keyword">and</span> isPrime(q1)<br>P=<span class="hljs-built_in">pow</span>(c1,inverse(e1,(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)),n1)<br><span class="hljs-keyword">assert</span> isPrime(P)<br>flag=long_to_bytes(<span class="hljs-built_in">pow</span>(c,inverse(e,(P-<span class="hljs-number">1</span>)*(Q-<span class="hljs-number">1</span>)),P*Q))<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#GKCTF&#123;f64310b5-d5e6-45cb-ae69-c86600cdf8d8&#125;</span><br></code></pre></td></tr></table></figure><h2 id="3-GKCTF-2021-XOR"><a href="#3-GKCTF-2021-XOR" class="headerlink" title="3.[GKCTF 2021]XOR"></a>3.[GKCTF 2021]XOR</h2><p>çœ‹ä¸€ä¸‹é¢˜ç›®çš„ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br>a = getPrime(<span class="hljs-number">512</span>)<br>b = getPrime(<span class="hljs-number">512</span>)<br>c = getPrime(<span class="hljs-number">512</span>)<br>d = getPrime(<span class="hljs-number">512</span>)<br>d1 = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">bin</span>(d)[<span class="hljs-number">2</span>:][::-<span class="hljs-number">1</span>] , <span class="hljs-number">2</span>)<br>n1 = a*b<br>x1 = a^b<br>n2 = c*d<br>x2 = c^d1<br>flag = md5(<span class="hljs-built_in">str</span>(a+b+c+d).encode()).hexdigest()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n1 =&quot;</span>,n1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;x1 =&quot;</span>,x1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n2 =&quot;</span>,n2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;x2 =&quot;</span>,x2)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†$a$å’Œ$b$çš„ä¹˜ç§¯ã€$a$å’Œ$b$å¼‚æˆ–åçš„å€¼ã€$c$å’Œ$d$çš„ä¹˜ç§¯å’Œ$c$å’Œ$dâ€™$å¼‚æˆ–çš„å€¼ã€‚</p><p>å¯¹äºç¬¬ä¸€ä¸ªé—®æƒ…å†µï¼Œæˆ‘ä»¬åªéœ€è¦ä¸æ–­æšä¸¾å®ƒçš„æ¯ä¸€ä½å°±å¯ä»¥äº†ã€‚ä¸è¿‡æ³¨æ„ä¸€ä¸‹è¿™æ ·ä¸€ä¸ªåŒä½™çš„æ€§è´¨ï¼šä¸è®ºåœ¨å‡ è¿›åˆ¶ä¸‹ï¼Œå¦‚æœå·²çŸ¥$A,B$ä¸¤ä¸ªæ•°çš„æœ€å$n$ä½ï¼Œé‚£ä¹ˆå®ƒä»¬çš„ä¹˜ç§¯çš„æœ€å$n$ä½æˆ‘ä»¬ä¹Ÿä¼šçŸ¥é“äº†ã€‚</p><p>ä¾‹å¦‚ï¼š</p><p>$9Ã—7&#x3D;63$ï¼Œ$53370$<font color="red">$9$</font>$Ã—18826$<font color="red">$7$</font>$&#x3D;10047979230$<font color="red">$3$</font>ã€‚ </p><p>$5193Ã—8326&#x3D;43236918$,$8173$<font color="red">$5193$</font>$Ã—6327$<font color="red">$8326$</font>$&#x3D;517206618832$<font color="red">$6918$</font>ã€‚</p><p>åå…­è¿›åˆ¶è¿™ç§æƒ…å†µä¹ŸåŒæ ·å­˜åœ¨ï¼š</p><p>$\mathrm{7ABHÃ—96FH&#x3D;485625H}$ï¼Œ$8733$<font color="red">$\mathrm{7AB}$</font>$\mathrm {HÃ—62CE}$<font color="red">$\mathrm{96F}$</font>$\mathrm{H&#x3D;342ED01B03C}$<font color="red">$\mathrm{625}$</font>$\mathrm H$</p><p>å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹äºç¬¬ä¸€ç§æƒ…å†µç›´æ¥æšä¸¾å³å¯ã€‚</p><p>è€Œç¬¬äºŒç§æƒ…å†µå†ä¹‹å‰çš„XDCTFä¸­ï¼Œè„šæœ¬è§5æœˆ17æ—¥å‘å¸ƒçš„<strong>21May1</strong>ä¸­çš„ç¬¬ä¸‰é¢˜ï¼Œä¸è¿‡è¿™é‡Œå¯¹äºä¸‰ä¸ªå‰ªææ¡ä»¶æˆ‘å†é˜è¿°ä¸€ä¸‹ï¼š</p><p>ä¸€ï¼šä¸åŒä½™çš„æ—¶å€™å‰ªæï¼Œè¿™ä¸ªæˆ‘åˆšåˆšè®²è¿‡ï¼Œå®ç°ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span>(CurP*CurQ)%(<span class="hljs-number">2</span>**(Round+<span class="hljs-number">1</span>))!=n%(<span class="hljs-number">2</span>**(Round+<span class="hljs-number">1</span>)):<br>    <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><p>äºŒï¼šæœ€å°å€¼æƒ…å†µä¸‹æ€»æ•°è¿‡å¤§ï¼Œè¶…è¿‡äº†$n$ï¼ˆå®šä¸Šç•Œï¼‰</p><p>ç”±äºæˆ‘ä»¬æ˜¯é«˜ä½ä½ä½ä¸¤å¤´åŒé¢å¤¹å‡»ï¼Œä¸æ–­è¡¥å……æ¯”ç‰¹ä½çš„ï¼Œå› æ­¤åœ¨æšä¸¾ä¸€å¼€å§‹çš„æ—¶å€™ï¼Œä¸­é—´æ‰€æœ‰çš„æ¯”ç‰¹ä½éƒ½æ˜¯$0$ã€‚ä¹Ÿå°±æ˜¯æ­¤æ—¶æšä¸¾æ—¶$P,Q$çš„å€¼éƒ½æ˜¯å°äºçœŸå€¼çš„ã€‚å› æ­¤å¦‚æœæ­¤æ—¶ä¹˜ç§¯è¶…è¿‡$n$ï¼Œå°±è¯´æ˜æŸä¸ªæ•°çš„é«˜ä½å®šå¤§äº†ï¼Œéœ€è¦è¿”å›é‡æ–°å®šå€¼ã€‚å®ç°ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> CurP*CurQ&gt;n:<br>    <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><p>ä¸‰ï¼šæœ€å¤§å€¼æƒ…å†µä¸‹æ€»æ•°è¿‡å°ï¼Œæ— æ³•åˆ°è¾¾$n$ã€‚ï¼ˆå®šä¸‹ç•Œï¼‰</p><p>æœ‰ä¸€ä¸ªå¾ˆå¥½çš„åŠæ³•æ˜¯æŠŠä¸­é—´æ‰€æœ‰çš„æœªç¡®è®¤çš„æ¯”ç‰¹ä½å…¨å¡«å……æˆ$1$ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œä½†æˆ–è®¸ä¼šæ¯”è¾ƒéº»çƒ¦ï¼ˆ</p><p>æ ¹æ®ç¬¬äºŒæ¡ä¸­çš„ç†è®ºï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ç»™æšä¸¾çš„æ•°å­—å®šä¸ªä¸‹ç•Œã€‚ç”±äºæˆ‘ä»¬ç¬¬$\mathrm {Round}$çš„è½®å®šä¸‹çš„é«˜ä½æ˜¯ä»£è¡¨ç€$2^{511-\mathrm{Round}}$çš„å€¼ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ç»™è¿™ä¸€ä½å¼ºè¡Œ$+1$ï¼Œä¹Ÿå°±æ˜¯åŸæœ¬çš„$0$å˜$1$ï¼ŒåŸæœ¬çš„$1$å˜$2$ï¼ˆè¿›åˆ°ä¸‹ä¸€ä½ï¼‰ï¼Œå¦‚æœæ­¤æ—¶ä¸¤æ•°çš„ä¹˜ç§¯è¿˜ä¸åˆ°$n$ï¼Œå°±è¯´æ˜æˆ‘ä»¬çš„ä¸¤ä¸ªæ•°å­—ç¡®å®šå¾—å°äº†ï¼Œéœ€è¦æšä¸¾æ›´å¤§çš„æ¯”ç‰¹ä½äº†ã€‚å®ç°ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span>(CurP+<span class="hljs-number">2</span>**(<span class="hljs-number">511</span>-Round))*((CurQ+<span class="hljs-number">2</span>**(<span class="hljs-number">511</span>-Round)))&lt;n: <br>    <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><p>æœ€åä¸Šä¸€ä¸‹å®Œæ•´çš„è§£é¢˜ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> *<br>bina=<span class="hljs-built_in">bin</span>(x2)[<span class="hljs-number">2</span>:]<br>bina=<span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">512</span>-<span class="hljs-built_in">len</span>(bina))+bina<br>binb=<span class="hljs-built_in">bin</span>(x1)[<span class="hljs-number">2</span>:]<br>binb=<span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">512</span>-<span class="hljs-built_in">len</span>(binb))+binb<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs2</span>(<span class="hljs-params">P,Q,n,Round</span>):<br>    <span class="hljs-keyword">if</span> Round==<span class="hljs-number">256</span>:<br>        <span class="hljs-keyword">if</span> P*Q==n:<br>            <span class="hljs-keyword">global</span> c,d<br>            c,d=P,Q<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>            CurP=P+i*(<span class="hljs-number">2</span>**(<span class="hljs-number">511</span>-Round))+(<span class="hljs-built_in">int</span>(bina[Round])^j)*(<span class="hljs-number">2</span>**Round)<br>            CurQ=Q+j*(<span class="hljs-number">2</span>**(<span class="hljs-number">511</span>-Round))+(<span class="hljs-built_in">int</span>(bina[<span class="hljs-number">511</span>-Round])^i)*(<span class="hljs-number">2</span>**Round)<br>            <span class="hljs-keyword">if</span> CurP*CurQ&gt;n:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">if</span>(CurP+<span class="hljs-number">2</span>**(<span class="hljs-number">511</span>-Round))*((CurQ+<span class="hljs-number">2</span>**(<span class="hljs-number">511</span>-Round)))&lt;n: <br>                <span class="hljs-keyword">continue</span>     <br>            <span class="hljs-keyword">if</span>(CurP*CurQ)%(<span class="hljs-number">2</span>**(Round+<span class="hljs-number">1</span>))!=n%(<span class="hljs-number">2</span>**(Round+<span class="hljs-number">1</span>)):<br>                <span class="hljs-keyword">continue</span><br>            dfs2(CurP,CurQ,n,Round+<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs1</span>(<span class="hljs-params">P,Q,n,Round</span>):<br>    <span class="hljs-keyword">if</span> Round&gt;<span class="hljs-number">512</span>:<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> Round==<span class="hljs-number">512</span>:<br>        <span class="hljs-keyword">if</span> P*Q==n:<br>          <span class="hljs-keyword">global</span> a,b<br>          a,b=P,Q<br>          <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>        CurP=(i&lt;&lt;Round)+P<br>        CurQ=((i^<span class="hljs-built_in">int</span>(binb[<span class="hljs-number">511</span>-Round]))&lt;&lt;Round)+Q<br>        <span class="hljs-keyword">if</span>(CurP*CurQ%(<span class="hljs-number">2</span>**(Round))!=n%(<span class="hljs-number">2</span>**(Round))):<br>            <span class="hljs-keyword">continue</span><br>        dfs1(CurP,CurQ,n,Round+<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-comment">#----MAIN BELOW----#</span><br>a,b,c,d=<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span><br>dfs2(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,n2,<span class="hljs-number">0</span>)<br><span class="hljs-keyword">assert</span> isPrime(c) <span class="hljs-keyword">and</span> isPrime(d)<br>dfs1(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,n1,<span class="hljs-number">0</span>)<br><span class="hljs-keyword">assert</span> isPrime(a) <span class="hljs-keyword">and</span> isPrime(b)<br>flag = <span class="hljs-string">&quot;GKCTF&#123;&quot;</span>+md5(<span class="hljs-built_in">str</span>(a+b+c+d).encode()).hexdigest()+<span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#GKCTF&#123;f28ed218415356b4336e2f778f2981bb&#125;</span><br></code></pre></td></tr></table></figure><h2 id="4-æ€»ç»“"><a href="#4-æ€»ç»“" class="headerlink" title="4.æ€»ç»“"></a>4.æ€»ç»“</h2><p>æš‘å‡æ”¾å‡å›å®¶ç¬¬ä¸€ç¯‡å¤ç°çš„wpï¼Œæ€»ä½“æ„Ÿè§‰å¥½ä¹…æ²¡åšè¿‡CTFæ°´å¹³ä¸‹é™äº†å¾ˆå¤šçš„æ ·å­ï¼ˆ</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Explore MT19937</title>
    <link href="/2021/07/10/Explore-MT19937/"/>
    <url>/2021/07/10/Explore-MT19937/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å¯¹PRNG-MT19937çš„æ·±ä¸€æ­¥å­¦ä¹ "><a href="#huangx607087å¯¹PRNG-MT19937çš„æ·±ä¸€æ­¥å­¦ä¹ " class="headerlink" title="huangx607087å¯¹PRNG-MT19937çš„æ·±ä¸€æ­¥å­¦ä¹ "></a>huangx607087å¯¹PRNG-MT19937çš„æ·±ä¸€æ­¥å­¦ä¹ </h1><h2 id="0x01-å¯¹MT19937æ›´æ·±çš„ç†è§£"><a href="#0x01-å¯¹MT19937æ›´æ·±çš„ç†è§£" class="headerlink" title="0x01 å¯¹MT19937æ›´æ·±çš„ç†è§£"></a>0x01 å¯¹MT19937æ›´æ·±çš„ç†è§£</h2><p>MT19937ï¼Œå³æ¢…æ£®æ—‹è½¬ç®—æ³•ï¼Œæ˜¯ä¸€ç§é«˜è´¨é‡çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œåœ¨2020å¹´10æœˆ26æ—¥çš„<strong>PRNG MT Notes</strong>æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¯¹è¿™ä¸ªç®—æ³•çš„æ¦‚å¿µæ€§çš„å†…å®¹è¿›è¡Œäº†åˆæ­¥è®²è¿°ï¼Œç°åœ¨å¯¹äºMT19937çš„ä¸€äº›å…¶ä»–æ€§è´¨è¿›è¡Œäº†è§£ã€‚</p><p>CTFä¸­å¾ˆå¤šä¼šè®©ä½ é¢„æµ‹éšæœºæ•°çš„æƒ…å½¢ï¼Œéƒ½æ˜¯åŸºäºMT19937çš„ã€‚å¯¹äºMT19937çš„é¢„æµ‹ï¼Œæ ¹æ®ç†è®ºå¯çŸ¥ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“è¿ç»­çš„$624$ä¸ª$32$ä½äºŒè¿›åˆ¶æ•°ï¼Œå°±å¯ä»¥è·å–è¯¥ç®—æ³•çš„åé¢çš„æ‰€æœ‰çŠ¶æ€æˆ–è€…å‰é¢çš„æ‰€æœ‰çŠ¶æ€ã€‚</p><p>è€Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ä¼ªéšæœºæ•°éƒ½æ˜¯32ä½çš„ï¼Œæœ‰çš„æ—¶å€™ä¹Ÿä¼šå‡ºç°8ä½ã€16ä½ã€64ä½ã€96ä½ç­‰32çš„å€æ•°æˆ–çº¦æ•°ã€‚å½“ç„¶ä¹Ÿæœ‰å¯èƒ½å‡ºç°9ä½ã€33ä½ï¼Œ34ä½ã€70ä½ç­‰ä¸è§„åˆ™çš„æƒ…å½¢ã€‚å› æ­¤ï¼Œä¸Šé¢æåˆ°çš„â€œè¿ç»­$624$ä¸ª$32$ä½äºŒè¿›åˆ¶æ•°â€å¯ä»¥è¢«æ›¿æ¢æˆâ€œè¿ç»­$19968$ä¸ªæ¯”ç‰¹ä½â€ã€‚ï¼ˆè¿™é‡Œæœ‰ä¸ªå¾ˆç¥å¥‡çš„åœ°æ–¹ï¼Œå°±æ˜¯$623Ã—32$çš„å€¼æ°å¥½æ˜¯$19936$ï¼‰ã€‚</p><p>ä¸‹é¢ä¸Šä¸€ä¸‹MT19937çš„åŸºæœ¬ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_int32</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">0xFFFFFFFF</span> &amp; x)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MT19937</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        <span class="hljs-variable language_">self</span>.mt = [<span class="hljs-number">0</span>] * <span class="hljs-number">624</span><br>        <span class="hljs-variable language_">self</span>.mt[<span class="hljs-number">0</span>] = seed<br>        <span class="hljs-variable language_">self</span>.mti = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">624</span>):<br>            <span class="hljs-variable language_">self</span>.mt[i] = _int32(<span class="hljs-number">1812433253</span> * (<span class="hljs-variable language_">self</span>.mt[i - <span class="hljs-number">1</span>] ^ <span class="hljs-variable language_">self</span>.mt[i - <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>) + i)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getstate</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.mti == <span class="hljs-number">0</span>:<br>            <span class="hljs-variable language_">self</span>.twist()<br>        y = <span class="hljs-variable language_">self</span>.mt[<span class="hljs-variable language_">self</span>.mti]<br>        y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>        y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>        <span class="hljs-variable language_">self</span>.mti = (<span class="hljs-variable language_">self</span>.mti + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span><br>        <span class="hljs-keyword">return</span> _int32(y)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">twist</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>            y = _int32((<span class="hljs-variable language_">self</span>.mt[i] &amp; <span class="hljs-number">0x80000000</span>) + (<span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>))<br>            <span class="hljs-variable language_">self</span>.mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ <span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br>            <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>                <span class="hljs-variable language_">self</span>.mt[i] = <span class="hljs-variable language_">self</span>.mt[i] ^ <span class="hljs-number">0x9908b0df</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    <span class="hljs-built_in">print</span>(D.getstate())        <br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨MT19937ä¸­ï¼Œç”±äºgetstateå‡½æ•°å¹¶ä¸æ˜¯ç›´æ¥æŠŠå†…éƒ¨æ•°ç»„çš„å†…å®¹è¾“å‡ºï¼Œè€Œæ˜¯ç»è¿‡ä¸€ä¸ªå¯é€†å¹¶ä¸”ä¸€ä¸€å¯¹åº”çš„å¤„ç†åè¾“å‡ºçš„ã€‚è¿™å°±ä½¿å¾—è¾“å‡ºçš„æ•°å­—éšæœºæ€§è¾ƒé«˜ã€‚</p><p>è€Œå¦‚æœæˆ‘ä»¬æƒ³è¦ç”Ÿæˆçš„éšæœºæ•°çš„æ¯”ç‰¹ä½æ•°æ˜¯$32$çš„å€æ•°çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªéšæœºæ•°ä¹Ÿæ˜¯å¯ä»¥é¢„æµ‹å‡ºæ¥çš„ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬åªéœ€è¦å°†æ¯$32$ä¸ªæ¯”ç‰¹ä½çœ‹ä½œä¸€ä¸ªæ•´ä½“ï¼Œç„¶åæŒ‰ç…§æœ€ä½$32$ä½å…ˆç”Ÿæˆçš„åŸåˆ™ï¼Œå°±å¯ä»¥é¢„æµ‹å‡ºæ•´ä¸ªéšæœºæ•°åºåˆ—äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦é¢„æµ‹$64$ä½çš„éšæœºæ•°åºåˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å°†æ¯ä¸ª$64$ä½çš„éšæœºæ•°æ‹†æˆä¸¤ä¸ª$32$ä½çš„æ•°å­—ï¼Œç„¶åæŠŠä»£è¡¨ç€$2^{31}$åˆ°$2^{0}$çš„æ¯”ç‰¹ä½æ”¾å‰é¢ï¼Œ$2^{63}$åˆ°$2^{32}$çš„æ¯”ç‰¹ä½æ”¾åé¢ï¼Œè¿™æ ·å°±å¯ä»¥æ¢å¤æ‰€æœ‰çš„$32$ä½åºåˆ—è¿›è¡Œé¢„æµ‹äº†ã€‚åŒç†å¯ä»¥é¢„æµ‹$96,128$ç­‰$32$çš„å€æ•°çš„éšæœºæ•°çš„åºåˆ—ã€‚</p><h2 id="0x02-CTFä¸­MT19937å¸¸è§é¢˜å‹"><a href="#0x02-CTFä¸­MT19937å¸¸è§é¢˜å‹" class="headerlink" title="0x02 CTFä¸­MT19937å¸¸è§é¢˜å‹"></a>0x02 CTFä¸­MT19937å¸¸è§é¢˜å‹</h2><h3 id="2o01-é¢˜å‹ä¸€ï¼šé€†å‘éšæœºæ•°äº§ç”Ÿå™¨å†…éƒ¨çš„stateä¸­çš„å†…å®¹"><a href="#2o01-é¢˜å‹ä¸€ï¼šé€†å‘éšæœºæ•°äº§ç”Ÿå™¨å†…éƒ¨çš„stateä¸­çš„å†…å®¹" class="headerlink" title="2o01 é¢˜å‹ä¸€ï¼šé€†å‘éšæœºæ•°äº§ç”Ÿå™¨å†…éƒ¨çš„stateä¸­çš„å†…å®¹"></a>2o01 é¢˜å‹ä¸€ï¼šé€†å‘éšæœºæ•°äº§ç”Ÿå™¨å†…éƒ¨çš„stateä¸­çš„å†…å®¹</h3><p>æ ¹æ®ä¸Šé¢çš„ä»£ç åˆ†æå†…å®¹å¯çŸ¥ï¼Œæœ€åè¾“å‡ºçš„å†…å®¹å¹¶ä¸æ˜¯éšæœºæ•°äº§ç”Ÿæ—¶åŸæœ¬çš„stateã€‚æ ¹æ®å»å¹´10æœˆ26æ—¥çš„é‚£ç¯‡æ–‡ç« çš„åˆ†æã€‚æˆ‘ä»¬åˆ©ç”¨ä¸‹é¢çš„ä»£ç ä¸­çš„<code>recover()</code>å‡½æ•°å’Œ<code>extract_number()</code>å‡½æ•°ï¼Œå°±å¯ä»¥å®ç°å†…éƒ¨stateå’Œå®é™…è¾“å‡ºä¹‹é—´æ•°å€¼çš„äº’ç›¸è½¬æ¢ã€‚ï¼ˆå…·ä½“åŸç†è§å»å¹´10.26æ–‡ç« çš„åˆ†æï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right</span>(<span class="hljs-params">res, shift, mask=<span class="hljs-number">0xffffffff</span>, bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>        tmp = res ^ tmp &gt;&gt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left</span>(<span class="hljs-params">res, shift, mask=<span class="hljs-number">0xffffffff</span>, bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>        tmp = res ^ tmp &lt;&lt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_number</span>(<span class="hljs-params">y</span>):<br>    y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>    y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>    <span class="hljs-keyword">return</span> y&amp;<span class="hljs-number">0xffffffff</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover</span>(<span class="hljs-params">y</span>):<br>    y = inverse_right(y,<span class="hljs-number">18</span>)<br>    y = inverse_left(y,<span class="hljs-number">15</span>,<span class="hljs-number">4022730752</span>)<br>    y = inverse_left(y,<span class="hljs-number">7</span>,<span class="hljs-number">2636928640</span>)<br>    y = inverse_right(y,<span class="hljs-number">11</span>)<br>    <span class="hljs-keyword">return</span> y&amp;<span class="hljs-number">0xffffffff</span><br></code></pre></td></tr></table></figure><h3 id="2o02-é¢˜å‹äºŒï¼šé¢„æµ‹åç»­çš„éšæœºæ•°"><a href="#2o02-é¢˜å‹äºŒï¼šé¢„æµ‹åç»­çš„éšæœºæ•°" class="headerlink" title="2o02 é¢˜å‹äºŒï¼šé¢„æµ‹åç»­çš„éšæœºæ•°"></a>2o02 é¢˜å‹äºŒï¼šé¢„æµ‹åç»­çš„éšæœºæ•°</h3><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ä»¥ä¸‹ä»£ç æ¥è¿›è¡Œé¢„æµ‹éšæœºæ•°ã€‚ä¹Ÿå°±æ˜¯ç›´æ¥å¯¹å·²çŸ¥çš„$624$ä¸ªéšæœºæ•°å¤„ç†æˆéšæœºæ•°äº§ç”Ÿå™¨å†…éƒ¨çŠ¶æ€ï¼Œç„¶åè¿›è¡Œä¸€æ¬¡æ¨æµ‹å°±è¡Œäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">setstate</span>(<span class="hljs-params">self,s</span>):<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(s)!=<span class="hljs-number">624</span>):<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;The length of prediction must be 624!&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        <span class="hljs-variable language_">self</span>.mt[i]=<span class="hljs-variable language_">self</span>.recover(s[i])<br>    <span class="hljs-variable language_">self</span>.mti=<span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">predict</span>(<span class="hljs-params">self,s</span>):<br>    <span class="hljs-variable language_">self</span>.setstate(s)<br>    <span class="hljs-variable language_">self</span>.twist()<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.getstate(<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><h3 id="2o03-é¢˜å‹ä¸‰ï¼šæ±‚ä¹‹å‰çš„éšæœºæ•°ï¼Œå³é€†å‘twist-å‡½æ•°"><a href="#2o03-é¢˜å‹ä¸‰ï¼šæ±‚ä¹‹å‰çš„éšæœºæ•°ï¼Œå³é€†å‘twist-å‡½æ•°" class="headerlink" title="2o03 é¢˜å‹ä¸‰ï¼šæ±‚ä¹‹å‰çš„éšæœºæ•°ï¼Œå³é€†å‘twist()å‡½æ•°"></a>2o03 é¢˜å‹ä¸‰ï¼šæ±‚ä¹‹å‰çš„éšæœºæ•°ï¼Œå³é€†å‘<code>twist()</code>å‡½æ•°</h3><p>æˆ‘ä»¬å…ˆæ¥è§‚å¯Ÿä¸€ä¸‹è¿™ä¸ª<code>twist()</code>å‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">twist</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>        y = _int32((<span class="hljs-variable language_">self</span>.mt[i] &amp; <span class="hljs-number">0x80000000</span>) + (<span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>))<br>        <span class="hljs-variable language_">self</span>.mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ <span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>            <span class="hljs-variable language_">self</span>.mt[i] = <span class="hljs-variable language_">self</span>.mt[i] ^ <span class="hljs-number">0x9908b0df</span><br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œå¯¹äºå†…éƒ¨çš„æ¯ä¸€çŠ¶æ€ï¼Œè¯¥å‡½æ•°å…ˆç»§æ‰¿äº†åŸçŠ¶æ€çš„æœ€é«˜ä½ï¼ŒåŠ ä¸Šä¸‹ä¸€çŠ¶æ€çš„æœ€ä½$31$ä½ï¼Œç„¶ååˆæ˜¯ä¸€æ¬¡å¼‚æˆ–çš„è¿‡ç¨‹ï¼Œæœ€åæœ‰æ ¹æ®ä¸´æ—¶å€¼$y$çš„å¥‡å¶æ€§åˆä¼šå¯¹å†…éƒ¨çŠ¶æ€è¿›è¡Œä¸€æ¬¡å¼‚æˆ–ã€‚ç”±äºå¼‚æˆ–è¿‡ç¨‹éƒ½æ˜¯å¯é€†çš„ï¼Œå¦‚æœæˆ‘ä»¬ä¸¾ä¸€ä¸ªç‰¹æ®Šå€¼è¿›è¡Œç®€å•çš„åˆ†æï¼Œå¯ä»¥å¾—åˆ°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">1.</span> <span class="hljs-number">11100110110101000100101111000001</span> // state[i]<br><span class="hljs-number">2.</span> <span class="hljs-number">10101110111101011001001001011111</span> // state[i + <span class="hljs-number">1</span>]<br><span class="hljs-number">3.</span> <span class="hljs-number">11101010010001001010000001001001</span> // state[i + <span class="hljs-number">397</span>]<br>// y = state[i] &amp; <span class="hljs-number">0x80000000</span> | state[i + <span class="hljs-number">1</span>] &amp; <span class="hljs-number">0x7fffffff</span><br><span class="hljs-number">4.</span> <span class="hljs-number">10101110111101011001001001011111</span> // y<br><span class="hljs-number">5.</span> <span class="hljs-number">0</span>1010111011110101100100100101111 // <span class="hljs-built_in">next</span> = y &gt;&gt;&gt; <span class="hljs-number">1</span><br><span class="hljs-number">6.</span> <span class="hljs-number">11001110011100100111100111110000</span> // <span class="hljs-built_in">next</span> ^= <span class="hljs-number">0x9908b0df</span><br><span class="hljs-number">0x9908b0df</span> =&gt; <span class="hljs-number">10011001000010001011000011011111</span><br><span class="hljs-number">7.</span> <span class="hljs-number">00</span>100100001101101101100110111001 // <span class="hljs-built_in">next</span> ^= state[i + <span class="hljs-number">397</span>]<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œå¤„ç†å<code>state[i]</code>å†…å®¹ä¸<code>state[i+1]</code>å’Œ<code>state[i+397]</code>æœ‰å…³ã€‚</p><p>å…¶ä¸­ç¬¬7æ­¥æ˜¯å¿…é¡»è¿›è¡Œçš„ä¸€æ­¥(å¼‚æˆ–çš„æ¬¡åºä¸å½±å“ç»“æœï¼Œæ‰€ä»¥å¼‚æˆ–<code>state[i+397]</code>å¯ä»¥çœ‹æˆæœ€åä¸€æ­¥ã€‚</p><p>ä½†ç¬¬6æ­¥æ˜¯æ ¹æ®ç¬¬4æ­¥ç»“æœçš„å¥‡å¶æ€§ç¡®å®šçš„,ä¸ä¸€å®šæœ‰ç¬¬6æ­¥,ä½†æ˜¯å› ä¸ºç¬¬7æ­¥æ˜¯ç¬¬5æ­¥æˆ–è€…ç¬¬6æ­¥å¼‚æˆ–<code>state[i+397]</code>çš„ç»“æœ,æˆ‘ä»¬å¯ä»¥è€ƒå¯Ÿæ–°ç”Ÿæˆçš„<code>state[i]</code>å¼‚æˆ–<code>state[i+397]</code>çš„ç»“æœï¼Œæ¥åˆ¤æ–­æ˜¯å¦è¿›è¡Œäº†ç¬¬å…­æ­¥çš„æ“ä½œã€‚ </p><p>ç”±äº<code>0x9908b0df =&gt; 10011001000010001011000011011111</code>,è€Œç¬¬5æ­¥çš„æœ€é«˜ä½å¿…å®šæ˜¯0,ä½†æ˜¯å¦‚æœæ‰§è¡Œäº†ç¬¬6æ­¥é‚£ä¹ˆæ‰§è¡Œåçš„ç»“æœé¦–ä½åˆ™ä¼šå˜æˆ1,äºæ˜¯æˆ‘ä»¬å¯ä»¥æ ¹æ®ç¬¬7æ­¥é€†å‘å‡ºçš„ç»“æœçš„é¦–ä½åˆ¤æ–­æ˜¯å¦è¿›è¡Œäº†ç¬¬6æ­¥.è¿›è€Œæ¨å‡ºç¬¬5æ­¥,ç¬¬5æ­¥çš„å31ä½åŒ…å«äº†<code>state[i]</code>çš„ç¬¬1ä½å’Œ<code>state[i+1]</code>çš„ç¬¬2ä½è‡³ç¬¬31ä½,æ ¹æ®ç¬¬6æ­¥æ˜¯å¦è¿›è¡Œå¯ä»¥å¾—åˆ°<code>state[i+1]</code>çš„æœ€å1ä½,æ‰€ä»¥æ ¹æ®ç°åœ¨çš„<code>state[i]</code>å’Œä»¥å‰çš„<code>state[i+397]</code>,å¯ä»¥è·å¾—åŸæ¥<code>state[i]</code>çš„1ä½ä¿¡æ¯å’Œ<code>state[i+1]</code>çš„31ä½ä¿¡æ¯,è¦è·å¾—<code>state[i]</code>å‰©ä¸‹çš„31ä½ä¿¡æ¯,éœ€è¦å¯¹ç°åœ¨çš„<code>state[i-1]</code>è¿›è¡ŒåŒæ ·çš„è¿ç®—.å½“éœ€è¦è®¡ç®—ç¬¬ä¸€ä½<code>state</code>æ—¶,å‰©ä¸‹çš„<code>state</code>éƒ½å·²ç»æ¢å¤äº†,å¯ä»¥åˆ©ç”¨æ¢å¤äº†çš„æœ€åä¸€ä½<code>state</code>è·å¾—è¿˜æœªæ¢å¤çš„<code>state[0]</code>çš„å31ä½ã€‚</p><p>é€†å‘ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">invtwist</span>(<span class="hljs-params">self</span>):<br>    high = <span class="hljs-number">0x80000000</span><br>    low = <span class="hljs-number">0x7fffffff</span><br>    mask = <span class="hljs-number">0x9908b0df</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">623</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        tmp = <span class="hljs-variable language_">self</span>.mt[i]^<span class="hljs-variable language_">self</span>.mt[(i+<span class="hljs-number">397</span>)%<span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        res = tmp&amp;high<br>        tmp = <span class="hljs-variable language_">self</span>.mt[i-<span class="hljs-number">1</span>]^<span class="hljs-variable language_">self</span>.mt[(i+<span class="hljs-number">396</span>)%<span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        res |= (tmp)&amp;low<br>        <span class="hljs-variable language_">self</span>.mt[i] = res<br></code></pre></td></tr></table></figure><p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¸Šä¸€ä¸‹æ•´ä¸ªMT19937çš„å·¥å…·åŒ…ä¾›ä½¿ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_int32</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">0xFFFFFFFF</span> &amp; x)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MT19937</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed=<span class="hljs-number">0</span></span>):<br>        <span class="hljs-variable language_">self</span>.mt = [<span class="hljs-number">0</span>] * <span class="hljs-number">624</span><br>        <span class="hljs-variable language_">self</span>.mt[<span class="hljs-number">0</span>] = seed<br>        <span class="hljs-variable language_">self</span>.mti = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">624</span>):<br>            <span class="hljs-variable language_">self</span>.mt[i] = _int32(<span class="hljs-number">1812433253</span> * (<span class="hljs-variable language_">self</span>.mt[i - <span class="hljs-number">1</span>] ^ <span class="hljs-variable language_">self</span>.mt[i - <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>) + i)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getstate</span>(<span class="hljs-params">self,op=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.mti == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> op==<span class="hljs-literal">False</span>:<br>            <span class="hljs-variable language_">self</span>.twist()<br>        y = <span class="hljs-variable language_">self</span>.mt[<span class="hljs-variable language_">self</span>.mti]<br>        y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>        y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>        <span class="hljs-variable language_">self</span>.mti = (<span class="hljs-variable language_">self</span>.mti + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span><br>        <span class="hljs-keyword">return</span> _int32(y)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">twist</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>            y = _int32((<span class="hljs-variable language_">self</span>.mt[i] &amp; <span class="hljs-number">0x80000000</span>) + (<span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>))<br>            <span class="hljs-variable language_">self</span>.mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ <span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br>            <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>                <span class="hljs-variable language_">self</span>.mt[i] = <span class="hljs-variable language_">self</span>.mt[i] ^ <span class="hljs-number">0x9908b0df</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right</span>(<span class="hljs-params">self,res, shift, mask=<span class="hljs-number">0xffffffff</span>, bits=<span class="hljs-number">32</span></span>):<br>        tmp = res<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>            tmp = res ^ tmp &gt;&gt; shift &amp; mask<br>        <span class="hljs-keyword">return</span> tmp<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left</span>(<span class="hljs-params">self,res, shift, mask=<span class="hljs-number">0xffffffff</span>, bits=<span class="hljs-number">32</span></span>):<br>        tmp = res<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>            tmp = res ^ tmp &lt;&lt; shift &amp; mask<br>        <span class="hljs-keyword">return</span> tmp<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_number</span>(<span class="hljs-params">self,y</span>):<br>        y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>        y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>        <span class="hljs-keyword">return</span> y&amp;<span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recover</span>(<span class="hljs-params">self,y</span>):<br>        y = <span class="hljs-variable language_">self</span>.inverse_right(y,<span class="hljs-number">18</span>)<br>        y = <span class="hljs-variable language_">self</span>.inverse_left(y,<span class="hljs-number">15</span>,<span class="hljs-number">4022730752</span>)<br>        y = <span class="hljs-variable language_">self</span>.inverse_left(y,<span class="hljs-number">7</span>,<span class="hljs-number">2636928640</span>)<br>        y = <span class="hljs-variable language_">self</span>.inverse_right(y,<span class="hljs-number">11</span>)<br>        <span class="hljs-keyword">return</span> y&amp;<span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setstate</span>(<span class="hljs-params">self,s</span>):<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(s)!=<span class="hljs-number">624</span>):<br>            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;The length of prediction must be 624!&quot;</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>            <span class="hljs-variable language_">self</span>.mt[i]=<span class="hljs-variable language_">self</span>.recover(s[i])<br>        <span class="hljs-comment">#self.mt=s</span><br>        <span class="hljs-variable language_">self</span>.mti=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">predict</span>(<span class="hljs-params">self,s</span>):<br>        <span class="hljs-variable language_">self</span>.setstate(s)<br>        <span class="hljs-variable language_">self</span>.twist()<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.getstate(<span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">invtwist</span>(<span class="hljs-params">self</span>):<br>        high = <span class="hljs-number">0x80000000</span><br>        low = <span class="hljs-number">0x7fffffff</span><br>        mask = <span class="hljs-number">0x9908b0df</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">623</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>            tmp = <span class="hljs-variable language_">self</span>.mt[i]^<span class="hljs-variable language_">self</span>.mt[(i+<span class="hljs-number">397</span>)%<span class="hljs-number">624</span>]<br>            <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>                tmp ^= mask<br>                tmp &lt;&lt;= <span class="hljs-number">1</span><br>                tmp |= <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                tmp &lt;&lt;=<span class="hljs-number">1</span><br>            res = tmp&amp;high<br>            tmp = <span class="hljs-variable language_">self</span>.mt[i-<span class="hljs-number">1</span>]^<span class="hljs-variable language_">self</span>.mt[(i+<span class="hljs-number">396</span>)%<span class="hljs-number">624</span>]<br>            <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>                tmp ^= mask<br>                tmp &lt;&lt;= <span class="hljs-number">1</span><br>                tmp |= <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                tmp &lt;&lt;=<span class="hljs-number">1</span><br>            res |= (tmp)&amp;low<br>            <span class="hljs-variable language_">self</span>.mt[i] = res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">example</span>():<br>    D=MT19937(<span class="hljs-number">48</span>)<br>    <span class="hljs-built_in">print</span>(D.getstate())<br>    <span class="hljs-built_in">print</span>(D.mt[:<span class="hljs-number">5</span>])<br>    <span class="hljs-built_in">print</span>(D.recover(<span class="hljs-number">90324435</span>))<br>    <span class="hljs-built_in">print</span>(D.extract_number(<span class="hljs-number">90324435</span>))<br>    D.twist()<br>    <span class="hljs-built_in">print</span>(D.mt[:<span class="hljs-number">5</span>])<br>    D.invtwist()<br>    <span class="hljs-built_in">print</span>(D.mt[:<span class="hljs-number">5</span>])<br><span class="hljs-comment">#Main Below#</span><br>example()<br></code></pre></td></tr></table></figure><h2 id="0x03-ç»™å‡ºä»»æ„19937ä¸ªbit-upd-2025-01-22"><a href="#0x03-ç»™å‡ºä»»æ„19937ä¸ªbit-upd-2025-01-22" class="headerlink" title="0x03 ç»™å‡ºä»»æ„19937ä¸ªbit-upd:2025.01.22"></a>0x03 ç»™å‡ºä»»æ„19937ä¸ªbit-upd:2025.01.22</h2><blockquote><p>xsï¼Œ3 å¹´åŠäº†ï¼Œè¿™ç¯‡åšå®¢ç«Ÿç„¶è¿˜æ›´æ–°äº†</p></blockquote><p>ç»è¿‡æµ‹è¯•ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„ç»“è®ºï¼š</p><p><code>getrandbits(64)</code> ä¸­ï¼Œåé¢ 32 bit ä¸ºé«˜ä½ï¼Œå‰é¢ 32 bit ä¸ºä½ä½ï¼ˆ96ï¼Œ128åŒç†ï¼Œè¶Šé åçš„32bitç»„ä½ç½®è¶Šé«˜ï¼‰ï¼Œå¯ä»¥ç›´æ¥æŒ‰32bitåŸæ–¹æ³•é€†å‘ã€‚</p><p><code>getrandbits(16)</code> ä¸­ï¼Œåªè¿”å›é«˜ 16 bitï¼Œä½ 16 bit è¢«ä¸¢å¼ƒï¼Œè€Œ <code>getrandbits(33)</code> ä¸­ï¼Œä½ 32 bit ä¸ºç¬¬ä¸€ç»„æ¯”ç‰¹ï¼Œè€Œé«˜ 1 ä½å–è‡ªç¬¬äºŒç»„çš„æœ€é«˜ä½bitï¼Œç¬¬äºŒç»„ä½31bitè¢«ä¸¢å¼ƒã€‚</p><p>é‚£ï¼Œå¦‚æœç»™å‡ºäº†ä»»æ„ä¸è¿ç»­çš„ 19937 ä¸ªæ¯”ç‰¹å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªä»£ç æ„é€ çŸ©é˜µè¿›è¡Œæ±‚è§£ï¼ˆæ­¤å¤„æ•°æ®åŒ…æ‹¬1250ä¸ª <code>getrandbits(16)</code> çš„ç»“æœï¼Œå¦‚æœæ˜¯å…¶ä»–å¥‡å¥‡æ€ªæ€ªçš„å–å€¼æ–¹å¼ï¼Œåˆ™ <code>getRows</code> å‡½æ•°çš„å–æ ·æ–¹æ³•å’Œå–æ ·é¡ºåºä¿æŒå’Œé¢˜ç›®ä¸­å®Œå…¨ä¸€è‡´å°±OKäº†ï¼‰</p><p>æç¤ºï¼šåœ¨è‡ªå·±ç”µè„‘ä¸Šè·‘ï¼Œè€—æ—¶ $\mathsf{8 min}$ ï¼ˆæ¯”æƒ³è±¡å¾—å¿«ï¼‰ï¼Œå†…å­˜æ¶ˆè€—å³°å€¼ä¸º $\mathsf{7GB540MB}$ï¼ˆä¹Ÿæ¯”æƒ³è±¡çš„ä½ï¼Œä¼°è®¡Sageå¯¹ $\mathbb F_2$ ä¸Šè®¡ç®—åšäº†ä¼˜åŒ–ï¼Œä½†æ­¤ä»£ç åˆ‡å‹¿åœ¨å†…å­˜å°äº 8G çš„æœåŠ¡å™¨ä¸Šè·‘ï¼‰ã€‚</p><blockquote><p>REF:<a href="https://tangcuxiaojikuai.xyz/post/69eaef2e.html">2024-åŒæµå¤§å­¦ç¬¬äºŒå±Šç½‘ç»œå®‰å…¨æ–°ç”Ÿèµ›CatCTF-wp-crypto | ç³–é†‹å°é¸¡å—çš„blog (tangcuxiaojikuai.xyz)</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python">Dall=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;data3.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).readlines()))<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>n=<span class="hljs-number">1250</span><br>D=Dall[:n]<br>rng=Random()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    <span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†æ ¹æ®é¢˜ç›®å®é™…ç¼–å†™ï¼Œå¿…é¡»å’Œé¢˜ç›®å®é™…æ¯”ç‰¹è·å–é¡ºåºå’Œæ–¹å¼å®Œå…¨ä¸€è‡´ï¼Œä¸”ç¡®ä¿æ¯”ç‰¹æ•°å¤§äº19937ï¼Œå¹¶ä¸”è¯·æ³¨æ„zfillã€‚</span><br>    row=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(rng.getrandbits(<span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">16</span>))))<br>    <span class="hljs-keyword">return</span> row<br>M=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<span class="hljs-comment">#è¿™ä¸€éƒ¨åˆ†ä¸ºå›ºå®šå¥—è·¯ï¼Œå…·ä½“åŸå› å·²ç»å†™åœ¨æ³¨é‡Šä¸­äº†</span><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    referennce:</span><br><span class="hljs-string">    ç³–é†‹å°é¸¡å— 2025/1/21 20:26:51</span><br><span class="hljs-string">    è¿™éƒ¨åˆ†ä»£ç ç›¸å½“äºå–äº†ä¸€ç»„çº¿æ€§åŸº</span><br><span class="hljs-string"></span><br><span class="hljs-string">    ç³–é†‹å°é¸¡å— 2025/1/21 20:26:56</span><br><span class="hljs-string">    å› ä¸ºmt19937æ˜¯çº¿æ€§çš„</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <span class="hljs-comment">#è¿™ä¸ªsetstateä¹Ÿæ˜¯å›ºå®šæ ¼å¼ï¼Œå·²äº2025.1.21æµ‹è¯•</span><br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br>y=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    y+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(D[i])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">16</span>))))<br>y=vector(GF(<span class="hljs-number">2</span>),y)<br>s=M.solve_left(y)<br><span class="hljs-comment">#print(s)</span><br>G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    C=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        C&lt;&lt;=<span class="hljs-number">1</span><br>        C|=<span class="hljs-built_in">int</span>(s[<span class="hljs-number">32</span>*i+j])<br>    G.append(C)<br><span class="hljs-keyword">import</span> random<br>RNG1 = random.Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<br><br><span class="hljs-built_in">print</span>([RNG1.getrandbits(<span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">75</span>)])<br><span class="hljs-built_in">print</span>(D[:<span class="hljs-number">75</span>])<br><span class="hljs-comment">#[24611, 61540, 27000, 22927, 22627, 55288, 63953, 49489, 34260, 42784, 11039, 23642, 10110, 16227, 39041, 62962, 56808, 36780, 3159, 51528, 32460, 35716, 47277, 16978, 11858, 52799, 13693, 32000, 60366, 40153, 65005, 61189, 33210, 43238, 25824, 22460, 8863, 57878, 36381, 56343, 55634, 1060, 8091, 61140, 8566, 27917, 60023, 7332, 46069, 28344, 1102, 14223, 24904, 56001, 35032, 60197, 25690, 38921, 38024, 52458, 33339, 16684, 55115, 48897, 27067, 43509, 1101, 3168, 35237, 27651, 2668, 5881, 12436, 24064, 30439]</span><br><span class="hljs-comment">#[24611, 61540, 27000, 22927, 22627, 55288, 63953, 49489, 34260, 42784, 11039, 23642, 10110, 16227, 39041, 62962, 56808, 36780, 3159, 51528, 32460, 35716, 47277, 16978, 11858, 52799, 13693, 32000, 60366, 40153, 65005, 61189, 33210, 43238, 25824, 22460, 8863, 57878, 36381, 56343, 55634, 1060, 8091, 61140, 8566, 27917, 60023, 7332, 46069, 28344, 1102, 14223, 24904, 56001, 35032, 60197, 25690, 38921, 38024, 52458, 33339, 16684, 55115, 48897, 27067, 43509, 1101, 3168, 35237, 27651, 2668, 5881, 12436, 24064, 30439]</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason3</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>21May1</title>
    <link href="/2021/05/17/21May1/"/>
    <url>/2021/05/17/21May1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-5æœˆçš„åˆ‡é¢˜"><a href="#huangx607087-5æœˆçš„åˆ‡é¢˜" class="headerlink" title="huangx607087 5æœˆçš„åˆ‡é¢˜"></a>huangx607087 5æœˆçš„åˆ‡é¢˜</h1><h2 id="0-Intruduction"><a href="#0-Intruduction" class="headerlink" title="0.Intruduction"></a>0.Intruduction</h2><p>ä¹‹å‰4æœˆå‡†å¤‡æ›´æ–°2ç¯‡åšå®¢çš„ï¼Œä¸è¿‡è‡ªå·±å› ä¸ºå‡†å¤‡å…­çº§æ‰€ä»¥åªèƒ½åœ¨4æœˆ9æ—¥å†™äº†ä¸€ç¯‡åšå®¢å°±ç»“æŸäº†ï¼ˆã€‚5æœˆä»½è™½ç„¶è¿˜æ˜¯ç´§å¼ åœ°å¤‡è€ƒï¼Œè‡ªå·±è¿˜æ˜¯æŠ½å‡ºæ¥äº†ä¸€ç‚¹ç‚¹æ—¶é—´æ¥æ‰“æ‰“CTFã€‚ç®€å•åšäº†ä¸€äº›é¢˜ç›®ã€‚ã€‚è¿™ä¸ªæ—¶å€™è·ç¦»å…­çº§ä¹Ÿå°±å‰©20å‡ å¤©äº†ã€‚å…­æœˆä»½è¿˜æœ‰æœŸæœ«è€ƒè¯•ã€‚å¯ä»¥è¯´è¿™ä¸ªæ˜¯è‡ªå·±ç¬¬äºŒé˜¶æ®µCTFçš„å­¦å­¦ä¹ çš„æœ€åä¸€ç¯‡æ–‡ç« ã€‚ç­‰7æœˆ7æ—¥çš„æš‘å‡ï¼Œè‡ªå·±CTFè¿›å…¥ç¬¬ä¸‰é˜¶æ®µï¼Œåˆ°æ—¶å€™äº‰å–èƒ½è·Ÿå¯’å‡ä¸€æ ·æœ‰ä¸ªçªç ´ï¼Œç„¶å9æœˆè¯´ä¸å®šèƒ½<del>è¿›çº¿ä¸‹å¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œè¢«Nu1Lå¤§ä½¬å‹åˆ¶ï¼Œæ³¨å®šåªæœ‰åœ¨X1cä¸­æ‘¸é±¼çš„ä»½äº†</del>ã€‚</p><p><del>5æœˆ15æ—¥ï¼Œciscnåšå‡ºäº†ä¸‰é“å¯†ç é¢˜ï¼Œ1200åˆ†ï¼Œæ­»è€Œæ— æ†¾</del>ï¼ˆciscnRSAé‚£é“é¢˜è¿‡äºç®€å•ï¼Œæ•…åšå®¢ä¸­ä¸æ”¾è¿™é“é¢˜çš„wpï¼‰</p><p>æœ¬åšå®¢å¸¸ç”¨ç¬¦å·ï¼š$|E|$è¡¨ç¤ºé›†åˆ$E$å†…å…ƒç´ çš„ä¸ªæ•°ï¼Œæˆ–è€…æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹æ•°ã€‚$\dfrac{\ln}{\ln 2}$è¡¨ç¤ºæŸä¸ªæ•°å­—çš„æ¯”ç‰¹ä½æ•°ï¼Œ$\dfrac{\ln}{\ln 10}$è¡¨ç¤ºåè¿›åˆ¶ä½æ•°ï¼Œ$\mathrm{int}(x)$è¡¨ç¤ºå‘ä¸‹å–æ•´ï¼Œ$\mathrm{int}(x+0.5)$è¡¨ç¤ºå››èˆäº”å…¥</p><h2 id="1-CISCN-2021-imageencrypt"><a href="#1-CISCN-2021-imageencrypt" class="headerlink" title="1.[CISCN 2021]imageencrypt"></a>1.[CISCN 2021]imageencrypt</h2><p>è¿™é“é¢˜æ˜¯ä¸€ä¸ªå¯¹ä¸€å¼ å›¾ç‰‡çš„åŠ å¯†ï¼ˆå®é™…ä¸Šæ˜¯å¯¹ä¸€ä¸ªæ•°ç»„çš„åŠ å¯†ï¼‰ï¼Œé¢˜ç›®ç»™å‡ºäº†åŠ å¯†ä»£ç ã€é™„åŠ æ˜æ–‡å’Œé™„åŠ å¯†æ–‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Chall.py</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag,image,r,key1,key2<br><span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">assert</span>(flag[:<span class="hljs-number">5</span>]==<span class="hljs-string">&#x27;CISCN&#x27;</span>)<br><span class="hljs-keyword">assert</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>(r))==<span class="hljs-number">3</span>)<br>data = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">chr</span>,image))<br><span class="hljs-keyword">assert</span>(flag[<span class="hljs-number">6</span>:-<span class="hljs-number">1</span>] == md5.new(data).hexdigest())<br><span class="hljs-keyword">assert</span>(key1&lt;<span class="hljs-number">256</span>)<br><span class="hljs-keyword">assert</span>(key2&lt;<span class="hljs-number">256</span>)<br>x0 = random.random()<br>x0 = <span class="hljs-built_in">round</span>(x0,<span class="hljs-number">6</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">round</span>(r*x*(<span class="hljs-number">3</span>-x),<span class="hljs-number">6</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">pixel,key1,key2,x0,m,n</span>):<br>    num = m*n/<span class="hljs-number">8</span>    <br>    seqs = []<br>    x = x0<br>    bins = <span class="hljs-string">&#x27;&#x27;</span><br>    tmp = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num):<br>        x = generate(x)<br>        tmp.append(x)<br>        seqs.append(<span class="hljs-built_in">int</span>(x*<span class="hljs-number">22000</span>))<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> seqs:<br>        bin_x  = <span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(bin_x) &lt; <span class="hljs-number">16</span>:<br>            bin_x = <span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(bin_x))+bin_x<br>        bins += bin_x<br>    <span class="hljs-keyword">assert</span>(<span class="hljs-built_in">len</span>(pixel) == m*n)<br>    cipher = [ <span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            index = n*i+j<br>            ch = <span class="hljs-built_in">int</span>(bins[<span class="hljs-number">2</span>*index:<span class="hljs-number">2</span>*index+<span class="hljs-number">2</span>],<span class="hljs-number">2</span>)<br>            pix = pixel[index]<br>            <span class="hljs-keyword">if</span> ch == <span class="hljs-number">0</span>:<br>                pix = (pix^key1)&amp;<span class="hljs-number">0xff</span><br>            <span class="hljs-keyword">if</span> ch == <span class="hljs-number">1</span>:<br>                pix = (~pix^key1)&amp;<span class="hljs-number">0xff</span><br>            <span class="hljs-keyword">if</span> ch == <span class="hljs-number">2</span>:<br>                pix = (pix^key2)&amp;<span class="hljs-number">0xff</span><br>            <span class="hljs-keyword">if</span> ch == <span class="hljs-number">3</span>:<br>                pix = (~pix^key2)&amp;<span class="hljs-number">0xff</span><br>            cipher[index] = pix <br>    <span class="hljs-keyword">return</span> cipher<br>flagimage = image<br>testimage = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>*<span class="hljs-number">16</span>):<br>    testimage.append(random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">255</span>))<br><span class="hljs-built_in">print</span> testimage<br><span class="hljs-built_in">print</span> encrypt(testimage,key1,key2,x0,<span class="hljs-number">16</span>,<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span> encrypt(flagimage,key1,key2,x0,<span class="hljs-number">24</span>,<span class="hljs-number">16</span>)<br></code></pre></td></tr></table></figure><p>é€šè¿‡å®¡è®¡ä»£ç å¯ä»¥å‘ç°ï¼šé¢˜ç›®ä¸­ä¸€å…±æœ‰4ä¸ªæœªçŸ¥é‡ï¼š$x_0,r,key_1,key_2$ã€‚åŠ å¯†è¿‡ç¨‹ä¹Ÿå¾ˆç®€å•ï¼šé€šè¿‡$x_0,r$ä¸¤ä¸ªæ•°å­—é€šè¿‡å‡½æ•°$f(x)&#x3D;rx(3-x)$ä¸æ–­è¿­ä»£ç”Ÿæˆä¸€ä¸ªåºåˆ—ï¼Œç„¶åæ ¹-æ®åºåˆ—é‡Œçš„å€¼æ¥ç¡®å®šæ˜æ–‡å¯¹å“ªä¸ªå€¼è¿›è¡Œå¼‚æˆ–ã€‚</p><h3 id="Step-1-æ±‚-key-å€¼"><a href="#Step-1-æ±‚-key-å€¼" class="headerlink" title="Step 1:æ±‚$key$å€¼"></a>Step 1:æ±‚$key$å€¼</h3><p>æ ¹æ®ä¸ªäººåšé¢˜ä¹ æƒ¯ï¼šå…ˆå°†ç»™å‡ºæ¥çš„é™„åŠ æ˜æ–‡ã€é™„åŠ å¯†æ–‡ã€flagå¯†æ–‡å†™å…¥<code>given.py</code>ï¼Œåˆ†åˆ«å‘½åä¸º<code>Pg,Cg,Cf</code>ã€‚</p><p>å¾ˆæ˜¾ç„¶ï¼Œç”±äºå¯¹æ˜æ–‡çš„åŠ å¯†ä»…ä»…æ˜¯å¯¹$key_1,key_2$çš„å¼‚æˆ–æ“ä½œï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆå¯¹$Pg,Cg$ä¸¤ä¸ªæ•°ç»„è¿›è¡Œä¸€æ¬¡å¼‚æˆ–ï¼Œå¯ä»¥å¾—åˆ°$key_1,key_2$åœ¨é›†åˆ$(78,177,86,169)$ä¸­ã€‚å…¶ä¸­ä¸éš¾å‘ç°$78$çš„å–åæ˜¯$177$ï¼Œ$86$çš„å–åæ˜¯$169$ã€‚æ‰€ä»¥$key_1$çš„å–å€¼æœ‰ä¸¤ç§$(78,177)$ï¼Œ$key_2$çš„å–å€¼æœ‰ä¸¤ç§$(86,169)$ï¼Œå¹¶ä¸”$key_1,key_2$çš„å€¼è¿›è¡Œè°ƒæ¢æ˜¯ä¸ç­‰ä»·çš„ï¼Œä¹Ÿå°±æ˜¯è¦å…³æ³¨é¡ºåºï¼Œåˆæ˜¯ä¸¤ç§å¯èƒ½æ€§ã€‚å› æ­¤ï¼Œå¯èƒ½çš„$(key_1,key_2)$çš„æ•°å¯¹ä¸€å…±æœ‰$8$ç§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™$8$ç§ç»„åˆç”Ÿæˆå¯¹åº”çš„åŠ å¯†æŒ‡ä»¤ä¸²ï¼Œä¹Ÿå°±æ˜¯é¢˜ç›®<code>encrypt</code>å‡½æ•°ä¸­çš„<code>bins</code></p><p>è¿™ä¸€æ­¥çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> Pg,Cg<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Generate</span>(<span class="hljs-params">key1,key2</span>):<br>    <span class="hljs-keyword">global</span> K1<br>    s=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> K1:<br>        <span class="hljs-keyword">if</span>(i==key1):<br>            s+=<span class="hljs-string">&quot;00&quot;</span><br>        <span class="hljs-keyword">if</span>(i==(<span class="hljs-number">255</span>-key1)):<br>            s+=<span class="hljs-string">&quot;01&quot;</span><br>        <span class="hljs-keyword">if</span>(i==key2):<br>            s+=<span class="hljs-string">&quot;10&quot;</span><br>        <span class="hljs-keyword">if</span>(i==(<span class="hljs-number">255</span>-key2)):<br>            s+=<span class="hljs-string">&quot;11&quot;</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s)==<span class="hljs-number">512</span><br>    <span class="hljs-built_in">print</span>(s)<br>K1,K2=[],[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Pg)):<br>    K1.append((Pg[i]^Cg[i])&amp;<span class="hljs-number">0xff</span>)<br>    K2.append((~Pg[i]^Cg[i])&amp;<span class="hljs-number">0xff</span>)<br><span class="hljs-built_in">print</span>(K1)<br><span class="hljs-built_in">print</span>(K2)<br>Generate(<span class="hljs-number">78</span>,<span class="hljs-number">86</span>)<br>Generate(<span class="hljs-number">78</span>,<span class="hljs-number">169</span>)<br>Generate(<span class="hljs-number">177</span>,<span class="hljs-number">86</span>)<br>Generate(<span class="hljs-number">177</span>,<span class="hljs-number">169</span>)<br>Generate(<span class="hljs-number">86</span>,<span class="hljs-number">78</span>)<br>Generate(<span class="hljs-number">86</span>,<span class="hljs-number">177</span>)<br>Generate(<span class="hljs-number">169</span>,<span class="hljs-number">78</span>)<br>Generate(<span class="hljs-number">169</span>,<span class="hljs-number">177</span>)<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å°†ç”Ÿæˆçš„$8$ä¸ªå­—ç¬¦ä¸²å†™å¦‚<code>possible.py</code>æ–‡ä»¶ä¸­ï¼Œå®šä¹‰æ•°ç»„<code>psb</code>å‚¨å­˜è¿™$8$ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ†åˆ«å¯¹åº”ä¸Šé¢çš„å…«ä¸ªå¯èƒ½çš„ç»„åˆå¯†é’¥ï¼Œ<code>possible.py</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">psb=[<span class="hljs-string">&#x27;0001...1001&#x27;</span>,<br><span class="hljs-string">&#x27;0001...1101&#x27;</span>,<br><span class="hljs-string">&#x27;0100...1000&#x27;</span>,<br><span class="hljs-string">&#x27;0100...1100&#x27;</span>,<br><span class="hljs-string">&#x27;1011...0011&#x27;</span>,<br><span class="hljs-string">&#x27;1110...0010&#x27;</span>,<br><span class="hljs-string">&#x27;1011...0111&#x27;</span>,<br><span class="hljs-string">&#x27;1110...0110&#x27;</span>,]<br></code></pre></td></tr></table></figure><h3 id="Step-2-æ±‚-r-x-0-å€¼"><a href="#Step-2-æ±‚-r-x-0-å€¼" class="headerlink" title="Step 2:æ±‚$r,x_0$å€¼"></a>Step 2:æ±‚$r,x_0$å€¼</h3><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†å¯†é’¥å¯¹$(key_1,key_2)$çš„å…«ä¸ªå¯èƒ½ç»„åˆï¼Œç°åœ¨è¿˜æœ‰$(x_0,r)$è¿™ä¸ªç»„åˆæˆ‘ä»¬è¿˜ä¸çŸ¥é“ï¼Œ$x_0$æ˜¯å…­ä½å°æ•°åœ¨åŒºé—´å†…$[0.000000,0.999999]$ï¼Œ$r$æ˜¯ä¸€ä¸ªæœªçŸ¥çš„æ•°å­—ã€‚</p><p>æ ¹æ®é¢˜ç›®ä¸­<code>assert(len(str(r))==3)</code>å¯çŸ¥ï¼š$r$çš„å–å€¼æœ‰ä¸¤ä¸ªèŒƒå›´ï¼Œä¸€ä¸ªæ˜¯$[0.0,9.9]$å†…çš„ä¸€ä½å°æ•°ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯$[100,999]$ä¹‹é—´çš„ä¸‰ä½æ•°ã€‚ä¸è¿‡æ ¹æ®ç®€å•çš„åˆ†æï¼Œç”±äºé¢˜ç›®ä¸­å¯¹äº§ç”Ÿçš„å°æ•°æœ‰ä¹˜$22000$çš„æ“ä½œï¼Œå‡è®¾å½“$x&#x3D;0.1$æ—¶ï¼Œ$100Ã—0.1Ã—2.9Ã—22000&#x3D;638000$ï¼Œè¿œè¶…$16$ä½æ•´æ•°æœ€å¤§å€¼$65536$ï¼Œå› æ­¤$r$åªæœ‰$[0.1,9.9]$ä¹‹é—´ã€‚</p><p>æˆ‘ä¸€å¼€å§‹çŒœçš„$r&#x3D;5.3$ï¼Œç»“æœè¿è¡ŒåŠ å¯†è„šæœ¬çªç„¶æŠ¥é”™äº†ï¼Œç„¶åé€šè¿‡è¾“å‡ºçš„æ•°æ®ï¼Œæˆ‘å‘ç°è¿­ä»£å‡ æ¬¡ä¹‹åï¼Œæ•°å­—çš„å€¼å°±è¿œè¿œè¶…è¿‡äº†$10^{300}$çš„æ•°é‡çº§ã€‚è¯´æ˜$r$ä¸€å®šæ˜¯æœ‰ä¸ªèŒƒå›´çš„ã€‚</p><p>è‡ªå·±å°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å½“$râ‰¤1.3$çš„æ—¶å€™æ•´ä¸ªè¿­ä»£åºåˆ—æ˜¯æ”¶æ•›çš„ï¼Œ$r&gt;1.3$çš„æ—¶å€™è¿­ä»£åºåˆ—æ˜¯å‘æ•£çš„ï¼ˆå› ä¸ºå‡½æ•°å›¾åƒå·¦è¾¹å¯ä»¥èµ°åˆ°è´Ÿæ— ç©·ï¼‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼š$r$ä¸€å…±æœ‰$13$ç§å–å€¼æ–¹æ¡ˆï¼Œ$x_0$ä¸€å…±æœ‰$10^6$ä¸­å¯èƒ½å–å€¼ï¼Œå› æ­¤å¯¹äºä¸€ç»„å¯†é’¥çš„æšä¸¾ï¼Œä¸€å…±æ˜¯ä¸€åƒä¸‰ç™¾ä¸‡ç§å¯èƒ½æ€§ï¼Œè¿›è¡Œç®€å•çš„å‰ªæè¿˜æ˜¯å¯æšä¸¾çš„â€”â€”åªéœ€è¦æšä¸¾ä¸€ä½æ ¹æ®å¯èƒ½æ€§åˆ¤æ–­ä¸€ä½ï¼Œä¸€æ—¦ä¸ç¬¦åˆç›´æ¥<code>return 0</code>ï¼Œè¿›è¡Œä¸‹ä¸€è½®çš„æšä¸¾å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> possible <span class="hljs-keyword">import</span> *<br>answer=psb[<span class="hljs-number">0</span>]<br>keyz=[(<span class="hljs-number">78</span>,<span class="hljs-number">86</span>),(<span class="hljs-number">78</span>,<span class="hljs-number">169</span>),(<span class="hljs-number">177</span>,<span class="hljs-number">86</span>),(<span class="hljs-number">177</span>,<span class="hljs-number">169</span>),(<span class="hljs-number">86</span>,<span class="hljs-number">78</span>),(<span class="hljs-number">86</span>,<span class="hljs-number">177</span>),(<span class="hljs-number">169</span>,<span class="hljs-number">78</span>),(<span class="hljs-number">169</span>,<span class="hljs-number">177</span>)]<br>Standard=[]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">x,r</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">round</span>(r*x*(<span class="hljs-number">3</span>-x),<span class="hljs-number">6</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">BruteForce</span>(<span class="hljs-params">key1,key2,x0,m,n,r</span>):<br>    num = m*n//<span class="hljs-number">8</span>    <br>    seqs = []<br>    x = x0<br>    bins = <span class="hljs-string">&#x27;&#x27;</span><br>    tmp = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num):<br>        x = generate(x,r)<br>        tmp.append(x)<br>        seqs.append(<span class="hljs-built_in">int</span>(x*<span class="hljs-number">22000</span>))<br>        <span class="hljs-keyword">if</span>(seqs!=Standard[:<span class="hljs-built_in">len</span>(seqs)]):<br>           <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> T <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Breaking &#x27;</span>+<span class="hljs-built_in">str</span>(T+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;th Possibility&#x27;</span>)<br>    k1,k2=keyz[T]<br>    answer=psb[T]<br>    Standard=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(answer),<span class="hljs-number">16</span>):<br>        Standard.append(<span class="hljs-built_in">int</span>(answer[i:i+<span class="hljs-number">16</span>],<span class="hljs-number">2</span>))<br>    x0=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> x0&lt;<span class="hljs-number">0.999999</span>:<br>        x0=<span class="hljs-built_in">round</span>(x0+<span class="hljs-number">0.000001</span>,<span class="hljs-number">6</span>)<br>        r=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> r&lt;<span class="hljs-number">1.3</span>:<br>            r=r+<span class="hljs-number">0.1</span><br>            <span class="hljs-keyword">if</span>(BruteForce(k1,k2,x0,<span class="hljs-number">16</span>,<span class="hljs-number">16</span>,r)):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Find(k1,k2,x0,r)!\n&#x27;</span>,k1,k2,x0,r)<br>                <span class="hljs-keyword">break</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Result:</span><br><span class="hljs-string">Breaking 7th Possibility</span><br><span class="hljs-string">Find(k1,k2,x0,r)!</span><br><span class="hljs-string"> 169 78 0.840264 1.2</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="Step-3-æ•´åˆç»“æœï¼Œæ±‚å‡ºç­”æ¡ˆ"><a href="#Step-3-æ•´åˆç»“æœï¼Œæ±‚å‡ºç­”æ¡ˆ" class="headerlink" title="Step 3:æ•´åˆç»“æœï¼Œæ±‚å‡ºç­”æ¡ˆ"></a>Step 3:æ•´åˆç»“æœï¼Œæ±‚å‡ºç­”æ¡ˆ</h3><p>æˆ‘ä»¬æˆåŠŸæ‰¾å‡ºäº†$x_0&#x3D;0.840264,r&#x3D;1.2$ï¼Œè¿™æ ·å››ä¸ªæœªçŸ¥æ•°æ‰€æœ‰çš„å†…å®¹å°±å…¨è¢«æˆ‘ä»¬çŸ¥é“äº†ã€‚æ‰©å±•ä¸€ä¸‹æ“ä½œä¸²ï¼Œç„¶åè§£å¯†å›å»å°±è¡Œäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> Cf<br>x0,r=<span class="hljs-number">0.840264</span>,<span class="hljs-number">1.2</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">round</span>(r*x*(<span class="hljs-number">3</span>-x),<span class="hljs-number">6</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">key1,key2,x0,m,n</span>):<br>    num = m*n//<span class="hljs-number">8</span>    <br>    seqs = []<br>    x = x0<br>    bins = <span class="hljs-string">&#x27;&#x27;</span><br>    tmp = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num):<br>        x = generate(x)<br>        tmp.append(x)<br>        seqs.append(<span class="hljs-built_in">int</span>(x*<span class="hljs-number">22000</span>))<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> seqs:<br>        bin_x  = <span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(bin_x) &lt; <span class="hljs-number">16</span>:<br>            bin_x = <span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">16</span>-<span class="hljs-built_in">len</span>(bin_x))+bin_x<br>        bins += bin_x<br>    <span class="hljs-keyword">return</span> bins<br>decstr=encrypt(<span class="hljs-number">169</span>,<span class="hljs-number">78</span>,<span class="hljs-number">0.840264</span>,<span class="hljs-number">24</span>,<span class="hljs-number">16</span>)<br>Pf=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Cf)):<br>    op=<span class="hljs-built_in">int</span>(decstr[i*<span class="hljs-number">2</span>:i*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>],<span class="hljs-number">2</span>)<br>    <span class="hljs-comment">#print(op)</span><br>    <span class="hljs-keyword">if</span>(op==<span class="hljs-number">0</span>):<br>        Pf.append(Cf[i]^<span class="hljs-number">169</span>)<br>    <span class="hljs-keyword">if</span>(op==<span class="hljs-number">1</span>):<br>        Pf.append(Cf[i]^<span class="hljs-number">86</span>)<br>    <span class="hljs-keyword">if</span>(op==<span class="hljs-number">2</span>):<br>        Pf.append(Cf[i]^<span class="hljs-number">78</span>)<br>    <span class="hljs-keyword">if</span>(op==<span class="hljs-number">3</span>):<br>        Pf.append(Cf[i]^<span class="hljs-number">177</span>)<br><span class="hljs-built_in">print</span>(Pf)<br>S=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Pf:<br>   S*=<span class="hljs-number">256</span><br>   S+=i<br>S=long_to_bytes(S)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;CISCN&#123;&#x27;</span>+md5(S).hexdigest()+<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br><span class="hljs-comment">#CISCN&#123;7fa176002ced947e49f1752c1eb9dd62&#125;</span><br></code></pre></td></tr></table></figure><h2 id="2-CopperMove"><a href="#2-CopperMove" class="headerlink" title="2.CopperMove"></a>2.CopperMove</h2><h3 id="Step-1ï¼šåˆæ­¥è§‚å¯Ÿä»£ç ï¼Œç¡®å®šç®—æ³•"><a href="#Step-1ï¼šåˆæ­¥è§‚å¯Ÿä»£ç ï¼Œç¡®å®šç®—æ³•" class="headerlink" title="Step 1ï¼šåˆæ­¥è§‚å¯Ÿä»£ç ï¼Œç¡®å®šç®—æ³•"></a>Step 1ï¼šåˆæ­¥è§‚å¯Ÿä»£ç ï¼Œç¡®å®šç®—æ³•</h3><p>è¿˜æ˜¯å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt, gcd<br><span class="hljs-keyword">import</span> random<br>BITS = <span class="hljs-number">512</span><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>)<br>flag = f.read()<br>f.close()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_prime</span>(<span class="hljs-params">nbit</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = getPrime(nbit)<br>        <span class="hljs-keyword">if</span> p % <span class="hljs-number">3</span> == <span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">return</span> p<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen</span>(<span class="hljs-params">nbit</span>):<br>    p = get_prime(nbit)<br>    q = get_prime(nbit)<br>    <span class="hljs-keyword">if</span> q &gt; p:<br>        p, q = q, p<br>    n = p * q<br>    bound = <span class="hljs-built_in">int</span>(sqrt(<span class="hljs-number">2</span> * n)) // <span class="hljs-number">12</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        x = random.randint(<span class="hljs-number">1</span>, <span class="hljs-built_in">round</span>(sqrt(bound)))<br>        y = random.randint(<span class="hljs-number">1</span>, bound) // x<br>        zbound = <span class="hljs-built_in">int</span>(((p - q) * <span class="hljs-built_in">round</span>(n ** <span class="hljs-number">0.25</span>) * y) // (<span class="hljs-number">3</span> * (p + q)))<br>        z = zbound - ((p + <span class="hljs-number">1</span>) * (q + <span class="hljs-number">1</span>) * y + zbound) % x<br>        e = ((p + <span class="hljs-number">1</span>) * (q + <span class="hljs-number">1</span>) * y + z) // x<br>        <span class="hljs-keyword">if</span> gcd(e, (p + <span class="hljs-number">1</span>) * (q + <span class="hljs-number">1</span>)) == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">break</span><br>    gifts = [<span class="hljs-built_in">int</span>(<span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:][:<span class="hljs-number">22</span>], <span class="hljs-number">2</span>), <span class="hljs-built_in">int</span>(<span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:][<span class="hljs-number">256</span>:<span class="hljs-number">276</span>], <span class="hljs-number">2</span>)]<br>    <span class="hljs-keyword">return</span> n, e, gifts<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">p1, p2</span>):<span class="hljs-comment"># ECC Add</span><br>    <span class="hljs-keyword">if</span> p1 == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> p2<br>    <span class="hljs-keyword">if</span> p2 == (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> p1<br>    <span class="hljs-keyword">if</span> p1[<span class="hljs-number">0</span>] == p2[<span class="hljs-number">0</span>] <span class="hljs-keyword">and</span> (p1[<span class="hljs-number">1</span>] != p2[<span class="hljs-number">1</span>] <span class="hljs-keyword">or</span> p1[<span class="hljs-number">1</span>] == <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">if</span> p1[<span class="hljs-number">0</span>] == p2[<span class="hljs-number">0</span>]:<br>        tmp = (<span class="hljs-number">3</span> * p1[<span class="hljs-number">0</span>] * p1[<span class="hljs-number">0</span>]) * inverse(<span class="hljs-number">2</span> * p1[<span class="hljs-number">1</span>], n) % n<br>    <span class="hljs-keyword">else</span>:<br>        tmp = (p2[<span class="hljs-number">1</span>] - p1[<span class="hljs-number">1</span>]) * inverse(p2[<span class="hljs-number">0</span>] - p1[<span class="hljs-number">0</span>], n) % n<br>    x = (tmp * tmp - p1[<span class="hljs-number">0</span>] - p2[<span class="hljs-number">0</span>]) % n<br>    y = (tmp * (p1[<span class="hljs-number">0</span>] - x) - p1[<span class="hljs-number">1</span>]) % n<br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(x), <span class="hljs-built_in">int</span>(y))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul</span>(<span class="hljs-params">n, p</span>):<br>    r = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    tmp = p<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">0</span> &lt; n:<br>        <span class="hljs-keyword">if</span> n &amp; <span class="hljs-number">1</span> == <span class="hljs-number">1</span>:<br>            r = add(r, tmp)<br>        n, tmp = n &gt;&gt; <span class="hljs-number">1</span>, add(tmp, tmp)<br>    <span class="hljs-keyword">return</span> r<br>n, e, hint = gen(BITS)<br>pt = (bytes_to_long(flag[:<span class="hljs-built_in">len</span>(flag) // <span class="hljs-number">2</span>]), bytes_to_long(flag[<span class="hljs-built_in">len</span>(flag) // <span class="hljs-number">2</span>:]))<br>c = mul(e, pt)<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>f.write(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>\n&quot;</span>)<br>f.write(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>\n&quot;</span>)<br>f.write(<span class="hljs-string">f&quot;h1 = <span class="hljs-subst">&#123;hint[<span class="hljs-number">0</span>]&#125;</span>\n&quot;</span>)<br>f.write(<span class="hljs-string">f&quot;h2 = <span class="hljs-subst">&#123;hint[<span class="hljs-number">1</span>]&#125;</span>\n&quot;</span>)<br>f.write(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>\n&quot;</span>)<br>f.close()<br></code></pre></td></tr></table></figure><p>åˆæ¬¡ä»£ç å®¡è®¡ï¼Œå¯èƒ½å¹¶çœ‹ä¸å‡ºä»€ä¹ˆï¼Œä¸è¿‡è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ ·ä¸¤ä¸ªæƒ…å†µï¼š</p><p>ä¸€æ˜¯ç”Ÿæˆ$e$çš„æ–¹å¼éå¸¸å¤æ‚ï¼Œå¹¶ä¸”$p,q\equiv 2 \pmod 3$ã€‚</p><p>äºŒæ˜¯addã€mulå‡½æ•°æ˜¯äºŒå…ƒç»„çš„è®¡ç®—ï¼Œå¹¶ä¸”çœ‹ä¼¼éå¸¸å¤æ‚ï¼Œåƒåæ ‡çš„è®¡ç®—</p><p>æ ¹æ®æ¡ä»¶äºŒï¼Œå¯ä»¥åˆ¤æ–­å‡ºè¿™åº”è¯¥æ˜¯ECCï¼Œæ ¹æ®æ¡ä»¶ä¸€ï¼Œå¯ä»¥åˆ¤æ–­å‡ºè¿™é‡Œç”¨çš„æ˜¯KMOV-91ç®—æ³•ï¼Œç›¸å…³å†…å®¹è§åšå®¢ä¸Šå‘å¸ƒçš„<strong>ECCNotes3(2021.3.25)</strong></p><h3 id="Step-2ï¼šäºŒæ¬¡å®¡è®¡ä»£ç ï¼Œå®šå‚æ•°æ€§è´¨"><a href="#Step-2ï¼šäºŒæ¬¡å®¡è®¡ä»£ç ï¼Œå®šå‚æ•°æ€§è´¨" class="headerlink" title="Step 2ï¼šäºŒæ¬¡å®¡è®¡ä»£ç ï¼Œå®šå‚æ•°æ€§è´¨"></a>Step 2ï¼šäºŒæ¬¡å®¡è®¡ä»£ç ï¼Œå®šå‚æ•°æ€§è´¨</h3><p>é€šè¿‡å®¡è®¡ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼š$\dfrac{\ln x}{\ln 2}&#x3D;254,\dfrac{\ln y}{\ln 2}&lt;260,\dfrac{\ln n}{\ln 2}&#x3D;\dfrac{\ln e}{\ln 2}&#x3D;1024$ã€‚å¹¶ä¸”$\dfrac{\ln }{\ln 2}(ex-yn)&#x3D;535$ã€‚</p><p>ç”±äºè¿™é‡Œä¸çŸ¥é“WienerAttackæ€ä¹ˆåšï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªç‰¹æ®ŠåŒ–æˆRSAä¸­ä½è§£å¯†æŒ‡æ•°å¹¿æ’­ï¼ˆè™½ç„¶åªæœ‰ä¸€ç»„ï¼‰æ”»å‡»çš„å½¢å¼ï¼Œæ„é€ ä½è§£å¯†æŒ‡æ•°æ”»å‡»çš„æ ¼ï¼Œå°±å¯ä»¥æŠŠ$x$æ±‚å‡ºæ¥äº†ã€‚ï¼ˆç›¸å…³æ–¹æ³•è§æ–‡ç« <strong>VNCTF WriteUpï¼Œ2021.4.9å‘å¸ƒ</strong>ï¼‰</p><p>ç„¶åæ ¹æ®$y&#x3D;\dfrac{ex}n$ï¼Œå¯ä»¥å¾ˆå¿«çš„æ±‚å‡º$y$çš„å€¼ã€‚ç„¶åå°±å¯ä»¥æ±‚å‡ºä½™æ•°$k$ã€‚</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥è¿™æ ·è¿›è¡Œæ¨å¯¼ï¼šç”±<br>$$<br>k&#x3D;y(p+q+1)-z<br>$$<br>å¯ä»¥æ¨å‡º<br>$$<br>k&#x3D;y(p+q+1)-\mathrm{zbound}-[(\phi y-\mathrm{zbound})\mod x]<br>$$<br>å…¶ä¸­$\phi&#x3D;(p+1)(q+1)$ï¼Œå…¶æ„ä¹‰æ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹æ•°ï¼Œä¸æ˜¯RSAä¸­çš„$\phi&#x3D;(p-1)(q-1)$ï¼</p><p>ç„¶åæˆ‘ä»¬æ ¹æ®æ¡ä»¶ï¼Œåˆå¯ä»¥æ¨å‡º<br>$$<br>k&#x3D;y(p+q+1)+{\text{int}(\dfrac{(p-q)\text{int}(\sqrt[4]n+0.5)y}{3(p+q)}})-[\phi y-\mathrm{zbound} \mod x]<br>$$<br>ç”±äºæœ€åä¸€é¡¹ä¸€å®šå°äº$x$ï¼Œè€Œç¬¬äºŒé¡¹ä¸$\dfrac{(p-q)\text{int}(\sqrt[4]n+0.5)y}{3(p+q)}$çœŸå®å€¼ä¸è¶…è¿‡$1$ã€‚å› æ­¤ä¸Šé¢çš„å¼å­é™¤ä»¥$y$ï¼Œå°±æ˜¯$K&#x3D;p+q+1+\dfrac{(p-q)\text{int}(\sqrt[4]n+0.5)y}{3(p+q)}$çš„å€¼ã€‚è€Œæ­¤æ—¶çš„æœªçŸ¥é‡ï¼Œåªå‰©ä¸‹äº†$p,q$ã€‚</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·çš„å¼å­ï¼š<br>$$<br>p-q&#x3D;\dfrac{3(p+q)(K-1-(p+q))}{\mathrm{int}(\sqrt[4]{n}+0.5)}<br>$$<br>åˆæ ¹æ®$(p+q)^2-(p-q)^2&#x3D;4n$ï¼Œå‡è®¾$p+q&#x3D;s$ï¼Œä¹‹å‰çš„ç»“æœå¯ä»¥å¾—åˆ°è¿™æ ·çš„ç»“æœ<br>$$<br>4n&#x3D;s^2-\dfrac{\mathrm{int}(9s^2(K-1-s)^2)}{\mathrm{int}^2(\sqrt[4]n +0.5)}<br>$$<br>ç„¶åç”¨äºŒåˆ†æ³•æ±‚è§£å³å¯ã€‚</p><p>æ±‚å‡ºæ¥ä¹‹åï¼Œå°±å¯ä»¥çŸ¥é“åˆ†è§£$p,q$ï¼Œæ±‚å‡ºè§£å¯†æŒ‡æ•°$d$ï¼Œé¢˜ç›®å‡ºè§£ã€‚</p><p>è¿™é‡Œæ¤­åœ†æ›²çº¿æ˜¯$y^2&#x3D;x^3+b$ï¼Œç›¸å…³å†…å®¹è§<strong>ECC Notes3</strong>ä¸­çš„KMOV91</p><p>ä¸Šä¸€ä¸‹è§£å¯†ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e=<br>n=<br>Cx=<br>Cy=<br>M=matrix(ZZ,[[<span class="hljs-number">2</span>^<span class="hljs-number">512</span>,e],[<span class="hljs-number">0</span>,n]])<br>M=M.LLL()<br>x=(<span class="hljs-built_in">abs</span>(M[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])&gt;&gt;<span class="hljs-number">512</span>)<br>y=e*x//n<br>k=e*x-y*n<br>K=k//y<br>l,r=<span class="hljs-number">0</span>,K<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">515</span>):<br>    s=(l+r)//<span class="hljs-number">2</span><br>    v=s*s-<span class="hljs-built_in">int</span>(s*s*<span class="hljs-number">9</span>*(K-<span class="hljs-number">1</span>-s)*(K-<span class="hljs-number">1</span>-s))//(<span class="hljs-built_in">round</span>(n**<span class="hljs-number">0.25</span>)*<span class="hljs-built_in">round</span>(n**<span class="hljs-number">0.25</span>))<br>    <span class="hljs-keyword">if</span>(v&lt;<span class="hljs-number">4</span>*n):<br>        l=s<br>    <span class="hljs-keyword">else</span>:<br>        r=s<br>pandq=r<br>d=inverse(e,n+pandq+<span class="hljs-number">1</span>)<br>b=(Cy**<span class="hljs-number">2</span>-Cx**<span class="hljs-number">3</span>)%n<br>E=EllipticCurve(Zmod(n), [<span class="hljs-number">0</span>, b])<br>C=E(Cx,Cy)<br>P=d*C<br>flag=long_to_bytes(P[<span class="hljs-number">0</span>])+long_to_bytes(P[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#CISCN&#123;e91fef4ead7463b13d00bda65f540477&#125;</span><br></code></pre></td></tr></table></figure><p>2021è™ç¬¦CTFå¾—åˆ°è¿™é“é¢˜æ˜¯è¿™ä¸ªé¢˜ç›®çš„æ‰©å±•ç‰ˆ,åªä¸è¿‡è¿™é‡Œ$\ln x&#x3D;0.38\ln n$ï¼Œæä¾›äº†ä¸‰ç»„æ•°æ®ï¼Œä¹Ÿä¸€æ ·è§£ã€‚</p><p><a href="https://ctf.njupt.edu.cn/597.html#simultaneous">REFERENCE</a></p><h2 id="3-XDCTF-RSA"><a href="#3-XDCTF-RSA" class="headerlink" title="3.[XDCTF RSA]"></a>3.[XDCTF RSA]</h2><p>2021å¹´5æœˆ7æ—¥ï¼Œåšå‡ºäº†shallowå‡ºçš„é¢˜ç›®ï¼Œæ­»è€Œæ— æ†¾</p><p>è¿˜æ˜¯å…ˆæŒ‰ç…§æƒ¯ä¾‹çœ‹ä¸€ä¸‹é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(bytes_to_long(flag) , e , n))<br>_q = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">bin</span>(q)[<span class="hljs-number">2</span>:][::-<span class="hljs-number">1</span>] , <span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(p ^ _q)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†$e,n$çš„åŒæ—¶ï¼Œè¿˜ç»™å‡ºäº†$p$çš„å€¼ä¸$qâ€™$å¼‚æˆ–ä¹‹åçš„å€¼ï¼Œå…¶ä¸­$qâ€™$æ˜¯$q$çš„æ¯”ç‰¹ä½å®Œå…¨åè¿‡æ¥å¯¹åº”çš„å€¼.</p><p>ä¹‹å‰è‡ªå·±åœ¨ç½‘ä¸Šè§åˆ°è¿‡ä¸€ä¸ªé¢˜ç›®ï¼Œæ¡ä»¶æ˜¯$q$çš„æ¯”ç‰¹ä½ä¸º$p$çš„æ¯”ç‰¹ä½å€’è¿‡æ¥ï¼Œä¹Ÿå°±æ˜¯$p&#x3D;qâ€™$ã€‚è¿™å°±è¯´æ˜é‚£é“é¢˜æ˜¯è¿™ä¸€é¢˜çš„ä¸€ä¸ªç‰¹æ®Šæƒ…å†µï¼š$p \text { xor } qâ€™&#x3D;0$ã€‚æ‰€ä»¥å¯ä»¥è®¤ä¸ºè¿™ä¸¤é¢˜æ˜¯åŒä¸€ä¸ªé¢˜ç›®</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸€ä½ä¸€ä½ï¼ŒåŒæ—¶æšä¸¾$p,q$çš„é«˜ä½å°±å¯ä»¥äº†ï¼Œè¿™æ ·é¡ºä¾¿å°±èƒ½æŠŠå¯¹åº”çš„ä½ä½æ±‚å‡ºæ¥ã€‚å› æ­¤æšä¸¾æ˜¯$256$è½®è€Œä¸æ˜¯$512$è½®ã€‚è¿™è¾¹è¿˜æœ‰ä¸€ç‚¹ï¼Œå°±æ˜¯å¼‚æˆ–åçš„å€¼ä¸è¶³$512$ä¸ªæ¯”ç‰¹ä½ï¼Œå› æ­¤æˆ‘ä»¬è¦å¯¹$a$ï¼ˆä¹Ÿå°±æ˜¯å¼‚æˆ–çš„å€¼ï¼‰çš„é«˜ä½è¿›è¡Œè¡¥$0$ã€‚</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥å°±å¯ä»¥å¼€å§‹æˆ‘ä»¬çš„dfsæ“ä½œäº†ï¼Œä¸è¿‡è¿™é‡Œæœ‰å‡ ä¸ªå‰ªæç‚¹å¯ä»¥ç®€å•çš„æä¸€ä¸‹ï¼š</p><p>1.æ ¹æ®åŒä½™çš„æ€§è´¨å¯çŸ¥ï¼šæ— è®ºåœ¨å¤šå°‘è¿›åˆ¶ä¸‹ï¼Œåªè¦ä¸¤ä¸ªæ•°çš„æœ€å$n$ä½å›ºå®šä¸‹æ¥äº†ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ•°çš„ä¹˜ç§¯çš„æœ€å$n$ä½ä¹Ÿè¢«å›ºå®šäº†ã€‚å› æ­¤æˆ‘ä»¬åªè¦å‘ç°æšä¸¾æ—¶ä¸¤ä¸ªæ•°ä¹˜å‡ºæ¥æœ€åçš„æ¯”ç‰¹ä½ä¸$n$å€¼å¯¹åº”çš„æ¯”ç‰¹ä½ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æŠŠè¿™ä¸ªçŠ¶æ€èˆå¼ƒæ‰</p><p>2.ç”±äºæˆ‘ä»¬æ˜¯ä¸€ä½ä¸€ä½çš„ä»$p,q$çš„é«˜ä½å¼€å§‹æšä¸¾ï¼Œå› æ­¤å®é™…ä¸Šéšç€æšä¸¾çš„è¿›è¡Œï¼Œå¦‚æœå‡è®¾ä¸­é—´æœªè¢«æšä¸¾åˆ°çš„æ•°ä½å…¨æ˜¯$0$çš„è¯ï¼Œ$p,q$çš„å€¼åº”è¯¥æ˜¯é€æ¸å˜å¤§çš„ã€‚å› æ­¤åœ¨æšä¸¾ä¸­ï¼Œå¦‚æœå‘ç°$p,q$ä¸¤ä¸ªæ•°çš„ä¹˜ç§¯è¶…è¿‡äº†$n$ï¼Œå°±åˆå¯ä»¥è¯´æ˜è¿™ä¸€ç§æƒ…å†µä¸ç¬¦åˆæ¡ä»¶äº†ï¼Œä¹Ÿéœ€è¦é€šè¿‡<code>continue</code>å°†å…¶èˆå¼ƒï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç»™æšä¸¾å€¼å®šä¸Šé™äº†ã€‚</p><p>3.ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»™æšä¸¾å€¼å®šä¸‹é™ã€‚å‡è®¾æˆ‘ä»¬æšä¸¾çš„æ—¶å€™ï¼Œä¸­é—´æœªè¢«æšä¸¾åˆ°çš„ä½å…¨æ˜¯$1$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æšä¸¾æ—¶å°±å¯ä»¥è®¤ä¸º$p,q$ä¸¤ä¸ªå€¼æ˜¯ä¸æ–­ç¼©å°çš„ï¼Œè€Œæ­¤æ—¶æˆ‘ä»¬å‡è®¾çš„$p,q$ä¸¤ä¸ªæ•°ä¹˜ç§¯è¿˜ä¸åˆ°$n$ï¼Œå°±è¯´æ˜è¿™ç§æƒ…å†µä¹Ÿä¸ç¬¦åˆé¢˜æ„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹å¼ç»™æšä¸¾å€¼å®šä¸‹é™ã€‚è€Œå¦‚æœæˆ‘ä»¬æƒ³å‡è®¾è¿™ä¸¤ä¸ªæ•°æœªè¢«æšä¸¾åˆ°çš„æ¯”ç‰¹ä½å…¨æ˜¯$1$çš„è¯ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯$2^{511-\mathrm{Round}}\mathrm{CurP}$ï¼ˆå…·ä½“åŸå› å¯ä»¥è‡ªå·±å°è¯•ä¸€ä¸‹ï¼‰ã€‚</p><p>è¿™æ ·è®¾ç½®è¿™ä¸‰ä¸ªç­›é€‰æ¡ä»¶ï¼Œå°±å¯ä»¥è·å¾—$p,q$çš„å€¼è§£å¯†äº†ã€‚</p><p><del>è¿˜æœ‰ä¸¤é¢˜å®åœ¨åšä¸å‡ºæ¥ï¼Œå› ä¸ºè‡ªå·±tcl</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> e,n,c,a<br>bina=<span class="hljs-built_in">bin</span>(a)[<span class="hljs-number">2</span>:]<br>bina=<span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">512</span>-<span class="hljs-built_in">len</span>(bina))+bina<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs</span>(<span class="hljs-params">P,Q,Round</span>):<br>    <span class="hljs-keyword">if</span> Round==<span class="hljs-number">256</span>:<br>        <span class="hljs-keyword">if</span> P*Q==n:<br>            <span class="hljs-keyword">global</span> p,q<br>            p,q=P,Q<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>            CurP=P+i*(<span class="hljs-number">2</span>**(<span class="hljs-number">511</span>-Round))+(<span class="hljs-built_in">int</span>(bina[Round])^j)*(<span class="hljs-number">2</span>**Round)<br>            CurQ=Q+j*(<span class="hljs-number">2</span>**(<span class="hljs-number">511</span>-Round))+(<span class="hljs-built_in">int</span>(bina[<span class="hljs-number">511</span>-Round])^i)*(<span class="hljs-number">2</span>**Round)<br>            <span class="hljs-keyword">if</span> CurP*CurQ&gt;n:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">if</span>  (CurP+<span class="hljs-number">2</span>**(<span class="hljs-number">511</span>-Round))*((CurQ+<span class="hljs-number">2</span>**(<span class="hljs-number">511</span>-Round)))&lt;n: <br>                <span class="hljs-keyword">continue</span>     <br>            <span class="hljs-keyword">if</span> (CurP*CurQ)%(<span class="hljs-number">2</span>**(Round+<span class="hljs-number">1</span>))!=n%(<span class="hljs-number">2</span>**(Round+<span class="hljs-number">1</span>)):<br>                <span class="hljs-keyword">continue</span><br>            dfs(CurP,CurQ,Round+<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-comment">#------Main Below------#</span><br>p,q=<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span><br>dfs(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<br><span class="hljs-keyword">assert</span> p!=<span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> q!=<span class="hljs-literal">None</span><br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=inverse(e,phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br></code></pre></td></tr></table></figure><h2 id="4-CSAWQual-2019-byte-me"><a href="#4-CSAWQual-2019-byte-me" class="headerlink" title="4.[CSAWQual 2019]byte_me"></a>4.[CSAWQual 2019]byte_me</h2><p>XDCTFä¸­shallowå‡ºäº†ä¸€ä¸ªå—å¯†ç é¢˜ï¼Œæ˜¯CBCæ¨¡å¼ï¼Œ<del>ä½†è‡ªå·±å¤ªèœäº†æ²¡åšå‡ºæ¥</del>ï¼Œç„¶åæˆ‘åœ¨buuä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªåŒæ ·çš„å—å¯†ç ï¼Œä¸è¿‡è¿™é‡Œç”¨çš„æ˜¯EBCæ¨¡å¼ï¼Œå…³äºå—å¯†ç é¢˜ï¼Œæˆ‘ä¼šåœ¨ç¬¬ä¸‰é˜¶æ®µçš„CTFå­¦ä¹ ä¸­ï¼Œä¼šä¸“é—¨åœ¨ä¸€ç¯‡åšå®¢ä¸­å¯¹å‡ ç§å—å¯†ç çš„åŠ å¯†æ¨¡å¼è¿›è¡Œä¸€ä¸ªæ¯”è¾ƒè¯¦ç»†çš„é˜è¿°.</p><p>ECBæ¨¡å¼ï¼Œå³ç”µå­å¯†ç æœ¬ï¼Œå¯¹æ¯ä¸€å—æ˜æ–‡é€ä¸ªåŠ å¯†å°±å¯ä»¥å¾—åˆ°å¯†æ–‡ï¼ˆæœ€åä¸€ä¸ªå—è¦å¡«å……ï¼‰ã€‚è¯¥æ¨¡å¼å…·æœ‰ç®€å•ã€é«˜æ•ˆçš„ç‰¹ç‚¹ï¼Œç„¶è€Œç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯å¯†æ–‡å¾ˆæœ‰è§„å¾‹ï¼ˆå› ä¸ºä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯†é’¥ï¼‰ï¼Œå®¹æ˜“åœ¨ä¸»åŠ¨æ”»å‡»ä¸­è¢«ç ´è§£ã€‚åœ¨DES&#x2F;3DESåŠ å¯†ä¸­ï¼Œå–ç”¨çš„å—é•¿åº¦ä¸º8ï¼Œè€Œåœ¨AESåŠ å¯†ä¸­ï¼Œå—é•¿åº¦ä¸º16ã€‚</p><p>è¯¥æ¨¡å¼æœ‰ä¸ªå¾ˆæ˜¾è‘—çš„ç‰¹ç‚¹ï¼šæ—¢ä¸éœ€è¦è®¡æ•°å™¨ä¹Ÿä¸éœ€è¦åˆå§‹å‘é‡iv</p><p>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹åŠ å¯†ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">text, block_size</span>):<br>    pad_size = block_size - (<span class="hljs-built_in">len</span>(text) % block_size)<br>    <span class="hljs-keyword">if</span> pad_size == <span class="hljs-number">0</span>:<br>        pad_size = block_size<br>    pad = <span class="hljs-built_in">chr</span>(pad_size) * pad_size<br>    <span class="hljs-keyword">return</span> text + pad<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">random_key</span>(<span class="hljs-params">num</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(<br>        [random.choice(string.ascii_letters + string.digits) <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num)]<br>    ).upper()<br>key = random_key(<span class="hljs-number">16</span>)<br>random_string = random_key(random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">15</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ecb_enc</span>(<span class="hljs-params">text</span>):<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    <span class="hljs-keyword">return</span> cipher.encrypt(text)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encryption_oracle</span>(<span class="hljs-params">text, unknown</span>):<br>    text = pad(random_string + text + unknown, <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">return</span> ecb_enc(text)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">string_length_detect</span>():<br>    str1 = encryption_oracle(<span class="hljs-string">&quot;A&quot;</span> * <span class="hljs-number">16</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    decoded_flag=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).readline()<br>    <span class="hljs-built_in">print</span>(encryption_oracle(decoded_flag, <span class="hljs-string">&quot;&quot;</span>).encode(<span class="hljs-string">&quot;hex&quot;</span>))<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        userInput = raw_input(<span class="hljs-string">&quot;Tell me something: &quot;</span>)<br>        <span class="hljs-built_in">print</span>(encryption_oracle(<span class="hljs-built_in">str</span>(userInput), decoded_flag).encode(<span class="hljs-string">&quot;hex&quot;</span>))<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    exit(main())<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä»£ç å®¡è®¡ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·ä¸€ä¸ªå…³ç³»ï¼šè®¾æ˜æ–‡ä¸º$m$ï¼Œä¸€ä¸ªéšæœºå‰ç¼€$w$ï¼ˆé•¿åº¦åœ¨1åˆ°15ä½ä¹‹é—´ï¼‰ã€‚ä¸€å¼€å§‹ç»™å‡º$w+m$çš„åŠ å¯†ç»“æœ$c$ï¼ˆ<strong>è§ä¸‹å›¾ç¬¬ä¸€æ®µ</strong>ï¼‰ï¼Œæ•°äº†ä¸€ä¸‹ï¼Œä¸€å…±$128$ä½ï¼Œè€ƒè™‘åˆ°$w$çš„é•¿åº¦æ˜¯1åˆ°15ä½ï¼Œé‚£ä¹ˆä¼°è®¡$m$çš„é•¿åº¦åº”è¯¥æ˜¯32è‡³â€‹48â€‹ä½ä¹‹é—´çš„æ ·å­ã€‚ä¹Ÿå°±æ˜¯éœ€è¦ä¸‰ä¸ªå—ã€‚è€Œè¿™é“é¢˜ï¼Œæ˜¯å¯¹AES-ECBæ¨¡å¼çš„é€‰æ‹©æ˜æ–‡æ”»å‡»ï¼Œå¯¹æœåŠ¡å™¨å‘é€å­—ç¬¦ä¸²$s$ï¼Œæœ€åæœåŠ¡å™¨è¿”å›å¯¹$w+s+m$åŠ å¯†çš„å¯†æ–‡</p><p>ä¸€å¼€å§‹è‡ªå·±æ²¡æœ‰æ€è·¯çš„æ—¶å€™ï¼Œå¯¹æœåŠ¡å™¨å‘é€äº†å­—ç¬¦ä¸²<code>a</code>,<code>aa</code>,<code>aaa</code>,<code>aaaa</code>,â€¦ â€¦ï¼Œç„¶åæˆ‘å‘ç°å½“å­—ç¬¦<code>a</code>çš„ä¸ªæ•°è¾¾åˆ°æŸä¸ªå€¼çš„æ—¶å€™ï¼Œæœ€å‰é¢32ä½çš„å¯†æ–‡ä¿æŒä¸å˜â€”â€”ç»è¿‡æ€è€ƒï¼Œè¿™ä¸å˜çš„32ä½å¯†æ–‡ï¼Œæ˜¯éšæœºå‰ç¼€$w$é€šè¿‡å¡«å……å­—ç¬¦<code>a</code>è‡³16ä½æ—¶çš„å¯†æ–‡ã€‚å‡è®¾è¿™ä¸€æ®µå­—ç¬¦<code>a</code>ç§°ä¸ºå­—ç¬¦ä¸²$i$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å–ä½¿åŠ å¯†ç»“æœä¸å†æ”¹å˜çš„<code>a</code>å­—ç¬¦çš„æœ€å°å€¼ä½œä¸ºå­—ç¬¦ä¸²$i$ï¼Œé‚£ä¹ˆæ­¤æ—¶ç¬¬ä¸€æ®µåŠ å¯†ç»“æœï¼Œä¹Ÿå°±æ˜¯æœ€å‰é¢32ä½ï¼Œå°±æ˜¯å­—ç¬¦ä¸²$w+i$çš„ç»“æœï¼Œç¬¬32è‡³64ä½æ˜¯$m$å‰16ä½çš„åŠ å¯†ç»“æœï¼Œç§°ä¸º$m_1$ï¼Œå†å¾€åå°±æ˜¯$m_2,m_3$ï¼Œåˆ†åˆ«å¯¹åº”$m$çš„ç¬¬17-32ä½å’Œç¬¬33ä½åŠä»¥åçš„åŠ å¯†ç»“æœã€‚<strong>è§ä¸‹å›¾ç¬¬äºŒæ®µ</strong></p><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€æ®µé•¿åº¦15ï¼Œå†…å®¹ä¸º<code>#</code>çš„å­—ç¬¦ä¸²ï¼Œç§°ä¸º$k$ä¸²ï¼Œå¯¹æœåŠ¡å™¨å‘é€$i+k$ï¼ŒæœåŠ¡å™¨è¿”å›$w+i+k+m$çš„å¯†æ–‡ï¼Œå…¶ä¸­$w+i$è¿™ä¸€ä¸ªé•¿åº¦ä¸º16çš„å­—ç¬¦ä¸²å¯¹åº”çš„å¯†æ–‡å‰32ä½ï¼Œè€Œå¯†æ–‡ç¬¬ 33è‡³48ä½å¯¹åº”ç€$k$å’Œ$m$ç¬¬ä¸€ä½çš„å¯†æ–‡ã€‚è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸€ä½è¿›è¡Œçˆ†ç ´ã€‚<strong>è§ä¸‹å›¾ç¬¬ä¸‰æ®µç°è‰²éƒ¨åˆ†ï¼Œä¸ºçˆ†ç ´çš„è¿™ä¸€ä½</strong>ã€‚å¦‚æœçˆ†ç ´æ—¶çš„æŸä¸€ä¸ªåŠ å¯†ç»“æœçš„33è‡³48ä½ä¸åˆå§‹å‘é€çš„33è‡³48ä½ä¸€è‡´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸€ä½æˆåŠŸçˆ†ç ´ã€‚å¹¶å­˜å‚¨ä¸‹æ¥ä½œä¸º$f$</p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æŠŠ$k$æ”¹æˆ14ä¸ª<code>#</code>ï¼Œç„¶å13ä¸ª<code>#</code>ï¼Œæ¯æ¬¡å‘é€ $i+k+f$ï¼Œè¿”å›$w+i+k+f+m$çš„å¯†æ–‡ã€‚å…¶ä¸­$w+i$ä¸º16ä½ï¼Œ$k+f$ä¸º16ä½ï¼Œä¸ç ´ååŠ å¯†çš„æ•´ä½“æ€§ï¼Œ<strong>è§ä¸‹å›¾ç¬¬å››æ®µå’Œç¬¬äº”æ®µ</strong>ï¼Œæ£•è‰²æ˜¯æˆ‘ä»¬å·²çŸ¥çš„$m_1$çš„éƒ¨åˆ†ï¼Œç°è‰²æ˜¯æˆ‘ä»¬çˆ†ç ´çš„é‚£ä¸€ä½</p><p><img src="/2021/05/17/21May1/201.png" alt="401"></p><p>å¾ˆå¿«ï¼Œæˆ‘ä»¬çŸ¥é“äº†$m_1$çš„å…¨éƒ¨ï¼Œä¹Ÿå°±æ˜¯flagçš„å‰16ä½ï¼Œè§ä¸‹é¢ç¬¬å…­æ®µ**(æ³¨æ„ä¸‹é¢è¿™å¼ å›¾çš„æ ‡å°ºä¸ä¸Šé¢ä¸€ä¸ªå›¾ä¸ä¸€æ ·ï¼)**</p><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æˆªå–$m_1$çš„æœ€å15ä½ï¼Œç„¶åä»ç„¶æ˜¯çˆ†ç ´ç¬¬æ•´ä¸ªåºåˆ—ç¬¬32ä½ï¼Œä½¿è¿™ä¸¤ä¸ªåœ°æ–¹çš„åŠ å¯†å€¼ç›¸åŒï¼Œå¯ä»¥è·å¾—$m_2$çš„ç¬¬ä¸€ä½ã€‚</p><p>ç„¶åæˆªå–$m_1$çš„æœ€å14ä½ï¼Œ13ä½ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥çŸ¥é“çš„$m_2$çš„å†…å®¹è¶Šæ¥è¶Šå¤šâ€¦ â€¦<strong>è§ä¸‹å›¾ç¬¬ä¸ƒæ®µ</strong></p><p>åŒç†ï¼Œ<strong>è§ä¸‹å›¾ç¬¬å…«æ®µå’Œç¬¬ä¹æ®µï¼ŒåŒç†å¯ä»¥çŸ¥é“$m_3$çš„æ‰€æœ‰å†…å®¹</strong></p><p><img src="/2021/05/17/21May1/202.png" alt="402"></p><p>æœ€åä¸Šä¸€ä¸‹è„šæœ¬å’Œè¿è¡Œç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>sh=remote(<span class="hljs-string">&quot;node3.buuoj.cn&quot;</span>,<span class="hljs-number">29419</span>)<br>C=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-comment">#print(C)</span><br><span class="hljs-comment">#print(len(C))</span><br><span class="hljs-comment">#sh.interactive()</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getflag</span>(<span class="hljs-params">sh,L,R</span>):<br>    <span class="hljs-keyword">global</span> suffex,flag<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        <span class="hljs-built_in">print</span>(i,flag[<span class="hljs-number">15</span>:])<br>        suff=<span class="hljs-string">&#x27;#&#x27;</span>*i<br>        sh.recvuntil(<span class="hljs-string">&#x27;ng: &#x27;</span>)<br>        <span class="hljs-comment">#print(flag+&#x27;\n&#x27;)</span><br>        sh.send(suffex+suff+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>            rightseq=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">128</span>):<br>            nowch=<span class="hljs-built_in">chr</span>(j)<br>            sh.recvuntil(<span class="hljs-string">&#x27;ng: &#x27;</span>)<br>            sh.send(suffex+flag[-<span class="hljs-number">15</span>:]+nowch+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                getseq=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>            <span class="hljs-keyword">if</span>(getseq[<span class="hljs-number">32</span>:<span class="hljs-number">64</span>]==rightseq[L:R]):<br>                flag=flag+nowch<br>                <span class="hljs-keyword">break</span><br>flag=<span class="hljs-string">&#x27;#&#x27;</span>*<span class="hljs-number">15</span><br>recvsuff=<span class="hljs-string">&#x27;0123456789abcdef0123456789abcdef&#x27;</span><br>suffex=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    suff=<span class="hljs-string">&#x27;*&#x27;</span>*(i+<span class="hljs-number">1</span>)<br>    sh.recvuntil(<span class="hljs-string">&#x27;ng: &#x27;</span>)<br>    sh.send(suff+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>        curseq=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    <span class="hljs-keyword">if</span>(curseq[:<span class="hljs-number">32</span>]==recvsuff):<br>        suffex=<span class="hljs-string">&#x27;*&#x27;</span>*i<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        recvsuff=curseq[:<span class="hljs-number">32</span>]<br><span class="hljs-built_in">print</span>(suffex)<br>getflag(sh,<span class="hljs-number">32</span>,<span class="hljs-number">64</span>)<br>getflag(sh,<span class="hljs-number">64</span>,<span class="hljs-number">96</span>)<br>getflag(sh,<span class="hljs-number">96</span>,<span class="hljs-number">128</span>)<br></code></pre></td></tr></table></figure><p><img src="/2021/05/17/21May1/1.jpg" alt="403"></p><h2 id="5-CISCN2018-Crackme-Java"><a href="#5-CISCN2018-Crackme-Java" class="headerlink" title="5.[CISCN2018] Crackme Java"></a>5.[CISCN2018] Crackme Java</h2><p>é¦–å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ï¼Œåˆšå¥½æœ€è¿‘å­¦äº†ä¸€ä¸‹javaï¼Œèƒ½å¤Ÿææ‡‚é¢˜ç›®çš„æ„æ€</p><p>ç„¶åç®€å•çš„å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œå‘ç°ä½¿Elgamalï¼Œåªä¸è¿‡$c_1,c_2$éƒ½æ˜¯ä»¥$32$è¿›åˆ¶ç»™å‡ºæ¥çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.math.BigInteger;<br><span class="hljs-keyword">import</span> java.util.Random;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test0</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">BigInteger</span> <span class="hljs-variable">two</span> <span class="hljs-operator">=</span><span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInteger</span>(<span class="hljs-string">&quot;2&quot;</span>);<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">BigInteger</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInteger</span>(<span class="hljs-string">&quot;11360738295177002998495384057893129964980131806509572927886675899422214174408333932150813939357279703161556767193621832795605708456628733877084015367497711&quot;</span>);<br>    <span class="hljs-keyword">static</span> BigInteger h= <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInteger</span>(<span class="hljs-string">&quot;7854998893567208831270627233155763658947405610938106998083991389307363085837028364154809577816577515021560985491707606165788274218742692875308216243966916&quot;</span>);<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     Alice write the below algorithm for encryption.</span><br><span class="hljs-comment">     The public key &#123;p, h&#125; is broadcasted to everyone.</span><br><span class="hljs-comment">    @param val: The plaintext to encrypt.</span><br><span class="hljs-comment">        We suppose val only contains lowercase letter &#123;a-z&#125; and numeric charactors, and is at most 256 charactors in length.</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">pkEnc</span><span class="hljs-params">(String val)</span>&#123;<br>        BigInteger[] ret = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInteger</span>[<span class="hljs-number">2</span>];<br>        BigInteger bVal=<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInteger</span>(val.toLowerCase(),<span class="hljs-number">36</span>);<br>        <span class="hljs-type">BigInteger</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span><span class="hljs-keyword">new</span> <span class="hljs-title class_">BigInteger</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>().nextInt()+<span class="hljs-string">&quot;&quot;</span>);<br>        ret[<span class="hljs-number">0</span>]=two.modPow(r,p);<br>        ret[<span class="hljs-number">1</span>]=h.modPow(r,p).multiply(bVal);<br>        <span class="hljs-keyword">return</span> ret[<span class="hljs-number">0</span>].toString(<span class="hljs-number">36</span>)+<span class="hljs-string">&quot;==&quot;</span>+ret[<span class="hljs-number">1</span>].toString(<span class="hljs-number">36</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/* Alice write the below algorithm for decryption. x is her private key, which she will never let you know.</span><br><span class="hljs-comment">    public static String skDec(String val,BigInteger x)&#123;</span><br><span class="hljs-comment">        if(!val.contains(&quot;==&quot;))&#123;</span><br><span class="hljs-comment">            return null;</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">        else &#123;</span><br><span class="hljs-comment">            BigInteger val0=new BigInteger(val.split(&quot;==&quot;)[0],36);</span><br><span class="hljs-comment">            BigInteger val1=new BigInteger(val.split(&quot;==&quot;)[1],36);</span><br><span class="hljs-comment">            BigInteger s=val0.modPow(x,p).modInverse(p);</span><br><span class="hljs-comment">            return val1.multiply(s).mod(p).toString(36);</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">   */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.out.println(<span class="hljs-string">&quot;You intercepted the following message, which is sent from Bob to Alice:&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;eag0vit7sboilgcfu0fbkbrmjgs4pzi2oznmqrkey5h1bwicvborngscx050u8vpghi69xqjmotgrtj4vq8fgw9tzi916o034bu==ahcwy7c0qq5cnxdntssqrj972nhvzt5liqlq0cvv0o1fm2ee4205nemuy5tvkda0hyetu5a5xcqqov8exk901z5xebvkcdo3jiq1gj8pkxzhjaeg9z6syu58neijxy56am7d1l9grhgtgkkfc432wm6h3jr8y1xx&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;Please figure out the plaintext!&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//eag0vit7sboilgcfu0fbkbrmjgs4pzi2oznmqrkey5h1bwicvborngscx050u8vpghi69xqjmotgrtj4vq8fgw9tzi916o034bu==ahcwy7c0qq5cnxdntssqrj972nhvzt5liqlq0cvv0o1fm2ee4205nemuy5tvkda0hyetu5a5xcqqov8exk901z5xebvkcdo3jiq1gj8pkxzhjaeg9z6syu58neijxy56am7d1l9grhgtgkkfc432wm6h3jr8y1xx</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„åˆ°$r$æ˜¯<code>random_integer</code>ï¼Œè¯´æ˜åº”è¯¥ä¸è¶…è¿‡$42$äº¿ï¼Œç®€å•æšä¸¾ä¸€ä¸‹å°±å¯ä»¥çŸ¥é“$r$çš„å€¼äº†</p><p>$r$è§£å‡ºæ¥äº†å°±å¯ä»¥çŸ¥é“æ‰€æœ‰çš„å†…å®¹äº†<del>ä¸è¿‡ä¸çŸ¥é“æœ€ååº”è¯¥äº¤ä¸Šå»ä»€ä¹ˆï¼Œä¸è¿‡è¥¿ç”µå¤§ä½¬dbtæ˜¯è§£å‡ºæ¥çš„ï¼Œä¸è¿‡ä»–ä¹Ÿå¿˜è®°äº†ï¼Œå› ä¸ºçœŸçš„ä¸å¥½æ”¹</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">if</span>(s[:<span class="hljs-number">5</span>]==<span class="hljs-string">b&#x27;flag&#123;&#x27;</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>        <span class="hljs-keyword">if</span>(s[i] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">128</span>)):<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>p=<span class="hljs-number">11360738295177002998495384057893129964980131806509572927886675899422214174408333932150813939357279703161556767193621832795605708456628733877084015367497711</span><br>h=<span class="hljs-number">7854998893567208831270627233155763658947405610938106998083991389307363085837028364154809577816577515021560985491707606165788274218742692875308216243966916</span><br>c1=<span class="hljs-string">&#x27;eag0vit7sboilgcfu0fbkbrmjgs4pzi2oznmqrkey5h1bwicvborngscx050u8vpghi69xqjmotgrtj4vq8fgw9tzi916o034bu&#x27;</span><br>c2=<span class="hljs-string">&#x27;ahcwy7c0qq5cnxdntssqrj972nhvzt5liqlq0cvv0o1fm2ee4205nemuy5tvkda0hyetu5a5xcqqov8exk901z5xebvkcdo3jiq1gj8pkxzhjaeg9z6syu58neijxy56am7d1l9grhgtgkkfc432wm6h3jr8y1xx&#x27;</span><br>c1,c2=<span class="hljs-built_in">int</span>(c1,<span class="hljs-number">36</span>),<span class="hljs-built_in">int</span>(c2,<span class="hljs-number">36</span>)<br>r=<span class="hljs-number">1599939680</span><br><span class="hljs-keyword">assert</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,r,p)==c1)<br>e1=<span class="hljs-built_in">pow</span>(h,r,p)<br><span class="hljs-keyword">assert</span> c2%e1==<span class="hljs-number">0</span><br>bval=c2//e1<br>table=<span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;</span><br>s=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">from</span> base36 <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(dumps(bval))<br><span class="hljs-comment">#ciscncongratulationsthisisdesignedbyalibabasecurity2096022101</span><br></code></pre></td></tr></table></figure><h2 id="6-Conclusion"><a href="#6-Conclusion" class="headerlink" title="6.Conclusion"></a>6.Conclusion</h2><p>huangx607087 CTFå­¦ä¹ çš„ç¬¬äºŒé˜¶æ®µè‡³æ­¤å°±ç»“æŸäº†ã€‚åé¢å‡†å¤‡å¤‡è€ƒå…­çº§å’ŒæœŸæœ«è€ƒè¯•äº†ã€‚</p><p>7æœˆ7æ—¥ï¼Œåšå®¢ä¼šç»§ç»­æ›´æ–°ï¼Œç¬¬ä¸‰é˜¶æ®µCTFå­¦ä¹ å¼€å§‹ï¼Œè‡ªå·±äº‰å–èƒ½å¤Ÿåœ¨ä»¥åæœ‰1æ¬¡å»çº¿ä¸‹çœ‹çœ‹å„ä½å¤§ä½¬ä»¬çš„æœºä¼šå§<del>è™½ç„¶æˆ‘çŸ¥é“å°±ç®—æ˜¯å»äº†å¤§æ¦‚ç‡è¿˜æ˜¯å»æ‘¸é±¼çš„</del>ï¼Œå¯’å‡è‡ªå·±çš„CTFæ°´å¹³æœ‰äº†ä¸ªçªç ´ï¼Œäº‰å–è¿™ä¸ªæš‘å‡ä¹Ÿèƒ½æœ‰ä¸ªçªç ´å§</p><p>ä¸çŸ¥ä¸è§‰ï¼Œä»Šå¤©éƒ½å·²ç»5æœˆ18æ—¥äº†ï¼Œ7æœˆ7æ—¥æ”¾æš‘å‡ï¼Œä¹Ÿå°±æ˜¯è¯´è‡ªå·±å¤§ä¸€å°±å‰©ä¸åˆ°50å¤©äº†ï¼ˆè‰</p><p>æ²¡æƒ³åˆ°è‡ªå·±å·²ç»èµ°äº†è¿™ä¹ˆè¿œäº†å•Šâ€¦ â€¦<del>æ€ä¹ˆæ„Ÿè§‰æ˜¨å¤©æ‰å…¥å­¦å•Šwoc</del>â€¦â€¦</p><p>äº‰å–åˆ°æ—¶å€™èƒ½æœ‰Am4dalaoçš„ä¸€åŠæ°´å¹³å§ï¼ˆï¼Œå“ï¼ˆ</p><p><del>æ‰“CTFèƒ½è®¤è¯†dwå’Œdbtä¸¤ä½å¯†ç ç¥ï¼Œæ­»è€Œæ— æ†¾</del></p><p><del>6æœˆ28æ—¥è¿›å…¥è€ƒè¯•å‘¨ï¼Œå†²å†²å†²ï¼Œäº‰å–æ¯é—¨è¯¾éƒ½èƒ½æœ‰60â€”â€”ä¸è¿‡æˆ‘å‘ç°è‡ªå·±é¢„ä¹ ä¸å®Œäº†æ€ä¹ˆåŠ</del>ï¼Œæˆ‘åªæ˜¯ä¸æƒ³è¡¥è€ƒï¼ˆå“</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>VNCTF WriteUp</title>
    <link href="/2021/04/09/VNCTF-WriteUp/"/>
    <url>/2021/04/09/VNCTF-WriteUp/</url>
    
    <content type="html"><![CDATA[<h1 id="VNCTF-WriteUp-By-huangx607087"><a href="#VNCTF-WriteUp-By-huangx607087" class="headerlink" title="VNCTF WriteUp By huangx607087"></a>VNCTF WriteUp By huangx607087</h1><h2 id="0-Introduction"><a href="#0-Introduction" class="headerlink" title="0.Introduction"></a>0.Introduction</h2><p>3æœˆ14æ—¥çš„VNCTFï¼Œè‡ªå·±ä¸€é“é¢˜ä¹Ÿä¸ä¼šï¼Œåªèƒ½é èµ›åå¤ç°äº†ã€‚</p><h2 id="1-WhiteGive"><a href="#1-WhiteGive" class="headerlink" title="1.WhiteGive"></a>1.WhiteGive</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> url<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>m = bytes_to_long(url)<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p * q<br>d = getPrime(<span class="hljs-number">256</span>)<br>e = inverse(d,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(c)<br>m = e<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p * p * q<br>e = <span class="hljs-number">0x10001</span><br>d = inverse(e,lcm(p,lcm(p-<span class="hljs-number">1</span>,q-<span class="hljs-number">1</span>)))<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br>hint = <span class="hljs-built_in">pow</span>(d,e,n)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(c)p<br><span class="hljs-built_in">print</span>(hint)<br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ç»™å‡ºäº†ç¬¬ä¸€æ­¥åŠ å¯†çš„$n,c$çš„å€¼ï¼Œå¹¶å¯¹ç¬¬ä¸€æ¬¡çš„$e$è¿›è¡Œäº†å¦ä¸€è½®åŠ å¯†æ“ä½œã€‚å…¶ä¸­$d$æ˜¯$e&#x3D;65537$æ¨¡$\dfrac{p(p-1)(q-1)}{\gcd(p-1,q-1)}$çš„é€†å…ƒã€‚å› æ­¤æˆ‘ä»¬è¦æ±‚å‡ºç¬¬ä¸€è½®$e$çš„å€¼ã€‚è€Œç»™å‡ºäº†$h\equiv d^e \pmod n$</p><p>ä¸€å¼€å§‹ï¼Œè‡ªå·±æƒ³çš„æ˜¯è®¡ç®—å‡º$e^{e-1}$ï¼Œç”±$c&#x3D;m^e$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¡ç®—ã€‚</p><p><img src="/2021/04/09/VNCTF-WriteUp/Q1.png" alt="Q1"></p><p>ç„¶åå°è¯•æšä¸¾$\gcd(p-1,q-1)$çš„å€¼ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½è§£å‡ºä¸€ä¸ªå°äº$1024$æ¯”ç‰¹çš„å€¼ï¼Œç»“æœå¤±è´¥äº†ã€‚<del>è¿™é“é¢˜å°±æ²¡æœ‰ç»§ç»­åšä¸‹å»äº†</del>ã€‚</p><p>ç„¶åçœ‹äº†è¥¿ç”µå¤§ä½¬Deebatoçš„Expï¼Œè‡ªå·±æ‰å¾—çŸ¥äº†è¿™é“é¢˜æ­£ç¡®çš„è§£æ³•ï¼š</p><p>æˆ‘ä»¬å¯ä»¥æ¨å‡ºè¿™æ ·çš„å¼å­ï¼šç”±$ed\equiv 1 \pmod {\dfrac{p(p-1)(q-1)}{\gcd(p-1,q-1)}}$ã€‚æ—¢ç„¶æˆ‘ä»¬å·²çŸ¥äº†$d^e$ï¼Œé‚£æˆ‘ä»¬ä¹Ÿå¯ä»¥è®¡ç®—å‡º$e$çš„å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰äº†$(ed)^e\equiv 1 \pmod {\dfrac{p(p-1)(q-1)}{\gcd(p-1,q-1)}}$ã€‚å› æ­¤ï¼Œ$(((ed)^e-1)\mod n)\equiv 0 \pmod {\dfrac{p(p-1)(q-1)}{\gcd(p-1,q-1)}}$ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥è®¡ç®—$(ed)^e$çš„å€¼ï¼Œç„¶åä¸$n$å–GCDå³å¯ã€‚æˆ‘ä»¬å°±å¾—åˆ°äº†$p$å€¼ï¼Œæ¥ç€å°±æ˜¯æ­£å¸¸çš„RSAè§£å¯†äº†ã€‚</p><p><del>è§£å‡º$p,q$åæ‰å‘ç°$\gcd(p-1,q-1)&#x3D;6$ï¼Œä¸çŸ¥é“è‡ªå·±å½“æ—¶æšä¸¾çš„æ—¶å€™å‡ºç°äº†ä»€ä¹ˆé—®é¢˜</del></p><p>ä¸è¿‡æˆ‘ä»¬è¿›å…¥ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†$\ln d &#x3D; 0.25 \ln n$ï¼Œè€ƒè™‘Wienerattackï¼Œä¸è¿‡å¥½åƒå¤±è´¥äº†ï¼ˆã€‚è¿˜å¥½ï¼Œæˆ‘åœ¨<strong>RSA Notes 4</strong>ä¸­è¿˜æœ‰ä¸€ä¸ªè„šæœ¬ï¼Œè¿™ä¸ªèƒ½å¤Ÿè·‘å‡ºæ¥ã€‚</p><p>è§£å‡ºæ¥åï¼Œæ˜¯ä¸€ä¸ªç½‘ç«™ã€‚ã€‚ã€‚é‡Œé¢ç«Ÿç„¶è¿˜æœ‰ä¸€é¢˜ï¼ˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag,padding<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>m = bytes_to_long(flag)<br>e = <span class="hljs-number">7</span> <br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p * q<br>c1 = <span class="hljs-built_in">pow</span>(m,e,n)<br>c2 = <span class="hljs-built_in">pow</span>(m+padding,e,n)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(c1)<br><span class="hljs-built_in">print</span>(c2)<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œä¹ä¸€çœ‹ä»¥ä¸ºæ˜¯Related Message Attackã€‚ç»“æœå‘ç°æˆ‘ä»¬ä¸çŸ¥é“Paddingã€‚æŸ¥äº†ä¸€ä¸‹æ‰çŸ¥é“æ˜¯Short-Padding Attackã€‚ä¸Šä¸€ä¸‹è„šæœ¬ï¼Œä»¥åå†ç ”ç©¶<del>ï¼ˆguguguï¼‰</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">short_pad_attack</span>(<span class="hljs-params">c1, c2, e, n</span>):<br>    PRxy.&lt;x,y&gt; = PolynomialRing(Zmod(n))<br>    PRx.&lt;xn&gt; = PolynomialRing(Zmod(n))<br>    PRZZ.&lt;xz,yz&gt; = PolynomialRing(Zmod(n))<br>    g1 = x^e - c1<br>    g2 = (x+y)^e - c2<br>    q1 = g1.change_ring(PRZZ)<br>    q2 = g2.change_ring(PRZZ)<br>    h = q2.resultant(q1)<br>    h = h.univariate_polynomial()<br>    h = h.change_ring(PRx).subs(y=xn)<br>    h = h.monic()<br>    kbits = n.nbits()//(<span class="hljs-number">2</span>*e*e)<br>    diff = h.small_roots(X=<span class="hljs-number">2</span>^kbits, beta=<span class="hljs-number">0.4</span>)[<span class="hljs-number">0</span>]  <span class="hljs-comment"># find root &lt; 2^kbits with factor &gt;= n^0.4</span><br>    <span class="hljs-keyword">return</span> diff<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">related_message_attack</span>(<span class="hljs-params">c1, c2, diff, e, n</span>):<br>    PRx.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    g1 = x^e - c1<br>    g2 = (x+diff)^e - c2<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">gcd</span>(<span class="hljs-params">g1, g2</span>):<br>        <span class="hljs-keyword">while</span> g2:<br>            g1, g2 = g2, g1 % g2<br>        <span class="hljs-keyword">return</span> g1.monic()<br>    <span class="hljs-keyword">return</span> -gcd(g1, g2)[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    n = <br>    e = <span class="hljs-number">7</span><br>    c1 =<br>    c2 = <br>    diff = short_pad_attack(c1, c2, e, n)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;difference of two messages is %d&quot;</span> % diff)<br>    m1 = related_message_attack(c1, c2, diff, e, n)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;m1:&quot;</span>, m1)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;m2:&quot;</span>, m1 + diff)<br></code></pre></td></tr></table></figure><p>æœ€åå¾—å‡ºflag<code>VNCTF&#123;H4ppyNeWy34r!2021_V&amp;N_figHt1ng!&#125;</code></p><h2 id="2-FACTOR"><a href="#2-FACTOR" class="headerlink" title="2.FACTOR"></a>2.FACTOR</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_public_key</span>(<span class="hljs-params">d</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        p, q = getPrime(<span class="hljs-number">512</span>), getPrime(<span class="hljs-number">512</span>)<br>        N, phi, not_phi = p * q, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>), (p + <span class="hljs-number">1</span>) * (q + <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">try</span>:<br>            e = inverse(d, not_phi)<br>            <span class="hljs-keyword">assert</span> gcd(e, phi) == <span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> (N, e)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">pubkey, m</span>):<br>    N, e = pubkey<br>    c = <span class="hljs-built_in">pow</span>(m, e, N)<br>    <span class="hljs-keyword">return</span> c<br>m = bytes_to_long(flag)<br>d = getPrime(<span class="hljs-number">300</span>)<br>pubkeys = [get_public_key(d), get_public_key(d)]<br>cs = encrypt(pubkeys[<span class="hljs-number">0</span>], m), encrypt(pubkeys[<span class="hljs-number">1</span>], m)<br><span class="hljs-built_in">print</span>(pubkeys)<br><span class="hljs-built_in">print</span>(cs)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®çš„ä»£ç å¾ˆç®€å•ï¼Œç®€å•ç†è§£ä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°å®é™…ä¸Šæ˜¯é€šè¿‡ä¸€ä¸ªå¾ˆå°çš„è§£å¯†æŒ‡æ•°$d$æ‰€ç”Ÿæˆçš„ä¸¤ç»„å…¬é’¥ã€‚<del>ä¸€å¼€å§‹è‡ªå·±çœ‹çš„ä¸è®¤çœŸï¼Œä»¥ä¸ºæ˜¯Extending Wiener Attackï¼Œç»“æœæ€ä¹ˆåšä¹Ÿåšä¸å‡ºæ¥ï¼ˆx</del></p><p>æœ€åæ‰çŸ¥é“ï¼Œè¿™åŸæ¥æ˜¯ä¸€ç§æ–°çš„æ”»å‡»æ–¹æ³•ã€‚å¦‚æœè§£å¯†æŒ‡æ•°$d$æ¯”è¾ƒä½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ æ ¼çš„æ–¹æ³•æ¥è§£å†³ã€‚</p><p>ç›¸å…³çš„è®ºæ–‡æ˜¯è¿™æ ·è§£é‡Šçš„ï¼šå¦‚æœä½¿ç”¨ä¸€ä¸ªå°$d$ä¸ºç§é’¥æ¥æ„é€ $r$ç»„å…¬é’¥ï¼Œè€Œæ„é€ å‡ºçš„æ¨¡æ•°çš„æ•°é‡çº§æ¥è¿‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ ¹æ®$ed\equiv 1 \pmod n$æ„é€ å¦‚ä¸‹çš„å¼å­ï¼š<br>$$<br>e_id &#x3D; 1 + k_i \phi(n_i)<br>$$<br>å…¶ä¸­æˆ‘ä»¬å‡è®¾$n_1&lt;n_2&lt;n_3&lt;â€¦&lt;n_r&lt;2n_1$ã€‚è®ºæ–‡ä¸­è¯´ï¼šå¦‚æœ$\dfrac{\ln d}{\ln n}&#x3D;\delta$ï¼Œåˆ™è‹¥$\delta&lt;0.5-\dfrac{1}{2(r+1)}-\dfrac{\ln \delta}{\ln n_r}$ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ¨¡æ•°$n$éƒ½å¯ä»¥åœ¨å¤šé¡¹å¼çš„æ—¶é—´å¤æ‚åº¦å†…è¢«åˆ†è§£ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ç®€å•åœ°è¯´ä¸€ä¸‹è§£å†³æ–¹æ³•ï¼šå‡è®¾$M&#x3D;(\sqrt n_5)^-$ï¼Œ$s&#x3D;n-\phi(n)$ã€‚(æ³¨ï¼šæœ¬åšå®¢ç”¨ä¸Šæ ‡$+$è¡¨ç¤ºå‘ä¸Šå–æ•´æˆ–æ— é™ä»å³è¶‹è¿‘ï¼Œç”¨ä¸‹æ ‡$-$è¡¨ç¤ºå‘ä¸‹å–æ•´æˆ–è€…æ— é™ä»å·¦è¶‹è¿‘)ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ è¿™æ ·çš„å¼å­ï¼š</p><p><img src="/2021/04/09/VNCTF-WriteUp/1.png" alt="1"></p><p>ç„¶åæˆ‘ä»¬å¯ä»¥æ„é€ ä»¥ä¸‹çš„çŸ©é˜µï¼ˆä»¥$r&#x3D;5$ä¸ºä¾‹ï¼‰</p><p><img src="/2021/04/09/VNCTF-WriteUp/2.png" alt="2"></p><p>æ ¹æ®ä¸Šé¢çš„å¼å­å’Œä¸Šé¢çš„çŸ©é˜µï¼ˆå‡è®¾çŸ©é˜µè®°ä¸º$B$ï¼‰,æˆ‘ä»¬å°±å¯ä»¥æ„é€ $\vec v&#x3D;(d,k_1,k_2,k_3,k_4,k_5),\vec w&#x3D;(d\sqrt{n_5},1-k_1s_1,1-k_2s_2,1-k_3s_3,1-k_4s_4,1-k_5s_5)$ã€‚è¿™æ ·æˆ‘ä»¬å°±æ»¡è¶³$\vec vB&#x3D;\vec w$çš„æ„é€ äº†ã€‚ä¸è¿‡è·Ÿè¿‡å»ä¸åŒçš„æ˜¯ï¼šè¿™æ¬¡è§£å‡ºæ¥çš„æœ€çŸ­å‘é‡ä¸º$\vec v$è€Œä¸æ˜¯å‰å‡ æ¬¡çš„$\vec w$ã€‚æ ¹æ®è¿™ä¸ªé€’æ¨å¼ä¹Ÿå¯ä»¥å‘ç°</p><p>ç”±æ­¤å¯è§ï¼Œåœ¨æ•°æ®è¶³å¤Ÿå¤šçš„æƒ…å†µä¸‹ï¼Œå¦‚æœ$\ln d&lt;0.5\ln n$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰å¯èƒ½è§£å‡ºæ¥$d$çš„å€¼ã€‚æ‰€ä»¥æ ¹æ®æˆ‘ä»¬åœ¨RSAä¸­çš„ç»éªŒï¼Œåœ¨å‘æ”¾å…¬é’¥çš„æ—¶å€™ï¼Œä¸€å®šè¦ä¿è¯$\ln d&gt;\ln n$ã€‚ä¸ç„¶å¾ˆå®¹æ˜“è¢«æ”»ç ´ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼ŒWienerattackæ˜¯$n$ç›¸åŒï¼Œ$d$æ”¹å˜ï¼Œ$\ln d&lt;0.5\ln n$ã€‚è€Œå…±ç§é’¥æŒ‡æ•°æ”»å‡»æ˜¯$d$ç›¸åŒï¼Œ$n$æ”¹å˜ï¼Œ$\ln d&lt;0.5\ln n$ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸Šä¸€ä¸‹è„šæœ¬ï¼Œè¿™é‡Œ$r&#x3D;2$ï¼Œå› æ­¤æ ¼æ˜¯$3$ç»´çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n1=<span class="hljs-number">5362254810180378444.</span>.....<br>e1=<span class="hljs-number">3762917428094791884.</span>.....<br>n2=<span class="hljs-number">1154833387078533235.</span>.....<br>e2=<span class="hljs-number">5794296112064899907.</span>.....<br>c1=<span class="hljs-number">5320050759114401782.</span>.....<br>c2=<span class="hljs-number">5186139432313258226.</span>.....<br><span class="hljs-keyword">assert</span> n2&gt;n1<br>M=<span class="hljs-built_in">int</span>(sqrt(n2))<br>B=[[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]]<br>B[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>],B[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>],B[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]=M,e1,e2<br>B[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>],B[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>]=n1,n2<br>B=Matrix(ZZ,B)<br>B=B.LLL()<br><span class="hljs-keyword">if</span>(B[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]&lt;<span class="hljs-number">0</span>):<br>    B=-B<br>d,t1,t2=B[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]//M,B[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>],B[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]<br>k1,k2=(d*e1-t1)//n1,(d*e2-t2)//n2<br>k1.nbits(),k2.nbits()<br>s1,s2=(t1-<span class="hljs-number">1</span>)//k1-<span class="hljs-number">1</span>,(t2-<span class="hljs-number">1</span>)//k2-<span class="hljs-number">1</span><br>var(<span class="hljs-string">&#x27;x&#x27;</span>)<br>F,G=x^<span class="hljs-number">2</span>-s1*x+n1,x^<span class="hljs-number">2</span>-s2*x+n2<br>p1,q1=F.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>],F.roots()[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]<br>p2,q2=G.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>],G.roots()[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]<br>phi1,phi2=(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>),(p2-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>)<br>d1,d2=inverse(e1,ZZ(phi1)),inverse(e2,ZZ(phi2))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c2,d2,n2)),long_to_bytes(<span class="hljs-built_in">pow</span>(c1,d1,n1)))<br><span class="hljs-comment">#b&#x27;vnctf&#123;7d47956b-bc55-4897-a550-cda0b221ce67&#125; vnctf&#123;7d47956b-bc55-4897-a550-cda0b221ce67&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="3-Strange-Function-1"><a href="#3-Strange-Function-1" class="headerlink" title="3.Strange Function 1"></a>3.Strange Function 1</h2><p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>MENU = <span class="hljs-string">br&#x27;&#x27;&#x27;[+] 1.function</span><br><span class="hljs-string">[+] 2.only_function_numerator</span><br><span class="hljs-string">[+] 3.only_function_denominator</span><br><span class="hljs-string">[+] 4.exit</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;[-] &#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self</span>):<br>        random.seed(os.urandom(<span class="hljs-number">8</span>))<br>        proof = <span class="hljs-string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)])<br>        _hexdigest = sha256(proof.encode()).hexdigest()<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">f&quot;[+] sha256(XXXX+<span class="hljs-subst">&#123;proof[<span class="hljs-number">4</span>:]&#125;</span>) == <span class="hljs-subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())<br>        x = <span class="hljs-variable language_">self</span>.recv(prompt=<span class="hljs-string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(x) != <span class="hljs-number">4</span> <span class="hljs-keyword">or</span> sha256(x+proof[<span class="hljs-number">4</span>:].encode()).hexdigest() != _hexdigest:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">function_only_numerator</span>(<span class="hljs-params">self, x</span>):<br>        <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">        ********</span><br><span class="hljs-string">        * hide *</span><br><span class="hljs-string">        ********</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span><br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">function_only_denominator</span>(<span class="hljs-params">self, x</span>):<br>        <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">        ********</span><br><span class="hljs-string">        * hide *</span><br><span class="hljs-string">        ********</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span><br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">my_round</span>(<span class="hljs-params">self, value, x</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">round</span>(value * (<span class="hljs-number">10</span>**x)) / ((<span class="hljs-number">10</span>**x) * <span class="hljs-number">1.0</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">function</span>(<span class="hljs-params">self, x</span>):<br>        res = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.lenth):<br>            numerator = <span class="hljs-built_in">ord</span>(flag[i])<br>            denominator = x - <span class="hljs-variable language_">self</span>.data[i]<br>            <span class="hljs-keyword">try</span>:<br>                tmp = numerator / denominator<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[+] Error!&#x27;</span>)<br>                <span class="hljs-keyword">return</span><br>            res += tmp<br>        <span class="hljs-keyword">assert</span> <span class="hljs-variable language_">self</span>.my_round(res,<span class="hljs-number">10</span>) == <span class="hljs-variable language_">self</span>.my_round(<span class="hljs-variable language_">self</span>.function_only_numerator(x) / <span class="hljs-variable language_">self</span>.function_only_denominator(x),<span class="hljs-number">10</span>)<br>        <span class="hljs-keyword">return</span> res<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        signal.alarm(<span class="hljs-number">500</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-variable language_">self</span>.proof_of_work():<br>            <span class="hljs-keyword">return</span>        <br>        <span class="hljs-variable language_">self</span>.data = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>            <span class="hljs-variable language_">self</span>.data.append(getRandomInteger(<span class="hljs-number">16</span>))<br>        <span class="hljs-variable language_">self</span>.data.sort()<br>        <span class="hljs-variable language_">self</span>.lenth = <span class="hljs-built_in">len</span>(flag)<br>        <span class="hljs-keyword">assert</span> <span class="hljs-variable language_">self</span>.lenth == <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.data)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[+] Welcome!&#x27;</span>)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[+] Can you find the flag through the calculating?&#x27;</span>)<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-variable language_">self</span>.send(MENU, newline=<span class="hljs-literal">False</span>)<br>            choice = <span class="hljs-variable language_">self</span>.recv()<br>            <span class="hljs-keyword">if</span>(choice == <span class="hljs-string">b&#x27;1&#x27;</span>):<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;[+] Plz give me your x: &quot;</span>)<br>                now = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv().strip().decode())<br>                now = <span class="hljs-variable language_">self</span>.function(now)<br>                <span class="hljs-variable language_">self</span>.send((<span class="hljs-string">&quot;[+] let me show you the answer: &quot;</span>+<span class="hljs-built_in">str</span>(now)).encode())<br>            <span class="hljs-keyword">elif</span>(choice == <span class="hljs-string">b&#x27;2&#x27;</span>):<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;[+] Plz give me your x: &quot;</span>)<br>                now = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv().strip().decode())<br>                now = <span class="hljs-variable language_">self</span>.function_only_numerator(now)<br>                <span class="hljs-variable language_">self</span>.send((<span class="hljs-string">&quot;[+] let me show you the answer: &quot;</span>+<span class="hljs-built_in">str</span>(now)).encode())<br>            <span class="hljs-keyword">elif</span>(choice == <span class="hljs-string">b&#x27;3&#x27;</span>):<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;[+] Plz give me your x: &quot;</span>)<br>                now = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv().strip().decode())<br>                now = <span class="hljs-variable language_">self</span>.function_only_denominator(now)<br>                <span class="hljs-variable language_">self</span>.send((<span class="hljs-string">&quot;[+] let me show you the answer: &quot;</span>+<span class="hljs-built_in">str</span>(now)).encode())<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-variable language_">self</span>.request.close()<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">10001</span><br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä»£ç å®¡è®¡ï¼Œæˆ‘ä»¬å‘ç°ï¼Œé¢˜ç›®ä¼šç»™å‡ºä¸€ä¸ªç§˜å¯†çš„å­—ç¬¦ä¸²$s$ï¼Œå¹¶ç»™å‡ºä¸€ç»„æ•°æ®$a$ï¼Œå…¶ä¸­æ„é€ ä¸€ä¸ªå‡½æ•°ï¼ˆ$t$ä¸ºç¨‹åºè¿›è¡Œçš„è½®æ•°ï¼Œ$5$è½®åç»™å‡ºflagï¼‰<br>$$<br>f(x)&#x3D;\sum_{i&#x3D;1}^{16t} \dfrac{s_i}{x-a_i}<br>$$<br>æ­¤å¤„$a$ä¸­çš„æ•°å­—çš„è§„æ¨¡ä¸º$2^{32}$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹æœåŠ¡å™¨å‘é€$a_i+1$çš„å€¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å¾—æ¯ä¸€ä¸ª$s_i$å€¼çš„éå¸¸ç²¾ç¡®çš„å€¼äº†ã€‚</p><p>ä¸‹é¢ç›´æ¥ç»™å‡ºè§£å¯†è„šæœ¬ã€‚å®é™…ä¸Šå¯¹äºè¿œç¨‹é¢˜æ¥è¯´ï¼š<strong>ç¡®å®šæ¥æ”¶çš„å†…å®¹è¿˜æ˜¯æ¯”è¾ƒå›°éš¾çš„</strong>ï¼Œæœ‰çš„æ—¶å€™å³ä½¿ä½¿ç”¨<code>recvuntil</code>ä¹Ÿæ¯”è¾ƒå¤æ‚ã€‚æ‰€ä»¥æˆªå–ç¨³å®šçš„ä¸¤æ®µå†…å®¹çš„æ—¶å€™ä¸ªäººä¸€èˆ¬ä¹ æƒ¯äºæ•°ä¸‹æ ‡ï¼ˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyanzhengma</span>(<span class="hljs-params">s16,s64</span>):<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s16)==<span class="hljs-number">16</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(s64)==<span class="hljs-number">64</span><br>    table=<span class="hljs-string">&quot;0123456789QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span><br>    <span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> table:<br>        <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> table:<br>            <span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> table:<br>                <span class="hljs-keyword">for</span> i4 <span class="hljs-keyword">in</span> table:<br>                    s=i1+i2+i3+i4+s16<br>                    <span class="hljs-keyword">if</span>(sha256(s.encode()).hexdigest()==s64):<br>                        <span class="hljs-keyword">return</span> i1+i2+i3+i4<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">str_2_list</span>(<span class="hljs-params">s</span>):<br>    li,inli,num,table=[],<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-string">&quot;0123456789&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> table:<br>            inli,num=<span class="hljs-number">1</span>,num*<span class="hljs-number">10</span>+<span class="hljs-built_in">int</span>(i)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> inli==<span class="hljs-number">1</span>:<br>                li.append(num)<br>                inli,num=<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> li,<span class="hljs-built_in">len</span>(li)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">str_2_float</span>(<span class="hljs-params">s</span>):<br>    flo,uit,dot=<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;.&#x27;</span>:<br>            dot=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> dot==<span class="hljs-number">0</span>:<br>            flo=flo*<span class="hljs-number">10</span>+<span class="hljs-built_in">int</span>(i)<br>        <span class="hljs-keyword">else</span>:<br>            flo+=<span class="hljs-built_in">int</span>(i)*uit<br>            uit=uit/<span class="hljs-number">10</span><br>    <span class="hljs-keyword">return</span> flo<br><span class="hljs-comment">#--------MAIN BELOW--------#</span><br>sh=remote(<span class="hljs-string">&quot;node3.buuoj.cn&quot;</span>,<span class="hljs-number">26452</span>)<br>s1=sh.recvuntil(<span class="hljs-string">&#x27;:&#x27;</span>)<br>s2=getyanzhengma(s1[<span class="hljs-number">16</span>:<span class="hljs-number">32</span>],s1[<span class="hljs-number">37</span>:<span class="hljs-number">101</span>])<br>sh.send(s2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[#] sent yanzhengma&#x27;</span>)<br><span class="hljs-keyword">for</span> T <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[#] &#x27;</span>+<span class="hljs-built_in">str</span>(T+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;th Round Begin&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> T:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    <span class="hljs-keyword">else</span>:<br>        s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    tokn,lentokn=str_2_list(s1)<br>    subans=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(lentokn):<br>        s1=sh.recvuntil(<span class="hljs-string">&#x27;xit&#x27;</span>)<br>        sh.send(<span class="hljs-string">&#x27;1&#x27;</span>)<br>        s1=sh.recvuntil(<span class="hljs-string">&#x27;x:&#x27;</span>)<br>        sh.send(<span class="hljs-built_in">str</span>(tokn[i]+<span class="hljs-number">1</span>))<br>        s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>        s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>        subans+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(str_2_float(s1[<span class="hljs-number">36</span>:<span class="hljs-number">48</span>])+<span class="hljs-number">0.5</span>))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[#] &#x27;</span>+<span class="hljs-built_in">str</span>(T+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27; th Round Answer: &#x27;</span>+subans)<br>    sh.recvuntil(<span class="hljs-string">&#x27;xit&#x27;</span>)<br>    sh.send(<span class="hljs-string">&#x27;2&#x27;</span>)<br>    sh.send(subans)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[#] Sent &#x27;</span>+<span class="hljs-built_in">str</span>(T+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;th Round Answer&#x27;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>flag=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>flag=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="4-Strange-Function-2"><a href="#4-Strange-Function-2" class="headerlink" title="4.Strange Function 2"></a>4.Strange Function 2</h2><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹2.0ç‰ˆæœ¬å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ï¼ˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> os<br>MENU = <span class="hljs-string">br&#x27;&#x27;&#x27;[+] 1.function</span><br><span class="hljs-string">[+] 2.check_answer</span><br><span class="hljs-string">[+] 3.exit</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = <span class="hljs-variable language_">self</span>.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            <span class="hljs-variable language_">self</span>.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;[-] &#x27;</span></span>):<br>        <span class="hljs-variable language_">self</span>.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._recvall()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self</span>):<br>        random.seed(os.urandom(<span class="hljs-number">8</span>))<br>        proof = <span class="hljs-string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)])<br>        _hexdigest = sha256(proof.encode()).hexdigest()<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">f&quot;[+] sha256(XXXX+<span class="hljs-subst">&#123;proof[<span class="hljs-number">4</span>:]&#125;</span>) == <span class="hljs-subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())<br>        x = <span class="hljs-variable language_">self</span>.recv(prompt=<span class="hljs-string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(x) != <span class="hljs-number">4</span> <span class="hljs-keyword">or</span> sha256(x+proof[<span class="hljs-number">4</span>:].encode()).hexdigest() != _hexdigest:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">function</span>(<span class="hljs-params">self, x</span>):<br>        res = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.lenth):<br>            numerator = <span class="hljs-built_in">ord</span>(<span class="hljs-variable language_">self</span>.token[i])<br>            denominator = x - <span class="hljs-variable language_">self</span>.data[i]<br>            <span class="hljs-keyword">try</span>:<br>                tmp = numerator / denominator<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[+] Error!&#x27;</span>)<br>                <span class="hljs-keyword">return</span><br>            res += tmp<br>        <span class="hljs-keyword">return</span> res<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        signal.alarm(<span class="hljs-number">1000</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-variable language_">self</span>.proof_of_work():<br>            <span class="hljs-keyword">return</span>            <br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[+] Welcome!&#x27;</span>)<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[+] Can you find the flag through the calculating?&#x27;</span>)<br>        <span class="hljs-variable language_">self</span>.score = <span class="hljs-number">0</span><br>        <span class="hljs-variable language_">self</span>.token = <span class="hljs-string">&#x27;&#x27;</span>.join(random.sample(string.ascii_letters + string.digits, <span class="hljs-number">8</span>))<br>        <span class="hljs-variable language_">self</span>.lenth = <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.token)<br>        <span class="hljs-variable language_">self</span>.data = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.lenth):<br>            <span class="hljs-variable language_">self</span>.data.append(getRandomInteger(<span class="hljs-number">17</span>))<br>        <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">str</span>(<span class="hljs-variable language_">self</span>.data).encode())<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-variable language_">self</span>.send(MENU, newline=<span class="hljs-literal">False</span>)<br>            choice = <span class="hljs-variable language_">self</span>.recv()<br>            <span class="hljs-keyword">if</span>(choice == <span class="hljs-string">b&#x27;1&#x27;</span>):<br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;[+] Plz give me your x: &quot;</span>)<br>                now = <span class="hljs-built_in">int</span>(<span class="hljs-variable language_">self</span>.recv().strip().decode())<br>                now = <span class="hljs-variable language_">self</span>.function(now)<br>                <span class="hljs-variable language_">self</span>.send((<span class="hljs-string">&quot;[+] let me show you the answer: &quot;</span>+<span class="hljs-built_in">str</span>(now)).encode())<br>            <span class="hljs-keyword">elif</span>(choice == <span class="hljs-string">b&#x27;2&#x27;</span>):<br>                guess = <span class="hljs-variable language_">self</span>.recv().strip().decode()<br>                <span class="hljs-keyword">if</span>(guess == <span class="hljs-variable language_">self</span>.token):<br>                    <span class="hljs-variable language_">self</span>.score += <span class="hljs-number">1</span><br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;[+] You win!&quot;</span>)<br>                    <span class="hljs-variable language_">self</span>.send((<span class="hljs-string">&quot;[!] Now your score: &quot;</span> + <span class="hljs-built_in">str</span>(<span class="hljs-variable language_">self</span>.score)).encode())<br><br>                    <span class="hljs-variable language_">self</span>.token = <span class="hljs-string">&#x27;&#x27;</span>.join([random.choice(string.digits + string.ascii_letters) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>((<span class="hljs-variable language_">self</span>.score+<span class="hljs-number">1</span>)*<span class="hljs-number">8</span>)])<br>                    <span class="hljs-variable language_">self</span>.lenth = <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.token)<br>                    <span class="hljs-variable language_">self</span>.data = []<br>                    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.lenth):<br>                        <span class="hljs-variable language_">self</span>.data.append(getRandomInteger(<span class="hljs-number">17</span>))<br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">str</span>(<span class="hljs-variable language_">self</span>.data).encode())<br>                    <br>                    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">self</span>.score &gt;= <span class="hljs-number">5</span>):<br>                        <span class="hljs-variable language_">self</span>.send(flag.encode())<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[+] What do you want to say???&#x27;</span>)<br>                    <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&#x27;[!] Go away!&#x27;</span>)<br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-variable language_">self</span>.request.close()<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST, PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, <span class="hljs-number">10002</span><br>    server = ForkedServer((HOST, PORT), Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    server.serve_forever()<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸åŒï¼š</p><p>åœ¨å‡½æ•°<br>$$<br>f(x)&#x3D;\sum_{i&#x3D;1}^{8t} \dfrac{s_i}{x-a_i}<br>$$<br>é‡Œé¢ï¼Œ$a_i$çš„è§„æ¨¡ä»$2^{32}$é™åˆ°äº†$2^{17}$ï¼Œè¿™å°±å¯¼è‡´äº†æ¯å½“æˆ‘ä»¬è¾“å…¥$x&#x3D;a_i+1$åï¼Œç»™å‡ºæ¥çš„æ•°æ®åç¦»æ•´æ•°è¾ƒå¤§ï¼Œå¦‚æœæˆ‘æˆ‘ä»¬è¿™ä¸ªæ—¶å€™ç»§ç»­ç”¨ç¬¬ä¸‰é¢˜ä¸­çš„ä»£ç ï¼Œä¼šå¯¼è‡´éƒ¨åˆ†æ•°å­—å‡ºç°å½¢å¦‚$109.47886234,53.53195675$ç­‰è¿™ç§ç¦»æ•´æ•°è¾ƒè¿œçš„æ•°æ®ï¼Œç”šè‡³å‡ºç°äº†$61.06428516$ï¼ˆå› ä¸º<code>9</code>çš„ASCIIç å€¼æ˜¯$57$ï¼Œ<code>A</code>çš„ASCIIç å€¼æ˜¯$65$ï¼Œè¯´æ˜è¿™ç§æƒ…å†µä¸‹å™ªå£°å·²ç»è¿œè¿œè¶…è¿‡äº†$1$ï¼‰ã€‚ç›´æ¥è·‘çš„è¯å¿…ç„¶ä¼šå‡ºé”™ã€‚</p><p>ç„¶è€Œï¼Œè™½ç„¶è¿™é‡Œä¼šå‡ºç°ä¸€ä¸ªè¾ƒå¤§çš„è¯¯å·®ï¼Œä¸è¿‡æ˜¯å¤šä¸ªè¯¯å·®å åŠ è€Œæˆï¼Œè¿™é‡Œæˆ‘ä»¬è·å¾—çš„æ•°æ®å®é™…ä¸Šååº”äº†$s_i$çš„å¤§æ¦‚å€¼ï¼Œå› æ­¤æˆ‘ä»¬è€ƒè™‘é™å™ªçš„æ—¶å€™ï¼Œ</p><p>è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦å¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œä¸€ä¸ªå¤„ç†ï¼š</p><p>è§‚å¯Ÿè¿™ä¸ªå‡½æ•°ï¼ˆ<del>æˆ‘çªç„¶æƒ³åˆ°äº†XDUçš„REå¤§ä½¬Innerspaceå«æ ‘ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå¿«é€ƒ</del>ï¼‰<br>$$<br>f(x)&#x3D;\sum_{i&#x3D;1}^{8t} \dfrac{s_i}{x-a_i}<br>$$<br>æˆ‘ä»¬æ”¹å˜ä¸€ä¸‹ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦æå–$s_j$ï¼ˆæˆ‘ä»¬å·²çŸ¥$x&#x3D;a_j+1$ï¼Œå› æ­¤å·¦è¾¹çš„åˆ†æ¯å€¼æ˜¯$1$ï¼Œä¸è¿‡ç”±äºæµ®ç‚¹è¯¯å·®ç­‰åŸå› ï¼Œ$x-a_i$ä¸ä¼šä¸¥æ ¼ç­‰äº$1$ï¼Œä½†éå¸¸æ¥è¿‘$1$ï¼‰ã€‚<br>$$<br>\dfrac{s_j}{x-a_j}&#x3D;f(x)-\sum_{i\in [1,8t],i\not &#x3D;j}\dfrac{s_i}{x-a_i}<br>$$<br>å› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆè·å–æˆ‘ä»¬é€šè¿‡æ¯æ¬¡å‘é€$a_j+1$çš„å€¼ï¼Œå…ˆå­˜å‚¨æˆ‘ä»¬æ¥æ”¶åˆ°çš„æµ®ç‚¹æ•°ï¼Œç„¶åé€šè¿‡é™å™ªå¤„ç†,è·å¾—æˆ‘ä»¬çœŸæ­£éœ€è¦çš„$s_j$å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">ReduceError</span>(<span class="hljs-params">tokn,lflo</span>):<br>    lflo2=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tokn)):<br>        cnt=lflo[i]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tokn)):<br>            <span class="hljs-keyword">if</span> i==j:<br>                <span class="hljs-keyword">continue</span><br>            cnt-=lflo[j]/(-tokn[j]+tokn[i]+<span class="hljs-number">1</span>)<br>        lflo2.append(cnt)<br>    <span class="hljs-keyword">return</span> lflo2<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬é€šè¿‡ReduceErrorå¤„ç†ä¸€ä¸‹ï¼Œå°±è·å¾—äº†æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ã€‚ç„¶åç›´æ¥ä¸€éè¿‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyanzhengma</span>(<span class="hljs-params">s16,s64</span>):<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s16)==<span class="hljs-number">16</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(s64)==<span class="hljs-number">64</span><br>    table=<span class="hljs-string">&quot;0123456789QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span><br>    <span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> table:<br>        <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> table:<br>            <span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> table:<br>                <span class="hljs-keyword">for</span> i4 <span class="hljs-keyword">in</span> table:<br>                    s=i1+i2+i3+i4+s16<br>                    <span class="hljs-keyword">if</span>(sha256(s.encode()).hexdigest()==s64):<br>                        <span class="hljs-keyword">return</span> i1+i2+i3+i4<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">str_2_list</span>(<span class="hljs-params">s</span>):<br>    li,inli,num,table=[],<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-string">&quot;0123456789&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> i <span class="hljs-keyword">in</span> table:<br>            inli,num=<span class="hljs-number">1</span>,num*<span class="hljs-number">10</span>+<span class="hljs-built_in">int</span>(i)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> inli==<span class="hljs-number">1</span>:<br>                li.append(num)<br>                inli,num=<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> li,<span class="hljs-built_in">len</span>(li)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">str_2_float</span>(<span class="hljs-params">s</span>):<br>    flo,uit,dot=<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;.&#x27;</span>:<br>            dot=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> dot==<span class="hljs-number">0</span>:<br>            flo=flo*<span class="hljs-number">10</span>+<span class="hljs-built_in">int</span>(i)<br>        <span class="hljs-keyword">else</span>:<br>            flo+=<span class="hljs-built_in">int</span>(i)*uit<br>            uit=uit/<span class="hljs-number">10</span><br>    <span class="hljs-keyword">return</span> flo<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ReduceError</span>(<span class="hljs-params">tokn,lflo</span>):<br>    lflo2=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tokn)):<br>        cnt=lflo[i]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tokn)):<br>            <span class="hljs-keyword">if</span> i==j:<br>                <span class="hljs-keyword">continue</span><br>            cnt-=lflo[j]/(-tokn[j]+tokn[i]+<span class="hljs-number">1</span>)<br>        lflo2.append(cnt)<br>    <span class="hljs-keyword">return</span> lflo2<br><span class="hljs-comment">#--------MAIN BELOW--------#</span><br>sh=remote(<span class="hljs-string">&quot;node3.buuoj.cn&quot;</span>,<span class="hljs-number">25102</span>)<br>s1=sh.recvuntil(<span class="hljs-string">&#x27;:&#x27;</span>)<br>s2=getyanzhengma(s1[<span class="hljs-number">16</span>:<span class="hljs-number">32</span>],s1[<span class="hljs-number">37</span>:<span class="hljs-number">101</span>])<br>sh.send(s2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[#] sent yanzhengma&#x27;</span>)<br><span class="hljs-keyword">for</span> T <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    lflo=[]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[#] &#x27;</span>+<span class="hljs-built_in">str</span>(T+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;th Round Begin&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> T:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    <span class="hljs-keyword">else</span>:<br>        s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    tokn,lentokn=str_2_list(s1)<br>    subans=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(lentokn):<br>        s1=sh.recvuntil(<span class="hljs-string">&#x27;xit&#x27;</span>)<br>        sh.send(<span class="hljs-string">&#x27;1&#x27;</span>)<br>        s1=sh.recvuntil(<span class="hljs-string">&#x27;x:&#x27;</span>)<br>        sh.send(<span class="hljs-built_in">str</span>(tokn[i]+<span class="hljs-number">1</span>))<br>        s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>        s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>        lflo.append(str_2_float(s1[<span class="hljs-number">36</span>:<span class="hljs-number">48</span>]))<br>    <span class="hljs-built_in">print</span>(lflo)<br>    lflo=ReduceError(tokn,lflo)<br>    <span class="hljs-built_in">print</span>(lflo)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lflo:<br>        subans+=<span class="hljs-built_in">str</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(i+<span class="hljs-number">0.5</span>)))<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[#] &#x27;</span>+<span class="hljs-built_in">str</span>(T+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27; th Round Answer: &#x27;</span>+subans)<br>    sh.recvuntil(<span class="hljs-string">&#x27;xit&#x27;</span>)<br>    sh.send(<span class="hljs-string">&#x27;2&#x27;</span>)<br>    sh.send(subans)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[#] Sent &#x27;</span>+<span class="hljs-built_in">str</span>(T+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;th Round Answer&#x27;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        s1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>flag=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>flag=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹çš„è¿è¡Œæˆªå›¾ï¼Œåæ˜ äº†é™å™ªåæ•°æ®çš„åˆç†æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œé™å™ªåçš„æ•°æ®è¿˜æ˜¯éå¸¸é è¿‘æ•´æ•°å€¼çš„ã€‚</p><p><img src="/2021/04/09/VNCTF-WriteUp/F7.jpg" alt="F7"></p><p>è¿™é‡ŒDeeBaToå¤§ä½¬ä¹Ÿæä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œç”¨çš„æ˜¯ä¸­é—´ASCIIç äº¤å‰çš„æ–¹å¼ï¼Œä»ä¸­é—´çš„ASCIIå€¼$85$é€¼è¿‘ï¼Œç›¸å½“äºä¸€ç§ä¸¢ç•ªå›¾çš„æ€æƒ³ã€‚</p><p>ç½‘é¡µé“¾æ¥<a href="https://d33b4t0.com/2021/03/28/VNCTF2021Wp/">Deebato-VNCTFWP-2021-3-28</a></p><p><del>ï¼ˆæœ¬æ¥æ‰“ç®—æŠŠä»£ç æ”¾è¿›æ¥çš„ï¼Œä¸è¿‡å¤åˆ¶å‡ºäº†é—®é¢˜ï¼Œå°±ä¸æ”¾äº†å§ï¼‰</del></p><h2 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5.æ€»ç»“"></a>5.æ€»ç»“</h2><p>VNCTFçš„5é“é¢˜ç›®ï¼Œä¸ªäººè®¤ä¸ºæ€»ä½“è´¨é‡è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ã€‚ä¸è¿‡è‡ªå·±æ°´å¹³è¿˜æ˜¯å¤ªèœäº†ï¼Œå¯¼è‡´ä¸€ä¸ªæœˆåæ‰è¿›è¡Œå¤ç°ã€‚</p><p>æœ€è¿‘é¦–å½“å…¶å†²çš„æ˜¯CET6çš„å‡†å¤‡ï¼Œäº‰å–ä¸€æ¬¡è¿‡ï¼Œè¿‡äº†CET6ï¼Œè‹±è¯­ç›´æ¥è·‘è·¯ã€‚</p><p>ç„¶åè¿˜è¦å¤ä¹ é«˜æ•°å¤§ç‰©ç”µè·¯C++</p><p><code>huangx607087,å»å¤ä¹ ï¼Œgkdï¼Œä¸ç„¶ä½ æœŸæœ«å°±æŒ‚ç§‘äº†</code></p><p><del>æˆ‘ä»¿ä½›å·²ç»çœ‹åˆ°äº†è‡ªå·±æœŸæœ«é«˜æ•°å’Œå¤§ç‰©æŒ‚äº†çš„åœºæ™¯</del></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ECCNotes3</title>
    <link href="/2021/03/25/ECCNotes3/"/>
    <url>/2021/03/25/ECCNotes3/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ ECCçš„ç¬”è®°3"><a href="#huangx607087å­¦ä¹ ECCçš„ç¬”è®°3" class="headerlink" title="huangx607087å­¦ä¹ ECCçš„ç¬”è®°3"></a>huangx607087å­¦ä¹ ECCçš„ç¬”è®°3</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>è¿™ä¸€ç³»åˆ—ä¸»è¦ä»‹ç»å‡ ç§ECCçš„åŠ å¯†æ–¹æ³•ï¼Œä»¥åŠé€šè¿‡å¯¹RSAçš„ç±»æ¯”ï¼Œå°†RSAä¸­å¸¸è§çš„å‡ ç§æ”»å‡»æ–¹æ³•åº”ç”¨äºECCä¸Šã€‚</p><p>3æœˆ23æ—¥ï¼Œè‡ªå·±è¿›äº†X1cï¼Œæ„Ÿè°¢Am4å¸ˆå‚…ä¸€è·¯å¸¦æˆ‘ï¼Œè‡ªå·±åé¢è¦æ›´åŠ åŠªåŠ›ã€‚ç„¶è€Œè‡ªå·±è¿˜æœ‰6æœˆçš„å…­çº§å’ŒæœŸæœ«è€ƒè¯•ï¼Œï¼ˆä¸€å®šè¦è¿‡å…­çº§ï¼ŒæœŸæœ«è€ƒè¯•ä¸€å®šè¦å…¨è¿‡ã€‚ã€‚ä¸è¿‡å¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œè‡ªå·±ä¼šåœ¨æš‘å‡å¯»æ±‚ä¸€ä¸ªçªç ´ã€‚åœ¨9æœˆèƒ½å¤Ÿæˆä¸ºAm4å¸ˆå‚…é‚£æ ·ï¼ˆx</p><h2 id="1-æ¤­åœ†æ›²çº¿ä¸Šçš„é™¤å¼"><a href="#1-æ¤­åœ†æ›²çº¿ä¸Šçš„é™¤å¼" class="headerlink" title="1.æ¤­åœ†æ›²çº¿ä¸Šçš„é™¤å¼"></a>1.æ¤­åœ†æ›²çº¿ä¸Šçš„é™¤å¼</h2><p>åœ¨æ¤­åœ†æ›²çº¿$y^2&#x3D;x^3+ax+b$ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰è¿™æ ·çš„é™¤å¼ï¼š<br>$$<br>F_{-1},F_0,F_1,F_2,F_3&#x3D;-1,0,1,2y,3x^4+6ax^2+12bx-a^2<br>$$</p><p>$$<br>F_4&#x3D;4y(x^6+5ax^4+20bx^3-5a^2x^2-4abx-8b^2-a^3)<br>$$</p><p>$$<br>F_{2i}&#x3D;F_{i+2}F_{i}^3-F_{i+1}^3F_{i-1}<br>$$</p><p>$$<br>F_{2i+1}&#x3D;\dfrac{F_i(F_{i+2}F_{i-1}^2-F_{i-2}F^2_{i+1})}{2y}<br>$$</p><p>é¡ºä¾¿æˆ‘ä»¬åœ¨å®šä¹‰ä¸€ä¸‹å¤šé¡¹å¼$G,H$<br>$$<br>G_{i}&#x3D;xF_i^2-F_{i+1}F_{i-1}<br>$$</p><p>$$<br>H_i&#x3D;(F_{i+2}F_{i-1}^2-F_{i-2}F^2_{i+1}) &#x2F;4y<br>$$</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹çš„å¼å­ï¼š<br>$$<br>mP&#x3D;(\dfrac{G_m(P)}{F_m^2(P)},\dfrac{H_m(P)}{F_m^3(P)})<br>$$<br>è€Œè¿™ä¸ªå¼å­å¦‚æœæƒ³å®ç°çš„è¯ï¼Œå¯ä»¥è°ƒç”¨sagemathä¸­çš„<code>_multiple_x_numerator</code>,<code>_multiple_x_denominator</code>ä¸¤ä¸ªå‡½æ•°æ¥å®ç°å¯¹$x$åæ ‡çš„æ•°ä¹˜çš„å¤šé¡¹å¼ï¼ˆæœ€ç»ˆç”¨$x$è¡¨ç¤ºï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">E=EllipticCurve(GF(<span class="hljs-number">10007</span>),[<span class="hljs-number">5362</span>,<span class="hljs-number">7045</span>])<br>Fz=E._multiple_x_numerator(<span class="hljs-number">7</span>)<br>Fz<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">x^49 + 9573*x^47 + 1673*x^46 + 9230*x^45 + 7088*x^44 + 2559*x^43 + 1491*x^42 + 1730*x^41 + 1886*x^40 + 8655*x^39 + 9529*x^38 + 2785*x^37 + 3587*x^36 + 3847*x^35 + 3439*x^34 + 1171*x^33 + 7340*x^32 + 2033*x^31 + 5346*x^30 + 3021*x^29 + 6843*x^28 + 1123*x^27 + 6261*x^26 + 4150*x^25 + 5110*x^24 + 9659*x^23 + 8409*x^22 + 6218*x^21 + 1501*x^20 + 4233*x^19 + 4240*x^18 + 5172*x^17 + 2625*x^16 + 1767*x^15 + 5499*x^14 + 7768*x^13 + 308*x^12 + 1527*x^11 + 2631*x^10 + 6193*x^9 + 6584*x^8 + 9405*x^7 + 1509*x^6 + 7683*x^5 + 3994*x^4 + 8777*x^3 + 2600*x^2 + 3465*x + 993</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>ç»è¿‡æ•°æ®çš„è§‚å¯Ÿå¯ä»¥çœ‹å‡ºï¼Œ$mP$ä¸­$x$åæ ‡çš„åˆ†å­è¡¨è¾¾å¼æ¬¡æ•°æ€»æ˜¯$m^2$ï¼Œåˆ†æ¯æ¬¡æ•°æ€»æ˜¯$m^2-1$ï¼Œè¿™ä¹Ÿå°è¯äº†ä¹‹å‰<strong>ç¬”è®°1</strong>ä¸­æåˆ°çš„$\ln u$æ­£æ¯”äº$m^2$çš„ç»“è®ºã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯¹æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹åŠ å¯†çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ¨ªåæ ‡$x$ï¼Œç„¶ååœ¨æ¤­åœ†æ›²çº¿ä¸Šæ‰¾ç‚¹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€‰å–ä¸€ä¸ªæ•´æ•°$k$ï¼Œæ˜æ–‡$m$ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—$m^3+am+b$æ˜¯å¦æ˜¯æ¨¡$q$çš„äºŒæ¬¡å‰©ä½™ã€‚å¦‚æœæ˜¯çš„è¯ï¼Œç›´æ¥å¯¹ç»“æœå¼€å¹³æ–¹å³å¯ï¼ˆè§æˆ‘ä¹‹å‰æ•°è®ºç¬”è®°ï¼‰ã€‚å¦‚æœä¸æ˜¯çš„è¯ï¼Œæˆ‘ä»¬è®¡ç®—$m+1$ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¦åˆçš„$m$å€¼ã€‚æ ¹æ®äºŒæ¬¡å‰©ä½™çš„åˆ†å¸ƒå¯çŸ¥ï¼Œæˆ‘ä»¬æ‰¾ä¸åˆ°çš„æœŸæœ›å€¼ä¸º$\dfrac 1 {2^k}$ã€‚</p><h2 id="2-å‡ ç§ECCåŠ å¯†ç®—æ³•"><a href="#2-å‡ ç§ECCåŠ å¯†ç®—æ³•" class="headerlink" title="2.å‡ ç§ECCåŠ å¯†ç®—æ³•"></a>2.å‡ ç§ECCåŠ å¯†ç®—æ³•</h2><p>ä¹‹å‰æˆ‘ä»¬è®²è¿‡DHå¯†é’¥äº¤æ¢å’ŒElgamalåŠ å¯†ç³»ç»Ÿï¼Œè¿™é‡Œæˆ‘ä»¬å¤šä»‹ç»å‡ ä¸ªåŸºäºECCçš„åŠ å¯†ç³»ç»Ÿã€‚</p><h3 id="0x01-DemytkoåŠ å¯†"><a href="#0x01-DemytkoåŠ å¯†" class="headerlink" title="0x01 DemytkoåŠ å¯†"></a>0x01 DemytkoåŠ å¯†</h3><h4 id="1-åŠ å¯†"><a href="#1-åŠ å¯†" class="headerlink" title="1.åŠ å¯†"></a>1.åŠ å¯†</h4><p>å¯»æ‰¾ä¸¤ä¸ªå¤§ç´ æ•°$p,q$ï¼Œç„¶åè®¡ç®—$n&#x3D;pq$ã€‚ç„¶åç¡®å®šæ¤­åœ†æ›²çº¿çš„ç³»æ•°$a,b$ï¼Œå¹¶ä¿è¯$\gcd(4a^3+27b^2,n)&#x3D;1$ã€‚</p><p>ç„¶åæˆ‘ä»¬è®¡ç®—$N_1,N_2,N_3,N_4&#x3D;|E_p|,2p+2-N_1,|E_q|,2q+2-N_3$ã€‚ ç”±äºè‡ªå·±åšå®¢ä¸­æŸäº›ç¬¦å·æ— æ³•æ‰“å‡ºæ¥ï¼Œå› æ­¤æˆ‘ä»¬å€Ÿç”¨ç¬¦å·$|D|$è¡¨ç¤ºé›†åˆ$D$ä¸­çš„å…ƒç´ ä¸ªæ•°è€Œä¸æ˜¯æˆ‘æ‰“ä¸å‡ºæ¥çš„é‚£ä¸ªç¬¦å·<del>ï¼ˆå› ä¸ºæ‰“é‚£ä¸ªç¬¦å·åšå®¢å¤„ç†æ—¶ä¼šå‡ºä¸¥é‡é—®é¢˜å¯¼è‡´markdownæ··ä¹±</del></p><p>æ¥ç€é€‰å–$e$ä¿è¯$\gcd(e,N_i)&#x3D;1$å³å¯ã€‚å…¶ä¸­$i$ä¸º$1$åˆ°$4$ã€‚åŒæ—¶è®¡ç®—$d_1,d_2,d_3,d_4$åˆ†åˆ«ä¸º$e$åœ¨æ¨¡$\dfrac{N_1N_3}{\gcd(N_1N_3)},\dfrac{N_1N_4}{\gcd(N_1N_4)},\dfrac{N_2N_3}{\gcd(N_2N_3)},\dfrac{N_2N_4}{\gcd(N_2N_4)}$ä¸‹çš„é€†å…ƒã€‚</p><p>è®¡ç®—å‡ºè¿™äº›æ•°å€¼ä¹‹åï¼Œæˆ‘ä»¬æŠŠ$n,e,u$ä½œä¸ºå…¬é’¥ï¼Œ$p,q,d_1,d_2,d_3,d_4$ä½œä¸ºç§é’¥ã€‚</p><p>åŠ å¯†æ—¶ï¼Œé€‰å–ç‚¹$P$æ»¡è¶³å…¶æ¨ªåæ ‡ä¸º$m$ï¼Œç„¶åè®¡ç®—$c&#x3D;(eP)_x$ã€‚</p><h4 id="2-è§£å¯†"><a href="#2-è§£å¯†" class="headerlink" title="2.è§£å¯†"></a>2.è§£å¯†</h4><p>è§£å¯†æ–¹è®¡ç®—$w&#x3D;c^3+ac+b$ï¼Œç„¶ååœ¨$d_1$åˆ°$d_4$ä¸­é€‰æ‹©ä¸€ä¸ªè¿™æ ·çš„ç§é’¥ç”¨äºè§£å¯†ï¼Œæ–¹æ³•å¦‚ä¸‹ã€‚ä¸ºä¸åˆ†æ•°çš„å‡ºå‘åŒºåˆ†å¼€ï¼Œä»¥ä¸‹ç”¨$\mathrm{lgd}(\dfrac{a}{b})$æ¥è¡¨ç¤º$a$æ˜¯å¦æ˜¯$b$çš„äºŒæ¬¡å‰©ä½™ï¼Œè‹¥æ˜¯å€¼ä¸º$1$ï¼Œä¸æ˜¯çš„è¯å€¼ä¸º$-1$ã€‚ç›¸å…³å†…å®¹å¯è§<strong>0xGame Div 4</strong>ã€‚</p><table><thead><tr><th align="center">$\mathrm{lgd}(\dfrac{w}{p})$</th><th align="center">$\mathrm{lgd}(\dfrac{w}{q})$</th><th align="center">é€‰å–ç§é’¥$d$</th></tr></thead><tbody><tr><td align="center">$1$</td><td align="center">$1$</td><td align="center">$d_1$</td></tr><tr><td align="center">$1$</td><td align="center">$-1$</td><td align="center">$d_2$</td></tr><tr><td align="center">$-1$</td><td align="center">$1$</td><td align="center">$d_3$</td></tr><tr><td align="center">$-1$</td><td align="center">$-1$</td><td align="center">$d_4$</td></tr></tbody></table><p>ç„¶åé€‰å–ç‚¹$Q$ä½¿å¾—å…¶æ¨ªåæ ‡ä¸º$c^3+ac+b$ï¼Œç„¶åè®¡ç®—$dQ$å³å¯ï¼Œå…¶æ¨ªåæ ‡å°±æ˜¯$m$ã€‚</p><p>ä¸ºäº†å¿«é€Ÿåœ°ç®—å‡º$|E_p|,|E_q|$ï¼Œæˆ‘ä»¬å¯ä»¥é€‰å–$p\equiv q\equiv 2 \pmod 3$ä¸”$a&#x3D;0$æˆ–è€…$p\equiv q\equiv 3 \pmod 4$ä¸”$a&#x3D;0$ï¼Œé‚£ä¹ˆ$|E_p|&#x3D;p+1,|E_q|&#x3D;q+1$ã€‚</p><h3 id="0x02-KMOVç®—æ³•"><a href="#0x02-KMOVç®—æ³•" class="headerlink" title="0x02 KMOVç®—æ³•"></a>0x02 KMOVç®—æ³•</h3><h4 id="1-åŠ å¯†-1"><a href="#1-åŠ å¯†-1" class="headerlink" title="1.åŠ å¯†"></a>1.åŠ å¯†</h4><p>å¯»æ‰¾ä¸¤ä¸ªå¤§ç´ æ•°$p,q$ï¼Œç„¶åè®¡ç®—$n&#x3D;pq$ã€‚ç„¶åç¡®å®šæ¤­åœ†æ›²çº¿çš„ç³»æ•°$a,b$ï¼Œå¹¶ä¿è¯$\gcd(4a^3+27b^2,n)&#x3D;1$ã€‚</p><p>ç„¶åè®¡ç®—$N_1,N_2&#x3D;|E_p|,|E_q|$ã€‚å¹¶é€‰æ‹©$e$ä½¿å¾—$\gcd(e,N_1)&#x3D;\gcd(e,N_2)&#x3D;1$ã€‚åŒæ—¶è®¡ç®—$d$æ˜¯$e$æ¨¡$\dfrac{N_1N_2}{\gcd{N_1N_2}}$çš„é€†å…ƒã€‚</p><p>å…¶ä¸­å…¬é’¥ä¸º$n,e,a,b$ï¼Œç§é’¥ä¸º$p,q,d$ã€‚</p><p>åŠ å¯†æ—¶ï¼Œç›´æ¥è®¡ç®—$C&#x3D;eP$çš„å€¼å³å¯ã€‚</p><h4 id="2-è§£å¯†-1"><a href="#2-è§£å¯†-1" class="headerlink" title="2.è§£å¯†"></a>2.è§£å¯†</h4><p>ç›´æ¥è®¡ç®—$dC&#x3D;P$ã€‚</p><p>ç„¶è€Œï¼Œè¿™ä¸ªåŠ å¯†ç®—æ³•æœ‰ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ç¼ºç‚¹ï¼Œå°±æ˜¯é™¤éä½¿ç”¨äº†ç‰¹æ®Šçš„æ›²çº¿å’Œç‰¹æ®Šçš„ç´ æ•°ï¼Œä¸ç„¶è®¡ç®—$|E_p|,|E_q|$å¼ä¸€ä»¶éå¸¸éš¾çš„äº‹æƒ…ã€‚å› æ­¤ï¼Œ1991å¹´æœ‰äººå¯¹è¿™ä¸ªç³»ç»Ÿè¿›è¡Œäº†æ”¹è¿›ï¼Œç»™å‡ºäº†KMOV91ã€‚</p><h4 id="3-KMOV91"><a href="#3-KMOV91" class="headerlink" title="3.KMOV91"></a>3.KMOV91</h4><p>åœ¨KMOV91ä¸­ï¼Œç›´æ¥é€‰å–$p\equiv q\equiv 2 \pmod 3$ï¼Œä½¿å¾—$N_1,N_2&#x3D;p+1,q+1$ã€‚å…¶ä¸­$n,e$ä¸ºå…¬é’¥ï¼Œ$p,q,d$ä¸ºç§é’¥ã€‚è€Œä½¿ç”¨æ¤­åœ†æ›²çº¿$y^2&#x3D;x^3+b,b&#x3D;P_y^2-P_x^3$ã€‚æœ€åä¿è¯$P_x^3 \not \equiv  P_y^2 \pmod n$å³å¯è¿›è¡ŒåŠ å¯†ã€‚å…¶ä»–è¿‡ç¨‹ä¸åŸæ¥ä¸€æ ·ã€‚</p><h2 id="3-è¿‘æœŸCTFä¸­åŸºäºæ¤­åœ†æ›²çº¿çš„æ”»å‡»æ–¹æ³•"><a href="#3-è¿‘æœŸCTFä¸­åŸºäºæ¤­åœ†æ›²çº¿çš„æ”»å‡»æ–¹æ³•" class="headerlink" title="3.è¿‘æœŸCTFä¸­åŸºäºæ¤­åœ†æ›²çº¿çš„æ”»å‡»æ–¹æ³•"></a>3.è¿‘æœŸCTFä¸­åŸºäºæ¤­åœ†æ›²çº¿çš„æ”»å‡»æ–¹æ³•</h2><h3 id="1-ECCä½æŒ‡æ•°å¹¿æ’­æ”»å‡»-NepCTF-lowExpoent"><a href="#1-ECCä½æŒ‡æ•°å¹¿æ’­æ”»å‡»-NepCTF-lowExpoent" class="headerlink" title="1. ECCä½æŒ‡æ•°å¹¿æ’­æ”»å‡» NepCTF lowExpoent"></a>1. ECCä½æŒ‡æ•°å¹¿æ’­æ”»å‡» NepCTF lowExpoent</h3><h4 id="0o01-åˆ†æé¢˜ç›®"><a href="#0o01-åˆ†æé¢˜ç›®" class="headerlink" title="0o01.åˆ†æé¢˜ç›®"></a>0o01.åˆ†æé¢˜ç›®</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Encrypt</span>(<span class="hljs-params">e, nbits, msg</span>):<br>    p, q = [getPrime(<span class="hljs-built_in">int</span>(nbits)) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>    N = p*q<br>    x = <span class="hljs-built_in">int</span>(msg)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        a, b = [getRandomRange(<span class="hljs-number">1</span>, N) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>        P.&lt;Yp&gt; = PolynomialRing(Zmod(p))<br>        fp = x^<span class="hljs-number">3</span> + a*x + b - Yp^<span class="hljs-number">2</span><br>        P.&lt;Yq&gt; = PolynomialRing(Zmod(q))<br>        fq = x^<span class="hljs-number">3</span> + a*x + b - Yq^<span class="hljs-number">2</span><br>        <span class="hljs-keyword">try</span>:<br>            yp, yq = <span class="hljs-built_in">int</span>(fp.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]), <span class="hljs-built_in">int</span>(fq.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br>            y = crt([yp, yq], [p, q])<br>            E = EllipticCurve(IntegerModRing(N), [a, b])<br>            msg_point = E.point((x, y))<br>            Ep = EllipticCurve(IntegerModRing(p), [a, b])<br>            Eq = EllipticCurve(IntegerModRing(q), [a, b])<br>            N1 = Ep.order()<br>            N2 = <span class="hljs-number">2</span>*p+<span class="hljs-number">2</span>-N1<br>            N3 = Eq.order()<br>            N4 = <span class="hljs-number">2</span>*q+<span class="hljs-number">2</span>-N3<br>            d = &#123;<br>                ( <span class="hljs-number">1</span>, <span class="hljs-number">1</span>): inverse_mod(e, lcm(N1, N3)),<br>                ( <span class="hljs-number">1</span>,-<span class="hljs-number">1</span>): inverse_mod(e, lcm(N1, N4)),<br>                (-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>): inverse_mod(e, lcm(N2, N3)),<br>                (-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>): inverse_mod(e, lcm(N2, N4))<br>            &#125;<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>    cip_point = e*msg_point<br>    ciphertext = cip_point.xy()[<span class="hljs-number">0</span>]<br>    privKey = (d, p, q)<br>    pubKey = (a, b, N)<br>    <span class="hljs-keyword">return</span> (ciphertext, pubKey, privKey)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Decrypt</span>(<span class="hljs-params">ciphertext, pubKey, privKey</span>):<br>    d, p, q = privKey<br>    a, b, N = pubKey<br>    x = ciphertext<br>    w = x^<span class="hljs-number">3</span> + a*x + b % N<br>    P.&lt;Yp&gt; = PolynomialRing(Zmod(p))<br>    fp = x^<span class="hljs-number">3</span> + a*x + b -Yp^<span class="hljs-number">2</span><br>    yp = fp.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    P.&lt;Yq&gt; = PolynomialRing(Zmod(q))<br>    fq = x^<span class="hljs-number">3</span> + a*x + b -Yq^<span class="hljs-number">2</span><br>    yq = fq.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    y = crt([<span class="hljs-built_in">int</span>(yp), <span class="hljs-built_in">int</span>(yq)], [p, q])<br>    E = EllipticCurve(IntegerModRing(N), [a, b])<br>    cip_point = E.point([x, y])<br>    legendre_symbol_p = legendre_symbol(w, p)<br>    legendre_symbol_q = legendre_symbol(w, q)<br>    msg_point = d[(legendre_symbol_p, legendre_symbol_q)]*cip_point<br>    <span class="hljs-keyword">return</span> msg_point.xy()[<span class="hljs-number">0</span>]<br>msg = bytes_to_long(flag)<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">70</span>):<br>    current_st = time()<br>    cipher = Encrypt(<span class="hljs-number">3</span>, <span class="hljs-number">256</span>, msg)<br>    f.writelines(<span class="hljs-string">&quot;&#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;\n&quot;</span>.<span class="hljs-built_in">format</span>(cipher[<span class="hljs-number">0</span>],*cipher[<span class="hljs-number">1</span>]))<br>f.close()<br></code></pre></td></tr></table></figure><p>ç„¶åé¢˜ç›®æœ€ç»ˆç»™å‡ºäº†$70$ç»„ä¸åŒçš„$(c,a,b,n)$çš„å››å…ƒç»„ï¼Œå‡ä¸ºå¯¹åŒä¸€æ˜æ–‡$x$çš„åŠ å¯†ã€‚</p><p>é‚£ä¹ˆè¿™é“é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é¦–å…ˆæ„é€ å…³äº$x$çš„å¤šé¡¹å¼ã€‚æˆ‘ä»¬åˆšæ‰çœ‹åˆ°äº†ï¼Œ$F_3(x)&#x3D;3x^4+6ax^2+12bx-a^2$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°åˆ†å­çš„å€¼å’Œåˆ†æ¯çš„å€¼<br>$$<br>G&#x3D;x(3x^4+6ax^2+12bx-a^2)^2-8(x^3+ax+b)(x^6+5ax^4+20bx^3-5ax^2-4ab-8b^2-a^3)<br>$$</p><p>$$<br>F^2&#x3D;(3x^4+6ax^2+12bx-a)^2<br>$$</p><p>ç„¶åæˆ‘ä»¬ç”±$c\equiv\dfrac G {F^2} \pmod n$ï¼Œé‚£ä¹ˆæœ‰$G-cF^2\equiv 0 \pmod n$ã€‚ç”±äº$F^2$æ˜¯å…«æ¬¡å¼ï¼Œ$G$æ˜¯ä¹æ¬¡å¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ å‡º$70$ä¸ªä¹æ¬¡å¼ï¼ˆä¸è¿‡æœ€å¥½ä¿è¯æ„é€ å‡ºæ¥çš„$G$å‡ä¸º<code>monic</code>ï¼Œä¹Ÿå°±æ˜¯æœ€é«˜æ¬¡é¡¹ä¹æ¬¡é¡¹ä¸º$1$ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬ç»§ç»­ç±»æ¯”RSAä¸­ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»çš„æ–¹æ³•ï¼Œå¯ä»¥åˆ†åˆ«å¯¹å¸¸æ•°é¡¹åˆ°ä¹æ¬¡é¡¹åˆ†åˆ«è¿›è¡Œä¸­å›½å‰©ä½™å®šç†ï¼Œå¹¶å°†æ‰€æœ‰çš„æ¨¡æ•°ç›¸ä¹˜ï¼Œå¾—åˆ°ä¸€ä¸ªæ‰€æœ‰çš„ç³»æ•°éƒ½å¾ˆå¤§çš„ä¸€ä¸ªå¤šé¡¹å¼ã€‚ï¼ˆå½“ç„¶ä¹æ¬¡é¡¹ç³»æ•°è¿˜æ˜¯$1$ï¼‰ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ª$N&#x3D;\prod_{i&#x3D;1}^{70} n$ï¼Œç”±äº$n$çš„æ¯”ç‰¹æ•°å¤§æ¦‚æ˜¯$512$ï¼Œä¹Ÿå°±æ˜¯$\ln n&#x3D;355$ï¼Œé‚£ä¹ˆ$\ln N&#x3D;24842$ï¼Œè€Œæˆ‘ä»¬éœ€è¦å¯†æ–‡çš„è§„æ¨¡ä¸è¶…è¿‡$\ln m&#x3D;355$ã€‚æ¬¡æ•°ä¸º$9$æ¬¡å¼ï¼Œå› æ­¤æ ¹æ®Copeersmithå®šç†ï¼šåªè¦$\ln x&lt;2760 $ï¼Œå°±å¯ä»¥æ±‚å‡ºè¿™ä¸ªå¼å­çš„ä¸€ä¸ªæ ¹ã€‚å¾ˆæ˜¾ç„¶$m$çš„å€¼æ˜¯ç¬¦åˆæ¡ä»¶çš„ã€‚</p><p>å› æ­¤è¿™ä¸ªè¿‡ç¨‹å°±è½¬åŒ–æˆäº†æ±‚å¤šé¡¹å¼çš„å°æ ¹ï¼Œç›´æ¥ç”¨<code>small_roots</code>å°±å¯ä»¥è§£å‡ºæ¥äº†ã€‚ä¸è¿‡Sagemathä¸­çš„è¿™äº›å‘½ä»¤ä¹Ÿå¹¶ä¸æ˜¯ç‰¹åˆ«å¥½ç”¨çš„<del>æˆ‘è¿˜æ˜¯è°ƒç¨‹åºè°ƒäº†åŠå¤©</del>ã€‚å› æ­¤å»ºè®®é€šè¿‡LLLç®—æ³•æ‰‹å†™ä¸€ä¸ªæ±‚å¤šé¡¹å¼å°æ ¹çš„è„šæœ¬ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><h4 id="0o02-è‡ªå·±çš„exp"><a href="#0o02-è‡ªå·±çš„exp" class="headerlink" title="0o02.è‡ªå·±çš„exp"></a>0o02.è‡ªå·±çš„exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br>c=[]<br>a=[]<br>b=[]<br>n=[]<br>Fzlist=[]<br>Fmlist=[]<br>Dlist=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">70</span>):<br>    R.&lt;x&gt;=PolynomialRing(Zmod(n[i]))<br>    Fz=x*(<span class="hljs-number">3</span>*x^<span class="hljs-number">4</span>+<span class="hljs-number">6</span>*a[i]*x^<span class="hljs-number">2</span>+<span class="hljs-number">12</span>*b[i]*x-a[i]^<span class="hljs-number">2</span>)^<span class="hljs-number">2</span>-<span class="hljs-number">8</span>*(x^<span class="hljs-number">3</span>+a[i]*x+b[i])*(x^<span class="hljs-number">6</span>+<span class="hljs-number">5</span>*a[i]*x^<span class="hljs-number">4</span>+<span class="hljs-number">20</span>*b[i]*x^<span class="hljs-number">3</span>-<span class="hljs-number">5</span>*a[i]^<span class="hljs-number">2</span>*x^<span class="hljs-number">2</span>-<span class="hljs-number">4</span>*a[i]*b[i]*x-<span class="hljs-number">8</span>*b[i]^<span class="hljs-number">2</span>-a[i]^<span class="hljs-number">3</span>)<br>    Fm=(<span class="hljs-number">3</span>*x^<span class="hljs-number">4</span>+<span class="hljs-number">6</span>*a[i]*x^<span class="hljs-number">2</span>+<span class="hljs-number">12</span>*b[i]*x-a[i]^<span class="hljs-number">2</span>)^<span class="hljs-number">2</span><br>    Fzlist.append(Fz)<br>    Fmlist.append(Fm*c[i])<br>    Dlist.append(Fz-c[i]*Fm)<br>Crtlist=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">70</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">70</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        Crtlist[j][i]=ZZ(Dlist[i][j])<br>A=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    A.append(CRT(Crtlist[i],n))<br>N=<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n:<br>    N*=i<br>O.&lt;y&gt;=PolynomialRing(Zmod(N))<br>S=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    S+=A[i]*y^i<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Finding Roots&#x27;</span>)<br>oo,oooo,ooooo=<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><br>S.small_roots(epsilon=<span class="hljs-number">1</span>/<span class="hljs-number">16</span>)<br>[<span class="hljs-number">3088969433059681806521206959873975785377227976800172674306727155831805513908352148702210247662586117242206183337522557</span>]<br></code></pre></td></tr></table></figure><h4 id="0o03-å‡ºé¢˜äººAm4çš„å®˜æ–¹wp"><a href="#0o03-å‡ºé¢˜äººAm4çš„å®˜æ–¹wp" class="headerlink" title="0o03 å‡ºé¢˜äººAm4çš„å®˜æ–¹wp"></a>0o03 å‡ºé¢˜äººAm4çš„å®˜æ–¹wp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>)<br>ciphertext = []<br>a, b, n = [], [], []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">70</span>):<br>ci, ai, bi, ni = [<span class="hljs-built_in">int</span>(num) <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> f.readline().strip().split(<span class="hljs-string">&quot;, &quot;</span>)]<br>ciphertext.append(ci)<br>a.append(ai)<br>b.append(bi)<br>n.append(ni)<br>e = <span class="hljs-number">3</span><br>deg = <span class="hljs-number">9</span><br>coeffi = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">70</span>):<br>E = EllipticCurve(IntegerModRing(n[i]), [a[i], b[i]])<br>P.&lt;m&gt; = PolynomialRing(Zmod(n[i]))<br>f = ciphertext[i]*E._multiple_x_denominator(e, m) -<br>E._multiple_x_numerator(e, m)<br>coeffi.append(f.coefficients(sparse=<span class="hljs-literal">False</span>))<br>large_coeffi = [crt([<span class="hljs-built_in">int</span>(coeffi[j][i]) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">70</span>)], [n[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span><br><span class="hljs-built_in">range</span>(<span class="hljs-number">70</span>)]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(deg+<span class="hljs-number">1</span>)]<br>N_bitlength = <span class="hljs-built_in">sum</span>([n[i].bit_length() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">70</span>)])<br>min_n = <span class="hljs-built_in">min</span>(n)<br>N = reduce(<span class="hljs-keyword">lambda</span> x, y: x*y, n)<br>Sc = large_coeffivar(<span class="hljs-string">&quot;x&quot;</span>)<br>assume(x, <span class="hljs-string">&#x27;integer&#x27;</span>)<br>f =<br>Sc[<span class="hljs-number">9</span>]*x^<span class="hljs-number">9</span>+Sc[<span class="hljs-number">8</span>]*x^<span class="hljs-number">8</span>+Sc[<span class="hljs-number">7</span>]*x^<span class="hljs-number">7</span>+Sc[<span class="hljs-number">6</span>]*x^<span class="hljs-number">6</span>+Sc[<span class="hljs-number">5</span>]*x^<span class="hljs-number">5</span>+Sc[<span class="hljs-number">4</span>]*x^<span class="hljs-number">4</span>+Sc[<span class="hljs-number">3</span>]*x^<span class="hljs-number">3</span>+Sc[<span class="hljs-number">2</span>]*x^<span class="hljs-number">2</span><br>+Sc[<span class="hljs-number">1</span>]*x+Sc[<span class="hljs-number">0</span>]<br>lat = []<br>lat.append([large_coeffi[i]*min_n**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(deg+<span class="hljs-number">1</span>)]+[<span class="hljs-number">1</span>/(deg+<span class="hljs-number">1</span>)])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(deg+<span class="hljs-number">1</span>):<br>lat.append([((min_n**j)*N <span class="hljs-keyword">if</span> (i==j) <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(deg+<span class="hljs-number">1</span>)]+[<span class="hljs-number">0</span>])<br>Mat = matrix(lat)<br>Mat_LLL = Mat.LLL()<br><span class="hljs-keyword">for</span> lin <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(deg):<br>Sc = [<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Mat_LLL[lin]]<br>Sc = [(Sc[i]//(min_n**i)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(deg+<span class="hljs-number">1</span>)]<br>var(<span class="hljs-string">&quot;x&quot;</span>)<br>assume(x, <span class="hljs-string">&#x27;integer&#x27;</span>)<br>f =<br>Sc[<span class="hljs-number">9</span>]*x^<span class="hljs-number">9</span>+Sc[<span class="hljs-number">8</span>]*x^<span class="hljs-number">8</span>+Sc[<span class="hljs-number">7</span>]*x^<span class="hljs-number">7</span>+Sc[<span class="hljs-number">6</span>]*x^<span class="hljs-number">6</span>+Sc[<span class="hljs-number">5</span>]*x^<span class="hljs-number">5</span>+Sc[<span class="hljs-number">4</span>]*x^<span class="hljs-number">4</span>+Sc[<span class="hljs-number">3</span>]*x^<span class="hljs-number">3</span>+Sc[<span class="hljs-number">2</span>]*x^<span class="hljs-number">2</span><br>+Sc[<span class="hljs-number">1</span>]*x+Sc[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(factor(f))<br><span class="hljs-keyword">break</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">m =</span><br><span class="hljs-string">3088969433059681806521206959873975785377227976800172674306727155831805513908352</span><br><span class="hljs-string">148702210247662586117242206183337522557</span><br><span class="hljs-string">print(long_to_bytes(m))</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure><h3 id="2-ECCä¸Šçš„ç›¸å…³æ˜æ–‡æ”»å‡»"><a href="#2-ECCä¸Šçš„ç›¸å…³æ˜æ–‡æ”»å‡»" class="headerlink" title="2.ECCä¸Šçš„ç›¸å…³æ˜æ–‡æ”»å‡»"></a>2.ECCä¸Šçš„ç›¸å…³æ˜æ–‡æ”»å‡»</h3><h4 id="0o01-åˆ†æé¢˜ç›®-1"><a href="#0o01-åˆ†æé¢˜ç›®-1" class="headerlink" title="0o01 åˆ†æé¢˜ç›®"></a>0o01 åˆ†æé¢˜ç›®</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, long_to_bytes, getPrime, getRandomRange<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>flag = bytes_to_long(flag)<br>p, q = [getPrime(<span class="hljs-built_in">int</span>(<span class="hljs-number">256</span>)) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>a, b = [getRandomRange(<span class="hljs-number">1</span>, p*q) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, a, b, p, q, e</span>):<br>        <span class="hljs-variable language_">self</span>.p, <span class="hljs-variable language_">self</span>.q = p, q<br>        <span class="hljs-variable language_">self</span>.a, <span class="hljs-variable language_">self</span>.b = a, b<br>        <span class="hljs-variable language_">self</span>.N = <span class="hljs-variable language_">self</span>.p*<span class="hljs-variable language_">self</span>.q<br>        <span class="hljs-variable language_">self</span>.e = e<br>        <span class="hljs-variable language_">self</span>.Kbits = <span class="hljs-number">8</span><br>        Ep = EllipticCurve(IntegerModRing(<span class="hljs-variable language_">self</span>.p), [<span class="hljs-variable language_">self</span>.a, <span class="hljs-variable language_">self</span>.b])<br>        Eq = EllipticCurve(IntegerModRing(<span class="hljs-variable language_">self</span>.q), [<span class="hljs-variable language_">self</span>.a, <span class="hljs-variable language_">self</span>.b])<br>        N1 = Ep.order()<br>        N2 = <span class="hljs-number">2</span>*<span class="hljs-variable language_">self</span>.p+<span class="hljs-number">2</span>-N1<br>        N3 = Eq.order()<br>        N4 = <span class="hljs-number">2</span>*<span class="hljs-variable language_">self</span>.q+<span class="hljs-number">2</span>-N3<br>        <span class="hljs-variable language_">self</span>.d = &#123;<br>            ( <span class="hljs-number">1</span>, <span class="hljs-number">1</span>): inverse_mod(<span class="hljs-variable language_">self</span>.e, lcm(N1, N3)),<br>            ( <span class="hljs-number">1</span>,-<span class="hljs-number">1</span>): inverse_mod(<span class="hljs-variable language_">self</span>.e, lcm(N1, N4)),<br>            (-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>): inverse_mod(<span class="hljs-variable language_">self</span>.e, lcm(N2, N3)),<br>            (-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>): inverse_mod(<span class="hljs-variable language_">self</span>.e, lcm(N2, N4))<br>        &#125;<br>        <span class="hljs-variable language_">self</span>.E = EllipticCurve(IntegerModRing(<span class="hljs-variable language_">self</span>.N), [<span class="hljs-variable language_">self</span>.a, <span class="hljs-variable language_">self</span>.b])<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Enc</span>(<span class="hljs-params">self, plaintext</span>):<br>        <span class="hljs-keyword">try</span>:<br>            msg_point = <span class="hljs-variable language_">self</span>.msg_to_point(plaintext)<br>            cip_point = <span class="hljs-variable language_">self</span>.e*msg_point<br>            <span class="hljs-keyword">return</span> cip_point.xy()[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Dec</span>(<span class="hljs-params">self, ciphertext</span>):<br>        x = ciphertext<br>        w = x^<span class="hljs-number">3</span> + <span class="hljs-variable language_">self</span>.a*x + <span class="hljs-variable language_">self</span>.b % <span class="hljs-variable language_">self</span>.N<br>        P.&lt;Yp&gt; = PolynomialRing(Zmod(<span class="hljs-variable language_">self</span>.p))<br>        fp = x^<span class="hljs-number">3</span> + <span class="hljs-variable language_">self</span>.a*x + <span class="hljs-variable language_">self</span>.b -Yp^<span class="hljs-number">2</span><br>        yp = fp.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>        P.&lt;Yq&gt; = PolynomialRing(Zmod(<span class="hljs-variable language_">self</span>.q))<br>        fq = x^<span class="hljs-number">3</span> + <span class="hljs-variable language_">self</span>.a*x + <span class="hljs-variable language_">self</span>.b -Yq^<span class="hljs-number">2</span><br>        yq = fq.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>        y = crt([<span class="hljs-built_in">int</span>(yp), <span class="hljs-built_in">int</span>(yq)], [<span class="hljs-variable language_">self</span>.p, <span class="hljs-variable language_">self</span>.q])<br>        cip_point = <span class="hljs-variable language_">self</span>.E.point([x, y])<br>        legendre_symbol_p = legendre_symbol(w, <span class="hljs-variable language_">self</span>.p)<br>        legendre_symbol_q = legendre_symbol(w, <span class="hljs-variable language_">self</span>.q)<br>        msg_point = <span class="hljs-variable language_">self</span>.d[(legendre_symbol_p, legendre_symbol_q)]*cip_point<br>        <span class="hljs-keyword">return</span> msg_point.xy()[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-variable language_">self</span>.Kbits<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">msg_to_point</span>(<span class="hljs-params">self, x, shift=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-keyword">if</span> shift:<br>            x &lt;&lt;= <span class="hljs-variable language_">self</span>.Kbits<br>        checkPoint = <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>&lt;&lt;<span class="hljs-variable language_">self</span>.Kbits):<br>            P.&lt;Yp&gt; = PolynomialRing(Zmod(<span class="hljs-variable language_">self</span>.p))<br>            fp = x^<span class="hljs-number">3</span> + <span class="hljs-variable language_">self</span>.a*x + <span class="hljs-variable language_">self</span>.b - Yp^<span class="hljs-number">2</span><br>            P.&lt;Yq&gt; = PolynomialRing(Zmod(<span class="hljs-variable language_">self</span>.q))<br>            fq = x^<span class="hljs-number">3</span> + <span class="hljs-variable language_">self</span>.a*x + <span class="hljs-variable language_">self</span>.b - Yq^<span class="hljs-number">2</span><br>            <span class="hljs-keyword">try</span>:<br>                yp, yq = <span class="hljs-built_in">int</span>(fp.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]), <span class="hljs-built_in">int</span>(fq.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br>                y = crt([yp, yq], [<span class="hljs-variable language_">self</span>.p, <span class="hljs-variable language_">self</span>.q])<br>                E = EllipticCurve(IntegerModRing(<span class="hljs-variable language_">self</span>.p*<span class="hljs-variable language_">self</span>.q), [<span class="hljs-variable language_">self</span>.a, <span class="hljs-variable language_">self</span>.b])<br>                checkPoint = E.point((x, y))<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">except</span>:<br>                x += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> checkPoint<br>delta = <span class="hljs-number">28552609273</span><br>e = <span class="hljs-number">137</span><br>cip = Task(a, b, p, q, e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;a = <span class="hljs-subst">&#123;a&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;b = <span class="hljs-subst">&#123;b&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;p*q&#125;</span>&quot;</span>)<br>plaintext1 = cip.msg_to_point(flag, shift=<span class="hljs-literal">True</span>).xy()[<span class="hljs-number">0</span>]<br>ciphertext1 = cip.Enc(plaintext1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext1 = <span class="hljs-subst">&#123;ciphertext1&#125;</span>&quot;</span>)<br>plaintext2 = cip.msg_to_point(flag+delta, shift=<span class="hljs-literal">True</span>).xy()[<span class="hljs-number">0</span>]<br>ciphertext2 = cip.Enc(plaintext2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ciphertext2 = <span class="hljs-subst">&#123;ciphertext2&#125;</span>&quot;</span>)<br>delta = plaintext2 - plaintext1<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;delta = <span class="hljs-subst">&#123;delta&#125;</span>&quot;</span>)<br><span class="hljs-comment"># a = 4281014323581546488462714122303747203636223358897123235803046898862939653328802115362584316327572195541081125920528501180620492421895128401613948866529122</span><br><span class="hljs-comment"># b = 1504110610934153564757355169781343270879282969971532470271782059859117769089994716068562704547770368420258743734175281689611986131092394954948339191589449</span><br><span class="hljs-comment"># n = 6638798722521613809421411597209101115203859862340555482590990067056543831415553727351714220257486793657912537305448979625073630917241320204281256125412671</span><br><span class="hljs-comment"># ciphertext1 = 6327639450575093157999054915625304951894564605402541939450801256931875815282143921161475586010526883609974743159835451980804875847625527741681757415519394</span><br><span class="hljs-comment"># ciphertext2 = 3275348139763310265438126795688591830796510682708632201044899744259822398076574133105844638686347122066389056025294466297206704146167073441486603569471235</span><br><span class="hljs-comment"># delta = 7309467973885</span><br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™é“é¢˜ç»™å‡ºäº†$m$çš„æ˜æ–‡å’Œ$m+d$çš„æ˜æ–‡ï¼ŒåŠ å¯†æŒ‡æ•°ä¸º$137$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨æˆ‘ä»¬åˆšæ‰æåˆ°çš„å‡½æ•°æ„é€ å‡ºå¤šé¡¹å¼ï¼Œç„¶åæ±‚å¤šé¡¹å¼çš„GCDæ¥ç¡®å®šæœ€åçš„æ ¹ã€‚</p><p>ä¸è¿‡æ•´ä¸ªä»£ç çš„å®ç°è¿˜æ˜¯æŒºå›°éš¾çš„ï¼Œå› ä¸ºé‡Œé¢çš„å¾®æ“å¾ˆå¤šï¼Œæ¯”å¦‚è¦æŠŠæ±‚å‡ºæ¥çš„å¤šé¡¹å¼å…ˆè½¬æˆlistå†è½¬å›å¤šé¡¹å¼ã€‚ä¸ç„¶ç¨‹åºè¿è¡Œä¼šå‡ºç°é”™è¯¯ã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br>a = <span class="hljs-number">4281014323581546488462714122303747203636223358897123235803046898862939653328802115362584316327572195541081125920528501180620492421895128401613948866529122</span><br>b = <span class="hljs-number">1504110610934153564757355169781343270879282969971532470271782059859117769089994716068562704547770368420258743734175281689611986131092394954948339191589449</span><br>n = <span class="hljs-number">6638798722521613809421411597209101115203859862340555482590990067056543831415553727351714220257486793657912537305448979625073630917241320204281256125412671</span><br>c1= <span class="hljs-number">6327639450575093157999054915625304951894564605402541939450801256931875815282143921161475586010526883609974743159835451980804875847625527741681757415519394</span><br>c2= <span class="hljs-number">3275348139763310265438126795688591830796510682708632201044899744259822398076574133105844638686347122066389056025294466297206704146167073441486603569471235</span><br>d = <span class="hljs-number">7309467973885</span><br>E=EllipticCurve(Zmod(n),[a,b])<br>Fz=E._multiple_x_numerator(<span class="hljs-number">137</span>)<br>Fm=E._multiple_x_denominator(<span class="hljs-number">137</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Proof Work Finished&#x27;</span>)<br>Fmlist=<span class="hljs-built_in">list</span>(Fm)<br>Fzlist=<span class="hljs-built_in">list</span>(Fz)<br>R.&lt;t&gt;=PolynomialRing(Zmod(n))<br>Fm1,Fm2,Fz1,Fz2=<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Fmlist)):<br>    Fm1+=Fmlist[i]*(t^i)<br>    Fm2+=Fmlist[i]*((t+d)^i)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Fzlist)):<br>    Fz1+=Fzlist[i]*(t^i)<br>    Fz2+=Fzlist[i]*((t+d)^i)<br>G1,G2=c1*Fm1-Fz1,c2*Fm2-Fz2<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gcdpro</span>(<span class="hljs-params">g1, g2</span>):<br>    <span class="hljs-keyword">while</span> g2:<br>        g1, g2 = g2, g1 % g2<br>    <span class="hljs-keyword">return</span> g1.monic()<br>    <span class="hljs-comment">#return -gcdpro(g1, g2)[0]</span><br>H=(gcdpro(G1,G2))<br><span class="hljs-built_in">print</span>(H)<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(long_to_bytes(n-H[<span class="hljs-number">0</span>]))<br><span class="hljs-comment">#b&#x27;DASCTF&#123;692d49f84fe5497fa05d6e91a1cf4e3e&#125;\x04&#x27;</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼ŒECCä¸­ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨å…±æ¨¡æ”»å‡»å’ŒRSAä¸­çš„Coppersmithæ¥å‡ºé¢˜ã€‚å¯ä»¥é¢„æµ‹çš„æ˜¯ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼ŒCTFä¸­ECCçš„é¢˜ç›®çš„æ•°é‡å¹¶ä¸æ˜¯ç‰¹åˆ«å¤šã€‚è¿™å°±ã€‚ã€‘è¯´æ˜äº†ECCæœ‰å¯èƒ½ä¼šæˆä¸ºåé¢CTFçš„ä¸€ä¸ªå‡ºé¢˜çƒ­é—¨ç‚¹ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ECCNotes2</title>
    <link href="/2021/03/04/ECCNotes2/"/>
    <url>/2021/03/04/ECCNotes2/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ ECCçš„ç¬”è®°2"><a href="#huangx607087å­¦ä¹ ECCçš„ç¬”è®°2" class="headerlink" title="huangx607087å­¦ä¹ ECCçš„ç¬”è®°2"></a>huangx607087å­¦ä¹ ECCçš„ç¬”è®°2</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0. About"></a>0. About</h2><p>è¿™ä¸€ç³»åˆ—ç¬”è®°ä¸»è¦ä»‹ç»æ¤­åœ†æ›²çº¿å¯†ç å­¦çš„çŸ¥è¯†ï¼Œæ¥ç€ç¬”è®°1ç»§ç»­æ‰©å±•ã€‚</p><p>è¿™ä¸€ç¬”è®°æœ¬æ¥2.22å°±åˆ›å»ºå¼€å§‹å†™äº†ï¼Œå’•åˆ°äº†3æœˆ4æ—¥æ‰å‹‰å¼ºæäº¤ï¼Œå“ï¼ˆå‡†å¤‡è¡¥å……ç¬”è®°3äº†ã€‚<strong>ç¬”è®°3ä¸ä¼šæ¥ç€ç¬”è®°2ç»§ç»­è®²</strong>ã€‚ã€‚ã€‚ã€‚ã€‚</p><h2 id="6-æ¤­åœ†æ›²çº¿ä¸Šçš„åŒçº¿æ€§å¯¹"><a href="#6-æ¤­åœ†æ›²çº¿ä¸Šçš„åŒçº¿æ€§å¯¹" class="headerlink" title="6.æ¤­åœ†æ›²çº¿ä¸Šçš„åŒçº¿æ€§å¯¹"></a>6.æ¤­åœ†æ›²çº¿ä¸Šçš„åŒçº¿æ€§å¯¹</h2><p>åœ¨çº¿æ€§ä»£æ•°ä¸­ï¼Œå‘é‡ç©ºé—´$R^n$ä¸­ä¸¤ä¸ªå‘é‡$\vec v,\vec w$ï¼Œå®ƒä»¬çš„æ•°é‡ç§¯å°±æ˜¯å®ƒä»¬å¯¹åº”åˆ†é‡çš„ç§¯ä¹‹å’Œã€‚</p><p>ç°åœ¨æœ‰ä¸¤ä¸ª$n$ç»´è¡Œå‘é‡$\vec v,\vec w$å’Œä¸€ä¸ª$n$é˜¶æ–¹é˜µ$A$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°$\beta(\vec v,\vec w)&#x3D;\vec vA\vec w^T$ã€‚å…¶ä¸­$\vec w^T$ä¸­çš„ä¸Šæ ‡$T$è¡¨ç¤ºè½¬ç½®ï¼Œå°†è¡Œå‘é‡åŒ–ä¸ºåˆ—å‘é‡ä»¥æ»¡è¶³çŸ©é˜µä¹˜æ³•çš„è§„åˆ™ã€‚å½“ç„¶æœ‰<br>$$<br>\beta(a_1\vec v_1+a_2\vec v_2,\vec w)&#x3D;a_1\beta(\vec v_1,\vec w)+a_2\beta(\vec v_2,\vec w)<br>$$</p><p>$$<br>\beta(\vec v,b_1\vec w_1+b_2\vec w_2)&#x3D;b_1\beta(\vec v,\vec w_1)+a_2\beta(\vec v,\vec w_2)<br>$$</p><p>è¿˜æœ‰ä¸€ç§åŒçº¿æ€§é…å¯¹æ˜¯$R^2$ä¸Šçš„è¡Œåˆ—å¼æ˜ å°„ã€‚ å› æ­¤ï¼Œå¦‚æœ$\vec v&#x3D;(v_1,v_2)$å’Œ$\vec w&#x3D;(w_1,w_2)$ï¼Œé‚£ä¹ˆæœ‰$\delta(\vec v,\vec w)&#x3D;v_1w_2-v_2w_1$ï¼Œä¹Ÿå°±æ˜¯å°†è¿™ä¸¤ä¸ªè¡Œå‘é‡æ„é€ å‡ºçš„çŸ©é˜µçš„è¡Œåˆ—å¼çš„å€¼ã€‚</p><p>æˆ‘ä»¬åœ¨æœ¬èŠ‚ä¸­è®¨è®ºçš„åŒçº¿æ€§å¯¹æ˜¯ç›¸ä¼¼çš„ï¼Œå› ä¸ºå®ƒä»¬ä»¥æ¤­åœ†æ›²çº¿ä¸Šçš„ä¸¤ä¸ªç‚¹ä½œä¸ºè¾“å…¥ï¼Œå¹¶ç»™å‡ºä¸€ä¸ªæ•°å­—ä½œä¸ºè¾“å‡ºã€‚ ç„¶è€Œï¼ŒåŒçº¿æ€§æ¡ä»¶ç•¥æœ‰ä¸åŒï¼Œå› ä¸ºè¾“å‡ºå€¼æ˜¯æœ‰é™åœºçš„éé›¶å…ƒç´ ï¼Œæ‰€ä»¥ç”¨ä¹˜ç§¯ä»£æ›¿åˆšæ‰æœ€ä¸Šé¢ä¸¤ä¸ªçº¿æ€§ç»„åˆå³è¾¹çš„å’Œã€‚</p><p>æ¤­åœ†æ›²çº¿ä¸Šçš„åŒçº¿æ€§å¯¹å…·æœ‰è®¸å¤šé‡è¦çš„å¯†ç å­¦åº”ç”¨ã€‚ å¯¹äºè¿™äº›åº”ç”¨ç¨‹åºä¸­çš„å¤§å¤šæ•°ï¼Œæœ‰å¿…è¦ä½¿ç”¨æœ‰é™åŸŸçš„ç´ æ•°é˜¶$GF(p^k)$ã€‚</p><h3 id="6x01-æ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰é™é˜¶ç‚¹"><a href="#6x01-æ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰é™é˜¶ç‚¹" class="headerlink" title="6x01 æ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰é™é˜¶ç‚¹"></a>6x01 æ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰é™é˜¶ç‚¹</h3><p>æˆ‘ä»¬é¦–å…ˆç®€è¦æè¿°æ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰é™é˜¶ç‚¹</p><p><strong>å®šä¹‰ï¼š</strong>å½“æ¤­åœ†æ›²çº¿$E$ä¸Šçš„ä¸€ç‚¹$P$ï¼Œæ»¡è¶³$mP&#x3D;O$çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹çš„é˜¶å°±æ˜¯$m$ã€‚$E$ä¸Šæ‰€æœ‰é˜¶ä¸º$m$çš„ç‚¹è®°ä¸º$E[m]$ã€‚è¿™ç±»ç‚¹ç§°ä¸ºæœ‰é™é˜¶ç‚¹æˆ–æ‰­è½¬ç‚¹ã€‚</p><p>å¾ˆæ˜¾ç„¶ï¼Œå¦‚æœ$P,Q\in E[m]$ï¼Œé‚£ä¹ˆ$P+Q,-P \in E[m]$ã€‚æ•…$E[m]$æ˜¯$E$çš„ä¸€ä¸ªå­ç¾¤ã€‚å½“ç„¶ï¼Œå®šä¹‰åŸŸæ˜¯$GF(49)$çš„æ¤­åœ†æ›²çº¿$E$ä¸Šæ‰€æœ‰é˜¶ä¸º$10$çš„ç‚¹çš„é›†åˆè®°ä¸º$E(GF(49))[10]$ã€‚å…¶ä»–çš„æƒ…å†µå¯ä»¥æ­¤ç±»æ¨ã€‚</p><p>å½“æ¤­åœ†æ›²çº¿çš„å®šä¹‰åŸŸä¸º$Q,R,C$æ—¶ï¼Œé‚£ä¹ˆ$E(C)[m]&#x3D;\dfrac{Z}{mZ}Ã—\dfrac{Z}{mZ}$ã€‚</p><p>å½“æ¤­åœ†æ›²çº¿åœ¨$GF(p)$ä¸Šæ—¶ï¼Œå¦‚æœ$p$ä¸æ˜¯$m$çš„å› æ•°ï¼Œé‚£ä¹ˆå¯¹äºä»»æ„çš„$j$ï¼Œéƒ½å­˜åœ¨$k$ä½¿å¾—$E(GF(P^{jk}))[m]&#x3D;\dfrac{Z}{mZ}Ã—\dfrac{Z}{mZ}$ã€‚</p><p>å¦‚æœ$l$ä¸ºç´ æ•°ï¼Œæ›²çº¿çš„å®šä¹‰åŸŸä¸º$K$ï¼Œé‚£ä¹ˆæœ‰$E(K)[l]&#x3D;\dfrac{Z}{lZ}Ã—\dfrac{Z}{lZ}$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¤ä¸º$E[l]$æ˜¯åœ¨$\dfrac{Z}{lZ}Ã—\dfrac{Z}{lZ}$ä¸Šçš„ä¸€ä¸ªå‘é‡ç©ºé—´ã€‚å½“ç„¶ï¼Œå¯¹äºåˆæ•°$m$ï¼Œ$E(K)[m]$ä¸­ä¹Ÿä¼šæœ‰ä¸¤ä¸ªç‚¹$P_1,P_2$ï¼Œä½¿å¾—$E[m]$ä¸­çš„ä»»æ„ä¸€ä¸ªç‚¹$P$ï¼Œéƒ½å¯ä»¥ç”¨$P_1,P_2$çº¿æ€§è¡¨ç¤ºæˆ$P&#x3D;aP_1+bP_2$ã€‚å¯¹äºç³»æ•°$a,bâˆˆ\dfrac{Z}{mZ}$çš„å”¯ä¸€é€‰æ‹©ã€‚ å½“ç„¶ï¼Œå¦‚æœ$m$å¾ˆå¤§ï¼Œå¯èƒ½å¾ˆéš¾æ‰¾åˆ°$a$å’Œ$b$ã€‚ å®é™…ä¸Šï¼Œå¦‚æœ$P$æ˜¯$P_1$çš„å€æ•°ï¼Œé‚£ä¹ˆæ±‚$a$çš„å€¼ä¸è§£$P$å’Œ$P1$çš„ECDLPæ˜¯ç›¸åŒçš„ã€‚</p><h3 id="6x02-æ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰ç†æ•°å‡½æ•°å’Œçº¦æ•°"><a href="#6x02-æ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰ç†æ•°å‡½æ•°å’Œçº¦æ•°" class="headerlink" title="6x02 æ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰ç†æ•°å‡½æ•°å’Œçº¦æ•°"></a>6x02 æ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰ç†æ•°å‡½æ•°å’Œçº¦æ•°</h3><p>ä¸ºäº†å®šä¹‰Weilå’ŒTateå¯¹ï¼Œæˆ‘ä»¬éœ€è¦è§£é‡Šæ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰ç†å‡½æ•°å¦‚ä½•ä¸å…¶é›¶ç‚¹å’Œæç‚¹ç›¸å…³ã€‚ æˆ‘ä»¬ä»ä¸€ä¸ªå˜é‡çš„æœ‰ç†å‡½æ•°çš„ç®€å•æƒ…å†µå¼€å§‹ã€‚ æœ‰ç†æ•°å‡½æ•°æ˜¯å¤šé¡¹å¼çš„æ¯”å€¼<br>$$<br>f(x)&#x3D;\dfrac{\sum_{i&#x3D;0}^{n}a_ix^i}{\sum_{i&#x3D;0}^{n}b_ix^i}<br>$$<br>æ ¹æ®ä»£æ•°åŸºæœ¬å®šç†ï¼Œåœ¨å¤æ•°èŒƒå›´å†…ï¼Œäº$n$æ¬¡æ–¹ç¨‹æœ‰$n$ä¸ªæ ¹ï¼Œé‚£ä¹ˆ$f(x)$è¿˜å¯ä»¥å†™æˆè¿™æ ·çš„å½¢å¼ï¼Œå…¶ä¸­æ‰€æœ‰çš„$\alpha$å’Œæ‰€æœ‰çš„$\beta$éƒ½ä¸ç›¸åŒã€‚<br>$$<br>f(x)&#x3D;\dfrac{a\prod_{i&#x3D;1}^r (x-\alpha_i)^{e_i}}{b\prod_{i&#x3D;1}^s (x-\beta_i)^{d_i}}<br>$$<br>ç”±äº$\alpha$ä¸$\beta$ä¸­çš„å€¼æ²¡æœ‰äº¤é›†ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°æ‰€æœ‰çš„$\alpha$å€¼éƒ½æ˜¯$f(x)$çš„é›¶ç‚¹ï¼Œæ‰€æœ‰çš„$\beta$å€¼éƒ½æ˜¯$f(x)$çš„æç‚¹ã€‚æˆ‘ä»¬é€šè¿‡å®šä¹‰$f(x)$çš„é™¤æ•°ä¸ºå½¢å¼å’Œæ¥è·Ÿè¸ª$f(x)$çš„é›¶ç‚¹å’Œæç‚¹åŠå…¶å€æ•°ã€‚å®šä¹‰ï¼š<br>$$<br>\mathrm{div} (f(x))&#x3D;\sum_{i&#x3D;1}^r e_i\alpha_i-\sum_{i&#x3D;1}^sd_i\beta_i<br>$$<br>åœ¨æ¤­åœ†æ›²çº¿$E:y^2&#x3D;x^3+Ax+B$ä¸­ï¼Œå¦‚æœæŠŠ$x,y$éƒ½çœ‹æˆæ˜¯æŸä¸ªå˜é‡çš„æœ‰ç†å‡½æ•°$x(t),y(t)$ï¼Œé‚£ä¹ˆæ¤­åœ†æ›²çº¿$E$ä¸Šé¢çš„$f$çš„æœ‰äº›é›¶ç‚¹å’Œæç‚¹ä¼šæ¶ˆå¤±ã€‚æ­¤å¤–ï¼Œå¯ä»¥å°†å€æ•°åˆ†é…ç»™é›¶ç‚¹å’Œæç‚¹ï¼Œå› æ­¤ $f$ æœ‰ä¸€ä¸ªç›¸å…³çš„é™¤æ•°<br>$$<br>\mathrm{div}(f)&#x3D;\sum_{P\in E} n_P[P]<br>$$<br>åœ¨è¿™ä¸ªå½¢å¼å’Œä¸­ï¼Œç³»æ•°$n_P$æ˜¯æ•´æ•°ï¼Œåªæœ‰æœ‰é™çš„$n_P$æ˜¯éé›¶çš„ï¼Œæ‰€ä»¥$\mathrm{div}(f)$æ˜¯æœ‰é™å’Œã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å‡è®¾ä¸€ä¸ªæ¤­åœ†æ›²çº¿æ–¹ç¨‹$y^2&#x3D;x^3+Ax+B$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æœ‰<br>$$<br>x^3+Ax+B&#x3D;(x-\alpha_1)(x-\alpha_2)(x-\alpha_3)<br>$$<br>é‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œ$(\alpha_i,0)$éƒ½æ˜¯æ¤­åœ†æ›²çº¿ä¸Šé˜¶æ•°ä¸º$2$çš„ç‚¹ï¼Œè®¾$P_i&#x3D;(\alpha_i,0)$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æœ‰$2P_1&#x3D;2P_2&#x3D;2P_3&#x3D;O$ã€‚é‚£ä¹ˆ$y$å°±ä¼šåœ¨è¿™ä¸‰ä¸ªç‚¹ä¸Šæ¶ˆå¤±ï¼Œç„¶åæˆ‘ä»¬å°±æœ‰<br>$$<br>\mathrm{div}(Y)&#x3D;[P_1]+[P_2]+[P_3]-3[O]<br>$$<br>å¹¶ä¸”å¯ä»¥æ¨å‡ºï¼Œ$P_1,P_2,P_3$éƒ½æ˜¯ä¸åŒçš„ç‚¹ã€‚</p><p>æ›´ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰æ¤­åœ†æ›²çº¿$E$ä¸Šçš„é™¤æ•°å®šä¹‰æˆ$D&#x3D;\sum_{P\in E}n_P[P]$ï¼Œå…¶ä¸­$n_p\in Z$å¹¶ä¸”$n_P&#x3D;0$å¯¹æ‰€æœ‰ä½†æ˜¯æœ‰é™ä¸ªç‚¹$P\in E$ã€‚</p><p>å…¶ä¸­ï¼Œé™¤æ•°çš„åº¦æ•°å°±æ˜¯å®ƒçš„ç³»æ•°ä¹‹å’Œï¼š$\deg D &#x3D;\deg \sum_{P\in E}n_P[P]&#x3D;\sum_{P \in E} n_p$ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ–¹æ‹¬å·æ¥å®šä¹‰é™¤æ•°çš„å’Œï¼š$\mathrm{Sum}(D)&#x3D;\mathrm{Sum}\sum_{P\in E}n_P[P]&#x3D;\sum_{P\in E}n_PP$ã€‚</p><p>æ³¨æ„ï¼Œ$n_PP$æ„å‘³ç€ç”¨åŠ æ³•æ³•åˆ™æŠŠ$P$åŠ åˆ°è‡ªå·±çš„$n_P$æ¬¡ä¸Šåœ¨$E$ä¸Šï¼Œå¾ˆè‡ªç„¶åœ°ä¼šé—®å“ªäº›é™¤æ•°æ˜¯å‡½æ•°çš„é™¤æ•°ï¼Œå“ªäº›é™¤æ•°æ˜¯å‡½æ•°çš„é™¤æ•°å‡½æ•°çš„é™¤æ•°å†³å®šå‡½æ•°çš„å¤§å°ã€‚è¿™äº›é—®é¢˜æ˜¯ç”±ä¸‹é¢çš„å®šç†æ¥å›ç­”ã€‚</p><p><strong>å®šç†1ï¼š</strong>è®¾$f$å’Œ$g$æ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„æœ‰ç†å‡½æ•°ï¼Œå¦‚æœ$\mathrm{div}(f)&#x3D;\mathrm {div} (g)$ï¼Œé‚£ä¹ˆå­˜åœ¨ä¸€ä¸ªéé›¶å¸¸æ•°$c$ä½¿å¾—$f&#x3D;cg$ã€‚</p><p><strong>å®šç†2ï¼š</strong>è®¾$D&#x3D;\sum_{P\in E}n_P[P]$ï¼Œä¸ºæ¤­åœ†æ›²çº¿$E$ä¸Šçš„ä¸€ä¸ªé™¤æ•°ï¼Œåˆ™$D$æ˜¯$E$ä¸Šæœ‰ç†å‡½æ•°çš„é™¤æ•°å½“ä¸”ä»…å½“$\deg D&#x3D;0 \text{ and Sum}(D)&#x3D;O$ã€‚</p><p>ç‰¹åˆ«åœ°ï¼Œå¦‚æœ$E$ä¸Šçš„æœ‰ç†å‡½æ•°æ²¡æœ‰é›¶æˆ–æç‚¹ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚</p><h3 id="6x03-Weilé…å¯¹"><a href="#6x03-Weilé…å¯¹" class="headerlink" title="6x03 Weilé…å¯¹"></a>6x03 Weilé…å¯¹</h3><p>ç”¨$e_m$è¡¨ç¤ºçš„Weilé…å¯¹ä»¥ä¸€å¯¹ç‚¹ä½œä¸ºè¾“å…¥$P, QâˆˆE[m]$ï¼Œå¹¶ç»™å‡ºå•ä½$e_m(P,Q)$çš„ç¬¬$m$ä¸ªæ ¹ä½œä¸ºè¾“å‡ºã€‚åŒçº¿æ€§Weilå¯¹çš„æ€§è´¨ç”¨æ–¹ç¨‹è¡¨ç¤º<br>$$<br>e_m(P_1+P_2,Q)&#x3D;e_m(P_1,Q)e_m(P_2Q)<br>$$</p><p>$$<br>e_m(P,Q_1+Q_2)&#x3D;e_m(P,Q_1)e_m(P,Q_2)<br>$$</p><p><strong>å®šä¹‰ï¼š</strong>è®¾$P,QâˆˆE[m]$ï¼Œå³$P$å’Œ$Q$æ˜¯$m$é˜¶ç‚¹ç¾¤$E$ã€‚è®¾$f_P$å’Œ$f_Q$æ˜¯$E$ä¸Šçš„æœ‰ç†å‡½æ•°æ»¡è¶³$\mathrm{div}(f_P)&#x3D;m[P]âˆ’m[O]$å’Œ$\mathrm{div}(fQ)&#x3D;m[Q]âˆ’m[O]$ã€‚$P$å’Œ$Q$çš„Weilé…å¯¹å€¼å°±æ˜¯<br>$$<br>e_m(P,Q)&#x3D;\dfrac{f_P(Q+S)f_Q(-S)}{f_P(S)f_Q(P-S)}<br>$$<br>å…¶ä¸­$S\in E $ä¸”$S$ä¸ä¸º$O,P,-Q,P-Q$ã€‚å¹¶ä¸”$e_m(P,Q)$çš„å€¼ä¸å‡½æ•°$f_P,f_Q$çš„é€‰å–æ— å…³ã€‚</p><p>Weilé…å¯¹çš„å€¼æ»¡è¶³$e_m(P,Q)^m&#x3D;1$ã€$e_m(P,Q)&#x3D;e_m(Q,P)^{-1}$ï¼Œå…¶ä¸­$P,Q\in E[m]$ä¸”å¯¹äºä»»ä½•çš„$P\in E[m]$ï¼Œéƒ½æœ‰$e_m(P,P)&#x3D;1$ã€‚</p><p>å¹¶ä¸”ï¼ŒWeilé…å¯¹æ˜¯éé€€åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå¯¹äºä»»æ„çš„$Q\in E[m]$ï¼Œéƒ½æœ‰$e_m(P,Q)&#x3D;1$ï¼Œé‚£ä¹ˆå¯ä»¥æ¨å‡º$P&#x3D;O$ã€‚</p><p>æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªåŸº$P_1,P_2âˆˆE[m]$ã€‚é‚£ä¹ˆä»»æ„å…ƒç´ $PâˆˆE[m]$éƒ½å¯ä»¥æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šå†™æˆ$P&#x3D;a_PP_1+b_PP_2$ã€‚</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥åˆä»¥ä¸‹çš„å¼å­:<br>$$<br>e_m(P,Q)&#x3D;e_m(P_1,P_2)^{a_Pb_Q-a_Qb_P}<br>$$<br>Weilé…å¯¹çš„ä¼˜ç‚¹æ˜¯å®ƒå¯ä»¥éå¸¸æœ‰æ•ˆåœ°è®¡ç®—ä¸å¿…ç”¨$E[m]$çš„åŸºæ¥è¡¨ç¤º$P$å’Œ$Q$ã€‚</p><h3 id="6x04-ä¸€ç§æœ‰æ•ˆçš„ç®—æ³•æ¥è®¡ç®—Weilé…å¯¹"><a href="#6x04-ä¸€ç§æœ‰æ•ˆçš„ç®—æ³•æ¥è®¡ç®—Weilé…å¯¹" class="headerlink" title="6x04 ä¸€ç§æœ‰æ•ˆçš„ç®—æ³•æ¥è®¡ç®—Weilé…å¯¹"></a>6x04 ä¸€ç§æœ‰æ•ˆçš„ç®—æ³•æ¥è®¡ç®—Weilé…å¯¹</h3><p>æˆ‘ä»¬è®¾æ¤­åœ†æ›²çº¿$E$ä¸Šæœ‰ä¸¤ç‚¹$P,Q$ï¼Œç›´çº¿$P,Q$çš„æ–œç‡ä¸º$k$ï¼Œ$S(x,y)\in E$ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¾<br>$$<br>g_{P,Q}&#x3D;\dfrac{y-y_P-k(x-x_P)}{x+x_P+x_Q-k^2}<br>$$<br>å¦‚æœ$x_P&#x3D;x_Q$ä¸”$P \not &#x3D;Q$ï¼Œé‚£ä¹ˆä¸Šå¼çš„å€¼è§†ä¸º$x-x_P$ã€‚å¦‚æœ$P&#x3D;Q$ï¼Œé‚£ä¹ˆ$k$è§†ä¸º$P$ç‚¹åœ¨æ¤­åœ†æ›²çº¿ä¸Šå¯¹åº”ç‚¹çš„åˆ‡çº¿çš„æ–œç‡ï¼Œè€Œåˆ‡çº¿çš„æ–œç‡å¯ä»¥ç”¨é«˜ç­‰æ•°å­¦ä¸­éšå‡½æ•°æ±‚å¯¼æ³•æ±‚å‡ºä¸º$yâ€™&#x3D;\dfrac{3x^2+A}{2y}$</p><p>å› æ­¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è·å¾—è¿™æ ·ä¸€ä¸ªå¼å­ï¼š$\mathrm{div}(g_{P,Q})&#x3D;[P]+[Q]-[P+Q]-[O]$ã€‚</p><p>ä¸‹é¢çš„ç®—æ³•è¿”å›ä¸€ä¸ªé™¤æ•°æ»¡è¶³$\mathrm{div}(f_P ) &#x3D; m[P] âˆ’ [mP] âˆ’ (m âˆ’ 1)[O]$ã€‚</p><p>å·²çŸ¥$P(36,60)$å’Œ$Q(121,387)$å‡ä¸ºæœ‰é™åŸŸä¸Šæ¤­åœ†æ›²çº¿$y^2\equiv x^3+30x+34\pmod{631} $ä¸Šçš„$5$é˜¶ç‚¹ï¼Œè®¾$S(x,y)&#x3D;(19,186)$ä¸ºæ¤­åœ†æ›²çº¿ä¸Šç¬¦åˆæ¡ä»¶çš„ä»»æ„ä¸€ç‚¹ï¼Œé€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡º$e_5(P.Q)$çš„å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">o1=GF(<span class="hljs-number">631</span>)<br>A,B=<span class="hljs-number">30</span>,<span class="hljs-number">34</span><br>E=EllipticCurve(o1,[A,B])<br>m=<span class="hljs-number">5</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">g</span>(<span class="hljs-params">P,Q,S</span>):<br>    <span class="hljs-keyword">if</span>(P[<span class="hljs-number">0</span>]==Q[<span class="hljs-number">0</span>] <span class="hljs-keyword">and</span> P!=Q):<br>        <span class="hljs-keyword">return</span> S[<span class="hljs-number">0</span>]-P[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">if</span> P[<span class="hljs-number">0</span>]==Q[<span class="hljs-number">0</span>]:<br>        k=(<span class="hljs-number">3</span>*P[<span class="hljs-number">0</span>]*P[<span class="hljs-number">0</span>]+A)/(<span class="hljs-number">2</span>*P[<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">else</span>:<br>        k=(P[<span class="hljs-number">1</span>]-Q[<span class="hljs-number">1</span>])/(P[<span class="hljs-number">0</span>]-Q[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">return</span> (S[<span class="hljs-number">1</span>]-P[<span class="hljs-number">1</span>]-k*(S[<span class="hljs-number">0</span>]-P[<span class="hljs-number">0</span>]))/(S[<span class="hljs-number">0</span>]+P[<span class="hljs-number">0</span>]+Q[<span class="hljs-number">0</span>]-k*k)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">F</span>(<span class="hljs-params">P,S</span>):<br>    T,f=P,<span class="hljs-number">1</span><br>    n=<span class="hljs-built_in">bin</span>(m)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(n)):<br>        f=f*f*g(T,T,S)<br>        T=<span class="hljs-number">2</span>*T<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(n[i]):<br>            f=f*g(T,P,S)<br>            T=T+P<br>    <span class="hljs-keyword">return</span> f<br>P,Q,S=E(<span class="hljs-number">36</span>,<span class="hljs-number">60</span>),E(<span class="hljs-number">121</span>,<span class="hljs-number">387</span>),E(<span class="hljs-number">19</span>,<span class="hljs-number">186</span>)<br>tmp1=F(P,Q+S)/F(P,S)<br>tmp2=F(Q,P-S)/F(Q,-S)<br>ePQ=tmp1/tmp2<br><span class="hljs-built_in">print</span>(tmp1,tmp2,ePQ)<br><span class="hljs-comment">#198 345 242</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼š$242^5\equiv 1 \pmod {631}$</p><p>ç‰¹åˆ«åœ°ï¼Œå¦‚æœ$P \in E[m]$ï¼Œé‚£ä¹ˆ$\mathrm{div}(f_P)&#x3D;m[P]-m[O]$ã€‚</p><h3 id="6x05-Tateé…å¯¹"><a href="#6x05-Tateé…å¯¹" class="headerlink" title="6x05 Tateé…å¯¹"></a>6x05 Tateé…å¯¹</h3><p> Weilå¯¹æ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„éé€€åŒ–åŒçº¿æ€§å½¢å¼åœ¨ä»»ä½•é¢†åŸŸã€‚å¯¹äºæœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿è¿˜æœ‰å¦ä¸€å¯¹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºTateé…å¯¹åœ¨å¯†ç å­¦ä¸­ç»å¸¸ä½¿ç”¨ï¼Œå› ä¸ºå®ƒåœ¨è®¡ç®—ä¸Šæœ‰ç‚¹å¤æ‚æ¯”Weilé…å¯¹æ›´æœ‰æ•ˆã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç®€è¦ä»‹ç»Tateé…å¯¹ã€‚</p><p>è®¾$E$æ˜¯$GF(q)$ä¸Šçš„ä¸€ä¸ªæ¤­åœ†æ›²çº¿ï¼Œ$l$æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œè®¾$P\in E(GF(q))[l],Q \in E(GF(q))$ï¼Œé€‰æ‹©$E$ä¸Šçš„æœ‰ç†å‡½æ•°$f_P$ä½¿å¾—ï¼š<br>$$<br>\mathrm{div}(f_P)&#x3D;l[P]-l[O]<br>$$<br>å¹¶ä¸”Tateå¯¹$P,Q$çš„å€¼ä¸º<br>$$<br>Ï„ (P,Q)&#x3D;\dfrac{f_P(Q+S)}{f_P(S)}<br>$$<br>å…¶ä¸­$S$æ˜¯$E(GF(q))$ä¸Šä»»ä¸€ç‚¹ï¼Œå¹¶ä¸”ä½¿å¾—ä¸Šå¼çš„åˆ†å­åˆ†æ¯ä¸ä¸º$0$çš„ç‚¹ã€‚</p><p>äº‹å®è¯æ˜ï¼ŒTateé…å¯¹çš„å€¼åªæœ‰åœ¨ä¹˜ä»¥$GF(q)$å…ƒç´ çš„$l$æ¬¡å¹‚ä¹‹åæ‰æœ‰æ˜ç¡®çš„å®šä¹‰ã€‚å¦‚æœ$q \equiv 1 \pmod l$ï¼Œæˆ‘ä»¬å®šä¹‰$P,Q$çš„Tateé…å¯¹ä¸º<br>$$<br>Ï„â€™(P,Q)&#x3D;Ï„â€™(P,Q)^{(q-1)&#x2F;l}&#x3D;(\dfrac{f_P(Q+S)}{f_P(S)})^{(q-1)&#x2F;l}<br>$$<br>è®¾$E$æ˜¯$GF(q)$ä¸Šçš„ä¸€ä¸ªæ¤­åœ†æ›²çº¿ï¼Œ$l$æ˜¯ç´ æ•°æ»¡è¶³$q\equiv 1 \pmod l$ä¸”$E(GF(q))[L]&#x3D;\dfrac{Z}{lZ}$ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·ä¸€ä¸ªæ˜ å°„ï¼š<br>$$<br>:E(GF(q))[l]Ã—E(GF(q))[l] \rightarrow GF(q)<br>$$<br>å¹¶ä¸”è¿™ä¸ª$Ï„â€™$çš„æ€§è´¨ä¹Ÿæ»¡è¶³ï¼š<br>$$<br>Ï„â€™(P_1+P_2,Q)&#x3D;Ï„â€™(P_1,Q)Ï„â€™(P_2Q)<br>$$</p><p>$$<br>Ï„â€™(P,Q_1+Q_2)&#x3D;Ï„â€™(P,Q_1)Ï„â€™(P,Q_2)<br>$$</p><p>å¹¶ä¸”$Ï„â€™(P,P)$çš„å€¼$x$æ»¡è¶³$x^l\equiv 1 \pmod p$ä¸”$x \not &#x3D;1$ã€‚</p><h2 id="7-GF-p-k-ä¸Šçš„Weilå¯¹"><a href="#7-GF-p-k-ä¸Šçš„Weilå¯¹" class="headerlink" title="7.$GF(p^k)$ä¸Šçš„Weilå¯¹"></a>7.$GF(p^k)$ä¸Šçš„Weilå¯¹</h2><h3 id="7x01-åµŒå…¥åº¦å’ŒMOVç®—æ³•"><a href="#7x01-åµŒå…¥åº¦å’ŒMOVç®—æ³•" class="headerlink" title="7x01 åµŒå…¥åº¦å’ŒMOVç®—æ³•"></a>7x01 åµŒå…¥åº¦å’ŒMOVç®—æ³•</h3><p>è®¾$E$æ˜¯$GF(p)$ä¸Šçš„ä¸€ä¸ªæ¤­åœ†æ›²çº¿ï¼Œ$mâ‰¥1$ä¸”$p$ä¸æ•´é™¤$m$ï¼Œä¸ºäº†èƒ½å¤Ÿè·å¾—éé›¶çš„Weilé…å¯¹å€¼ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸€ä¸ª$E$ä¸Šçš„ç‹¬ç«‹çš„é˜¶ä¸º$m$çš„ç‚¹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé˜¶ä¸º$m$çš„ç‚¹ä¸€èˆ¬æœ‰$m^2$ä¸ªï¼Œä½†å®ƒä»¬çš„åæ ‡å¯èƒ½åœ¨ä¸€ä¸ªæ›´å¤§çš„åŸŸä¸­æ‰èƒ½å®Œå…¨å‡ºç°ã€‚</p><p><strong>å®šä¹‰ï¼šåµŒå…¥åº¦</strong> è®¾$E$æ˜¯$GF(p)$ä¸Šçš„æ¤­åœ†æ›²çº¿ï¼Œ$mâ‰¥1$ä¸”$p$ä¸æ•´é™¤$m$ï¼Œ$E$å¯¹$m$çš„åµŒå…¥åº¦çš„å€¼ä¸ºä½¿å¾—ä»¥ä¸‹å¼å­æˆç«‹çš„æœ€å°$k$å€¼ï¼š<br>$$<br>E(GF(p^k))[m] &#x3D; (\dfrac Z{mZ})^2<br>$$<br>è€Œåœ¨å¯†ç å­¦çš„åº”ç”¨ä¸­ï¼Œå½“$m$æ˜¯ä¸€ä¸ªå¤§ç´ æ•°æ—¶ï¼Œè¿™ä¸€æƒ…å†µä¸‹åµŒå…¥åº¦ä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼š</p><p>è®¾$E$æ˜¯$GF(p)$ä¸Šçš„ä¸€ä¸ªæ¤­åœ†æ›²çº¿ï¼Œ$l$æ˜¯ä¸€ä¸ªä¸$p$ä¸ç›¸ç­‰çš„ç´ æ•°ï¼Œé‚£ä¹ˆ$E$å¯¹$l$çš„åµŒå…¥åº¦å¯èƒ½æ˜¯ä¸‹é¢ä¸‰ç§æƒ…å†µä¹‹ä¸€ï¼š</p><p>1.$E$çš„åµŒå…¥åº¦ä¸º$1$ï¼Œä¸è¿‡å½“$l&gt;\sqrt p +1$çš„æ—¶å€™è¿™å¼ æƒ…å†µæ—¶ä¸å¯èƒ½çš„<br>2.$p \equiv 1 \pmod l$æ—¶ï¼Œ$E$çš„åµŒå…¥åº¦ä¸º$l$<br>3.$p \not \equiv 1 \pmod l$æ—¶ï¼Œæ­¤æ—¶çš„åµŒå…¥åº¦å°±æ˜¯ä½¿å¾—ä¸‹é¢å¼å­æˆç«‹çš„æœ€å°$k(â‰¥2)$å€¼ã€‚<br>$$<br>p^k \equiv 1 \pmod l<br>$$<br>è®¾$E$æ˜¯$GF(p)$ä¸Šçš„ä¸€ä¸ªæ¤­åœ†æ›²çº¿ï¼Œ$P\in E$å¹¶ä¸”$P$çš„é˜¶ä¸º$l$ï¼Œ$l$æ˜¯ä¸€ä¸ªå¤§ç´ æ•°ä¸”$l&gt;\sqrt p +1$ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„æ­¥éª¤æ¥æ±‚è§£ECDLPï¼Œè€Œè¿™é‡Œæ±‚è§£ECDLPçš„é—®é¢˜å°±éœ€è¦ç”¨åˆ°æ±‚è§£DLPçš„é—®é¢˜</p><p>1.è®¡ç®—$n&#x3D;|E(GF(p^k))|$ï¼Œå…¶ä¸­$|E|$è¡¨ç¤ºæ¤­åœ†æ›²çº¿å†…æ‰€å«ç‚¹æ•°<br>2.éšæœºé€‰å–ä¸€ä¸ªç‚¹$T \in E(GF(p^k))$ä¸”$T\not \in E(GF(p))$<br>3.è®¾$Tâ€™&#x3D;(n&#x2F;l)T$ï¼Œå¦‚æœ$Tâ€™&#x3D;O$ï¼Œé‡æ–°é€‰æ‹©$T$<br>4.è®¡ç®—$\alpha&#x3D;e_l(P,Tâ€™)$å’Œ$\beta &#x3D;e_l(Q,Tâ€™)$<br>5.è®¡ç®—ç¦»æ•£å¯¹æ•°$\alpha^x\equiv \beta \pmod p$<br>6.é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ±‚å‡º$Q&#x3D;xP$ï¼ŒECDLPæ±‚è§£ã€‚</p><h2 id="99-åè®°"><a href="#99-åè®°" class="headerlink" title="99.åè®°"></a>99.åè®°</h2><p>ECCç¬”è®°2åˆ°è¿™é‡Œæš‚æ—¶å…ˆç»“æŸï¼Œå†™çš„æ¯”è¾ƒåŒ†å¿™ï¼Œä¹¦ä¸Š5.8ã€5.9ã€5.10æœ‰å¾ˆå¤šæ¯”è¾ƒæ™¦æ¶©éš¾æ‡‚çš„ä¸œè¥¿ï¼Œä¸ªäººæ„Ÿè§‰åœ¨CTFä¸­çš„åº”ç”¨ä¸æ˜¯å¾ˆå¹¿æ³›ï¼ŒåæœŸä¼šå¯¹è¿™ä¸€ç¬”è®°è¿›è¡Œæ›´æ–°è¡¥å……ï¼ˆ<del>æ ¹æœ¬åŸå› æ˜¯å› ä¸ºè‡ªå·±å¤ªèœäº†ï¼Œçœ‹ä¸æ‡‚ï¼ˆ</del></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LatticeNotes6</title>
    <link href="/2021/03/01/LatticeNotes6/"/>
    <url>/2021/03/01/LatticeNotes6/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°6"><a href="#huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°6" class="headerlink" title="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°6"></a>huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°6</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0. About"></a>0. About</h2><p>è¿™ä¸ªç¬”è®°<strong>å¹¶æ²¡æœ‰</strong>æ¥ç€ä¹‹å‰å‘å¸ƒçš„ç¬”è®°5ï¼Œå¹¶ä¸”æ–‡ç« çš„tagæ ‡ä¸ºExplogè€Œä¸æ˜¯Notesï¼Œä¸»è¦è®²çš„æ˜¯LLLç®—æ³•åœ¨RSAä¸­çš„ä½¿ç”¨ã€‚</p><p>100å¤©çš„æ—¶é—´ï¼Œè‡ªå·±ç»ˆäºæŠŠNCTFé‚£é“é¢˜ç ”ç©¶äº†å‡ºæ¥ï¼Œwtcl</p><h2 id="1-RSA-WienerAttack"><a href="#1-RSA-WienerAttack" class="headerlink" title="1. RSA WienerAttack"></a>1. RSA WienerAttack</h2><p>æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹Wienerattackï¼ŒWienerattackä¸»è¦æ˜¯åŸºäºè¿åˆ†æ•°å±•å¼€ï¼Œåœ¨è‡ªå·±çš„åˆ·é¢˜è®°å½•**21Feb2[2021.2.16]**ä¸­æˆ‘ä»¬æåˆ°è¿‡è¿åˆ†æ•°å±•å¼€çš„ä¸€äº›æ³¨æ„äº‹é¡¹å¹¶è¿›è¡Œäº†ç®€å•çš„è¯æ˜ä»¥åŠè¿åˆ†æ•°å±•å¼€ä¸­ç²¾ç¡®è¦†ç›–çš„æ¡ä»¶ ã€‚ä¸‹é¢æˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼š</p><p><strong>å‹’è®©å¾·å®šç†</strong>ï¼šè‹¥$a \in Q, c,d\in Z,\gcd (c,d)&#x3D;1$ï¼Œå¦‚æœæœ‰<br>$$<br>|a-\dfrac c d| &lt; \dfrac 1 {2d^2}<br>$$<br>é‚£ä¹ˆåœ¨å¯¹$a$è¿›è¡Œè¿åˆ†æ•°å±•å¼€çš„æ—¶å€™ï¼Œå¯ä»¥ç²¾ç¡®è¦†ç›–åˆ°$\dfrac c d$çš„å€¼ã€‚ä¸‹é¢æˆ‘ä»¬ç®€å•è¯æ˜ä¸€ä¸‹WienerAttackçš„æœ‰æ•ˆæ€§ã€‚</p><p>è®¾$ed &#x3D; 1+kl,g&#x3D;\gcd(p-1,q-1),gl&#x3D;(p-1)(q-1)$ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ$l$æ˜¯$(p-1)(q-1)$çš„æœ€å°å…¬å€æ•°ã€‚åˆ™å½“$4 \ln d&lt;\ln n$æ—¶ï¼Œæœ‰ï¼š<br>$$<br>|\dfrac e n - \dfrac k {dg}|&#x3D;|\dfrac 1 {dn}-\dfrac {ks}{dgn}|&lt;\dfrac {ks}{dgn}&lt;\dfrac 1 {2(dg)^2}<br>$$<br>é‚£ä¹ˆå¯ä»¥é€šè¿‡$\dfrac e n$çš„è¿åˆ†æ•°å±•å¼€ç²¾ç¡®è¦†ç›–åˆ°$\dfrac k {dg}$ã€‚åˆå› ä¸º$ed&#x3D;k(p-1)(q-1)+1$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰<br>$$<br>edg&#x3D;k(p-1)(q-1)+g,k&gt;g<br>$$<br>å› æ­¤ï¼Œå¯ä»¥æœ‰<br>$$<br>\mathrm{floor}(\dfrac{edg}{k})&#x3D;(p-1)(q-1)<br>$$<br>å…¶ä¸­floorè¡¨ç¤ºå‘ä¸‹å–æ•´ã€‚</p><p>åˆå› ä¸º<br>$$<br>\dfrac{pq-(p-1)(q-1)+1} 2&#x3D;\dfrac {p+q} 2<br>$$<br>é‚£ä¹ˆæœ‰<br>$$<br>(\dfrac{p+q}2)-pq&#x3D;(\dfrac{p-q}2)^2<br>$$<br>å› æ­¤æˆ‘ä»¬åªéœ€è¦åˆ¤æ–­ä¸€ä¸‹è¿åˆ†æ•°ä¸­$(\dfrac{p-q} 2)^2$æ˜¯å¦ä¸ºå¹³æ–¹æ•°å³å¯ã€‚é™„ä¸Šsagemathä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sagemath</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">possible</span>(<span class="hljs-params">e,alist,N</span>): <br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> alist:<br>        <span class="hljs-keyword">if</span> x==<span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi = floor(e*(<span class="hljs-number">1</span>/x))<br>        <span class="hljs-keyword">if</span> (N-phi+<span class="hljs-number">1</span>)%<span class="hljs-number">2</span>==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> sqrt(<span class="hljs-built_in">pow</span>((N-phi+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)-N).is_integer():<br>                (p,q)=var(<span class="hljs-string">&#x27;p,q&#x27;</span>)<br>                x=solve([(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)==phi, p*q==N],p,q)<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(x[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]).split(<span class="hljs-string">&#x27;==&#x27;</span>)[<span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wiener_attack</span>(<span class="hljs-params">e,N</span>):<br>    c=continued_fraction(e/N)<br>    alist=c.convergents()<br>    <span class="hljs-keyword">return</span> possible(e,alist,N)<br>n=<br>e=<br>t=wiener_attack(e,n)<br><span class="hljs-built_in">print</span> (t)<br></code></pre></td></tr></table></figure><h2 id="2-Extend-Wiener-Attack-2D"><a href="#2-Extend-Wiener-Attack-2D" class="headerlink" title="2. Extend Wiener Attack 2D"></a>2. Extend Wiener Attack 2D</h2><p>å½“æˆ‘ä»¬å°†$e$çš„ä¸ªæ•°ä»$1$æå‡åˆ°$2$çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯å‡å¦‚å·²çŸ¥ä¸€ä¸ªæ¨¡æ•°$n$å’Œ$2$ä¸ª$e$å€¼ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ª$e$å€¼å¯¹åº”çš„è§£å¯†æŒ‡æ•°$d$éƒ½æ¯”è¾ƒå°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰äº†$e_id_i-k_in&#x3D;1$ï¼Œå…¶ä¸­$i$å–å€¼ä¸º$1,2$ã€‚</p><p>æ ¹æ®æˆ‘åˆšæ‰å¾—åˆ°çš„å¼å­ï¼š<br>$$<br>edg&#x3D;k(p-1)(q-1)+g,k&gt;g<br>$$<br>è®¾$s&#x3D;1-p-q$ï¼Œä¸Šå¼åŒ–ç®€æˆ<br>$$<br>edg-kn&#x3D;g+ks<br>$$<br>é‚£ä¹ˆæˆ‘ä»¬å°±æœ‰<br>$$<br>e_1d_1g_1&#x3D;g+k_1(p-1)(q-1),e_2d_2g_2&#x3D;g+k_2(p-1)(q-1)<br>$$<br>ç„¶åï¼Œé€šè¿‡åŒ–ç®€ï¼Œæ¶ˆå»$(p-1)(q-1)$ï¼Œå°±æœ‰<br>$$<br>k_2d_1e_1-k_1d_2e_2&#x3D;k_2-k_1<br>$$<br>ç„¶åå¾ˆå¿«å°±æœ‰<br>$$<br>\dfrac {e_1} {e_2}-\dfrac{k_1d_2}{k_2d_1}&#x3D;\dfrac {k_2-k_1}{k_2d_1e_2}<br>$$<br>å¾ˆæ˜¾ç„¶ï¼Œå¦‚æœ$2(k_2-k_1)d_1k_2&lt;e_2$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¿åˆ†æ•°é€¼è¿‘çš„æ–¹å¼ï¼Œæ±‚å‡º$\dfrac {e_1}{e_2}$è¿åˆ†æ•°å±•å¼€ä¸­çš„ç²¾ç¡®è¦†ç›–çš„å€¼$\dfrac{d_2k_1}{d_1k_2}$ï¼Œä½†ç€æƒ³æ‰¾åˆ°$d_1,d_2$æ—¶åŸºæœ¬ä¸ç°å®çš„ã€‚</p><p>é‚£ä¹ˆè¿™å°±è¿›å…¥äº†Extend Wiener Attack</p><p>æ ¹æ®æ„é€ æ ¼è¿›è¡ŒLLLçš„è¦æ±‚ï¼Œæˆ‘ä»¬å¿…é¡»è¦ç¡®å®šå·²çŸ¥é‡å’ŒæœªçŸ¥é‡ã€‚åœ¨è¿™é‡Œå·²çŸ¥é‡æ˜¯$e,n$ï¼ŒæœªçŸ¥é‡æ˜¯$k,d,s,g$ï¼Œ</p><p>é‚£ä¹ˆæ ¹æ®æˆ‘ä»¬åˆšåˆšæ„é€ çš„å¼å­ï¼š<br>$$<br>k_2d_1e_1g-k_1d_2e_2g&#x3D;k_2g-k_1g[1]<br>$$</p><p>$$<br>d_1gk_2e_1-k_1k_2n&#x3D;k_2g+k_1k_2(pq-p-q+1)&#x3D;k_2g+k_1k_2s[2]<br>$$</p><p>$$<br>(e_1d_1g-k_1n)(e_2d_2g-k_2n)&#x3D;(g+k_1s)(g+k_2s)[3]<br>$$</p><p>$[3]$å¯ä»¥ç»§ç»­è¿›è¡ŒåŒ–ç®€ï¼Œå¾—åˆ°ï¼š<br>$$<br>d_1d_2g^2e_1e_2-d_1gk_2e_1n-d_2gk_1e_2n+k_1k_2n^2&#x3D;(g+k_1s)(g+k_2s)[3]<br>$$<br>ç„¶åæˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹æ„é€ çŸ©é˜µï¼šç”±äºç­‰å·æœ€å·¦è¾¹æœ€å¤§é•¿åº¦æ˜¯$4$ï¼Œå› æ­¤éœ€è¦æ„é€ ä¸€ä¸ª$\mathrm{4x4}$çš„çŸ©é˜µã€‚å› æ­¤æˆ‘ä»¬è¦è€ƒè™‘å‡‘ä¸ªæ•°ã€‚æˆ‘ä»¬å‘ç°ï¼š$[2][3]$ä¸­éƒ½æœ‰$k_1k_2$è¿™ä¸ªå…ƒç´ ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å‡‘ä¸€ä¸ª$k_1k_2$å‡ºæ¥ã€‚</p><p>å› æ­¤ï¼Œæ ¹æ®$\vec vA&#x3D;\vec w$æ„é€ æ³•åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ï¼š$\vec v&#x3D;(k_1k_2,k_2d_1g,k_1d_2g,d_1d_2g^2)$ï¼Œ$\vec w&#x3D;(k_1k_2,k_2g-k_1g,k_2g+k_1k_2s,(g+k_1s)(g+k_2s))$ï¼Œè¿™æ ·ä½¿å¾—å‘é‡$\vec v$å’Œå‘é‡$\vec w$åŒ…æ‹¬äº†æ‰€æœ‰çš„æœªçŸ¥é‡ã€‚ç„¶åå°±å¯ä»¥æ„é€ å·²çŸ¥é‡çŸ©é˜µ$A$å¦‚ä¸‹å›¾äº†ã€‚</p><img src="/2021/03/01/LatticeNotes6/1.png" alt="1" style="zoom:40%;"><p>è¿™é‡Œæ˜¯å››ç»´çš„çŸ©é˜µï¼Œå¾ˆæ˜¾ç„¶å…¶è¡Œåˆ—å¼çš„å€¼ä¸º$ne_1e_2^2$ã€‚ä½†å‘é‡$\vec w$çš„é•¿åº¦æ˜æ˜¾è¦é•¿å¾ˆå¤šã€‚å› æ­¤æˆ‘ä»¬å°±å¼€å§‹è€ƒè™‘æ‰©å¤§$\det A$çš„å€¼ã€‚</p><p>æ ¹æ®æˆ‘ä»¬å·²çŸ¥æ¡ä»¶ï¼Œæœ‰$eâ‰ˆn,kâ‰ˆdâ‰ˆn^b,gâ‰ˆ1,sâ‰ˆ\sqrt n$ã€‚å› æ­¤ï¼Œ$\det A â‰ˆ n^4$ï¼Œè€Œ$|\vec w|$æ˜æ˜¾å¤§äºè¿™ä¸ªæ•°ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä»–é€šè¿‡å¯¹çŸ©é˜µå¾—åˆ—ä¹˜ä¸Šä¸€ä¸ªæ•°å¾—å€æ•°ä½¿å¾—æ¡ä»¶æ»¡è¶³ã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™çŸ©é˜µç¬¬ä¸€åˆ—ä¹˜ä¸Š$n$ï¼Œç¬¬äºŒåˆ—ä¹˜ä¸Š$\sqrt n$ï¼Œç¬¬ä¸‰åˆ—ä¹˜ä¸Š$n^{1+b}$ä½¿å¾—æ¡ä»¶æ»¡è¶³ï¼Œè¿™ä¹Ÿå°±æ˜¯é€šè¿‡çŸ©é˜µçš„åˆ—ä¹˜ä¸Šä¸€ä¸ªæ•°å­—ä½¿å¾—æ¡ä»¶æ»¡è¶³ã€‚</p><p>å› æ­¤ï¼Œæ„é€ åçš„$\vec w$ä¸º<br>$$<br>\vec w&#x3D;(k_1k_2n,k_2g-k_1g\sqrt{n},k_2g+k_1k_2sn^{1+b},(g+k_1s)(g+k_2s))<br>$$<br>æ­¤æ—¶å¯ä»¥è®¡ç®—å‡º$|\vec w|&lt; 2n^{1+2b}$ï¼Œä¹Ÿå°±æ˜¯<br>$$<br>2\sqrt[4]{\det A}&#x3D;2n \sqrt[8]{13+2b}<br>$$<br>ç„¶åæœ‰$bâ‰¤\dfrac 5 {14}$ã€‚ç„¶åå¯ä»¥å¸¦å…¥$n^{1+b}$ä¸­ï¼Œç„¶åå¯¹$A$ä½¿ç”¨$LLL$ç®—æ³•æ±‚å‡º$A$çš„æœ€çŸ­å‘é‡$\vec w$ï¼Œç„¶åè®¡ç®—$\vec v &#x3D;\vec w A^{-1}$ï¼Œåˆ©ç”¨$A$çš„å‰ä¸¤é¡¹æ±‚å‡º$\phi&#x3D;(p-1)(q-1)$ï¼Œè¿™é‡Œæœ‰$\phi&#x3D;e_1 \dfrac {k_1k_2}{k_2d_1g}$ã€‚</p><h2 id="3-ä¾‹é¢˜-2020ç¾ŠåŸæ¯-Simple"><a href="#3-ä¾‹é¢˜-2020ç¾ŠåŸæ¯-Simple" class="headerlink" title="3.ä¾‹é¢˜ [2020ç¾ŠåŸæ¯] Simple"></a>3.ä¾‹é¢˜ [2020ç¾ŠåŸæ¯] Simple</h2><p>é¦–å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> random<br>key = <span class="hljs-string">&quot;abcdefgh&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">des_encrypt</span>(<span class="hljs-params">m</span>):<br>    des = DES.new(key, DES.MODE_ECB)<br>    res = des.encrypt(m)<br>    <span class="hljs-keyword">return</span> res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>():<br>    p = getPrime(<span class="hljs-number">2048</span>)<br>    q = getPrime(<span class="hljs-number">2048</span>)<br>    n = p * q<br>    bit = n.bit_length()<br>    phi_n = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>    num = random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        u = getPrime(bit / <span class="hljs-number">4</span> - num)<br>        <span class="hljs-keyword">if</span> gmpy2.gcd(u, phi_n) != <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">continue</span><br>        t = gmpy2.invert(u, phi_n)<br>        e = bytes_to_long(des_encrypt(long_to_bytes(t)))<br>        <span class="hljs-keyword">if</span> gmpy2.gcd(e, phi_n) == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> (n, e)<br>P = getPrime(<span class="hljs-number">1024</span>)<br>Q = getPrime(<span class="hljs-number">1024</span>)<br>N = P * Q<br>E = <span class="hljs-number">65537</span><br>lcm = gmpy2.lcm(P-<span class="hljs-number">1</span>, Q-<span class="hljs-number">1</span>)<br>e1 = gmpy2.invert(getPrime(<span class="hljs-number">730</span>), lcm)<br>e2 = gmpy2.invert(getPrime(<span class="hljs-number">730</span>), lcm)<br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, E, N)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;N = &quot;</span> + <span class="hljs-built_in">str</span>(N)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;e2 = &quot;</span> + <span class="hljs-built_in">str</span>(e2)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;C = &quot;</span> + <span class="hljs-built_in">str</span>(c)  <br>_n, _e = gen_key()<br>_c = <span class="hljs-built_in">pow</span>(e1, _e, _n)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;n = &quot;</span> + <span class="hljs-built_in">str</span>(_n)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;e = &quot;</span> + <span class="hljs-built_in">str</span>(_e)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;c = &quot;</span> + <span class="hljs-built_in">str</span>(_c)<br></code></pre></td></tr></table></figure><p>æ•´ä¸ªé¢˜ç›®å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†è§£å†³ã€‚æˆ‘ä»¬é¦–å…ˆå¯ä»¥é€šè¿‡ä¸€æ¬¡DESè§£å¯†å¯ä»¥è·å¾—$t$å€¼ã€‚æ³¨æ„åˆ°$ut\equiv 1 \pmod {phin}$ï¼Œè€Œ$4\ln u&lt;\ln t$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡wiener attackæ±‚å‡º$u$çš„å€¼ã€‚è¿›è€Œå°±å¯ä»¥è§£å¯†å‡º$e_1$çš„å€¼äº†ã€‚å…¶ä¸­æ±‚$u$å¾—å€¼å°±ç”¨çš„ä¸Šé¢å¾—WienerAttackè„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> *<br>des=DES.new(<span class="hljs-string">b&quot;abcdefgh&quot;</span>,DES.MODE_ECB)<br>t=bytes_to_long(des.decrypt(long_to_bytes(e)))<br>u=<span class="hljs-number">11797660359487393794703501696733722234597800563221644744216546283873417801358839752749644652587148151353963016872894291750625278074742782471171817895256720486745393451876158473621006168530167397313514152556156473219068407536794185608357374065375644916773016430063167943099951326297693</span><br>phi=(t*u-<span class="hljs-number">1</span>)<br>d=inverse(e,t*u-<span class="hljs-number">1</span>)<br>e1=(<span class="hljs-built_in">pow</span>(c,d,n))<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å‘åŠ¨Extend Wiener Attackï¼Œå¯ä»¥æ³¨æ„åˆ°è¿™é‡Œä¸¤ä¸ªæœªçŸ¥çš„ç´ æ•°éƒ½åœ¨$730$ä½ï¼Œå› æ­¤æˆ‘ä»¬å°±æœ‰$b&#x3D;730$ï¼Œ$n$æ˜¯$2048$ä½ã€‚ç›´æ¥æ ¹æ®åˆšæ‰çš„ç†è®ºæ„å»ºæ ¼çŸ©é˜µå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>c=...<br>n=...<br>e1=...<br>e2=...<br>M=[[<span class="hljs-number">1</span>,-n,<span class="hljs-number">0</span>,n*n],[<span class="hljs-number">0</span>,e1,e1,-e1*n],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-e2,-e2*n],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,e1*e2]]<br>S1,S2=<span class="hljs-built_in">int</span>(n^<span class="hljs-number">0.5</span>),<span class="hljs-built_in">int</span>(n^(<span class="hljs-number">1</span>+<span class="hljs-number">730</span>/<span class="hljs-number">2048</span>))<br>D=diagonal_matrix(ZZ,[n,S1,S2,<span class="hljs-number">1</span>])<br>M=matrix(ZZ,M)*D<br>w=vector(ZZ,(M).LLL()[<span class="hljs-number">0</span>])<br>v=w*M^(-<span class="hljs-number">1</span>)<br>phi = <span class="hljs-built_in">int</span>(v[<span class="hljs-number">1</span>]//v[<span class="hljs-number">0</span>]*e1)<br>d=inverse(<span class="hljs-number">65537</span>,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,N)<br><span class="hljs-built_in">print</span> (long_to_bytes(m))<br><span class="hljs-comment">#b&#x27;GWHT&#123;3da44ca8379b98fdc1c86f9b34dcc1ef&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="4-3D-4D-Expand-WienerAttack"><a href="#4-3D-4D-Expand-WienerAttack" class="headerlink" title="4. 3D &amp; 4D Expand WienerAttack"></a>4. 3D &amp; 4D Expand WienerAttack</h2><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬å¦‚æœæ¯”è¾ƒä¸€ä¸‹ä¸Šé¢çš„å€¼ï¼Œå¯ä»¥å‘ç°$\ln d &#x3D; 0.35 \ln n$ï¼Œè¶…è¿‡äº†æˆ‘ä»¬ä¹‹å‰è¯´è¿‡çš„$0.25$çš„æ¯”å€¼ã€‚è€Œå®é™…ä¸Šï¼Œéšç€æ ¼ç»´åº¦çš„å¢åŠ (æ™®é€šçš„WienerAttackå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç»´çš„)ï¼Œå…è®¸çš„$\ln d$ä¸$\ln n$çš„æ¯”å€¼ä¹Ÿåœ¨å¢åŠ ã€‚ä¸‹é¢æ˜¯$n&#x3D;1$åˆ°$7$æ—¶Expand Wiener Attack æ‰€å…è®¸çš„æœ€å¤§æ¯”å€¼ï¼Œæœ€é«˜å¯ä»¥åˆ°$0.5$ã€‚</p><table><thead><tr><th align="center">$n$</th><th align="center">$1$</th><th align="center">$2$</th><th align="center">$3$</th><th align="center">$4$</th><th align="center">$5$</th><th align="center">$6$</th><th align="center">$â‰¥7$</th></tr></thead><tbody><tr><td align="center">$\dfrac{\ln d}{\ln n}$</td><td align="center">$0.25$</td><td align="center">$0.357$</td><td align="center">$0.4$</td><td align="center">$0.441$</td><td align="center">$0.468$</td><td align="center">$0.493$</td><td align="center">$0.5$</td></tr></tbody></table><p>è€Œå®é™…ä¸Šï¼Œæˆ‘ä»¬é€šè¿‡è§‚å¯Ÿä¹‹å‰äºŒç»´çš„æ ¼çš„å€¼ï¼Œä¼šå‘ç°æ¨å¯¼æ—¶ç»å¸¸ç”¨åˆ°ä¸¤ä¸ªå¼å­ï¼Œä¸‹é¢æˆ‘ä»¬ä¸ºäº†ç®€åŒ–ï¼Œç»™è¿™ä¸¤ä¸ªå¸¸ç”¨å¼å­æ‰“ä¸ªtagï¼š<br>$$<br>[W_1]:e_1d_1g-k_1n&#x3D;g+k_1s<br>$$</p><p>$$<br>[G_{(12)}]:e_2e_2k_1-e_1d_1k_2&#x3D;k_2-k_1<br>$$</p><p>åœ¨äºŒç»´çš„æ ¼ä¸­ï¼Œæˆ‘ä»¬å‡è®¾æ ¼åŸºæœ¬å•ä½ä¸º$A$ï¼Œè¡Œå˜æ¢å¯¹è§’çŸ©é˜µä¸º$P$ï¼Œåˆ—å˜æ¢å¯¹è§’çŸ©é˜µä¸º$Q$ï¼Œé‚£ä¹ˆåœ¨åˆšæ‰äºŒç»´çš„æ ¼ä¸­ï¼Œ$A_2$çš„å€¼å…¥ä¸‹å›¾</p><p><img src="/2021/03/01/LatticeNotes6/2.png" alt="2"></p><p>è€Œ$P_2&#x3D;\mathrm{diag}(1,e_1,e_2,e_1e_2),Q_2&#x3D;\mathrm{diag}(n,n^{0.5},n^{1+b},1)$ã€‚å…¶ä¸­$b$æ˜¯æˆ‘ä»¬ä¼°è®¡çš„$\dfrac{\ln d}{\ln n}$çš„å€¼ã€‚</p><p>å¹¶ä¸”ä¸è¦å¿˜è®°$\vec v_2&#x3D;(k_1k_2,d_1k_2g,k_1d_2g,d_1d_2g^2)$ã€‚</p><p>ä¸‹é¢æˆ‘æˆ‘ä»¬å°è¯•æ„å»ºä¸€ä¸‹ä¸‰ç»´çš„æƒ…å½¢ï¼š</p><p>é¦–å…ˆæ˜¯ç±»æ¯”$\vec v$çš„å€¼ï¼Œç”±äºä¸‰ç»´çš„å‡ºç°äº†$k_3$ï¼Œå› æ­¤$\vec v$ä¸­æ¯ä¸ªåˆ†é‡çš„$k$å’Œ$d$çš„å€¼ä¸ªæ•°ä¹‹å’Œåº”è¯¥ä¸º$3$ã€‚å¹¶ä¸”æ³¨æ„åˆ°$\vec v$ä¸­çš„ä¸€ä¸ªåˆ†é‡æœ‰å‡ ä¸ª$d$ï¼Œå¯¹åº”çš„é‚£ä¸ªåˆ†é‡å°±è¦ä¹˜ä¸Š$g$çš„å‡ æ¬¡æ–¹ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡º<br>$$<br>\vec v_3&#x3D;(k_1k_2k_3,d_1k_2k_3g,k_1d_2k_3g,d_1d_2k_3g^2,k_1k_2d_3g,d_1k_2d_3g^2,k_1d_2d_3g^2,d_1d_2d_3g^3)<br>$$<br>å¯ä»¥çœ‹å‡º$\vec v_3$çš„å‰ä¸‰ä¸ªåˆ†é‡ä»…ä»…æ˜¯æŠŠ$\vec v_2$ä¸­çš„æ‰€æœ‰åˆ†é‡éƒ½ä¹˜ä¸Šäº†ä¸ª$k_3$ï¼Œå› æ­¤ï¼Œå¦‚æœ$A_3$çœ‹ä½œåˆ†å—çŸ©é˜µçš„è¯ï¼Œ$A_3$çš„å·¦ä¸Šè§’åº”å½“æ˜¯$A_2$ï¼Œå·¦ä¸‹è§’åº”å½“æ˜¯$0$çŸ©é˜µã€‚åŒç†ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç±»æ¯”å‡º$A_3$çš„ç¬¬äº”åˆ—å’Œç¬¬å…«åˆ—çš„å€¼ï¼Œå‚è€ƒä¸€ä¸‹è¡¨è¾¾å¼$G_{13}$å’Œè¡¨è¾¾å¼$W_1W_2W_3$å³å¯ã€‚</p><p>ä¸è¿‡ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ„å»ºå«æœ‰$d_1d_3$çš„è¡¨è¾¾å¼ï¼ˆå¹¶ä¸”è¿˜ä¸èƒ½æœ‰$d_2d_3$é¡¹å‡ºç°ï¼‰è€ƒè™‘åˆ°è¿™ä¸€ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»º$W_1G_{23}$æ¥è§£å†³ã€‚ä¸è¿‡æœ€åä¸ºä¿è¯$g$çš„æŒ‡æ•°è¶³å¤Ÿéœ€è¦ä¹˜ä¸Šä¸€ä¸ª$g$ã€‚åŒç†ï¼Œæ„å»ºå«æœ‰$d_2d_3$çš„è¡¨è¾¾å¼ï¼Œé‚£å°±è®¾ç½®$W_2G_{13}$è§£å†³ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬æ„å»ºçš„æ ¼$A_3$å¦‚ä¸‹ï¼Œå…¶ä¸­ç¬¬$5,8$ä¸¤åˆ—å¯ä»¥ç±»æ¯”ä¸€ä¸‹å¾—åˆ°ï¼Œ$6,7$ä¸¤åˆ—é€šè¿‡é€šè¿‡$W,G$ä¸¤ä¸ªå¼å­çš„ç»„åˆæ¥å®Œæˆã€‚</p><p><img src="/2021/03/01/LatticeNotes6/3.png" alt="3"></p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—åˆ—$1$åˆ°$8$çš„åŸå§‹æ¨å¯¼å¼</p><table><thead><tr><th align="center">$1$</th><th align="center">$2$</th><th align="center">$3$</th><th align="center">$4$</th></tr></thead><tbody><tr><td align="center">$k_1k_2k_3$</td><td align="center">$W_1k_2k_3$</td><td align="center">$G_{12}k_3g$</td><td align="center">$W_1W_2k_3$</td></tr><tr><td align="center">$5$</td><td align="center">$6$</td><td align="center">$7$</td><td align="center">$8$</td></tr><tr><td align="center">$k_2G_{13}$</td><td align="center">$W_1G_{23}g$</td><td align="center">$W_{2}G_{13}g$</td><td align="center">$W_1W_2W_3$</td></tr></tbody></table><p>å…¶ä¸­å¦‚æœæ¨å¯¼æ—¶å‘ç°$g$çš„æŒ‡æ•°ä¸è¶³ï¼Œéœ€è¦è¡¥$g$çš„æŒ‡æ•°ï¼Œä¸Šé¢ç¬¬$3,6,7$ä¸ªæ¨å¯¼å¼å°±æ˜¯å¦‚æ­¤</p><p>ç±»æ¯”$P_{3}$ï¼Œæˆ‘ä»¬é€šè¿‡äºŒè¿›åˆ¶æ€ç»´ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°ç”±$P_2$æ„å»ºå‡º<br>$$<br>P_3&#x3D;\mathrm{diag}(1,e_1,e_2,e_1e_2,e_3,e_1e_3,e_2e_3,e_1e_2e_3)<br>$$<br>ä¸è¿‡$Q_3$å°±ä¸æ˜¯é‚£ä¹ˆå¥½æ„é€ äº†ã€‚æˆ‘ä»¬è¿˜æ˜¯å‡è®¾$b&#x3D;\dfrac{\ln d}{\ln n}$ã€‚</p><p>é‚£ä¹ˆæœ‰$k_1k_2k_3s^3â‰ˆn^{3(b+0.5)}$ï¼Œå› æ­¤æˆ‘ä»¬å‘ç°ï¼Œå½“æ ¼çš„ç»´æ•°æå‡$1$æ—¶ï¼Œè§‚å¯ŸçŸ©é˜µ$P_3A_3$æ¯ä¸€åˆ—æœ€ä¸Šé¢çš„é$0$å…ƒé‚£ä¹ˆå¯¹åº”çš„åˆ†é‡å°±è¦æå‡$0.5$ï¼Œå¦‚æœæŸä¸€åˆ—å¯¹åº”çš„æœ€é«˜éé›¶å…ƒå‡ºç°äº†$e$ï¼ŒæŒ‡æ•°è¿˜éœ€è¦é™„åŠ ä¸€ä¸ª$b$ã€‚è€Œå¦‚æœæœ€é«˜éé›¶å…ƒ$n$çš„æŒ‡æ•°æ¯å¢åŠ $1$ï¼Œé‚£ä¹ˆ$Q$å¯¹åº”åˆ†é‡$n$çš„æŒ‡æ•°å°±é™ä½$0.5$ã€‚</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥iç»§ç»­æ„é€ è¡¨æ ¼ï¼š</p><table><thead><tr><th align="center">åˆ—æ•°$i$</th><th align="center">$1$</th><th align="center">$2$</th><th align="center">$3$</th><th align="center">$4$</th></tr></thead><tbody><tr><td align="center">æœ€é«˜é$0$å…ƒ</td><td align="center">$1$</td><td align="center">$-n$</td><td align="center">$-e_1$</td><td align="center">$n^2$</td></tr><tr><td align="center">$Q_{ii}$</td><td align="center">$n^{1.5}$</td><td align="center">$n$</td><td align="center">$n^{1.5+b}$</td><td align="center">$n^{0.5}$</td></tr><tr><td align="center">åˆ—æ•°$i$</td><td align="center">$5$</td><td align="center">$6$</td><td align="center">$7$</td><td align="center">$8$</td></tr><tr><td align="center">æœ€é«˜é$0$å…ƒ</td><td align="center">$-e_1$</td><td align="center">$e_2n$</td><td align="center">$e_1n$</td><td align="center">$-n^3$</td></tr><tr><td align="center">$Q_$</td><td align="center">$n^{1.5+b}$</td><td align="center">$n^{1+b}$</td><td align="center">$n^{1+b}$</td><td align="center">$1$</td></tr></tbody></table><p>$$<br>Q_3&#x3D;\mathrm{diag}(n^{1.5},n,n^{1.5+b},n^{0.5},n^{1.5+b},n^{1+b},n^{1+b},1)<br>$$</p><p>è¿™æ ·å­çš„è¯ï¼Œæˆ‘ä»¬ä¸‰ç»´çš„æƒ…å†µå°±æ„é€ å¥½äº†ï¼Œä¸‰ç»´å¯ä»¥è§£å†³$\ln d&#x3D;0.4\ln n$çš„æƒ…å½¢ã€‚</p><p>åé¢å°±æ˜¯è€ƒè™‘æ„å»ºå››ç»´çš„æ ¼ã€‚å¾ˆæ˜¾ç„¶ï¼Œåœ¨å››ç»´çš„æ ¼é‡Œé¢ï¼Œ$\vec v_4$ä¸­æ¯ä¸ªåˆ†é‡å«$d$çš„ä¸ªæ•°åˆ†åˆ«æ˜¯ä»$1$åˆ°$4$ã€‚å…¶ä¸­é€šè¿‡ç±»æ¯”$\vec v_3$ä¸­ç»™äº†æˆ‘ä»¬æ„é€ åˆ†é‡ä¸­å«$0,1,2$ä¸ª$d$çš„æ–¹æ³•ï¼Œå¹¶ä¸”æœ€åå…¨æ˜¯$d$çš„æƒ…å†µçš„æ˜¯æ‰€æœ‰$W$å¼ç›¸ä¹˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°±éœ€è¦è€ƒè™‘è€ƒè™‘$3$ä¸ª$d$çš„æ„é€ æ–¹æ³•ã€‚</p><p>ç”±äºæˆ‘ä»¬åªæœ‰$W$å¼å’Œ$G$å¼ï¼Œå¦‚æœæƒ³è¦è®©å¼å­ä¸­æœ‰$3$ä¸ª$d$ï¼Œå…¶ä¸­å¿…é¡»è¦åŒ…å«$d_4$ï¼Œä»¥æ„é€ $\vec v_4$ä¸­çš„ç¬¬$12$ä¸ªåˆ†é‡$d_1d_2k_3d_4g^3$çš„æƒ…å†µä¸ºä¾‹ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯$d_1d_2$ï¼Œå¹¶ä¸”ä¸èƒ½å‡ºç°$d_3d_4$çš„ä¹˜ç§¯å¾—åˆ°æƒ…å†µï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¹˜ä¸Š$W_1W_2$ã€‚è€Œå¦‚æœæˆ‘ä»¬æƒ³åˆ†å¼€$d_3,d_4$,é‚£å°±å¯ä»¥ç»™è¿‡å»ä¸€ä¸ª$G_{34}$ï¼Œé€šè¿‡æ„é€ $G_{34}W_1W_2$æ¥å®Œæˆã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¾—åˆ°$A_4$çŸ©é˜µï¼Œä¹Ÿå¯ä»¥ç±»æ¯”å‡º$P_4,Q_4$</p><p><img src="/2021/03/01/LatticeNotes6/4.png" alt="4"><br>$$<br>P_4&#x3D;\mathrm{diag}(1,e_1,e_2,e_1e_2,e_3,e_1e_3,e_2e_3,e_1e_2e_3,e_4,e_1e_4,e_2e_4,e_1e_2e_4,e_3e_4,e_1e_3e_4,e_2e_3e_4,e_1e_2e_3e_4)<br>$$</p><p>$$<br>Q_4&#x3D;\mathrm{diag}(n^2,n^{1.5},n^{2+b},n,n^{2+b},n^{1.5+b},n^{1.5+b},n^{0.5},n^{2+b},n^{1.5+b},n^{1.5+b},n^{1+b},n^{1.5+b},n^{1+b},n^{1+b},1)<br>$$</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ‰©å±•åˆ°$5,6,7$ç»´çš„æƒ…å†µï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚</p><h2 id="5-ä¾‹é¢˜-2020NCTF-RRRSA"><a href="#5-ä¾‹é¢˜-2020NCTF-RRRSA" class="headerlink" title="5.ä¾‹é¢˜ [2020NCTF] RRRSA"></a>5.ä¾‹é¢˜ [2020NCTF] RRRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#RSA.py</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, getRandomNBitInteger, GCD, inverse<br>lcm = <span class="hljs-keyword">lambda</span> x, y: x*y // GCD(x,y)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RSA</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, bits</span>):<br>        p = getPrime(bits//<span class="hljs-number">2</span>)<br>        q = getPrime(bits//<span class="hljs-number">2</span>)<br>        <span class="hljs-variable language_">self</span>.N = p * q<br>        <span class="hljs-variable language_">self</span>.lbd = lcm(p-<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>)<br>        <span class="hljs-variable language_">self</span>.gen_ed(bits)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_ed</span>(<span class="hljs-params">self, bits</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            d = getRandomNBitInteger(<span class="hljs-built_in">int</span>(bits*<span class="hljs-number">0.4</span>))<br>            <span class="hljs-keyword">if</span> GCD(d, <span class="hljs-variable language_">self</span>.lbd) == <span class="hljs-number">1</span>:<br>                e = inverse(d, <span class="hljs-variable language_">self</span>.lbd)<br>                <span class="hljs-variable language_">self</span>.e, <span class="hljs-variable language_">self</span>.d = e, d<br>                <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self, m</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(m, <span class="hljs-variable language_">self</span>.e, <span class="hljs-variable language_">self</span>.N)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">self, c, d</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(c, d, <span class="hljs-variable language_">self</span>.N)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#task.py</span><br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> ascii_letters, digits<br><span class="hljs-keyword">from</span> RSA <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> FLAG<br>MENU = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">1. encrypt</span><br><span class="hljs-string">2. decrypt</span><br><span class="hljs-string">3. newkey</span><br><span class="hljs-string">4. encflag</span><br><span class="hljs-string">5. exit&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>():<br>    proof = <span class="hljs-string">&#x27;&#x27;</span>.join([choice(ascii_letters+digits) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)])<br>    _hexdigest = sha256(proof.encode()).hexdigest()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;sha256(XXXX+<span class="hljs-subst">&#123;proof[<span class="hljs-number">4</span>:]&#125;</span>) == <span class="hljs-subst">&#123;_hexdigest&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        prefix = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Give me XXXX: &quot;</span>)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error!&quot;</span>)<br>        exit(-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> sha256((prefix+proof[<span class="hljs-number">4</span>:]).encode()).hexdigest() == _hexdigest<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">task</span>():<br>    CHANCE = <span class="hljs-number">1</span><br>    RRRSA = RSA(<span class="hljs-number">1024</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;My public key: <span class="hljs-subst">&#123;RRRSA.e&#125;</span>, <span class="hljs-subst">&#123;RRRSA.N&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-built_in">print</span>(MENU)<br>            choice = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Your choice: &quot;</span>)<br>            <span class="hljs-keyword">if</span> choice == <span class="hljs-string">&quot;1&quot;</span>:<br>                m = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Your message: &quot;</span>))<br>                c = RRRSA.encrypt(m)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Your cipher: <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">elif</span> choice == <span class="hljs-string">&quot;2&quot;</span>:<br>                c = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Your message: &quot;</span>))<br>                d = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Your decryption exponent: &quot;</span>))<br>                m = RRRSA.decrypt(c, d)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Your message: <span class="hljs-subst">&#123;m&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">elif</span> choice == <span class="hljs-string">&quot;3&quot;</span>:<br>                RRRSA.gen_ed(<span class="hljs-number">1024</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;My new public key: <span class="hljs-subst">&#123;RRRSA.e&#125;</span>, <span class="hljs-subst">&#123;RRRSA.N&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">elif</span> choice == <span class="hljs-string">&quot;4&quot;</span>:<br>                <span class="hljs-keyword">if</span> CHANCE:<br>                    CHANCE -= <span class="hljs-number">1</span><br>                    flag = <span class="hljs-built_in">int</span>.from_bytes(FLAG, <span class="hljs-string">&#x27;big&#x27;</span>)<br>                    encflag = RRRSA.encrypt(flag)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;encflag: <span class="hljs-subst">&#123;encflag&#125;</span>&quot;</span>)<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Nope, only 1 chance to get encflag.&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Bye!&quot;</span>)<br>                exit(<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error!&quot;</span>)<br>            exit(-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">if</span> proof_of_work():<br>        task()<br></code></pre></td></tr></table></figure><p>é€šè¿‡è§‚å¯Ÿä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ï¼šæ¯æ¬¡ç”Ÿæˆçš„$d$æ»¡è¶³$\ln d &#x3D; 0.4 \ln n$çš„è§„æ¨¡ã€‚è€Œ$n$å¾—å€¼è‡ªå§‹è‡³ç»ˆéƒ½æ˜¯ä¸å˜åŒ–çš„ï¼Œä½†ä¸æ™®é€šçš„å…±æ¨¡æ”»å‡»ä¸åŒçš„å°±æ˜¯ï¼Œæˆ‘ä»¬åªèƒ½è·å¾—ä¸€æ¬¡flagçš„å¯†æ–‡ã€‚å› æ­¤å¯ä»¥ä½¿ç”¨Extend WienerAttackã€‚è€Œæ ¹æ®è¿™è¾¹$b&#x3D;0.4$çš„è§„æ¨¡ï¼Œå°±æ„é€ $4$ç»´çš„æ ¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n=<br>e=<br>c=<br>e1=<br>e2=<br>e3=<br>e4=<br>A=[<br>[<span class="hljs-number">1</span>,-n,<span class="hljs-number">0</span>,n^<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-n^<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,n^<span class="hljs-number">4</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-n,-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,n,n^<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,n,<span class="hljs-number">0</span>,n,<span class="hljs-number">0</span>,-n^<span class="hljs-number">2</span>,-n^<span class="hljs-number">3</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n,<span class="hljs-number">0</span>,n,<span class="hljs-number">0</span>,n^<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,n,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-n^<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,-n^<span class="hljs-number">3</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-n,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,n,n,n^<span class="hljs-number">2</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n,-n,n^<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-n^<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-n^<span class="hljs-number">3</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-n,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,n,-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,n,n^<span class="hljs-number">2</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,n,<span class="hljs-number">0</span>,n,<span class="hljs-number">0</span>,n^<span class="hljs-number">2</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-n],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n,-n,n^<span class="hljs-number">2</span>,-n,n^<span class="hljs-number">2</span>,n^<span class="hljs-number">2</span>,-n^<span class="hljs-number">3</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-n,<span class="hljs-number">0</span>,-n,<span class="hljs-number">0</span>,n^<span class="hljs-number">2</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-n,n^<span class="hljs-number">2</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-n],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n,-n,n^<span class="hljs-number">2</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-n],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]]<br>Q=[n^<span class="hljs-number">2</span>,n^<span class="hljs-number">1.5</span>,n^<span class="hljs-number">2.4</span>,n,n^<span class="hljs-number">2.4</span>,n^<span class="hljs-number">1.9</span>,n^<span class="hljs-number">1.9</span>,n^<span class="hljs-number">0.5</span>,n^<span class="hljs-number">2.4</span>,n^<span class="hljs-number">1.9</span>,n^<span class="hljs-number">1.9</span>,n^<span class="hljs-number">1.4</span>,n^<span class="hljs-number">1.9</span>,n^<span class="hljs-number">1.4</span>,n^<span class="hljs-number">1.4</span>,<span class="hljs-number">1</span>]<br>P=[<span class="hljs-number">1</span>,e1,e2,e1*e2,e3,e1*e3,e2*e3,e1*e2*e3,e4,e1*e4,e2*e4,e1*e2*e4,e3*e4,e1*e3*e4,e2*e3*e4,e1*e2*e3*e4]<br>A,P,Q=matrix(ZZ,A),diagonal_matrix(ZZ,P),diagonal_matrix(ZZ,Q)<br>A=P*A*Q<br>w=vector(ZZ,A.LLL()[<span class="hljs-number">0</span>])<br>v=w*A^(-<span class="hljs-number">1</span>)<br>phi=<span class="hljs-built_in">int</span>(e1*v[<span class="hljs-number">1</span>]//v[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(phi))<br>d=inverse(e,phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br><span class="hljs-comment">#NCTF&#123;Aft3r_411__t0morr0w_1s_an0ther_d4y&#125;</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶ä¹Ÿå¯ä»¥æ„é€ ä¸‰ç»´çš„æ ¼ï¼Œä¸è¿‡è¿™é‡Œè¾¹ç•Œå¡çš„æ¯”è¾ƒæ­»(æ°å¥½$0.4$å·¦å³)ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸ç¨³å®šï¼Œéœ€è¦å¤šè¯•å‡ æ¬¡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e=<br>c= <br>e2= <br>e1= <br>n= <br>e3=<br>A=[[<span class="hljs-number">1</span>,-n,<span class="hljs-number">0</span>,n^<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,-n^<span class="hljs-number">3</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-n,-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,n,n^<span class="hljs-number">2</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n,<span class="hljs-number">0</span>,n,<span class="hljs-number">0</span>,n^<span class="hljs-number">2</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-n],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n,-n,n^<span class="hljs-number">2</span>],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-n],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,-n],<br>[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]]<br>P=[<span class="hljs-number">1</span>,e1,e2,e1*e2,e3,e1*e3,e2*e3,e1*e2*e3]<br>Q=[n^<span class="hljs-number">1.5</span>,n,n^<span class="hljs-number">1.9</span>,n^<span class="hljs-number">0.5</span>,n^<span class="hljs-number">1.9</span>,n^<span class="hljs-number">1.4</span>,n^<span class="hljs-number">1.4</span>,<span class="hljs-number">1</span>]<br>A,P,Q=matrix(ZZ,A),diagonal_matrix(ZZ,P),diagonal_matrix(ZZ,Q)<br>A=P*A*Q<br>w=vector(ZZ,A.LLL()[<span class="hljs-number">0</span>])<br>v=w*A^(-<span class="hljs-number">1</span>)<br>phi1,phi2=<span class="hljs-built_in">int</span>(e1*v[<span class="hljs-number">1</span>]//v[<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(e2*v[<span class="hljs-number">2</span>]//v[<span class="hljs-number">0</span>])<br>phi=<span class="hljs-built_in">int</span>(phi1)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(phi1))<br>d,d0=inverse(e,phi),inverse(e2,phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br></code></pre></td></tr></table></figure><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6.æ€»ç»“"></a>6.æ€»ç»“</h2><p>RSAä¸æ ¼å¯†ç çš„ç»“åˆï¼Œè¿˜æ˜¯æ¯”è¾ƒéš¾çš„ï¼ˆï¼Œè‡ªå·±NCTFåœ¨æ”¾é¢˜å100å¤©ï¼Œæœ¬åœ°å¤ç°çš„æ—¶å€™æ‰åšå‡ºæ¥ï¼ˆï¼ˆï¼ˆ</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HgameDiv3,4</title>
    <link href="/2021/02/28/HgameDiv3/"/>
    <url>/2021/02/28/HgameDiv3/</url>
    
    <content type="html"><![CDATA[<h1 id="Hgame-Div-3-4é¢˜è§£"><a href="#Hgame-Div-3-4é¢˜è§£" class="headerlink" title="Hgame Div 3,4é¢˜è§£"></a>Hgame Div 3,4é¢˜è§£</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>ç»ˆäºåœ¨æ¥è§¦CTFå·®ä¸å¤šå¤§çº¦6ä¸ªæœˆåï¼Œå°è¯•æ‰“äº†ä¸€ä¸‹æ­å·ç”µå­ç§‘å¤§çš„CTFæ‹›æ–°é¢˜ï¼ˆ<del>æ€»ä½“æ„Ÿè§‰åªæœ‰4ä¸ªå­—ï¼šæˆ‘å¤ªèœäº†</del></p><p>åªåšäº†å¯†ç å­¦ï¼Œå…¶ä»–çš„é¢˜ç›®ä¸çœ‹ï¼Œ<del>å› ä¸ºä¸æ˜¯æˆ‘ç ”ç©¶çš„å†…å®¹ï¼ˆ</del></p><p>ç¬¬3ï¼Œ4ä¸¤å‘¨çš„é¢˜ç›®ç¡®å®éš¾åº¦å˜å¤§äº†å¾ˆå¤š</p><h2 id="1-LikiPrime"><a href="#1-LikiPrime" class="headerlink" title="1. LikiPrime"></a>1. LikiPrime</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> s2n<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> secrets, flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_prime</span>(<span class="hljs-params">secret</span>):<br>    prime = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(secret):<br>        prime = prime &lt;&lt; <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> prime - <span class="hljs-number">1</span><br>random.shuffle(secrets)<br>m = s2n(flag)<br>p = get_prime(secrets[<span class="hljs-number">0</span>])<br>q = get_prime(secrets[<span class="hljs-number">1</span>])<br>n = p * q<br>e = <span class="hljs-number">0x10001</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n = &#123;&#125;.format(n)&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e = &#123;&#125;.format(e)&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = &#123;&#125;.format(c)&quot;</span>)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®æœ€åç»™å‡ºçš„æ˜¯$n,e,c$çš„å€¼ã€‚</p><p>é€šè¿‡ç®€å•åœ°è§‚å¯Ÿä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œ$p,q$éƒ½å…·æœ‰$2^k-1$çš„å½¢å¼ï¼Œå¹¶ä¸”éƒ½æ˜¯ç´ æ•°ã€‚$n$çš„ä½æ•°ä¸º$5072$</p><p>$p.q$çš„å€¼ã€‚</p><p>æšä¸¾å‡º$p,q$ä¹‹åã€‚ä¹‹åå°±æ˜¯æ­£å¸¸çš„RSAè§£å¯†äº†ã€‚</p><p><code>hgame&#123;Mers3nne~Pr!Me^re4l1y_s0+5O-li7tle!&#125;</code></p><h2 id="2-HappyNewYear"><a href="#2-HappyNewYear" class="headerlink" title="2.HappyNewYear"></a>2.HappyNewYear</h2><p>é¢˜ç›®æè¿°ï¼šLiki çš„æœ‹å‹ä»¬åœ¨æ–°å¹´çš„æ—¶å€™ç»™å¥¹å‘é€äº†æ–°å¹´ç¥ç¦ã€‚å¥½å®¶ä¼™ï¼Œä¸€çœ‹å°±æ˜¯ç¾¤å‘çš„ï¼Œæœ‰å‡ ä¸ªæœ‹å‹å‘é€çš„å†…å®¹è¿˜æ˜¯ç›¸åŒçš„</p><p>ç„¶åé¢˜ç›®ç»™å‡ºäº†å¾ˆå¤š$n,c$çš„å€¼ï¼Œå¹¶ä¸”$e&#x3D;3$ã€‚ä¸å‡ºæ„å¤–åº”è¯¥æ˜¯ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»ã€‚å› ä¸ºæç¤ºæœ‰ä¸€æ ·çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸¤ä¸¤æšä¸¾ï¼Œä½¿ç”¨CRTæ±‚è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crt2</span>(<span class="hljs-params">m1,m2,r1,r2</span>):<br>    M=m1*m2<br>    t1,t2=inverse(m2,m1),inverse(m1,m2)<br>    <span class="hljs-keyword">return</span> (r1*t1*m2+r2*t2*m1)%M<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data2.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>n,c=[],[]<br>a=[]<br>b=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    n.append(<span class="hljs-built_in">int</span>(f.readline()))<br>    c.append(<span class="hljs-built_in">int</span>(f.readline()))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>,<span class="hljs-number">7</span>):<br>        now=crt2(n[i],n[j],c[i],c[j])<br>        <span class="hljs-keyword">if</span>(now <span class="hljs-keyword">in</span> a):<br>            <span class="hljs-keyword">if</span> now <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> b:<br>                b.append(now)<br>        <span class="hljs-keyword">else</span>:<br>            a.append(now)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b:<br>    c,d=iroot(i,<span class="hljs-number">3</span>)<br>    <span class="hljs-keyword">if</span>(d):<br>        <span class="hljs-built_in">print</span>(long_to_bytes(c))<br></code></pre></td></tr></table></figure><h2 id="3-EncryptedChats"><a href="#3-EncryptedChats" class="headerlink" title="3.EncryptedChats"></a>3.EncryptedChats</h2><p>é¢˜ç›®é¦–å…ˆç»™å‡ºäº†ä¸¤ä¸ªäººçš„å¯¹è¯ï¼Œè¿˜æœ‰AESåŠ å¯†çš„è¿‡ç¨‹ã€‚</p><h4 id="1-Dialogue"><a href="#1-Dialogue" class="headerlink" title="1.Dialogue"></a>1.Dialogue</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">Switch:</span> <span class="hljs-string">ä½ å¥½è€ä¼™æ±</span><br><span class="hljs-attr">Million:</span> <span class="hljs-string">ä½ å¥½</span><br><span class="hljs-attr">Switch:</span> <span class="hljs-string">æ‰€ä»¥ä¸ºä»€ä¹ˆè¿™å®¶ä¼™åœ¨è¿™é‡Œ</span><br><span class="hljs-attr">Liki:</span> <span class="hljs-string">å› ä¸ºæˆ‘æ˜¯æ¥è®°å½•ä½ ä»¬è°ˆè¯å†…å®¹çš„</span><br><span class="hljs-attr">Million:</span> <span class="hljs-string">å¥½å§</span><br><span class="hljs-attr">Million:</span> <span class="hljs-string">ä¸è¿‡æˆ‘å¯ä»¥æä¸€ä¸ªè¦æ±‚å—</span><br><span class="hljs-attr">Liki:</span> <span class="hljs-string">?</span><br><span class="hljs-attr">Million:</span> <span class="hljs-string">æˆ‘ä»¬...æ¢ä¸€ä¸ªç¾¤èŠ</span><br><span class="hljs-attr">Switch:</span> <span class="hljs-string">å¥½å•Š!</span> <span class="hljs-string">æˆ‘çœ‹çœ‹,</span> <span class="hljs-string">å°±æ¢åˆ°åŠ æ³•ç¾¤èŠå§!</span><br><span class="hljs-attr">Switch:</span> <span class="hljs-string">å–‚,</span> <span class="hljs-string">å¸®å¿™é€‰ä¸€ä¸ªè´¨æ•°</span> <span class="hljs-string">g</span> <span class="hljs-string">å§</span><br><span class="hljs-attr">Liki:</span> <span class="hljs-string">??,</span> <span class="hljs-number">12602983924735419868428783329859102652072837431735895060811258460532600319539509800915989811879506790207025505003183121812480524033163157114086741486989697</span><br><span class="hljs-attr">Million:</span> <span class="hljs-string">è¿™ä½å¥³å£«ï¼Œå¯ä»¥åŠ³çƒ¦æ‚¨å†ä¸ºæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªè´¨æ•°</span> <span class="hljs-string">p</span> <span class="hljs-string">å—</span><br><span class="hljs-attr">Liki:</span> <span class="hljs-string">???...é‚£å°±,</span>  <span class="hljs-number">30567260905179651419358486099834315837354102714690253338851161207042846254351374572818884286661092938876675032728700590336029243619773064402923830209873155153338320502164587381848849791304214084993139233581072431814555885408821184652544361671134564827265516331283076223247829980225591857643487356406284913560960657053777612115591241983729716542192518684003840806442329098770424504275465756739925434019460351138273272559738332984560095465809481270198689251655392941966835733947437503158486731906649716026200661065054914445245468517406404904444261196826370252359102324767986314473183183059212009545789665906197844518119</span> <span class="hljs-string">å§,</span> <span class="hljs-string">å¤Ÿå¤§äº†å—?</span><br><span class="hljs-attr">Million:</span> <span class="hljs-string">å¥½çš„,</span> <span class="hljs-string">æˆ‘é€‰å¥½æˆ‘çš„</span> <span class="hljs-string">a</span> <span class="hljs-string">äº†,</span> <span class="hljs-string">é‚£ä¹ˆ</span> <span class="hljs-string">A</span> <span class="hljs-string">=</span> <span class="hljs-number">6407001517522031755461029087358686699246016691953286745456203144289666065160284103094131027888246726980488732095429549592118968601737506427099198442788626223019135982124788211819831979642738635150279126917220901861977041911299607913392143290015904211117118451848822390856596017775995010697100627886929406512483565105588306151304249791558742229557096175320767054998573953728418896571838697779621641522372719890056962681223595931519174265357487072296679757688238385898442549594049002467756836225770565740860731932911280385359763772064721179733418453824127593878917184915316616399071722555609838785743384947882543058635</span><br><span class="hljs-comment"># A = a ^ g % p = pow(g, a, p)</span><br><span class="hljs-attr">Switch:</span> <span class="hljs-string">okay,</span> <span class="hljs-string">b</span> <span class="hljs-string">ä¹Ÿé€‰å¥½äº†,</span> <span class="hljs-string">B</span> <span class="hljs-string">=</span> <span class="hljs-number">5522084830673448802472379641008428434072040852768290130448235845195771339187395942646105104638930576247008845820145438300060808178610210847444428530002142556272450436372497461222761977462182452947513887074829637667167313239798703720635138224358712513217604569884276513251617003838008296082768599917178457307640326380587295666291524388123169244965414927588882003753247085026455845320527874258783530744522455308596065597902210653744845305271468086224187208396213207085588031362747352905905343508092625379341493584570041786625506585600322965052668481899375651376670219908567608009443985857358126335247278232020255467723</span><br><span class="hljs-comment"># B = b ^ g % p = pow(g, b, p)</span><br><span class="hljs-attr">Liki:</span> <span class="hljs-string">????</span><br><span class="hljs-attr">Million:</span> &#123;<span class="hljs-attr">&#x27;iv&#x27;:</span> <span class="hljs-string">&#x27;d3811beb5cd2a4e1e778207ab541082b&#x27;</span>, <span class="hljs-attr">&#x27;encrypted_flag&#x27;:</span> <span class="hljs-string">&#x27;059e9c216bcc14e5d6901bcf651bee361d9fe42f225bc0539935671926e6c092&#x27;</span>&#125;<br><span class="hljs-attr">Switch:</span> &#123;<span class="hljs-attr">&#x27;iv&#x27;:</span> <span class="hljs-string">&#x27;b4259ed79d050dabc7eab0c77590a6d0&#x27;</span>, <span class="hljs-attr">&#x27;encrypted_flag&#x27;:</span> <span class="hljs-string">&#x27;af3fe410a6927cc227051f587a76132d668187e0de5ebf0608598a870a4bbc89&#x27;</span>&#125;<br><span class="hljs-attr">Million:</span> <span class="hljs-string">å†è§ä¼™æ±</span><br><span class="hljs-attr">Switch:</span> <span class="hljs-string">å†è§</span><br><span class="hljs-attr">Liki:</span> <span class="hljs-string">?????</span><br><br></code></pre></td></tr></table></figure><h4 id="2-AES-encryption"><a href="#2-AES-encryption" class="headerlink" title="2.AES encryption"></a>2.AES encryption</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad, unpad<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> shared_secret, FLAG<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_flag</span>(<span class="hljs-params">shared_secret: <span class="hljs-built_in">int</span></span>):<br>    <span class="hljs-comment"># Derive AES key from shared secret</span><br>    sha1 = hashlib.sha1()<br>    sha1.update(<span class="hljs-built_in">str</span>(shared_secret).encode(<span class="hljs-string">&#x27;ascii&#x27;</span>))<br>    key = sha1.digest()[:<span class="hljs-number">16</span>]<br>    <span class="hljs-comment"># Encrypt flag</span><br>    iv = os.urandom(<span class="hljs-number">16</span>)<br>    cipher = AES.new(key, AES.MODE_CBC, iv)<br>    ciphertext = cipher.encrypt(pad(FLAG, <span class="hljs-number">16</span>))<br>    <span class="hljs-comment"># Prepare data to send</span><br>    data = &#123;&#125;<br>    data[<span class="hljs-string">&#x27;iv&#x27;</span>] = iv.<span class="hljs-built_in">hex</span>()<br>    data[<span class="hljs-string">&#x27;encrypted_flag&#x27;</span>] = ciphertext.<span class="hljs-built_in">hex</span>()<br>    <span class="hljs-keyword">return</span> data<br><span class="hljs-built_in">print</span>(encrypt_flag(shared_secret))<br></code></pre></td></tr></table></figure><h4 id="3-Solution"><a href="#3-Solution" class="headerlink" title="3.Solution"></a>3.Solution</h4><p>å¾ˆæ˜¾ç„¶ï¼Œçœ‹åˆ°ä¸¤ä¸ªäººçš„å¯¹è¯ï¼Œå°±çŸ¥é“è¿™é“é¢˜è€ƒç‚¹æ˜¯æ•°å­—ç­¾åã€‚ä¹Ÿå°±æ˜¯è‘—åçš„DHå¯†é’¥äº¤æ¢ç®—æ³•ã€‚è¿™ä¸ªåœ¨æˆ‘çš„<strong>DLP Notes 1</strong>é‡Œé¢æœ‰è¾ƒä¸ºè¯¦ç»†çš„ä»‹ç»ã€‚</p><p>ä¸è¿‡åœ¨è¿™è¾¹æœ‰ä¸€ä¸ªæ–°çš„æ¦‚å¿µå°±æ˜¯ç¾¤ï¼šç®€å•æ¥è¯´ï¼Œç¾¤å°±æ˜¯ä¸€ä¸ªå°é—­çš„è¿ç®—é›†åˆã€‚åœ¨ä¸€ä¸ªç¾¤$G$é‡Œé¢ï¼Œä½¿ç”¨çš„è¿ç®—ç¬¦å·æ˜¯$\mathrm{op}$ã€‚é‚£ä¹ˆå¯¹äºä»»æ„çš„$a,b,\in G$ï¼Œæ»¡è¶³äº¤æ¢å¾‹å¾‹$a \text{ op }b&#x3D;b\text{ op }a$ï¼Œç»“åˆå¾‹$a\text{ op }b\text{ op }c&#x3D;a\text{ op }(b\text{ op }c)$ã€‚å¹¶ä¸”ç¾¤ä¸­æœ‰ä¸€ä¸ªä¸­æ€§å…ƒ$e$ï¼Œæ¯ä¸ªå…ƒç´ $a$éƒ½æœ‰ä¸€ä¸ªé€†å…ƒ$a^{-1}$ï¼Œä½¿å¾—$a\text{ op } a^{-1}&#x3D;e$ã€‚å½“ç„¶ï¼Œ$a\text{ op }a$åœ¨ç¾¤ä¸­å¯ä»¥è®°ä½œ$a^2$ã€‚</p><p>ä»ä¸Šè¿°å¯¹è¯ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šè¿™é‡Œä½¿ç”¨çš„æ˜¯åŠ æ³•ç¾¤ï¼Œå› æ­¤$\mathrm{op}&#x3D;+$ï¼Œè€Œè¡¨é¢ä¸Šçš„æŒ‡æ•°ï¼Œå®é™…ä¸Šåº”è¯¥æ˜¯æ•°å­¦è®¡ç®—ä¸­çš„ä¹˜å·ã€‚</p><p>æ ¹æ®DHå¯†é’¥äº¤æ¢ç³»ç»Ÿï¼Œæœ€åå…±äº«å¯†é’¥æ˜¯ç¾¤é‡Œé¢çš„$g^{ab}$ã€‚ç”±äºè¿™é‡Œæ˜¯åŠ æ³•ç¾¤ï¼Œå› æ­¤å…±äº«å†…å®¹æ˜¯$gab$ä¸‰è€…ä¹˜ç§¯æ¨¡$p$çš„å€¼ã€‚å› æ­¤ç›´æ¥æ±‚ä¸ªé€†å…ƒå°±å¯ä»¥å¾—åˆ°$a,b$ã€‚</p><p>è‡³äºAESéƒ¨åˆ†ï¼Œç›´æ¥æ¨¡ä»¿ä»–çš„åŠ å¯†è¿‡ç¨‹æ„å»ºå¯†é’¥å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs PYTHON"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> g,p,A,B<br>d=inverse(g,p)<br>a,b=A*d%p,B*d%p<br>S=g*a*b%p<br>sha1=hashlib.sha1()<br>sha1.update(<span class="hljs-built_in">str</span>(S).encode(<span class="hljs-string">&#x27;ascii&#x27;</span>))<br>key=sha1.digest()[:<span class="hljs-number">16</span>]<br>iv=[<span class="hljs-number">0xd3811beb5cd2a4e1e778207ab541082b</span>,<span class="hljs-number">0xb4259ed79d050dabc7eab0c77590a6d0</span>]<br>c=[<span class="hljs-number">0x059e9c216bcc14e5d6901bcf651bee361d9fe42f225bc0539935671926e6c092</span>,<span class="hljs-number">0xaf3fe410a6927cc227051f587a76132d668187e0de5ebf0608598a870a4bbc89</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>    iv[i]=long_to_bytes(iv[i])<br>    c[i]=long_to_bytes(c[i])<br>cipher1 = AES.new(key, AES.MODE_CBC, iv[<span class="hljs-number">0</span>])<br>cipher2 = AES.new(key, AES.MODE_CBC, iv[<span class="hljs-number">1</span>])<br>d1=cipher1.decrypt(c[<span class="hljs-number">0</span>])<br>d2=cipher2.decrypt(c[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(d1,d2)<br></code></pre></td></tr></table></figure><h2 id="4-å¤ºå®å¤§å†’é™©1"><a href="#4-å¤ºå®å¤§å†’é™©1" class="headerlink" title="4.å¤ºå®å¤§å†’é™©1"></a>4.å¤ºå®å¤§å†’é™©1</h2><h3 id="Step-1ï¼šé˜…è¯»é¢˜ç›®ï¼Œç¡®å®šç®—æ³•"><a href="#Step-1ï¼šé˜…è¯»é¢˜ç›®ï¼Œç¡®å®šç®—æ³•" class="headerlink" title="Step 1ï¼šé˜…è¯»é¢˜ç›®ï¼Œç¡®å®šç®—æ³•"></a>Step 1ï¼šé˜…è¯»é¢˜ç›®ï¼Œç¡®å®šç®—æ³•</h3><p>è¿˜æ˜¯å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>flag = <span class="hljs-string">&quot;xxxx&quot;</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cxx1ff</span>:<br>    c4ff1x = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">8</span>),<span class="hljs-string">&#x27;big&#x27;</span>)<br>    c66f6 = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">8</span>),<span class="hljs-string">&#x27;big&#x27;</span>)<br>    c4ff10 = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">8</span>),<span class="hljs-string">&#x27;big&#x27;</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        <span class="hljs-variable language_">self</span>.state = seed<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.state = (<span class="hljs-variable language_">self</span>.state * <span class="hljs-variable language_">self</span>.c4ff1x + <span class="hljs-variable language_">self</span>.c66f6) % <span class="hljs-variable language_">self</span>.c4ff10<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.state<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cxx2ff</span>:<br>    c4ff1x = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">8</span>),<span class="hljs-string">&#x27;big&#x27;</span>)<br>    c66f6 = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">8</span>),<span class="hljs-string">&#x27;big&#x27;</span>)<br>    c4ff10 = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">8</span>),<span class="hljs-string">&#x27;big&#x27;</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        <span class="hljs-variable language_">self</span>.state = seed<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.state = (<span class="hljs-variable language_">self</span>.state * <span class="hljs-variable language_">self</span>.c4ff1x + <span class="hljs-variable language_">self</span>.c66f6) % <span class="hljs-variable language_">self</span>.c4ff10<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.state<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cxx3ff</span>:<br>    c4ff1x = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">8</span>),<span class="hljs-string">&#x27;big&#x27;</span>)<br>    c66f6 = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">8</span>),<span class="hljs-string">&#x27;big&#x27;</span>)<br>    c4ff10 = <span class="hljs-built_in">int</span>.from_bytes(os.urandom(<span class="hljs-number">8</span>),<span class="hljs-string">&#x27;big&#x27;</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        <span class="hljs-variable language_">self</span>.state = seed<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.state = (<span class="hljs-variable language_">self</span>.state * <span class="hljs-variable language_">self</span>.c4ff1x + <span class="hljs-variable language_">self</span>.c66f6) % <span class="hljs-variable language_">self</span>.c4ff10<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.state<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test1</span>():<br>    gen = Cxx1ff(<span class="hljs-number">123</span>) <br>    <span class="hljs-built_in">print</span>((Cxx1ff.c4ff1x,Cxx1ff.c4ff10))<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    t1 = <span class="hljs-built_in">input</span>()<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(t1.strip())==Cxx1ff.c66f6:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test2</span>():<br>    gen = Cxx2ff(<span class="hljs-number">123</span>)<br>    <span class="hljs-built_in">print</span>((Cxx2ff.c4ff10))<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    t1 = <span class="hljs-built_in">input</span>()<br>    t2 = <span class="hljs-built_in">input</span>()<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">int</span>(t1.strip())==Cxx2ff.c4ff1x) <span class="hljs-keyword">and</span> (<span class="hljs-built_in">int</span>(t2.strip())==Cxx2ff.c66f6):<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test3</span>():<br>    gen = Cxx3ff(<span class="hljs-number">123</span>)<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-built_in">print</span>(gen.<span class="hljs-built_in">next</span>())<br>    t1 = <span class="hljs-built_in">input</span>()<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(t1.strip())==Cxx3ff.c4ff10:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    ans = <span class="hljs-number">0</span><br>    ans += test1()<br>    ans += test2()<br>    ans += test3()<br>    <span class="hljs-keyword">if</span> ans&gt;=<span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;win&quot;</span>)<br>        <span class="hljs-built_in">print</span>(flag)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;fail&quot;</span>)<br></code></pre></td></tr></table></figure><p>é€šè¿‡é˜…è¯»ä»£ç å¯ä»¥å‘ç°ï¼Œè¿™é“é¢˜å®é™…ä¸Šæ˜¯çº¿æ€§åŒä½™ç”Ÿæˆå™¨çš„ä¸€ä¸ªé¢˜ç›®ã€‚çº¿æ€§åŒä½™ç”Ÿæˆå™¨å°±æ˜¯é€šè¿‡é€’æ¨å¼$X_{n+1}\equiv AX_{n}+B \pmod M$çš„è®¡ç®—æ¥ç”Ÿæˆéšæœºæ•°ï¼Œå®ƒåŒ…æ‹¬ä¸€ä¸ªçº¿æ€§å‡½æ•°$Ax+B$å’Œæ¨¡$M$è¿ç®—ã€‚</p><p>è€Œè¿™é“é¢˜ï¼Œå®é™…ä¸Šåˆ†æˆäº†ä¸‰ä¸ªå°é—®ï¼Œå½“ä¸‰ä¸ªå°é—®éƒ½ç­”å¯¹çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¼šç›´æ¥ç»™ä½ flagï¼Œä¸‹é¢æˆ‘ä»¬é€ä¸€è§£å†³è¿™ä¸‰å°é—®ã€‚</p><h3 id="Step-2-åˆ†æ­¥è§£å†³é—®é¢˜ï¼Œæå‡ºåˆæ­¥æ–¹æ¡ˆã€‚"><a href="#Step-2-åˆ†æ­¥è§£å†³é—®é¢˜ï¼Œæå‡ºåˆæ­¥æ–¹æ¡ˆã€‚" class="headerlink" title="Step 2: åˆ†æ­¥è§£å†³é—®é¢˜ï¼Œæå‡ºåˆæ­¥æ–¹æ¡ˆã€‚"></a>Step 2: åˆ†æ­¥è§£å†³é—®é¢˜ï¼Œæå‡ºåˆæ­¥æ–¹æ¡ˆã€‚</h3><h4 id="Question-1"><a href="#Question-1" class="headerlink" title="Question 1"></a>Question 1</h4><p>ç¬¬ä¸€é—®æ˜¯å·²çŸ¥$A,M,X_{0}&#x3D;123,X_1,X_2$ï¼Œæ±‚$B$ã€‚é‚£ä¹ˆæˆ‘ä»¬æ ¹æ®<br>$$<br>X_{1}\equiv AX_{0}+B \pmod M<br>$$<br>å¯ä»¥ç›´æ¥æ¨å‡º<br>$$<br>B\equiv X_{1}-AX_{0} \pmod M<br>$$<br>æ‰€ä»¥ï¼Œç¬¬ä¸€é—®çœŸæ­£çš„è®¡ç®—åªæœ‰ä¸€è¡Œä»£ç ï¼ˆæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯æˆ‘è¿›è¡Œæœ¬åœ°æµ‹è¯•æ—¶ä½¿ç”¨çš„æ•°æ®ï¼ŒæœåŠ¡å™¨ç»™å‡ºçš„æ•°æ®å¯èƒ½ä¸ä¸€æ ·ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">a=<span class="hljs-number">3423853412712492282</span><br>m=<span class="hljs-number">17055887075354437978</span><br>x1=<span class="hljs-number">8976750431089074058</span><br>b=(x1-<span class="hljs-number">123</span>*a)%m<br><span class="hljs-built_in">print</span>(b)<br></code></pre></td></tr></table></figure><h4 id="Question-2"><a href="#Question-2" class="headerlink" title="Question 2"></a>Question 2</h4><p>ç¬¬äºŒé—®ï¼Œå·²çŸ¥$M,X_0&#x3D;123,X_1,X_2,X_3$ã€‚è¦æ±‚å‡º$A,B$é‚£ä¹ˆæˆ‘ä»¬æ ¹æ®$X_1\equiv AX_0+B \pmod M$ã€$X_2\equiv AX_1+B \pmod M$ã€$X_3\equiv AX_2+B \pmod M$ã€‚ç¬¬äºŒä¸ªå¼å­å‡å»ç¬¬ä¸€ä¸ªå¼å­ï¼Œç¬¬ä¸‰ä¸ªå¼å­å‡å»ç¬¬äºŒä¸ªå¼å­ï¼Œæ¶ˆå»äº†$B$ï¼Œå°±å¾—åˆ°<br>$$<br>X_2-X_1\equiv A(X_1-X_0)\pmod M<br>$$</p><p>$$<br>X_3-X_2\equiv A(X_2-X_1)\pmod M<br>$$</p><p>æ‰€ä»¥ï¼Œä»¥ç¬¬ä¸€ä¸ªå¼å­ä¸¤è¾¹é™¤ä»¥$X_1-X_0$ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>(X_2-X_1)(X_1-X_0)^{-1}\equiv A \pmod M<br>$$<br>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ç¬¬äºŒä¸ªå¼å­<br>$$<br>(X_3-X_2)(X_2-X_1)^{-1}\equiv A \pmod M<br>$$<br>$A$æ±‚å‡ºæ¥ä¹‹åï¼Œé‚£ä¹ˆæˆ‘ä»¬æ ¹æ®<br>$$<br>AX_0+B\equiv X_1\pmod M<br>$$<br>å¯ä»¥å¾—åˆ°<br>$$<br>B\equiv X_1-AX_0 \pmod M<br>$$<br>è¿™æ ·é¢˜ç›®å°±å¾—å‡ºäº†è§£ã€‚</p><p>ä¸Šä¸€ä¸‹ç¬¬äºŒé—®çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">G</span>(<span class="hljs-params">d1,d2,m</span>):<br>    <span class="hljs-keyword">return</span> (d2)*inverse(d1,m)%m<br>m=<span class="hljs-number">17339855340627587175</span><br>x0=<span class="hljs-number">123</span><br>x1=<span class="hljs-number">11280784678567285991</span><br>x2=<span class="hljs-number">16229269394156588360</span><br>x3=<span class="hljs-number">12807800121938543462</span><br>detla1,detla2,detla3=x1-x0,x2-x1,x3-x2<br>a=G(detla1,detla2,m)<br>b=(x1-<span class="hljs-number">123</span>*a)%m<br><span class="hljs-built_in">print</span>(a,b)<br></code></pre></td></tr></table></figure><h4 id="Question-3"><a href="#Question-3" class="headerlink" title="Question 3"></a>Question 3</h4><p>ç¬¬ä¸‰é—®ï¼Œå·²çŸ¥$X_0$åˆ°$X_7$çš„å€¼ï¼Œè¦æ±‚å‡ºæ¨¡æ•°$M$ã€‚</p><p>æ ¹æ®æˆ‘ä»¬çŸ¥é“çš„$X_0$åˆ°$X_7$çš„é€’æ¨å¼ï¼Œæˆ‘ä»¬ä¾ç„¶æƒ³åˆ°äº†æ¶ˆå…ƒã€‚</p><p>æ ¹æ®ç¬¬äºŒé—®æˆ‘ä»¬å·²ç»è·å¾—çš„ä¸¤ä¸ªå¼å­ï¼š<br>$$<br>(X_2-X_1)(X_1-X_0)^{-1}\equiv A \pmod M<br>$$</p><p>$$<br>(X_3-X_2)(X_2-X_1)^{-1}\equiv A \pmod M<br>$$</p><p>è”ç«‹è¿™ä¸¤ä¸ªå¼å­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<br>$$<br>(X_2-X_1)(X_1-X_0)^{-1}\equiv(X_3-X_2)(X_2-X_1)^{-1} \pmod M<br>$$<br>å¹²è„†æŠŠåˆ†æ¯ä¹Ÿå»äº†å§<br>$$<br>(X_2-X_1)^2\equiv(X_3-X_2)(X_1-X_0) \pmod M<br>$$<br>ç„¶åæŠŠåŒä½™å·ä¹Ÿå»äº†å§ï¼ˆ<br>$$<br>(X_2-X_1)^2&#x3D;(X_3-X_2)(X_1-X_0)+k_2M<br>$$<br>æœ€åç§»é¡¹<br>$$<br>(X_2-X_1)^2-(X_3-X_2)(X_1-X_0)&#x3D;+k_2M<br>$$<br>åŒç†å¯å¾—ï¼š<br>$$<br>(X_3-X_2)^2-(X_4-X_3)(X_2-X_1)&#x3D;+k_3M<br>$$<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸€æ‰‹æ®µè·å¾—$k_2M,k_3M,k_4M,k_5M,k_6M$çš„å€¼ï¼Œç„¶åç›´æ¥æ±‚GCDå°±å¯ä»¥äº†ã€‚</p><p>ä¸Šä¸€ä¸‹ç¬¬ä¸‰é—®çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *i<br>x0=<span class="hljs-number">123</span><br>x1=<span class="hljs-number">9994867626161635096</span><br>x2=<span class="hljs-number">5753461374688204354</span><br>x3=<span class="hljs-number">11648048026234191592</span><br>x4=<span class="hljs-number">1202418284492042518</span><br>x5=<span class="hljs-number">10468479901118246086</span><br>x6=<span class="hljs-number">8754702082052904382</span><br>x7=<span class="hljs-number">4553263904866307968</span><br>detla1,detla2,detla3,detla4,detla5=x1-x0,x2-x1,x3-x2,x4-x3,x5-x4<br>detla6,detla7=x6-x5,x7-x6<br>P2=detla2**<span class="hljs-number">2</span>-detla3*detla1<br>P3=detla3**<span class="hljs-number">2</span>-detla4*detla2<br>P4=detla4**<span class="hljs-number">2</span>-detla5*detla3<br>P5=detla5**<span class="hljs-number">2</span>-detla6*detla4<br>P6=detla6**<span class="hljs-number">2</span>-detla7*detla5<br>P2,P3,P4,P5,P6=<span class="hljs-built_in">abs</span>(P2),<span class="hljs-built_in">abs</span>(P3),<span class="hljs-built_in">abs</span>(P4),<span class="hljs-built_in">abs</span>(P5),<span class="hljs-built_in">abs</span>(P6)<br>E=GCD(P2,P3)<br>E=GCD(E,P4)<br>E=GCD(E,P5)<br>E=GCD(E,P6)<br><span class="hljs-built_in">print</span>(E)<br></code></pre></td></tr></table></figure><h3 id="Step-3-å›é¡¾å¹¶å®Œå–„æ–¹æ¡ˆ"><a href="#Step-3-å›é¡¾å¹¶å®Œå–„æ–¹æ¡ˆ" class="headerlink" title="Step 3.å›é¡¾å¹¶å®Œå–„æ–¹æ¡ˆ"></a>Step 3.å›é¡¾å¹¶å®Œå–„æ–¹æ¡ˆ</h3><p>å†…æµ‹çš„æ—¶å€™ï¼Œè¿™ä¸‰ä¸ªä»£ç éƒ½èƒ½å¤Ÿå¾—å‡ºæ­£ç¡®ç­”æ¡ˆï¼Œä½†éƒ½æ˜¯æ¦‚ç‡æ€§æ­£ç¡®ï¼ˆä¹Ÿå°±æ˜¯æ€»æ˜¯ä¼šå‡ºé”™ï¼‰ï¼ŒåŸå› å¯èƒ½å¦‚ä¸‹ï¼š</p><p>ç¬¬ä¸€é—®çš„$M&gt;A$ä¸”$\gcd(A,M)\not &#x3D;1$çš„æ—¶å€™ï¼Œå¤§æ¦‚æœ‰$70\text{percent}$çš„æ¦‚ç‡ä¼šå‡ºç°ç¬¬ä¸€é—®çš„é”™è¯¯ã€‚å› ä¸ºä¸¤è¾¹çš„æ¨¡æ˜¯ä¸èƒ½æœˆçš„ï¼Œä¹‹å‰å°±æå‡ºè¿‡$2x\equiv2 \pmod 6$çš„è§£æ˜¯$x_1&#x3D;1$å’Œ$x_2&#x3D;4$ã€‚</p><p>ç¬¬äºŒé—®å¯èƒ½åŒæ—¶å‡ºç°$\gcd (X_1-X_0,M)\not &#x3D;1$å’Œ$\gcd (X_2-X_1,M)\not &#x3D;1$ï¼Œæ­¤æ—¶é€†å…ƒæ— æ³•æ±‚å‡ºï¼Œè§£é¢˜ä¼šéå¸¸éº»çƒ¦ã€‚</p><p>ç¬¬ä¸‰é—®å¯èƒ½ä¼šå‡ºç°$M$çš„æ¯”ç‰¹ä½é•¿$â‰¥65$çš„æƒ…å†µï¼Œå› ä¸ºæœ€åæ±‚$\gcd$çš„æ—¶å€™ï¼Œ$M$å‰é¢çš„ç³»æ•°æ²¡æœ‰æ¶ˆæˆ$1$ã€‚</p><p>æ€»ä¹‹ï¼Œè¿™äº›é—®é¢˜å¤„ç†èµ·æ¥ï¼Œä¼šéå¸¸éº»çƒ¦ï¼Œä½†åœ¨æ•°æ®æ¯”è¾ƒå¥½çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸‰ä¸ªåšæ³•éƒ½èƒ½åšå‡ºæ¥ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœæœ€åæä¸å‡ºæ¥ï¼Œé‚£å°±å¹²è„†é‡è¿ç®—äº†ã€‚æ¯”å¦‚è¯´ï¼Œåœ¨ç¬¬äºŒé—®$\gcd$å…¨éƒ¨ä¸ç­‰äº$1$çš„æ—¶å€™ç¨‹åºè‡ªåŠ¨<code>raise ValueError</code>ï¼Œç¬¬ä¸‰é—®è§£å‡ºçš„æ•°å­—æ¯”ç‰¹ä½é•¿äº$64$ä¹Ÿ<code>raise</code>ä¸€ä¸ª<code>ValueError</code>ã€‚ç¬¬ä¸‰é—®è§£å†³å‡ºæ¥åæŠŠæœåŠ¡å™¨çš„åé¦ˆå…¨ç›˜æ¥å—ï¼Œä¸€æ—¦å‡ºç°<code>fail</code>è‡ªåŠ¨é‡è¿ï¼Œå› æ­¤åªè¦æˆ‘ä»¬æœ€åæ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²çš„é•¿åº¦å¤§äº$5$ï¼Œå°±è¯´æ˜æˆ‘ä»¬è·å¾—äº†flagï¼Œç„¶åç›´æ¥è¾“å‡ºå°±è¡Œäº†ã€‚</p><p>ç”±äºæˆ‘ä»¬ä¸èƒ½é¢„ä¼°è¿™äº›æ¦‚ç‡ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—å¤šæ¬¡è¿æ¥ï¼ˆï¼Œè„šæœ¬å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s1</span>(<span class="hljs-params">a,m,x1,x2</span>):<br>    <span class="hljs-keyword">return</span> (x1-<span class="hljs-number">123</span>*a)%m<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s2</span>(<span class="hljs-params">m,x1,x2,x3</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">G</span>(<span class="hljs-params">d1,d2,m</span>):<br>        <span class="hljs-comment">#print(GCD(d1,m))</span><br>        <span class="hljs-keyword">assert</span> GCD(d1,m)==<span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> (d2)*inverse(d1,m)%m<br>    x0=<span class="hljs-number">123</span><br>    detla1,detla2,detla3=x1-x0,x2-x1,x3-x2<br>    <span class="hljs-keyword">try</span>:<br>        a=G(detla1,detla2,m)<br>        b=(x1-<span class="hljs-number">123</span>*a)%m<br>        <span class="hljs-comment">#print(a.bit_length(),b.bit_length())</span><br>        <span class="hljs-keyword">return</span>(a,b)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">try</span>:<br>            a=G(detla2,detla3,m)<br>            b=(x1-<span class="hljs-number">123</span>*a)%m<br>            <span class="hljs-comment">#print(a.bit_length(),b.bit_length())</span><br>            <span class="hljs-keyword">return</span>(a,b)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">raise</span> ValueError<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s3</span>(<span class="hljs-params">x1,x2,x3,x4,x5,x6,x7</span>):<br>    x0=<span class="hljs-number">123</span><br>    detla1,detla2,detla3,detla4,detla5=x1-x0,x2-x1,x3-x2,x4-x3,x5-x4<br>    detla6,detla7=x6-x5,x7-x6<br>    P2=detla2**<span class="hljs-number">2</span>-detla3*detla1<br>    P3=detla3**<span class="hljs-number">2</span>-detla4*detla2<br>    P4=detla4**<span class="hljs-number">2</span>-detla5*detla3<br>    P5=detla5**<span class="hljs-number">2</span>-detla6*detla4<br>    P6=detla6**<span class="hljs-number">2</span>-detla7*detla5<br>    P2,P3,P4,P5,P6=<span class="hljs-built_in">abs</span>(P2),<span class="hljs-built_in">abs</span>(P3),<span class="hljs-built_in">abs</span>(P4),<span class="hljs-built_in">abs</span>(P5),<span class="hljs-built_in">abs</span>(P6)<br>    E=GCD(P2,P3)<br>    E=GCD(E,P4)<br>    E=GCD(E,P5)<br>    E=GCD(E,P6)<br>    <span class="hljs-comment">#print(E.bit_length())</span><br>    <span class="hljs-keyword">if</span> E.bit_length()&gt;<span class="hljs-number">64</span>:<br>        <span class="hljs-keyword">raise</span> ValueError<br>    <span class="hljs-keyword">return</span> E<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getamin1</span>(<span class="hljs-params">s1</span>):<br>    arr,now,ind=[],<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s1:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">48</span>,<span class="hljs-number">58</span>):<br>            ind,now=<span class="hljs-number">1</span>,now*<span class="hljs-number">10</span>+<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">48</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> ind:<br>                arr.append(now)<br>                now,ind=<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(arr)==<span class="hljs-number">2</span><br>    <span class="hljs-keyword">return</span> arr[<span class="hljs-number">0</span>],arr[<span class="hljs-number">1</span>]<br><span class="hljs-comment">#---------------RUN BELOW-------------------#</span><br><span class="hljs-comment">#get 1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>    sh=remote(<span class="hljs-string">&quot;182.92.108.71&quot;</span>,<span class="hljs-number">30641</span>)<br>    so1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    x1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    x2=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    a,m=getamin1(so1)<br>    x1,x2=<span class="hljs-built_in">int</span>(x1),<span class="hljs-built_in">int</span>(x2)<br>    ans1=s1(a,m,x1,x2)<br>    <span class="hljs-built_in">print</span>(ans1.bit_length())<br>    sh.sendline(<span class="hljs-built_in">str</span>(ans1))<br>    <span class="hljs-comment">#get 2</span><br>    m=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    x1=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    x2=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    x3=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    a,b=s2(m,x1,x2,x3)<br>    sh.sendline(<span class="hljs-built_in">str</span>(a))<br>    sh.sendline(<span class="hljs-built_in">str</span>(b))<br>    <span class="hljs-comment">#get 3</span><br>    x1=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    x2=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    x3=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    x4=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    x5=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    x6=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    x7=<span class="hljs-built_in">int</span>(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>    ans=s3(x1,x2,x3,x4,x5,x6,x7)<br>    sh.sendline(<span class="hljs-built_in">str</span>(ans))<br>    final=sh.recvall()<br>    sh.close()<br>    <span class="hljs-keyword">return</span> final<br><span class="hljs-comment">#------------------MAIN BELOW------------------#</span><br>T,F=<span class="hljs-number">1</span>,<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(T)+<span class="hljs-string">&#x27;th time trying&#x27;</span>)<br>    F=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        F=run()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(F)&gt;<span class="hljs-number">6</span>:<br>        <span class="hljs-built_in">print</span>(F)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;with using&#x27;</span>+<span class="hljs-built_in">str</span>(T)+<span class="hljs-string">&#x27;times to get the flag&#x27;</span>)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        T+=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œæˆªå›¾ï¼Œè¿™é‡Œæ˜¯ç”¨äº†$24$æ¬¡ï¼Œå¤šæµ‹äº†å‡ æ¬¡ï¼Œæœ€å¥½çš„ä¸€æ¬¡é‡ç½®$3$æ¬¡è·å¾—flagï¼Œæœ€åçš„ä¸€æ¬¡é‡ç½®äº†$91$æ¬¡ã€‚</p><p><img src="/2021/02/28/HgameDiv3/1.jpg" alt="1"></p><h3 id="Step-4-Reference"><a href="#Step-4-Reference" class="headerlink" title="Step 4 Reference"></a>Step 4 Reference</h3><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆå‡ºé¢˜äººç”Ÿæˆæ¨¡æ•°çš„æ—¶å€™ä¸ä½¿ç”¨<code>getPrime(64)</code>è€Œæ˜¯ä½¿ç”¨<code>bytes_to_long(urandom(8))</code>ï¼Œæ˜¯å¤§Eäº†è¿˜æ˜¯å¦æœ‰æƒ³æ³•ï¼Œåªèƒ½åç­‰å®˜æ–¹çš„week4çš„wpäº†ã€‚è¿™è¯´æ˜è‡ªå·±è¿˜æ˜¯å¤ªèœäº†ï¼ˆ</p><p><strong>Update 2021.7.12</strong></p><p>å½“æ—¶æ‰“å®Œäº†ä¹‹åé—®äº†ä¸€ä¸‹ä½œè€…ã€‚<del>å®é™…ä¸Šæ˜¯æ‰“å®Œä¸ä¹…ï¼Œä½†4ä¸ªåŠæœˆåæ‰æƒ³èµ·æ¥Update</del>ï¼Œæ­¤å¤„å®é™…ä¸Šä½¿ç”¨çš„æ˜¯é‡å¤æ”»å‡»æ„è¯†ï¼Œå› ä¸ºæœ‰çš„æ—¶å€™ç”±äºå„ç§æ•°æ®çš„åŸå› ï¼Œè™½ç„¶ç®—æ³•æ˜¯å¯¹çš„ï¼Œä½†æœ‰å¯èƒ½ä¹Ÿåšä¸å‡ºæœ€ç»ˆç»“æœã€‚å› æ­¤é‡åˆ°è¿™ç§æƒ…å†µçš„æ—¶å€™å¯ä»¥å¤šè¯•å‡ æ¬¡ï¼Œå°±å¯ä»¥å¾—å‡ºæ­£ç¡®ç­”æ¡ˆ</p><h2 id="5-å¤ºå®å¤§å†’é™©2"><a href="#5-å¤ºå®å¤§å†’é™©2" class="headerlink" title="5.å¤ºå®å¤§å†’é™©2"></a>5.å¤ºå®å¤§å†’é™©2</h2><p>çœ‹ä¸€ä¸‹é¢˜ç›®ï¼Œæ˜¯lfsræ±‚ç§å­å’Œéšæœºæ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LXFIQNN</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, init, mask, length</span>):<br>        <span class="hljs-variable language_">self</span>.init = init<br>        <span class="hljs-variable language_">self</span>.mask = mask<br>        <span class="hljs-variable language_">self</span>.lengthmask = <span class="hljs-number">2</span>**(length+<span class="hljs-number">1</span>)-<span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        nextdata = (<span class="hljs-variable language_">self</span>.init &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-variable language_">self</span>.lengthmask <br>        i = <span class="hljs-variable language_">self</span>.init &amp; <span class="hljs-variable language_">self</span>.mask &amp; <span class="hljs-variable language_">self</span>.lengthmask <br>        output = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> i != <span class="hljs-number">0</span>:<br>            output ^= (i &amp; <span class="hljs-number">1</span>)<br>            i = i &gt;&gt; <span class="hljs-number">1</span><br>        nextdata ^= output<br>        <span class="hljs-variable language_">self</span>.init = nextdata<br>        <span class="hljs-keyword">return</span> output<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">random</span>(<span class="hljs-params">self, nbit</span>):<br>        output = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbit):<br>            output &lt;&lt;= <span class="hljs-number">1</span><br>            output |= <span class="hljs-variable language_">self</span>.<span class="hljs-built_in">next</span>()<br>        <span class="hljs-keyword">return</span> output<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> init, FLAG<br><span class="hljs-string">&quot;&quot;&quot;secret.py</span><br><span class="hljs-string">import os</span><br><span class="hljs-string">init = int.from_bytes(os.urandom(5), &#x27;big&#x27;)</span><br><span class="hljs-string">FLAG = &#x27;hgame&#123;xxx&#125;&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>prng = LXFIQNN(init, <span class="hljs-number">0b1011001010001010000100001000111011110101</span>, <span class="hljs-number">40</span>)<br>score = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;round <span class="hljs-subst">&#123;r&#125;</span> :: score <span class="hljs-subst">&#123;score&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        guess = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;guess: &quot;</span>))<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">break</span><br>    secret = prng.random(<span class="hljs-number">4</span>)<br>    <span class="hljs-keyword">if</span> secret == guess:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Right&quot;</span>)<br>        score += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Wrong, the secret is <span class="hljs-subst">&#123;secret&#125;</span>&quot;</span>)<br><span class="hljs-keyword">if</span> score &gt;= <span class="hljs-number">80</span>:<br>    <span class="hljs-built_in">print</span>(FLAG)<br></code></pre></td></tr></table></figure><p>CTFWIKIä¸Šè¯´è¿‡ï¼Œä¸€ä¸ª$n$ä½çš„lfsrï¼Œåœ¨çŸ¥é“æ©ç maskçš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦çŸ¥é“$n$ä½çš„è¾“å‡ºï¼Œå°±å¯ä»¥æ¢å¤ç§å­å€¼ï¼Œè€Œå¦‚æœåœ¨è¿maskä¹Ÿä¸çŸ¥é“çš„æƒ…å†µä¸‹ï¼Œå¦‚æœçŸ¥é“äº†$2n$ä½çš„è¾“å‡ºï¼Œé‚£ä¹ˆå¯ä»¥å…ˆé€šè¿‡çŸ©é˜µè¿ç®—å¾—åˆ°maskçš„å€¼ï¼Œç„¶åæ±‚ä¸ªé€†çŸ©é˜µå°±å¯ä»¥å¾—åˆ°ç§å­çš„å€¼äº†ã€‚</p><p>å…·ä½“å†…å®¹è§è‡ªå·±åšå®¢çš„**Lfsr Notes[2021.1.27]**ç›¸å…³å†…å®¹ï¼Œä¸‹é¢ç›´æ¥ä¸Šä¸€ä¸‹åšé¢˜è„šæœ¬ã€‚ç›¸å…³å†…å®¹çš„æ„é€ å¯ä»¥ç›´æ¥æ¨¡ä»¿é¢˜ç›®ç»™å‡ºçš„æ–¹æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LXFIQNN</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, init, mask, length</span>):<br>        <span class="hljs-variable language_">self</span>.init = init<br>        <span class="hljs-variable language_">self</span>.mask = mask<br>        <span class="hljs-variable language_">self</span>.lengthmask = <span class="hljs-number">2</span>**(length+<span class="hljs-number">1</span>)-<span class="hljs-number">1</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        nextdata = (<span class="hljs-variable language_">self</span>.init &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-variable language_">self</span>.lengthmask <br>        i = <span class="hljs-variable language_">self</span>.init &amp; <span class="hljs-variable language_">self</span>.mask &amp; <span class="hljs-variable language_">self</span>.lengthmask <br>        output = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> i != <span class="hljs-number">0</span>:<br>            output ^= (i &amp; <span class="hljs-number">1</span>)<br>            i = i &gt;&gt; <span class="hljs-number">1</span><br>        nextdata ^= output<br>        <span class="hljs-variable language_">self</span>.init = nextdata<br>        <span class="hljs-keyword">return</span> output<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">random</span>(<span class="hljs-params">self, nbit</span>):<br>        output = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbit):<br>            output &lt;&lt;= <span class="hljs-number">1</span><br>            output |= <span class="hljs-variable language_">self</span>.<span class="hljs-built_in">next</span>()<br>        <span class="hljs-keyword">return</span> output<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padbin</span>(<span class="hljs-params">x,b</span>):<br>    s=<span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:]<br>    s=<span class="hljs-string">&#x27;0&#x27;</span>*(b-<span class="hljs-built_in">len</span>(s))+s<br>    <span class="hljs-keyword">return</span> s<br><span class="hljs-comment">#------MAIN---BELOW------#</span><br>sh=remote(<span class="hljs-string">&quot;182.92.108.71&quot;</span>,<span class="hljs-number">30607</span>)<br>arr=[]<br>lj=[<span class="hljs-number">5</span>,<span class="hljs-number">22</span>,<span class="hljs-number">23</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    sh.recvuntil(<span class="hljs-string">&quot;guess: &quot;</span>)<br>    sh.sendline(<span class="hljs-string">&#x27;0&#x27;</span>)<br>    judge=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(judge) <span class="hljs-keyword">in</span> lj<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(judge)==<span class="hljs-number">5</span>:<br>        arr.append(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">else</span>:<br>        arr.append(<span class="hljs-built_in">int</span>(judge[<span class="hljs-number">21</span>:]))<br><span class="hljs-built_in">print</span>(arr)<br>mask = <span class="hljs-number">0xb28a108ef5</span><br>N = <span class="hljs-number">40</span><br>key = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> arr:<br>    key+=padbin(i,<span class="hljs-number">4</span>)<br>idx = <span class="hljs-number">0</span><br>ans = <span class="hljs-string">&quot;&quot;</span><br>key = key[<span class="hljs-number">39</span>] + key[:<span class="hljs-number">40</span>]<br><span class="hljs-keyword">while</span> idx &lt; <span class="hljs-number">40</span>:<br>    tmp = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>):<br>        <span class="hljs-keyword">if</span> mask &gt;&gt; i &amp; <span class="hljs-number">1</span>:<br>            tmp ^= <span class="hljs-built_in">int</span>(key[<span class="hljs-number">39</span> - i])<br>    ans = <span class="hljs-built_in">str</span>(tmp) + ans<br>    idx += <span class="hljs-number">1</span><br>    key = key[<span class="hljs-number">39</span>] + <span class="hljs-built_in">str</span>(tmp) + key[<span class="hljs-number">1</span>:<span class="hljs-number">39</span>]<br>num = <span class="hljs-built_in">int</span>(ans, <span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(num))<br>prng=LXFIQNN(num, mask, <span class="hljs-number">40</span>)<br>anses=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">300</span>):<br>    anses.append(prng.random(<span class="hljs-number">4</span>))<br><span class="hljs-keyword">assert</span> anses[<span class="hljs-number">0</span>:<span class="hljs-number">10</span>]==arr<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>,<span class="hljs-number">100</span>):<br>    tr1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    <span class="hljs-built_in">print</span>(str1)<br>    sh.recvuntil(<span class="hljs-string">&quot;guess: &quot;</span>)<br>    sh.sendline(<span class="hljs-built_in">str</span>(anses[i]))<br>    str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>    <span class="hljs-built_in">print</span>(str1)<br>flag=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#hgame&#123;lfsr_121a111y^use-in&amp;crypto&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Explore SPN</title>
    <link href="/2021/02/26/Explore-SPN/"/>
    <url>/2021/02/26/Explore-SPN/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ SPNåŠ å¯†çš„ç¬”è®°"><a href="#huangx607087å­¦ä¹ SPNåŠ å¯†çš„ç¬”è®°" class="headerlink" title="huangx607087å­¦ä¹ SPNåŠ å¯†çš„ç¬”è®°"></a>huangx607087å­¦ä¹ SPNåŠ å¯†çš„ç¬”è®°</h1><h2 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0.ç®€ä»‹"></a>0.ç®€ä»‹</h2><p>BUUCTFä¸Šåšäº†ä¸€é“SPNçš„é¢˜ç›®ï¼Œ<del>æŒºå¤æ‚çš„ï¼Œå¾—è®¤çœŸåšäº¿ç‚¹ç‚¹ç¬”è®°</del>ï¼Œwpä¸Šè®²çš„éå¸¸ç®€å•ï¼Œè‡ªå·±æ‘¸äº†åŠå¤©æ‰åšå‡ºæ¥ã€‚</p><h2 id="1-ä»€ä¹ˆæ˜¯SPN"><a href="#1-ä»€ä¹ˆæ˜¯SPN" class="headerlink" title="1.ä»€ä¹ˆæ˜¯SPN"></a>1.ä»€ä¹ˆæ˜¯SPN</h2><p>SPNåŠ å¯†æ˜¯åˆ†ç»„å¯†ç çš„ä¸€ç§ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ª$S$ç›’å’Œä¸€ä¸ª$P$ç›’ï¼Œ$S$ç›’çš„ä½œç”¨æ˜¯å°†æŸä¸ªæ•°å¯¹åº”åœ°å˜æˆå¦ä¸€ä¸ªæ•°ï¼Œè€Œ$P$ç›’çš„ä½œç”¨æ˜¯ç½®æ¢æ¯”ç‰¹ä½ã€‚å…¶è‹±æ–‡å…¨ç§°å«Substitution-Permutation Networkï¼Œç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯ä»£æ¢-ç½®æ¢ç½‘ç»œã€‚</p><p>SPNåŠ å¯†ç½‘ç»œä¸­å¤§æ¦‚åˆ†ä¸ºè¿™ä¸‰ä¸ªè¿‡ç¨‹ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œå‡†å¤‡è¿™ä¸€æ¬¡åŠ å¯†çš„å¯†é’¥$k$ï¼Œå°†è¾“å…¥çš„æ˜æ–‡ä¸$k$å¼‚æˆ–ã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œå°†ç¬¬ä¸€æ­¥å¾—åˆ°çš„æ‰€æœ‰çš„ç»“æœé€šè¿‡$S$ç›’ï¼Œè¿›è¡Œæ•°å­—çš„ä»£æ¢ã€‚</p><p>ç¬¬ä¸‰æ­¥ï¼Œå¯¹å·²çŸ¥çš„æ¯”ç‰¹ä½è¿›è¡Œä¿®æ”¹ä½ç½®ï¼Œä¸ä¿®æ”¹å…¶å€¼çš„ç½®æ¢ã€‚</p><p>å› æ­¤æ ¹æ®ä¸Šé¢çš„è§‚å¯Ÿï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼šåªæœ‰$S$ç›’çš„ä»£æ¢æ˜¯ä¸€ä¸ªéçº¿æ€§çš„è¿‡ç¨‹ï¼Œä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆè§„å¾‹ï¼Œå…¶ä»–çš„æ­¥éª¤éƒ½æ˜¯å¯é€†çš„ã€‚</p><p>ä¾‹å¦‚ï¼šå·²çŸ¥ä¸€ä¸ªSPNçš„$S$ç›’å’Œ$P$ç›’å¦‚ä¸‹ï¼š</p><table><thead><tr><th>$x$</th><th>$0$</th><th>$1$</th><th>$2$</th><th>$3$</th><th>$4$</th><th>$5$</th><th>$6$</th><th>$7$</th><th>$8$</th><th>$9$</th><th>$10$</th><th>$11$</th><th>$12$</th><th>$13$</th><th>$14$</th><th>$15$</th></tr></thead><tbody><tr><td>$S(x)$</td><td>$6$</td><td>$14$</td><td>$5$</td><td>$12$</td><td>$1$</td><td>$7$</td><td>$11$</td><td>$2$</td><td>$0$</td><td>$4$</td><td>$15$</td><td>$8$</td><td>$13$</td><td>$10$</td><td>$3$</td><td>$9$</td></tr><tr><td>$P(x)$</td><td>$1$</td><td>$3$</td><td>$0$</td><td>$5$</td><td>$6$</td><td>$7$</td><td>$2$</td><td>$4$</td><td>&#x2F;</td><td>&#x2F;</td><td>&#x2F;</td><td>&#x2F;</td><td>&#x2F;</td><td>&#x2F;</td><td>&#x2F;</td><td>&#x2F;</td></tr></tbody></table><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ª$S$ç›’ä¸€ä¸ªå•ä½æ˜¯$8$ä¸ªæ¯”ç‰¹å€¼ï¼Œå…¶ä¸­æ¯$4$æ¯”ç‰¹è¿›è¡Œä¸€æ¬¡ç½®æ¢ã€‚</p><p>å½“æ•°å­—$186(11,10)$å…ˆé€šè¿‡$S$ç›’å†é€šè¿‡$P$ç›’æ—¶ï¼Œå˜æ¢æ˜¯è¿™æ ·çš„ï¼šé¦–å…ˆï¼Œå…ˆé€šè¿‡$S$ç›’ç½®æ¢ï¼Œ$11$å˜æˆ$8$ï¼Œ$10$å˜æˆ$15$ã€‚æ•°å­—çš„å€¼ä»$186(\text{BAH})$æ”¹ä¸ºäº†$143(\text{8FH})$ã€‚å…¶æ¯”ç‰¹ä¸º$10001111\text{B}$ã€‚ç„¶åè¿›è¡Œç½®æ¢ï¼šé¦–ä½(ä¸‹æ ‡$0$ï¼‰çš„$1$è¢«æ¢åˆ°ç¬¬ä¸‰ä½(ä¸‹æ ‡$1$ï¼‰,ä»¥æ­¤ç±»æ¨ï¼Œæœ€ç»ˆæ•°å­—å˜æˆäº†$01101011\text{B}$ä¹Ÿå°±æ˜¯$107(\text{6BH})$ã€‚</p><h2 id="2-å¯¹éçº¿æ€§Sç›’çš„åˆ†æâ€”â€”çº¿æ€§å¤„ç†"><a href="#2-å¯¹éçº¿æ€§Sç›’çš„åˆ†æâ€”â€”çº¿æ€§å¤„ç†" class="headerlink" title="2.å¯¹éçº¿æ€§Sç›’çš„åˆ†æâ€”â€”çº¿æ€§å¤„ç†"></a>2.å¯¹éçº¿æ€§Sç›’çš„åˆ†æâ€”â€”çº¿æ€§å¤„ç†</h2><p>æ‰€è°“çº¿æ€§åˆ†æï¼Œå°±æ˜¯å¯»æ‰¾ä¸€ä¸ªç»™å®šçš„å¯†ç ç³»ç»Ÿä¸‹ï¼Œå…·æœ‰å¦‚ä¸‹çš„çº¿æ€§è¡¨è¾¾å¼ï¼Œå…¶ä¸­æ‰€æœ‰çš„å°å†™å­—æ¯å–å€¼éƒ½åœ¨$0,1$å†…ã€‚</p><p>$$<br>P[p_1,p_2,â€¦,p_n] \text{ xor } C[c_1,c_2,â€¦,c_n]&#x3D;K[k_1,k_2,â€¦,k_n]<br>$$<br>å› æ­¤ï¼Œçº¿æ€§åˆ†æçš„åŸºæœ¬æ€æƒ³å°±æ˜¯é€šè¿‡å¯»æ‰¾ä¸€ä¸ªç»™å®šå¯†ç ç®—æ³•æœ‰æ•ˆçš„çº¿æ€§è¿‘ä¼¼è¡¨è¾¾å¼æ¥ç ´è¯‘å¯†ç ç³»ç»Ÿã€‚å› ä¸ºæ¯ä¸ªå¯†ç ç³»ç»Ÿå‡ä¸ºéçº¿æ€§ç³»ç»Ÿï¼Œå› æ­¤åªèƒ½å¯»æ‰¾çº¿æ€§è¿‘ä¼¼çš„è¡¨è¾¾å¼ã€‚</p><p>å…¶ä¸­ï¼Œå¯¹äºä¸€ä¸ªéšæœºç»™å®šçš„æ˜æ–‡$P$å’Œç›¸å¯¹åº”çš„å¯†æ–‡$C$ï¼Œä¸Šé¢çš„ç­‰å¼æˆç«‹çš„æ¦‚ç‡ä¸ç­‰äº$0.5$ã€‚<strong>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼šæ„é€ ä¸€ä¸ªå…³äºæ˜æ–‡å’Œå€’æ•°ç¬¬äºŒè½®è¾“å…¥çš„çº¿æ€§è¡¨è¾¾å¼ï¼Œå°±æœ‰å¯èƒ½ä¼šä»˜å‡ºæœ€åä¸€è½®åŠ å¯†ä½¿ç”¨çš„å­å¯†é’¥çš„ä¸€ä¸ªå­é›†ï¼Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚</strong></p><p>å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬å‘å¯¹ä¸€ä¸ª$S$ç›’è¿›è¡Œçº¿æ€§å¤„ç†çš„æ—¶å€™ï¼Œå°±è¦è€ƒè™‘è€ƒè™‘å…¶æ˜¯å¦å­˜åœ¨çº¿æ€§ä¼˜åŠ¿ï¼Œä»¥åŠå¦‚ä½•æ±‚å•è½®å’Œå¤šè½®çš„çº¿æ€§ä¼˜åŠ¿ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®¾$e&#x3D;p-0.5$ä¸ºåå·®å€¼ï¼Œå› æ­¤ç­‰å¼çš„æœ‰æ•ˆæ€§å¯ä»¥ç”¨$|\delta|$æ¥è¡¡é‡ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å¼•å…¥å †ç§¯å¼•ç†ï¼Œè¡¨è¾¾å¼å¦‚ä¸‹ï¼Œå…¶ä¸­æ‰€æœ‰çš„$x$å–å€¼èŒƒå›´å‡ä¸º$0,1$ã€‚<br>$$<br>Pr(\sum_{i&#x3D;1}^n x_i \equiv 0 \pmod 2\text{ }) &#x3D;0.5+2^{n-1}\prod_{i&#x3D;1}^n\delta_i<br>$$<br>å¾ˆæ˜¾ç„¶ï¼Œå¦‚æœæŸä¸€ä¸ª$\delta$å€¼ä¸º$0$ï¼Œé‚£ä¹ˆæ•´ä¸ªç®—å¼çš„$\delta$å€¼ä¹Ÿä¸º$0$ã€‚</p><p>å› æ­¤ï¼Œåˆ©ç”¨å †ç§¯å¼•ç†ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¯è½®å˜æ¢ä¸­åå·®æœ€å¤§çš„çº¿æ€§é€¼è¿‘å¼è¿›è¡Œç»„åˆã€‚è€Œç»„åˆåçš„çº¿æ€§é€¼è¿‘å¼ä¹Ÿä¼šæœ‰æœ€å¤§çš„åå·®å€¼ã€‚</p><p>è€Œçº¿æ€§ç»„åˆä½¿ç”¨çš„å¼å­åˆ™ä¸ºï¼Œå…¶ä¸­$x$å€¼ä¸ºé€šè¿‡$S$ç›’çš„è¾“å…¥å€¼<br>$$<br>f\equiv \sum_{i&#x3D;1}^n a_ix_i \pmod 2<br>$$<br>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰¾å‡º$S$ç›’çš„è¾“å‡ºå€¼$y$è¿›è¡Œä¸€æ¬¡çº¿æ€§ç»„åˆã€‚<br>$$<br>g\equiv \sum_{i&#x3D;1}^n b_iy_i \pmod 2<br>$$<br>æœ€åè®¡ç®—ä¸€ä¸‹$f+g \equiv 0 \pmod 2$çš„æ¦‚ç‡ï¼Œå¹¶ä¸$0.5$è¿›è¡Œæ¯”è¾ƒï¼Œåå·®è¶Šå¤§è¶Šå¥½ã€‚</p><p>ä»¥æˆ‘ä»¬ä¸Šé¢çš„é‚£ä¸ªä¾‹å­ä¸ºä¾‹ï¼Œå‡å¦‚æˆ‘ä»¬å†³å®šä½¿ç”¨çš„ç»„åˆè¡¨è¾¾å¼ä¸º$f\equiv 1x_1+1x_2+1x_3+1x_4\pmod 2$ï¼Œ$g \equiv 0y_1+1y_2+0y_3+0y_4$ï¼Œæˆ‘ä»¬é€šè¿‡æšä¸¾$0$åˆ°$15$çš„æ¯ä¸ªå€¼å¯ä»¥æ±‚å‡º$f+g\equiv 0 \pmod 2$çš„æƒ…å†µæœ‰$10$ç§ï¼Œæ¦‚ç‡$0.625$ï¼Œåå·®$\delta&#x3D;0.625-0.5&#x3D;0.125&#x3D;12.5\text{percent}$ã€‚ä¸ºäº†èƒ½å¤Ÿç»™å‡ºä¸€ä¸ªç¬¦å·ï¼Œæˆ‘ä»¬ç›´æ¥ç»„åˆ$f$çš„æ‰€æœ‰ç³»æ•°ä¸º$1111\text{B}&#x3D;7$ï¼Œå’Œ$g$çš„ç³»æ•°$0100\text B&#x3D;4$ï¼Œè®°ä½œ$\delta_{(7,4)}&#x3D;0.125$ã€‚</p><p>å¦‚æœæˆ‘ä»¬å¯¹æ‰€æœ‰çš„å¯èƒ½æ€§éƒ½æšä¸¾ä¸€æ¬¡ï¼Œå¯ä»¥å¾—åˆ°è¿™æ ·ä¸€å¼ è¡¨ï¼Œå…¶ä¸­$i$å¾ªç¯ç”¨äºæšä¸¾è¾“å…¥æ•°å­—ï¼Œ$j$å¾ªç¯ç”¨äºæšä¸¾è¾“å…¥çš„çº¿æ€§ç»„åˆçš„ç³»æ•°ï¼Œ$k$å¾ªç¯ç”¨äºæšä¸¾è¾“å‡ºçš„çº¿æ€§ç»„åˆçš„ç³»æ•°ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦å¼€ä¸€ä¸ªäºŒç»´è®¡æ•°æ•°ç»„å°±å¯ä»¥äº†ã€‚æœ€åè¿™ä¸ªæ•°ç»„ä¸­çš„$256$ä¸ªæ•°å€¼æ„æˆäº†ä¸€ä¸ªçº¿æ€§é€¼è¿‘è¡¨ã€‚è€Œè¿™ä¸ªçº¿æ€§é€¼è¿‘è¡¨çš„ä¸å‡åŒ€æ€§ï¼Œä¹Ÿå°±æä¾›äº†çº¿æ€§åˆ†æçš„å¯èƒ½æ€§ï¼Œå› æ­¤æˆ‘ä»¬åªè¦é€‰æ‹©å‡ºæœ€ä½³çº¿æ€§é€¼è¿‘å¼æ¥è¿›è¡Œçº¿æ€§æ”»å‡»ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> s[<span class="hljs-number">16</span>]=&#123;<span class="hljs-number">6</span>,<span class="hljs-number">14</span>,<span class="hljs-number">5</span>,<span class="hljs-number">12</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">15</span>,<span class="hljs-number">8</span>,<span class="hljs-number">13</span>,<span class="hljs-number">10</span>,<span class="hljs-number">3</span>,<span class="hljs-number">9</span>&#125;;<br><span class="hljs-type">double</span> p[<span class="hljs-number">16</span>][<span class="hljs-number">16</span>];<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">sumbitpros</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> c=a&amp;x,d=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span>(c)<br>&#123;<br>d+=c&amp;<span class="hljs-number">1</span>;<br>c&gt;&gt;=<span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-keyword">return</span> d&amp;<span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j,k;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;=<span class="hljs-number">15</span>;i++)<br>&#123;<br><span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>;j&lt;=<span class="hljs-number">15</span>;j++)<br><span class="hljs-keyword">for</span>(k=<span class="hljs-number">0</span>;k&lt;=<span class="hljs-number">15</span>;k++)<br>&#123;<br><span class="hljs-type">int</span> a=<span class="hljs-built_in">sumbitpros</span>(j,i),b=<span class="hljs-built_in">sumbitpros</span>(k,s[i]);<br>p[j][k]+=(a==b);<br>&#125;<br>&#125;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;=<span class="hljs-number">15</span>;i++)<br>&#123;<br><span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>;j&lt;=<span class="hljs-number">15</span>;j++)<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.2lf &quot;</span>,<span class="hljs-built_in">abs</span>(p[i][j]<span class="hljs-number">-8</span>)/<span class="hljs-number">16</span>);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼Œçº¢è‰²æ•°å­—æ ‡å‡ºäº†æ¯ä¸€è¡Œå‡ºç°å¾—æœ€å¤§å€¼ã€‚</p><p><img src="/2021/02/26/Explore-SPN/1.png" alt="1"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªç³»æ•°æ•°ç»„<code>[0,1,11,2,1,5,5,3,11,12,6,7,12,8,2,4]</code>ã€‚</p><p>å½’çº³ä¸€ä¸‹çº¿æ€§æ”»å‡»çš„è¿‡ç¨‹ä¸º:å‡å¦‚æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸€ä¸ªæ˜æ–‡æ¯”ç‰¹å­é›†å’Œæœ€åä¸€è½®å³å°†è¿›è¡Œä»£æ¢çš„è¾“å…¥çŠ¶æ€æ¯”ç‰¹å­é›†ä¹‹é—´æ‰¾åˆ°ä¸€ä¸ªæ¦‚ç‡çº¿æ€§å…³ç³»ï¼Œæ¢å¥è¯è¯´ï¼Œå³å­˜åœ¨ä¸€ä¸ªæ¯”ç‰¹å­é›†ä½¿å¾—å…¶ä¸­å…ƒç´ çš„å¼‚æˆ–è¡¨ç°å‡ºééšæœºçš„åˆ†å¸ƒ(å³æ˜æ–‡å’Œæœ€åä¸€è½®è¾“å…¥çš„æœ€ä½³çº¿æ€§é€¼è¿‘<br>å¼)ï¼Œå†å‡è®¾ä¸€ä¸ªæ”»å‡»è€…æ‹¥æœ‰å¤§é‡çš„ç”¨åŒä¸€æœªçŸ¥å¯†é’¥åŠ å¯†çš„æ˜æ–‡å¯†æ–‡å¯¹.</p><p>å¯¹æ¯ä¸€ä¸ªæ˜æ–‡å¯†æ–‡å¯¹ï¼Œå°†ç”¨æ‰€æœ‰çš„(æœ€åä¸€è½®)å€™é€‰å¯†é’¥æ¥å¯¹æœ€åä¸€è½®è§£å¯†å¯†æ–‡.å¯¹æ¯ä¸€ä¸ªå€™é€‰å¯†é’¥ï¼Œè®¡ç®—åŒ…å«åœ¨çº¿æ€§å…³ç³»å¼ä¸­çš„ç›¸å…³æ¯”ç‰¹çš„å¼‚æˆ–çš„å€¼ï¼Œç„¶åç¡®å®šä¸Šè¿°çš„çº¿æ€§å…³ç³»å¼æ˜¯å¦æˆç«‹ã€‚å¦‚æœæˆç«‹ï¼Œå°±åœ¨å¯¹åº”äºç‰¹å®šå€™é€‰å¯†é’¥çš„è®¡æ•°å™¨ä¸ŠåŠ $1$.</p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹çš„æœ€åï¼Œæˆ‘ä»¬å¸Œæœ›è®¡æ•°é¢‘ç‡ç¦»æ˜å¯†æ–‡å¯¹æ•°çš„ä¸€åŠæœ€è¿œçš„å€™é€‰å¯†é’¥å«æœ‰é‚£äº›å¯†é’¥æ¯”ç‰¹çš„æ­£ç¡®å€¼.<br>å¯ä»¥çœ‹åˆ°ï¼Œçº¿æ€§æ”»å‡»æˆåŠŸåªä¾èµ–äºæ˜æ–‡çš„ä¸ªæ•°$N$å’Œ$|p- 0.5|$, å¹¶ä¸”éšç€$N$æˆ–$|p -0.5|$çš„å¢åŠ è€Œå¢åŠ ã€‚</p><p>éœ€è¦è¯´æ˜çš„æ˜¯:åœ¨é€‰æ‹©ä»ä¸€è½®åˆ°å¤šè½®çº¿æ€§é€¼è¿‘å¼æ—¶ï¼Œé™¤äº†è€ƒè™‘æœ‰æ•ˆæ€§å¤–ï¼Œè¿˜éœ€ä½¿å¾—å¾—åˆ°çš„æœ€åå…³ç³»å¼ä¸­ï¼ŒåªåŒ…å«æ˜æ–‡ã€å¯†æ–‡å’Œæœ€åä¸€è½®çš„å¯†é’¥æ¯”ç‰¹ï¼Œæ‰èƒ½å®æ–½æœ‰æ•ˆæ”»å‡»ã€‚</p><h2 id="3-CTFå®æˆ˜â€”â€”ä»¥-NPUCTF2020-EzSPNä¸ºä¾‹"><a href="#3-CTFå®æˆ˜â€”â€”ä»¥-NPUCTF2020-EzSPNä¸ºä¾‹" class="headerlink" title="3. CTFå®æˆ˜â€”â€”ä»¥[NPUCTF2020]EzSPNä¸ºä¾‹"></a>3. CTFå®æˆ˜â€”â€”ä»¥[NPUCTF2020]EzSPNä¸ºä¾‹</h2><h3 id="Step-1-é˜…è¯»ä»£ç çœ‹æ‡‚é¢˜ç›®"><a href="#Step-1-é˜…è¯»ä»£ç çœ‹æ‡‚é¢˜ç›®" class="headerlink" title="Step 1 é˜…è¯»ä»£ç çœ‹æ‡‚é¢˜ç›®"></a>Step 1 é˜…è¯»ä»£ç çœ‹æ‡‚é¢˜ç›®</h3><p>æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåŠ å¯†ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> hexlify, unhexlify<br><span class="hljs-keyword">import</span> Crypto.Random.random <span class="hljs-keyword">as</span> random<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>coef = [<span class="hljs-number">239</span>, <span class="hljs-number">163</span>, <span class="hljs-number">147</span>, <span class="hljs-number">71</span>, <span class="hljs-number">163</span>, <span class="hljs-number">75</span>, <span class="hljs-number">219</span>, <span class="hljs-number">73</span>]<br>sbox = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>random.shuffle(sbox)<br>sboxi = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    sboxi.append(sbox.index(i))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">doxor</span>(<span class="hljs-params">l1,l2</span>):<br>    <span class="hljs-keyword">return</span> [x[<span class="hljs-number">0</span>]^x[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(l1,l2)]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trans</span>(<span class="hljs-params">blk</span>):<br>    res = []<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>):<br>        bits = [<span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:].rjust(<span class="hljs-number">8</span>,<span class="hljs-string">&#x27;0&#x27;</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> blk[k:k+<span class="hljs-number">8</span>]]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            res.append(<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([x[(i+<span class="hljs-number">1</span>) % <span class="hljs-number">8</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> bits]),<span class="hljs-number">2</span>))<br>        res[k:k+<span class="hljs-number">8</span>] = [(coef[i] * res[k+i]) % <span class="hljs-number">256</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>    <span class="hljs-keyword">return</span> res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_block</span>(<span class="hljs-params">pt, ks</span>):<br>    cur = doxor(pt, ks[:<span class="hljs-number">8</span>])<br>    cur = [sbox[x] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cur]<br>    cur = trans(cur)<br>    cur = [sboxi[x] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cur]<br>    cur = doxor(cur, ks[<span class="hljs-number">8</span>:])<br>    <span class="hljs-keyword">return</span> cur<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">pt, k</span>):<br>    x = <span class="hljs-number">0</span> <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(pt)%<span class="hljs-number">8</span>==<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> (<span class="hljs-number">8</span>-<span class="hljs-built_in">len</span>(pt)%<span class="hljs-number">8</span>)<br>    pt += [x]*x<br>    ct = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(pt), <span class="hljs-number">8</span>):<br>        res = encrypt_block([x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> pt[i:i+<span class="hljs-number">8</span>]], k)<br>        ct += <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-string">&quot;&#123;:02x&#125;&quot;</span>.<span class="hljs-built_in">format</span>(xx) <span class="hljs-keyword">for</span> xx <span class="hljs-keyword">in</span> res])<br>    <span class="hljs-keyword">return</span> ct<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">doout</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(x) % <span class="hljs-number">16</span>:<br>        x = (<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(x) % <span class="hljs-number">16</span>) * <span class="hljs-string">&quot;0&quot;</span> + x<br>    <span class="hljs-keyword">return</span> x<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">doin</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(unhexlify(x))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genkeys</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(os.urandom(<span class="hljs-number">2</span>*<span class="hljs-number">8</span>))<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-built_in">print</span>(sbox)<br>    key = genkeys()<br>    ct = encrypt(flag, key)<br>    <span class="hljs-built_in">print</span>(ct)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        pt = doin(<span class="hljs-built_in">input</span>())<br>        <span class="hljs-built_in">print</span>(doout(encrypt(pt, key)))<br></code></pre></td></tr></table></figure><p>ç®€å•åˆ†æä¸€ä¸‹ä»£ç å°±å¯ä»¥çŸ¥é“ï¼Œæ¯$8$ä¸ªå­—ç¬¦ä¸ºä¸€ç»„ï¼Œå…±$64$ä¸ªæ¯”ç‰¹å€¼è¿›è¡ŒåŠ å¯†ã€‚å…¶ä¸­$S$ç›’çš„å®¹é‡æ˜¯$8$æ¯”ç‰¹ï¼ŒåŒ…å«ä¸€ä¸ªå­—èŠ‚ï¼Œé¢˜ç›®ä¸€å¼€å§‹ç»™å‡ºäº†$S$ç›’å’Œflagçš„å¯†æ–‡ã€‚ä»£æ¢æœ‰äº†ï¼Œä¸è¿‡è¿˜æ²¡æœ‰ç½®æ¢ã€‚</p><p>ä¸è¿‡æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>trans</code>å‡½æ•°ä¼¼ä¹ç»™å‡ºäº†æ¯”ç‰¹ä½çš„ç½®æ¢è§„åˆ™ã€‚è‡ªå·±å†…æµ‹ä¸€ä¸‹+åˆ†æä¸€ä¸‹ï¼Œå¯ä»¥ç»™å‡º$P$ç›’çš„ç½®æ¢è§„åˆ™æ˜¯ï¼šä¸€ç»„$8$ä¸ª$8$æ¯”ç‰¹æ•°å­—ä¸­ï¼Œéå†ä¸‹æ ‡$-1$åˆ°$6$ï¼Œå…ˆå–æœ€é«˜ä½æ„æˆç¬¬ä¸€ä¸ªæ–°æ•°å­—ï¼Œç„¶åå–æ¬¡é«˜ä½æ„æˆç¬¬äºŒä¸ªæ–°æ•°å­—ï¼Œä»¥æ­¤ç±»æ¨ã€‚æœ€åè¿˜ä¹˜ä¸Šäº†å¯¹åº”ä½çš„ä¸€ä¸ªcoefå¸¸æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">trans</span>(<span class="hljs-params">blk</span>):<br>    res = []<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>):<br>        bits = [<span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:].rjust(<span class="hljs-number">8</span>,<span class="hljs-string">&#x27;0&#x27;</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> blk[k:k+<span class="hljs-number">8</span>]]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            res.append(<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([x[(i+<span class="hljs-number">1</span>) % <span class="hljs-number">8</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> bits]),<span class="hljs-number">2</span>))<br>        res[k:k+<span class="hljs-number">8</span>] = [(coef[i] * res[k+i]) % <span class="hljs-number">256</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>    <span class="hljs-keyword">return</span> res<br></code></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬æ‰¾å‡º$S$ç›’å’Œ$P$ç›’çš„æ—¶å€™ï¼Œè€ƒè™‘ä¸€äº›æ¯ä¸€æ¬¡åŠ å¯†çš„è¿‡ç¨‹ï¼šå…ˆæ˜¯å°†å¾…åŠ å¯†æ•°æ®ä¸å¯†é’¥å¼‚æˆ–ï¼Œç„¶åå°†æ•°æ®é€šè¿‡$S$ç›’ï¼Œç„¶åè¿›è¡Œ$P$ç›’é™„å¸¦ä¹˜ä¸Šcoefå¸¸æ•°ç½®æ¢ï¼Œï¼Œæœ€åå†æ¥ä¸€æ¬¡$S^{-1}$ç›’ä»¥åŠä¸ååŠæ®µå¯†é’¥å¼‚æˆ–è¿›è¡Œçš„åŠ å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_block</span>(<span class="hljs-params">pt, ks</span>):<br>    cur = doxor(pt, ks[:<span class="hljs-number">8</span>])<br>    cur = [sbox[x] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cur]<br>    cur = trans(cur)<br>    cur = [sboxi[x] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cur]<br>    cur = doxor(cur, ks[<span class="hljs-number">8</span>:])<br>    <span class="hljs-keyword">return</span> cur<br></code></pre></td></tr></table></figure><p>æ¯æ¬¡æˆ‘ä»¬å¯ä»¥ä»»æ„é€‰å–ä¸€æ®µæ˜æ–‡ï¼Œç„¶åå‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ä¼šåé¦ˆç»™æˆ‘ä»¬åŠ å¯†ç»“æœã€‚</p><p>æ ¹æ®åˆšæ‰çš„åˆ†æï¼Œå¾ˆæ˜¾ç„¶ï¼Œä¸€æ—¦æˆ‘ä»¬çŸ¥é“äº†ç¬¬äºŒè½®çš„å¯†é’¥ï¼Œå°±å¾ˆå®¹æ˜“å°†æ•´ä¸ªè¿‡ç¨‹é€†å›å»ã€‚æ‰€ä»¥æˆ‘ä»¬è¦è€ƒè™‘æ±‚å‡ºç¬¬äºŒè½®å¯†é’¥ã€‚</p><h3 id="Step-2-åˆ†æé¢˜ç›®ï¼Œåˆ†éƒ¨è§£å†³"><a href="#Step-2-åˆ†æé¢˜ç›®ï¼Œåˆ†éƒ¨è§£å†³" class="headerlink" title="Step 2 åˆ†æé¢˜ç›®ï¼Œåˆ†éƒ¨è§£å†³"></a>Step 2 åˆ†æé¢˜ç›®ï¼Œåˆ†éƒ¨è§£å†³</h3><p><strong>è¿™é‡Œçš„åˆ†ç»„å¯¹ç§°å¯†ç ä¸­å‡ºç°äº†Sç›’ï¼Œå› æ­¤æˆ‘ä»¬å¿…ç„¶æ˜¯è¦è€ƒè™‘è€ƒè™‘Sç›’çš„çº¿æ€§æ”»å‡»çš„</strong>ã€‚æ•…æˆ‘ä»¬é€‰æ‹©åˆ†åˆ«å¯¹åº”Sboxå…«ä¸ªè¾“å‡ºçš„å…«ä¸ªSboxçš„æœ€å¤§åå·®çº¿æ€§ä¼°è®¡ï¼Œæ¥è¿›è¡Œå…«ä¸ªç¬¬äºŒè½®å­å¯†é’¥çš„çŒœæµ‹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(256Ã—8)&#x3D;O(2048)$ã€‚</p><p>è€Œæˆ‘ä»¬çŒœæµ‹è¿™ä¸ªå¯†é’¥ï¼ŒåŒæ ·åœ°ä¹Ÿå¯ä»¥ç”¨çº¿æ€§åˆ†æã€‚ä¸è¿‡è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦å¤§é‡å­¦ä¹ æ•°æ®ï¼Œå°±è·Ÿæœºå™¨å­¦ä¹ ä¸€æ ·ã€‚æŒ‰é“ç†è¯´ï¼Œå½“æ•°æ®è¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œæ¯ä¸ªæ•°å­—çš„ç»“æœåº”è¯¥éƒ½ä¸ç›¸åŒï¼Œå› æ­¤æˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½æ‰¾åˆ°é‚£ä¸ªåå·®æœ€å¤§çš„æ•°å­—ï¼Œç„¶åå°±æ˜¯æˆ‘ä»¬éœ€è¦æ‰¾åˆ°çš„ç¬¬äºŒè½®å¯†é’¥ã€‚</p><p>è€Œæ•´ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥åˆ†ä¸ºè¿™ä¹ˆå‡ ä¸ªéƒ¨åˆ†ï¼š</p><h4 id="1-åˆå§‹åŒ–éƒ¨åˆ†"><a href="#1-åˆå§‹åŒ–éƒ¨åˆ†" class="headerlink" title="[1] åˆå§‹åŒ–éƒ¨åˆ†"></a>[1] åˆå§‹åŒ–éƒ¨åˆ†</h4><p>åˆå§‹åŒ–éƒ¨åˆ†ä¸»è¦åŒ…æ‹¬äº†ï¼šå°†æ¥æ”¶åˆ°çš„$S$ç›’ç”±å­—ç¬¦ä¸²å½¢å¼è½¬åŒ–æˆæ•°ç»„ã€å°†åå…­ä½é•¿çš„å­—ç¬¦ä¸²è½¬åŒ–æˆå…«ä¸ª$0-255$å†…çš„æ•°å­—ã€è¡¥ä½åå…­è¿›åˆ¶å¡«å……å’ŒäºŒè¿›åˆ¶å¡«å……ã€è¿”å›ä¸¤æ•°ç»„ä¸­å¯¹åº”ä½ç½®å¼‚æˆ–çš„å€¼ï¼Œä»¥åŠæ„å»ºå½¢å¦‚ä»¥ä¸‹å¼å­çš„çº¿æ€§ç»„åˆï¼Œå…¶ä¸­$A,X$æ˜¯å…«æ¯”ç‰¹æ•°å­—ï¼Œ$a,x$æ˜¯å¯¹åº”æ¯”ç‰¹æ•°ã€‚<br>$$<br>f(A,X)\equiv\sum _{i&#x3D;1}^8 a_ix_i  \pmod 2<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getboxinv</span>(<span class="hljs-params">s</span>):<br>    S,Q=[],[<span class="hljs-number">0</span>]*<span class="hljs-number">256</span><br>    cntint,endex=<span class="hljs-number">0</span>,<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">48</span>,<span class="hljs-number">58</span>):<br>            endex=<span class="hljs-literal">True</span><br>            cntint=cntint*<span class="hljs-number">10</span>+<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">48</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> endex==<span class="hljs-literal">True</span>:<br>                endex=<span class="hljs-literal">False</span><br>                S.append(cntint)<br>                Q[cntint]=<span class="hljs-built_in">len</span>(S)-<span class="hljs-number">1</span><br>                cntint=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> S,Q<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s32tol8</span>(<span class="hljs-params">s16</span>):<br>    L8=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(s16),<span class="hljs-number">2</span>):<br>        L8.append(<span class="hljs-built_in">int</span>(s16[i:i+<span class="hljs-number">2</span>],<span class="hljs-number">16</span>))<br>    <span class="hljs-keyword">return</span> L8<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padhex</span>(<span class="hljs-params">x,b</span>):<br>    x=<span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">return</span> (b-<span class="hljs-built_in">len</span>(x))*<span class="hljs-string">&#x27;0&#x27;</span>+x<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padbin</span>(<span class="hljs-params">x,b</span>):<br>    x=<span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">return</span> (b-<span class="hljs-built_in">len</span>(x))*<span class="hljs-string">&#x27;0&#x27;</span>+x<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">doxor</span>(<span class="hljs-params">l1,l2</span>):<br>    <span class="hljs-keyword">return</span> [x[<span class="hljs-number">0</span>]^x[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(l1,l2)]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sumbitpros</span>(<span class="hljs-params">a,x</span>):<br>    c,d=a&amp;x,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> c:<br>        d+=c&amp;<span class="hljs-number">1</span><br>        c&gt;&gt;=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> d&amp;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h4 id="2-åˆå§‹åŒ–éƒ¨åˆ†"><a href="#2-åˆå§‹åŒ–éƒ¨åˆ†" class="headerlink" title="[2] åˆå§‹åŒ–éƒ¨åˆ†"></a>[2] åˆå§‹åŒ–éƒ¨åˆ†</h4><p>çº¿æ€§åŒ–$S$ç›’çš„å‡½æ•°ï¼Œå¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬ç±»æ¯”äºä¸Šé¢$\text{16 x 16}$çš„è¡¨æ ¼ï¼Œåˆ—ä¸¾å‡ºä¸€ä¸ª$\text{256 x 256}$çš„è¡¨æ ¼ï¼Œå…¶ä¸­$i$æ˜¯æˆ‘ä»¬åˆ—ä¸¾çš„è¾“å…¥æ•°å­—ï¼Œ$j$æ˜¯å¸¦å…¥ä¸Šé¢çš„çº¿æ€§ç»„åˆå¯¹åº”çš„æ¯”ç‰¹ç³»æ•°ï¼Œ$k$æ˜¯$S$ç›’è¾“å‡ºç»“æœæ„é€ çº¿æ€§å‡½æ•°çš„æ¯”ç‰¹ç³»æ•°ã€‚æœ€åæˆ‘ä»¬å¾—åˆ°çš„<code>offset</code>åºåˆ—ï¼Œä¾‹å¦‚ï¼š<code>offser[115]</code>å°±æ˜¯æ•°å­—$115$é€šè¿‡$S$ç›’æ—¶çš„æœ€ä½³é€¼è¿‘ç³»æ•°ã€‚è¿™ä¸€éƒ¨åˆ†å·²ç»åœ¨ä¸€å¼€å§‹æœ‰äº†è®²è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">linersbox</span>(<span class="hljs-params">sbox</span>):<br>    lnipt=[]<br>    offset=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">if</span> i%<span class="hljs-number">15</span>==<span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[lnrsbox]:&#x27;</span>+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;/256&#x27;</span>)<br>        si=sbox[i]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>                a=sumbitpros(j,i)<br>                b=sumbitpros(k,si)<br>                <span class="hljs-keyword">if</span> a==b:<br>                    offset[j][k]+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        offset[i]=[<span class="hljs-built_in">abs</span>(x-<span class="hljs-number">128</span>)/<span class="hljs-number">256.0</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> offset[i]]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>): <br>        cur=[x[i] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> offset] <br>        lnipt.append(cur.index(<span class="hljs-built_in">max</span>(cur)))<br>    <span class="hljs-keyword">return</span> offset,lnipt<br></code></pre></td></tr></table></figure><h4 id="3-çŒœæµ‹ç¬¬äºŒæ®µå¯†é’¥éƒ¨åˆ†"><a href="#3-çŒœæµ‹ç¬¬äºŒæ®µå¯†é’¥éƒ¨åˆ†" class="headerlink" title="[3] çŒœæµ‹ç¬¬äºŒæ®µå¯†é’¥éƒ¨åˆ†"></a>[3] çŒœæµ‹ç¬¬äºŒæ®µå¯†é’¥éƒ¨åˆ†</h4><p>å½“æˆ‘ä»¬æƒ³è¦è·å–å¯†é’¥æ¯”ç‰¹çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬æœ‰äº†$r$è½®åŠ å¯†è¿‡ç¨‹çš„ç®—æ³•å’Œå‰$r-1$è½®çš„çº¿æ€§è¿‘ä¼¼è¡¨è¾¾å¼ï¼Œä¸”è¡¨è¾¾å¼çš„çº¿æ€§å¯èƒ½æ€§åç§»é‡è¶³å¤Ÿå¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¢å¤æœ€åä¸€è½®çš„å­å¯†é’¥æ”»å‡»æ—¶å¯è¡Œçš„ã€‚æŠŠä»æœ€åä¸€ä¸ªå­å¯†é’¥ä¸­æ¢å¤å‡ºçš„å¯†é’¥çš„ä¸€éƒ¨åˆ†æˆä¸ºå±€éƒ¨ç›®æ ‡å­å¯†é’¥ã€‚è€Œå±€éƒ¨ç›®æ ‡å­å¯†é’¥æ¥è‡ªäºæœ€åä¸€è½®$S$ç›’ç›¸å…³è”çš„å­å¯†é’¥ã€‚</p><p>ç‰¹åˆ«åœ°ï¼Œå¯¹äºæ‰€æœ‰å¯èƒ½çš„å±€éƒ¨ç›®æ ‡å­å¯†é’¥ï¼Œç›¸åº”çš„å¯†æ–‡æ¯”ç‰¹ä¸å…¶è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œç»“æœå°±ä¼šç»§ç»­é€šè¿‡æœ€åä¸€è½®å¯¹åº”çš„$S$ç›’è¿›è¡Œè®¡ç®—ã€‚</p><p>å¦‚æœä½¿ç”¨çš„æ˜¯ä¸æ­£ç¡®çš„å­å¯†é’¥ï¼Œé‚£ä¹ˆè¿™å°±ä¼šè·ŸéšæœºçŒœæµ‹è¾“å…¥äº§ç”Ÿçš„ç»“æœè¿‘ä¼¼å·®ä¸å¤šï¼Œä½¿å¾—æœ€åç¨‹åºè¾“å‡ºçš„æ¦‚ç‡æ¥è¿‘äº$0.5$ï¼Œåç§»é‡æ¥è¿‘äº$0$ã€‚</p><p>å¦‚æœä¸€ä¸ªå­å¯†é’¥çš„è®¡æ•°å€¼ä¸æ˜æ–‡-å¯†æ–‡çš„æ•°ç›®ä¸€åŠç›¸å·®æœ€å¤šï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯æ­£ç¡®çš„å­å¯†é’¥ã€‚å› ä¸ºä¸€ä¸ªæ­£ç¡®çš„å­å¯†é’¥ä¼šä½¿å¾—çº¿æ€§è¿‘ä¼¼è¡¨è¾¾å¼æˆç«‹çš„æ¦‚ç‡åç¦»äº$0.5$ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥äº§ç”Ÿå¤§é‡çš„éšæœºæ˜æ–‡ï¼Œå¹¶è®©æœåŠ¡å™¨ç»™æˆ‘ä»¬è¿›è¡ŒåŠ å¯†è·å¾—å¯†æ–‡ï¼Œç„¶ååˆ©ç”¨æˆ‘ä»¬æ‰‹ä¸Šçš„æ˜æ–‡å’Œå¯†æ–‡ï¼Œé€šè¿‡å¤§é‡æ•°æ®çš„åˆ†æ ï¼Œæœ€åæˆ‘ä»¬å°±å¯ä»¥æ‰¾å‡ºä¸€ä¸ªæ­£ç¡®çš„å­å¯†é’¥äº†ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘é€‰æ‹©æ¥æ”¶$16384$ç»„é™„åŠ æ˜æ–‡å’Œå¯†æ–‡ã€‚ï¼ˆå®é™…ä¸Š$7000+$ç»„çš„è§„æ¨¡å°±å¤Ÿç”¨äº†ï¼‰</p><p>æ‰€ä»¥çŒœæµ‹å¯†é’¥éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹çš„ä»£ç ï¼Œé€šè¿‡<code>getkey8f</code>å‡½æ•°ä¸­æšä¸¾$8$ä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†$256$ä¸­å¯èƒ½çš„å–å€¼ï¼Œå…±$16384$ç»„é™„åŠ æ˜æ–‡å’Œé™„åŠ å¯†æ–‡ã€‚æˆ‘ä»¬åªéœ€è¦ä¸æ–­åœ°åˆ¤æ–­æœ€åä¸¤ä¸ªçº¿æ€§ç»„åˆçš„ç›¸ç­‰æ¦‚ç‡ä¸$0.5$ç›¸å·®å¤šå°‘å°±å¯ä»¥äº†ï¼Œç›¸å·®æœ€å¤§çš„é‚£ä¸ªï¼Œå°±ä¸€å®šæ˜¯ç¬¬äºŒè½®å¯†é’¥äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">guess</span>(<span class="hljs-params">pt,ct,loc,gus,lnipt,coefinv</span>):<br>    pt,ct=s32tol8(pt),s32tol8(ct)<br>    ct[loc]^=gus<br>    ct[loc]=sbox[ct[loc]]<br>    ct[loc]=ct[loc]*coefinv[loc]&amp;<span class="hljs-number">255</span><br>    tmp1=sumbitpros(pt[<span class="hljs-number">0</span>],lnipt[<span class="hljs-number">1</span>&lt;&lt;((<span class="hljs-number">14</span>-loc)&amp;<span class="hljs-number">7</span>)])<br>    tmp2=sumbitpros(ct[loc],<span class="hljs-number">128</span>)<br>    <span class="hljs-keyword">return</span> tmp1==tmp2<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getkey8f</span>(<span class="hljs-params">Tl,Cl,lnipt,coefinv,scale</span>):<br>    k8f=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[GettingKey]:ID=&#x27;</span>+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">8</span>))<br>        kount=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)]<br>        <span class="hljs-keyword">for</span> gskey <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(scale):<br>                <span class="hljs-keyword">if</span> guess(Tl[j],Cl[j],i,gskey,lnipt,coefinv):<br>                    kount[gskey]+=<span class="hljs-number">1</span><br>        beta=[<span class="hljs-built_in">abs</span>(x-scale//<span class="hljs-number">2</span>+<span class="hljs-number">0.0</span>)/(scale+<span class="hljs-number">0.0</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> kount]<br>        k8f.append(beta.index(<span class="hljs-built_in">max</span>(beta)))<br>    <span class="hljs-keyword">return</span> k8f<br></code></pre></td></tr></table></figure><h4 id="4-é€šè¿‡ç¬¬äºŒæ®µå¯†é’¥æ¢å¤ç¬¬ä¸€æ®µå¯†é’¥å’Œè§£å¯†æ˜æ–‡"><a href="#4-é€šè¿‡ç¬¬äºŒæ®µå¯†é’¥æ¢å¤ç¬¬ä¸€æ®µå¯†é’¥å’Œè§£å¯†æ˜æ–‡" class="headerlink" title="[4] é€šè¿‡ç¬¬äºŒæ®µå¯†é’¥æ¢å¤ç¬¬ä¸€æ®µå¯†é’¥å’Œè§£å¯†æ˜æ–‡"></a>[4] é€šè¿‡ç¬¬äºŒæ®µå¯†é’¥æ¢å¤ç¬¬ä¸€æ®µå¯†é’¥å’Œè§£å¯†æ˜æ–‡</h4><p>å½“ç¬¬äºŒæ®µå¯†é’¥å¾—åˆ°ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸€ç»„é™„åŠ å¯†æ–‡å’Œé™„åŠ æ˜æ–‡ï¼Œè¿›è€Œæ±‚å¾—ç¬¬ä¸€æ®µå¯†é’¥ï¼Œç¬¬ä¸€æ®µå¯†é’¥æ±‚å‡ºåï¼Œç›´æ¥æ¨¡ä»¿åŠ å¯†çš„å½¢å¼ï¼Œå†™å‡ºæ‰€æœ‰æ­¥éª¤çš„é€†ï¼Œflagå°±å‡ºæ¥äº†ã€‚</p><p>ä»¥ä¸‹æ˜¯æ±‚ç¬¬ä¸€æ®µå¯†é’¥å’Œå¯¹å¯†æ–‡è¿›è¡Œè§£å¯†çš„è¿‡ç¨‹ï¼Œè¿™ä¸€è¿‡ç¨‹å¾ˆç®€å•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getkey07</span>(<span class="hljs-params">pt,ct,k8f,coefinv,sbox,sinv</span>):<br>    pt,ct=s32tol8(pt),s32tol8(ct)<br>    cur=ct<br>    cur=doxor(cur,k8f)<br>    cur=[sbox[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur]<br>    cur=transinv(cur)<br>    cur=[sinv[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur]<br>    k07=doxor(pt,cur)<br>    <span class="hljs-keyword">return</span> k07<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ct,k07,k8f,sbox,sinv</span>):<br>    ct=s32tol8(ct)<br>    cur=ct<br>    cur=doxor(cur,k8f)<br>    cur=[sbox[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur]<br>    cur=transinv(cur)<br>    cur=[sinv[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur]<br>    m=doxor(cur,k07)<br>    <span class="hljs-keyword">return</span> m<br></code></pre></td></tr></table></figure><h4 id="5-å®Œæ•´ä»£ç "><a href="#5-å®Œæ•´ä»£ç " class="headerlink" title="[5] å®Œæ•´ä»£ç "></a>[5] å®Œæ•´ä»£ç </h4><p>æ•´ä¸ªè§£é¢˜è¿‡ç¨‹ä¸­ï¼Œæ­¥éª¤è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œ<del>æ˜¯è‡ªå·±ç›®å‰å†™çš„æœ€é•¿çš„è„šæœ¬</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getboxinv</span>(<span class="hljs-params">s</span>):<br>    S,Q=[],[<span class="hljs-number">0</span>]*<span class="hljs-number">256</span><br>    cntint,endex=<span class="hljs-number">0</span>,<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">48</span>,<span class="hljs-number">58</span>):<br>            endex=<span class="hljs-literal">True</span><br>            cntint=cntint*<span class="hljs-number">10</span>+<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">48</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> endex==<span class="hljs-literal">True</span>:<br>                endex=<span class="hljs-literal">False</span><br>                S.append(cntint)<br>                Q[cntint]=<span class="hljs-built_in">len</span>(S)-<span class="hljs-number">1</span><br>                cntint=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> S,Q<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s32tol8</span>(<span class="hljs-params">s16</span>):<br>    L8=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(s16),<span class="hljs-number">2</span>):<br>        L8.append(<span class="hljs-built_in">int</span>(s16[i:i+<span class="hljs-number">2</span>],<span class="hljs-number">16</span>))<br>    <span class="hljs-keyword">return</span> L8<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padhex</span>(<span class="hljs-params">x,b</span>):<br>    x=<span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">return</span> (b-<span class="hljs-built_in">len</span>(x))*<span class="hljs-string">&#x27;0&#x27;</span>+x<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padbin</span>(<span class="hljs-params">x,b</span>):<br>    x=<span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">return</span> (b-<span class="hljs-built_in">len</span>(x))*<span class="hljs-string">&#x27;0&#x27;</span>+x<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">doxor</span>(<span class="hljs-params">l1,l2</span>):<br>    <span class="hljs-keyword">return</span> [x[<span class="hljs-number">0</span>]^x[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(l1,l2)]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sumbitpros</span>(<span class="hljs-params">a,x</span>):<br>    c,d=a&amp;x,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> c:<br>        d+=c&amp;<span class="hljs-number">1</span><br>        c&gt;&gt;=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> d&amp;<span class="hljs-number">1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">transinv</span>(<span class="hljs-params">blk</span>):<br>    res=[]<br>    blk=[(coefinv[i]*blk[i])&amp;<span class="hljs-number">255</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>    blk=[padbin(i,<span class="hljs-number">8</span>)<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> blk]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        s=<span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">1</span>,<span class="hljs-number">7</span>):<br>            s+=blk[j][i]<br>        res.append(<span class="hljs-built_in">int</span>(s,<span class="hljs-number">2</span>))<br>    <span class="hljs-keyword">return</span> res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">linersbox</span>(<span class="hljs-params">sbox</span>):<br>    lnipt=[]<br>    offset=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)] <span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">if</span> i%<span class="hljs-number">15</span>==<span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[lnrsbox]:&#x27;</span>+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;/256&#x27;</span>)<br>        si=sbox[i]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>                a=sumbitpros(j,i)<br>                b=sumbitpros(k,si)<br>                <span class="hljs-keyword">if</span> a==b:<br>                    offset[j][k]+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        offset[i]=[<span class="hljs-built_in">abs</span>(x-<span class="hljs-number">128</span>)/<span class="hljs-number">256.0</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> offset[i]]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>): <br>        cur=[x[i] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> offset] <br>        lnipt.append(cur.index(<span class="hljs-built_in">max</span>(cur)))<br>    <span class="hljs-keyword">return</span> offset,lnipt<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">guess</span>(<span class="hljs-params">pt,ct,loc,gus,lnipt,coefinv</span>):<br>    pt,ct=s32tol8(pt),s32tol8(ct)<br>    ct[loc]^=gus<br>    ct[loc]=sbox[ct[loc]]<br>    ct[loc]=ct[loc]*coefinv[loc]&amp;<span class="hljs-number">255</span><br>    tmp1=sumbitpros(pt[<span class="hljs-number">0</span>],lnipt[<span class="hljs-number">1</span>&lt;&lt;((<span class="hljs-number">14</span>-loc)&amp;<span class="hljs-number">7</span>)])<br>    tmp2=sumbitpros(ct[loc],<span class="hljs-number">128</span>)<br>    <span class="hljs-keyword">return</span> tmp1==tmp2<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getkey8f</span>(<span class="hljs-params">Tl,Cl,lnipt,coefinv,scale</span>):<br>    k8f=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[GettingKey]:ID=&#x27;</span>+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">8</span>))<br>        kount=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)]<br>        <span class="hljs-keyword">for</span> gskey <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(scale):<br>                <span class="hljs-keyword">if</span> guess(Tl[j],Cl[j],i,gskey,lnipt,coefinv):<br>                    kount[gskey]+=<span class="hljs-number">1</span><br>        beta=[<span class="hljs-built_in">abs</span>(x-scale//<span class="hljs-number">2</span>+<span class="hljs-number">0.0</span>)/(scale+<span class="hljs-number">0.0</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> kount]<br>        k8f.append(beta.index(<span class="hljs-built_in">max</span>(beta)))<br>    <span class="hljs-keyword">return</span> k8f<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getkey07</span>(<span class="hljs-params">pt,ct,k8f,coefinv,sbox,sinv</span>):<br>    pt,ct=s32tol8(pt),s32tol8(ct)<br>    cur=ct<br>    cur=doxor(cur,k8f)<br>    cur=[sbox[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur]<br>    cur=transinv(cur)<br>    cur=[sinv[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur]<br>    k07=doxor(pt,cur)<br>    <span class="hljs-keyword">return</span> k07<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ct,k07,k8f,sbox,sinv</span>):<br>    ct=s32tol8(ct)<br>    cur=ct<br>    cur=doxor(cur,k8f)<br>    cur=[sbox[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur]<br>    cur=transinv(cur)<br>    cur=[sinv[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cur]<br>    m=doxor(cur,k07)<br>    <span class="hljs-keyword">return</span> m<br><span class="hljs-comment">#----------MAIN BELOW----------#</span><br>sh=remote(<span class="hljs-string">&quot;node3.buuoj.cn&quot;</span>,<span class="hljs-number">29170</span>)<br>sbox=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>C=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(C)<br>sbox,sinv=getboxinv(sbox)<br>Tl,Cl=[],[]<br>coefinv=[<span class="hljs-number">15</span>,<span class="hljs-number">11</span>,<span class="hljs-number">155</span>,<span class="hljs-number">119</span>,<span class="hljs-number">11</span>,<span class="hljs-number">99</span>,<span class="hljs-number">83</span>,<span class="hljs-number">249</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16384</span>):<br>    <span class="hljs-keyword">if</span> i%<span class="hljs-number">45</span>==<span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[Recving]:&#x27;</span>+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;/16384&#x27;</span>)<br>    cntsend=padhex(bytes_to_long(urandom(<span class="hljs-number">8</span>)),<span class="hljs-number">16</span>)<br>    Tl.append(cntsend)<br>    sh.sendline(cntsend)<br>    Cl.append(sh.recvline(keepends=<span class="hljs-literal">False</span>))<br>offset,lnipt=linersbox(sbox)<br>k8f=getkey8f(Tl,Cl,lnipt,coefinv,<span class="hljs-number">16384</span>)<br><span class="hljs-built_in">print</span>(k8f)<br>k07=getkey07(Tl[<span class="hljs-number">0</span>],Cl[<span class="hljs-number">0</span>],k8f,coefinv,sbox,sinv)<br><span class="hljs-built_in">print</span>(k07)<br>flag=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(C),<span class="hljs-number">16</span>):<br>    m=decrypt(C[i:i+<span class="hljs-number">16</span>],k07,k8f,sbox,sinv)<br>    flag+=m<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#[110, 112, 117, 99, 116, 102, 123, 55, 105, 110, 121, 83, 80, 78, 45, 99, 52, 110, 45, 98, 51, 45, 51, 64, 115, 105, 49, 121, 45, 99, 114, 52, 99, 107, 51, 100, 33, 33, 125, 1]</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MatlabExperiment1-4</title>
    <link href="/2021/02/24/matlab1/"/>
    <url>/2021/02/24/matlab1/</url>
    
    <content type="html"><![CDATA[<h1 id="Matlab-Experiment-By-huangx607087"><a href="#Matlab-Experiment-By-huangx607087" class="headerlink" title="Matlab Experiment  By huangx607087"></a>Matlab Experiment  By huangx607087</h1><h2 id="Notice"><a href="#Notice" class="headerlink" title="Notice"></a>Notice</h2><p>2æœˆ25æ—¥æ›´æ–°ï¼š4ç¯‡æ–‡ç« åˆä¸€ï¼Œå› ä¸ºè‡ªå·±çš„åšå®¢ä¸»è¦è¿˜æ˜¯æCTFè€Œä¸æ˜¯matlabï¼ˆï¼Œå› æ­¤è¿™é‡Œä¸»è¦è¿˜æ˜¯ä»¥å·¥å…·æŸ¥é˜…çš„æ–¹å¼å‘å¸ƒ</p><h2 id="Div-1"><a href="#Div-1" class="headerlink" title="Div 1"></a>Div 1</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>è®¡ç®—$\lim_{x\rightarrow0} \dfrac{1-\cos(mx)}{x^2}$å’Œ$\lim_{x\rightarrow0} \dfrac{1-\cos(mx)}{x}$ï¼Œå…¶ä¸­$m$ä¸ºè‡ªå·±å­¦å·çš„å4ä½ï¼Œæœ¬åšå®¢ä¸­ç”¨çš„æ•°å€¼æ˜¯$m&#x3D;1126$</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs matlab">&gt;&gt; syms x<br>&gt;&gt; f=(<span class="hljs-number">1</span>-<span class="hljs-built_in">cos</span>(<span class="hljs-number">1126</span>*x))/(x*x);<br>&gt;&gt; limit(f,x,<span class="hljs-number">0</span>)<br><span class="hljs-comment">%633938</span><br>&gt;&gt; syms x<br>&gt;&gt; g=(<span class="hljs-number">1</span>-<span class="hljs-built_in">cos</span>(<span class="hljs-number">1126</span>*x))/(x);<br>&gt;&gt; limit(g,x,<span class="hljs-number">0</span>)<br><span class="hljs-comment">%0</span><br></code></pre></td></tr></table></figure><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>$f(x)&#x3D;e^x\sin(\dfrac{mx}{1000})$ï¼Œæ±‚$fâ€™â€™(x)$å’Œ$f^{(6)}(1)$ï¼Œæ­¤å¤„$m&#x3D;1126$ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs matlab">&gt;&gt; syms x<br>&gt;&gt; f=<span class="hljs-built_in">exp</span>(x)*<span class="hljs-built_in">sin</span>(<span class="hljs-number">1126</span>*x/<span class="hljs-number">1000</span>);<br>&gt;&gt; d1=diff(f,x,<span class="hljs-number">2</span>);<br>&gt;&gt; d2=diff(f,x,<span class="hljs-number">6</span>);<br>&gt;&gt; k=subs(d2,x,<span class="hljs-number">1</span>);<br><span class="hljs-comment">%(563*cos((563*x)/500)*exp(x))/250 - (66969*sin((563*x)/500)*exp(x))/250000</span><br><span class="hljs-comment">%(63380945166868791*exp(1)*sin(563/500))/15625000000000000 - (170878640482871*cos(563/500)*exp(1))/15625000000000</span><br></code></pre></td></tr></table></figure><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>è®¡ç®—$\int_{0}^{+âˆ} e^{-mx^2} \text dx$ï¼Œå…¶ä¸­$m&#x3D;1126$ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs matlab">&gt;&gt; syms x<br>&gt;&gt; f=<span class="hljs-built_in">exp</span>(<span class="hljs-number">-1126</span>*x*x);<br>&gt;&gt; int(f,x,<span class="hljs-number">0</span>,<span class="hljs-built_in">inf</span>)<br><span class="hljs-comment">%(1126^(1/2)*pi^(1/2))/2252</span><br></code></pre></td></tr></table></figure><h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p>ç»™å‡º$\sqrt[3]{\dfrac{m}{1000}+x}$åœ¨$x&#x3D;0$å¤„çš„æ³°å‹’å±•å¼€å¼ï¼Œå…¶ä¸­$x$çš„æœ€é«˜æ¬¡å¹‚ä¸º$4$ï¼Œ$m&#x3D;1126$ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs matlab">&gt;&gt; syms x<br>&gt;&gt; f=(<span class="hljs-number">1126</span>/<span class="hljs-number">1000</span>+x)^(<span class="hljs-number">1</span>/<span class="hljs-number">3</span>);<br>&gt;&gt; taylor(f,x,<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;Order&#x27;</span>,<span class="hljs-number">5</span>)<br><span class="hljs-comment">%  -(1250000000*500^(2/3)*563^(1/3)*x^4)/24414051311523 + (1250000*500^(2/3)*563^(1/3)*x^3)/14454737307 - (500*500^(2/3)*563^(1/3)*x^2)/2852721 + (500^(2/3)*563^(1/3)*x)/1689 + (500^(2/3)*563^(1/3))/500</span><br><br></code></pre></td></tr></table></figure><h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><p>æ•°åˆ—$x$æ»¡è¶³$x_1&#x3D;2,x_2&#x3D;1,x_n&#x3D;2x_{n-1}+\dfrac m {300}x_{n-2}$ï¼Œç”¨å¾ªç¯è¯­å¥ç»™å‡ºè¿™ä¸ªæ•°åˆ—çš„å‰$20$é¡¹ï¼Œå¹¶ç”¨å‘é‡çš„å½¢å¼è¾“å‡ºã€‚å…¶ä¸­$m&#x3D;1126$ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs matlab">&gt;&gt; x=[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>];<br>&gt;&gt; <span class="hljs-keyword">for</span> n=<span class="hljs-number">3</span>:<span class="hljs-number">20</span><br>x(n)=<span class="hljs-number">2</span>*x(n<span class="hljs-number">-1</span>)+(<span class="hljs-number">1126</span>/<span class="hljs-number">300</span>)*x(n<span class="hljs-number">-2</span>);<br><span class="hljs-keyword">end</span><br>sym(x)<br><span class="hljs-comment">%[ 2, 1, 713/75, 683/30, 5714999122138853/70368744177664, 545095937007935/2199023255552, 1760513646050073/2199023255552, 1391738510584149/549755813888, 4435425659045283/549755813888, 3523627465287435/137438953472, 2802290668494757/34359738368, 8910918441917557/34359738368, 7084941964896359/8589934592, 5632823933614673/2147483648, 4478421269405941/536870912, 3560577249130079/134217728, 2830851614013183/33554432, 562669471674589/2097152, 7157638204545749/8388608, 5690705185958165/2097152]</span><br></code></pre></td></tr></table></figure><h3 id="6"><a href="#6" class="headerlink" title="6"></a>6</h3><p><img src="/2021/02/24/matlab1/1.png" alt="T6"></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs matlab">&gt;&gt; A=[<span class="hljs-number">4</span>,<span class="hljs-number">-2</span>,<span class="hljs-number">2</span>;<span class="hljs-number">-3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>];<br>&gt;&gt; B=[<span class="hljs-number">1</span>,<span class="hljs-number">1126</span>/<span class="hljs-number">400</span>,<span class="hljs-number">4</span>;<span class="hljs-number">-2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-3</span>;<span class="hljs-number">2</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>];<br>det(A)<br><span class="hljs-built_in">ans</span> = <span class="hljs-number">-92</span><br>sym(A^<span class="hljs-number">-1</span>)<br><span class="hljs-built_in">ans</span> =<br>[  <span class="hljs-number">5</span>/<span class="hljs-number">46</span>, <span class="hljs-number">-7</span>/<span class="hljs-number">46</span>,  <span class="hljs-number">5</span>/<span class="hljs-number">46</span>]<br>[ <span class="hljs-number">-5</span>/<span class="hljs-number">23</span>, <span class="hljs-number">-9</span>/<span class="hljs-number">46</span>, <span class="hljs-number">13</span>/<span class="hljs-number">46</span>]<br>[  <span class="hljs-number">3</span>/<span class="hljs-number">46</span>,  <span class="hljs-number">5</span>/<span class="hljs-number">46</span>,  <span class="hljs-number">3</span>/<span class="hljs-number">46</span>]<br>&gt;&gt; [P,D]=eig(A)<br>P =<br>   <span class="hljs-number">-0.3490</span>   <span class="hljs-number">-0.8942</span>    <span class="hljs-number">0.2379</span><br>   <span class="hljs-number">-0.8952</span>    <span class="hljs-number">0.4403</span>    <span class="hljs-number">0.5181</span><br>    <span class="hljs-number">0.2772</span>   <span class="hljs-number">-0.0815</span>    <span class="hljs-number">0.8216</span><br>D =<br>   <span class="hljs-number">-2.7180</span>         <span class="hljs-number">0</span>         <span class="hljs-number">0</span><br>         <span class="hljs-number">0</span>    <span class="hljs-number">5.1671</span>         <span class="hljs-number">0</span><br>         <span class="hljs-number">0</span>         <span class="hljs-number">0</span>    <span class="hljs-number">6.5509</span><br>&gt;&gt; A*(B^<span class="hljs-number">-1</span>)<br><span class="hljs-built_in">ans</span> =<br>    <span class="hljs-number">0.0000</span>    <span class="hljs-number">0.0000</span>    <span class="hljs-number">2.0000</span><br>   <span class="hljs-number">-3.0351</span>   <span class="hljs-number">-8.5615</span>   <span class="hljs-number">-8.5439</span><br>    <span class="hljs-number">0.1597</span>   <span class="hljs-number">-1.9704</span>   <span class="hljs-number">-1.5503</span><br>&gt;&gt; (A^<span class="hljs-number">-1</span>)*B<br><span class="hljs-built_in">ans</span> =<br>    <span class="hljs-number">0.6304</span>    <span class="hljs-number">0.1973</span>    <span class="hljs-number">1.0000</span><br>    <span class="hljs-number">0.7391</span>   <span class="hljs-number">-0.8946</span>    <span class="hljs-number">0.0000</span><br>   <span class="hljs-number">-0.0217</span>    <span class="hljs-number">0.1184</span>    <span class="hljs-number">0.0000</span><br></code></pre></td></tr></table></figure><h3 id="7"><a href="#7" class="headerlink" title="7"></a>7</h3><p>ä½œå›¾$f(x)$ï¼Œå…¶ä¸­$x\in [0,0.5]$æ—¶$f(x)&#x3D;2x$ï¼Œ$x\in [0.5,1]$æ—¶$f(x)&#x3D;2(1-x)$</p><p>ä½¿ç”¨çš„Mæ–‡ä»¶ï¼š</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs matlab"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">[y]</span>=<span class="hljs-title">f</span><span class="hljs-params">(x)</span></span><br><span class="hljs-keyword">if</span> x&gt;=<span class="hljs-number">0</span> &amp;&amp; x&lt;=<span class="hljs-number">0.5</span><br>    y=<span class="hljs-number">2</span>*x;<br><span class="hljs-keyword">elseif</span> <span class="hljs-number">0.5</span>&lt;x &amp;&amp; x&lt;=<span class="hljs-number">1</span><br>    y=<span class="hljs-number">2</span>*(<span class="hljs-number">1</span>-x);<br><span class="hljs-keyword">else</span><br>    y=<span class="hljs-number">0</span><br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><p>ç»˜å›¾æŒ‡ä»¤ï¼š</p><p><code>fplot(&#39;f&#39;,[0,1])</code></p><p>å›¾ç‰‡ï¼š</p><img src="/2021/02/24/matlab1/7.png" alt="7" style="zoom: 80%;"><h3 id="8"><a href="#8" class="headerlink" title="8"></a>8</h3><p>ç»˜åˆ¶ç©ºé—´æ›²çº¿$x&#x3D;\cos t+t \sin t,y&#x3D;\sin t-t\cos t,z&#x3D;-t$ï¼Œå…¶ä¸­$t \in[\dfrac{-30m}{1000},\dfrac{+30m}{1000}]$ï¼Œ$m&#x3D;1126$ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs matlab">&gt;&gt; t=<span class="hljs-number">-30</span>*<span class="hljs-number">1126</span>/<span class="hljs-number">1000</span>:<span class="hljs-number">0.005</span>:<span class="hljs-number">30</span>*<span class="hljs-number">1126</span>/<span class="hljs-number">1000</span>;<br>x=<span class="hljs-built_in">cos</span>(t)+t.*<span class="hljs-built_in">sin</span>(t);<br>y=<span class="hljs-built_in">sin</span>(t)-t.*<span class="hljs-built_in">cos</span>(t);<br>z=-t;<br><span class="hljs-built_in">plot3</span>(x,y,z);grid on<br></code></pre></td></tr></table></figure><img src="/2021/02/24/matlab1/8.png" alt="8" style="zoom: 80%;"><h3 id="9"><a href="#9" class="headerlink" title="9"></a>9</h3><p>$f(x)&#x3D;\lambda e^{-\lambda x}, x&gt;0$ï¼Œ$xâ‰¤0$æ—¶$x$æ’å®šä¸º$0$ï¼Œåœ¨åŒæ„åæ ‡ç³»å†…ç”»å‡º$f(x)$çš„å›¾åƒï¼Œ$\lambda$åˆ†åˆ«å–$\dfrac{1000}{1126},\dfrac{500}{1126},\dfrac{400}{1126},\dfrac{100}{1126}$ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs matlab">&gt;&gt; x=<span class="hljs-number">-1</span>:<span class="hljs-number">0.005</span>:<span class="hljs-number">5</span>;<br>f1=(<span class="hljs-number">0</span>) .* (x&lt;=<span class="hljs-number">0</span>) +(<span class="hljs-number">1000</span>/<span class="hljs-number">1126</span>*<span class="hljs-built_in">exp</span>(<span class="hljs-number">-1000</span>/<span class="hljs-number">1126</span>*x)) .* (x&gt;<span class="hljs-number">0</span>);<br>f2=(<span class="hljs-number">0</span>) .* (x&lt;=<span class="hljs-number">0</span>) +(<span class="hljs-number">500</span>/<span class="hljs-number">1126</span>*<span class="hljs-built_in">exp</span>(<span class="hljs-number">-500</span>/<span class="hljs-number">1126</span>*x)) .* (x&gt;<span class="hljs-number">0</span>);<br>f3=(<span class="hljs-number">0</span>) .* (x&lt;=<span class="hljs-number">0</span>) +(<span class="hljs-number">400</span>/<span class="hljs-number">1126</span>*<span class="hljs-built_in">exp</span>(<span class="hljs-number">-400</span>/<span class="hljs-number">1126</span>*x)) .* (x&gt;<span class="hljs-number">0</span>);<br>f4=(<span class="hljs-number">0</span>) .* (x&lt;=<span class="hljs-number">0</span>) +(<span class="hljs-number">100</span>/<span class="hljs-number">1126</span>*<span class="hljs-built_in">exp</span>(<span class="hljs-number">-100</span>/<span class="hljs-number">1126</span>*x)) .* (x&gt;<span class="hljs-number">0</span>);<br><span class="hljs-built_in">plot</span>(x,f1,<span class="hljs-string">&#x27;r&#x27;</span>,x,f2,<span class="hljs-string">&#x27;g&#x27;</span>,x,f3,<span class="hljs-string">&#x27;b&#x27;</span>,x,f4,<span class="hljs-string">&#x27;k&#x27;</span>); grid on<br></code></pre></td></tr></table></figure><img src="/2021/02/24/matlab1/9.png" alt="9" style="zoom: 80%;"><h3 id="10"><a href="#10" class="headerlink" title="10"></a>10</h3><p>ç”¨<code>ezplot</code>ç”»éšå‡½æ•°$\sin (x^2+\dfrac{m}{1000}y^2)&#x3D;\cos (xy)$ï¼Œ$m&#x3D;1126$</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">ezplot(<span class="hljs-string">&#x27;sin(x^2+1126/1000*y^2)-cos(x*y)&#x27;</span>,[<span class="hljs-number">-4</span> <span class="hljs-number">4</span> <span class="hljs-number">-4</span> <span class="hljs-number">4</span>])<br></code></pre></td></tr></table></figure><img src="/2021/02/24/matlab1/10.png" alt="10" style="zoom: 80%;"><h3 id="11"><a href="#11" class="headerlink" title="11"></a>11</h3><p>ä½œå›¾$z&#x3D;mx^2+y^4$çš„å›¾å½¢ï¼Œ$m&#x3D;1126$ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs matlab">syms x<br>syms y<br>ezmesh(<span class="hljs-number">1126</span>*x^<span class="hljs-number">2</span>+y^<span class="hljs-number">4</span>,[<span class="hljs-number">-9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">-13</span>,<span class="hljs-number">13</span>])<br></code></pre></td></tr></table></figure><img src="/2021/02/24/matlab1/11.png" alt="11" style="zoom:80%;"><h3 id="12"><a href="#12" class="headerlink" title="12"></a>12</h3><p>å¯¹äºæ–¹ç¨‹$e^x-3 \dfrac{m}{m+100}x^2&#x3D;0,m&#x3D;1126$ã€‚</p><p>1.ç»˜åˆ¶å‡½æ•°çš„å›¾å½¢<br>2.å€ŸåŠ©äºè½¯ä»¶ä¸­æ–¹ç¨‹è¿‘ä¼¼æ±‚æ ¹å‘½ä»¤æ±‚å‡ºæ‰€æœ‰å®æ ¹ã€‚<br>3.æ‰¾å‡ºå•è°ƒåŒºé—´ï¼Œå¹¶è¯´æ˜ä¸ºä»€ä¹ˆè¿™äº›åŒºé—´æ˜¯å•è°ƒçš„<br>4.è¯´æ˜è¯¥æ–¹ç¨‹ç¡®å®åªæœ‰ä½ æ±‚å‡ºçš„è¿™äº›å®æ ¹<br>5.å†™å‡ºä½ åšæ­¤é¢˜çš„ä½“ä¼š</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs matlab"><span class="hljs-comment">%1-3é—®</span><br>syms x<br>f=<span class="hljs-built_in">exp</span>(x)<span class="hljs-number">-3</span>*<span class="hljs-number">1126</span>/<span class="hljs-number">1226</span>*x^<span class="hljs-number">2</span>;<br>fplot(f,[<span class="hljs-number">-4</span>,<span class="hljs-number">5</span>]);grid on<br>double(solve(f,x));<br><span class="hljs-comment">%å›¾ç‰‡è§ä¸‹å›¾</span><br><span class="hljs-built_in">ans</span> =<br>    <span class="hljs-number">0.9867</span><br>   <span class="hljs-number">-0.4751</span><br>    <span class="hljs-number">3.5441</span><br>df=diff(f,x);<br>double(solve(df))<br><span class="hljs-built_in">ans</span> =<br>    <span class="hljs-number">0.2279</span><br>    <span class="hljs-number">2.6998</span><br></code></pre></td></tr></table></figure><img src="/2021/02/24/matlab1/12.png" alt="12" style="zoom:80%;"><p>å¯¹äº$f(x)&#x3D;e^x-\dfrac{1689}{613}x^2$ï¼Œå®šä¹‰åŸŸæ˜¯$R$ã€‚æ±‚å¯¼å¾—$fâ€™(x)&#x3D;e^x-\dfrac{3378}{613}x$ã€‚è¿™ä¸ªæ–¹ç¨‹æœ‰ä¸¤ä¸ªæ ¹å¤§è‡´ä¸º$0.2279$å’Œ$2.6998$ã€‚å› æ­¤$f(x)$åœ¨åŒºé—´$[-âˆï¼Œ0.2279]$å’Œ$[2.6998,+âˆ]$è¿™ä¸¤ä¸ªåŒºé—´å†…å•è°ƒå¢ï¼Œåœ¨åŒºé—´$[0.2279,2.6998]$å•è°ƒå‡ã€‚å› æ­¤$f(x)$åœ¨è¿™ä¸‰ä¸ªå•è°ƒåŒºé—´å†…è‡³å¤šå„æœ‰ä¸€ä¸ªå®æ ¹ï¼Œæˆ‘ä»¬å·²ç»æ±‚å‡ºæ¥ä¸º$-0.4751,0.9867,3.5441$ã€‚</p><p>ä½“ä¼šç•¥å»ï¼ˆ</p><h2 id="Div-2"><a href="#Div-2" class="headerlink" title="Div 2"></a>Div 2</h2><h3 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h3><p>$x_{1}&#x3D;-1,x_{n+1}&#x3D;0.5(x_n+\dfrac{1126}{x_n})$ã€‚é—®æ•°åˆ—$x_n$æ˜¯å¦æ”¶æ•›ï¼Œè‹¥æ”¶æ•›å…¶å€¼æ˜¯å¤šå°‘ï¼Œç²¾ç¡®åˆ°$8$ä½æœ‰æ•ˆæ•°å­—</p><p><strong>Code</strong></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs matlab">syms x;<br>f=inline(<span class="hljs-string">&#x27;0.5*(x+1126/x)&#x27;</span>);<br>x1=<span class="hljs-number">-1</span>;<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">1</span>:<span class="hljs-number">15</span><br>x1=f(x1);<br>fprintf(<span class="hljs-string">&#x27;%g,%.8f\n&#x27;</span>,<span class="hljs-built_in">i</span>,x1);<br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><p><strong>Result</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>,-<span class="hljs-number">563</span>.<span class="hljs-number">50000000</span><br><span class="hljs-attribute">2</span>,-<span class="hljs-number">282</span>.<span class="hljs-number">74911269</span><br><span class="hljs-attribute">3</span>,-<span class="hljs-number">143</span>.<span class="hljs-number">36572086</span><br><span class="hljs-attribute">4</span>,-<span class="hljs-number">75</span>.<span class="hljs-number">60988006</span><br><span class="hljs-attribute">5</span>,-<span class="hljs-number">45</span>.<span class="hljs-number">25105685</span><br><span class="hljs-attribute">6</span>,-<span class="hljs-number">35</span>.<span class="hljs-number">06722679</span><br><span class="hljs-attribute">7</span>,-<span class="hljs-number">33</span>.<span class="hljs-number">58849003</span><br><span class="hljs-attribute">8</span>,-<span class="hljs-number">33</span>.<span class="hljs-number">55593926</span><br><span class="hljs-attribute">9</span>,-<span class="hljs-number">33</span>.<span class="hljs-number">55592347</span><br><span class="hljs-attribute">10</span>,-<span class="hljs-number">33</span>.<span class="hljs-number">55592347</span><br><span class="hljs-attribute">11</span>,-<span class="hljs-number">33</span>.<span class="hljs-number">55592347</span><br><span class="hljs-attribute">12</span>,-<span class="hljs-number">33</span>.<span class="hljs-number">55592347</span><br><span class="hljs-attribute">13</span>,-<span class="hljs-number">33</span>.<span class="hljs-number">55592347</span><br><span class="hljs-attribute">14</span>,-<span class="hljs-number">33</span>.<span class="hljs-number">55592347</span><br><span class="hljs-attribute">15</span>,-<span class="hljs-number">33</span>.<span class="hljs-number">55592347</span><br></code></pre></td></tr></table></figure><p>å› æ­¤$x$å€¼æ˜¯æ”¶æ•›çš„ï¼Œæ”¶æ•›åˆ°$-33.55592347$ã€‚</p><h3 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h3><p>æ±‚å‡ºåˆ†å¼çº¿æ€§å‡½æ•°$f_1(x)&#x3D;\dfrac{x-1}{x+1126},f_2(x)&#x3D;\dfrac{x+1126^2}{x+1126}$çš„ä¸åŠ¨ç‚¹ï¼Œå†ç¼–ç¨‹åˆ¤æ–­å®ƒä»¬çš„è¿­ä»£åºåˆ—æ˜¯å¦æ”¶æ•›ã€‚</p><p><strong>f1</strong></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs matlab">syms x<br>f1=(x<span class="hljs-number">-1</span>)/(x+<span class="hljs-number">1126</span>);<br>fprintf(<span class="hljs-string">&quot;%.8f\n%.8f\n&quot;</span>,solve(f1-x,x))<br><span class="hljs-comment">%-1124.99911111</span><br><span class="hljs-comment">%-0.00088889</span><br>f1=inline(<span class="hljs-string">&#x27;(x-1)/(x+1126)&#x27;</span>);<br>x1=<span class="hljs-number">-1</span>;<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">1</span>:<span class="hljs-number">15</span><br>x1=f1(x1);<br>fprintf(<span class="hljs-string">&#x27;%g,%.8f\n&#x27;</span>,<span class="hljs-built_in">i</span>,x1);<br><span class="hljs-keyword">end</span><br><span class="hljs-number">1</span>,<span class="hljs-number">-7.94444444</span><br><span class="hljs-number">2</span>,<span class="hljs-number">-0.00800000</span><br><span class="hljs-number">3</span>,<span class="hljs-number">-0.00089521</span><br><span class="hljs-number">4</span>,<span class="hljs-number">-0.00088890</span><br><span class="hljs-number">5</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-number">6</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-number">7</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-number">8</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-number">9</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-number">10</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-number">11</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-number">12</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-number">13</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-number">14</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-number">15</span>,<span class="hljs-number">-0.00088889</span><br><span class="hljs-comment">%æ”¶æ•›äº0.00088889</span><br></code></pre></td></tr></table></figure><p><strong>f2</strong></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs matlab">syms x<br>f2=(x+<span class="hljs-number">1126</span>*<span class="hljs-number">1126</span>)/(x+<span class="hljs-number">1126</span>);<br>fprintf(<span class="hljs-string">&quot;%.8f\n%.8f\n&quot;</span>,solve(f2-x,x))<br><span class="hljs-comment">%-1821.18274398</span><br><span class="hljs-comment">%696.18274398</span><br>f2=inline(<span class="hljs-string">&#x27;(x+1126*1126)/(x+1126)&#x27;</span>);<br>x1=<span class="hljs-number">-1</span>;<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">1</span>:<span class="hljs-number">30</span><br>x1=f2(x1);<br>fprintf(<span class="hljs-string">&#x27;%g,%.8f\n&#x27;</span>,<span class="hljs-built_in">i</span>,x1);<br><span class="hljs-keyword">end</span><br><span class="hljs-number">1</span>,<span class="hljs-number">1127.00000000</span><br><span class="hljs-number">2</span>,<span class="hljs-number">563.25033289</span><br><span class="hljs-number">3</span>,<span class="hljs-number">750.88885622</span><br><span class="hljs-number">4</span>,<span class="hljs-number">675.92009226</span><br><span class="hljs-number">5</span>,<span class="hljs-number">704.00009720</span><br><span class="hljs-number">6</span>,<span class="hljs-number">693.21307799</span><br><span class="hljs-number">7</span>,<span class="hljs-number">697.31755363</span><br><span class="hljs-number">8</span>,<span class="hljs-number">695.75007109</span><br><span class="hljs-number">9</span>,<span class="hljs-number">696.34785265</span><br><span class="hljs-number">10</span>,<span class="hljs-number">696.11975892</span><br><span class="hljs-number">11</span>,<span class="hljs-number">696.20677431</span><br><span class="hljs-number">12</span>,<span class="hljs-number">696.17357627</span><br><span class="hljs-number">13</span>,<span class="hljs-number">696.18624158</span><br><span class="hljs-number">14</span>,<span class="hljs-number">696.18140961</span><br><span class="hljs-number">15</span>,<span class="hljs-number">696.18325306</span><br><span class="hljs-number">16</span>,<span class="hljs-number">696.18254976</span><br><span class="hljs-number">17</span>,<span class="hljs-number">696.18281808</span><br><span class="hljs-number">18</span>,<span class="hljs-number">696.18271571</span><br><span class="hljs-number">19</span>,<span class="hljs-number">696.18275477</span><br><span class="hljs-number">20</span>,<span class="hljs-number">696.18273987</span><br><span class="hljs-number">21</span>,<span class="hljs-number">696.18274555</span><br><span class="hljs-number">22</span>,<span class="hljs-number">696.18274338</span><br><span class="hljs-number">23</span>,<span class="hljs-number">696.18274421</span><br><span class="hljs-number">24</span>,<span class="hljs-number">696.18274390</span><br><span class="hljs-number">25</span>,<span class="hljs-number">696.18274402</span><br><span class="hljs-number">26</span>,<span class="hljs-number">696.18274397</span><br><span class="hljs-number">27</span>,<span class="hljs-number">696.18274399</span><br><span class="hljs-number">28</span>,<span class="hljs-number">696.18274398</span><br><span class="hljs-number">29</span>,<span class="hljs-number">696.18274398</span><br><span class="hljs-number">30</span>,<span class="hljs-number">696.18274398</span><br><span class="hljs-comment">%æ”¶æ•›äº696.18274398</span><br></code></pre></td></tr></table></figure><h3 id="3-1"><a href="#3-1" class="headerlink" title="3"></a>3</h3><p>$f(x)&#x3D;2x,x\in[0,0.5]; 2(1-x),x\in(0.5,1]$çš„è¿­ä»£æ˜¯å¦ä¼šäº§ç”Ÿæ··æ²Œã€‚</p><p>ä¸ä¼šäº§ç”Ÿæ··æ²Œï¼Œåªä¸è¿‡å¦‚æœå°æ•°ä½æ•°å¢å¤šï¼Œå‘¨æœŸä¼šå˜é•¿ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs matlab">syms x<br>f=inline(<span class="hljs-string">&#x27;(2*x) .*(x&gt;=0&amp;x&lt;=0.5) + (2*(1-x)) .* (x&gt;0.5&amp;x&lt;=1)&#x27;</span>)<br>x0=<span class="hljs-number">0.53</span>;<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">1</span>:<span class="hljs-number">50</span><br>x0=f(x0);<br>fprintf(<span class="hljs-string">&#x27;%g,%g\n&#x27;</span>,<span class="hljs-built_in">i</span>,x0)<br><span class="hljs-keyword">end</span><br>-------------------Result-----------------<br><span class="hljs-number">1</span>,<span class="hljs-number">0.94</span><br><span class="hljs-number">2</span>,<span class="hljs-number">0.12</span><br><span class="hljs-number">3</span>,<span class="hljs-number">0.24</span><br><span class="hljs-number">4</span>,<span class="hljs-number">0.48</span><br><span class="hljs-number">5</span>,<span class="hljs-number">0.96</span><br><span class="hljs-number">6</span>,<span class="hljs-number">0.08</span><br><span class="hljs-number">7</span>,<span class="hljs-number">0.16</span><br><span class="hljs-number">8</span>,<span class="hljs-number">0.32</span><br><span class="hljs-number">9</span>,<span class="hljs-number">0.64</span><br><span class="hljs-number">10</span>,<span class="hljs-number">0.72</span><br><span class="hljs-number">11</span>,<span class="hljs-number">0.56</span><br><span class="hljs-number">12</span>,<span class="hljs-number">0.88</span><br><span class="hljs-number">13</span>,<span class="hljs-number">0.24</span><br><span class="hljs-number">14</span>,<span class="hljs-number">0.48</span><br><span class="hljs-number">15</span>,<span class="hljs-number">0.96</span><br></code></pre></td></tr></table></figure><h3 id="4-1"><a href="#4-1" class="headerlink" title="4"></a>4</h3><p>$f(x)&#x3D;\alpha x(1-x),x\in[0,1]$ï¼Œå…¶ä¸­$x_0&#x3D;0.5$äº§ç”Ÿè¿­ä»£åºåˆ—çš„æ”¶æ•›æ€§ã€‚å…¶ä¸­$\alpha$åˆ†åˆ«å–$2.6,3.4,3.6,3.84$ã€‚å‡ºç°å¾ªç¯ï¼ŒæŒ‡å‡ºå‘¨æœŸã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs matlab">u=<span class="hljs-number">2.6</span>:<span class="hljs-number">0.01</span>:<span class="hljs-number">4.0</span>;<br>x=<span class="hljs-number">0.1</span>;<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">300</span><br>x=u.*(x-x.^<span class="hljs-number">2</span>);<br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">for</span> <span class="hljs-built_in">j</span>=<span class="hljs-number">1</span>:<span class="hljs-number">80</span><br>x=u.*(x-x.^<span class="hljs-number">2</span>);<br><span class="hljs-built_in">plot</span>(u,x,<span class="hljs-string">&#x27;k.&#x27;</span>,<span class="hljs-string">&#x27;markersize&#x27;</span>,<span class="hljs-number">2</span>)<br><span class="hljs-built_in">hold</span> on;<br><span class="hljs-keyword">end</span><br>grid on<br></code></pre></td></tr></table></figure><img src="/2021/02/24/matlab1/24.png" alt="4" style="zoom:80%;"><p>$2.6$å¯¹åº”çš„å‘¨æœŸæ˜¯$1$ï¼Œ$3.4$å¯¹åº”çš„å‘¨æœŸæ˜¯$2$ï¼Œ$3.6$å‡ºç°äº†æ··æ²Œç°è±¡ï¼Œ$3.84$å¯¹åº”çš„å‘¨æœŸæ˜¯$3$ã€‚</p><h3 id="5-1"><a href="#5-1" class="headerlink" title="5"></a>5</h3><p>å¯¹äº Martin è¿­ä»£ï¼Œå–å‚æ•°  $a,b,c$ä¸ºä¸‹é¢çš„å€¼ä¼šå¾—åˆ°ä»€ä¹ˆå›¾å½¢ï¼Ÿ</p><table><thead><tr><th align="center"></th><th align="center">$a$</th><th align="center">$b$</th><th align="center">$c$</th></tr></thead><tbody><tr><td align="center">$\mathbf{1}$</td><td align="center">$-1126$</td><td align="center">$1.126$</td><td align="center">$-1126$</td></tr><tr><td align="center">$\mathbf{2}$</td><td align="center">$1.126$</td><td align="center">$1.126$</td><td align="center">$0.5$</td></tr><tr><td align="center">$\mathbf{3}$</td><td align="center">$1.126$</td><td align="center">$1126$</td><td align="center">$-1126$</td></tr><tr><td align="center">$\mathbf{4}$</td><td align="center">$11.26$</td><td align="center">$112.6$</td><td align="center">$-10$</td></tr><tr><td align="center">$\mathbf{5}$</td><td align="center">$-112.6$</td><td align="center">$17$</td><td align="center">$4$</td></tr></tbody></table><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs matlab"><span class="hljs-comment">%è¾“å…¥editï¼Œå¡«å†™ä»¥ä¸‹ä»£ç </span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Martin</span><span class="hljs-params">(a,b,c,n)</span></span><br>f=@(x,y)(y-<span class="hljs-built_in">sign</span>(x)*<span class="hljs-built_in">sqrt</span>(<span class="hljs-built_in">abs</span>(b*x-c)));<br>g=@(x)(a-x);<br>m=[<span class="hljs-number">0</span>;<span class="hljs-number">0</span>];<br><span class="hljs-keyword">for</span> n=<span class="hljs-number">1</span>:n<br>m(:,n+<span class="hljs-number">1</span>)=[f(m(<span class="hljs-number">1</span>,n),m(<span class="hljs-number">2</span>,n)),g(m(<span class="hljs-number">1</span>,n))];<br><span class="hljs-keyword">end</span><br><span class="hljs-built_in">plot</span>(m(<span class="hljs-number">1</span>,:),m(<span class="hljs-number">2</span>,:),<span class="hljs-string">&#x27;kx&#x27;</span>);grid on<br>axis equal<br><span class="hljs-comment">%å…³é—­edit</span><br>Martin(<span class="hljs-number">-1126</span>,<span class="hljs-number">1.126</span>,<span class="hljs-number">-1126</span>,<span class="hljs-number">10000</span>)<br>Martin(<span class="hljs-number">1.126</span>,<span class="hljs-number">1.126</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">10000</span>)<br>Martin(<span class="hljs-number">1.126</span>,<span class="hljs-number">1126</span>,<span class="hljs-number">-1126</span>,<span class="hljs-number">10000</span>)<br>Martin(<span class="hljs-number">11.26</span>,<span class="hljs-number">112.6</span>,<span class="hljs-number">-10</span>,<span class="hljs-number">10000</span>)<br>Martin(<span class="hljs-number">-112.6</span>,<span class="hljs-number">17</span>,<span class="hljs-number">4</span>,<span class="hljs-number">10000</span>)<br></code></pre></td></tr></table></figure><img src="/2021/02/24/matlab1/25-1.png" alt="5-1" style="zoom:80%;"><img src="/2021/02/24/matlab1/25-2.png" alt="5-2" style="zoom:80%;"><img src="/2021/02/24/matlab1/25-3.png" alt="5-3" style="zoom:80%;"><img src="/2021/02/24/matlab1/25-4.png" alt="5-4" style="zoom:80%;"><img src="/2021/02/24/matlab1/25-5.png" alt="5-5" style="zoom:80%;"><h3 id="6-1"><a href="#6-1" class="headerlink" title="6"></a>6</h3><p>å¯»æ‰¾åˆ†å¼å‡½æ•°$f(x)&#x3D;\dfrac{ax+b}{cx^2+dx+e}$ï¼Œä½¿å®ƒäº§ç”Ÿçš„è¿­ä»£åºåˆ—æ”¶æ•›åˆ°$\sqrt[3]{1126}$ã€‚å¦‚æœè¿­ä»£æ”¶æ•›ï¼Œé‚£ä¹ˆè¿­ä»£çš„åˆå€¼å’Œæ”¶æ•›çš„é€Ÿåº¦æˆä»€ä¹ˆå…³ç³»ï¼Ÿ</p><p>æ ¹æ®é¢˜ç›®æˆ‘ä»¬å¯ä»¥çŸ¥é“$\sqrt[3]{1126}$æ˜¯æ–¹ç¨‹$f(x)&#x3D;x$çš„è§£ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>cx^3+dx^2+(e-a)x-b&#x3D;0<br>$$<br>å¾ˆæ˜¾ç„¶ï¼Œä¸‰æ¬¡æ ¹å·åªèƒ½é€šè¿‡ç›´æ¥å¼€ä¸‰æ¬¡æ ¹å·å®ç°ï¼Œå› æ­¤$c&#x3D;1,b&#x3D;1126$ã€‚ä¸ºä¿è¯è¿™ä¸ªï¼Œåªæœ‰$d&#x3D;0,e&#x3D;a$ã€‚</p><p>ä¸è¿‡ï¼Œè¿™é‡Œæœ‰ä¸ªå°ç»†èŠ‚ï¼Œä¸ºäº†ä¿è¯ç‚¹æœ€åæ”¶æ•›äºæˆ‘ä»¬çš„æœŸæœ›å€¼ï¼Œå› æ­¤æˆ‘ä»¬æœŸæœ›å€¼çš„å¯¼æ•°çš„ç»å¯¹å€¼è¦å°äº$1$ã€‚è¿™é‡Œæˆ‘ä»¬é€šè¿‡è¯•éªŒï¼Œé€‰å–çš„å€¼ä¸º$500$</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs matlab"><span class="hljs-comment">%æ±‚æ”¶æ•›å€¼çš„ç¨‹åº</span><br>syms x;<br>f=inline(<span class="hljs-string">&#x27;(500*x+1126)/(x^2+500)&#x27;</span>);<br>x1=<span class="hljs-number">-1</span>;<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">1</span>:<span class="hljs-number">15</span><br>x1=f(x1);<br>fprintf(<span class="hljs-string">&#x27;%g,%.8f\n&#x27;</span>,<span class="hljs-built_in">i</span>,x1);<br><span class="hljs-keyword">end</span><br><span class="hljs-number">1</span>,<span class="hljs-number">1.24950100</span><br><span class="hljs-number">2</span>,<span class="hljs-number">3.49060158</span><br><span class="hljs-number">3</span>,<span class="hljs-number">5.60599142</span><br><span class="hljs-number">4</span>,<span class="hljs-number">7.39329141</span><br><span class="hljs-number">5</span>,<span class="hljs-number">8.69476637</span><br><span class="hljs-number">6</span>,<span class="hljs-number">9.50902199</span><br><span class="hljs-number">7</span>,<span class="hljs-number">9.95985241</span><br><span class="hljs-number">8</span>,<span class="hljs-number">10.19015330</span><br><span class="hljs-number">9</span>,<span class="hljs-number">10.30253816</span><br><span class="hljs-number">10</span>,<span class="hljs-number">10.35609816</span><br><span class="hljs-number">11</span>,<span class="hljs-number">10.38132871</span><br><span class="hljs-number">12</span>,<span class="hljs-number">10.39314826</span><br><span class="hljs-number">13</span>,<span class="hljs-number">10.39867078</span><br><span class="hljs-number">14</span>,<span class="hljs-number">10.40124793</span><br><span class="hljs-number">15</span>,<span class="hljs-number">10.40244990</span><br><span class="hljs-comment">%æ±‚å¯¼æ•°ç¨‹åº</span><br>syms x;<br>y=(<span class="hljs-number">500</span>*x+<span class="hljs-number">1126</span>)/(x^<span class="hljs-number">2</span>+<span class="hljs-number">500</span>);<br>dy=diff(y,x);<br>double(subs(dy,x,<span class="hljs-number">1126</span>^(<span class="hljs-number">1</span>/<span class="hljs-number">3</span>)))<br></code></pre></td></tr></table></figure><p>å¦‚æœè¿­ä»£åˆå€¼çš„å‡½æ•°å€¼è¶Šæ¥è¿‘äºå‡½æ•°çš„å¸å¼•ç‚¹çš„æ¨ªåæ ‡ï¼Œé‚£ä¹ˆæ”¶æ•›çš„é€Ÿåº¦è¶Šå¿«ã€‚</p><h2 id="Div-3"><a href="#Div-3" class="headerlink" title="Div 3"></a>Div 3</h2><h3 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h3><p><img src="/2021/02/24/matlab1/3T1.png" alt="T1"></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs matlab">syms n<br>A=[<span class="hljs-number">4</span>,<span class="hljs-number">1</span>;<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br>x=[<span class="hljs-number">1</span>;<span class="hljs-number">2</span>];<br>[P,D]=eig(sym(A))<br>P =<br>[ <span class="hljs-number">-1</span>/<span class="hljs-number">2</span>, <span class="hljs-number">1</span>]<br>[    <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]<br>D =<br>[ <span class="hljs-number">2</span>, <span class="hljs-number">0</span>]<br>[ <span class="hljs-number">0</span>, <span class="hljs-number">5</span>]<br>An=P*D^n*(P^<span class="hljs-number">-1</span>)<br>[     <span class="hljs-number">2</span>^n/<span class="hljs-number">3</span> + (<span class="hljs-number">2</span>*<span class="hljs-number">5</span>^n)/<span class="hljs-number">3</span>,     <span class="hljs-number">5</span>^n/<span class="hljs-number">3</span> - <span class="hljs-number">2</span>^n/<span class="hljs-number">3</span>]<br>[ (<span class="hljs-number">2</span>*<span class="hljs-number">5</span>^n)/<span class="hljs-number">3</span> - (<span class="hljs-number">2</span>*<span class="hljs-number">2</span>^n)/<span class="hljs-number">3</span>, (<span class="hljs-number">2</span>*<span class="hljs-number">2</span>^n)/<span class="hljs-number">3</span> + <span class="hljs-number">5</span>^n/<span class="hljs-number">3</span>]<br>xn=An*x<br>     (<span class="hljs-number">4</span>*<span class="hljs-number">5</span>^n)/<span class="hljs-number">3</span> - <span class="hljs-number">2</span>^n/<span class="hljs-number">3</span><br> (<span class="hljs-number">2</span>*<span class="hljs-number">2</span>^n)/<span class="hljs-number">3</span> + (<span class="hljs-number">4</span>*<span class="hljs-number">5</span>^n)/<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h3 id="2-2"><a href="#2-2" class="headerlink" title="2"></a>2</h3><p>å°†ä¸Šé¢çš„çŸ©é˜µç¬¬ä¸€è¡Œæ”¹ä¸º$0.4,0.2$ï¼Œç¬¬äºŒè¡Œæ”¹ä¸º$0.1,0.3$ï¼Œå†åšä¸€æ¬¡å®éªŒæ±‚$x$é€šé¡¹ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs matlab">syms n<br>A=[<span class="hljs-number">0.4</span>,<span class="hljs-number">0.2</span>;<span class="hljs-number">0.1</span>,<span class="hljs-number">0.3</span>];<br>x=[<span class="hljs-number">1</span>;<span class="hljs-number">2</span>];<br>[P,D]=eig(sym(A))<br>P =<br>[ <span class="hljs-number">-1</span>, <span class="hljs-number">2</span>]<br>[  <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]<br>D =<br>[ <span class="hljs-number">1</span>/<span class="hljs-number">5</span>,   <span class="hljs-number">0</span>]<br>[   <span class="hljs-number">0</span>, <span class="hljs-number">1</span>/<span class="hljs-number">2</span>]<br>An=P*D^n*(P^<span class="hljs-number">-1</span>)<br>An =<br>[ (<span class="hljs-number">2</span>*(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)^n)/<span class="hljs-number">3</span> + (<span class="hljs-number">1</span>/<span class="hljs-number">5</span>)^n/<span class="hljs-number">3</span>, (<span class="hljs-number">2</span>*(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)^n)/<span class="hljs-number">3</span> - (<span class="hljs-number">2</span>*(<span class="hljs-number">1</span>/<span class="hljs-number">5</span>)^n)/<span class="hljs-number">3</span>]<br>[     (<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)^n/<span class="hljs-number">3</span> - (<span class="hljs-number">1</span>/<span class="hljs-number">5</span>)^n/<span class="hljs-number">3</span>,     (<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)^n/<span class="hljs-number">3</span> + (<span class="hljs-number">2</span>*(<span class="hljs-number">1</span>/<span class="hljs-number">5</span>)^n)/<span class="hljs-number">3</span>]<br>xn=An*x<br>xn=<br> <span class="hljs-number">2</span>*(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)^n - (<span class="hljs-number">1</span>/<span class="hljs-number">5</span>)^n<br>   (<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)^n + (<span class="hljs-number">1</span>/<span class="hljs-number">5</span>)^n<br></code></pre></td></tr></table></figure><h3 id="3-2"><a href="#3-2" class="headerlink" title="3"></a>3</h3><p><img src="/2021/02/24/matlab1/3T3.png" alt="T3"></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs matlab">A=[<span class="hljs-number">4</span>,<span class="hljs-number">1</span>;<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br>a=[];<br>x=<span class="hljs-number">2</span>*<span class="hljs-built_in">rand</span>(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)<span class="hljs-number">-1</span>;<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">30</span><br>a(<span class="hljs-built_in">i</span>,<span class="hljs-number">1</span>:<span class="hljs-number">2</span>)=x;<br>x=A*x;<br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">20</span><br><span class="hljs-keyword">if</span> a(<span class="hljs-built_in">i</span>,<span class="hljs-number">1</span>)==<span class="hljs-number">0</span><br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span> t=a(<span class="hljs-built_in">i</span>,<span class="hljs-number">2</span>)/a(<span class="hljs-built_in">i</span>,<span class="hljs-number">1</span>);<br>fprintf(<span class="hljs-string">&#x27;%g  %g\n&#x27;</span>,<span class="hljs-built_in">i</span>,t);<br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><span class="hljs-comment">%ä»¥ä¸‹ä¸ºè¾“å‡ºç»“æœ</span><br><span class="hljs-number">1</span>  <span class="hljs-number">1.28936</span><br><span class="hljs-number">2</span>  <span class="hljs-number">1.10941</span><br><span class="hljs-number">3</span>  <span class="hljs-number">1.04283</span><br><span class="hljs-number">4</span>  <span class="hljs-number">1.01699</span><br><span class="hljs-number">5</span>  <span class="hljs-number">1.00677</span><br><span class="hljs-number">6</span>  <span class="hljs-number">1.0027</span><br><span class="hljs-number">7</span>  <span class="hljs-number">1.00108</span><br><span class="hljs-number">8</span>  <span class="hljs-number">1.00043</span><br><span class="hljs-number">9</span>  <span class="hljs-number">1.00017</span><br><span class="hljs-number">10</span>  <span class="hljs-number">1.00007</span><br><span class="hljs-number">11</span>  <span class="hljs-number">1.00003</span><br><span class="hljs-number">12</span>  <span class="hljs-number">1.00001</span><br><span class="hljs-number">13</span>  <span class="hljs-number">1</span><br><span class="hljs-number">14</span>  <span class="hljs-number">1</span><br><span class="hljs-number">15</span>  <span class="hljs-number">1</span><br><span class="hljs-number">16</span>  <span class="hljs-number">1</span><br><span class="hljs-number">17</span>  <span class="hljs-number">1</span><br><span class="hljs-number">18</span>  <span class="hljs-number">1</span><br><span class="hljs-number">19</span>  <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ•°åˆ—æœ€ç»ˆæ”¶æ•›äº$1$ã€‚</p><h3 id="4-2"><a href="#4-2" class="headerlink" title="4"></a>4</h3><p>$x_n,y_n,m(x_n)$æé™éƒ½å­˜åœ¨ï¼Œè§ä»£ç ï¼š</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs matlab">A=[<span class="hljs-number">2.1</span>,<span class="hljs-number">3.4</span>,<span class="hljs-number">-1.2</span>,<span class="hljs-number">2.3</span>;<span class="hljs-number">0.8</span>,<span class="hljs-number">-0.3</span>,<span class="hljs-number">4.1</span>,<span class="hljs-number">2.8</span>;<span class="hljs-number">2.3</span>,<span class="hljs-number">7.9</span>,<span class="hljs-number">-1.5</span>,<span class="hljs-number">1.4</span>;<span class="hljs-number">3.5</span>,<span class="hljs-number">7.2</span>,<span class="hljs-number">1.7</span>,<span class="hljs-number">-9</span>];<br>x0=[<span class="hljs-number">1</span>;<span class="hljs-number">2</span>;<span class="hljs-number">3</span>;<span class="hljs-number">4</span>];<br>x=A*x0;<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">1</span>:<span class="hljs-number">100</span><br>a=<span class="hljs-built_in">max</span>(x);<br>b=<span class="hljs-built_in">min</span>(x);<br>m=a*(<span class="hljs-built_in">abs</span>(a)&gt;<span class="hljs-built_in">abs</span>(b))+b*(<span class="hljs-built_in">abs</span>(a)&lt;=<span class="hljs-built_in">abs</span>(b));<br>y=x/m;<br>x=A*y;<br><span class="hljs-keyword">end</span><br><span class="hljs-comment">%ä»¥ä¸‹ä¸ºç»“æœ</span><br>x =<br>    <span class="hljs-number">0.9819</span><br>    <span class="hljs-number">3.2889</span><br>   <span class="hljs-number">-1.2890</span><br>  <span class="hljs-number">-11.2213</span><br>y =<br>   <span class="hljs-number">-0.0875</span><br>   <span class="hljs-number">-0.2931</span><br>    <span class="hljs-number">0.1149</span><br>    <span class="hljs-number">1.0000</span><br>m =<br>  <span class="hljs-number">-11.2213</span><br></code></pre></td></tr></table></figure><h3 id="5-2"><a href="#5-2" class="headerlink" title="5"></a>5</h3><p>æ±‚å‡ºä¸Šä¸€é¢˜çŸ©é˜µ$A$çš„æ‰€æœ‰ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ï¼Œå¹¶ä¸ä¸Šä¸€é¢˜çš„ç»“è®ºåšå¯¹æ¯”</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs matlab">A=[<span class="hljs-number">2.1</span>,<span class="hljs-number">3.4</span>,<span class="hljs-number">-1.2</span>,<span class="hljs-number">2.3</span>;<span class="hljs-number">0.8</span>,<span class="hljs-number">-0.3</span>,<span class="hljs-number">4.1</span>,<span class="hljs-number">2.8</span>;<span class="hljs-number">2.3</span>,<span class="hljs-number">7.9</span>,<span class="hljs-number">-1.5</span>,<span class="hljs-number">1.4</span>;<span class="hljs-number">3.5</span>,<span class="hljs-number">7.2</span>,<span class="hljs-number">1.7</span>,<span class="hljs-number">-9</span>];<br>[P,D]=eig(A)<br>P =<br>    <span class="hljs-number">0.3779</span>    <span class="hljs-number">0.8848</span>   <span class="hljs-number">-0.0832</span>    <span class="hljs-number">0.3908</span><br>    <span class="hljs-number">0.5367</span>   <span class="hljs-number">-0.3575</span>   <span class="hljs-number">-0.2786</span>   <span class="hljs-number">-0.4777</span><br>    <span class="hljs-number">0.6473</span>   <span class="hljs-number">-0.2988</span>    <span class="hljs-number">0.1092</span>    <span class="hljs-number">0.7442</span><br>    <span class="hljs-number">0.3874</span>    <span class="hljs-number">0.0015</span>    <span class="hljs-number">0.9505</span>   <span class="hljs-number">-0.2555</span><br>D =<br>    <span class="hljs-number">7.2300</span>         <span class="hljs-number">0</span>         <span class="hljs-number">0</span>         <span class="hljs-number">0</span><br>         <span class="hljs-number">0</span>    <span class="hljs-number">1.1352</span>         <span class="hljs-number">0</span>         <span class="hljs-number">0</span><br>         <span class="hljs-number">0</span>         <span class="hljs-number">0</span>  <span class="hljs-number">-11.2213</span>         <span class="hljs-number">0</span><br>         <span class="hljs-number">0</span>         <span class="hljs-number">0</span>         <span class="hljs-number">0</span>   <span class="hljs-number">-5.8439</span><br></code></pre></td></tr></table></figure><p>$A$ä¸­ç»å¯¹å€¼æœ€å¤§çš„ç‰¹å¾å€¼ç­‰äº$m(x_n)$çš„æé™å€¼ã€‚</p><p>å¹¶ä¸”$P$çš„ç‰¹å¾å€¼$-11.2213$å¯¹åº”çš„ç‰¹å¾å‘é‡çº¦ä¸ºä¸Šé¢˜ä¸­å‘é‡$\vec y$çš„$\dfrac{20}{19}$å€ã€‚</p><h3 id="6-2"><a href="#6-2" class="headerlink" title="6"></a>6</h3><p>å·²çŸ¥çŸ©é˜µ$A&#x3D;[0.75,0.5,0.25;0.125,0.25,0.5;0.125,0.25,0.25]$ä¸ºå¤©æ°”çŸ©é˜µï¼Œå‘é‡$\vec p_0&#x3D;(0.5,0.25,0.25)^T$ï¼Œæ±‚å‡ºè‹¥å¹²å¤©ä¹‹åçš„å¤©æ°”æƒ…å†µï¼Œä¿ç•™$4$ä½å°æ•°ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs matlab">A=[<span class="hljs-number">3</span>/<span class="hljs-number">4</span>,<span class="hljs-number">1</span>/<span class="hljs-number">2</span>,<span class="hljs-number">1</span>/<span class="hljs-number">4</span>;<span class="hljs-number">1</span>/<span class="hljs-number">8</span>,<span class="hljs-number">1</span>/<span class="hljs-number">4</span>,<span class="hljs-number">1</span>/<span class="hljs-number">2</span>;<span class="hljs-number">1</span>/<span class="hljs-number">8</span>,<span class="hljs-number">1</span>/<span class="hljs-number">4</span>,<span class="hljs-number">1</span>/<span class="hljs-number">4</span>];<br>P=[<span class="hljs-number">0.5</span>;<span class="hljs-number">0.25</span>;<span class="hljs-number">0.25</span>];<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">1</span>:<span class="hljs-number">25</span><br>P(:,<span class="hljs-built_in">i</span>+<span class="hljs-number">1</span>)=A*P(:,<span class="hljs-built_in">i</span>);<br><span class="hljs-keyword">end</span><br>P<br><span class="hljs-comment">%ä»¥ä¸‹ä¸ºè¾“å‡ºç»“æœ</span><br>  åˆ— <span class="hljs-number">1</span> è‡³ <span class="hljs-number">10</span><br>    <span class="hljs-number">0.5000</span>    <span class="hljs-number">0.5625</span>    <span class="hljs-number">0.5938</span>    <span class="hljs-number">0.6035</span>    <span class="hljs-number">0.6069</span>    <span class="hljs-number">0.6081</span>    <span class="hljs-number">0.6085</span>    <span class="hljs-number">0.6086</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span><br>    <span class="hljs-number">0.2500</span>    <span class="hljs-number">0.2500</span>    <span class="hljs-number">0.2266</span>    <span class="hljs-number">0.2207</span>    <span class="hljs-number">0.2185</span>    <span class="hljs-number">0.2178</span>    <span class="hljs-number">0.2175</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span><br>    <span class="hljs-number">0.2500</span>    <span class="hljs-number">0.1875</span>    <span class="hljs-number">0.1797</span>    <span class="hljs-number">0.1758</span>    <span class="hljs-number">0.1746</span>    <span class="hljs-number">0.1741</span>    <span class="hljs-number">0.1740</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span><br>  åˆ— <span class="hljs-number">11</span> è‡³ <span class="hljs-number">20</span><br>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span><br>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span><br>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span><br>  åˆ— <span class="hljs-number">21</span> è‡³ <span class="hljs-number">26</span><br>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span>    <span class="hljs-number">0.6087</span><br>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span>    <span class="hljs-number">0.2174</span><br>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span>    <span class="hljs-number">0.1739</span><br></code></pre></td></tr></table></figure><p>å¾—å‡ºç»“è®ºï¼šç¬¬$9$å¤©å¼€å§‹ï¼Œå¤©æ°”å‘é‡ç¨³å®šäº$(0.6087,0.2174,0.1739)^T$. <del>æ€»æ„Ÿè§‰æœ€åç»“æœä¸­çš„ç¬¬ä¸€ä¸ªåˆ†é‡ç¼ºäº†ç‚¹ä»€ä¹ˆ</del>ã€‚</p><h3 id="7-1"><a href="#7-1" class="headerlink" title="7"></a>7</h3><p>æ±‚å‡ºç¬¬å…­é¢˜çš„çŸ©é˜µ$A$çš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ï¼Œå¹¶ä¸æœ€ç»ˆçš„ç»“è®ºè¿›è¡Œå¯¹æ¯”ã€‚</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs matlab">A=[<span class="hljs-number">3</span>/<span class="hljs-number">4</span>,<span class="hljs-number">1</span>/<span class="hljs-number">2</span>,<span class="hljs-number">1</span>/<span class="hljs-number">4</span>;<span class="hljs-number">1</span>/<span class="hljs-number">8</span>,<span class="hljs-number">1</span>/<span class="hljs-number">4</span>,<span class="hljs-number">1</span>/<span class="hljs-number">2</span>;<span class="hljs-number">1</span>/<span class="hljs-number">8</span>,<span class="hljs-number">1</span>/<span class="hljs-number">4</span>,<span class="hljs-number">1</span>/<span class="hljs-number">4</span>];<br>[P,D]=eig(A)<br>P =<br><br>   <span class="hljs-number">-0.9094</span>   <span class="hljs-number">-0.8069</span>    <span class="hljs-number">0.3437</span><br>   <span class="hljs-number">-0.3248</span>    <span class="hljs-number">0.5116</span>   <span class="hljs-number">-0.8133</span><br>   <span class="hljs-number">-0.2598</span>    <span class="hljs-number">0.2953</span>    <span class="hljs-number">0.4695</span><br>D =<br><br>    <span class="hljs-number">1.0000</span>         <span class="hljs-number">0</span>         <span class="hljs-number">0</span><br>         <span class="hljs-number">0</span>    <span class="hljs-number">0.3415</span>         <span class="hljs-number">0</span><br>         <span class="hljs-number">0</span>         <span class="hljs-number">0</span>   <span class="hljs-number">-0.0915</span><br></code></pre></td></tr></table></figure><p>çŸ©é˜µ$A$æœ‰ç‰¹å¾å€¼$1$ï¼Œå¯¹åº”å‘é‡æ˜¯$\alpha&#x3D;(-0.9094,-0.3248,-0.2598)^T$ï¼Œä¸Šé¢˜ä¸­çš„æœ€ç»ˆç»“æœæ°å¥½æ˜¯$\alpha$çš„$0.6696$å€ã€‚</p><h3 id="8-1"><a href="#8-1" class="headerlink" title="8"></a>8</h3><p><code>A=[3/4,7/18;1/4,11/18]</code>ï¼Œè®¾ $p_1$,$ p_2$ ä¸º $A$ çš„ ä¸¤ ä¸ª çº¿ æ€§ æ—  å…³ çš„ ç‰¹ å¾ å‘ é‡ ï¼Œ è‹¥$p^{(0)}&#x3D;(0.5,0.5)^T$ã€‚å…·ä½“æ±‚å‡ºä¸Šè¿°çš„$u$, $v$ ï¼Œå°† $p^(0)$ è¡¨ç¤ºæˆ $p_1$,$ p_2 $çš„çº¿æ€§ç»„åˆï¼Œ æ±‚ $p^{(k)}$ çš„å…·ä½“è¡¨è¾¾å¼ï¼Œå¹¶æ±‚ $k\rightarrow +âˆ$ æ—¶$ p^{(k)}$ çš„æé™ï¼Œä¸å·²çŸ¥ç»“è®ºä½œæ¯”è¾ƒ.</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs matlab">A=[<span class="hljs-number">0.75</span>,<span class="hljs-number">7</span>/<span class="hljs-number">18</span>;<span class="hljs-number">0.25</span>,<span class="hljs-number">11</span>/<span class="hljs-number">18</span>];<br>p0=[<span class="hljs-number">0.5</span>;<span class="hljs-number">0.5</span>];<br>[P,D]=eig(sym(A));<br>B=sym(P^<span class="hljs-number">-1</span>)*p0<br>B =<br> <span class="hljs-number">5</span>/<span class="hljs-number">46</span><br> <span class="hljs-number">9</span>/<span class="hljs-number">23</span><br>syms k<br>pk=B(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)*D(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) .^ k*P(:,<span class="hljs-number">1</span>)+B(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)*D(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>) .^ k*P(:,<span class="hljs-number">2</span>)<br>pk =<br> <span class="hljs-number">14</span>/<span class="hljs-number">23</span> - (<span class="hljs-number">5</span>*(<span class="hljs-number">13</span>/<span class="hljs-number">36</span>)^k)/<span class="hljs-number">46</span><br>  (<span class="hljs-number">5</span>*(<span class="hljs-number">13</span>/<span class="hljs-number">36</span>)^k)/<span class="hljs-number">46</span> + <span class="hljs-number">9</span>/<span class="hljs-number">23</span><br>vpa(limit(pk,k,<span class="hljs-number">100</span>),<span class="hljs-number">10</span>)<br><span class="hljs-built_in">ans</span> =<br> <span class="hljs-number">0.6086956522</span><br> <span class="hljs-number">0.3913043478</span><br></code></pre></td></tr></table></figure><p>ç»“è®ºï¼šä¸ä¸Šè¯¾æ—¶è¿­ä»£å‡ºæ¥çš„æé™å€¼æ˜¯ä¸€æ ·çš„ã€‚</p><h2 id="Div-4"><a href="#Div-4" class="headerlink" title="Div 4"></a>Div 4</h2><h3 id="1-3"><a href="#1-3" class="headerlink" title="1"></a>1</h3><p>ç”¨æ±‚å®šç§¯åˆ†çš„ Monte Carlo æ³•è¿‘ä¼¼è®¡ç®—$\pi$</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs matlab">n=<span class="hljs-number">500000</span>;<br>kount=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:n<br>x=<span class="hljs-built_in">rand</span>;y=<span class="hljs-built_in">rand</span>;<br><span class="hljs-keyword">if</span>(x^<span class="hljs-number">2</span>+y^<span class="hljs-number">2</span>&lt;=<span class="hljs-number">1</span>)<br>kount=kount+<span class="hljs-number">1</span>;<br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><span class="hljs-built_in">ans</span>=<span class="hljs-number">4</span>*kount/n<br><span class="hljs-comment">%ä¸‰æ¬¡è¿è¡Œç»“æœï¼š3.1398 3.1424 3.1507</span><br></code></pre></td></tr></table></figure><h3 id="2-3"><a href="#2-3" class="headerlink" title="2"></a>2</h3><p>æ ¹æ®ä»»å–ä¸€å¯¹æ­£æ•´æ•°äº’è´¨æ¦‚ç‡çš„è®¨è®ºç»“æœï¼Œç°é€‰å–$112600$ å¯¹éšæœºçš„ $a,b$ æ±‚å‡º$\pi$ çš„è¿‘ä¼¼å€¼ã€‚</p><p>æç¤ºï¼š(1)æœ€å¤§å…¬çº¦æ•°çš„å‘½ä»¤:<code>gcd(a,b)</code> </p><p>(2)<code>randint(1,1,[u,v])</code>äº§ç”Ÿä¸€ä¸ªåœ¨$[u,v]$åŒºé—´ä¸Šçš„éšæœºæ•´æ•°</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs matlab">kount=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>:<span class="hljs-number">112600</span><br>a=<span class="hljs-built_in">ceil</span>(<span class="hljs-built_in">rand</span>*<span class="hljs-number">500000000</span>);<br>b=<span class="hljs-built_in">ceil</span>(<span class="hljs-built_in">rand</span>*<span class="hljs-number">500000000</span>);<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">gcd</span>(a,b)==<span class="hljs-number">1</span>;<br>kount=kount+<span class="hljs-number">1</span>;<br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><span class="hljs-built_in">sqrt</span>(<span class="hljs-number">6</span>*<span class="hljs-number">112600</span>/kount)<br><span class="hljs-comment">%ä¸‰æ¬¡è¿è¡Œç»“æœï¼š3.1377 3.1464 3.1394</span><br></code></pre></td></tr></table></figure><h3 id="3-3"><a href="#3-3" class="headerlink" title="3"></a>3</h3><p>æ±‚æ»¡è¶³$c-b&#x3D;2,c&lt;1000$çš„æ‰€æœ‰å‹¾è‚¡æ•°ï¼Œèƒ½å¦ç±»ä¼¼äºä¹¦ä¸­çš„ï¼ˆ11.8ï¼‰ï¼Œ </p><p>æŠŠå®ƒä»¬ç”¨ä¸€ä¸ªå…¬å¼è¡¨ç¤ºå‡ºæ¥ï¼Ÿå…¬å¼:$a&#x3D;2(u+1),b&#x3D;u^2+2u,c&#x3D;u^2+2u+2$</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs matlab"><span class="hljs-keyword">for</span> b=<span class="hljs-number">1</span>:<span class="hljs-number">998</span><br>a=<span class="hljs-built_in">sqrt</span>((b+<span class="hljs-number">2</span>)^<span class="hljs-number">2</span>-b^<span class="hljs-number">2</span>);<br><span class="hljs-keyword">if</span>(a==<span class="hljs-built_in">floor</span>(a))<br>fprintf(<span class="hljs-string">&#x27;%d  %d  %d\n&#x27;</span>,a,b,b+<span class="hljs-number">2</span>)<br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><span class="hljs-comment">%ä»¥ä¸‹ä¸ºè¿è¡Œç»“æœ</span><br><span class="hljs-number">4</span>  <span class="hljs-number">3</span>  <span class="hljs-number">5</span><br><span class="hljs-number">6</span>  <span class="hljs-number">8</span>  <span class="hljs-number">10</span><br><span class="hljs-number">8</span>  <span class="hljs-number">15</span>  <span class="hljs-number">17</span><br><span class="hljs-number">10</span>  <span class="hljs-number">24</span>  <span class="hljs-number">26</span><br><span class="hljs-number">12</span>  <span class="hljs-number">35</span>  <span class="hljs-number">37</span><br><span class="hljs-number">14</span>  <span class="hljs-number">48</span>  <span class="hljs-number">50</span><br><span class="hljs-number">16</span>  <span class="hljs-number">63</span>  <span class="hljs-number">65</span><br><span class="hljs-number">18</span>  <span class="hljs-number">80</span>  <span class="hljs-number">82</span><br><span class="hljs-number">20</span>  <span class="hljs-number">99</span>  <span class="hljs-number">101</span><br><span class="hljs-number">22</span>  <span class="hljs-number">120</span>  <span class="hljs-number">122</span><br><span class="hljs-number">24</span>  <span class="hljs-number">143</span>  <span class="hljs-number">145</span><br><span class="hljs-number">26</span>  <span class="hljs-number">168</span>  <span class="hljs-number">170</span><br><span class="hljs-number">28</span>  <span class="hljs-number">195</span>  <span class="hljs-number">197</span><br><span class="hljs-number">30</span>  <span class="hljs-number">224</span>  <span class="hljs-number">226</span><br><span class="hljs-number">32</span>  <span class="hljs-number">255</span>  <span class="hljs-number">257</span><br><span class="hljs-number">34</span>  <span class="hljs-number">288</span>  <span class="hljs-number">290</span><br><span class="hljs-number">36</span>  <span class="hljs-number">323</span>  <span class="hljs-number">325</span><br><span class="hljs-number">38</span>  <span class="hljs-number">360</span>  <span class="hljs-number">362</span><br><span class="hljs-number">40</span>  <span class="hljs-number">399</span>  <span class="hljs-number">401</span><br><span class="hljs-number">42</span>  <span class="hljs-number">440</span>  <span class="hljs-number">442</span><br><span class="hljs-number">44</span>  <span class="hljs-number">483</span>  <span class="hljs-number">485</span><br><span class="hljs-number">46</span>  <span class="hljs-number">528</span>  <span class="hljs-number">530</span><br><span class="hljs-number">48</span>  <span class="hljs-number">575</span>  <span class="hljs-number">577</span><br><span class="hljs-number">50</span>  <span class="hljs-number">624</span>  <span class="hljs-number">626</span><br><span class="hljs-number">52</span>  <span class="hljs-number">675</span>  <span class="hljs-number">677</span><br><span class="hljs-number">54</span>  <span class="hljs-number">728</span>  <span class="hljs-number">730</span><br><span class="hljs-number">56</span>  <span class="hljs-number">783</span>  <span class="hljs-number">785</span><br><span class="hljs-number">58</span>  <span class="hljs-number">840</span>  <span class="hljs-number">842</span><br><span class="hljs-number">60</span>  <span class="hljs-number">899</span>  <span class="hljs-number">901</span><br><span class="hljs-number">62</span>  <span class="hljs-number">960</span>  <span class="hljs-number">962</span><br></code></pre></td></tr></table></figure><h3 id="4-3"><a href="#4-3" class="headerlink" title="4"></a>4</h3><p>å¯¹$câ‰¤1000 ï¼Œc - b &#x3D; k(k  â‰¤200 )$ï¼Œå¯¹å“ªäº› $k$ å­˜åœ¨æœ¬åŸå‹¾è‚¡æ•°ï¼Ÿ</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs matlab"><span class="hljs-keyword">for</span> k=<span class="hljs-number">1</span>:<span class="hljs-number">200</span><br><span class="hljs-keyword">for</span> b=<span class="hljs-number">1</span>:<span class="hljs-number">999</span><br>a=<span class="hljs-built_in">sqrt</span>((b+k)^<span class="hljs-number">2</span>-b^<span class="hljs-number">2</span>);<br><span class="hljs-keyword">if</span>(a==<span class="hljs-built_in">floor</span>(a)&amp;<span class="hljs-built_in">gcd</span>(<span class="hljs-built_in">gcd</span>(a,b),b+k)==<span class="hljs-number">1</span>)<br>fprintf(<span class="hljs-string">&quot;%d\n&quot;</span>,k);<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">8</span><br><span class="hljs-number">9</span><br><span class="hljs-number">18</span><br><span class="hljs-number">25</span><br><span class="hljs-number">32</span><br><span class="hljs-number">49</span><br><span class="hljs-number">50</span><br><span class="hljs-number">72</span><br><span class="hljs-number">81</span><br><span class="hljs-number">98</span><br><span class="hljs-number">121</span><br><span class="hljs-number">128</span><br><span class="hljs-number">162</span><br><span class="hljs-number">169</span><br><span class="hljs-number">200</span><br></code></pre></td></tr></table></figure><h3 id="5-3"><a href="#5-3" class="headerlink" title="5"></a>5</h3><p><img src="/2021/02/24/matlab1/4T5.png" alt="T5"></p><table><thead><tr><th>$n$</th><th>$1$</th><th>$2$</th><th>$3$</th><th>$4$</th><th>$5$</th><th>$6$</th></tr></thead><tbody><tr><td>$p_n$</td><td>$2$</td><td>$7$</td><td>$26$</td><td>$97$</td><td>$362$</td><td>$1351$</td></tr><tr><td>$q_n$</td><td>$1$</td><td>$4$</td><td>$5$</td><td>$56$</td><td>$209$</td><td>$780$</td></tr><tr><td>$p_n+q_n$</td><td>$3$</td><td>$11$</td><td>$41$</td><td>$153$</td><td>$571$</td><td>$2131$</td></tr><tr><td>$p_n+2q_n$</td><td>$4$</td><td>$15$</td><td>$56$</td><td>$209$</td><td>$780$</td><td>$2911$</td></tr><tr><td>$p_n-q_n$</td><td>$1$</td><td>$3$</td><td>$11$</td><td>$41$</td><td>$153$</td><td>$571$</td></tr></tbody></table><p>$p_{n-1}+q_{n-1}&#x3D;p_n-q_n$ï¼Œ$q_n&#x3D;p_{n-1}+2q_{n-1}$ã€‚</p><p>æ‰€ä»¥å¯ä»¥æ¨å¯¼å‡º$p_n&#x3D;2p_{n-1}+3q_{n-1},q_n&#x3D;p_{n-1}+2q_{n-1}$</p><p>è®¾$X_n&#x3D;(p_n,q_n)^T$ï¼Œå› æ­¤å°†$X_n$å˜æ¢åˆ°$X_{n+1}$éœ€è¦ç”¨åˆ°çŸ©é˜µ$A&#x3D;[2,3;1,2]$</p>]]></content>
    
    
    <categories>
      
      <category>SelfSkills</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Skills</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ECCNotes1</title>
    <link href="/2021/02/21/ECCNotes1/"/>
    <url>/2021/02/21/ECCNotes1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ ECCçš„ç¬”è®°1"><a href="#huangx607087å­¦ä¹ ECCçš„ç¬”è®°1" class="headerlink" title="huangx607087å­¦ä¹ ECCçš„ç¬”è®°1"></a>huangx607087å­¦ä¹ ECCçš„ç¬”è®°1</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0. About"></a>0. About</h2><p>è¿™ä¸€ç³»åˆ—ç¬”è®°ä¸»è¦ä»‹ç»æ¤­åœ†æ›²çº¿å¯†ç å­¦çš„çŸ¥è¯†ã€‚</p><h2 id="1-æ¤­åœ†æ›²çº¿"><a href="#1-æ¤­åœ†æ›²çº¿" class="headerlink" title="1.æ¤­åœ†æ›²çº¿"></a>1.æ¤­åœ†æ›²çº¿</h2><p>æ¤­åœ†æ›²çº¿æ˜¯å…·æœ‰ä»¥ä¸‹æ ¼å¼çš„æ›²çº¿ï¼š<br>$$<br>y^2&#x3D;x^3+ax+b<br>$$<br>æ¤­åœ†æ›²çº¿çš„ä¸€ä¸ªæƒŠäººçš„ç‰¹ç‚¹æ˜¯ï¼Œæœ‰ä¸€ç§è‡ªç„¶çš„æ–¹æ³•ï¼Œåœ¨æ¤­åœ†æ›²çº¿ä¸Šå–ä¸¤ä¸ªç‚¹ï¼Œå¹¶â€œæ·»åŠ â€å®ƒä»¬ä»¥äº§ç”Ÿç¬¬ä¸‰ä¸ªç‚¹ã€‚åœ¨â€œæ·»åŠ â€å‘¨å›´æ”¾ç½®å¼•å·ï¼Œå› ä¸ºæˆ‘ä»¬æŒ‡çš„æ˜¯ä¸€ä¸ªæ“ä½œï¼Œå®ƒä»¥ä¸€ç§ç±»ä¼¼äºåœ¨æŸäº›æ–¹é¢æ·»åŠ çš„æ–¹å¼ç»“åˆä¸¤ç‚¹ï¼ˆå®ƒæ˜¯äº¤æ¢çš„å’Œå…³è”çš„ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªæ’ç­‰å¼ï¼‰ï¼Œä½†åœ¨å…¶ä»–æ–¹é¢ä¸æ·»åŠ éå¸¸ä¸åŒã€‚æè¿°æ¤­åœ†æ›²çº¿ä¸Šâ€œåŠ æ³•å®šå¾‹â€çš„æœ€è‡ªç„¶æ–¹æ³•æ˜¯ä½¿ç”¨å‡ ä½•ã€‚</p><p>æ¤­åœ†æ›²çº¿ä¸Šå·²çŸ¥$(x_1,y_1),(x_2,y_2)$ä¸¤ç‚¹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»¥ä¸‹å…¬å¼è®¡ç®—ç¬¬ä¸‰ç‚¹ï¼š<br>$$<br>x_3&#x3D;s^2-x_1-x_2<br>$$</p><p>$$<br>y_3&#x3D;s(x_1-x_3)-y_1<br>$$</p><p>å…¶ä¸­ï¼Œå½“ä¸¤ä¸ªç‚¹ä¸åŒæ—¶ï¼Œ$s&#x3D;\dfrac{y_2-y_1}{x_2-x_1}$ã€‚å½“ç›¸åŒçš„ä¸¤ä¸ªç‚¹ç›¸åŠ æ—¶ï¼Œ$s&#x3D;\dfrac {3x^2+a}{2y}$ã€‚å¹¶ä¸”å‡å¦‚ç‚¹$M$æ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„ä¸€ç‚¹ï¼Œé‚£ä¹ˆ$M+M$ä¹Ÿå¯ä»¥å†™ä½œ$2M$ã€‚</p><p>ç”±äºæ¤­åœ†æ›²çº¿æ˜¯å…³äº$x$çš„ä¸‰æ¬¡æ›²çº¿ï¼Œå› æ­¤ä»»æ„ç”»ä¸€æ¡ç›´çº¿$y&#x3D;kx+b$ï¼Œä¸æ¤­åœ†æ›²çº¿è”ç«‹æ–¹ç¨‹ç»„ï¼Œéƒ½ä¼šæœ‰ä¸‰ä¸ªæ ¹ã€‚è€Œè¿™ä¸‰ä¸ªæ ¹çš„å’Œæ°å¥½ä¸º$O$ï¼Œå…¶ä¸­$O$æ˜¯åæ ‡çº¸ä¸Šä¸€ä¸ªæ— ç©·è¿œçš„ç‚¹ï¼Œåˆè¢«ç§°ä¸ºæºç‚¹ã€‚</p><p>å› æ­¤ï¼Œæ¤­åœ†æ›²çº¿è¿˜æ»¡è¶³ä»¥ä¸‹å››æ¡è¿ç®—å¾‹ï¼š$O+P&#x3D;P,P+(-P)&#x3D;O,P+Q&#x3D;Q+P$ã€‚å¹¶ä¸”å¦‚æœä¸¤ä¸ªç‚¹$P,Q$æ¨ªåæ ‡ç›¸åŒï¼Œçºµåæ ‡äº’ä¸ºç›¸åæ•°ï¼Œåˆ™$P+Q&#x3D;O$ã€‚</p><p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°å°çš„ç»“è®ºï¼Œå°±æ˜¯åœ¨ä¸è¿›è¡Œå–æ¨¡çš„æƒ…å†µä¸‹ä¸€ä¸ªç®€å•çš„ç‚¹è‡ªåŠ çš„æ—¶å€™ï¼ˆä¾‹å¦‚$y^2&#x3D;x^3+3x+5$ä¸Šçš„ç‚¹$(1,3)$ï¼‰,æ— è®ºæ˜¯$x$åæ ‡è¿˜æ˜¯$y$åæ ‡ï¼Œåˆ†å­å’Œåˆ†æ¯çš„å¢é•¿çš„æ•°é‡çº§éƒ½æ˜¯è¿…é€Ÿçš„ï¼Œè®¾$u$æ˜¯$x$åæ ‡åˆ†å­ã€$x$åæ ‡åˆ†æ¯ã€$y$åæ ‡åˆ†å­ã€$y$åæ ‡åˆ†æ¯ä¸­çš„$4$ä¸ªå€¼å¾—ä»»æ„ä¸€ä¸ªï¼Œé‚£ä¹ˆéƒ½æœ‰$\ln u$æ­£æ¯”äº$k^2$ï¼Œå…¶ä¸­$k$æ˜¯ç‚¹è‡ªåŠ çš„æ¬¡æ•°ã€‚å¹¶ä¸”ï¼Œä»»ä½•ä¸€ä¸ªæ¤­åœ†æ›²çº¿ä¸Šçš„æ•´ç‚¹éƒ½æ˜¯æœ‰é™çš„ï¼ŒåŸºæœ¬ä¸è¶…è¿‡$15$ä¸ªã€‚</p><h2 id="2-æœ‰é™åŸŸä¸­çš„æ¤­åœ†æ›²çº¿"><a href="#2-æœ‰é™åŸŸä¸­çš„æ¤­åœ†æ›²çº¿" class="headerlink" title="2.æœ‰é™åŸŸä¸­çš„æ¤­åœ†æ›²çº¿"></a>2.æœ‰é™åŸŸä¸­çš„æ¤­åœ†æ›²çº¿</h2><p>æœ‰é™åŸŸä¸­çš„æ¤­åœ†æ›²çº¿è¦æ±‚$4a^3+27b^2 \not &#x3D;0$ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ä»¥æ¤­åœ†æ›²çº¿$y^2&#x3D;x^3+x+8$ï¼Œå®šä¹‰åŸŸä¸º$GF(13)$ä¸ºä¾‹ã€‚å¯»æ‰¾ä¸Šé¢çš„ç‚¹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠ$0$åˆ°$12$çš„æ¯ä¸€ä¸ªæ•°å­—å¸¦è¿›å»è®¡ç®—$y$ï¼Œç„¶ååˆ¤æ–­$y$æ˜¯å¦ä¸ºäºŒæ¬¡å‰©ä½™å³å¯ç¡®å®šè¯¥ç‚¹æ˜¯å¦å­˜åœ¨ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°$9$ä¸ªç‚¹ï¼š$O,(1,5),(1,8),(2,3),(2,10),(9,6),(9,7),(12,2),(12,11)$ã€‚</p><p>æ ¹æ®åˆšæ‰çš„ç†è®ºï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—$(1,8)+(9,7)&#x3D;(2,10)$ã€‚å…·ä½“æ­¥éª¤è¯·è‡ªå·±æ‰‹æ“ï¼ˆ</p><p>è€ŒECCåœ¨æœ‰é™åŸŸä¸Šä¹Ÿéµå¾ªè¿™æ ·çš„è®¡ç®—æ³•åˆ™ï¼Œåªä¸è¿‡å¤šäº†ä¸€ä¸ªæ¨¡æ•°$p$ã€‚ä¸‹é¢çš„ä»£ç æ—¶è®¡ç®—$kA$çš„ä»£ç ï¼Œè¾“å…¥ç›¸å…³çš„å‚æ•°å³å¯è¿è¡Œæ±‚è§£ï¼Œä½¿ç”¨çš„ä¹Ÿæ˜¯äºŒåˆ†çš„æ–¹æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> p,a,b,k,x,y,G<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">plus1</span>(<span class="hljs-params">X,Y</span>):<br>    K=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>    s=(Y[<span class="hljs-number">1</span>]-X[<span class="hljs-number">1</span>])*inverse(Y[<span class="hljs-number">0</span>]-X[<span class="hljs-number">0</span>],p)%p<br>    K[<span class="hljs-number">0</span>]=s*s-X[<span class="hljs-number">0</span>]-Y[<span class="hljs-number">0</span>]<br>    K[<span class="hljs-number">1</span>]=s*(X[<span class="hljs-number">0</span>]-K[<span class="hljs-number">0</span>])-X[<span class="hljs-number">1</span>]<br>    K[<span class="hljs-number">0</span>]%=p<br>    K[<span class="hljs-number">1</span>]%=p<br>    <span class="hljs-keyword">return</span> K<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul2</span>(<span class="hljs-params">X</span>):<br>    Y=X<br>    s=(<span class="hljs-number">3</span>*X[<span class="hljs-number">0</span>]*X[<span class="hljs-number">0</span>]+a)*inverse(<span class="hljs-number">2</span>*X[<span class="hljs-number">1</span>],p)%p<br>    K=[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>    K[<span class="hljs-number">0</span>]=s*s-X[<span class="hljs-number">0</span>]-Y[<span class="hljs-number">0</span>]<br>    K[<span class="hljs-number">1</span>]=s*(X[<span class="hljs-number">0</span>]-K[<span class="hljs-number">0</span>])-X[<span class="hljs-number">1</span>]<br>    K[<span class="hljs-number">0</span>]%=p<br>    K[<span class="hljs-number">1</span>]%=p<br>    <span class="hljs-keyword">return</span> K<br>p=<span class="hljs-number">13</span><br>a=<span class="hljs-number">3</span><br>b=<span class="hljs-number">8</span><br>k=<span class="hljs-number">2</span><br>A=[<span class="hljs-number">1</span>,<span class="hljs-number">8</span>]<br>G=A<br>op=<span class="hljs-built_in">bin</span>(k)[<span class="hljs-number">2</span>:]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(op)):<br>    A=mul2(A)<br>    <span class="hljs-keyword">if</span>(op[i]==<span class="hljs-string">&quot;1&quot;</span>):<br>        A=plus1(A,G)<br>    <span class="hljs-built_in">print</span>(A)<br><span class="hljs-built_in">print</span>(A[<span class="hljs-number">0</span>]+A[<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure><h2 id="3-æ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°ECDLP"><a href="#3-æ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°ECDLP" class="headerlink" title="3.æ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°ECDLP"></a>3.æ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°ECDLP</h2><p>æ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°é—®é¢˜çš„å½¢å¼ä¸»è¦æ˜¯å½“çŸ¥é“ç‚¹$P,Q$çš„æ—¶å€™ï¼Œå¯»æ‰¾ä¸€ä¸ªæœªçŸ¥æ•°$n$ï¼Œä½¿å¾—<br>$$<br>Q&#x3D;nP<br>$$<br>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å†™æˆ$n&#x3D;\log_PQ$æˆ–$\dfrac {\ln (Q)}{\ln P}$</p><p>ç›®å‰æƒ³è¦åœ¨$F_p$ä¸­è§£å†³ECDLPçš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(\sqrt p)$ã€‚å› æ­¤å½“$p$éå¸¸å¤§çš„æ—¶å€™ï¼Œè®¡ç®—ECDLPä¹Ÿæ˜¯éå¸¸å›°éš¾çš„ã€‚ä¸è¿‡å¦‚æœ$p-1$æ˜¯å…‰æ»‘æ•°ï¼Œé‚£ä¹ˆä½¿ç”¨PohilgHellmanç®—æ³•ä¹Ÿæ˜¯å¯ä»¥åœ¨è¾ƒçŸ­æ—¶é—´å†…è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚</p><h2 id="4-æ¤­åœ†æ›²çº¿å¯†ç å­¦"><a href="#4-æ¤­åœ†æ›²çº¿å¯†ç å­¦" class="headerlink" title="4.æ¤­åœ†æ›²çº¿å¯†ç å­¦"></a>4.æ¤­åœ†æ›²çº¿å¯†ç å­¦</h2><h3 id="4x01-æ¤­åœ†æ›²çº¿ä¸Šçš„Diffieâ€“Hellmanå¯†é’¥äº¤æ¢"><a href="#4x01-æ¤­åœ†æ›²çº¿ä¸Šçš„Diffieâ€“Hellmanå¯†é’¥äº¤æ¢" class="headerlink" title="4x01 æ¤­åœ†æ›²çº¿ä¸Šçš„Diffieâ€“Hellmanå¯†é’¥äº¤æ¢"></a>4x01 æ¤­åœ†æ›²çº¿ä¸Šçš„Diffieâ€“Hellmanå¯†é’¥äº¤æ¢</h3><p>é¦–å…ˆå…ˆç¡®å®šä¸€ä¸ªå¤§ç´ æ•°$p$ã€ä¸€ä¸ªæ¤­åœ†æ›²çº¿è¡¨è¾¾å¼$E$å’Œæ¤­åœ†æ›²çº¿ä¸Šçš„ä¸€ç‚¹$P$ã€‚</p><p>Aliceç¡®å®šä¸€ä¸ªç§˜å¯†çš„æ•´æ•°$a$ï¼Œå¹¶è®¡ç®—$Q_A&#x3D;aP$ã€‚åŒæ—¶Bobç¡®å®šä¸€ä¸ªç§˜å¯†çš„æ•´æ•°$b$ï¼Œè®¡ç®—$Q_B&#x3D;bP$ã€‚å¹¶äº’ç›¸å‘é€$Q_A,Q_B$ã€‚</p><p>æ”¶åˆ°æ¶ˆæ¯åï¼ŒAliceè®¡ç®—$aQ_B$ï¼ŒBobè®¡ç®—$bQ_A$å³å¯ã€‚</p><h3 id="4x02æ¤­åœ†æ›²çº¿ä¸Šçš„ElGamalå…¬é’¥å¯†ç ä½“åˆ¶"><a href="#4x02æ¤­åœ†æ›²çº¿ä¸Šçš„ElGamalå…¬é’¥å¯†ç ä½“åˆ¶" class="headerlink" title="4x02æ¤­åœ†æ›²çº¿ä¸Šçš„ElGamalå…¬é’¥å¯†ç ä½“åˆ¶"></a>4x02æ¤­åœ†æ›²çº¿ä¸Šçš„ElGamalå…¬é’¥å¯†ç ä½“åˆ¶</h3><p>åœ¨ç¡®å®šä¸€ä¸ªå¤§ç´ æ•°$p$ï¼Œ$GF(p)$ä¸Šçš„ä¸€ä¸ªæ¤­åœ†æ›²çº¿$E$å’Œæ¤­åœ†æ›²çº¿ä¸Šçš„ä¸€ä¸ªç‚¹$P$ã€‚</p><p>Aliceç¡®å®šç§é’¥$a$ï¼Œå¹¶è®¡ç®—$Q&#x3D;aP$ï¼Œå¹¶å…¬å¼€å…¬é’¥$Q$ã€‚</p><p>BobåŠ å¯†æ—¶ï¼Œé€‰å–æ¤­åœ†æ›²çº¿ä¸Šçš„ä¸€ä¸ªç‚¹$M$å’Œä¸€ä¸ªéšæœºæ•°$k$ã€‚å¹¶è®¡ç®—å¯†æ–‡$C_1&#x3D;kP,C_2&#x3D;M+kQ$ï¼Œå°†å¯†æ–‡$(C_1,C_2)$å‘é€ç»™Aliceã€‚</p><p>Aliceæ”¶åˆ°å¯†æ–‡åï¼Œè®¡ç®—$C_2-aC_1$å³å¯ã€‚</p><p>ä¸‹é¢å°±æ˜¯ä½¿ç”¨$y^2&#x3D;x^3+7x+8$ï¼Œ$p&#x3D;43$è¿›è¡ŒåŠ å¯†çš„ä¾‹å­,Sagemathä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">E=EllipticCurve(GF(<span class="hljs-number">43</span>),[<span class="hljs-number">7</span>,<span class="hljs-number">8</span>])<br>G=E(<span class="hljs-number">1</span>,<span class="hljs-number">4</span>)<br><span class="hljs-comment">#Alice Prepare</span><br>a=<span class="hljs-number">10</span><br>Q=a*G<br><span class="hljs-built_in">print</span>(Q)<br><span class="hljs-comment">#(13,19)</span><br><span class="hljs-comment">#Bob Encrypt</span><br>M=E(<span class="hljs-number">4</span>,<span class="hljs-number">33</span>)  <br>k=<span class="hljs-number">13</span><br>C1=k*G<br>C2=M+k*Q<br><span class="hljs-built_in">print</span>(C1,C2)<br><span class="hljs-comment">#(1,4),(4,10)</span><br><span class="hljs-comment">#Alice Decrypt</span><br><span class="hljs-built_in">print</span>(C2-a*C1)<br><span class="hljs-comment">#(4,33)</span><br></code></pre></td></tr></table></figure><h2 id="5-GF-2-å’Œ-GF-2-k-ä¸Šçš„æ¤­åœ†æ›²çº¿"><a href="#5-GF-2-å’Œ-GF-2-k-ä¸Šçš„æ¤­åœ†æ›²çº¿" class="headerlink" title="5.$GF(2)$å’Œ$GF(2^k)$ä¸Šçš„æ¤­åœ†æ›²çº¿"></a>5.$GF(2)$å’Œ$GF(2^k)$ä¸Šçš„æ¤­åœ†æ›²çº¿</h2><p>è®¡ç®—æœºä¼šè®²äºŒè¿›åˆ¶ï¼Œæ‰€ä»¥å®ƒä»¬ç‰¹åˆ«é€‚åˆåšæ¨¡$2$çš„è®¡ç®—ã€‚ è¿™è¡¨æ˜ä½¿ç”¨æ¤­åœ†æ›²çº¿æ¨¡$2$å¯èƒ½æ›´æœ‰æ•ˆã€‚ ä¸å¹¸çš„æ˜¯ï¼Œå¦‚æœ$E$æ˜¯åœ¨$GF(2)$ä¸Šå®šä¹‰çš„æ¤­åœ†æ›²çº¿ï¼Œé‚£ä¹ˆ$E(GF(2))$æœ€å¤šåŒ…å«5ä¸ªç‚¹ï¼Œå› æ­¤$E(GF(2))$å¯¹äºå¯†ç å­¦ç›®çš„æ˜¯æ²¡æœ‰ç”¨çš„ã€‚</p><p>ç„¶è€Œï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„åŸŸï¼Œä¹Ÿå¯ä»¥ä½¿å¾—$2\equiv 0$ï¼Œè¿™ç§åŸŸå°±æ˜¯$GF(2^k)$åŸŸã€‚å¯¹äºæ¯ä¸ªç´ æ•°å¹‚$p^k$ï¼Œ$GF(p^k)$éƒ½æ˜¯ä¸€ä¸ªæœ‰$p^k$ä¸ªå…ƒç´ çš„ç´ æ•°åŸŸã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å–ä¸€æ¡æ¤­åœ†æ›²çº¿ï¼Œå®ƒçš„æ–¹ç¨‹åœ¨$GF(p^k)$ä¸­å…·æœ‰ç³»æ•°ï¼Œå¹¶è§‚å¯Ÿè¯¥æ›²çº¿ä¸Šå…·æœ‰åæ ‡çš„ç‚¹ç¾¤ã€‚åœ¨è¿™ç§æ›´ä¸€èˆ¬çš„æƒ…å†µä¸‹ï¼ŒHasseå®šç†æ˜¯æ­£ç¡®çš„ã€‚</p><p>Hasseå®šç†ï¼šåœ¨$GF(p^k)$ä¸­ï¼Œæ¤­åœ†æ›²çº¿$E(GF(p^k))$ä¸Šçš„ç‚¹æ•°ä¸º$p^k+1-t_{p^k}$ï¼Œå…¶ä¸­$t_{p^k}$çš„ç»å¯¹å€¼ä¸è¶…è¿‡$2p^{(k&#x2F;2)}$ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨å¤æ•°åŸŸ$GF(9)$ä¸­ï¼Œå¯ä»¥æ„é€ $E(GF(9)):y^2&#x3D;x^3+(1+i)x+(2+i)$ã€‚è¿™ä¸ªæ¤­åœ†æ›²çº¿ä¸Šæœ‰$10$ä¸ªç‚¹ï¼Œåˆ†åˆ«æ˜¯$(2i,1+2i),(2i,2+i),(1+i,1+i),(1+i,2+2i),(2,0),(2+i,i),(2+i,2i),(2+2i,1),(2+2i,2)$å’Œ$O$ã€‚å…¶ä¸­ç‚¹å¯ä»¥ç›¸äº’å åŠ ï¼Œåªä¸è¿‡éœ€è¦ç”¨åˆ°$i^2&#x3D;-1$å’Œè®¡ç®—æ—¶ä¸æ–­åœ°æ¨¡$3$ã€‚ä¸è¿‡æˆ‘ä»¬è¦æ³¨æ„çš„å°±æ˜¯æ„é€ æ¤­åœ†æ›²çº¿çš„æ—¶å€™ï¼Œè¦æ³¨æ„$\Delta&#x3D;-16(4A^3+27B^2)$çš„å€¼ä¸ä¸ºé›¶ï¼ˆä¸è¿‡å¤šæ•°æƒ…å†µä¸‹ï¼Œå¦‚æœä»…åšåˆ¤æ–­ï¼Œä¼šçœå»å‰é¢çš„ç³»æ•°$-16$ï¼‰ã€‚</p><p>åªè¦æˆ‘ä»¬åœ¨$2\not&#x3D;0$çš„å­—æ®µä¸­å·¥ä½œï¼Œé‚£ä¹ˆ$Î”\not &#x3D;0$æ¡ä»¶ä¸ä»»ä½•ä¸€ä¸ªå®šä¹‰éƒ½æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯å¯¹äº$GF(2^k)$å…¶ä¸­$2&#x3D;0$çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å·²ç»ä¸ºæ¯ä¸ªæ ‡å‡†æ¤­åœ†æ›²çº¿æ–¹ç¨‹å‡æ»¡è¶³$Î”&#x3D;0$ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦å¼•å…¥æ‰©å±•æ¤­åœ†æ›²çº¿æ–¹ç¨‹çš„å½¢å¼ï¼š<br>$$<br>E: y^2+a_1xy+a_3y&#x3D;x^3+a_2x^2+a_4x+a_6<br>$$<br>å…¶ä¸­ï¼Œæ¯”æˆ‘ä»¬ä¸€å¼€å§‹çš„æ¤­åœ†æ›²çº¿ï¼Œå¤šäº†$xy$äº¤å‰é¡¹ã€$y$çš„ä¸€æ¬¡é¡¹å’Œ$x$çš„äºŒæ¬¡é¡¹ã€‚å½“ç„¶ï¼Œè¿™ä¸ªæ›²çº¿ä¸Šä¹Ÿæœ‰ä¸€ä¸ªæ— ç©·è¿œçš„ç‚¹$O$ã€‚æ­¤æ—¶çš„$\Delta$æ˜¯è¿™æ ·ç®—çš„ï¼š</p><p>è®¾$b_2&#x3D;a_1^2+4a_2,b_4&#x3D;2a_4+a_1a_3,b_6&#x3D;a_3^2+4a_6,b_8&#x3D;a_6b_2-a_1a_3a_4+a_2a_3^2-a_4^2$ã€‚</p><p>é‚£ä¹ˆ$\Delta&#x3D;-b_2^2b_8-8b_4^3-27b_6^2+9b_2b_4b_6$ã€‚è™½ç„¶è¿™äº›å…¬å¼çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œä½†å®ƒä»¬å¾ˆå®¹æ˜“è®¡ç®—ï¼Œå¹¶ä¸”æ¡ä»¶$Î”\not &#x3D;0$æ­£æ˜¯ç¡®ä¿æ›²çº¿$E$æ˜¯éå¥‡å¼‚çš„å¿…è¦æ¡ä»¶ã€‚</p><p>å…³äº$E$çš„åŠ æ³•å®šå¾‹çš„å‡ ä½•å®šä¹‰ä¸æˆ‘ä»¬ä»¥å‰çš„å®šä¹‰ç›¸ä¼¼ï¼Œå”¯ä¸€çš„å˜åŒ–æ˜¯æ—§çš„åå°„æ­¥éª¤$(x,y)â†’(x,âˆ’y)$è¢«ç¨å¾®å¤æ‚çš„åå°„æ­¥éª¤æ‰€å–ä»£ï¼Œå…¶ä¸­$-y$è¢«æ›¿æ¢æˆäº†$-y-a_1x-a_3$ã€‚è€Œæ±‚ä¸€ä¸ªç‚¹çš„è´Ÿç‚¹ï¼Œä¹Ÿæ˜¯éµå¾ª$x$ä¸å˜ï¼Œ$y$æ¢æˆ$-y-a_1x-a_3$çš„æ–¹æ³•ã€‚</p><p>å½“$S(x_1,y_1),T(x_2,y_2)$ä¸¤ç‚¹ç›¸åŠ æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ï¼š<br>$$<br>x(S+T)&#x3D;(\dfrac{y_2-y_1}{x_2-x_1})^2+a_1(\dfrac{y_2-y_1}{x_2-x_1})-a_2-x_1-x_2<br>$$<br>è€Œæ±‚ä¸€ä¸ªç‚¹$(x,y)$çš„ä¸¤å€ç‚¹ï¼Œå¯ä»¥ç”¨è¿™æ ·çš„å…¬å¼ï¼š<br>$$<br>x(2S)&#x3D;\dfrac{x^4-b_4x^2-2b_6x-b_8}{4x^3+b_2x^2+4b_4x+b_6}<br>$$<br>è€Œå½“$GF(2^k)$åŸŸä¸Šè®¡ç®—çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°ä¸å¯çº¦å¤šé¡¹å¼äº†ã€‚</p><p>ä¾‹å¦‚ï¼šåœ¨$GF(8)$ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€‰å–ä¸å¯çº¦å¤šé¡¹å¼$t^3+t+1$ã€‚æ­¤æ—¶ï¼Œ$GF(8)$ä¸­çš„æ‰€æœ‰å…ƒç´ å°±è¢«é”å®šåœ¨$t$çš„ä¸è¶…è¿‡äºŒæ¬¡å¤šé¡¹å¼é‡Œé¢äº†ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªè¿™æ ·çš„æ¤­åœ†æ›²çº¿ï¼š<br>$$<br>y^2+(1+t)y\equiv x^3+(1+t^2)x+t \pmod{t^3+t+1}\text{ and }\pmod2<br>$$<br>è¿™ä¸ªä¸Šé¢ä¸€å…±æœ‰$9$ä¸ªç‚¹ï¼Œæ¯”å¦‚$(0,t),(0,1),(t,1+t),(1+t^2,t+t^2)â€¦â€¦$ç­‰ç­‰ï¼Œå½“ç„¶ï¼Œ$9$ä¸ªç‚¹é‡Œé¢è¿˜åŒ…æ‹¬ä¸€ä¸ªæ— ç©·è¿œç‚¹$O$</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—åˆ°è®¡ç®—ï¼š$(1+t^2,t+t^2)+(1+t,t)&#x3D;(1+t^2,1+t^2)$å’Œ$2(t,1+t)&#x3D;(t,0)$ã€‚</p><p>å®šä¹‰ï¼š**(p-power)Frobenius**æ˜ å°„$Ï„$æ˜¯ç”±ç®€å•è§„åˆ™å®šä¹‰çš„ä»$GF(p^k)$åˆ°è‡ªèº«çš„æ˜ å°„ï¼Œ$Ï„(a)&#x3D;a^p$ã€‚</p><p>å½“ç„¶$Ï„(a+b)&#x3D;Ï„(a)+Ï„(b),Ï„(ab)&#x3D;Ï„(a)Ï„(b)(\text{in GF(2}^k))$ã€‚å½“ç„¶ï¼Œå¯¹äºæ¤­åœ†æ›²çº¿ä¸Šçš„ä¸€ç‚¹$P(x,y)$ï¼Œä¹Ÿæœ‰$Ï„(P)&#x3D;(Ï„(x),Ï„(y))$ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œ$Ï„$å°†$E(GF(2^k))$æ˜ å°„åˆ°è‡ªèº«ï¼Œå®ƒæ»¡è¶³åŠ æ³•å®šå¾‹ã€‚ (åœ¨æ•°å­¦æœ¯è¯­ä¸­ï¼ŒFrobeniusæ˜ å°„æ˜¯$E(GF2^k)$ä¸è‡ªèº«çš„ç¾¤åŒæ€ã€‚ </p><p>$GF(p)$ä¸­æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹çš„ä¸ªæ•°$\mathrm{ind }E$åœ¨åŒºé—´$[p+1-2\sqrt p,p+1+2\sqrt p]$ä¸­ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>21Feb2</title>
    <link href="/2021/02/16/21Feb2/"/>
    <url>/2021/02/16/21Feb2/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å¼€å­¦å‰çš„åˆ‡é¢˜2"><a href="#huangx607087å¼€å­¦å‰çš„åˆ‡é¢˜2" class="headerlink" title="huangx607087å¼€å­¦å‰çš„åˆ‡é¢˜2"></a>huangx607087å¼€å­¦å‰çš„åˆ‡é¢˜2</h1><h2 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0.ç®€ä»‹"></a>0.ç®€ä»‹</h2><p>ä¹‹å‰BUUCTFä¸Šåˆ°äº†3000åˆ†ï¼Œè¿›å…¥äº†Cryptoçš„æ·±æ°´åŒºï¼Œé¢˜ç›®éš¾åº¦éƒ½æ˜¯å¾ˆå¤§çš„ï¼Œçœ‹æ¥<del>æˆ‘æ˜¯ä¸æ˜¯åªèƒ½çœ‹ç€wpææ‡‚é¢˜ç›®åå†åšé¢˜äº†ã€‚</del></p><p>ç”±äºé¢˜ç›®å¤ªéš¾<del>ï¼ˆå®é™…ä¸Šæ˜¯è‡ªå·±å¤ªèœï¼‰</del>ï¼Œè¿™ç¯‡æ–‡ç« åŸè®¡åˆ’æ˜¯12æ—¥è‡³13æ—¥å‘å¸ƒçš„ï¼Œæœ€åç›´åˆ°16æ—¥æ‰å¼€å§‹å†™ï¼Œ<del>ç„¶åç«é€Ÿå‘å¸ƒ</del>ï¼ˆå¹¶æ²¡æœ‰ï¼‰ã€‚</p><h2 id="1-BSidesSF2020-decrypto-1"><a href="#1-BSidesSF2020-decrypto-1" class="headerlink" title="1.[BSidesSF2020]decrypto-1"></a>1.[BSidesSF2020]decrypto-1</h2><p>é€šè¿‡è§‚å¯Ÿä¸‹é¢çš„ä»£ç ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™ä¸ªå®é™…ä¸Šæ˜¯å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œäº†åŠ å¯†æ“ä½œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Crypto</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, key</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(key, <span class="hljs-built_in">bytes</span>):<br>            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">&#x27;key must be of type bytes!&#x27;</span>)<br>        <span class="hljs-variable language_">self</span>.key = key<br>        <span class="hljs-variable language_">self</span>._buf = <span class="hljs-built_in">bytes</span>()<br>        <span class="hljs-variable language_">self</span>._out = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;/dev/stdout&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_extend_buf</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>._buf += <span class="hljs-variable language_">self</span>.key<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_bytes</span>(<span class="hljs-params">self, nbytes</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>._buf) &lt; nbytes:<br>            <span class="hljs-variable language_">self</span>._extend_buf()<br>        ret, <span class="hljs-variable language_">self</span>._buf = <span class="hljs-variable language_">self</span>._buf[:nbytes], <span class="hljs-variable language_">self</span>._buf[nbytes:]<br>        <span class="hljs-keyword">return</span> ret<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self, buf</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(buf, <span class="hljs-built_in">bytes</span>):<br>            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">&#x27;buf must be of type bytes!&#x27;</span>)<br>        stream = <span class="hljs-variable language_">self</span>.get_bytes(<span class="hljs-built_in">len</span>(buf))<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(buf, stream))<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_outfile</span>(<span class="hljs-params">self, fname</span>):<br>        <span class="hljs-variable language_">self</span>._out = <span class="hljs-built_in">open</span>(fname, <span class="hljs-string">&quot;wb&quot;</span>)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_file</span>(<span class="hljs-params">self, fname</span>):<br>        buf = <span class="hljs-built_in">open</span>(fname, <span class="hljs-string">&quot;rb&quot;</span>).read()<br>        <span class="hljs-variable language_">self</span>._out.write(<span class="hljs-variable language_">self</span>.encrypt(buf))<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">JSONCrypto</span>(<span class="hljs-title class_ inherited__">Crypto</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_file</span>(<span class="hljs-params">self, fname</span>):<br>        buf = <span class="hljs-built_in">open</span>(fname, <span class="hljs-string">&quot;r&quot;</span>).read().strip()<br>        h = hashlib.sha256(buf.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).hexdigest()<br>        data = &#123;<br>                <span class="hljs-string">&quot;filename&quot;</span>: fname,<br>                <span class="hljs-string">&quot;hash&quot;</span>: h,<br>                <span class="hljs-string">&quot;plaintext&quot;</span>: buf,<br>        &#125;<br>        outbuf = json.dumps(data, sort_keys=<span class="hljs-literal">True</span>, indent=<span class="hljs-number">4</span>)<br>        <span class="hljs-variable language_">self</span>._out.write(<span class="hljs-variable language_">self</span>.encrypt(outbuf.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">argv</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(argv) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (<span class="hljs-number">3</span>, <span class="hljs-number">4</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s &lt;key&gt; &lt;infile&gt; [outfile]&quot;</span> % sys.argv[<span class="hljs-number">0</span>])<br>        <span class="hljs-keyword">return</span><br>    argv.pop(<span class="hljs-number">0</span>)<br>    key = argv.pop(<span class="hljs-number">0</span>)<br>    inf = argv.pop(<span class="hljs-number">0</span>)<br>    crypter = JSONCrypto(key.encode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br>    <span class="hljs-keyword">if</span> sys.argv:<br>        crypter.set_outfile(argv.pop(<span class="hljs-number">0</span>))<br>    crypter.encrypt_file(inf)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main(sys.argv)<br></code></pre></td></tr></table></figure><p>è€Œæ•´ä¸ªåŠ å¯†è¿‡ç¨‹ï¼Œå®é™…ä¸Šå°±æ˜¯dataå’Œkeyä¹‹é—´å¼‚æˆ–çš„æ“ä½œã€‚æ ¹æ®å¹³å¸¸çš„ç»éªŒï¼Œkeyçš„é•¿åº¦åº”è¯¥ä¸ä¼šå¾ˆé•¿ã€‚è€Œå¯†æ–‡çš„åŠ å¯†æ–‡æ¡£å«flag.txt.encã€‚å› æ­¤ç›²çŒœfilenameé‚£ä¸€æ çš„å€¼æ˜¯flag.txtã€‚è¿™æ ·å­çš„è¯ï¼Œdataçš„é•¿åº¦å·²ç»è¶…è¿‡äº†15ã€‚</p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªdataï¼Œæ¨¡ä»¿ä»–çš„æ„é€ å­—ç¬¦ä¸²çš„è¿‡ç¨‹å¯¹dataå¼‚æˆ–å¯†æ–‡ï¼Œå¯ä»¥çœ‹å‡ºæœ€å‰é¢å®é™…ä¸Šå‡ºç°äº†å¾ªç¯ç»“æ„ï¼Œè¯´æ˜è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„keyã€‚<code>n0t4=l4g</code></p><p>æœ€åæˆ‘ä»¬å°†keyå’Œdataè¿›è¡Œå¼‚æˆ–ï¼Œå°±å¯ä»¥å¾—åˆ°æ˜æ–‡å†…å®¹äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> json<br>fp=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt.enc&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<br>b=fp.read()<br>fp.close()<br>data = &#123;<br>            <span class="hljs-string">&quot;filename&quot;</span>: <span class="hljs-string">&#x27;flag.txt&#x27;</span>,<br>            <span class="hljs-string">&quot;hash&quot;</span>: <span class="hljs-string">&#x27;000000000000000000000000000000000000000&#x27;</span>,<br>            <span class="hljs-string">&quot;plaintext&quot;</span>:<span class="hljs-string">&#x27;000000000000000000000000000000000000&#x27;</span><br>        &#125;<br>outbuf = json.dumps(data, sort_keys=<span class="hljs-literal">True</span>, indent=<span class="hljs-number">4</span>)<br>s=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">min</span>(<span class="hljs-built_in">len</span>(outbuf),<span class="hljs-built_in">len</span>(b))):<br>    s+=<span class="hljs-built_in">chr</span>(b[i]^<span class="hljs-built_in">ord</span>(outbuf[i]))<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-comment">#n0t4=l4gn0t4=l4gn0t4=l4gn0t4=l4gn0t4=l4gn0t6ke&lt;5fa&quot;e=m0589q18o76mes6n9agj1s0&lt;......</span><br>key=<span class="hljs-string">b&#x27;n0t4=l4g&#x27;</span><br>ans=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(b)):<br>    ans+=<span class="hljs-built_in">chr</span>(b[i]^key[i%<span class="hljs-built_in">len</span>(key)])<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">    &quot;filename&quot;: &quot;flag.txt&quot;,</span><br><span class="hljs-string">    &quot;hash&quot;: &quot;2f98b8afa014bf955533a3e72cee0417413ff744e25f2b5b5838f5741cd69547&quot;,</span><br><span class="hljs-string">    &quot;plaintext&quot;: &quot;CTF&#123;plz_dont_r0ll_ur_own_crypto&#125;&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="2-ç¾ŠåŸæ¯-2020-GMC"><a href="#2-ç¾ŠåŸæ¯-2020-GMC" class="headerlink" title="2.[ç¾ŠåŸæ¯ 2020]GMC"></a>2.[ç¾ŠåŸæ¯ 2020]GMC</h2><p>æ‹¿åˆ°é¢˜ç›®ï¼Œå¾ˆæ˜¾ç„¶å•Šï¼Œçœ‹åˆ°äº†æœ‰éšæœºæ•°çš„å¹³æ–¹ï¼Œå®¹æ˜“æƒ³åˆ°ä½¿ç”¨ä¹‹å‰æåˆ°è¿‡çš„äºŒæ¬¡å‰©ä½™çš„ç›¸å…³çŸ¥è¯†æ¥è§£å†³ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime,bytes_to_long,getRandomNBitInteger<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> gcd<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gmc</span>(<span class="hljs-params">a, p</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(a, (p-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>, p) == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>():<br>    [gp,gq] = [getPrime(<span class="hljs-number">512</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]<br>    gN = gp * gq<br>    <span class="hljs-keyword">return</span> gN, gq, gp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_x</span>(<span class="hljs-params">gq,gp</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        x = getRandomNBitInteger(<span class="hljs-number">512</span>)<br>        <span class="hljs-keyword">if</span> gmc(x,gp) ^ gmc(x,gq) == -<span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">return</span> x <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_y</span>(<span class="hljs-params">gN</span>):<br>    gy_list = []<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(gy_list) != F_LEN:<br>        ty = getRandomNBitInteger(<span class="hljs-number">768</span>)<br>        <span class="hljs-keyword">if</span> gcd(ty,gN) == <span class="hljs-number">1</span>:<br>            gy_list.append(ty)<br>    <span class="hljs-keyword">return</span> gy_list<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    flag = <span class="hljs-built_in">bin</span>(bytes_to_long(flag))[<span class="hljs-number">2</span>:]<br>    F_LEN = <span class="hljs-built_in">len</span>(flag)<br>    N, q, p = gen_key()<br>    x = gen_x(q, p)<br>    y_list = gen_y(N)<br>    ciphertext = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(F_LEN):<br>        tc = <span class="hljs-built_in">pow</span>(y_list[i],<span class="hljs-number">2</span>) * <span class="hljs-built_in">pow</span>(x,<span class="hljs-built_in">int</span>(flag[i])) % N<br>        ciphertext.append(tc)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./output.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(<span class="hljs-built_in">str</span>(N) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(F_LEN):<br>            f.write(<span class="hljs-built_in">str</span>(ciphertext[i]) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œgmcå‡½æ•°å°±æ˜¯åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯äºŒæ¬¡å‰©ä½™çš„å‡½æ•°ï¼Œå› ä¸ºåœ¨æœ‰é™åŸŸé‡Œï¼ŒäºŒæ¬¡å‰©ä½™çš„ordå€¼ä¸€å®šæ˜¯$\dfrac{p-1}2$çš„å› æ•°ã€‚å› æ­¤å¦‚æœ$a$æ˜¯æœ‰é™åŸŸä¸­çš„äºŒæ¬¡å‰©ä½™ï¼Œé‚£ä¹ˆ$a^{\frac{p-1}2} \equiv 1 \pmod p$ã€‚</p><p>ä¸è¿‡è¿™é‡Œåˆ¤æ–­çš„æ˜¯$n&#x3D;pq$çš„äºŒæ¬¡å‰©ä½™æƒ…å†µã€‚æ ¹æ®é˜…è¯»ä»£ç ï¼Œä¸¤ä¸ªå¼‚æˆ–å€¼ç­‰äº$-2$çš„è¯ï¼Œåªæœ‰å¯èƒ½æ˜¯ä¸€ä¸ª$1$ä¸€ä¸ª$-1$ã€‚è€ŒäºŒæ¬¡å‰©ä½™çš„ç¬¦å·æ˜¯å¯ä»¥ç›¸ä¹˜çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œç”Ÿæˆçš„æ•°å­—è‚¯å®šä¸æ˜¯äºŒæ¬¡å‰©ä½™ã€‚</p><p>æ ¹æ®æœ€åç»™å‡ºçš„æ•°å­—ï¼š$y_i^2x^{f_i}$ï¼Œå…¶ä¸­$f_i$çš„å–å€¼ä¸º$0,1$ã€‚å› æ­¤å¦‚æœæœ€åç»™å‡ºæ•°å­—æ˜¯äºŒæ¬¡å‰©ä½™ï¼Œé‚£ä¹ˆå¯¹åº”çš„flagä½æ˜¯$0$ï¼Œå¦‚æœç»™å‡ºçš„æ•°å­—æ˜¯äºŒæ¬¡éå‰©ä½™ï¼Œé‚£ä¹ˆå¯¹åº”çš„flagä½æ˜¯$1$ã€‚</p><p>è¿™é“é¢˜è¿˜ç®—æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œç›´æ¥ä¸Šè„šæœ¬ï¼Œå…·ä½“è®²è§£å¯ä»¥å›é¡¾**0xGame Div 4[2020.10.29]**ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">isqr</span>(<span class="hljs-params">x,p</span>):<br>    <span class="hljs-keyword">if</span> p==<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    sgn=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> x%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>:<br>        x=x//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> p%<span class="hljs-number">8</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">or</span> p%<span class="hljs-number">8</span>==<span class="hljs-number">5</span>:<br>            sgn=-sgn<br>    <span class="hljs-keyword">if</span> x&lt;p:<br>        _tmp=p<br>        p=x<br>        x=_tmp<br>        <span class="hljs-keyword">if</span> x%<span class="hljs-number">4</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">and</span> p%<span class="hljs-number">4</span>==<span class="hljs-number">3</span> :<br>            sgn=-sgn<br>    <span class="hljs-keyword">return</span> sgn*isqr(x%p,p)<br>n,s=<span class="hljs-number">0</span>,[]<br>fp=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>n=<span class="hljs-built_in">int</span>(fp.readline())<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">try</span>:<br>        a=<span class="hljs-built_in">int</span>(fp.readline())<br>        s.append(a)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">break</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s)+<span class="hljs-number">1</span>==<span class="hljs-number">304</span><br>ans=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>    <span class="hljs-keyword">if</span>(isqr(i,n)==<span class="hljs-number">1</span>):<br>        ans+=<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        ans+=<span class="hljs-string">&#x27;1&#x27;</span><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(ans,<span class="hljs-number">2</span>)))<br></code></pre></td></tr></table></figure><h2 id="3-b01lers2020-Des-MMXX"><a href="#3-b01lers2020-Des-MMXX" class="headerlink" title="3.[b01lers2020]Des-MMXX"></a>3.[b01lers2020]Des-MMXX</h2><p>é¦–å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®çš„åŠ å¯†ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br>SECRET = <span class="hljs-number">0xa</span><span class="hljs-comment">########e          # remember to erase this later..</span><br>seed = <span class="hljs-string">b&#x27;secret_sauce_#9&#x27;</span>   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>(<span class="hljs-params">s</span>):<br>   keys = []<br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2020</span>):<br>      s = sha256(s).digest()<br>      keys.append(s)<br>   <span class="hljs-keyword">return</span> keys<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scramble</span>(<span class="hljs-params">s</span>):<br>   ret = <span class="hljs-string">&quot;&quot;</span>.join( [<span class="hljs-built_in">format</span>(s &amp; <span class="hljs-number">0xfffff</span>, <span class="hljs-string">&#x27;020b&#x27;</span>)]*<span class="hljs-number">101</span> )<br>   ret += <span class="hljs-string">&quot;&quot;</span>.join( [<span class="hljs-built_in">format</span>(s &gt;&gt; <span class="hljs-number">20</span>, <span class="hljs-string">&#x27;020b&#x27;</span>)]*<span class="hljs-number">101</span> )<br>   <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(ret, <span class="hljs-number">2</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">keys, msg</span>):<br>   dk = scramble(SECRET)<br>   <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> keys:<br>      idx = dk &amp; <span class="hljs-number">3</span><br>      dk &gt;&gt;= <span class="hljs-number">2</span><br>      k = v[idx*<span class="hljs-number">8</span>:(idx+<span class="hljs-number">1</span>)*<span class="hljs-number">8</span>]<br>      cp = DES.new(k, DES.MODE_CBC, <span class="hljs-built_in">bytes</span>(<span class="hljs-number">8</span>))  <br>      msg = cp.encrypt(msg)<br>   <span class="hljs-keyword">return</span> msg<br>keys = keygen(seed)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>   msg = f.read()<br>ctxt = encrypt(keys, msg)<br><span class="hljs-built_in">print</span>(ctxt)<br><span class="hljs-comment">#Plaintext: b&#x27;Attack at DAWN!!&#x27;</span><br><span class="hljs-comment">#Ciphertext: b&#x27;\x15\x08T\xff&lt;\xf4\xc4\xc0\xd2;\xd6\x8a\x824\x83\xbe&#x27;</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡é¢˜ç›®ç»™å‡ºçš„åŠ å¯†ä»£ç ä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†æœ€åè¿˜ç»™å‡ºäº†ä¸€ç»„é™„åŠ çš„æ˜æ–‡å’Œå¯†æ–‡ï¼Œçœ‹æ¥æ˜¯æœ‰ä¸€å®šç”¨å¤„çš„ã€‚è€ŒSECRETè™½ç„¶ä¸­é—´å…«ä½åå…­è¿›åˆ¶æ•°è¢«æ“¦å»ï¼Œä½†ç»™å‡ºäº†æœ€é«˜ä½çš„$\text{AH}$å’Œæœ€ä½ä½çš„$\text{EH}$ï¼ˆ$\text H$åç¼€è¡¨ç¤ºåå…­è¿›åˆ¶ï¼‰ã€‚</p><p>è§‚å¯Ÿä¸€ä¸‹scrambleå‡½æ•°ï¼Œä¸secretå¯†åˆ‡ç›¸å…³ï¼Œå› æ­¤æˆ‘æ„é€ äº†ä¸€ä¸ªåä½çš„åå…­è¿›åˆ¶æ•°$\text{123456789AH}$æ”¾è¿›å»ï¼Œå¾—å‡ºæ¥çš„ç»“æœæ˜¯$\text{6789A6789A6789Aâ€¦â€¦123451234512345H}$ã€‚è€ŒåŠ å¯†çš„æ—¶å€™ï¼Œå–è¿™ä¸ªæ•°å­—ä½œä¸ºdkï¼Œç„¶ådkæ¯æ¬¡é™¤ä»¥$4$å¹¶è·å–ä½™æ•°ã€‚ä½™æ•°ä½œä¸ºå¯¹åº”keyså¯†é’¥ä¸­çš„å¯†é’¥æ®µã€‚</p><p>æ³¨æ„åˆ°åŠ å¯†çš„å‰åŠæ®µå’ŒååŠæ®µåŸºæœ¬æ— å…³ï¼Œè€Œé¢˜ç›®åˆç»™å‡ºäº†ä¸€ä¸ªé™„åŠ æ˜æ–‡å’Œé™„åŠ å¯†æ–‡ã€‚å¾ˆæ˜¾ç„¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸­é—´ç¢°æ’æ³•è¿›è¡Œæ”»å‡»ï¼Œé€šè¿‡åˆ†åˆ«æšä¸¾ä¸¤ç«¯SECRETçš„å€¼ï¼Œç„¶åæ¯”å¯¹è¾“å‡ºç»“æœï¼Œåœ¨ä¸¤ç»„æ¯ç»„$60000$å¤šä¸ªè¾“å‡ºä¸­å¯»æ‰¾åˆ°ç›¸åŒçš„è¾“å‡ºã€‚</p><p>æ„é€ å¯†é’¥ç›´æ¥æ¨¡ä»¿å…¶æ„é€ å¯†é’¥çš„è¿‡ç¨‹å³å¯ã€‚è€Œæœ€éœ€è¦ä¸»ä¹‰çš„å°±æ˜¯å¯¹keyè¿›è¡Œä¸‹æ ‡å…³ç³»çš„è®¡ç®—ï¼Œä»¥åŠå¯¹ç”Ÿæˆçš„åŠå¯†é’¥é™¤ä»¥å¤šå°‘ï¼ˆä¹Ÿå°±æ˜¯éœ€è¦å³ç§»å¤šå°‘ä½ï¼‰çš„é—®é¢˜ï¼Œåæ­£éƒ½æ˜¯çº¿æ€§å‡½æ•°ï¼Œä¸¾ä¸¤ä¸ªä¾‹å­å°±å¯ä»¥åˆ¤æ–­äº†ã€‚  </p><p>æšä¸¾å‰åŠæ®µåŠ å¯†å¯†é’¥è„šæœ¬ï¼ˆå¯¹é™„åŠ æ˜æ–‡åŠ å¯†åˆ°ä¸€åŠçš„æ“ä½œï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#10.py</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>m=<span class="hljs-string">b&quot;Attack at DAWN!!&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>(<span class="hljs-params">s</span>):<br>   keys = []<br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2020</span>):<br>      s = sha256(s).digest()<br>      keys.append(s)<br>   <span class="hljs-keyword">return</span> keys<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">K</span>(<span class="hljs-params">x</span>):<br>   ret = <span class="hljs-string">&quot;&quot;</span>.join( [<span class="hljs-built_in">format</span>(x &amp; <span class="hljs-number">0xfffff</span>, <span class="hljs-string">&#x27;020b&#x27;</span>)]*<span class="hljs-number">101</span> )<br>   <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(ret,<span class="hljs-number">2</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">incrypt</span>(<span class="hljs-params">kinum,cip,keys</span>):<br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1010</span>):<br>      idx=(kinum&gt;&gt;(<span class="hljs-number">2</span>*i))&amp;<span class="hljs-number">3</span><br>      k=keys[i][idx*<span class="hljs-number">8</span>:idx*<span class="hljs-number">8</span>+<span class="hljs-number">8</span>]<br>      cp = DES.new(k, DES.MODE_CBC, <span class="hljs-built_in">bytes</span>(<span class="hljs-number">8</span>))<br>      cip=cp.encrypt(cip)<br>   <span class="hljs-keyword">return</span> cip<br>keys = keygen(<span class="hljs-string">b&#x27;secret_sauce_#9&#x27;</span>)<br>fp=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ENCMID.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">65536</span>):<br>    <span class="hljs-keyword">if</span>(i%<span class="hljs-number">150</span>==<span class="hljs-number">0</span>):<br>        <span class="hljs-built_in">print</span>(i)<br>    keynum=K(<span class="hljs-number">0xa0000</span>+i)<br>    fp.write(<span class="hljs-built_in">hex</span>(bytes_to_long(incrypt(keynum,m,keys)))[<span class="hljs-number">2</span>:]+<span class="hljs-string">&#x27;\n&#x27;</span>)<br></code></pre></td></tr></table></figure><p>æšä¸¾ååŠæ®µåŠ å¯†å¯†é’¥ï¼ˆå¯¹é™„åŠ å¯†æ–‡è¿›è¡Œè§£å¯†åˆ°ä¸€åŠçš„æ“ä½œï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#11.py</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>c=<span class="hljs-string">b&quot;\x15\x08\x54\xff\x3c\xf4\xc4\xc0\xd2\x3b\xd6\x8a\x82\x34\x83\xbe&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>(<span class="hljs-params">s</span>):<br>   keys = []<br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2020</span>):<br>      s = sha256(s).digest()<br>      keys.append(s)<br>   <span class="hljs-keyword">return</span> keys<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">K</span>(<span class="hljs-params">x</span>):<br>   ret = <span class="hljs-string">&quot;&quot;</span>.join( [<span class="hljs-built_in">format</span>(x &amp; <span class="hljs-number">0xfffff</span>, <span class="hljs-string">&#x27;020b&#x27;</span>)]*<span class="hljs-number">101</span> )<br>   <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(ret,<span class="hljs-number">2</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dicrypt</span>(<span class="hljs-params">kinum,cip,keys</span>):<br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1010</span>):<br>      idx=(kinum&gt;&gt;(<span class="hljs-number">2018</span>-<span class="hljs-number">2</span>*i))&amp;<span class="hljs-number">3</span><br>      k=keys[<span class="hljs-number">2019</span>-i][idx*<span class="hljs-number">8</span>:idx*<span class="hljs-number">8</span>+<span class="hljs-number">8</span>]<br>      cp = DES.new(k, DES.MODE_CBC, <span class="hljs-built_in">bytes</span>(<span class="hljs-number">8</span>))<br>      cip=cp.decrypt(cip)<br>   <span class="hljs-keyword">return</span> cip<br>keys = keygen(<span class="hljs-string">b&#x27;secret_sauce_#9&#x27;</span>)<br>fp=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;DECMID.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">65536</span>):<br>    <span class="hljs-keyword">if</span>(i%<span class="hljs-number">150</span>==<span class="hljs-number">0</span>):<br>        <span class="hljs-built_in">print</span>(i)<br>    keynum=K(i*<span class="hljs-number">16</span>+<span class="hljs-number">0xe</span>)<br>    fp.write(<span class="hljs-built_in">hex</span>(bytes_to_long(dicrypt(keynum,c,keys)))[<span class="hljs-number">2</span>:]+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>åœ¨ä¸¤ç»„æ–‡ä»¶ä¸­å¯»æ‰¾é…å¯¹ï¼Œå¤§æ¦‚éœ€è¦ç”¨$20$ç§’å·¦å³ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#6.py</span><br>s=[]<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ENCMID.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65536</span>):<br>    a=<span class="hljs-built_in">int</span>(f.readline(),<span class="hljs-number">16</span>)<br>    s.append(a)<br>f.close()<br><span class="hljs-built_in">print</span>(<span class="hljs-number">1</span>)<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;DECMID.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65536</span>):<br>    b=<span class="hljs-built_in">int</span>(f.readline(),<span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">if</span> b <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(i))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(s.index(b)))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(b))<br>f.close()<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">0x3618</span><br><span class="hljs-string">0x4d9e</span><br><span class="hljs-string">0x8ac245ba53950c4fb8352bfe2639fcd9</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒåŠ å¯†IDæ˜¯$\text{3618H}$ï¼Œè§£å¯†IDæ˜¯$\text{4D9EH}$ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¢å¤äº†æœ€åçš„SECRETçš„å€¼ä¸º$\text{A4D9E3618EH}$ã€‚ç„¶åç®€å•ä¿®æ”¹ä¸€ä¸‹è§£å¯†è„šæœ¬å°±å¯ä»¥å¾—å‡ºflagäº†ã€‚ä¸è¿‡é‡è¦çš„æ˜¯æ³¨æ„ä¸‹æ ‡è®¡ç®—çš„é—®é¢˜ï¼Œæ¯”å¦‚æœ€ç»ˆè§£å¯†è„šæœ¬ä¸­çš„ $4038-2i$å’Œ$2019-i$æ˜¯å¦‚ä½•ç®—çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#4.py</span><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br>SECRET=<span class="hljs-number">0xa4d9e3618e</span> <br>seed = <span class="hljs-string">b&#x27;secret_sauce_#9&#x27;</span>   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>(<span class="hljs-params">s</span>):<br>   keys = []<br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2020</span>):<br>      s = sha256(s).digest()<br>      keys.append(s)<br>   <span class="hljs-keyword">return</span> keys<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scramble</span>(<span class="hljs-params">s</span>):<br>   ret = <span class="hljs-string">&quot;&quot;</span>.join( [<span class="hljs-built_in">format</span>(s &amp; <span class="hljs-number">0xfffff</span>, <span class="hljs-string">&#x27;020b&#x27;</span>)]*<span class="hljs-number">101</span> )<br>   ret += <span class="hljs-string">&quot;&quot;</span>.join( [<span class="hljs-built_in">format</span>(s &gt;&gt; <span class="hljs-number">20</span>, <span class="hljs-string">&#x27;020b&#x27;</span>)]*<span class="hljs-number">101</span> )<br>   <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(ret, <span class="hljs-number">2</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">keys, msg</span>):<br>   dk = scramble(SECRET)<br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2020</span>):<br>      idx = (dk&gt;&gt;(<span class="hljs-number">4038</span>-(<span class="hljs-number">2</span>*i)))&amp;<span class="hljs-number">3</span><br>      k = keys[<span class="hljs-number">2019</span>-i][idx*<span class="hljs-number">8</span>:(idx+<span class="hljs-number">1</span>)*<span class="hljs-number">8</span>]<br>      cp = DES.new(k, DES.MODE_CBC, <span class="hljs-built_in">bytes</span>(<span class="hljs-number">8</span>))  <br>      msg = cp.decrypt(msg)<br>   <span class="hljs-keyword">return</span> msg<br>keys = keygen(seed)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.enc&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>   msg = f.read()<br>ctxt = decrypt(keys, msg)<br><span class="hljs-built_in">print</span>(ctxt)<br></code></pre></td></tr></table></figure><p><code>pctf&#123;Two_tO_thE_s1xt33n7h?_E4sy-p3asy..&#125;</code></p><h2 id="4-pasecactf-2019-tornado-casino"><a href="#4-pasecactf-2019-tornado-casino" class="headerlink" title="4.[pasecactf_2019]tornado_casino"></a>4.[pasecactf_2019]tornado_casino</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sys <span class="hljs-keyword">import</span> argv<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> getrandbits<br>flag = <span class="hljs-string">&#x27;&lt;redacted&gt;&#x27;</span><br>tornado_banner = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">                                                              88              </span><br><span class="hljs-string">  ,d                                                          88              </span><br><span class="hljs-string">  88                                                          88              </span><br><span class="hljs-string">MM88MMM ,adPPYba,  8b,dPPYba, 8b,dPPYba,  ,adPPYYba,  ,adPPYb,88  ,adPPYba,   </span><br><span class="hljs-string">  88   a8&quot;     &quot;8a 88P&#x27;   &quot;Y8 88P&#x27;   `&quot;8a &quot;&quot;     `Y8 a8&quot;    `Y88 a8&quot;     &quot;8a  </span><br><span class="hljs-string">  88   8b       d8 88         88       88 ,adPPPPP88 8b       88 8b       d8  </span><br><span class="hljs-string">  88,  &quot;8a,   ,a8&quot; 88         88       88 88,    ,88 &quot;8a,   ,d88 &quot;8a,   ,a8&quot;  </span><br><span class="hljs-string">  &quot;Y888 `&quot;YbbdP&quot;&#x27;  88         88       88 `&quot;8bbdP&quot;Y8  `&quot;8bbdP&quot;Y8  `&quot;YbbdP&quot;&#x27; &#x27;&#x27;&#x27;</span><br>casino_banner = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">                                88                          </span><br><span class="hljs-string">                                &quot;&quot;                          </span><br><span class="hljs-string">                                                            </span><br><span class="hljs-string"> ,adPPYba, ,adPPYYba, ,adPPYba, 88 8b,dPPYba,   ,adPPYba,   </span><br><span class="hljs-string">a8&quot;     &quot;&quot; &quot;&quot;     `Y8 I8[    &quot;&quot; 88 88P\&#x27;   `&quot;8a a8&quot;     &quot;8a  </span><br><span class="hljs-string">8b         ,adPPPPP88  `&quot;Y8ba,  88 88       88 8b       d8  </span><br><span class="hljs-string">&quot;8a,   ,aa 88,    ,88 aa    ]8I 88 88       88 &quot;8a,   ,a8&quot;  </span><br><span class="hljs-string"> `&quot;Ybbd8&quot;&#x27; `&quot;8bbdP&quot;Y8 `&quot;YbbdP&quot;\&#x27; 88 88       88  `&quot;YbbdP&quot;\&#x27; &#x27;&#x27;&#x27;</span><br>tornado_art = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">   ((  &quot;####@@!!$$    ))</span><br><span class="hljs-string">       `#####@@!$$`  ))</span><br><span class="hljs-string">    ((  &#x27;####@!!$:</span><br><span class="hljs-string">   ((  ,####@!!$:   ))</span><br><span class="hljs-string">       .###@!!$:</span><br><span class="hljs-string">       `##@@!$:</span><br><span class="hljs-string">        `#@!!$</span><br><span class="hljs-string">  !@#    `#@!$:       @#$</span><br><span class="hljs-string">   #$     `#@!$:       !@!</span><br><span class="hljs-string">            &#x27;@!$:</span><br><span class="hljs-string">        &#x27;`\   &quot;!$: /`&#x27;</span><br><span class="hljs-string">           &#x27;\  &#x27;!: /&#x27;</span><br><span class="hljs-string">             &quot;\ : /&quot;</span><br><span class="hljs-string">  -.&quot;-/\\\-.&quot;//.-&quot;/:`\.&quot;-.JrS&quot;.&quot;-=_\\</span><br><span class="hljs-string">&quot; -.&quot;-.\\&quot;-.&quot;//.-&quot;.`-.&quot;_\\-.&quot;.-\&quot;.-//&#x27;&#x27;&#x27;</span><br>welcome = <span class="hljs-string">&#x27;Welcome!\n[1] - To slotmachine\n[2] - Enter promocode\n[3] - Exit\n&#x27;</span><span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sltmchn_wndw</span>(<span class="hljs-params">num</span>):<br>    <span class="hljs-built_in">print</span>(num)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;|&#x27;</span> + <span class="hljs-string">&#x27;|&#x27;</span>.join(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">hex</span>(num)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>))) + <span class="hljs-string">&#x27;|&#x27;</span><br>slotmachine_menu = <span class="hljs-string">&#x27;[$] - $$$SPIN$$$\n&#x27;</span><br><span class="hljs-built_in">print</span>(tornado_banner)<br><span class="hljs-built_in">print</span>(casino_banner)<br><span class="hljs-built_in">print</span>(tornado_art)<br>user_balance = <span class="hljs-number">10</span><span class="hljs-comment">#$</span><br>promo = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    choice1 = <span class="hljs-built_in">input</span>(welcome)<br>    <span class="hljs-keyword">if</span> choice1 == <span class="hljs-string">&#x27;1&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;$$$Its point of no return!$$$\n$$$     all or nothing    $$$\n&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Your balance: <span class="hljs-subst">&#123;user_balance&#125;</span>&#x27;</span>)<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-keyword">if</span> user_balance &gt; <span class="hljs-number">0</span>:<br>                spin = <span class="hljs-built_in">input</span>(slotmachine_menu)<br>                <span class="hljs-keyword">if</span> spin == <span class="hljs-string">&#x27;$&#x27;</span>:<br>                    state = getrandbits(<span class="hljs-number">32</span>)<br>                    <span class="hljs-keyword">try</span>:<br>                        pff_try = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;It will be: &#x27;</span>), <span class="hljs-number">16</span>)<br>                    <span class="hljs-keyword">except</span>:<br>                        exit(<span class="hljs-number">0</span>)<br>                    <span class="hljs-keyword">if</span> pff_try == state:<br>                        <span class="hljs-built_in">print</span>(sltmchn_wndw(state))<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;OMGWTF$$$$$$$$$$$$&#x27;</span>)<br>                        <span class="hljs-built_in">print</span>(flag)<br>                        exit(<span class="hljs-number">0</span>)<br>                    <span class="hljs-keyword">else</span>:<br>                        <span class="hljs-built_in">print</span>(sltmchn_wndw(state))<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Nice try!&#x27;</span>)<br>                        user_balance -= <span class="hljs-number">1</span><br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Your balance: <span class="hljs-subst">&#123;user_balance&#125;</span>&#x27;</span>)<br>                <span class="hljs-keyword">else</span>:<br>                    exit(<span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Sorry!&#x27;</span>)<br>                exit(<span class="hljs-number">0</span>)                   <br>    <span class="hljs-keyword">elif</span> choice1 == <span class="hljs-string">&#x27;2&#x27;</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> promo:<br>            promo = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;Enter your promocode: &#x27;</span>)<br>            <span class="hljs-keyword">if</span> promo == <span class="hljs-string">&#x27;b33_1_4m_b3333&#x27;</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Great!&#x27;</span>)<br>                user_balance += <span class="hljs-number">1000</span><span class="hljs-comment">#$</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Only once!&#x27;</span>)      <br>    <span class="hljs-keyword">elif</span> choice1 == <span class="hljs-string">&#x27;3&#x27;</span>:<br>        exit(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>è§‚å¯ŸåŠ å¯†è„šæœ¬å¯ä»¥å‘ç°ï¼Œå¾ˆå®¹æ˜“åœ°å‘ç°<code>getrandbits(32)</code>ã€‚è€Œæ ¹æ®ä¹‹å‰åšé¢˜ç»éªŒï¼Œè¿™ä¸ªå°±æ˜¯è®©ä½ é¢„æµ‹MT19937ã€‚</p><p>é¦–å…ˆä¸Šä¸€ä¸‹è‡ªå·±åšçš„ä¸€ä¸ªMT19937çš„å·¥å…·åŒ…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_int32</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">0xFFFFFFFF</span> &amp; x)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MT19937</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        <span class="hljs-variable language_">self</span>.mt = [<span class="hljs-number">0</span>] * <span class="hljs-number">624</span><br>        <span class="hljs-variable language_">self</span>.mt[<span class="hljs-number">0</span>] = seed<br>        <span class="hljs-variable language_">self</span>.mti = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">624</span>):<br>            <span class="hljs-variable language_">self</span>.mt[i] = _int32(<span class="hljs-number">1812433253</span> * (<span class="hljs-variable language_">self</span>.mt[i - <span class="hljs-number">1</span>] ^ <span class="hljs-variable language_">self</span>.mt[i - <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>) + i)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_number</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.mti == <span class="hljs-number">0</span>:<br>            <span class="hljs-variable language_">self</span>.twist()<br>        y = <span class="hljs-variable language_">self</span>.mt[<span class="hljs-variable language_">self</span>.mti]<br>        y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>        y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>        <span class="hljs-variable language_">self</span>.mti = (<span class="hljs-variable language_">self</span>.mti + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span><br>        <span class="hljs-keyword">return</span> _int32(y)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">twist</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>            y = _int32((<span class="hljs-variable language_">self</span>.mt[i] &amp; <span class="hljs-number">0x80000000</span>) + (<span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>))<br>            <span class="hljs-variable language_">self</span>.mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ <span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br>            <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>                <span class="hljs-variable language_">self</span>.mt[i] = <span class="hljs-variable language_">self</span>.mt[i] ^ <span class="hljs-number">0x9908b0df</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right</span>(<span class="hljs-params">res, shift, mask=<span class="hljs-number">0xffffffff</span>, bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>        tmp = res ^ tmp &gt;&gt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left</span>(<span class="hljs-params">res, shift, mask=<span class="hljs-number">0xffffffff</span>, bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>        tmp = res ^ tmp &lt;&lt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_number</span>(<span class="hljs-params">y</span>):<br>    y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>    y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>    <span class="hljs-keyword">return</span> y&amp;<span class="hljs-number">0xffffffff</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover</span>(<span class="hljs-params">y</span>):<br>    y = inverse_right(y,<span class="hljs-number">18</span>)<br>    y = inverse_left(y,<span class="hljs-number">15</span>,<span class="hljs-number">4022730752</span>)<br>    y = inverse_left(y,<span class="hljs-number">7</span>,<span class="hljs-number">2636928640</span>)<br>    y = inverse_right(y,<span class="hljs-number">11</span>)<br>    <span class="hljs-keyword">return</span> y&amp;<span class="hljs-number">0xffffffff</span><br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬æ ¹æ®é¢˜ç›®çš„æç¤ºï¼Œè·å–$624$ä¸ªå†…éƒ¨çŠ¶æ€å°±å¯ä»¥é¢„æµ‹éšæœºæ•°äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> MT19937 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> mt19937predictor <span class="hljs-keyword">import</span> MT19937Predictor<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getnumber</span>(<span class="hljs-params">s29</span>):<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s29)==<span class="hljs-number">29</span><br>s=s29[<span class="hljs-number">13</span>]+s29[<span class="hljs-number">15</span>]+s29[<span class="hljs-number">17</span>]+s29[<span class="hljs-number">19</span>]+s29[<span class="hljs-number">21</span>]+s29[<span class="hljs-number">23</span>]+s29[<span class="hljs-number">25</span>]+s29[<span class="hljs-number">27</span>]<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(s,<span class="hljs-number">16</span>)<br>sh=remote(<span class="hljs-string">&quot;node3.buuoj.cn&quot;</span>,<span class="hljs-number">29601</span>)<br>str1=sh.recvuntil(<span class="hljs-string">&#x27;[3] - Exit&#x27;</span>)<br>sh.sendline(<span class="hljs-string">&#x27;2&#x27;</span>)<br>str1=sh.recvuntil(<span class="hljs-string">&#x27;Enter your promocode:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">&#x27;b33_1_4m_b3333&#x27;</span>)<br>str1=sh.recvuntil(<span class="hljs-string">&#x27;[3] - Exit&#x27;</span>)<br>sh.sendline(<span class="hljs-string">&#x27;1&#x27;</span>)<br>S=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br><span class="hljs-keyword">if</span>(i%<span class="hljs-number">31</span>==<span class="hljs-number">0</span>):<br><span class="hljs-built_in">print</span>(i)<br>str1=sh.recvuntil(<span class="hljs-string">&#x27;N$$$&#x27;</span>)<br>sh.sendline(<span class="hljs-string">&#x27;$&#x27;</span>)<br>sh.sendline(<span class="hljs-string">&#x27;10000000&#x27;</span>)<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>str2=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>S.append(getnumber(str2))<br>Q=[]<br>R=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> S:<br>Q.append(recover(i))<br>B=MT19937(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(Q)==<span class="hljs-number">624</span><br>B.mt=Q<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br><span class="hljs-built_in">print</span>(i,<span class="hljs-built_in">hex</span>(extract_number(B.mt[i])))<br>predictor = MT19937Predictor()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>predictor.setrandbits(S[i],<span class="hljs-number">32</span>)<br>Y2=predictor.getrandbits(<span class="hljs-number">32</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ans=&#x27;</span>,<span class="hljs-built_in">hex</span>(Y2))<br>sh.interactive()<br><br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸“é—¨çš„åŒ…ç”¨æ¥é¢„æµ‹ï¼Œè¿™ä¸ªåŒ…ç½‘ä¸Šå¯ä»¥é€šè¿‡pipä¸‹è½½ä¸‹æ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> mt19937predictor <span class="hljs-keyword">import</span> MT19937Predictor<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getnumber</span>(<span class="hljs-params">s29</span>):<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s29)==<span class="hljs-number">29</span><br>s=s29[<span class="hljs-number">13</span>]+s29[<span class="hljs-number">15</span>]+s29[<span class="hljs-number">17</span>]+s29[<span class="hljs-number">19</span>]+s29[<span class="hljs-number">21</span>]+s29[<span class="hljs-number">23</span>]+s29[<span class="hljs-number">25</span>]+s29[<span class="hljs-number">27</span>]<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(s,<span class="hljs-number">16</span>)<br>sh=remote(<span class="hljs-string">&quot;node3.buuoj.cn&quot;</span>,<span class="hljs-number">29601</span>)<br>str1=sh.recvuntil(<span class="hljs-string">&#x27;[3] - Exit&#x27;</span>)<br>sh.sendline(<span class="hljs-string">&#x27;2&#x27;</span>)<br>str1=sh.recvuntil(<span class="hljs-string">&#x27;Enter your promocode:&#x27;</span>)<br>sh.sendline(<span class="hljs-string">&#x27;b33_1_4m_b3333&#x27;</span>)<br>str1=sh.recvuntil(<span class="hljs-string">&#x27;[3] - Exit&#x27;</span>)<br>sh.sendline(<span class="hljs-string">&#x27;1&#x27;</span>)<br>S=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br><span class="hljs-keyword">if</span>(i%<span class="hljs-number">31</span>==<span class="hljs-number">0</span>):<br><span class="hljs-built_in">print</span>(i)<br>str1=sh.recvuntil(<span class="hljs-string">&#x27;N$$$&#x27;</span>)<br>sh.sendline(<span class="hljs-string">&#x27;$&#x27;</span>)<br>sh.sendline(<span class="hljs-string">&#x27;10000000&#x27;</span>)<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>str2=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>S.append(getnumber(str2))<br>predictor = MT19937Predictor()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>predictor.setrandbits(S[i],<span class="hljs-number">32</span>)<br>ans=predictor.getrandbits(<span class="hljs-number">32</span>)<br>sh.sendline(<span class="hljs-string">&#x27;$&#x27;</span>)<br>sh.sendline(<span class="hljs-built_in">hex</span>(ans)[<span class="hljs-number">2</span>:])<br>sh.interactive()<br></code></pre></td></tr></table></figure><h2 id="5-ç¾ŠåŸæ¯-2020-RRRRRRSA"><a href="#5-ç¾ŠåŸæ¯-2020-RRRRRRSA" class="headerlink" title="5.[ç¾ŠåŸæ¯ 2020]RRRRRRSA"></a>5.[ç¾ŠåŸæ¯ 2020]RRRRRRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">&#x27;GWHT&#123;************&#125;&#x27;</span><br>flag1 = flag[:<span class="hljs-number">19</span>].encode()<br>flag2 = flag[<span class="hljs-number">19</span>:].encode()<br><span class="hljs-keyword">assert</span>(<span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">38</span>)<br>P1 = getPrime(<span class="hljs-number">1038</span>)<br>P2 = sympy.nextprime(P1)<br><span class="hljs-keyword">assert</span>(P2 - P1 &lt; <span class="hljs-number">1000</span>)<br>Q1 = getPrime(<span class="hljs-number">512</span>)<br>Q2 = sympy.nextprime(Q1)<br>N1 = P1 * P1 * Q1<br>N2 = P2 * P2 * Q2<br>E1 = getPrime(<span class="hljs-number">1024</span>)<br>E2 = sympy.nextprime(E1)<br>m1 = bytes_to_long(flag1)<br>m2 = bytes_to_long(flag2)<br>c1 = <span class="hljs-built_in">pow</span>(m1, E1, N1)<br>c2 = <span class="hljs-built_in">pow</span>(m2, E2, N2)<br>output = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;secret&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>output.write(<span class="hljs-string">&#x27;N1=&#x27;</span> + <span class="hljs-built_in">str</span>(N1) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output.write(<span class="hljs-string">&#x27;c1=&#x27;</span> + <span class="hljs-built_in">str</span>(c1) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output.write(<span class="hljs-string">&#x27;E1=&#x27;</span> + <span class="hljs-built_in">str</span>(E1) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output.write(<span class="hljs-string">&#x27;N2=&#x27;</span> + <span class="hljs-built_in">str</span>(N2) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output.write(<span class="hljs-string">&#x27;c2=&#x27;</span> + <span class="hljs-built_in">str</span>(c2) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output.write(<span class="hljs-string">&#x27;E2=&#x27;</span> + <span class="hljs-built_in">str</span>(E2) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output.close()<br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ä¸­ï¼Œ$n$å…·æœ‰$n&#x3D;p^2q$çš„å½¢å¼ï¼Œå¹¶ä¸”æ„æˆ$n_1,n_2$ä¸­çš„$p,q$éƒ½æ˜¯éå¸¸éå¸¸æ¥è¿‘çš„ï¼ˆå°±æ˜¯ç›¸é‚»ä¸¤ä¸ªç´ æ•°çš„å…³ç³»ï¼‰ä¸è¿‡ï¼Œ$p$å’Œ$q$çš„ä½æ•°ç›¸å·®è¾ƒå¤§ã€‚</p><hr><h3 id="Insertï¼šå…³äºè¿åˆ†æ•°é€¼è¿‘çš„é—®é¢˜"><a href="#Insertï¼šå…³äºè¿åˆ†æ•°é€¼è¿‘çš„é—®é¢˜" class="headerlink" title="Insertï¼šå…³äºè¿åˆ†æ•°é€¼è¿‘çš„é—®é¢˜"></a>Insertï¼šå…³äºè¿åˆ†æ•°é€¼è¿‘çš„é—®é¢˜</h3><p>åœ¨ä¹‹å‰RSAçš„ç¬”è®°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„WienerAttackçš„åŸç†å°±æ˜¯è¿åˆ†æ•°é€¼è¿‘ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œè¡¥å……ä»‹ç»ä¸€ä¸‹å‹’è®©å¾·å®šç†ï¼šã€</p><p><strong>å‹’è®©å¾·å®šç†</strong>ï¼šå‡è®¾$x\in R_+$ï¼Œé‚£ä¹ˆåœ¨$x$çš„è¿åˆ†æ•°é€¼è¿‘å±•å¼€ä¸­ï¼Œå¦‚æœæœ‰$|x-\dfrac a b|&lt;\dfrac 1 {2b^2}$ï¼Œå…¶ä¸­$\gcd (a,b)&#x3D;1$ï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸º$\dfrac ab$æ˜¯$x$çš„è¿åˆ†æ•°å±•å¼€ä¸­çš„å…¶ä¸­ä¸€é¡¹çš„å€¼ã€‚</p><p>æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹RSAä¸­wienerattackçš„è¿‡ç¨‹ï¼š</p><p>ç”±$ed\equiv 1 \pmod \phi$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$ed-k\phi&#x3D;1$ã€‚ä¸¤è¾¹åŒæ—¶é™¤ä»¥$d\phi$ï¼Œé‚£ä¹ˆå°±æœ‰$|\dfrac e \phi-\dfrac k d |&#x3D;\dfrac 1 {d\phi}$ã€‚</p><p>åˆå› ä¸º$n-\phi&#x3D;p+q-1&lt;3\sqrt n$ã€‚</p><p>æ‰€ä»¥æ ¹æ®å‹’è®©å¾·å®šç†ï¼Œæˆ‘ä»¬éœ€è¦è¯æ˜$|\dfrac e \phi-\dfrac k d |&lt;\dfrac 1 {2d^2}$ï¼Œä¸‹é¢ç®€å•åœ°ç»™å‡ºè¯æ˜ï¼šï¼š</p><p>å·¦è¾¹åˆ†å¼é€šåˆ†ï¼Œå¾—<br>$$<br>|\dfrac {ed-nk}{dn}|<br>$$<br>åˆ†æ¯å‡‘ä¸€ä¸ª$k\phi$ï¼Œå¯ä»¥æœ‰<br>$$<br>|\dfrac {ed-k\phi-nk+k\phi}{dn}|<br>$$<br>åˆå› ä¸º$ed-k\phi&#x3D;1$ï¼Œé‚£ä¹ˆåˆ†å­åŒ–ç®€å¾—<br>$$<br>|\dfrac {1-k(n-\phi)}{dn}|<br>$$<br>è¿™ä¸ªæ•°å­—æ˜¯å°äº$\dfrac{3k\sqrt n}{dn}&#x3D;\dfrac{3k}{d\sqrt n}$ã€‚å› æ­¤æˆ‘ä»¬æ ¹æ®å‰é¢çš„å‡ ä¸ªæ¡ä»¶ï¼Œå¯ä»¥æ¨å‡ºæœ€åçš„ç»“æœå°äº$\dfrac{1}{2d^2}$ã€‚æ‰€ä»¥ï¼Œåœ¨æ•´ä¸ªè¿åˆ†æ•°é€¼è¿‘çš„è¿‡ç¨‹ä¸­ï¼Œä¸­é—´çš„ç»“æœå¿…ç„¶å‡†ç¡®è¦†ç›–äº†$\dfrac k d$çš„å€¼ã€‚</p><hr><p>å›åˆ°ä¸Šé¢è¿™é“é¢˜ï¼Œç”±äº$p$æ˜¯$1024$ä½ï¼Œ$p^2$æ˜¯$2048$ä½ï¼Œ$q$æ˜¯$512$ä½ï¼Œæ¯”$2048$ä½å°å¾—å¤šã€‚è€Œ$p_1,p_2$ã€$q_1,q_2$æ˜¯ä¸¤ç»„éå¸¸æ¥è¿‘çš„æ•°å­—ï¼Œè€ƒè™‘åˆ°$p$æ›´å¤§ï¼Œå› æ­¤ï¼Œå½“æˆ‘ä»¬å¯¹$\dfrac {n_1} {n_2}$è¿›è¡Œè¿åˆ†æ•°é€¼è¿‘æ—¶ï¼Œä¸€å®šä¼šå‡†ç¡®è¦†ç›–åˆ°$\dfrac{p_1^2}{p_2^2}$æˆ–è€…$\dfrac {q_1}{q_2}$ã€‚</p><p>ä¸‹é¢ä¸Šä¸€ä¸‹è§£é¢˜è¿‡ç¨‹,å…¶ä¸­<code>solve</code>å‡½æ•°æ˜¯è¿åˆ†æ•°å±•å¼€çš„è¿‡ç¨‹ï¼Œ<code>simplify</code>å‡½æ•°å’Œ<code>getmidfrac</code>å¯ä»¥è®¡ç®—<code>g</code>æ•°ç»„ä¸­æ‰€æ¶‰åŠçš„æ‰€æœ‰çš„åˆ†æ•°ï¼Œä»¥åˆ†å­å’Œåˆ†æ¯å½¢æˆçš„æ•°å¯¹å½¢å¼è¡¨ç°ã€‚æœ€åæšä¸¾è¿™ä¸ªæ•°å¯¹å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">a, b</span>):<br>    g=[]<br>    <span class="hljs-keyword">while</span>(a!=<span class="hljs-number">1</span>):<br>        g.append(a//b)<br>        a,b=b,a%b<br>    g.append(b)<br>    <span class="hljs-keyword">return</span> g<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">simplify</span>(<span class="hljs-params">x</span>):<br>    n,d=<span class="hljs-number">0</span>,<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x[::-<span class="hljs-number">1</span>]:<br>        n,d=d,i*d+n<br>    <span class="hljs-keyword">return</span> n,d<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getmidfrac</span>(<span class="hljs-params">x</span>):<br>    r=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(x)):<br>        r.append(simplify(x[:i]))<br>    <span class="hljs-keyword">return</span> r<br>g=solve(N1,N2)<br>g=getmidfrac(g)<br>q1,q2=<span class="hljs-literal">None</span>,<span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> (a,b) <span class="hljs-keyword">in</span> g:<br>    <span class="hljs-keyword">if</span> b==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> N1%b==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> b-<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> b-N1:<br>        q1=b<br>        q2=a<br>        <span class="hljs-keyword">break</span><br>p1,p2=iroot(N1//q1,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>],iroot(N2//q2,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>phi1,phi2=p1*(p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>),p2*(p2-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>)<br>d1,d2=inverse(E1,phi1),inverse(E2,phi2)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c1,d1,N1)))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c2,d2,N2)))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HgameDiv1,2</title>
    <link href="/2021/02/14/HgameDiv1/"/>
    <url>/2021/02/14/HgameDiv1/</url>
    
    <content type="html"><![CDATA[<h1 id="Hgame-Div-1-2é¢˜è§£"><a href="#Hgame-Div-1-2é¢˜è§£" class="headerlink" title="Hgame Div 1,2é¢˜è§£"></a>Hgame Div 1,2é¢˜è§£</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>ç»ˆäºåœ¨æ¥è§¦CTFå·®ä¸å¤šå¤§çº¦5ä¸ªæœˆåï¼Œå°è¯•æ‰“äº†ä¸€ä¸‹æ­å·ç”µå­ç§‘å¤§çš„CTFæ‹›æ–°é¢˜ï¼ˆ<del>æ€»ä½“æ„Ÿè§‰åªæœ‰4ä¸ªå­—ï¼šæˆ‘å¤ªèœäº†</del></p><p>åªåšäº†å¯†ç å­¦ï¼Œå…¶ä»–çš„é¢˜ç›®ä¸çœ‹ï¼Œ<del>å› ä¸ºä¸æ˜¯æˆ‘ç ”ç©¶çš„å†…å®¹ï¼ˆ</del></p><p><del><code>#define huangx607087 feiwu</code></del></p><p><strong>Update 2.15</strong></p><p><del>æœ¬ä»¥ä¸º21Feb2ä¼šå…ˆå‡ºçš„ï¼Œç»“æœå‘å±•åˆ°äº†ç“¶é¢ˆæœŸ</del>ï¼Œ21Feb2åŸè®¡åˆ’æ˜¯2.12æˆ–è€…2.13å‘å¸ƒï¼Œç»“æœåˆ°äº†2.15éƒ½æ²¡èƒ½å‘å¸ƒï¼ˆå› ä¸ºåªåˆ·äº†4é¢˜ï¼Œæ²¡åˆ·æ»¡5é¢˜ï¼‰ï¼Œæˆ‘æ˜¯fwï¼ˆ</p><h2 id="1-ç»„åˆå¯†ç "><a href="#1-ç»„åˆå¯†ç " class="headerlink" title="1.ç»„åˆå¯†ç "></a>1.ç»„åˆå¯†ç </h2><p>é¦–å…ˆæ‹¿åˆ°çš„é™„ä»¶å¾ˆç®€å•ï¼Œå°±ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œé‡Œé¢ä¸å‡ºæ„å¤–åº”è¯¥æ˜¯å†™çš„æ‘©å°”æ–¯ç”µç ã€‚éšä¾¿åœ¨ç½‘ä¸Šæ‰¾ä¸€ä¸ªè§£å¯†ç½‘ç«™è§£å¯†ï¼Œå¾—åˆ°äº†ä¸€ä¸²æ•°å­—ï¼Œçœ‹åˆ°æ‰€æœ‰çš„æ•°å­—éƒ½åœ¨$40$åˆ°$128$ä¹‹é—´ï¼Œåº”è¯¥æ˜¯ASCIIç ï¼Œè½¬æ¢æˆå­—ç¬¦ï¼Œå‘ç°æœ€åæ˜¯ä¸¤ä¸ªç­‰äºå·ï¼Œæœæ–­Base64è§£å¯†ã€‚</p><p>Base64è§£å¯†ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°äº†è¿™æ ·ä¸€ä¸²å­—ç¬¦ï¼š<code>Vigenere +Liki:&#125;VkmvJb!1XtAxe!hpM1&#123;M+9xqzrTM_Nj~cRg4x</code></p><p>çœ‹æ¥åº”è¯¥æ˜¯ç»´å‰å°¼äºšå¯†ç ï¼Œç”¨å¯†é’¥<code>Liki</code>è¿›è¡Œè§£å¯†ï¼Œç„¶åå°±å¾—åˆ°äº†è¿™æ ·çš„å†…å®¹ï¼š<code>&#125;KccnYt!1NlPpu!zeE1&#123;C+9pfrhLB_Fz~uGy4n</code></p><p>æ„Ÿè§‰æ²¡ä»€ä¹ˆæ€è·¯ï¼Œä¸è¿‡çœ‹åˆ°ä¸¤ä¸ªå¤§æ‹¬å·çš„é¡ºåºæ˜¯ä¹±çš„ï¼Œç›®æµ‹åº”è¯¥æ˜¯æ …æ å¯†ç ï¼Œä¸€ä¸ªä¸€ä¸ªè°ƒï¼Œå‘ç°æ …æ æ•°é‡æ˜¯$6$çš„æ—¶å€™ï¼Œæ¯”è¾ƒç¬¦åˆflagçš„æ ¼å¼ï¼š<code>&#125;!!Ch~K1z+LucNe9BGclEp_ynP1fF4Yp&#123;rzntu</code>ã€‚</p><p>ä¸éš¾å‘ç°æœ€å$5$ä¸ªå­—æ¯å¯¹åº”çš„æ˜æ–‡åº”è¯¥æ˜¯<code>emagh</code>ï¼Œç¬¦åˆå‡¯æ’’å¯†ç çš„æ ·å¼ã€‚å› æ­¤ç›´æ¥æ‰¾ä¸€ä¸ªå‡¯æ’’å¯†ç è§£å¯†çš„ç½‘ç«™å³å¯å¾—åˆ°æœ€ç»ˆçš„ç»“æœï¼Œæœ€åå€’è¿‡æ¥æäº¤ä»¥ä¸‹å°±è¡Œäº†ã€‚</p><h2 id="2-å¯¹ç§°ä¹‹ç¾"><a href="#2-å¯¹ç§°ä¹‹ç¾" class="headerlink" title="2.å¯¹ç§°ä¹‹ç¾"></a>2.å¯¹ç§°ä¹‹ç¾</h2><h3 id="PART-1-é˜…è¯»é¢˜ç›®"><a href="#PART-1-é˜…è¯»é¢˜ç›®" class="headerlink" title="PART 1 é˜…è¯»é¢˜ç›®"></a>PART 1 é˜…è¯»é¢˜ç›®</h3><p>é¦–å…ˆå…ˆæ¥çœ‹ä¸€ä¸‹é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> FLAG<br>key = <span class="hljs-string">&#x27;&#x27;</span>.join(random.choices(string.ascii_letters + string.digits, k=<span class="hljs-number">16</span>))<br>cipher = <span class="hljs-built_in">bytes</span>([<span class="hljs-built_in">ord</span>(m)^<span class="hljs-built_in">ord</span>(k) <span class="hljs-keyword">for</span> m, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(FLAG, itertools.cycle(key))])<br><span class="hljs-built_in">print</span>(cipher)<br><span class="hljs-comment">#cipher=*</span><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†å¯†é’¥çš„é•¿åº¦æ˜¯$16$ï¼Œç„¶åæœ€ç»ˆç»“æœå°±æ˜¯å°†flagå’Œå¯†é’¥å¼‚æˆ–å¾—å‡ºæ¥çš„å€¼ã€‚å…¶ä¸­å¯†é’¥é‡Œåªå«æœ‰A-Z,a-zå’Œ0-9ï¼Œå¯†æ–‡çš„é•¿åº¦æ˜¯$1069$</p><h3 id="PART-2-æ‹†è§£å¯†æ–‡ï¼Œè®¡ç®—æ–¹å·®"><a href="#PART-2-æ‹†è§£å¯†æ–‡ï¼Œè®¡ç®—æ–¹å·®" class="headerlink" title="PART 2 æ‹†è§£å¯†æ–‡ï¼Œè®¡ç®—æ–¹å·®"></a>PART 2 æ‹†è§£å¯†æ–‡ï¼Œè®¡ç®—æ–¹å·®</h3><p>å‘ç°å¯†é’¥çš„é•¿åº¦æ˜¯$16$ï¼Œå¯†æ–‡å¾ˆé•¿ï¼Œä¸å‡ºæ„å¤–åº”è¯¥æ˜¯é€šè¿‡å­—æ¯é¢‘ç‡æ”»å‡»å¾—åˆ°çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¼–å†™C++ç¨‹åºï¼Œå°†å¯†æ–‡ä¸­çš„ç¬¬$1,17,33â€¦$ä½ï¼Œ$2,18,34,â€¦$ä½è¿›è¡Œé€ä¸ªæ‹†è§£ï¼Œç„¶åæ¯ä¸ªæ–‡ä»¶éƒ½çˆ†ç ´ä¸€ä¸‹ï¼Œè®¡ç®—çˆ†ç ´æ—¶çš„æ–¹å·®å³å¯ã€‚</p><p>æ‹†è§£å¯†æ–‡çš„ä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> a[<span class="hljs-number">10000</span>];<br><span class="hljs-type">char</span> s[<span class="hljs-number">40</span>]=<span class="hljs-string">&quot;Cip00.txt&quot;</span>;<br><span class="hljs-type">int</span> f[<span class="hljs-number">18</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>&#125;;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">generate</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>s[<span class="hljs-number">3</span>]=<span class="hljs-string">&#x27;0&#x27;</span>+x/<span class="hljs-number">10</span>;<br>s[<span class="hljs-number">4</span>]=<span class="hljs-string">&#x27;0&#x27;</span>+x%<span class="hljs-number">10</span>;<br>FILE *gp=<span class="hljs-built_in">fopen</span>(s,<span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-keyword">for</span>(i=x;i&lt;=<span class="hljs-number">1069</span>;i+=<span class="hljs-number">16</span>)<br><span class="hljs-built_in">fprintf</span>(gp,<span class="hljs-string">&quot;%d\n&quot;</span>,a[i]);<br><span class="hljs-built_in">fclose</span>(gp);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>FILE *fp;<br><span class="hljs-type">int</span> i,j;<br>fp=<span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;cipher.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">1069</span>;i++) <br><span class="hljs-built_in">fscanf</span>(fp,<span class="hljs-string">&quot;%d&quot;</span>,&amp;a[i]);<br><span class="hljs-built_in">fclose</span>(fp);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">16</span>;i++)<br><span class="hljs-built_in">generate</span>(i);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure><p>ç„¶åæ˜¯çˆ†ç ´å¯†é’¥çš„ä»£ç ï¼Œå…¶ä¸­lossæ˜¯è®¡ç®—çš„æ–¹å·®ï¼Œåˆå§‹åŒ–å‡½æ•°é‡Œæœ‰æ¯ä¸ªå­—æ¯å‡ºç°çš„æ¦‚ç‡ï¼Œæ¯”å¦‚<code>A</code>å‡ºç°çš„æ¦‚ç‡æ˜¯$8.15\text{percent}$(æ³¨ï¼šä»¥ååšå®¢ä¸­ç™¾åˆ†å·ç”¨percentå•è¯è¡¨ç¤ºï¼Œå› ä¸ºä¸Šä¼ åšå®¢æ—¶æœ‰ç™¾åˆ†å·çš„åœ°æ–¹ä¼šå‡ºé”™)ï¼Œé‚£ä¹ˆ<code>pos[0]=8.15</code></p><p>æˆ‘ä»¬æŠŠæ¯æ¬¡çˆ†ç ´å‡ºçš„æ¦‚ç‡æ”¾åˆ°<code>cul</code>æ•°ç»„ä¸­ï¼Œæœ€åçš„æ–¹å·®$ V&#x3D;\sum_{i&#x3D;0}^{25}(\mathrm{pos}[i]-\mathrm{cul}[i])^2 $ã€‚</p><p>è¿™ä¸ªæ–¹æ³•ä¹Ÿå¾ˆå·§å¦™ï¼Œå› ä¸ºè¿™ä¸ªä»£ç å¯ä»¥é€šè¿‡ä¿®æ”¹å­—ç¬¦æ•°ç»„çš„æ–¹å¼ ï¼Œè¿ç»­è¯»å–$16$ä¸ªæ–‡ä»¶ï¼Œå¹¶å¯¹åº”è¾“å‡º$16$ä¸ªæ–‡ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">asdf</span>&#123;<span class="hljs-type">char</span> chr;<span class="hljs-type">double</span> loss;<br>&#125;data[<span class="hljs-number">95</span>];<br><span class="hljs-type">double</span> pos[<span class="hljs-number">26</span>],cul[<span class="hljs-number">26</span>],K=<span class="hljs-number">0</span>;<br><span class="hljs-type">char</span> files[<span class="hljs-number">26</span>]=<span class="hljs-string">&quot;Cip00.txt&quot;</span>;<br><span class="hljs-type">char</span> outfiles[<span class="hljs-number">26</span>]=<span class="hljs-string">&quot;Res00.txt&quot;</span>;<br><span class="hljs-type">char</span> Table[<span class="hljs-number">90</span>]=<span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>;<br><span class="hljs-type">int</span> a[<span class="hljs-number">45000</span>],b[<span class="hljs-number">45000</span>],n=<span class="hljs-number">0</span>; <br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(asdf a,asdf b)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">return</span> a.loss&lt;b.loss;<br>&#125; <br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">memset</span>(cul,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(cul));<br><span class="hljs-built_in">memset</span>(a,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(a));<br><span class="hljs-built_in">memset</span>(b,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(b));<br>n=<span class="hljs-number">0</span>;K=<span class="hljs-number">0</span>;<br>files[<span class="hljs-number">3</span>]=<span class="hljs-string">&#x27;0&#x27;</span>+x/<span class="hljs-number">10</span>;<br>files[<span class="hljs-number">4</span>]=<span class="hljs-string">&#x27;0&#x27;</span>+x%<span class="hljs-number">10</span>;<br>outfiles[<span class="hljs-number">3</span>]=<span class="hljs-string">&#x27;0&#x27;</span>+x/<span class="hljs-number">10</span>;<br>outfiles[<span class="hljs-number">4</span>]=<span class="hljs-string">&#x27;0&#x27;</span>+x%<span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> i,j;<br>pos[<span class="hljs-number">0</span>]=<span class="hljs-number">8.15</span>,pos[<span class="hljs-number">1</span>]=<span class="hljs-number">1.44</span>,pos[<span class="hljs-number">2</span>]=<span class="hljs-number">2.76</span>,pos[<span class="hljs-number">3</span>]=<span class="hljs-number">3.79</span>;<br>pos[<span class="hljs-number">4</span>]=<span class="hljs-number">13.11</span>,pos[<span class="hljs-number">5</span>]=<span class="hljs-number">2.92</span>,pos[<span class="hljs-number">6</span>]=<span class="hljs-number">1.99</span>,pos[<span class="hljs-number">7</span>]=<span class="hljs-number">5.26</span>;<br>pos[<span class="hljs-number">8</span>]=<span class="hljs-number">6.35</span>,pos[<span class="hljs-number">9</span>]=<span class="hljs-number">0.13</span>,pos[<span class="hljs-number">10</span>]=<span class="hljs-number">0.42</span>,pos[<span class="hljs-number">11</span>]=<span class="hljs-number">3.39</span>;<br>pos[<span class="hljs-number">12</span>]=<span class="hljs-number">2.54</span>,pos[<span class="hljs-number">13</span>]=<span class="hljs-number">7.1</span>,pos[<span class="hljs-number">14</span>]=<span class="hljs-number">8</span>,pos[<span class="hljs-number">15</span>]=<span class="hljs-number">1.98</span>;<br>pos[<span class="hljs-number">16</span>]=<span class="hljs-number">0.12</span>,pos[<span class="hljs-number">17</span>]=<span class="hljs-number">6.83</span>,pos[<span class="hljs-number">18</span>]=<span class="hljs-number">6.1</span>,pos[<span class="hljs-number">19</span>]=<span class="hljs-number">10.47</span>;<br>pos[<span class="hljs-number">20</span>]=<span class="hljs-number">2.46</span>,pos[<span class="hljs-number">21</span>]=<span class="hljs-number">0.92</span>,pos[<span class="hljs-number">22</span>]=<span class="hljs-number">1.54</span>,pos[<span class="hljs-number">23</span>]=<span class="hljs-number">0.17</span>;<br>pos[<span class="hljs-number">24</span>]=<span class="hljs-number">1.98</span>,pos[<span class="hljs-number">25</span>]=<span class="hljs-number">0.08</span>; <br>FILE *fp=<span class="hljs-built_in">fopen</span>(files,<span class="hljs-string">&quot;r&quot;</span>);<br><span class="hljs-keyword">while</span>(~<span class="hljs-built_in">fscanf</span>(fp,<span class="hljs-string">&quot;%d&quot;</span>,&amp;a[++n]));<br>n--;<br><span class="hljs-built_in">fclose</span>(fp);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">culcloss</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">memset</span>(cul,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(cul));<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-type">double</span> V=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br>&#123;<br><span class="hljs-keyword">if</span>(b[i]&gt;=<span class="hljs-string">&#x27;A&#x27;</span>&amp;&amp;b[i]&lt;=<span class="hljs-string">&#x27;Z&#x27;</span>)<br>cul[b[i]<span class="hljs-number">-65</span>]++;<br><span class="hljs-keyword">if</span>(b[i]&gt;=<span class="hljs-string">&#x27;a&#x27;</span>&amp;&amp;b[i]&lt;=<span class="hljs-string">&#x27;z&#x27;</span>)<br>cul[b[i]<span class="hljs-number">-97</span>]++;<br>&#125;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">26</span>;i++)<br>V+=(pos[i]-cul[i])*(pos[i]-cul[i])*<span class="hljs-number">100</span>/K;<br><span class="hljs-keyword">return</span> V;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>K=<span class="hljs-number">0</span>;<br><span class="hljs-built_in">memset</span>(b,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(b));<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br>b[i]=a[i]^Table[x];<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br><span class="hljs-keyword">if</span>(b[i]&gt;=<span class="hljs-string">&#x27;a&#x27;</span>&amp;&amp;b[i]&lt;=<span class="hljs-string">&#x27;z&#x27;</span>||b[i]&gt;=<span class="hljs-string">&#x27;A&#x27;</span>&amp;&amp;b[i]&lt;=<span class="hljs-string">&#x27;Z&#x27;</span>)<br>++K;<br>data[x].chr=Table[x];<br>data[x].loss=<span class="hljs-built_in">culcloss</span>();<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">16</span>;i++)<br>&#123;<br><span class="hljs-built_in">init</span>(i);<br><span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-built_in">strlen</span>(Table);j++)<br><span class="hljs-built_in">solve</span>(j);<br><span class="hljs-built_in">sort</span>(data,data+<span class="hljs-built_in">strlen</span>(Table),cmp);<br>FILE *gp=<span class="hljs-built_in">fopen</span>(outfiles,<span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-built_in">strlen</span>(Table);j++)<br><span class="hljs-built_in">fprintf</span>(gp,<span class="hljs-string">&quot;chr=%c  loss=%.4lf\n&quot;</span>,data[j].chr,data[j].loss);<br><span class="hljs-built_in">fclose</span>(gp);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="PART-3-æœ€åè°ƒæ•´ï¼Œå¾—å‡ºç­”æ¡ˆ"><a href="#PART-3-æœ€åè°ƒæ•´ï¼Œå¾—å‡ºç­”æ¡ˆ" class="headerlink" title="PART 3 æœ€åè°ƒæ•´ï¼Œå¾—å‡ºç­”æ¡ˆ"></a>PART 3 æœ€åè°ƒæ•´ï¼Œå¾—å‡ºç­”æ¡ˆ</h3><p>æˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬$1$ç»„è¾“å‡ºçš„å‰$6$è¡Œè¾“å‡ºå’Œç¬¬$4$ç»„è¾“å‡ºçš„å‰$6$è¡Œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Res01.txt                             _ [] X<br>____________________________________________<br><span class="hljs-attribute">chr</span>=8  <span class="hljs-attribute">loss</span>=507.0642<br><span class="hljs-attribute">chr</span>=9  <span class="hljs-attribute">loss</span>=748.7868<br><span class="hljs-attribute">chr</span>=2  <span class="hljs-attribute">loss</span>=1161.6835<br><span class="hljs-attribute">chr</span>=3  <span class="hljs-attribute">loss</span>=1385.8863<br><span class="hljs-attribute">chr</span>=4  <span class="hljs-attribute">loss</span>=1426.1932<br><span class="hljs-attribute">chr</span>=5  <span class="hljs-attribute">loss</span>=1430.1443<br><br>Res04.txt                             _ [] X<br>_____________________________________________<br><span class="hljs-attribute">chr</span>=e  <span class="hljs-attribute">loss</span>=418.8335<br><span class="hljs-attribute">chr</span>=E  <span class="hljs-attribute">loss</span>=418.8335<br><span class="hljs-attribute">chr</span>=c  <span class="hljs-attribute">loss</span>=755.6027<br><span class="hljs-attribute">chr</span>=C  <span class="hljs-attribute">loss</span>=755.6027<br><span class="hljs-attribute">chr</span>=d  <span class="hljs-attribute">loss</span>=844.2964<br><span class="hljs-attribute">chr</span>=D  <span class="hljs-attribute">loss</span>=844.2964<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç¬¬ä¸€ç»„è¾“å‡ºlossæœ€å°çš„æ˜¯å­—ç¬¦$8$ï¼Œæ‰€ä»¥å¯†é’¥åº”è¯¥æ˜¯ä»¥$8$å¼€å¤´çš„ï¼Œä¸è¿‡é—®é¢˜æ¥äº†ï¼Œæ¯ç»„è¾“å‡ºå¯¹åº”çš„å¤§å°å†™å­—æ¯éƒ½æ˜¯ä¸€è‡´çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬$4$ç»„è¾“å‡ºæˆ‘ä»¬æ— æ³•åˆ¤æ–­Eç©¶ç«Ÿæ˜¯å¤§å†™è¿˜æ˜¯å°å†™ã€‚</p><p>æˆ‘ä»¬è¿™è¾¹å¯ä»¥å‡è®¾æ‰€æœ‰çš„å­—æ¯éƒ½æ˜¯å¤§å†™å­—æ¯ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å°è¯•è§£å¯†ã€‚æ ¹æ®æˆ‘è§£å‡ºçš„ç»“æœæ˜¯<code>key=b&#39;89QEUTFDJAECOLTK&#39;</code></p><p>ç„¶åå¸¦å…¥å¯†æ–‡è¿›è¡Œå¼‚æˆ–è§£å¯†ï¼Œå‰40ä½æ˜¯è¿™æ ·çš„ï¼š<code>\nSYmmetry\x00In\x00ARt iS when THe\x00ELemeNts of</code></p><p>å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰<code>\x00</code>ï¼Œå¯¹åº”çš„ASCIIç æ˜¯$0$ï¼Œè€Œå¦‚æœæˆ‘ä»¬å°†å¯¹åº”çš„éƒ¨åˆ†æ”¹æˆå°å†™å­—æ¯ï¼Œé‚£ä¹ˆç»“æœåº”è¯¥æ˜¯<code>\x20</code>ï¼Œä¹Ÿå°±æ˜¯ç©ºæ ¼äº†ã€‚</p><p>ä¿®æ”¹ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å‘ç°å¾ˆå¤šåœ°æ–¹çš„å¤§å°å†™å­—æ¯æ‚ä¹±ï¼Œçœ‹åˆ°è¾“å‡ºå®é™…ä¸Šæœ‰è‹±æ–‡å¥å·çš„ï¼Œé‚£ä¹ˆå¯ä»¥æ¨å‡ºåªæœ‰ä¸€å¥è¯çš„å¼€å¤´æ‰èƒ½ç”¨å¤§å†™å­—æ¯ï¼Œæ‰€ä»¥ä¸å¯¹çš„åœ°æ–¹å¯†é’¥å‰ç»™æˆå°å†™å­—æ¯ï¼Œæœ€ç»ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°æ­£ç¡®çš„å¯†é’¥æ˜¯<code>b&#39;89qEUTFDJaeColtK&#39;</code></p><p>æœ€åæˆ‘ä»¬å°±å¯ä»¥å¾—å‡ºç­”æ¡ˆäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> cipher<br>key=<span class="hljs-string">b&#x27;89qEUTFDJaeColtK&#x27;</span><br>s=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher)):<br>    s+=<span class="hljs-built_in">chr</span>(key[i%<span class="hljs-built_in">len</span>(key)]^cipher[i])<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Symmetry in art is when the elements of </span><br><span class="hljs-string">a painting or drawing balance each other </span><br><span class="hljs-string">out. This could be the objects themselves, </span><br><span class="hljs-string">but it can also relate to colors and </span><br><span class="hljs-string">other compositional techniques.</span><br><span class="hljs-string">You may not realize it, but your brain </span><br><span class="hljs-string">is busy working behind the scenes to seek </span><br><span class="hljs-string">out symmetry when you look at a painting. </span><br><span class="hljs-string">There are several reasons for this. The </span><br><span class="hljs-string">first is that we&#x27;re hard-wired to look for </span><br><span class="hljs-string">it. Our ancient ancestors may not have had </span><br><span class="hljs-string">a name for it, but they knew that their </span><br><span class="hljs-string">own bodies were basically symmetrical, as </span><br><span class="hljs-string">were those of potential predators or prey. </span><br><span class="hljs-string">Therefore, this came in handy whether </span><br><span class="hljs-string">choosing a mate, catching dinner or </span><br><span class="hljs-string">avoiding being on the menu of a snarling, </span><br><span class="hljs-string">hungry pack of wolves or bears!</span><br><span class="hljs-string">Take a look at your face in the mirror </span><br><span class="hljs-string">and imagine a line straight down the </span><br><span class="hljs-string">middle. You&#x27;ll see both sides of your </span><br><span class="hljs-string">face are pretty symmetrical. This is </span><br><span class="hljs-string">known as bilateral symmetry and it&#x27;s </span><br><span class="hljs-string">where both sides either side of this </span><br><span class="hljs-string">dividing line appear more or less the same.</span><br><span class="hljs-string">So here is the flag: </span><br><span class="hljs-string">hgame&#123;X0r_i5-a_uS3fU1+4nd$fUNny_C1pH3r&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="3-Transformer"><a href="#3-Transformer" class="headerlink" title="3.Transformer"></a>3.Transformer</h2><p>é¢˜ç›®æ„æ€å¾ˆç®€å•ï¼Œä¸€ä¸ªæ›¿æ¢å¯†ç ï¼Œç»™å‡ºäº†$240$ä¸ªç‰‡æ®µå’Œæ‰“ä¹±çš„å¯†æ–‡ã€‚ä¸è¿‡è™½ç„¶æ˜¯æ‰“ä¹±çš„ï¼Œä½†æ˜¯è§£å‹åæˆ‘ä»¬åªéœ€è¦åœ¨æ–‡ä»¶å¤¹ä¸­æŒ‰å¤§å°æ’åºï¼Œå°±å¯ä»¥åšåˆ°åŸºæœ¬å¯¹åº”äº†ï¼ˆå› ä¸ºæ›¿æ¢å¯†ç åŠ å¯†åé•¿åº¦ä¸å˜ã€‚ï¼Œæœ€çŸ­çš„æ˜¯$25$å­—èŠ‚çš„ï¼Œä¸€å…±æœ‰$7$ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦é˜…è¯»$7$ä¸ªå³å¯ã€‚</p><p>çœ‹åˆ°flagæ–‡ä»¶ä¸­æœ‰ç–‘ä¼¼flagçš„å†…å®¹ï¼Œå¾ˆæ˜æ˜¾ï¼Œåº”è¯¥æœæ–­æ›¿æ¢ï¼Œç›²çŒœæœ€å‰é¢çš„å†…å®¹æ˜¯<code>hgame</code>ï¼Œå…¶ä»–å‡ ä¸ªæœªçŸ¥çš„å­—ç¬¦ä¹Ÿå¯ä»¥åŠ è¿›å»ï¼Œæœ€åå¾—åˆ°äº†è¿™æ ·çš„å†…å®¹ï¼š<code>hgame&#123;ea5y_f0r_fun^3nd&amp;he11o_&#125;</code></p><p>ä¸è¿‡æœ€åæäº¤ä¹‹åä¸€ç›´ä¸å¯¹ï¼Œçœ‹æ¥è¿˜å°‘äº›ä»€ä¹ˆï¼Œå›é¡¾å¯†æ–‡ï¼Œæˆ‘ä»¬å†³å®šæŠŠç»™å‡ºçš„è¿™æ®µè¯ç ´è¯‘æ‰</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">Tqh ufso mnfcyh eaikauh kdkoht qpk aiud zkhc xpkkranc uayfi kfieh <span class="hljs-number">2003</span>, oqh xpkkranc fk <span class="hljs-string">&quot;qypth&#123;hp5d_s0n_szi^3ic&amp;qh11a_&#125;&quot;</span>,Dai<span class="hljs-comment">&#x27;o sanyho oa pcc oqh dhpn po oqh hic.</span><br></code></pre></td></tr></table></figure><p>æœç„¶ï¼Œç ´è¯‘åæœ‰äº†å¤§å‘ç°ï¼šæœ€åçš„ä¸€å¥è¯å†…å®¹æ˜¯<code>to add the year at the end</code>ï¼Œé‚£ä¹ˆåé¢åº”è¯¥åŠ ä¸ª$2021$ï¼Œæœ€åæäº¤å†…å®¹æ˜¯ </p><p><code>hgame&#123;ea5y_f0r_fun^3nd&amp;he11o_2021&#125;</code>ï¼Œæœç„¶å¯¹äº†ã€‚</p><h2 id="4-signin"><a href="#4-signin" class="headerlink" title="4.signin"></a>4.signin</h2><p>å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util <span class="hljs-keyword">import</span> number<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> FLAG<br>m = s2n(FLAG)<br>a = number.getPrime(<span class="hljs-number">1024</span>)<br>p = number.getPrime(<span class="hljs-number">1024</span>)<br>c = a ** p * m % p<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(p))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(c))<br></code></pre></td></tr></table></figure><p>é¢˜ç›®æœ€åç»™å‡ºäº†$a,p,c$çš„å€¼ã€‚å…¶ä¸­$a^pm\equiv c\pmod p$ã€‚</p><p>æ ¹æ®è´¹é©¬å°å®šç†å¯çŸ¥ï¼Œ$a^p\equiv a\pmod p$ï¼Œå› æ­¤åŸå¼å°±æ˜¯$am\equiv c \pmod p$ï¼Œæ•…$a^{-1}c\equiv m \pmod p$ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨å†…ç½®å‡½æ•°æ±‚ä¸ªé€†å…ƒå°±ç»“æŸäº†ã€‚</p><h2 id="5-WhitegiveRSA"><a href="#5-WhitegiveRSA" class="headerlink" title="5.WhitegiveRSA"></a>5.WhitegiveRSA</h2><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">882564595536224140639625987659416029426239230804614613279163</span><br><span class="hljs-attribute">e</span> <span class="hljs-operator">=</span> <span class="hljs-number">65537</span><br><span class="hljs-attribute">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">747831491353896780365654517748216624798517769637260742155527</span><br></code></pre></td></tr></table></figure><p>é¢˜ç›®æè¿°å¾—å¾ˆç®€å•ã€‚çœ‹åˆ°$N$å¹¶ä¸æ˜¯ç‰¹åˆ«é•¿ï¼Œç›´æ¥æ”¾Sagemathåˆ†è§£å°±å¾—åˆ°<br>$$<br>N&#x3D;857504083339712752489993810777 Ã—1029224947942998075080348647219<br>$$<br>ç„¶åå°±æ˜¯æ­£å¸¸çš„å› å¼åˆ†è§£äº†ã€‚</p><h2 id="6-gcd-or-more"><a href="#6-gcd-or-more" class="headerlink" title="6.gcd or more?"></a>6.gcd or more?</h2><p>è¿™é“é¢˜æ˜¯RSAï¼Œ$e&#x3D;2$çš„æƒ…æ™¯ï¼Œé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯æšä¸¾$m&#x3D;kn+c$ï¼Œä¸è¿‡è²Œä¼¼ä¸å¯è¡Œ</p><p>$e&#x3D;2$æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å£ç®—å‡º$x^2\equiv 1 \pmod p$çš„è§£æ˜¯$1$å’Œ$p-1$ã€‚ç„¶åSagemathå¼€æ ¹å¾—å‡ºä¸€ä¸ªç‰¹è§£ã€‚</p><p>æœ€åå°±æ˜¯å‚è€ƒ<strong>RSA Notes 3</strong>çš„å†…å®¹ï¼Œ$e,\phi$ä¸äº’ç´ çš„æƒ…å†µçš„è§£æ³•ã€‚</p><h2 id="7-The-Password"><a href="#7-The-Password" class="headerlink" title="7.The Password"></a>7.The Password</h2><p>é¢˜ç›®çš„å…·ä½“è¦æ±‚è¯´çš„å¾ˆæ˜ç™½äº†ï¼Œå°±æ˜¯æ±‚æœ€åçš„$x$ã€‚</p><p><img src="/2021/02/14/HgameDiv1/1.png" alt="1"></p><p>é¦–å…ˆï¼Œæœ€å®¹æ˜“æƒ³åˆ°çš„ï¼Œå°±æ˜¯å¼‚æˆ–è¿ç®—çš„äº¤æ¢æ€§å’Œç›¸åŒçš„æ•°å¼‚æˆ–ç­‰äº$0$çš„æ€§è´¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰çš„$y$ä¸$n$å…ˆè¿›è¡Œå¼‚æˆ–æ›´æ–°ä¸‹ã€‚</p><p>åˆšå¼€å§‹æ‹¿åˆ°é¢˜ç›®çš„æ—¶å€™ï¼Œä»¥ä¸ºæ˜¯æ¢…æ£®æ—‹è½¬ä¸­çš„ç§»ä½ï¼Œä¸è¿‡æœ€åå‘ç°ç§»ä½æ˜¯å¾ªç¯ç§»ä½ã€‚</p><p>è€ƒè™‘åˆ°å¼‚æˆ–æ˜¯äºŒè¿›åˆ¶é‡Œçš„åŠ ï¼ŒåŠ ä¸Šè¿‘æœŸè‡ªå·±æ­£åœ¨å­¦æ ¼å¯†ç ï¼Œå› æ­¤æƒ³åˆ°äº†çŸ©é˜µè¿ç®—ã€‚</p><p><img src="/2021/02/14/HgameDiv1/2.png" alt="2"></p><p>éªŒè¯äº†ä¸€ä¸‹ï¼Œæœç„¶ç¬¦åˆå¾ªç¯ç§»ä½å¼‚æˆ–çš„ç»“æœã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„å»ºçŸ©é˜µæ¥è§£å†³é—®é¢˜äº†ï¼Œé™„ä¸Šsagemathä¸­çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">y,n,l,r</span>):<br>    y^^=n<br>    M,v=[],[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>        M.append([<span class="hljs-number">0</span>]*<span class="hljs-number">64</span>)<br>        v.append([<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>        M[i][i],M[i][(i-l)%<span class="hljs-number">64</span>],M[i][(i+r)%<span class="hljs-number">64</span>]=<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span><br>    M=matrix(GF(<span class="hljs-number">2</span>),M)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>        v[i]=y&amp;<span class="hljs-number">1</span><br>        y&gt;&gt;=<span class="hljs-number">1</span><br>    v=vector(GF(<span class="hljs-number">2</span>),v)<br>    M=M^-<span class="hljs-number">1</span><br>    G=vector(ZZ,M*v)<br>    s=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>        s+=(G[i]&lt;&lt;i)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(s))<br><span class="hljs-comment">#------main-below------#</span><br>Y=[<span class="hljs-number">15789597796041222200</span>,<span class="hljs-number">8279663441787235887</span>,<span class="hljs-number">9666438290109535850</span>,<span class="hljs-number">10529571502219113153</span>,<span class="hljs-number">8020289479524135048</span>,<span class="hljs-number">10914636017953100490</span>,<span class="hljs-number">4622436850708129231</span>]<br>N=[<span class="hljs-number">14750142427529922</span>,<span class="hljs-number">2802568775308984</span>,<span class="hljs-number">15697145971486341</span>,<span class="hljs-number">9110411034859362</span>,<span class="hljs-number">4092084344173014</span>,<span class="hljs-number">2242282628961085</span>,<span class="hljs-number">10750832281632461</span>]<br>L=[<span class="hljs-number">3</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>,<span class="hljs-number">13</span>,<span class="hljs-number">64</span>-<span class="hljs-number">16</span>,<span class="hljs-number">7</span>,<span class="hljs-number">5</span>]<br>R=[<span class="hljs-number">7</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    solve(Y[i],N[i],L[i],R[i])<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">0x6867616d657b6c</span><br><span class="hljs-string">0x316e6530725f61</span><br><span class="hljs-string">0x31676562723026</span><br><span class="hljs-string">0x697340316d706f</span><br><span class="hljs-string">0x7231306e315e31</span><br><span class="hljs-string">0x6e246372797074</span><br><span class="hljs-string">0x6f7d</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>flagä¹Ÿå°±å¾—å‡ºæ¥äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>21Feb1</title>
    <link href="/2021/02/09/21Feb1/"/>
    <url>/2021/02/09/21Feb1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å¼€å­¦å‰çš„åˆ‡é¢˜1"><a href="#huangx607087å¼€å­¦å‰çš„åˆ‡é¢˜1" class="headerlink" title="huangx607087å¼€å­¦å‰çš„åˆ‡é¢˜1"></a>huangx607087å¼€å­¦å‰çš„åˆ‡é¢˜1</h1><h2 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0.ç®€ä»‹"></a>0.ç®€ä»‹</h2><p>ä»Šå¤©BUUCTFä¸Šåˆ°äº†2500åˆ†ï¼ŒCryptoæ¦œï¼Œä¼šè§£æ¯”è¾ƒç®€å•çš„æ ¼å¯†ç å­¦çš„é¢˜ç›®äº†ã€‚åŒæ—¶æ¤­åœ†æ›²çº¿çš„å†…å®¹ä¹Ÿçœ‹äº†ä¸€äº›ã€‚BUUä¸Šåˆ·äº†å‡ é¢˜ï¼Œä¸è¿‡å› ä¸ºæ˜¯æ·±æ°´åŒºï¼Œéƒ½æ˜¯éå¸¸éš¾çš„å¤§é¢˜ç›®ï¼Œçœ‹æ¥è‡ªå·±CTFçš„æ°´å¹³è¿˜æ˜¯æœ‰ä¸€å®šå·®è·çš„ï¼ˆ</p><h2 id="1-CISCN2018-sm"><a href="#1-CISCN2018-sm" class="headerlink" title="1.[CISCN2018]sm"></a>1.[CISCN2018]sm</h2><p>æŒ‰ç…§æƒ¯ä¾‹åº”è¯¥å…ˆé˜…è¯»ä¸€ä¸‹é¢˜ç›®ï¼Œå¯ä»¥çœ‹å‡ºBUUCTFçš„æ·±æ°´åŒºçš„é¢˜ç›®éƒ½æ˜¯éå¸¸éš¾çš„ï¼Œä»£ç é•¿åº¦ä¹Ÿç›¸æ¯”äºä»¥å‰å¢åŠ äº†å¾ˆå¤šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime,long_to_bytes,bytes_to_long<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen512num</span>():<br>    order=[]<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(order)!=<span class="hljs-number">512</span>:<br>        tmp=randint(<span class="hljs-number">1</span>,<span class="hljs-number">512</span>)<br>        <span class="hljs-keyword">if</span> tmp <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> order:<br>            order.append(tmp)<br>    ps=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>):<br>        p=getPrime(<span class="hljs-number">512</span>-order[i]+<span class="hljs-number">10</span>)<br>        pre=<span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:][<span class="hljs-number">0</span>:(<span class="hljs-number">512</span>-order[i])]+<span class="hljs-string">&quot;1&quot;</span><br>        ps.append(<span class="hljs-built_in">int</span>(pre+<span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">512</span>-<span class="hljs-built_in">len</span>(pre)),<span class="hljs-number">2</span>))<br>    <span class="hljs-keyword">return</span> ps<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():<br>    choose=getPrime(<span class="hljs-number">512</span>)<br>    ps=gen512num()<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;gen over&quot;</span><br>    bchoose=<span class="hljs-built_in">bin</span>(choose)[<span class="hljs-number">2</span>:]<br>    r=<span class="hljs-number">0</span><br>    bchoose = <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">512</span>-<span class="hljs-built_in">len</span>(bchoose))+bchoose<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>):<br>        <span class="hljs-keyword">if</span> bchoose[i]==<span class="hljs-string">&#x27;1&#x27;</span>:<br>            r=r^ps[i]<br>    flag=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>).read()<br>    key=long_to_bytes(<span class="hljs-built_in">int</span>(hashlib.md5(long_to_bytes(choose)).hexdigest(),<span class="hljs-number">16</span>))<br>    aes_obj = AES.new(key, AES.MODE_ECB)<br>    ef=aes_obj.encrypt(flag).encode(<span class="hljs-string">&quot;base64&quot;</span>)<br>    <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>).write(<span class="hljs-built_in">str</span>(r))<br>    <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ef&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>).write(ef)<br>    gg=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> ps:<br>        gg+=<span class="hljs-built_in">str</span>(p)+<span class="hljs-string">&quot;\n&quot;</span><br>    <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ps&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>).write(gg)<br>run()<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ä¸­ç»™å‡ºäº†$r$è¿™ä¸ªæ•°å­—çš„å€¼ï¼Œè¿˜ç»™å‡ºäº†psè¿™ä¸ªåºåˆ—ï¼Œå½“ç„¶è¿˜æœ‰åŠ å¯†åçš„flagã€‚</p><p>é¢˜ç›®çš„æ„æ€å¾ˆç®€å•ï¼Œå°±æ˜¯ç”Ÿæˆäº†ä¸€ä¸ªç´ æ•°$p$ï¼Œç„¶åæŠŠç´ æ•°$p$çš„äºŒè¿›åˆ¶è¡¨ç¤ºå‡ºæ¥ï¼Œå¹¶ä¸”ç”Ÿæˆäº†$512$ä¸ªæ•°å­—ã€‚å¦‚æœ$p$çš„é‚£ä¸ªæ¯”ç‰¹ä½æ˜¯$1$é‚£å°±æŠŠ$r$å¼‚æˆ–ä¸€ä¸‹psåºåˆ—ä¸­çš„å€¼ã€‚æœ€åï¼Œ$r$çš„å€¼å°±æ˜¯å¯¹åº”$p$çš„$1$æ¯”ç‰¹ä½ä¸Šçš„é‚£ä¸ªprå€¼å¾—å¼‚æˆ–å’Œã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬é¦–è¦çš„ä»»åŠ¡å°±æ˜¯æ±‚$p$ã€‚è€Œæƒ³è¦æ±‚$p$ï¼Œå°±éœ€è¦æ±‚å‡º$r$æ˜¯å“ªäº›prå€¼çš„å’Œã€‚</p><p>æ‰“å¼€ç»™å‡ºçš„prï¼Œç®€å•æ‰«ä¸€çœ¼ï¼Œå‘ç°å…¨æ˜¯å¶æ•°<del>ï¼ˆå®é™…ä¸Šä»”ç»†çœ‹çš„è¯ï¼Œé‡Œé¢æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå¥‡æ•°ï¼‰</del>ï¼Œè¯´æ˜äº†prç”Ÿæˆæœ‰ç„æœºã€‚å†çœ‹ä¸€çœ¼ï¼šåŸæ¥ç”Ÿæˆæ•°å­—çš„æ—¶å€™ï¼Œå…ˆç”Ÿæˆäº†ä¸€ä¸ª$1$åˆ°$512$çš„ä¸€ä¸ªæ’åˆ—ï¼Œç„¶åç”Ÿæˆçš„é‚£ä¸ªæ•°å­—ï¼Œæ»¡è¶³å…¶æœ€ä½ä½çš„é‚£ä¸ªæ¯”ç‰¹ä½$1$ï¼Œæ°å¥½æ˜¯ä»å³å¾€å·¦æ•°å¯¹åº”æ’åˆ—çš„é‚£ä¸ªæ•°å­—ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±è¦è®¡ç®—å‡ºprä¸­æ‰€æœ‰æ•°å­—çš„æœ€ä½çš„$1$æ¯”ç‰¹ä½æ‰€ä»£è¡¨çš„æ•°å­—ï¼Œå¹¶å¯¹å…¶å–å¯¹æ•°$\log_2$ç„¶åæ•´æ•°åŒ–ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ª$0-511$çš„ä¸€ä¸ªåºåˆ—ã€‚<del>ä½œä¸ºä¸€ä¸ªoierï¼Œæˆ‘æƒ³èµ·äº†ä»¥å‰oiæ—¶æœŸç”¨ä¸Šçš„é‚£ä¸ªlowbitå‡½æ•°</del>ã€‚</p><p>å¾—åˆ°å¯¹åº”çš„$0-511$åºåˆ—ä¹‹åï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å¼‚æˆ–å’Œäº†ã€‚</p><p>è‡ªå·±çš„expç¬¬ä¸€éƒ¨åˆ†å¤šäº†ä¸¤ä¸ªæ•°ç»„ï¼š<code>endexnum,endexid</code>ï¼ˆæ³¨ï¼šindexæ€•æ’åº“å‡½æ•°åï¼Œå› æ­¤æ”¹æˆäº†endexï¼‰ç”¨äºæ±‚æ’åˆ—çš„é€†ï¼Œæ•°ç»„$s$æ˜¯ç”¨äºè®¡ç®—æ’åˆ—çš„ã€‚æ¯”å¦‚ï¼šå‡å¦‚<code>s[15]=334</code>ï¼Œé‚£ä¹ˆæœ‰<code>endexid[334]=15</code>ï¼Œä¸”<code>endexnum[334]</code>å¯¹åº”çš„é‚£ä¸ªæ•°çš„lowbitå€¼ä¸º$15$ã€‚è¿™æ ·å¯ä»¥é¿å…åæœŸç”¨forå¾ªç¯æŸ¥æ‰¾ï¼Œæ¯”è¾ƒçœæ—¶é—´ï¼Œ<del>è™½ç„¶CTFå¯¹äºæ—¶é—´çš„é™åˆ¶æ²¡æœ‰OIé‚£ä¹ˆä¸¥æ ¼</del>ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä»$0$å¼€å§‹ï¼Œåˆ¤æ–­$r$æ˜¯å¦å’Œ$\log_2 \mathrm{lowbit}(x)&#x3D;0$çš„é‚£ä¸ª$x$å€¼å¼‚æˆ–è¿‡äº†ã€‚æ ¹æ®å¼‚æˆ–è®¡ç®—çš„æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¿«å®Œæˆåé¢çš„è®¡ç®—è¿‡ç¨‹ã€‚</p><p>å¾ˆå¿«æˆ‘ä»¬å°±è§£å‡ºäº†ä¸€ä¸ª$p$ï¼Œçœ‹åˆ°å®ƒæ˜¯å¥‡æ•°ï¼ŒéªŒè¯äº†ä¸€ä¸‹ï¼Œå‘ç°ç«Ÿç„¶ä¸æ˜¯ç´ æ•°ã€‚å›é¡¾è‡ªå·±çš„è§£é¢˜è¿‡ç¨‹ï¼Œå‘ç°å¼‚æˆ–å¼€å§‹æ—¶å¯¹åº”çš„$p$å€¼æ˜¯æœ€é«˜ä½ï¼Œè€Œæˆ‘å´æŠŠå®ƒå½“æˆäº†æœ€ä½ä½è®¡ç®—ã€‚è°ƒæ•´åï¼Œå‘ç°é‡æ–°ç»“å‡ºæ¥çš„$p$æ˜¯ä¸ªç´ æ•°ï¼Œé‚£ä¹ˆè€ƒè™‘åˆ°å¤§æ•°ä¸­å‡ºç°ç´ æ•°çš„æ¦‚ç‡å¹¶ä¸é«˜ï¼Œå› æ­¤å¯ä»¥è®¤ä¸ºæ˜¯æ­£ç¡®çš„ã€‚</p><p>æœ€åå°±æ˜¯æ­£å¸¸çš„è§£å¯†ï¼Œç›´æ¥æ¨¡ä»¿é¢˜ç›®ç»™çš„å†…å®¹å³å¯ã€‚</p><p>ä¸ªäººåšé¢˜æœ‰ä¸ªä¹ æƒ¯ï¼Œå°±æ˜¯å–œæ¬¢æŠŠé¢˜ç›®ç»™å‡ºçš„ä¸€äº›ç‰¹åˆ«é•¿çš„listæ”¾åˆ°å¦ä¸€ä¸ªpythonæ–‡ä»¶ä¸­ï¼Œåœ¨expé‡Œé¢ç›´æ¥import</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> log2<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> pslist <span class="hljs-keyword">import</span> ps<br><span class="hljs-keyword">from</span> r <span class="hljs-keyword">import</span> r<br><span class="hljs-keyword">from</span> ef <span class="hljs-keyword">import</span> ef<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lowbit</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x&amp;(-x)<br>s=[]<br>endexnum,endexid=[<span class="hljs-number">0</span>]*<span class="hljs-number">512</span>,[<span class="hljs-number">0</span>]*<span class="hljs-number">512</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>):<br>    s.append(<span class="hljs-built_in">int</span>(log2(lowbit(ps[i]))))<br>    endexnum[s[-<span class="hljs-number">1</span>]]=ps[i]<br>    endexid[s[-<span class="hljs-number">1</span>]]=i<br>kount=<span class="hljs-number">0</span><br>xored=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>):<br>    tmp1,tmp2=(r&gt;&gt;i)&amp;<span class="hljs-number">1</span>,(kount&gt;&gt;i)&amp;<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> tmp1^tmp2:<br>        xored.append(i)<br>        kount^=endexnum[i]<br>p=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xored:<br>    p+=(<span class="hljs-number">1</span>&lt;&lt;(<span class="hljs-number">511</span>-endexid[i]))<br>key=long_to_bytes(<span class="hljs-built_in">int</span>(md5(long_to_bytes(p)).hexdigest(),<span class="hljs-number">16</span>))<br>aes_obj = AES.new(key, AES.MODE_ECB)<br>ef=b64decode(ef)<br>ef=aes_obj.decrypt(ef)<br><span class="hljs-built_in">print</span>(ef)<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±æ‹¿åˆ°äº†æœ€åçš„flagï¼š<code>flag&#123;shemir_alotof_in_wctf_fun!&#125;</code></p><h2 id="2-Zer0pts2020-ROR"><a href="#2-Zer0pts2020-ROR" class="headerlink" title="2.[Zer0pts2020]ROR"></a>2.[Zer0pts2020]ROR</h2><p>å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>ror = <span class="hljs-keyword">lambda</span> x, l, b: (x &gt;&gt; l) | ((x &amp; ((<span class="hljs-number">1</span>&lt;&lt;l)-<span class="hljs-number">1</span>)) &lt;&lt; (b-l))<br>N = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> base <span class="hljs-keyword">in</span> [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>]:<br>    N *= <span class="hljs-built_in">pow</span>(base, random.randint(<span class="hljs-number">123</span>, <span class="hljs-number">456</span>))<br>e = random.randint(<span class="hljs-number">271828</span>, <span class="hljs-number">314159</span>)<br>m = <span class="hljs-built_in">int</span>.from_bytes(flag, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>)<br><span class="hljs-keyword">assert</span> m.bit_length() &lt; N.bit_length()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m.bit_length()):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(ror(m, i, m.bit_length()), e, N))<br><br></code></pre></td></tr></table></figure><p>ä¸€å¼€å§‹ä¸çŸ¥é“rorç©¶ç«Ÿæ˜¯ä¸ªä»€ä¹ˆï¼Œè‡ªå·±å†™äº†ä¸ªç¨‹åºæµ‹è¯•äº†ä¸€ä¸‹ï¼ŒåŸæ¥æ˜¯å°†$x$å¾ªç¯å·¦ç§»$l$ä½ï¼Œæ€»å­—èŠ‚æ•°ä¸º$b$ã€‚</p><p>è¿™é“é¢˜ä¹ä¸€çœ‹ä»¥ä¸ºæ˜¯ä¸ªRSAåŠ å¯†ï¼Œä½†æ˜¯æ ¹æœ¬ä¸çŸ¥é“$N,e$çš„å€¼ï¼Œå¹¶ä¸”ä»…æ ¹æ®é¢˜ç›®ç»™å‡ºæ¥çš„çº¿ç´¢æ˜¯æ ¹æœ¬æ±‚ä¸å‡ºæ¥çš„ã€‚ä¸è¿‡è¿˜æ˜¯èƒ½æ³¨æ„åˆ°$N$æ˜¯ä¸ªå¶æ•°ï¼Œè€Œä¸€ä¸ªæ•°å¦‚æœå¯¹ä¸€ä¸ªå¶æ•°å–æ¨¡ï¼Œé‚£ä¹ˆå…¶å¥‡å¶æ€§ä¸å˜ã€‚è€Œä¹˜æ–¹è¿ç®—æ˜¯ä¸æ”¹å˜ä¸€ä¸ªæ•°å­—çš„å¥‡å¶æ€§çš„ã€‚æ‰€ä»¥è¿™é“é¢˜ç»™å‡ºçš„æ•°å­—ä¸­ï¼Œæ¯ä¸ªæ•°å­—éƒ½æ³„éœ²äº†æ˜æ–‡çš„æœ€åä¸€ä¸ªæ¯”ç‰¹ä½ï¼Œæ‹¼æ¥èµ·æ¥å°±æ˜¯flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>s,i=<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>fp=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;chall.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">try</span>:<br>        a=<span class="hljs-built_in">int</span>(fp.readline())&amp;<span class="hljs-number">1</span><br>        s+=(a&lt;&lt;i)<br>        i=i+<span class="hljs-number">1</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(long_to_bytes(s))<br></code></pre></td></tr></table></figure><p><code>zer0pts&#123;0h_1t_l34ks_th3_l34st_s1gn1f1c4nt_b1t&#125;</code></p><h2 id="3-ç¾ŠåŸæ¯-2020-Power"><a href="#3-ç¾ŠåŸæ¯-2020-Power" class="headerlink" title="3.[ç¾ŠåŸæ¯ 2020]Power"></a>3.[ç¾ŠåŸæ¯ 2020]Power</h2><h3 id="PART-1"><a href="#PART-1" class="headerlink" title="PART 1"></a>PART 1</h3><p>å¦‚æœè¯´å‰é¢ä¸¤é“é¢˜è¿˜ç®—æ¯”è¾ƒç®€å•çš„ï¼Œä¸ªäººè®¤ä¸ºBUUCTFä¸Šä»è¿™é“é¢˜å¼€å§‹ï¼Œå°±æ˜¯çœŸæ­£çš„ç¡¬æ ¸äº†ã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p**<span class="hljs-number">4</span>*q<br>e = <span class="hljs-number">0x10001</span><br>phi = gmpy2.lcm(p - <span class="hljs-number">1</span>, q - <span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, phi)<br>dp = d % (p - <span class="hljs-number">1</span>)<br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;dp = &quot;</span> + <span class="hljs-built_in">str</span>(dp)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;c = &quot;</span> + <span class="hljs-built_in">str</span>(c)<br>y = <span class="hljs-comment">#ç•¥å» *</span><br>g = <span class="hljs-number">2</span><br>x = <span class="hljs-number">2019</span>*p**<span class="hljs-number">2</span> + <span class="hljs-number">2020</span>*p**<span class="hljs-number">3</span> + <span class="hljs-number">2021</span>*p**<span class="hljs-number">4</span><br>c1 = <span class="hljs-built_in">pow</span>(g, x, y)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;c1 = &quot;</span> + <span class="hljs-built_in">str</span>(c1)<br><span class="hljs-comment">#æœ€åç»™å‡ºäº†dp,c,c1çš„å€¼ã€‚</span><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ä»£ç è¾ƒçŸ­<del>ä½†è¿™å¹¶ä¸æ„å‘³ç€é¢˜ç›®å®¹æ˜“è§£å‡ºæ¥</del>ã€‚å¤§è‡´çœ‹äº†ä¸€ä¸‹åŠ å¯†è¿‡ç¨‹ï¼Œæˆ‘ä»¬åº”å½“å…ˆè®¾æ³•æ±‚å‡º$p$ã€‚ï¼ˆä¸è¿‡$N$ä¸€ç›´æ˜¯æœªçŸ¥çš„ï¼‰ã€‚è€Œæƒ³è¦æ±‚å‡º$p$ï¼Œå°±è¦å°è¯•æ±‚å‡º$x$ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å°±æ˜¯è¦è§£å†³ä¸€ä¸ªç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚æˆ‘ä»¬å‘ç°$y$æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œå› æ­¤æˆ‘ä»¬å°è¯•åˆ†è§£$y-1$ï¼Œå‘ç°å…¶å¤§æ¦‚æ˜¯$100$ä¸‡çš„å…‰æ»‘ã€‚</p><p><img src="/2021/02/09/21Feb1/3.png" alt="3"></p><p>ç„¶åå°±å¯ä»¥ä½¿ç”¨æˆ‘åœ¨ç¦»æ•£å¯¹æ•°ç¬”è®°é‡Œæåˆ°çš„é‚£ä¸ªè„šæœ¬è§£äº†ã€‚ä¸è¿‡å‘ç°å¤ªéš¾è§£äº†ï¼Œè·‘äº†åŠå°æ—¶ï¼Œäº”åˆ†ä¹‹ä¸€è¿›åº¦éƒ½æ²¡è·‘åˆ°ã€‚æŸ¥äº†ä¸€ä¸‹Sagemathçš„ä½¿ç”¨æ‰‹å†Œï¼Œå‘ç°å¯ä»¥è¿™æ ·åšï¼Œç”¨æ—¶40ç§’å·¦å³ã€‚</p><p><img src="/2021/02/09/21Feb1/4.png" alt="4"></p><p>è¿™æ ·æˆ‘ä»¬å°±è§£å‡ºäº†$x$ã€‚</p><p>è§£å‡º$x$ä¹‹åï¼Œç”±äº$2021p^4+2020p^3+2019p^2-x&#x3D;0$ã€‚è¿™ä¸ªå…³äº$p$çš„å‡½æ•°å…·æœ‰å•è°ƒæ€§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨OIä¸­è®²è¿‡çš„äºŒåˆ†ç­”æ¡ˆçš„æ–¹å¼è§£å†³ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> valc <span class="hljs-keyword">import</span> C<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">2021</span>*x**<span class="hljs-number">4</span>+<span class="hljs-number">2020</span>*x**<span class="hljs-number">3</span>+<span class="hljs-number">2019</span>*x**<span class="hljs-number">2</span>-C<br>L,R=<span class="hljs-number">0</span>,<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">5120</span><br><span class="hljs-keyword">while</span> L&lt;=R:<br>    M=(L+R)//<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span>(f(M)&gt;<span class="hljs-number">0</span>):<br>        R=M<br>    <span class="hljs-keyword">elif</span>(f(M)&lt;<span class="hljs-number">0</span>):<br>        L=M<br>    <span class="hljs-keyword">elif</span>(f(M)==<span class="hljs-number">0</span>):<br>        <span class="hljs-built_in">print</span>(M)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(L),<span class="hljs-built_in">hex</span>(R))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    <span class="hljs-built_in">input</span>()<br></code></pre></td></tr></table></figure><p>è§£å‡º$p$ä¹‹åï¼ŒçŸ¥é“äº†$d_p$ï¼ŒæŸ¥é˜…èµ„æ–™ï¼Œå¯ä»¥ç”¨è¿™æ ·çš„ç®—æ³•è§£å†³ï¼Œè¿™ä¸ªä»£ç ä¹Ÿæ˜¯åœ¨å·²çŸ¥$d_p,p$å’Œ$n$çš„ç»“æ„ä¸º$p^kq$ç±»å‹çš„æ±‚$m$æ–¹æ³•ã€‚</p><p><img src="/2021/02/09/21Feb1/5.png" alt="5"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> p,c,dp,e<br>mp1=<span class="hljs-built_in">pow</span>(c,dp,p)<br>mp=<span class="hljs-built_in">pow</span>(c,dp-<span class="hljs-number">1</span>,p)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>    x=(c-<span class="hljs-built_in">pow</span>(mp1,e))%(p**(i+<span class="hljs-number">1</span>))<br>    y=x*mp1*inverse(e,p)%(p**(i+<span class="hljs-number">1</span>))<br>    mp1+=y<br><span class="hljs-built_in">print</span>(long_to_bytes(mp1))<br></code></pre></td></tr></table></figure><h2 id="4-watevrCTF-2019-Baby-RLWE"><a href="#4-watevrCTF-2019-Baby-RLWE" class="headerlink" title="4.[watevrCTF 2019]Baby RLWE"></a>4.[watevrCTF 2019]Baby RLWE</h2><h3 id="PART-1-1"><a href="#PART-1-1" class="headerlink" title="PART 1"></a>PART 1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath Ver 9.0</span><br><span class="hljs-keyword">from</span> sage.stats.distributions.discrete_gaussian_polynomial <span class="hljs-keyword">import</span> DiscreteGaussianDistributionPolynomialSampler <span class="hljs-keyword">as</span> d_gauss<br>flag = <span class="hljs-built_in">bytearray</span>(raw_input())<br>flag = <span class="hljs-built_in">list</span>(flag)<br>n = <span class="hljs-built_in">len</span>(flag)<br>q = <span class="hljs-number">40961</span><br><span class="hljs-comment">## Finite Field of size q. </span><br>F = GF(q)<br><span class="hljs-comment">## Univariate Polynomial Ring in y over Finite Field of size q</span><br>R.&lt;y&gt; = PolynomialRing(F)<br><span class="hljs-comment">## Univariate Quotient Polynomial Ring in x over Finite Field of size 40961 with modulus b^n + 1</span><br>S.&lt;x&gt; = R.quotient(y^n + <span class="hljs-number">1</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_small_poly</span>():<br>    sigma = <span class="hljs-number">2</span>/sqrt(<span class="hljs-number">2</span>*pi)<br>    d = d_gauss(S, n, sigma)<br>    <span class="hljs-keyword">return</span> d()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_large_poly</span>():<br>    <span class="hljs-keyword">return</span> S.random_element()<br><span class="hljs-comment">## Public key 1</span><br>a = gen_large_poly()<br><span class="hljs-comment">## Secret key</span><br>s = S(flag)<br>file_out = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;downloads/public_keys.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>file_out.write(<span class="hljs-string">&quot;a: &quot;</span> + <span class="hljs-built_in">str</span>(a) + <span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    <span class="hljs-comment">## Error</span><br>    e = gen_small_poly()<br>    <span class="hljs-comment">## Public key 2</span><br>    b = a*s + e<br>    file_out.write(<span class="hljs-string">&quot;b: &quot;</span> + <span class="hljs-built_in">str</span>(b) + <span class="hljs-string">&quot;\n&quot;</span>)<br>file_out.close()<br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ç›´æ¥å°±ç»™å‡ºçš„æ˜¯Sagemathé‡Œçš„åº”ç”¨ã€‚é¢˜ç›®ç»™å‡ºçš„æ•°æ®æ˜¯ä¸€ä¸ªå¤šé¡¹å¼$a(x)$ï¼Œå’Œ$100$ä¸ªå¤šé¡¹å¼$b(x)$ã€‚ä»”ç»†è§‚å¯Ÿä¸€ä¸‹å‘ç°$b(x)$å¯¹åº”æ¬¡æ•°æ¥è¿‘ã€‚åˆæ­¥åˆ¤å®š$n&#x3D;104$ã€‚</p><p><code> gen_large_poly()</code>å‡½æ•°æ˜¯åœ¨å¤šé¡¹å¼ç¯é‡Œéšæœºé€‰å–ä¸€ä¸ªå…ƒç´ ï¼Œè¿™ä¸ªä¸éš¾ç†è§£ã€‚ä¸è¿‡æœ€åä¸çŸ¥é“<code>gen_small_poly()</code>ç©¶ç«Ÿè®²çš„ä»€ä¹ˆï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ”¾åˆ°Sagemathä¸­è¯•éªŒä¸€ä¸‹</p><p><img src="/2021/02/09/21Feb1/1.png" alt="1"></p><p>æˆ‘ä»¬å‘ç°å®ƒç”Ÿæˆçš„å¤šé¡¹å¼çš„ç³»æ•°åŸºæœ¬ä¸Šåœ¨$[-2,2]$ä¹‹é—´ï¼Œè¯´æ˜æœ€ååŠ ä¸Šçš„å°å¤šé¡¹å¼$e(x)$çš„æ¯ä¸€é¡¹åŸºæœ¬ä¸Šä¹Ÿéƒ½æ˜¯åœ¨$[-2,2]$ä¹‹é—´ã€‚å¹¶ä¸”å‘ç°å°å¤šé¡¹å¼é‡Œé¢$0$æ˜¯å¯å–çš„ã€‚è¯´æ˜æˆ‘ä»¬æœ‰å¯èƒ½åªéœ€è¦ç»Ÿè®¡ä¸€ä¸‹$b(x)$ä¸­å¯¹åº”æ¬¡æ•°å“ªä¸ªç³»æ•°å‡ºç°å¾—æœ€å¤šï¼Œå°±è¯´æ˜åŸæ¥çš„$b(x)$çš„å€¼äº†ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆç»Ÿè®¡ä¸€ä¸‹ç»™å‡ºæ¥çš„$100$ä¸ª$b(x)$å¤šé¡¹å¼å€¼å¾—æƒ…å†µï¼Œæœ€ç»ˆå¯ä»¥ç¡®å®šçœŸæ­£çš„$b(x)$ã€‚</p><p>ç¡®å®š$b(x)$ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ±‚å‡º$s(x)&#x3D;a^{-1}(x)b(x)$ï¼Œè¿›è€Œæ‹¿åˆ°äº†flagã€‚</p><p><img src="/2021/02/09/21Feb1/2.png" alt="2"></p><h3 id="PART-2-æ‰©å±•é˜…è¯»å†…å®¹"><a href="#PART-2-æ‰©å±•é˜…è¯»å†…å®¹" class="headerlink" title="PART 2 æ‰©å±•é˜…è¯»å†…å®¹"></a>PART 2 æ‰©å±•é˜…è¯»å†…å®¹</h3><h4 id="1-ä»€ä¹ˆæ˜¯åé‡å­å¯†ç "><a href="#1-ä»€ä¹ˆæ˜¯åé‡å­å¯†ç " class="headerlink" title="(1) ä»€ä¹ˆæ˜¯åé‡å­å¯†ç "></a>(1) ä»€ä¹ˆæ˜¯åé‡å­å¯†ç </h4><p>ä¸Šé¢è¿™é“é¢˜å°±è¿™æ ·ç»“æŸäº†ï¼Œé‚£ä¹ˆRLWEç©¶ç«Ÿæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿæ¥äº†è§£ä¸‹:</p><p><strong>åé‡å­å¯†ç </strong>ï¼Œä½œä¸ºæœªæ¥ 5-10 å¹´é€æ¸ä»£æ›¿ RSAã€Diffie-Hellmanã€æ¤­åœ†æ›²çº¿ç­‰ç°è¡Œå…¬é’¥å¯†ç ç®—æ³•çš„å¯†ç æŠ€æœ¯ï¼Œæ­£è¢«è¶Šæ¥è¶Šå¤šçš„äººæ‰€é‡è§†ã€‚æœ¬æ–‡æ˜¯åé‡å­å¯†ç ç§‘æ™®ä¸“æ çš„ç¬¬ä¸‰ç¯‡ã€‚æ–‡ä¸­å¯¹åŸºäºæ ¼é—®é¢˜ (Ring Learning with Errors, RLWE) çš„åé‡å­å¯†é’¥äº¤æ¢ç®—æ³•çš„åŸç†è¿›è¡Œä»‹ç»ã€‚</p><p>å› æ­¤ï¼Œè¿™ä¸ªé—®é¢˜å¾—åŸç†éœ€è¦ç”¨åˆ°æ ¼ã€‚å…³äºæ ¼å¯†ç å­¦çš„åŸºç¡€å†…å®¹ï¼Œå¯ä»¥å›é¡¾æˆ‘åˆšå†™çš„<strong>æ ¼å¯†ç ç¬”è®°1åˆ°5</strong>ã€‚</p><h4 id="2-LWEã€RLWE"><a href="#2-LWEã€RLWE" class="headerlink" title="(2)LWEã€RLWE"></a>(2)LWEã€RLWE</h4><p>1996 å¹´Ajtai ç»™å‡ºäº†æ ¼ä¸­å›°éš¾é—®é¢˜ä»æœ€åæƒ…å†µåˆ°å¹³å‡æƒ…å†µçš„è§„çº¦è¯æ˜ã€‚å¯†ç å­¦ä¸­çš„å›°éš¾æ€§éœ€è¦çš„æ˜¯åœ¨ â€œå¹³å‡æƒ…å†µâ€ ä¸‹çš„å›°éš¾æ€§ã€‚Ajtai çš„å·¥ä½œä½¿å¾—åŸºäºæ ¼é—®é¢˜æ„é€ çš„å¯†ç æ–¹æ¡ˆå…·æœ‰äº†å¯è¯æ˜å®‰å…¨çš„æ€§è´¨ã€‚æ–°çš„æ ¼å›°éš¾é—®é¢˜ä¸­ï¼Œæœ‰å‡ ç§é‡è¦çš„å¹³å‡æƒ…å†µå›°éš¾çš„é—®é¢˜ï¼šSISã€LWEã€RLWE åŠå˜ç§ã€‚åœ¨ä¸€å®šçš„å‚æ•°è®¾å®šä¸‹ï¼Œè¿™äº›é—®é¢˜å¯ä»¥å½’çº¦åˆ° GapSVPã€SIVP ç­‰æ ¼ä¸Šçš„å›°éš¾é—®é¢˜ï¼ˆå³æ±‚è§£è¿™äº›é—®é¢˜å¹¶ä¸æ¯”æ±‚è§£æ ¼ä¸Šå›°éš¾é—®é¢˜å®¹æ˜“ï¼‰ã€‚</p><p>ä¸‹é¢ä»‹ç»è¿™å‡ ä¸ªé—®é¢˜çš„å®šä¹‰ï¼š</p><p><img src="/2021/02/09/21Feb1/S1.png" alt="S1"></p><p><del>å¤ªæŠ½è±¡äº†ï¼Œæˆ‘çœ‹ä¸æ‡‚</del></p><p>è¯´çš„ç®€å•ä¸€ç‚¹ï¼Œå°±æ˜¯å†™å‡ºä¸€ä¸ªå½¢å¦‚$as+e&#x3D;b$çš„å½¢å¼ï¼Œå…¶ä¸­$a,b$æ˜¯å‡åŒ€éšæœºçš„å†…å®¹ï¼Œ$s$æ˜¯ç§é’¥ï¼Œ$e$æ˜¯ä¸€ä¸ªæœä»æŸç§åˆ†å¸ƒçš„éšæœºæ‰°åŠ¨é¡¹ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼šé€‰å–çŸ©é˜µ$A$ï¼Œåˆ—å‘é‡$\vec s,\vec e,\vec b$ã€‚ä¸è¿‡ç”±äºé€‰å–çŸ©é˜µçš„å¼€é”€å¤ªå¤§ï¼Œæœ‰æ—¶å€™è¿˜ä¼šé€‰å–å¤šé¡¹å¼$n$æ¬¡å¤šé¡¹å¼$x^n+1$ï¼Œç´ æ•°åŸŸ$GF(p)$ï¼Œè®¡ç®—$a(x)s(x)+e(x)&#x3D;b(x)$</p><h4 id="3-å…³äºæ¶ˆé™¤æ‰°åŠ¨é¡¹"><a href="#3-å…³äºæ¶ˆé™¤æ‰°åŠ¨é¡¹" class="headerlink" title="(3)å…³äºæ¶ˆé™¤æ‰°åŠ¨é¡¹"></a>(3)å…³äºæ¶ˆé™¤æ‰°åŠ¨é¡¹</h4><p><img src="/2021/02/09/21Feb1/S2.png" alt="S2"></p><p><img src="/2021/02/09/21Feb1/S3.png" alt="S3"></p><p><img src="/2021/02/09/21Feb1/S4.png" alt="S4"></p><p><img src="/2021/02/09/21Feb1/S5.png" alt="S5"></p><p>å¦‚æœä¸Šé¢çš„å†…å®¹è¿‡äºå¤æ‚å¼•èµ·ä¸é€‚ï¼Œå»ºè®®ç»“æŸé˜…è¯»ã€‚</p><h2 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5.æ€»ç»“"></a>5.æ€»ç»“</h2><p>BUUCTFæ·±æ°´åŒºçš„é¢˜ç›®ï¼Œéƒ½æ˜¯éå¸¸éš¾çš„é¢˜ç›®ï¼Œè€Œè¿™äº›é¢˜ç›®ä¹Ÿæ˜¯å¤§èµ›é‡Œé¢çš„é¢˜ç›®ï¼Œå¾ˆæœ‰å­¦ä¹ ä»·å€¼çš„ï¼Œèƒ½å­¦åˆ°å¾ˆå¤šå¿ƒå¾—åŠ å¯†è¿‡ç¨‹å’Œç®—æ³•ï¼ˆã€‚</p><p>ä¸è¿‡è‡ªå·±ä¸€ç›´éƒ½æ˜¯ä¸ªmmxfwï¼Œå› ä¸ºè‡ªå·±å¤ªèœäº†ï¼Œå“ï¼ˆ</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LatticeNotes5</title>
    <link href="/2021/02/06/LatticeNotes5/"/>
    <url>/2021/02/06/LatticeNotes5/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°5"><a href="#huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°5" class="headerlink" title="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°5"></a>huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°5</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0. About"></a>0. About</h2><p>è¿™ä¸ªç¬”è®°æ¥ç€ä¹‹å‰å‘å¸ƒçš„ç¬”è®°4ï¼Œç»§ç»­å¾€åé¢æ‰©å±•æ–°çš„å†…å®¹ã€‚</p><h2 id="12-æ ¼çº¦ç®€ç®—æ³•"><a href="#12-æ ¼çº¦ç®€ç®—æ³•" class="headerlink" title="12.æ ¼çº¦ç®€ç®—æ³•"></a>12.æ ¼çº¦ç®€ç®—æ³•</h2><h3 id="12x01-2ç»´é«˜æ–¯æ ¼çº¦ç®€"><a href="#12x01-2ç»´é«˜æ–¯æ ¼çº¦ç®€" class="headerlink" title="12x01 2ç»´é«˜æ–¯æ ¼çº¦ç®€"></a>12x01 2ç»´é«˜æ–¯æ ¼çº¦ç®€</h3><p>å‡å¦‚æˆ‘ä»¬å·²çŸ¥$v_1,v_2$æ˜¯æ ¼$L$ä¸­çš„ä¸€ç»„åŸºåº•ï¼Œå‡è®¾$v_1$çš„é•¿åº¦å°äº$v_2$ï¼Œï¼ˆå¦‚æœä¸å°äºï¼Œåˆ™äº¤æ¢ä¸¤å‘é‡çš„é•¿åº¦ï¼‰ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹çš„è„šæœ¬é€æ­¥çº¦ç®€äºŒç»´æ ¼ä¸­æœ€çŸ­å‘é‡çš„é•¿åº¦ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sgn</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">if</span> x==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> x&gt;<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> x&lt;<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">vecmul</span>(<span class="hljs-params">veca,vecb</span>):<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(veca)==<span class="hljs-built_in">len</span>(vecb) <br>    s=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(veca)):<br>        s+=veca[i]*vecb[i]<br>    <span class="hljs-keyword">return</span> s<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getans</span> (veca,vecb):<br>    <span class="hljs-built_in">print</span>(veca,vecb)<br>    <span class="hljs-keyword">if</span> vecmul(vecb,vecb)&lt;vecmul(veca,veca):<br>        tmp=veca<br>        veca=vecb<br>        vecb=tmp<br>    <span class="hljs-built_in">print</span>(veca,vecb)<br>    m=<span class="hljs-built_in">int</span>(vecmul(veca,vecb)/vecmul(veca,veca)+<span class="hljs-number">0.5</span>*sgn(vecmul(veca,vecb)))<br>    <span class="hljs-keyword">if</span>(m==<span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> veca,vecb<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(vecb)):<br>        vecb[i]-=m*veca[i]<br>    <span class="hljs-keyword">return</span> getans(veca,vecb)<br>a=[<span class="hljs-number">66586820</span>,<span class="hljs-number">65354729</span>]<br>b=[<span class="hljs-number">6513996</span>,<span class="hljs-number">6393464</span>]<br>A,B=getans(a,b)<br><span class="hljs-built_in">print</span>(A,B)<br><span class="hljs-comment">#[2280, -1001] [-1324, -2376]</span><br></code></pre></td></tr></table></figure><h3 id="12x02-LLLæ ¼çº¦ç®€ç®—æ³•"><a href="#12x02-LLLæ ¼çº¦ç®€ç®—æ³•" class="headerlink" title="12x02 LLLæ ¼çº¦ç®€ç®—æ³•"></a>12x02 LLLæ ¼çº¦ç®€ç®—æ³•</h3><p>é«˜æ–¯çš„æ™¶æ ¼çº¦ç®€ç®—æ³•ç»™å‡ºäº†åœ¨ç»´æ•°$2$çš„æ™¶æ ¼ä¸­æ‰¾åˆ°æœ€çŸ­éé›¶å‘é‡çš„æœ‰æ•ˆæ–¹æ³•ï¼Œä½†éšç€ç»´æ•°çš„å¢åŠ ï¼Œæœ€çŸ­å‘é‡é—®é¢˜å˜å¾—æ›´åŠ å›°éš¾ã€‚ éšç€LLLç®—æ³•çš„å‘è¡¨ï¼Œ1982å¹´å–å¾—äº†é‡å¤§è¿›å±•ã€‚ åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ç»™å‡ºäº†LLLç®—æ³•çš„å®Œæ•´æè¿°ï¼Œåœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ç®€è¦æè¿°äº†å®ƒçš„ä¸€äº›æ¨å¹¿ã€‚</p><p>å½“æˆ‘ä»¬å¾—åˆ°æ ¼$L$çš„ä¸€ä¸ªåŸºåº•æ—¶ï¼Œæˆ‘ä»¬è‚¯å®šå¸Œæœ›å¯¹äºä»»æ„ä¸¤ä¸ªä¸åŒçš„åŸºå‘é‡$\vec v_i,\vec v_j(i \not &#x3D;j)$ï¼Œä½¿å¾—$\cos &lt;\vec v_i,\vec v_j&gt;&#x3D;\dfrac{\vec v_iÂ·\vec v_j}{|\vec v_i||\vec v_j|}$è¶Šæ¥è¿‘$0$è¶Šå¥½ã€‚æˆ–è€…åœ¨æ›´å¥½çš„åŸºä¸Šçš„å‘é‡å°½å¯èƒ½çŸ­ï¼Œé¦–å…ˆæ˜¯æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°çš„æœ€çŸ­å‘é‡ï¼Œç„¶åæ˜¯é•¿åº¦å°½å¯èƒ½æ…¢åœ°å¢åŠ çš„å‘é‡ï¼Œç›´åˆ°æˆ‘ä»¬åˆ°è¾¾åŸºä¸­çš„æœ€åä¸€ä¸ªå‘é‡ã€‚</p><p>å‰é¢çš„ç¬”è®°ï¼Œæˆ‘æåˆ°è¿‡è¿™æ ·ä¸€ä¸ªå¼å­$\det L &#x3D;\text{Vol }(F)â‰¤ \prod _{i&#x3D;1}^n |\vec v_i|$</p><p>å…¶ä¸­$F$æ˜¯æ ¼$L$çš„åŸºæœ¬åŸŸã€‚è€Œå¦‚æœåŸºè¶Šæ­£äº¤ï¼Œé‚£ä¹ˆä¸ç­‰å·ä¸¤è¾¹å°±è¶Šæ¥è¿‘ã€‚è€Œä¸ºäº†èƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ªæ›´å¥½çš„åŸºåº•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–½å¯†ç‰¹æ­£äº¤åŒ–çš„æ–¹æ³•å–å¾—æ­£äº¤åŸºã€‚ä¸è¿‡è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼šå› ä¸ºæ–½å¯†ç‰¹æ­£äº¤åŒ–çš„æ–¹æ³•ä¸­ï¼šç”±<br>$$<br>\vec v_i^*&#x3D;v_i-\sum_{j&#x3D;1}^{i-1}u_{ij}\vec v_j*<br>$$<br>æ³¨æ„åˆ°é‡Œé¢æœ‰è¿™æ ·ä¸€é¡¹$u_{ij}$å¹¶ä¸”è¿™ä¸€é¡¹ä¸èƒ½ä¿è¯æ˜¯æ•´æ•°ã€‚æ‰€ä»¥è¿›è¡Œæ–½å¯†ç‰¹æ­£äº¤åŒ–åçš„åŸº$B^*$ä¸åŸæ¥çš„åŸº$B$ä¹‹é—´çš„è½¬æ¢å‡ºç°äº†éæ•´æ•°çš„ç³»æ•°ã€‚è€Œå®é™…ä¸Šï¼ŒåŸº$B$ä¸åŸº$B^*$çš„è¡Œåˆ—å¼æ˜¯ç›¸åŒçš„ã€‚ä¸è¿‡å¦‚æœå‡ºç°äº†è¿™æ ·ä¸¤ä¸ªæ¡ä»¶ï¼Œå°±è¯´æ˜$B$è¢«çº¦ç®€äº†ä¸€æ¬¡ï¼š</p><p><strong>UPD 2021.2.9</strong>ï¼šåŸæ¥è¿™é‡Œçš„å…¬å¼æ”¹æˆäº†å›¾ç‰‡ï¼Œå› ä¸ºåœ¨ç½‘é¡µä¸Šå…¬å¼æ˜¾ç¤ºå¼‚å¸¸ã€‚</p><p><img src="/2021/02/06/LatticeNotes5/upd1.png" alt="upd1"></p><p><strong>å…³äºLLLç®—æ³•ä¸€äº›å…¶ä»–çš„åŸç†ï¼Œä»¥åä¼šä¸å®šæœŸè¡¥å……ã€‚</strong>Sagemathä¸­è‡ªå¸¦äº†çŸ©é˜µçš„LLLè®¡ç®—ï¼Œå¾ˆæ–¹ä¾¿ã€‚</p><p><img src="/2021/02/06/LatticeNotes5/1.png" alt="1"></p><p>ä»¥ä¸‹æ˜¯ç”¨Sagemathä¸­çš„LLLç®—æ³•è®¡ç®—çŸ©é˜µ$M$çš„å¯¹åº”çŸ©é˜µ$M^{LLL}$çš„ã€‚å¯ä»¥çœ‹å‡ºï¼Œæœ€çŸ­çš„å‘é‡åœ¨ç¬¬ä¸€è¡Œï¼Œçš„ç¡®æ–­äº†ä¸å°‘ã€‚</p><p>å½“ç„¶ï¼ŒåŒä¸€ä¸ªçŸ©é˜µä½¿ç”¨LLLç®—æ³•åï¼Œå¯èƒ½ä¼šç®—å¾—ä¸åŒçš„ç»“æœã€‚å¦‚ä¸‹å›¾çš„çŸ©é˜µï¼Œä¹Ÿæ˜¯$M$ç»è¿‡LLLç®—æ³•çš„ä¸€ä¸ªç­”æ¡ˆã€‚ä¸è¿‡è®¡ç®—ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹å‡º$M$ä¸$M^{LLL}$çš„è¡Œåˆ—å¼ç»å¯¹å€¼ç›¸åŒï¼Œä¾‹å­ä¸­å‡ä¸º$777406251$ã€‚å¹¶ä¸”$H(M)&#x3D;0.47,H(M^{LLL})&#x3D;0.87897$ï¼Œå› æ­¤$M^{LLL}$ä¸­çš„å‘é‡åŸºçš„ç¡®æ›´åŠ æ­£äº¤ã€‚ä½†$M_2^{LLL}$ä¸­çš„$H$å€¼çº¦ä¸º$0.88824$ã€‚æŸ¥çœ‹æºç å¯çŸ¥ï¼ŒSagemathä¸­çš„æ¡ä»¶$2$çš„åˆ¤æ–­å‚æ•°æ˜¯$0.99$ï¼Œè€Œ$M_2^{LLL}$ä½¿ç”¨çš„å‚æ•°æ˜¯$0.75$ã€‚å› æ­¤ï¼ŒLLLç®—æ³•å¯¹å…¶ä½¿ç”¨çš„å‚æ•°å…·æœ‰æ¯”è¾ƒé«˜çš„ä¾èµ–æ€§ã€‚ã€‚ä¹Ÿæœ‰ç”¨$0.85$åšçš„ï¼Œä¸è¿‡æ— è®ºå¦‚ä½•ï¼Œæœ€ä¸Šé¢ä¸€è¡Œçš„å€¼æ€»æ˜¯ä¸€æ ·çš„ï¼ˆè‡³å¤šå·®ä¸€ä¸ª$-1$å€ï¼‰</p><p><img src="/2021/02/06/LatticeNotes5/2.png" alt="2"></p><h3 id="12x03-ä½¿ç”¨LLLè§£å†³apprCVPé—®é¢˜ï¼š"><a href="#12x03-ä½¿ç”¨LLLè§£å†³apprCVPé—®é¢˜ï¼š" class="headerlink" title="12x03 ä½¿ç”¨LLLè§£å†³apprCVPé—®é¢˜ï¼š"></a>12x03 ä½¿ç”¨LLLè§£å†³apprCVPé—®é¢˜ï¼š</h3><p>æˆ‘ä»¬åœ¨ç¬”è®°3ä¸­è§£é‡Šäº†ï¼Œå¦‚æœæ™¶æ ¼Lå…·æœ‰æ­£äº¤åŸºï¼Œé‚£ä¹ˆSVPå’ŒCVPéƒ½å¾ˆå®¹æ˜“æ±‚è§£ã€‚ LLLç®—æ³•ä¸è¿”å›æ­£äº¤åŸºï¼Œä½†å®ƒç¡®å®äº§ç”Ÿäº†ä¸€ä¸ªåŸºå‘é‡æ˜¯å‡†æ­£äº¤çš„åŸºï¼Œå³å®ƒä»¬ä¹‹é—´æ˜¯åˆç†æ­£äº¤çš„ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†LLLç®—æ³•ä¸Babaiç®—æ³•ç›¸ç»“åˆï¼Œå½¢æˆä¸€ç§æ±‚è§£APRCVPçš„ç®—æ³•ã€‚</p><p>è¿™ä¸ªç®—æ³•å¾ˆç®€å•ï¼Œå…ˆæ±‚å‡º$M^{LLL}$ä¸­çš„å‘é‡ä½œä¸ºåŸºåº•ï¼Œç„¶ååœ¨Babaiç®—æ³•ä¸­ä½¿ç”¨LLLçº¦ç®€åŸºè¿›è¡Œè®¡ç®—ã€‚</p><h2 id="13-LLLåœ¨å¯†ç åˆ†æä¸­çš„åº”ç”¨"><a href="#13-LLLåœ¨å¯†ç åˆ†æä¸­çš„åº”ç”¨" class="headerlink" title="13.LLLåœ¨å¯†ç åˆ†æä¸­çš„åº”ç”¨"></a>13.LLLåœ¨å¯†ç åˆ†æä¸­çš„åº”ç”¨</h2><h3 id="13x01-å›é¡¾ç¬”è®°1ä¸­çš„åŒä½™å¯†ç ç³»ç»Ÿ"><a href="#13x01-å›é¡¾ç¬”è®°1ä¸­çš„åŒä½™å¯†ç ç³»ç»Ÿ" class="headerlink" title="13x01 å›é¡¾ç¬”è®°1ä¸­çš„åŒä½™å¯†ç ç³»ç»Ÿ"></a>13x01 å›é¡¾ç¬”è®°1ä¸­çš„åŒä½™å¯†ç ç³»ç»Ÿ</h3><p>å½“æˆ‘ä»¬çŸ¥é“$q&#x3D;1000170007,h&#x3D;999304853$æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨é«˜æ–¯çº¦ç®€å‘é‡$(1,h)$å’Œ$(0,q)$ï¼Œè®¡ç®—çº¦ç®€åçš„å‘é‡ä¸º$(-19653, -18557)$å’Œ$(-18497, 33426)$ã€‚æœ€çŸ­çš„å‘é‡ä¸ºå‰è€…ã€‚å› æ­¤$f&#x3D;19653,g&#x3D;18557$ï¼ŒæˆåŠŸç ´è§£ã€‚</p><h3 id="13x02-å›é¡¾ç¬”è®°1ä¸­èƒŒåŒ…å¯†ç ä¸­çš„LLLç®—æ³•ç ´è§£"><a href="#13x02-å›é¡¾ç¬”è®°1ä¸­èƒŒåŒ…å¯†ç ä¸­çš„LLLç®—æ³•ç ´è§£" class="headerlink" title="13x02 å›é¡¾ç¬”è®°1ä¸­èƒŒåŒ…å¯†ç ä¸­çš„LLLç®—æ³•ç ´è§£"></a>13x02 å›é¡¾ç¬”è®°1ä¸­èƒŒåŒ…å¯†ç ä¸­çš„LLLç®—æ³•ç ´è§£</h3><p>æ¶‰åŠåˆ°çš„ç†è®ºå¯ä»¥å‚è§ç¬”è®°1ä¸­çš„ç›¸å…³å†…å®¹</p><p>ä¸‹å›¾å±•ç¤ºäº†LLLåœ¨å‰ä¸¤ä¸ªä¾‹å­ä¸­çš„ä½“ç°</p><p><img src="/2021/02/06/LatticeNotes5/3.png" alt="3"></p><h3 id="13x03-å›é¡¾ç¬”è®°3ä¸­çš„GGHå…¬é’¥å¯†ç ç³»ç»Ÿ"><a href="#13x03-å›é¡¾ç¬”è®°3ä¸­çš„GGHå…¬é’¥å¯†ç ç³»ç»Ÿ" class="headerlink" title="13x03 å›é¡¾ç¬”è®°3ä¸­çš„GGHå…¬é’¥å¯†ç ç³»ç»Ÿ"></a>13x03 å›é¡¾ç¬”è®°3ä¸­çš„GGHå…¬é’¥å¯†ç ç³»ç»Ÿ</h3><p><img src="/2021/02/06/LatticeNotes5/4.png" alt="4"></p><p>æ”»å‡»æ­¤å¯†ç ç³»ç»Ÿï¼Œå¯ä»¥å°†å‘é‡ç»„$W$çº¦ç®€ã€‚å¾—åˆ°$\vec w_1&#x3D;(61,11,67),\vec w_2&#x3D;(36,-30,-86),\vec w_3&#x3D;(-10,102,-40)$ï¼Œå¯†æ–‡$\vec v&#x3D;(âˆ’79081427, âˆ’35617462, 11035473)$</p><p>æ­¤æ—¶$H(W)$é«˜è¾¾$0.956$ã€‚å› æ­¤æˆ‘ä»¬å¾ˆå¿«å°±æ‰¾åˆ°äº†ç­”æ¡ˆä¸º<br>$$<br>\vec v&#x3D;35\vec w_1-86\vec w_2+32\vec w_3&#x3D;(79081423, 35617459, âˆ’11035471)<br>$$<br>æ‰€ä»¥æœ€åçš„ç­”æ¡ˆæ˜¯$35,-86,32$ã€‚è€ƒè™‘åˆ°åŸæ¥$|v_2|&lt;|\vec v_1|&lt;|\vec v_3|$ï¼Œå› æ­¤è°ƒæ¢é¡ºåºï¼ŒæˆåŠŸç ´è§£æ˜æ–‡ä¸º$(-86,35,32)$</p><h3 id="13x04-å›é¡¾ç¬”è®°4ä¸­çš„NTRUç®—æ³•"><a href="#13x04-å›é¡¾ç¬”è®°4ä¸­çš„NTRUç®—æ³•" class="headerlink" title="13x04 å›é¡¾ç¬”è®°4ä¸­çš„NTRUç®—æ³•"></a>13x04 å›é¡¾ç¬”è®°4ä¸­çš„NTRUç®—æ³•</h3><p>åœ¨ç¬”è®°4ä¸­æˆ‘ä»¬ä¸¾çš„é‚£ä¸ªä¾‹å­é‡Œï¼Œåœ¨$N&#x3D;7,q&#x3D;41,d&#x3D;2$çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç®—å¾—$h(x)$çš„è¡¨è¾¾å¼ä¸º<br>$$<br>h(x)&#x3D;20x^6+40x^5+2x^4+38x^3+8x^2+26x+30<br>$$<br>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸‹å›¾çš„çŸ©é˜µ</p><p><img src="/2021/02/06/LatticeNotes5/5.png" alt="5"></p><p>åŒæ ·åœ°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨LLLç®—æ³•ã€‚ç®—å‡ºç»“æœåï¼Œå°†å…¶å¯¹åŠåˆ†å¼€ï¼Œè€ƒè™‘åˆ°LLLç®—æ³•æœ‰çš„æ—¶å€™ä¼šç›¸å·®ä¸€ä¸ªè´Ÿå·æˆ–è€…å‡ºç°æ—‹è½¬çš„é—®é¢˜ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æœ‰$3$è¡Œç­”æ¡ˆç¬¦åˆæ¡ä»¶ï¼Œå¹¶ä¸”è¿™$3$è¡Œäº’ä¸ºæ—‹è½¬ã€‚</p><p>ä»¥ç”¨çº¢è‰²æ ‡å‡ºæ¥çš„ç¬¬ä¸€è¡Œä¸ºä¾‹ï¼šæ­¤æ—¶çš„$f(x)&#x3D;-x^6-x^5+x^3-x^2+1,g(x)&#x3D;x^5+x^4-x^2-1$ã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥ç»™$f(x)$ä¹˜ä¸Š$-x^4$ï¼Œé‚£ä¹ˆæœ‰$-x^4f(x)&#x3D;x^6-x^4+x^3+x^2-1$ï¼Œ$-x^4g(x)&#x3D;x^6+x^4-x^2-x$ã€‚åˆšå¥½ä¸ä¹‹å‰Aliceå’ŒBobæ‰€è®¡ç®—çš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤æ”»å‡»è€…è®¡ç®—å‡ºæ¥çš„$f(x),g(x)$ä¹Ÿå¯ä»¥ä½œä¸ºè§£å¯†å¯†é’¥ä½¿ç”¨ã€‚</p><p><img src="/2021/02/06/LatticeNotes5/6.png" alt="6"></p><h2 id="14-ä¾‹é¢˜é€‰è®²-UPDATE-2021-2-20"><a href="#14-ä¾‹é¢˜é€‰è®²-UPDATE-2021-2-20" class="headerlink" title="14.ä¾‹é¢˜é€‰è®²[UPDATE 2021.2.20]"></a>14.ä¾‹é¢˜é€‰è®²[UPDATE 2021.2.20]</h2><h3 id="14x01-NPUCTF2020-BABYLCG"><a href="#14x01-NPUCTF2020-BABYLCG" class="headerlink" title="14x01 NPUCTF2020[BABYLCG]"></a>14x01 NPUCTF2020[BABYLCG]</h3><p><strong>update 2021.2.8</strong></p><h4 id="STEP-1-è¯»å–é¢˜ç›®"><a href="#STEP-1-è¯»å–é¢˜ç›®" class="headerlink" title="STEP 1 è¯»å–é¢˜ç›®"></a>STEP 1 è¯»å–é¢˜ç›®</h4><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, bit_length</span>):<br>        m = getPrime(bit_length)<br>        a = getRandomRange(<span class="hljs-number">2</span>, m)<br>        b = getRandomRange(<span class="hljs-number">2</span>, m)<br>        seed = getRandomRange(<span class="hljs-number">2</span>, m)<br>        <span class="hljs-variable language_">self</span>._key = &#123;<span class="hljs-string">&#x27;a&#x27;</span>:a, <span class="hljs-string">&#x27;b&#x27;</span>:b, <span class="hljs-string">&#x27;m&#x27;</span>:m&#125;<br>        <span class="hljs-variable language_">self</span>._state = seed <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>._state = (<span class="hljs-variable language_">self</span>._key[<span class="hljs-string">&#x27;a&#x27;</span>] * <span class="hljs-variable language_">self</span>._state + <span class="hljs-variable language_">self</span>._key[<span class="hljs-string">&#x27;b&#x27;</span>]) % <span class="hljs-variable language_">self</span>._key[<span class="hljs-string">&#x27;m&#x27;</span>]<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._state<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">export_key</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>._key<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_lcg</span>():<br>    rand_iter = LCG(<span class="hljs-number">128</span>)<br>    key = rand_iter.export_key()<br>    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;key&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>    f.write(<span class="hljs-built_in">str</span>(key))<br>    <span class="hljs-keyword">return</span> rand_iter<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">leak_data</span>(<span class="hljs-params">rand_iter</span>):<br>    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;old&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>        f.write(<span class="hljs-built_in">str</span>(rand_iter.<span class="hljs-built_in">next</span>() &gt;&gt; <span class="hljs-number">64</span>) + <span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">return</span> rand_iter<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">rand_iter</span>):<br>    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ct&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>)<br>    key = rand_iter.<span class="hljs-built_in">next</span>() &gt;&gt; <span class="hljs-number">64</span><br>    key = (key &lt;&lt; <span class="hljs-number">64</span>) + (rand_iter.<span class="hljs-built_in">next</span>() &gt;&gt; <span class="hljs-number">64</span>)<br>    key = long_to_bytes(key).ljust(<span class="hljs-number">16</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>    iv = long_to_bytes(rand_iter.<span class="hljs-built_in">next</span>()).ljust(<span class="hljs-number">16</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>    cipher = AES.new(key, AES.MODE_CBC, iv)<br>    pt = flag + (<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(flag) % <span class="hljs-number">16</span>) * <span class="hljs-built_in">chr</span>(<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(flag) % <span class="hljs-number">16</span>)<br>    ct = cipher.encrypt(pt.encode())<br>    f.write(ct)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    rand_iter = gen_lcg()<br>    rand_iter = leak_data(rand_iter)<br>    encrypt(rand_iter)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>çº¿æ€§åŒä½™ç”Ÿæˆå™¨ç®€ç§°LCGï¼Œå°±æ˜¯é€šè¿‡$y\equiv ax+b\pmod m$çš„çº¿æ€§æ–¹ç¨‹è¿­ä»£äº§ç”Ÿéšæœºæ•°ï¼Œéšæœºæ•°æ¯”è¾ƒæœ‰è§„å¾‹å¯å¾ªã€‚</p><p>é¢˜ç›®ç»™å‡º$a,b,m$çš„åŒæ—¶ï¼Œè¿˜ç»™å‡ºäº†è¿ç»­$20$ä¸ªäº§ç”Ÿçš„æ•°å­—ï¼Œä¸è¿‡æˆ‘ä»¬çŸ¥é“çš„åªæœ‰å®ƒä»¬çš„æœ€é«˜$64$ä½ï¼Œä½çš„$64$ä½ä¸çŸ¥é“ã€‚</p><h4 id="STEP-2-åˆæ­¥åˆ†æï¼Œç¡®å®šæ„å»ºæ ¼çŸ©é˜µçš„æ³•åˆ™"><a href="#STEP-2-åˆæ­¥åˆ†æï¼Œç¡®å®šæ„å»ºæ ¼çŸ©é˜µçš„æ³•åˆ™" class="headerlink" title="STEP 2 åˆæ­¥åˆ†æï¼Œç¡®å®šæ„å»ºæ ¼çŸ©é˜µçš„æ³•åˆ™"></a>STEP 2 åˆæ­¥åˆ†æï¼Œç¡®å®šæ„å»ºæ ¼çŸ©é˜µçš„æ³•åˆ™</h4><p>ä¸ºäº†ç®€ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä»ä¸¤ä¸ªæ•°å­—å¼€å§‹ï¼Œå‡è®¾æˆ‘ä»¬å·²çŸ¥çš„æ˜¯é«˜ä½éƒ¨åˆ†æ˜¯$c_1,c_2$ï¼ŒæœªçŸ¥çš„ä½ä½éƒ¨åˆ†æ˜¯$d_1,d_2$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°<br>$$<br>c_2+d_2\equiv a(c_1+d_1)+b \pmod m<br>$$<br>å»æ‰åŒä½™å·ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„å¼å­ï¼Œå…¶ä¸­$k$ä¹Ÿæ˜¯æœªçŸ¥é‡<br>$$<br>c_2+d_2&#x3D;ac_1+ad_1+b+km<br>$$<br>å¦‚æœæˆ‘ä»¬å¯¹è¿™ä¸ªå¼å­è¿›è¡Œç§»é¡¹ï¼Œé‚£å°±æœ‰<br>$$<br>d_2&#x3D;ad_1+km+ac_1+b-c_2&#x3D;f(k,d_1)<br>$$<br>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å»ºç«‹äº†$d_2$ä¸$d_1$ä¹‹é—´çš„é€’æ¨å…³ç³»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¦å»ºç«‹å‘é‡$\vec v,\vec w$å’ŒçŸ©é˜µ$M$ï¼Œä½¿å¾—$\vec vM&#x3D;\vec w$ã€‚è€Œæƒ³è¦å»ºç«‹çŸ©é˜µå’Œå‘é‡ï¼Œå°±è¦ä¿è¯<strong>ç­‰å¼å³è¾¹æœ‰å‡ ä¸ªæœªçŸ¥æ•°ï¼Œå‘é‡å°±è‡³å°‘è¦æœ‰å‡ ç»´ï¼Œå¹¶ä¸”ä¸¤ä¸ªå‘é‡è¦è¦†ç›–åˆ°æ‰€æœ‰çš„æœªçŸ¥é‡ã€‚è€ŒçŸ©é˜µä¸­çš„æ•°å­—ï¼Œåªèƒ½æ˜¯å·²çŸ¥é‡ï¼Œå¹¶ä¸”è¿˜è¦è¦†ç›–åˆ°é¢˜ç›®ç»™å‡ºçš„æ‰€æœ‰å‚æ•°ã€‚å› ä¸ºåˆ°æ—¶å€™ç›´æ¥æ”¾å…¥Sagemathä¸­è¿›è¡ŒLLLç®—æ³•çš„æ˜¯æ‰€æœ‰å…ƒç´ å‡ä¸ºå·²çŸ¥é‡çš„çŸ©é˜µ$M$è€Œä¸æ˜¯å¸¦æœ‰æœªçŸ¥æ•°å‘é‡</strong>ã€‚</p><h4 id="STEP-3-ä»ç†è®ºèµ°å‘å®è·µ"><a href="#STEP-3-ä»ç†è®ºèµ°å‘å®è·µ" class="headerlink" title="STEP 3 ä»ç†è®ºèµ°å‘å®è·µ"></a>STEP 3 ä»ç†è®ºèµ°å‘å®è·µ</h4><p>æ ¹æ®åˆšåˆšæ€»ç»“çš„ç†è®ºï¼Œæˆ‘ä»¬æœ‰ç¡®å®šäº†ç­‰å·å³è¾¹æœ‰$2$ä¸ªæœªçŸ¥æ•°ï¼Œå› æ­¤å‘é‡ç»´æ•°è‡³å°‘æ˜¯$2$ã€‚ç„¶è€Œï¼Œæ„é€ $2$ç»´çš„å‘é‡å¾ˆå›°éš¾ï¼Œå› ä¸ºæˆ‘ä»¬ä¸Šé¢$d_2$å…³äº$d_1,k$çš„è¡¨è¾¾å¼å®é™…ä¸Šåº”è¯¥å†™æˆè¿™ä¸ªæ ·å­ï¼š<br>$$<br>d_2&#x3D;ad_1+km+(ac_1+b-c_2)&#x3D;f(k,d_1)+C<br>$$<br>ä¸è¦å°çœ‹è¿™ä¸ª$+C$çš„ä½œç”¨ï¼Œå› ä¸ºè¿™æ ·æˆ‘ä»¬ç›´æ¥å°±é‡æ„äº†è¡¨è¾¾å¼ä¸º$d_2&#x3D;f(k,d_1)+C$ã€‚è€Œ$C$æ˜¯å·²çŸ¥é‡ï¼Œä¸$k,d_1$å…¨éƒ¨æ— å…³ã€‚æ•…æˆ‘ä»¬å¿…é¡»è¦æ„å»ºä¸‰ç»´çš„å‘é‡ï¼Œå¹¶å½»åº•ç¡®å®š$\vec v&#x3D;(k,d_1,1)$ã€‚çŸ©é˜µ$M$çš„ç¬¬ä¸€åˆ—ä¸º$(m,a,C)^T$ï¼Œå‘é‡$\vec w$çš„ç¬¬ä¸€ä¸ªåˆ†é‡ä¸º$d_2$ã€‚</p><p>å› æ­¤ï¼Œä¸‹å›¾å°±è¡¨ç¤ºæˆ‘ä»¬æ„å»ºæ ¼çš„é›å½¢äº†ã€‚</p><p><img src="/2021/02/06/LatticeNotes5/7.png" alt="7"></p><p>æ­¤æ—¶ï¼ŒæœªçŸ¥é‡$k,d_1,d_2$å·²ç»å…¨éƒ¨è¢«åŒ…å«ï¼Œå·²çŸ¥é‡$a,b,m,c_1,c_2$ä¹Ÿå…¨éƒ¨è¢«åŒ…å«ï¼Œæ²¡æœ‰ä»€ä¹ˆå¿…è¦çš„ä¸œè¥¿äº†ã€‚ä¸è¿‡æ³¨æ„åˆ°ä¸€ä¸ªé—®é¢˜ï¼š$\vec w$å®é™…ä¸Šæ˜¯<strong>æœ€åå¯¹çŸ©é˜µMçº¦ç®€æ—¶çš„æœ€çŸ­å‘é‡ï¼ˆè¿™ä¸ªå¾ˆé‡è¦ï¼‰</strong>ã€‚è€Œç›¸å¯¹äº$k$æ¥è®²ï¼Œæˆ‘ä»¬æ›´å¸Œæœ›çŸ¥é“çš„æ—¶$d_1$ï¼Œå› æ­¤æˆ‘ä»¬å°±è®©$\vec w$çš„ç¬¬äºŒä¸ªåˆ†é‡ä¸º$d_1$ï¼Œå®Œå–„äº†çŸ©é˜µã€‚</p><p><img src="/2021/02/06/LatticeNotes5/8.png" alt="8"></p><p>ä¸ºäº†è®©æœ€åä¸€ä¸ªæ•°å­—å°½å¯èƒ½åœ°ç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªçŸ©é˜µçš„ç¬¬ä¸‰åˆ—çš„å‰ä¸¤ä¸ªæ•°å…¨å¡«æˆ$0$ã€‚è¿™æ ·æ±‚æœ€çŸ­å‘é‡çš„æ—¶å€™ï¼Œæœ€åä¸€ç»´ä¹Ÿå°±æ˜¯ä¸ªå›ºå®šçš„å¸¸æ•°äº†ã€‚ä¸è¿‡é—®é¢˜æ¥äº†ï¼šçŸ©é˜µå³ä¸‹è§’çš„é‚£ä¸ªæ•°å­—çœŸçš„å¯ä»¥éšä¾¿å–å—ï¼Ÿ</p><p><strong>å½“ç„¶ä¸æ˜¯</strong></p><p>æˆ‘ä»¬åœ¨ç¬”è®°2çš„æ—¶å€™å°±è®²è¿‡<strong>Hermiteå®šç†</strong>ï¼šç»´æ•°ä¸º$n$çš„æ¯ä¸€ä¸ªæ ¼$L$ä¸­éƒ½åŒ…å«ä¸€ä¸ªé•¿åº¦ä¸è¶…è¿‡$\sqrt n \sqrt[n]{\det L}$çš„å‘é‡$\vec v$ã€‚è¿™é‡Œ$n&#x3D;3$ï¼Œå‡å¦‚å³ä¸‹è§’è¿™ä¸ªæ•°æ˜¯$x$ã€‚é‚£ä¹ˆå¾ˆå®¹æ˜“è®¡ç®—$\det L&#x3D;mx$ï¼Œå…¶ä¸­$m$æ˜¯æ¨¡æ•°ï¼Œ$128$ä½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€çŸ­å‘é‡ä¸€å®šå°äº$\sqrt[6]{27m^2x^2}$ã€‚å› æ­¤æé«˜$x$çš„å€¼å‡†ç¡®åº¦æ›´é«˜ã€‚ä»¥ä¸‹å°±æ˜¯å½“$x$å¾ˆå¤§å’Œè¾ƒå°æ—¶è§£å‡ºæ¥çš„å€¼ã€‚å¦‚æœç®—å‡ºæ¥çš„$d_1,d_2$ä¸­æœ‰ä¸€ä¸ªæ—¶è´Ÿæ•°ï¼Œ<del>é‚£å°±åªèƒ½æ¢ä¸€ç»„æ•°æ®äº†</del> <strong>ï¼ˆç›´æ¥å»ç»å¯¹å€¼å³å¯ï¼ŒUpd by shallowï¼‰</strong></p><p>å› æ­¤ï¼Œæˆ‘ä»¬å°±æ¢å¤äº†ä¸€ä¸ªæ•°çš„ä½ä½ã€‚ä¸€æ—¦è¿™ä¸ªæ•°çš„ä½ä½è¢«æ¢å¤ï¼Œé‚£æˆ‘ä»¬å°±æ¢å¤äº†è¢«çœç•¥æ‰çš„ä½ä½ï¼Œè·å¾—äº†ä¸€ä¸ªçŠ¶æ€ï¼Œé‚£æˆ‘ä»¬å°±ç«‹åˆ»åœ°æ¨å‡ºäº†æ‰€æœ‰çš„ç­”æ¡ˆäº†ï¼Œflagä¹Ÿå°±è§£å‡ºæ¥äº†ã€‚</p><p><img src="/2021/02/06/LatticeNotes5/9.png" alt="9"></p><h4 id="4-Reference"><a href="#4-Reference" class="headerlink" title="4. Reference"></a>4. Reference</h4><p>å› ä¸ºè‡ªå·±çš„åšæ³•ç¡®å®æœ‰äº›å±€é™æ€§ï¼Œä¸ºäº†è·å¾—æ›´æ™®éçš„æ–¹æ³•ï¼Œæˆ‘è¿˜æ˜¯è·Ÿshallowå¤§ä½¬è®¨è®ºäº†ä»¥ä¸‹è¿™é“é¢˜çš„åšæ³•ï¼Œä½†æˆ‘å¯èƒ½è¿˜æ˜¯å¤ªèœäº†ï¼Œæ€è€ƒäº†ä¸¤å°æ—¶éƒ½æ²¡èƒ½å®ç°è¿™ä¸ªåšæ³•ã€‚</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs dns">shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">20</span>:<span class="hljs-number">14</span>:<span class="hljs-number">05</span><br>è¿™é¢˜ç»™äº†ä½ è¿™ä¹ˆå¤šæ•°æ®ï¼Œè‚¯å®šä¸å¯èƒ½åªç”¨ä¸‰ä¸ªå°±åšçš„<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">20</span>:<span class="hljs-number">14</span>:<span class="hljs-number">21</span><br>æˆ‘å½“æ—¶è¿™é¢˜ç”¨çš„hnpçš„æ€è·¯å†™çš„æ¥ç€ã€‚ã€‚<br>huangx6<span class="hljs-number">07087 2021</span>/<span class="hljs-number">2/6 20:14</span>:<span class="hljs-number">46</span><br>æˆ‘ç”¨ä¸‰ä¸ªåšå‡ºæ¥äº†<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">20</span>:<span class="hljs-number">14</span>:<span class="hljs-number">55</span><br>az<br>huangx6<span class="hljs-number">07087 2021</span>/<span class="hljs-number">2/6 20:15</span>:<span class="hljs-number">04</span><br>ä¸è¿‡è°ƒäº†å‡ æ¬¡å‚æ•°<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">20</span>:<span class="hljs-number">15</span>:<span class="hljs-number">49</span><br>é‚£æ²¡äº‹äº†<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">20</span>:<span class="hljs-number">23</span>:<span class="hljs-number">36</span><br>è´Ÿçš„ç›´æ¥ç»å¯¹å€¼å°±è¡Œ<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">20</span>:<span class="hljs-number">23</span>:<span class="hljs-number">46</span><br>åˆšåˆšç®—äº†ä¸€ä¸‹ç•Œå±…ç„¶çœŸçš„å¤Ÿã€‚ã€‚<br>huangx6<span class="hljs-number">07087 2021</span>/<span class="hljs-number">2/6 20:24</span>:<span class="hljs-number">15</span><br>é‚£ï¼Œå¤§ä½¬èƒ½è¯´ä¸€ä¸‹ä½ å½“æ—¶æ˜¯æ€ä¹ˆåšçš„å—<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">20</span>:<span class="hljs-number">25</span>:<span class="hljs-number">34</span><br>æŠŠæ¯ä¸ªdè¡¨ç¤ºæˆad0 + b<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">20</span>:<span class="hljs-number">25</span>:<span class="hljs-number">52</span><br>ç„¶åä¸€æ’å…¨aï¼Œç¬¬äºŒæ’å…¨bï¼Œå‰©ä¸‹åœ°æ–¹å¯¹è§’çº¿å¡«n<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">20</span>:<span class="hljs-number">26</span>:<span class="hljs-number">03</span><br>LLLå®Œå‰©ä¸‹çš„å°±å…¨æ˜¯diäº†<br>huangx6<span class="hljs-number">07087 2021</span>/<span class="hljs-number">2/6 20:26</span>:<span class="hljs-number">14</span><br>å¥½çš„ï¼Œè°¢è°¢äº†ï¼Œæˆ‘è¿‡ä¼šè¯•ä¸€ä¸‹<br>huangx6<span class="hljs-number">07087 2021</span>/<span class="hljs-number">2/6 22:03</span>:<span class="hljs-number">59</span><br>nå°±æ˜¯ä»–ç»™å‡ºæ¥çš„<span class="hljs-number">20</span>ä¸ªé«˜ä½å—<br>huangx6<span class="hljs-number">07087 2021</span>/<span class="hljs-number">2/6 22:07</span>:<span class="hljs-number">03</span><br>ï¼ˆä¸å¥½æ„æ€æˆ‘ç†è§£å¤±è¯¯ï¼‰<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">22</span>:<span class="hljs-number">07</span>:<span class="hljs-number">30</span><br>nçš„æ˜¯é‚£ä¸ªp<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">22</span>:<span class="hljs-number">07</span>:<span class="hljs-number">35</span><br>å°±æ˜¯æ¨¡<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">22</span>:<span class="hljs-number">09</span>:<span class="hljs-number">00</span><br>éšä¾¿å§<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">22</span>:<span class="hljs-number">09</span>:<span class="hljs-number">01</span><br>éƒ½å¯ä»¥<br>huangx6<span class="hljs-number">07087 2021</span>/<span class="hljs-number">2/6 22:09</span>:<span class="hljs-number">05</span><br>OK<br>shallow <span class="hljs-number">2021/2/6</span> <span class="hljs-number">22</span>:<span class="hljs-number">09</span>:<span class="hljs-number">15</span><br><span class="hljs-number">20</span>Ã—<span class="hljs-number">22</span>ä¹Ÿå¯ä»¥ï¼Œ<span class="hljs-number">22</span>Ã—<span class="hljs-number">22</span>ä¹Ÿå¯ä»¥<br>huangx6<span class="hljs-number">07087 2021</span>/<span class="hljs-number">2/6 22:13</span>:<span class="hljs-number">11</span><br>OK<br></code></pre></td></tr></table></figure><h3 id="14x02-ACTF2021-hashgame"><a href="#14x02-ACTF2021-hashgame" class="headerlink" title="14x02 ACTF2021 [hashgame]"></a>14x02 ACTF2021 [hashgame]</h3><p><strong>Updated 2021.2.20</strong></p><h4 id="1-è¯»å–é¢˜ç›®ï¼š"><a href="#1-è¯»å–é¢˜ç›®ï¼š" class="headerlink" title="1.è¯»å–é¢˜ç›®ï¼š"></a>1.è¯»å–é¢˜ç›®ï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> hexlify, unhexlify<br>banner = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">               _  ___        _   _           _      ____                      </span><br><span class="hljs-string"> _ __ ___   __| |/ _ \      | | | | __ _ ___| |__  / ___| __ _ _ __ ___   ___ </span><br><span class="hljs-string">| &#x27;_ ` _ \ / _` | (_) |_____| |_| |/ _` / __| &#x27;_ \| |  _ / _` | &#x27;_ ` _ \ / _ \\</span><br><span class="hljs-string">| | | | | | (_| |\__, |_____|  _  | (_| \__ \ | | | |_| | (_| | | | | | |  __/</span><br><span class="hljs-string">|_| |_| |_|\__,_|  /_/      |_| |_|\__,_|___/_| |_|\____|\__,_|_| |_| |_|\___|</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md9</span>(<span class="hljs-params">m</span>):<br>    n, N = <span class="hljs-number">32</span>, <span class="hljs-number">2</span>**<span class="hljs-number">256</span><br>    h = <span class="hljs-number">69444099843545663157429813687097031070079259699713394209624552060334679683924</span><br>    g = <span class="hljs-number">91404868204801963538299172115753433950696139669081509476098772951762196709558</span><br>    <span class="hljs-keyword">assert</span>(<span class="hljs-built_in">isinstance</span>(m, <span class="hljs-built_in">bytes</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(m) == n)<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> m:<br>        h = ((h + x) * g) % N<br>    <span class="hljs-keyword">return</span> long_to_bytes(h)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">challenge</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        m1 = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt; &quot;</span>)<br>        m2 = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt; &quot;</span>)<br>        <span class="hljs-keyword">try</span>:<br>            m1, m2 = unhexlify(m1), unhexlify(m2)<br>            <span class="hljs-keyword">if</span> m1 != m2:<br>                <span class="hljs-keyword">if</span> md9(m1) != md9(m2):<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Failed!&quot;</span>)<br>                    <span class="hljs-keyword">return</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125; win!&quot;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>))<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Foolish try!&quot;</span>)<br>                <span class="hljs-keyword">return</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Something your input is wrong!&quot;</span>)<br>            <span class="hljs-keyword">return</span><br>    flag = os.environ.get(<span class="hljs-string">&#x27;FLAG&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Win!Here is the flag: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(flag))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-built_in">print</span>(banner)<br>    challenge()<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h4 id="Step-2ï¼šåˆæ­¥åˆ†æï¼Œæ„é€ çŸ©é˜µ"><a href="#Step-2ï¼šåˆæ­¥åˆ†æï¼Œæ„é€ çŸ©é˜µ" class="headerlink" title="Step 2ï¼šåˆæ­¥åˆ†æï¼Œæ„é€ çŸ©é˜µ"></a>Step 2ï¼šåˆæ­¥åˆ†æï¼Œæ„é€ çŸ©é˜µ</h4><p>å¯¹äºé¢˜ç›®ä¸­ç»™å‡ºçš„è®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œç®€å•åœ°åŒ–ç®€,åœ¨é˜…è¯»é¢˜ç›®è¦æ±‚åï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºï¼šé¢˜ç›®è¦æ±‚æˆ‘ä»¬æ‰¾ä¸¤ç»„æ•°å­—$x,y$ï¼Œæ¯ç»„æ•°å­—$32$ä¸ªï¼Œå¹¶ä¸”æ•°ç»„$x$å’Œæ•°ç»„$y$ä¸èƒ½å®Œå…¨ç›¸åŒã€‚æœ€åå°±æ˜¯æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„$2$ç»„æ•°å­—ï¼Œä½¿å¾—<br>$$<br>hg^{32}+\sum_{i&#x3D;1}^{32} x_i g^{33-i}\equiv hg^{32}+\sum_{i&#x3D;1}^{32} y_i g^{33-i} \pmod{2^{256}}<br>$$<br>å¾ˆæ˜¾ç„¶åœ°ï¼Œæˆ‘ä»¬å¯ä»¥çº¦å»ä¸¤è¾¹çš„$hg^{32}$ï¼Œç­‰å¼å˜æˆäº†<br>$$<br>\sum_{i&#x3D;1}^{32} x_i g^{33-i}\equiv\sum_{i&#x3D;1}^{32} y_i g^{33-i} \pmod{2^{256}}<br>$$<br>ç„¶åå°†æ¨¡å¼å†™æˆç­‰å¼ï¼Œå¾—<br>$$<br>\sum_{i&#x3D;1}^{32} x_i g^{32-i}&#x3D;\sum_{i&#x3D;1}^{32} y_i g^{33-i} +2^{256}k<br>$$<br>ç„¶åæˆ‘ä»¬å¯ä»¥åˆå¹¶ä¸€ä¸‹ä¸¤è¾¹ï¼š<br>$$<br>\sum_{i&#x3D;1}^{32}(x_i-y_i)g^{33-i}&#x3D;2^{256}k<br>$$<br>å¯ä»¥é¡ºå¸¦è¿›è¡Œç§»é¡¹<br>$$<br>\sum_{i&#x3D;1}^{32}(x_i-y_i)g^{33-i}-2^{256}k&#x3D;0<br>$$</p><p>è§‚å¯ŸåŒ–ç®€åçš„å¼å­ï¼Œå…¶ä¸­æœªçŸ¥é‡æ˜¯$x_i-y_i$å’Œ$k$ï¼Œå·²çŸ¥é‡æ˜¯$g$ã€‚å› æ­¤æˆ‘ä»¬åº”è¯¥å»ºç«‹ç›¸åº”çš„é€’æ¨å¼ã€‚</p><p>ä¸ºäº†ç®€åŒ–è¡¨è¾¾ï¼Œæˆ‘ä»¬å…ˆå‡è®¾$i$çš„å–å€¼ä»$1$åˆ°$32$ç¼©å‡æˆ$1$åˆ°$3$æ¥æ¨¡æ‹Ÿæ„é€ çŸ©é˜µã€‚</p><p>åœ¨åªæœ‰$3$ç»„å·®å€¼çš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸”æˆ‘ä»¬æœ€åè¦æ±‚å‡ºæ¥çš„æ˜¯$x_i-y_i$çš„å€¼ï¼Œå› æ­¤ï¼Œ$E_3&#x3D;\text{diag}(1,1,1)$å¿…é¡»æ˜¯æˆ‘ä»¬æ„é€ çŸ©é˜µä¸­çš„ä¸€ä¸ªå­çŸ©é˜µã€‚å¹¶ä¸”$k$ä¹Ÿæ˜¯æœªçŸ¥çš„ï¼Œå› æ­¤æˆ‘ä»¬çŸ©é˜µä¸­è¿˜è¦åŠ ä¸€ä¸ªå…ƒç´ $k$ã€‚è¿™æ ·æˆ‘ä»¬çš„å‘é‡å°±æ˜¯$4$ç»´è¡Œå‘é‡$(x_1-y_1,x_2-y_2,x_3-y_3,k)$ï¼Œæœ€åæˆ‘ä»¬æœŸæœ›å¾—åˆ°çš„å†…å®¹å°±æ˜¯å‰$3$ä¸ªå‚é‡ï¼Œè€Œåˆå› ä¸º$g^3(x_1-y_1)+g^2(x_2-y_2)+g(x_3-y_3)-2^{256}k&#x3D;0$ã€‚å› æ­¤æˆ‘ä»¬çŸ©é˜µéœ€è¦å¢åŠ è‡³$5$åˆ—ã€‚æœ€åä¸€åˆ—ä¸ºåˆ—å‘é‡$(g^3,g^2,g,2^{256})^T$ï¼Œè´Ÿå·æ‰”ç»™$k$ã€‚è€Œæœ€åæˆ‘ä»¬å¾—åˆ°çš„å‘é‡å°±æ˜¯$(x_1-y_1,x_2-y_2,x_3-y_3,-k,0)$ï¼Œå‘é‡çš„æœ€åä¸€åˆ—å¿…é¡»æ˜¯$0$ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•æ„é€ ä¸€ä¸ªè¿™æ ·çš„çŸ©é˜µåŠå…¶è®¡ç®—æ–¹å¼ã€‚</p><p><img src="/2021/02/06/LatticeNotes5/10.png" alt="10"></p><p>æˆ‘ä»¬åˆ°æœ€ååªéœ€è¦æ‰¾åˆ°å°¾æ•°æ˜¯$0$çš„é‚£ä¸€åˆ—ï¼Œé‚£ä¹ˆå°±æˆåŠŸäº†ã€‚</p><p>ä½†è¿™æ ·å¥½åƒæ˜¯å¤±è´¥äº†ï¼ˆï¼Œå› ä¸ºLLLç®—æ³•åç»“å‡ºæ¥çš„æœ€åçš„ç»“æœä¸ä¸º$0$ã€‚</p><p>çœ‹æ¥ï¼Œè¿™é‡Œçš„è®¡ç®—åº”è¯¥æ˜¯è·Ÿä¸Šé¢é‚£ä¸ªä¾‹å­é™¤äº†ç›¸åŒçš„é—®é¢˜ã€‚</p><h4 id="Step-3ï¼šæ„é€ å¹¶è°ƒæ•´çŸ©é˜µ"><a href="#Step-3ï¼šæ„é€ å¹¶è°ƒæ•´çŸ©é˜µ" class="headerlink" title="Step 3ï¼šæ„é€ å¹¶è°ƒæ•´çŸ©é˜µ"></a>Step 3ï¼šæ„é€ å¹¶è°ƒæ•´çŸ©é˜µ</h4><p>å› æ­¤æˆ‘ä»¬ç°åœ¨å°±éœ€è¦å¯¹ä¸Šé¢çš„çŸ©é˜µè¿›è¡Œè°ƒæ•´ã€‚å› ä¸ºæœ€çŸ­å‘é‡æ€»æ˜¯å°äº$\sqrt n \sqrt[n]{\det L}$ã€‚å½“æ ¼$L$å¯¹åº”çš„çŸ©é˜µ$M$ä¸æ˜¯æ–¹é˜µçš„æ—¶å€™ï¼Œæˆ‘ä»¬è§„å®šæ ¼$L$çš„è¡Œåˆ—å¼$\det L&#x3D;\det MM^T$ã€‚è€Œå½“$\det L$å¤ªå°çš„æ—¶å€™ï¼Œå°±ä¼šå¯¼è‡´æœ€åè§£å‡ºæ¥çš„å‘é‡æ›´çŸ­ï¼Œå¯¼è‡´è®¡ç®—é”™è¯¯ã€‚å› ä¸ºï¼š<br>$$<br>a^2+b^2&lt;(a+b)^2<br>$$<br>è¿™å°±æ„å‘³ç€ç¬¦åˆæ¡ä»¶æ—¶ï¼Œæœ€åä¸€ä¸ª$0$å‚æ•°ä¼šè¢«å¾®å°æå‡ï¼Œæ¥ç¼“è§£å…¶ä»–åˆ†é‡çš„è´Ÿæ‹…ï¼Œå‘é‡é•¿åº¦å˜å°äº†ï¼Œä½†å´ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</p><p>å› æ­¤æˆ‘ä»¬å°±è¦æ‰©å¤§$\det L$ã€‚è€Œæˆ‘ä»¬åˆæƒ³ä¿æŒä½ç­‰å·å³è¾¹çš„å‘é‡çš„å½¢å¼ï¼Œå› æ­¤æˆ‘ä»¬å°±éœ€è¦å¯¹çŸ©é˜µæœ€å³è¾¹ä¸€åˆ—æ‰€æœ‰æ•°å­—åŒæ—¶ä¹˜ä¸Šä¸€ä¸ªæ•°$C$ï¼ˆä¸å–æ¨¡ï¼‰ï¼Œç„¶åè¿™æ ·æ ¼$L$çš„è¡Œåˆ—å¼å°±ä¼šæå‡åˆ°åŸæ¥çš„$C^8$å€ï¼ˆå¦‚æœæ„é€ å‡ºçš„æ˜¯$M$è§„æ¨¡æ˜¯$33\text x34$ï¼Œåˆ™$MM^T$å°±æ˜¯$33\text x33$æ–¹é˜µï¼Œæœ€å³è¾¹ä¹˜ä¸Š$C$å°±ä¼šå¯¼è‡´çŸ©é˜µè¡Œåˆ—å¼æå‡åˆ°åŸæ¥çš„$C^{66}$å€ï¼‰ã€‚è€Œå‘é‡çš„é•¿åº¦ï¼Œæå‡å€æ•°å°†ä¼šå°äº$\sqrt[33]{C^{66}}&#x3D;C^2$å€ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬æœ€åæœŸæœ›å¾—åˆ°çš„çŸ©é˜µè®¡ç®—æ˜¯è¿™æ ·çš„ï¼Œè€Œåœ¨è¿™é“é¢˜ä¸­ï¼Œ$C$å–$70$å¤šå°±å¤Ÿäº†ï¼Œç„¶è€Œæˆ‘è¿˜æ˜¯å–äº†$2^{700}$ä¸ºäº†ä¿é™©ã€‚</p><p><img src="/2021/02/06/LatticeNotes5/11.png" alt="11"></p><p>æ„é€ çŸ©é˜µè¿è¡Œäº†ä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°ï¼Œå‘é‡çš„æ‰€æœ‰åˆ†é‡éƒ½å°äº$255$ã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€æ®µæ¨¡æ¿$x$å’Œä¸€æ®µå˜åŒ–è¿‡çš„$y$å°±è¡Œäº†ã€‚</p><p>è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼šè§£å‡ºæ¥çš„å€¼æœ‰æ­£æœ‰è´Ÿï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰æ­£æ•°éƒ½åŸºäº$\text{00H}$ä½œä¸ºæ¨¡æ¿ï¼Œè´Ÿæ•°åŸºäº$\text{FFH}$ä½œä¸ºæ¨¡æ¿ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚è§£å‡ºæ¥çš„å‰$4$ä¸ªæ•°å­—æ˜¯$32,-64,-96,128$ï¼Œé‚£ä¹ˆæˆ‘ä»¬$x$ç»„å°±æ„é€ $\text{00FFFF00H}$ï¼Œ$y$ç»„æ„é€ $\text{20BF9F80}$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#Sagemath 9.1</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br>mod=<span class="hljs-number">2</span>^<span class="hljs-number">256</span><br>K,n=<span class="hljs-number">2</span>^<span class="hljs-number">700</span>,<span class="hljs-number">32</span><br>g=<span class="hljs-number">91404868204801963538299172115753433950696139669081509476098772951762196709558</span><br>M=[[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">2</span>)]<span class="hljs-keyword">for</span> __ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>):<br>    ge=ZZ(<span class="hljs-built_in">pow</span>(g,n-i,mod))<br>    M[i][i]=<span class="hljs-number">1</span><br>    M[i][n+<span class="hljs-number">1</span>]=ZZ(ge*K)<br>M[n][n+<span class="hljs-number">1</span>]=ZZ(K*mod)<br>M=matrix(M)<br>A=M.LLL()<br>B,D=A[<span class="hljs-number">0</span>],[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> B:<br>    <span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">0</span>:<br>        D.append(<span class="hljs-number">255</span>)<br>    <span class="hljs-keyword">else</span>:<br>        D.append(<span class="hljs-number">0</span>)<br>B=<span class="hljs-built_in">list</span>(B)<br><span class="hljs-built_in">print</span>(B,<span class="hljs-built_in">len</span>(B))<br><span class="hljs-built_in">print</span>(D,<span class="hljs-built_in">len</span>(D))<br>s,t=<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padhex</span>(<span class="hljs-params">x,l</span>):<br>    s=<span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;0&#x27;</span>*(l-<span class="hljs-built_in">len</span>(s))+s<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    s+=padhex(D[i],<span class="hljs-number">2</span>)<br>    t+=padhex(B[i]+D[i],<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-built_in">print</span>(t)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b=[64, -39, 118, 7, 39, -3, 102, -7, -9, -9, -32, -48, 69, 58, 120, 133, 23, -197, 53, 23, -41, -45, 61, -101, 26, 2, -74, -57, 24, -23, -60, 52, -16, 0] 34</span><br><span class="hljs-string">d=[0, 255, 0, 0, 0, 255, 0, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 255, 0, 0, 255, 255, 0, 255, 0, 0, 255, 255, 0, 255, 255, 0, 255, 0] 34</span><br><span class="hljs-string">s=00ff000000ff00ffffffffff0000000000ff0000ffff00ff0000ffff00ffff00</span><br><span class="hljs-string">t=40d8760727fc66f8f6f6dfcf453a7885173a3517d6d23d9a1a02b5c618e8c334</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="4-Reference-1"><a href="#4-Reference-1" class="headerlink" title="4.Reference"></a>4.Reference</h4><p>ä¸€å¼€å§‹è‡ªå·±æƒ³çš„æ˜¯æ„é€ $64\text{x}64$çš„çŸ©é˜µï¼Œæƒ³åˆ†å‡º$y_{32}$ï¼Œæ„é€ ä»$(x_1,x_2,â€¦,x_{32},y_1,y_2,â€¦,y_{31},k)$é€’æ¨å‡º$(x_1,x_2,â€¦,y_{32},y_1,y_2,â€¦,y_{31},k)$çš„æƒ³æ³•ï¼Œä¸è¿‡å‘ç°è¿™æ ·åšæ„é€ çŸ©é˜µå¹¶ä¸å¯ä»¥ã€‚å¯èƒ½æ˜¯å› ä¸ºè¿™ç§æ„é€ ä¸‹ï¼Œ$x_1$å’Œ$y_1$å­¤ç«‹ï¼Œå¯¼è‡´ç›´æ¥å‡º$0$è§£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ ·ç”±äºæ˜¯æ„é€ çš„æ–¹é˜µï¼Œå¯ä»¥ç›´æ¥ä½¿å¾—LLLä¹‹åçš„å‘é‡ç»“æœï¼Œæ¯ä¸€è¡Œçš„è¡Œå‘é‡éƒ½æ˜¯å•ä½çŸ©é˜µä¸­å¯¹åº”è¡Œå‘é‡çš„æŸä¸ªæ•´æ•°çš„å€æ•°ï¼Œç›´æ¥æ„é€ å‡ºäº†$H(B)&#x3D;1$çš„å®Œå…¨æ­£äº¤åŸºâ€¦â€¦ã€‚</p><p>è¿™ä»¶äº‹è¿˜æ˜¯æš´éœ²äº†ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜å°±æ˜¯ï¼š<del>huangx607087 is a feiwu</del></p><h2 id="15-æ€»ç»“"><a href="#15-æ€»ç»“" class="headerlink" title="15.æ€»ç»“"></a>15.æ€»ç»“</h2><p>åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œæ ¼å¯†ç çš„5ç¯‡ç¬”è®°å…¨éƒ¨æŠ•æ”¾å®Œæ¯•ã€‚ç”±äºæœ€åä¸€ç¯‡é™äºæ—¶é—´ï¼Œæ²¡æœ‰è¿‡å¤šåœ°æåŠLLLç®—æ³•çš„åŸç†ï¼Œä»…ä»…æ˜¯ç®€å•åœ°æäº†ä¸€ä¸‹LLLç®—æ³•çš„ä½¿ç”¨æ–¹æ³•ï¼Œå’Œè§£å†³äº†ä¹‹å‰æ‰€æŠ›å‡ºæ¥çš„å‡ ä¸ªé—®é¢˜ã€‚åé¢ä¸»è¦å°±æ˜¯å°†è¿™äº›ç®—æ³•åº”ç”¨åˆ°CTFä¸­çš„é¢˜ç›®é‡Œå»ã€‚å¯èƒ½ä¼šæŠ•æ”¾Notes6ã€‚ä½†Notes6å¤§æ¦‚ç‡ä¼šå±äºExpLogã€‚</p><p>ä»¥åæœ‰å¯èƒ½ä¼šå¯¹LLLç®—æ³•çš„ç›¸å…³åŸç†è¿›è¡Œè¡¥å……ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LatticeNotes4</title>
    <link href="/2021/02/05/LatticeNotes4/"/>
    <url>/2021/02/05/LatticeNotes4/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°4"><a href="#huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°4" class="headerlink" title="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°4"></a>huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°4</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0. About"></a>0. About</h2><p>è¿™ä¸ªç¬”è®°æ¥ç€ä¹‹å‰å‘å¸ƒçš„ç¬”è®°3ï¼Œç»§ç»­å¾€åé¢æ‰©å±•æ–°çš„å†…å®¹ã€‚</p><h2 id="10-NTRUå…¬é’¥åŠ å¯†ç³»ç»Ÿ"><a href="#10-NTRUå…¬é’¥åŠ å¯†ç³»ç»Ÿ" class="headerlink" title="10.NTRUå…¬é’¥åŠ å¯†ç³»ç»Ÿ"></a>10.NTRUå…¬é’¥åŠ å¯†ç³»ç»Ÿ</h2><h3 id="10x00-Introduction"><a href="#10x00-Introduction" class="headerlink" title="10x00 Introduction"></a>10x00 Introduction</h3><p>åŸºäºæ•´æ•°å› å¼åˆ†è§£éš¾åº¦æˆ–ç¦»æ•£å¯¹æ•°é—®é¢˜çš„å¯†ç ç³»ç»Ÿæ˜¯åŸºäºç¾¤çš„å¯†ç ç³»ç»Ÿï¼Œå› ä¸ºåº•å±‚çš„ç¡¬é—®é¢˜åªæ¶‰åŠä¸€ä¸ªæ“ä½œã€‚ å¯¹äºRSAã€Diffie-Hellmanå’ŒElGamalï¼Œè¯¥ç»„æ˜¯æ¨¡é‡$m$çš„å•ä½æ¨¡$m$çš„ç»„ï¼Œå®ƒå¯èƒ½æ˜¯ç´ æ•°æˆ–å¤åˆçš„ï¼Œç¾¤è¿ç®—æ˜¯ä¹˜æ³•æ¨¡$m$ã€‚å¯¹äºECCï¼Œç»„æ˜¯æ¤­åœ†æ›²çº¿æ¨¡$p$ä¸Šçš„ç‚¹é›†ï¼Œç¾¤è¿ç®—æ˜¯æ¤­åœ†æ›²çº¿åŠ æ³•ã€‚</p><p>ç¯æ˜¯å…·æœ‰åŠ æ³•å’Œä¹˜æ³•ä¸¤ç§è¿ç®—çš„ä»£æ•°å¯¹è±¡ï¼Œå®ƒä»¬æ˜¯é€šè¿‡åˆ†é…å¾‹è¿æ¥èµ·æ¥çš„ã€‚ åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬æè¿°äº†NTRUå…¬é’¥å¯†ç ç³»ç»Ÿã€‚ ä½¿ç”¨å·ç§¯å¤šé¡¹å¼ç¯æœ€è‡ªç„¶åœ°æè¿°NTRUï¼Œä½†æ½œåœ¨çš„å›°éš¾çš„æ•°å­¦é—®é¢˜ä¹Ÿå¯ä»¥è§£é‡Šä¸ºæ™¶æ ¼ä¸­çš„SVPæˆ–CVPã€‚</p><h3 id="10x01-NTRUå…¬é’¥å¯†ç ä½“åˆ¶"><a href="#10x01-NTRUå…¬é’¥å¯†ç ä½“åˆ¶" class="headerlink" title="10x01 NTRUå…¬é’¥å¯†ç ä½“åˆ¶"></a>10x01 NTRUå…¬é’¥å¯†ç ä½“åˆ¶</h3><p>å›ºå®šä¸€ä¸ªæ•´æ•°$nâ‰¥1$å’Œä¸¤ä¸ªæ¨¡æ•°$p,q$å¹¶ä»¤$R,R_p,R_q$åˆ†åˆ«ä¸ºå·ç§¯å¤šé¡¹å¼ç¯ã€‚ï¼ˆå…·ä½“å†…å®¹è¯·å›é¡¾ç¬”è®°3ï¼‰</p><p>æˆ‘ä»¬å¯ä»¥å…ˆå°†å¤šé¡¹å¼$f(x)\in R$é€šè¿‡å–æ¨¡çš„æ–¹å¼é™ä½å…¶ç³»æ•°ï¼Œä½¿å…¶æˆä¸º$R_p$æˆ–è€…$R_q$ä¸­çš„å…ƒç´ ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†$R_p$æˆ–è€…$R_q$ä¸­çš„å…ƒç´ çœ‹ä½œæ˜¯$R$ä¸­çš„å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥å¯¹å‚æ•°$n,p,q$åšå‡ºå„ç§å‡è®¾ï¼Œç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚$n$æ˜¯ç´ æ•°ï¼Œ$\gcd (n,q)&#x3D;\gcd(p,q)&#x3D;1$ç­‰ç­‰ã€‚</p><p>åœ¨è¿›å…¥NTRUå¯†ç ä½“åˆ¶ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆå¼•å…¥ä¸€ä¸ªç¬¦å·ï¼š$T(d_1,d_2)$è¡¨ç¤ºä¸€ç±»å¤šé¡¹å¼çš„é›†åˆã€‚è‹¥$f(x)\in T(d_1,d_2)$ï¼Œå°±æ„å‘³ç€$f(x)$ä¸­ï¼Œæœ‰$d_1$ä¸ªç³»æ•°çš„å€¼ä¸º$1$ï¼Œæœ‰$d_2$ä¸ªç³»æ•°çš„å€¼ä¸º$-1$ï¼Œå…¶ä»–çš„ç³»æ•°çš„å€¼å‡ä¸º$0$ã€‚ä¾‹å¦‚ï¼š$f(x)&#x3D;x^7-x^6+x^4+x^3-x+1\in T(4,2)$</p><p>$T(d_1,d_2)$ä¸­çš„å¤šé¡¹å¼å¯ä»¥ç§°ä¸ºä¸‰å…ƒå¤šé¡¹å¼ï¼Œå› ä¸ºå¤šé¡¹å¼ä¸­ç³»æ•°çš„å–å€¼èŒƒå›´åªæœ‰$0$å’Œ$Â±1$ã€‚è€Œæˆ‘ä»¬ä»¥å‰è¯´çš„äºŒè¿›åˆ¶å¤šé¡¹å¼ä¸­ï¼Œç”±äºå¤šé¡¹å¼é‡Œåªå­˜åœ¨$0,1$ä¸¤ç§ç³»æ•°ï¼Œè¿™åˆå¯ä»¥æˆä¸ºäºŒå…ƒå¤šé¡¹å¼ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬è¿›å…¥è¿™ä¸ªå¯†ç ç³»ç»Ÿï¼š</p><p>é¦–å…ˆï¼ŒAliceç¡®å®šå››å…ƒæ•´æ•°ç»„$(N,p,q,d)$ã€‚æ»¡è¶³$N,p$å‡ä¸ºç´ æ•°ï¼Œ$\gcd(N,q)&#x3D;\gcd (p,q)&#x3D;1$ï¼Œä¸”$q&gt;(6d+1)p$ã€‚</p><p>ç„¶åï¼ŒAliceéšæœºé€‰å–ä¸¤ä¸ªå¤šé¡¹å¼$f(x)$å’Œ$g(x)$ä½œä¸ºç§é’¥ï¼Œå…¶ä¸­$f(x) \in T(d+1,d)$,$g(x)\in T(d,d)$ï¼Œå¹¶è®¡ç®—$f(x)$åœ¨$R_p,R_q$ä¸­çš„é€†$F_p(x),F_q(x)$ã€‚å¦‚æœä»»æ„ä¸€ä¸ªé€†ä¸å­˜åœ¨ï¼Œåˆ™é‡æ–°é€‰æ‹©$f(x)$ã€‚</p><p>ç„¶åï¼ŒAliceåœ¨$R_q$ä¸­è®¡ç®—$h(x)&#x3D;F_q(x)g(x)$å’Œä¹‹å‰ç¡®å®šçš„å››å…ƒæ•°ç»„ä½œä¸ºå…¬é’¥ã€‚</p><p>åŠ å¯†æ—¶ï¼ŒBobçš„æ˜æ–‡æ˜¯$m(x)$ï¼Œå…¶ç³»æ•°å‡åœ¨$(-\dfrac12p,\dfrac12p]$å†…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ$m(x)$æ˜¯$R$ä¸­çš„å…ƒç´ ï¼ŒåŒæ—¶ä¹Ÿæ˜¯$R_p$ä¸­çš„å…ƒç´ ã€‚ç„¶åå†éšæœºé€‰å–ä¸€ä¸ªå¤šé¡¹å¼$r(x)\in T(d,d)$å¹¶è®¡ç®—å¯†æ–‡$c(x)\equiv ph(x)r(x)+m(x)\pmod q$ï¼Œå®ŒæˆåŠ å¯†ã€‚</p><p>å½“Aliceæ”¶åˆ°å¯†æ–‡åï¼Œå¥¹è®¡ç®—$a(x)\equiv f(x)c(x) \pmod q$ã€‚</p><p>ç„¶ååœ¨$R_p$ä¸­è®¡ç®—$F_p(x)a(x)$ï¼Œå³å¯æ˜æ–‡å¾—åˆ°$m(x)$</p><p>ä¸‹é¢æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹è¿™ä¸ªå¯†é’¥ç³»ç»Ÿï¼š</p><p>é¦–å…ˆï¼ŒAliceç¡®å®šäº†æ•´æ•°$(N,p,q,d)&#x3D;(7,3,41,2)$å’Œ$f(x)&#x3D;x^6-x^4+x^3+x^2-1,g(x)&#x3D;x^6+x^4-x^2-x$ã€‚ä¿è¯äº†$f(x)\in T(3,2),g(x)\in T(2,2)$</p><p><img src="/2021/02/05/LatticeNotes4/1.png" alt="1"></p><p>ç„¶åè®¡ç®—å‡ºäº†$F_p(x)&#x3D;x^6+2x^5+x^3+x^2+1,F_q(x)&#x3D;8x^6+26x^5+31x^4+21x^3+40x^2+2x+37$ã€‚</p><p>æ¥ç€ï¼ŒAliceè®¡ç®—$h(x)&#x3D;F_q(x)g(x)\equiv 20x^6+40x^5+2x^4+38x^3+8x^2+26x+30$ã€‚ç„¶åå°†$(N,p,q,d)$è¿™ä¸€å››å…ƒç»„å’Œ$h(x)$è¡¨è¾¾å¼å…¬å¸ƒä½œä¸ºå…¬é’¥ã€‚</p><p>Bobé€‰æ‹©äº†$R_p$ä¸­çš„è¡¨è¾¾å¼$m(x)&#x3D;2x^5+x^3+x^2+2x+1$ï¼Œå°†å…¶è°ƒæ•´ä¸º$m(x)&#x3D;-x^5+x^3+x^2-x+1$ã€‚å› ä¸º$p&#x3D;3$ï¼Œå¹¶ä¸”è¦ä¿è¯$m(x)$ä¸­æ‰€æœ‰ç³»æ•°çš„ç»å¯¹å€¼ä¸è¶…è¿‡$p$ä¸€åŠï¼Œå› æ­¤é€šè¿‡$2\equiv -1 \pmod3$æ¥å®ç°ã€‚</p><p>æ¥ç€ï¼ŒBobéšæœºé€‰æ‹©äº†ä¸€ä¸ªåœ¨$T(2,2)$ä¸­çš„å¤šé¡¹å¼$r(x)&#x3D;x^6-x^5+x-1$</p><p>æ¥ç€è®¡ç®—$c(x)&#x3D;pr(x)h(x)+m(x)&#x3D;31x^6+19x^5+4x^4+2x^3+40x^2+3x+25$ï¼Œå¹¶å°†å¯†æ–‡å‘é€ç»™Alice</p><p><img src="/2021/02/05/LatticeNotes4/2.png" alt="2"></p><p>Aliceæ”¶åˆ°Bobçš„å¯†æ–‡åï¼Œè®¡ç®—$a(x)&#x3D;c(x)f(x)&#x3D;x^6+10x^5+33x^4+40x^3+40x^2+x+40$ã€‚</p><p><img src="/2021/02/05/LatticeNotes4/3.png" alt="3"></p><p>åœ¨è¿™é‡Œéœ€è¦æ³¨æ„è°ƒæ•´ä¸€ä¸‹ï¼Œç”±äº$q&#x3D;41$ï¼Œå› æ­¤æˆ‘ä»¬å°†$a(x)$ä¸­æ‰€æœ‰çš„ç³»æ•°çš„ç»å¯¹å€¼è°ƒåˆ°ä¸è¶…è¿‡$20$ï¼Œäºæ˜¯æœ‰äº†<br>$$<br>a(x)&#x3D;x^6+10x^5-8x^4-x^3-x^2+x-1<br>$$<br>æœ€åæˆ‘ä»¬è®¡ç®—$F_p(x)a(x)&#x3D;2x^5+x^3+x^2+2x+1$ï¼Œè°ƒæ•´ç³»æ•°åï¼Œå¾—åˆ°$-x^5+x^3+x^2-x+1&#x3D;m(x)$ã€‚å› æ­¤è·å–æ˜æ–‡ã€‚</p><p><img src="/2021/02/05/LatticeNotes4/4.png" alt="4"></p><p><strong>è¿™ä¸ªåŠ å¯†ç®—æ³•ä¸­ï¼Œæœ€å®¹æ˜“ææ··çš„å°±æ˜¯ç¯åœ¨ä¸æ–­åœ°æ¢ï¼Œä¸è¿‡å½’çº³ä¸€ä¸‹ï¼Œå‘ç°åªæœ‰$m(x)$çš„ç¡®å®šä¸è§£å¯†çš„æœ€åä¸€æ­¥æ˜¯ç”¨åˆ°$Zmod(p)$çš„ï¼Œå…¶ä»–å¤§å¤šæ•°æ—¶å€™ç”¨åˆ°çš„éƒ½æ˜¯$Zmod(q)$ã€‚</strong></p><h3 id="10x02-NTRUä¸­çš„æ•°å­¦é—®é¢˜"><a href="#10x02-NTRUä¸­çš„æ•°å­¦é—®é¢˜" class="headerlink" title="10x02 NTRUä¸­çš„æ•°å­¦é—®é¢˜"></a>10x02 NTRUä¸­çš„æ•°å­¦é—®é¢˜</h3><p>æˆ‘ä»¬å‘ç°ï¼Œ$h(x)$çš„ç³»æ•°è²Œä¼¼æ˜¯éšæœºçš„ï¼Œä½†ç»è¿‡éªŒè¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªéå¸¸é‡è¦çš„ç»“è®º<br>$$<br>f(x)h(x)\equiv g(x) \pmod {(x^N-1)} \text{   in   } Zmod(q)<br>$$<br><img src="/2021/02/05/LatticeNotes4/5.png" alt="4"></p><p>å¹¶ä¸”$f(x),g(x)$çš„ç³»æ•°éƒ½æ˜¯éå¸¸å°çš„ã€‚å› æ­¤å‡å¦‚å·²çŸ¥$h(x)$çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„$f(x)$å’Œ$g(x)$å‘¢ï¼Ÿ</p><p>ç„¶è€Œï¼Œè¿™ä¸ªè§£å®é™…ä¸Šå¹¶ä¸å”¯ä¸€ï¼Œå› ä¸ºå¦‚æœ$f(x),g(x)$æ»¡è¶³ä¸Šé¢é‚£ä¸ªç­‰å¼ï¼Œé‚£ä¹ˆ$x^kf(x),x^kg(x),k\in Z_N$ä¹Ÿç¬¦åˆä¸Šé¢é‚£ä¸ªç­‰å¼ã€‚æ­¤æ—¶æˆ‘ä»¬è§£å‡ºæ¥çš„ç­”æ¡ˆå°±æ˜¯$x^km(x)$ã€‚</p><p>æ›´ä¸€èˆ¬åœ°ï¼Œå…·æœ‰è¶³å¤Ÿå°ç³»æ•°å’Œæ»¡è¶³ä¸Šé¢é‚£ä¸ªç»“è®ºçš„ä»»æ„å¯¹å¤šé¡¹å¼$f(x),g(x)$ä½œä¸ºNTRUè§£å¯†å¯†é’¥ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœ$f(x)$æ˜¯åŸå§‹è§£å¯†å¯†é’¥ï¼Œä¸”$Î¸(x)$æœ‰å¾®å°çš„ç³»æ•°ï¼Œé‚£ä¹ˆ$Î¸(X)f(X)$ä¹Ÿå¯ä»¥ä½œä¸ºè§£å¯†å¯†é’¥ã€‚</p><p>ä¸ºä»€ä¹ˆäººä»¬ä¼šè®¤ä¸ºNTRUå¯†é’¥æ¢å¤é—®é¢˜æ˜¯ä¸€ä¸ªå›°éš¾çš„æ•°å­¦é—®é¢˜ï¼Ÿ ç¬¬ä¸€ä¸ªå¿…è¦çš„è¦æ±‚æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜å®é™…ä¸Šä¸èƒ½é€šè¿‡è›®åŠ›æˆ–ç¢°æ’æœç´¢æ¥è§£å†³ã€‚ æˆ‘ä»¬å°†åœ¨åé¢çš„å†…å®¹ä¸­è®¨è®ºè¿™æ ·çš„æœç´¢ã€‚ æ›´é‡è¦çš„æ˜¯ï¼Œä¸‹é¢ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬è¯æ˜äº†æ±‚è§£NTRUå¯†é’¥æ¢å¤é—®é¢˜ï¼ˆå‡ ä¹è‚¯å®šï¼‰ç­‰ä»·äºåœ¨æŸä¸€ç±»æ ¼ä¸­æ±‚è§£SVPã€‚ è¿™å°†NTRUé—®é¢˜ä¸ä¸€ä¸ªç»è¿‡å……åˆ†ç ”ç©¶çš„é—®é¢˜è”ç³»èµ·æ¥ï¼Œå°½ç®¡è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ™¶æ ¼é›†åˆã€‚ æ ¼çº¦ç®€çš„ä½¿ç”¨æ˜¯ç›®å‰æœ€è‘—åçš„ä»å…¬é’¥æ¢å¤NTRUç§é’¥çš„æ–¹æ³•ã€‚ æ™¶æ ¼è¿˜åŸæ˜¯æœ€å¥½çš„æ–¹æ³•å—ï¼Ÿ å°±åƒæ•´æ•°åˆ†è§£å’Œå…¶ä»–å¯†ç ç³»ç»ŸèƒŒåçš„å„ç§ç¦»æ•£å¯¹æ•°é—®é¢˜ä¸€æ ·ï¼Œæ²¡æœ‰äººçŸ¥é“æ˜¯å¦å­˜åœ¨æ›´å¿«çš„ç®—æ³•ã€‚ å› æ­¤ï¼Œåˆ¤æ–­NTRUå¯†é’¥æ¢å¤é—®é¢˜éš¾åº¦çš„å”¯ä¸€æ–¹æ³•æ˜¯æ³¨æ„ï¼Œå®ƒå·²ç»è¢«æ•°å­¦å’Œå¯†ç ç¤¾åŒºå¾ˆå¥½åœ°ç ”ç©¶ã€‚ ç„¶ååº”ç”¨ç›®å‰å·²çŸ¥çš„æœ€å¿«ç®—æ³•ï¼Œå¯¹æ±‚è§£é—®é¢˜çš„éš¾åº¦è¿›è¡Œå®šé‡ä¼°è®¡ã€‚</p><p>é‚£ä¹ˆæƒ³è¦åœ¨æ²¡æœ‰å¯†é’¥çš„æƒ…å†µä¸‹ï¼Œç ´è§£NTRUç³»ç»Ÿåˆå¤šéš¾å‘¢ï¼Ÿ</p><p>é¦–å…ˆï¼Œå°±æ˜¯$T(d_1,d_2)$ä¸­çš„å¤šé¡¹å¼ä¸ªæ•°ï¼Œä¸€å…±æœ‰$\text C_N^{d_1}\text C_{N-d_1}^{d_2}$ä¸ªç¬¦åˆæ¡ä»¶çš„å¤šé¡¹å¼ã€‚å¹¶ä¸”å½“$d_1,d_2$æ¥è¿‘äº$\dfrac N 3$çš„æ—¶å€™ï¼Œ$\text C_N^{d_1}\text C_{N-d_1}^{d_2}$çš„å€¼æ—¶æœ€å¤§çš„ã€‚</p><p>å¯¹äºè›®åŠ›æœç´¢ï¼Œæ”»å‡»è€…å¿…é¡»å°è¯•$T(d+1,d)$ä¸­çš„æ¯ä¸ªå¤šé¡¹å¼ï¼Œç›´åˆ°å¥¹æ‰¾åˆ°ä¸€ä¸ªè§£å¯†é”®ï¼Œä½†è¯·æ³¨æ„ï¼Œ$f(x)$çš„æ‰€æœ‰å¾ªç¯ç§»ä½éƒ½æ˜¯è§£å¯†é”®ï¼Œå› æ­¤æœ‰$N$ä¸ªç¬¦åˆæ¡ä»¶çš„é€‰é¡¹ã€‚ å› æ­¤ï¼Œå®ƒå°†éœ€è¦æ”»å‡»è€…å¤§çº¦å°è¯•$\dfrac {\text C_N^{d+1}\text C_{N-d-1}^{d}}{N}$ï¼Œå¯ä»¥æ‰¾åˆ°$f(x)$çš„ä¸€ä¸ªå¾ªç¯ç§»ä½)ã€‚ </p><p>ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…¬é’¥ä¸º$(N,p,q,d)&#x3D;(251,3,257,83)$ã€‚<strong>ï¼ˆæ³¨ï¼šè¿™é‡Œçš„$q&lt;(6d+1)p$ï¼Œæœ‰å¯èƒ½å‡ºç°è§£å¯†å¤±è´¥ï¼‰</strong>ã€‚é‚£ä¹ˆæƒ³è¦æ‰¾åˆ°ä¸€ä¸ªå¯è¡Œçš„å¯†é’¥ï¼Œè¿›è¡Œå°è¯•çš„æœŸæœ›å€¼$E$çš„æ•°é‡çº§è¾¾åˆ°äº†$\ln E&#x3D;\ln \dfrac{\text C_{251}^{84}\text C_{167}^{83}}{251}&#x3D;264.5$ã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç©ºé—´æ¢æ—¶é—´çš„åšæ³•ï¼Œè®¾å®š$f_1(x)&#x3D;\sum_{i&#x3D;1}^{(n&#x2F;2)^-}$å’Œ$f_1(x)&#x3D;\sum_{i&#x3D;n&#x2F;2}^{n}$ã€‚å…¶ä¸­$(\frac n 2)^-$è¡¨ç¤ºå–ä¸åˆ°$\frac n 2$ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ‰¾$f_1(x)h(x)$å’Œ$-f_2(x)h(x)$ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰ä¸€æ ·çš„å†…å®¹ï¼ˆç³»æ•°æ¨¡$q$ï¼‰ã€‚è€Œè¿™æ ·çš„è¯ï¼Œæ‰€éœ€è¦çš„æ¬¡æ•°çš„æ•°é‡çº§ä¼šé™åˆ°$\ln E&#x3D;132.3$ï¼Œä¹Ÿå°±æ˜¯æŒ‡æ•°é™åˆ°åŸæ¥çš„ä¸€åŠã€‚è€Œå½“$d$æ¥è¿‘äº$\dfrac N 3$çš„æ—¶å€™ï¼Œè¿™ä¸ªç®—æ³•çš„å¤æ‚åº¦å¤§æ¦‚æ˜¯$O(1.7321^N)$ã€‚</p><p>å› æ­¤ï¼Œè¿™æ—¶è§£å¯†æˆåŠŸçš„å¯¹æ•°å€¼çº¦ä¸º$\ln P&#x3D;\ln((\dfrac 3 {257})^{251}\text C_{251}^{84}\text C_{167}^{83})&#x3D;-847$ã€‚è‹¥å¯¹æ•°å–$\log_2$ï¼Œåˆ™å€¼ä¸º$-1222$</p><p>æ•…é™¤äº†$f(x)$çš„å¾ªç¯ç§»ä½ä¹‹åçš„è¡¨è¾¾å¼å¤–ï¼Œæœ‰å…¶ä»–å¯†é’¥çš„æ¦‚ç‡éå¸¸ä½ã€‚</p><h2 id="11-NTRUä¸æ ¼å¯†ç ç³»ç»Ÿ"><a href="#11-NTRUä¸æ ¼å¯†ç ç³»ç»Ÿ" class="headerlink" title="11.NTRUä¸æ ¼å¯†ç ç³»ç»Ÿ"></a>11.NTRUä¸æ ¼å¯†ç ç³»ç»Ÿ</h2><h3 id="11x01-NTRUæ ¼"><a href="#11x01-NTRUæ ¼" class="headerlink" title="11x01 NTRUæ ¼"></a>11x01 NTRUæ ¼</h3><p>åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬è§£é‡Šäº†å¦‚ä½•å°†NTRUå¯†é’¥æ¢å¤è¡¨ç¤ºä¸ºæŸä¸€ç‰¹æ®Šç±»å‹æ™¶æ ¼ä¸­çš„æœ€çŸ­å‘é‡é—®é¢˜ã€‚ </p><p>å‡è®¾æˆ‘ä»¬åœ¨æŸä¸€æ¬¡è§£å‡ºæ¥çš„$N&#x3D;3$æƒ…å†µä¸‹çš„$h(x)&#x3D;39x^2+23x+48$ï¼Œå¯¹åº”çš„$q$å€¼ä¸º$61$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ è¿™æ ·ä¸€ä¸ªçŸ©é˜µï¼Œå…¶ä¸­ç©ºç™½éƒ¨åˆ†å‡ä¸º$0$ï¼Œå¤§å°æ˜¯$6\text{x}6$</p><img src="/2021/02/05/LatticeNotes4/6.png" alt="6" style="zoom:115%;"><p>æ‰©å±•åˆ°$n$é˜¶ï¼Œåˆ™æ˜¯ä¸€ä¸ª$2n$é˜¶çš„çŸ©é˜µ</p><img src="/2021/02/05/LatticeNotes4/7.png" alt="7" style="zoom:90%;"><p>å…¶ä¸­å·¦ä¸Šè§’æ˜¯å•ä½é˜µ$E$ï¼Œå·¦ä¸‹è§’æ˜¯$0$çŸ©é˜µï¼Œå³ä¸‹è§’æ˜¯æ•°é‡çŸ©é˜µ$qE$ï¼Œå³ä¸Šè§’åˆ™æ˜¯$h(x)$çš„å„ä¸ªç³»æ•°å¾ªç¯å¾—æ¥çš„ã€‚</p><p>å‡å¦‚æˆ‘ä»¬ç°åœ¨æœ‰<br>$$<br>f(x)&#x3D;\sum_{i&#x3D;0}^{N-1} a_ix^i \text{   and    }g(x)&#x3D;\sum_{i&#x3D;0}^{N-1} b_ix^i<br>$$<br>ç„¶åæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªå‘é‡$(\vec a,\vec b)&#x3D;(a_0,a_1,â€¦,a_{N-1},b_0,b_1,â€¦b_{N-1})$ã€‚è¿™ä¸ªå‘é‡ä¹Ÿæ˜¯$2n$ç»´çš„ï¼Œå› æ­¤å¯ä»¥å³ä¹˜$M_{\text h}^{\text{NTRU}}$</p><p>æˆ‘ä»¬ç°åœ¨å‡è®¾NTRUå…¬é’¥$h(x)$æ˜¯ä½¿ç”¨ç§æœ‰å¤šé¡¹å¼$f(x)$å’Œ$g(x)$åˆ›å»ºçš„ï¼Œå¹¶è®¡ç®—å½“æˆ‘ä»¬å°†NTRUçŸ©é˜µä¹˜ä»¥ä¸€ä¸ªç²¾å¿ƒé€‰æ‹©çš„å‘é‡æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p><p>å› ä¸ºæˆ‘ä»¬åˆšæ‰æåˆ°è¿‡ä¸€ä¸ªå¼å­ï¼š$f(x)h(x)\equiv g(x)\pmod{x^N-1} \text{  in  } R_q$ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†™å‡ºè¿™æ ·çš„å¼å­ï¼Œå…¶ä¸­$u(x)$ä¹Ÿæ˜¯ä¸€ä¸ªå¤šé¡¹å¼<br>$$<br>f(x)h(x)&#x3D;g(x)+qu(x)<br>$$<br>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰<br>$$<br>(\vec f,-\vec {u})M_{\text h}^{\text{NTRU}}&#x3D;(\vec f,\vec fÂ·\vec h-q\vec u)&#x3D;(\vec f,\vec g)<br>$$<br>å› æ­¤ï¼Œ$(\vec f,\vec g)$åœ¨æ ¼$L_{\text h}^{\text{NTRU}}$ä¸­ã€‚</p><p>å½“å…¬é’¥ä¸­çš„$dâ‰ˆ\dfrac N 3,qâ‰ˆ6dâ‰ˆ2N$æ—¶ã€‚åˆ™$\det L_{\text h}^{\text{NTRU}}&#x3D;q^N $ï¼Œ$|(\vec f,\vec g)|â‰ˆ2\sqrt d$ã€‚ä¸”ç”±é«˜æ–¯å¯å‘å¼å¯ä»¥æ¨å‡ºï¼Œæœ€çŸ­é$0$å‘é‡çš„é•¿åº¦çº¦ä¸º$\sigma(L_{\text h}^{\text{NTRU}})â‰ˆ\dfrac{Nq}{\pi e}â‰ˆ0.484N$ã€‚</p><p>å½“ç„¶ï¼Œå½“$N$å¾ˆå¤§çš„æ—¶å€™ï¼Œå¾ˆå¤§æ¦‚ç‡ä¸Šï¼Œæ ¼ä¸­æœ€çŸ­éé›¶å‘é‡å°±æ˜¯$(\vec f,\vec g)$æˆ–è€…å…¶å¾ªç¯ç§»ä½ï¼ˆåˆç§°æ—‹è½¬ï¼‰ã€‚å¹¶ä¸”<br>$$<br>\dfrac {|(\vec f,\vec g)|}{\sigma (L)}â‰ˆ\dfrac{2.39}{\sqrt N}<br>$$<br>æ‰€ä»¥$(\vec f,\vec g)$çš„é•¿åº¦æ•°é‡çº§æ˜¯$O(N^{-\frac 1 2})$ï¼Œæ¯”é«˜æ–¯å¯å‘å¼æ‰€é¢„æµ‹çš„é•¿åº¦è¦çŸ­ã€‚</p><h3 id="11x02-å¯¹NTRUæ™¶æ ¼çš„å®‰å…¨æ€§çš„å®šé‡åˆ†æ"><a href="#11x02-å¯¹NTRUæ™¶æ ¼çš„å®‰å…¨æ€§çš„å®šé‡åˆ†æ" class="headerlink" title="11x02 å¯¹NTRUæ™¶æ ¼çš„å®‰å…¨æ€§çš„å®šé‡åˆ†æ"></a>11x02 å¯¹NTRUæ™¶æ ¼çš„å®‰å…¨æ€§çš„å®šé‡åˆ†æ</h3><p>ç”±æˆ‘ä»¬ä¹‹å‰çš„åˆ†æï¼Œå¯ä»¥å¾—å‡ºï¼šå¦‚æœæ”»å‡»è€…èƒ½å¤Ÿåœ¨NTRUæ ¼ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€çŸ­çš„å‘é‡ï¼Œé‚£ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜çš„éš¾åº¦å°±è‡³å°‘è¾¾åˆ°äº†SVPé—®é¢˜çš„æ±‚è§£ï¼Œå¦‚æœæ”»å‡»è€…å¯ä»¥åœ¨æ ¼ä¸­è§£å†³apprSVPé—®é¢˜åœ¨ä¸è¶…è¿‡$O(\sqrt N)$çš„çŸ­å‘é‡ï¼Œé‚£ä¹ˆæ”»å‡»è€…å‘ç°çš„çŸ­å‘é‡å°±å¾ˆå¯èƒ½æ˜¯è§£å¯†å¯†é’¥ã€‚å› æ­¤ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°äº†å¦‚ä½•ä¼°è®¡åœ¨NTRUæ ¼ç»¼åˆä½ æ‰¾åˆ°ä¸€ä¸ªç»™çŸ­çš„æˆ–è€…æœ€çŸ­çš„å‘é‡éš¾åº¦çš„é—®é¢˜ã€‚å› æ­¤æˆ‘ä»¬åœ¨ä¸‹ä¸€æ¡ç¬”è®°ä¸­ä¼šè®²åˆ°æœ‰å¤šé¡¹å¼æ—¶é—´å¤æ‚åº¦çš„LLLç®—æ³•ï¼Œä½†$N$å¾ˆå¤§æ—¶ï¼ŒLLLç®—æ³•æ˜¯æ‰¾ä¸åˆ°å¾ˆå°çš„å‘é‡çš„ï¼Œå› æ­¤ç¬”è®°5æˆ‘ä»¬è¿˜ä¼šè®¨è®ºè®¨è®ºBKZ-LLLç®—æ³•ã€‚ä¸è¿‡å…¶è¿è¡Œæ—¶é—´æœ‰å¯èƒ½ä¼šè¾¾åˆ°æŒ‡æ•°çº§åˆ«ã€‚</p><p>ä¸å¹¸çš„æ˜¯ï¼Œæ ‡å‡†æ™¶æ ¼çº¦ç®€ç®—æ³•(å¦‚BKZ-LLL)çš„æ“ä½œç‰¹æ€§å¹¶æ²¡æœ‰åƒç´ æ•°ç­›ç®—æ³•ã€æŒ‡æ•°å¾®ç§¯åˆ†èƒ¡æ€»å’ŒPollard Rhoç®—æ³•é‚£ä¹ˆå¾—åˆ°è¾ƒå¥½çš„ç†è§£ã€‚è¿™ä½¿å¾—ç†è®ºä¸Šå¾ˆéš¾é¢„æµ‹æ™¶æ ¼çº¦ç®€ç®—æ³•åœ¨ä»»ä½•ç»™å®šçš„ç±»æ ¼ä¸Šçš„æ€§èƒ½ã€‚ å› æ­¤ï¼Œåœ¨å®è·µä¸­ï¼Œå¿…é¡»é€šè¿‡å®éªŒç¡®å®šåŸºäºæ™¶æ ¼çš„å¯†ç ä½“åˆ¶(å¦‚NTRU)çš„å®‰å…¨æ€§ã€‚</p><p>ç²—ç•¥åœ°è¯´ï¼Œä¸€ä¸ªå‚æ•°åºåˆ—$(N,q,d)$ï¼Œå…¶ä¸­$N$å¢é•¿ï¼Œä½¿æ¶‰åŠ$N,q,d$çš„æŸäº›æ¯”ç‡ä¿æŒè¿‘ä¼¼æ’å®šã€‚ å¯¹äºæ¯ç»„å‚æ•°ï¼Œä¸€ä¸ªäººä½¿ç”¨BKZ-LLLè¿›è¡Œäº†è®¸å¤šå®éªŒï¼Œéšç€å—å¤§å°çš„å¢åŠ $Î²$ç›´åˆ°ç®—æ³•åœ¨$L^{NTRU}_h$ä¸­æ‰¾åˆ°ä¸€ä¸ªçŸ­å‘é‡ã€‚ ç„¶åç»˜åˆ¶å¹³å‡è¿è¡Œæ—¶é—´å¯¹Nçš„å¯¹æ•°ï¼ŒéªŒè¯ç‚¹è¿‘ä¼¼åœ¨çº¿ï¼Œå¹¶è®¡ç®—æœ€ä½³æ‹Ÿåˆçº¿$\ln(\text{Running Time}&#x3D;Ax+B)$ã€‚</p><p>åœ¨å¯¹Nçš„è®¸å¤šå€¼è¿›è¡Œè¿™æ ·åšä¹‹åï¼Œç›´åˆ°è®¡ç®—å˜å¾—ä¸å¯è¡Œæ—¶ï¼Œäººä»¬å¯ä»¥ä½¿ç”¨è¿™æ¡çº¿æ¥æ¨æ–­NTRUæ™¶æ ¼$L^{NTRU}_h$ä¸­å¯»æ‰¾ç§é’¥å‘é‡æ‰€éœ€çš„é¢„æœŸæ—¶é—´ï¼Œä»¥è·å¾—$N$çš„è¾ƒå¤§å€¼ã€‚è¿™äº›å®éªŒè¡¨æ˜ï¼Œ$N$çš„å€¼åœ¨$250$åˆ°$1000$ä¹‹é—´ï¼Œäº§ç”Ÿçš„å®‰å…¨ä¸RSAã€ElGamalå’ŒECCç›®å‰çš„å®‰å…¨å®ç°ç›¸å½“</p><p>åˆšåˆšæˆ‘ä»¬è¯´è¿‡ï¼ŒNTRUæ™¶æ ¼ä¸­çš„çŸ­ç›®æ ‡å‘é‡æ¯”é«˜æ–¯å¯å‘å¼é¢„æµ‹çš„çŸ­$O( \sqrt N)$ã€‚ ç†è®ºä¸Šå’Œå®éªŒä¸Šï¼Œå¦‚æœç»´æ•°$n$çš„æ™¶æ ¼å…·æœ‰æå°çš„å‘é‡ï¼Œä¾‹å¦‚$O(2^n)$æ¯”é«˜æ–¯é¢„æµ‹çŸ­ï¼Œé‚£ä¹ˆLLLåŠå…¶å˜ä½“ç­‰æ™¶æ ¼çº¦ç®€ç®—æ³•éå¸¸æ“…é•¿äºæ‰¾åˆ°å¾®å°å‘é‡ã€‚ è¿™æ˜¯ä¸€ä¸ªè‡ªç„¶å’Œéå¸¸æœ‰è¶£çš„é—®é¢˜ï¼Œé—®æ˜¯å¦åªæœ‰$O(n^k)$æ¯”é«˜æ–¯é¢„æµ‹çŸ­çš„å‘é‡ä¹Ÿå¯èƒ½æ›´å®¹æ˜“æ‰¾åˆ°ã€‚ è¿™æ—¶ï¼Œæ²¡æœ‰äººçŸ¥é“è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LatticeNotes3</title>
    <link href="/2021/02/04/LatticeNotes3/"/>
    <url>/2021/02/04/LatticeNotes3/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°3"><a href="#huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°3" class="headerlink" title="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°3"></a>huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°3</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0. About"></a>0. About</h2><p>è¿™ä¸ªç¬”è®°æ¥ç€ä¹‹å‰å‘å¸ƒçš„ç¬”è®°2ï¼Œç»§ç»­å¾€åé¢æ‰©å±•æ–°çš„å†…å®¹ã€‚</p><h2 id="6-Babaiç®—æ³•å’Œå¯»æ‰¾å¥½çš„åŸºåº•è§£å†³apprCVPé—®é¢˜"><a href="#6-Babaiç®—æ³•å’Œå¯»æ‰¾å¥½çš„åŸºåº•è§£å†³apprCVPé—®é¢˜" class="headerlink" title="6.Babaiç®—æ³•å’Œå¯»æ‰¾å¥½çš„åŸºåº•è§£å†³apprCVPé—®é¢˜"></a>6.Babaiç®—æ³•å’Œå¯»æ‰¾å¥½çš„åŸºåº•è§£å†³apprCVPé—®é¢˜</h2><p>å¦‚æœ ä¸€ä¸ªæ ¼çš„åŸºåº•ä¸­çš„å‘é‡ä¸¤ä¸¤æ­£äº¤ï¼Œä¹Ÿå°±æ˜¯å¯¹äºä»»æ„çš„$i \not &#x3D; j$ï¼Œå‡æœ‰$ \vec v_iÂ·\vec v_j &#x3D;0 $ã€‚é‚£ä¹ˆåœ¨è¿™ä¸ªæ ¼é‡Œé¢è§£å†³SVPå’ŒCVPé—®é¢˜å°±ä¼šæ˜¯å¾ˆç®€å•çš„ã€‚å¯ä»¥è¯æ˜ï¼Œè¿™ä¸ªæ ¼ä¸­çš„æœ€æ®µå‘é‡å°±æ˜¯$\vec v_1$åˆ°$\vec v_n$ä¸­çš„æœ€çŸ­å‘é‡ã€‚å› ä¸ºå‘é‡çš„é•¿åº¦çš„å¹³æ–¹ä¸º$(\sum_{i&#x3D;1}^n a_i\vec v_i)^2&#x3D;\sum _{i&#x3D;1}^n a_i^2\vec v_i^2$ã€‚åˆå› ä¸º$a$æ˜¯ä¸å…¨ä¸º$0$çš„æ•´æ•°ï¼Œå› æ­¤ç»™åŸºåº•ä¸­æœ€çŸ­çš„é‚£ä¸ªå‘é‡å‰çš„ç³»æ•°èµ‹å€¼ä¸º$Â±1$ï¼Œå…¶ä»–å‘é‡å‰çš„ç³»æ•°èµ‹å€¼ä¸º$0$å³ä¸ºæˆ‘ä»¬æ‰€æ±‚çš„è§£ã€‚</p><p>è€Œåœ¨æ­£äº¤åŸºåº•çš„æ ¼ä¸­è§£å†³CVPé—®é¢˜ï¼Œæ ¹æ®çº¿æ€§ä»£æ•°åŸç†ï¼Œå¯¹ä»»æ„å‘é‡$\vec w$æ­£äº¤åˆ†è§£ï¼Œå¯ä»¥åˆ†è§£æˆä»¥ä¸‹çš„å¼å­ï¼š<br>$$<br>\vec w&#x3D;\sum_{i&#x3D;1}^n b_i\vec v_i,b_i \in R<br>$$<br>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸€ç»„$a$ï¼Œä½¿å¾—$a_i$æ˜¯$b_i$æœ€è¿‘çš„é‚£ä¸ªæ•´æ•°å°±å¯ä»¥æ±‚å‡ºä¸$ \vec w $æœ€æ¥è¿‘çš„æ ¼ä¸­çš„å‘é‡ã€‚</p><p>ç„¶è€Œï¼Œå¦‚æœä¸€ä¸ªæ ¼ä¸­çš„åŸºåº•å‘é‡æ˜¯é«˜åº¦éæ­£äº¤çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨<strong>ç¬”è®°2</strong>ä¸­çš„<strong>52o01</strong>èŠ‚æåˆ°çš„Hadamardæ¯”ç‡$H(B)$æ¥è¿‘äº$0$æ—¶ï¼ŒCVPé—®é¢˜å°±æ²¡æœ‰é‚£ä¹ˆå¥½è§£å†³äº†ã€‚</p><p>ä¸€ä¸ªå¯èƒ½çš„æ–¹æ³•å°±æ˜¯ï¼Œå‡å¦‚ç»™å®šäº†ä¸€ä¸ªå‘é‡$\vec w&#x3D;\sum_{i&#x3D;1}^n b_i\vec v_i$ã€‚æ±‚ä¸å®ƒæœ€æ¥è¿‘çš„æ ¼å‘é‡å°±æ˜¯æŠŠæ‰€æœ‰çš„$b_i$é€šè¿‡å››èˆäº”å…¥çš„æ–¹å¼è½¬åŒ–æˆä¸å…¶æœ€æ¥è¿‘çš„æ•´æ•°ã€‚ä¸è¿‡è¿™ç§æ–¹æ³•åœ¨æ¯”è¾ƒæ­£äº¤çš„åŸºåº•çš„æ ¼ä¸­è¿˜æ˜¯æ¯”è¾ƒå¥½ç”¨çš„ï¼Œä½†å¯¹äºç”±â€œä¸å¥½çš„â€åŸºåº•ç»„æˆçš„æ ¼æ¥è¯´ï¼Œç”±äºæ¯ä¸ªå¹³è¡Œå››è¾¹å½¢ï¼ˆ$2D$å¹³é¢ï¼‰ä¼šè¢«æ‹‰çš„å¾ˆé•¿ï¼Œé‚£ä¹ˆé‡Œç›®æ ‡ç‚¹æœ€è¿‘çš„é¡¶ç‚¹çš„è·ç¦»ä¹Ÿä¼šå¢åŠ ã€‚å› æ­¤é™¤éåŸºåº•ç›¸å½“æ­£äº¤ï¼Œåœ¨ç»´æ•°ä½äº$5$çš„æ ¼ä¸­apprCVPçš„è¿™ä¸ªé—®é¢˜è¿˜æ˜¯ä¸å¤ªå¥½è§£å†³çš„ã€‚</p><p>å› æ­¤ï¼ŒBabaiç®—æ³•å°±æ˜¯åœ¨æ ¼ä¸­åŸºåº•å……åˆ†æ­£äº¤çš„æƒ…å†µä¸‹ï¼Œå¯¹ä»»æ„å‘é‡$\vec w$è¿›è¡Œåˆ†è§£ï¼Œç„¶åå–$\vec v_i$å‘é‡ä¸­çš„æ¯ä¸ªå‘é‡çš„ç³»æ•°$b_i$å–å…¶æœ€æ¥è¿‘çš„æ•´æ•°ä½œä¸ºæˆ‘ä»¬æ‰€æ±‚å‘é‡çš„åˆ†é‡ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªä¸‰ç»´çš„æ ¼ä¸­ï¼Œå‡è®¾$\vec v_1,\vec v_2,\vec v_3$å……åˆ†æ­£äº¤ï¼ˆ$H(v_1,v_2,v_3)&gt;0.7$ï¼‰ï¼ŒæŸä¸ªå‘é‡$\vec w$çš„åˆ†è§£è¡¨è¾¾å¼ä¸º$\vec w&#x3D;3.23\vec v_1+4.83\vec v_2-4.07\vec v_3$ï¼Œé‚£ä¹ˆä¸å®ƒæœ€æ¥è¿‘çš„ä¸€ä¸ªæ ¼ä¸­çš„å‘é‡å°±æ˜¯$3\vec v_1+5\vec v_2-4 \vec v_3$ã€‚å¦‚æœ$H(B)$å€¼è¿‡äºæ¥è¿‘äº$0$ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´æœ€æ¥è¿‘çš„å‘é‡å€¼å‡ºç°çš„åå·®ä¹Ÿä¼šæ¯”è¾ƒå¤§ï¼Œç”šè‡³å¾ˆæœ‰å¯èƒ½å°±ä¸æ˜¯æœ€è¿‘çš„æ ¼ç‚¹äº†ã€‚</p><h2 id="7-åŸºäºå›°éš¾æ ¼é—®é¢˜çš„å¯†ç "><a href="#7-åŸºäºå›°éš¾æ ¼é—®é¢˜çš„å¯†ç " class="headerlink" title="7.åŸºäºå›°éš¾æ ¼é—®é¢˜çš„å¯†ç "></a>7.åŸºäºå›°éš¾æ ¼é—®é¢˜çš„å¯†ç </h2><p><strong>[Translated by baidu translation]</strong></p><p>åœ¨20ä¸–çºª90å¹´ä»£ä¸­æœŸï¼Œå¼•å…¥äº†å‡ ä¸ªå¯†ç ç³»ç»Ÿï¼Œå…¶æ½œåœ¨çš„ç¡¬é—®é¢˜æ˜¯å¤§ç»´Nçš„æ ¼Lä¸­çš„SVPå’Œ&#x2F;æˆ–CVPã€‚å…¶ä¸­æœ€é‡è¦çš„ï¼ŒæŒ‰å­—æ¯é¡ºåºæ’åˆ—Dworkå¯†ç ç³»ç»Ÿã€Goldreichã€Goldwasserå’ŒHaleviçš„GGHå¯†ç ç³»ç»Ÿï¼Œä»¥åŠHoffsteinã€Pipherå’ŒSilvermanæå‡ºçš„NTRUå¯†ç ç³»ç»Ÿã€‚</p><p>å¼•å…¥è¿™äº›å¯†ç ç³»ç»Ÿçš„åŠ¨æœºæ˜¯åŒé‡çš„ã€‚ é¦–å…ˆï¼Œæ‹¥æœ‰åŸºäºå„ç§ç¡¬æ•°å­¦é—®é¢˜çš„å¯†ç ç³»ç»Ÿå½“ç„¶æ˜¯ä»¤äººæ„Ÿå…´è¶£çš„ï¼Œå› ä¸ºä»é‚£æ—¶èµ·ï¼Œè§£å†³ä¸€ä¸ªæ•°å­¦é—®é¢˜çš„çªç ´å¹¶ä¸ä¼šæŸå®³æ‰€æœ‰ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚ å…¶æ¬¡ï¼ŒåŸºäºæ ¼çš„å¯†ç ä½“åˆ¶å¾€å¾€æ¯”åˆ†è§£æˆ–ç¦»æ•£å¯¹æ•°ç³»ç»Ÿ(å¦‚ElGamalã€RSAå’ŒECC)å¿«å¾—å¤šã€‚ ç²—ç•¥åœ°è¯´ï¼Œä¸ºäº†å®ç°$k$ä½çš„å®‰å…¨ï¼ŒElGamalã€RSAå’ŒECCéœ€è¦$O(K^3)$æ“ä½œï¼Œè€ŒåŸºäºæ ¼çš„ç³»ç»Ÿçš„åŠ å¯†å’Œè§£å¯†åªéœ€è¦$O(K^2)$æ“ä½œã€‚ æ­¤å¤–ï¼ŒåŸºäºæ ¼çš„ç³»ç»Ÿä½¿ç”¨çš„ç®€å•çº¿æ€§ä»£æ•°æ“ä½œåœ¨ç¡¬ä»¶å’Œè½¯ä»¶ä¸Šéå¸¸å®¹æ˜“å®ç°ã€‚ ç„¶è€Œï¼Œå¿…é¡»æŒ‡å‡ºçš„æ˜¯ï¼ŒåŸºäºæ ¼çš„å¯†ç ä½“åˆ¶çš„å®‰å…¨åˆ†æå¹¶ä¸åƒåŸºäºå› å¼åˆ†è§£å’Œç¦»æ•£å¯¹æ•°çš„ç³»ç»Ÿé‚£æ ·å®¹æ˜“ç†è§£ã€‚ å› æ­¤ï¼Œè™½ç„¶åŸºäºç‚¹é˜µçš„ç³»ç»Ÿæ˜¯ç›®å‰è®¸å¤šç ”ç©¶çš„ä¸»é¢˜ï¼Œä½†ä¸æ—§ç³»ç»Ÿç›¸æ¯”ï¼Œå®ƒä»¬çš„å®é™…å®ç°æ˜¯å¾ˆå°‘çš„ã€‚</p><p>Ajtai-Dworkç³»ç»Ÿç‰¹åˆ«æœ‰è¶£ï¼Œå› ä¸ºAjtaiå’ŒDworkè¡¨æ˜ï¼Œé™¤éåœ¨å¤šé¡¹å¼æ—¶é—´å†…è§£å†³æœ€åæƒ…å†µä¸‹çš„æ™¶æ ¼é—®é¢˜ï¼Œå¦åˆ™å®ƒä»¬çš„ç³»ç»Ÿæ˜¯å¯è¯æ˜çš„å®‰å…¨çš„ã€‚ æŠµæ¶ˆè¿™ä¸€é‡è¦çš„ç†è®ºç»“æœæ˜¯å¯†é’¥å¤§å°è¢«è¯æ˜æ˜¯$O(N^4)$çš„å®é™…é™åˆ¶ï¼Œè¿™å¯¼è‡´äº†å·¨å¤§çš„å¯†é’¥ã€‚ é˜®å’Œæ–¯ç‰¹æ©éšåè¡¨æ˜ï¼ŒAjtai-Dworkç³»ç»Ÿçš„ä»»ä½•å®é™…å’Œæœ‰æ•ˆçš„å®ç°éƒ½æ˜¯ä¸å®‰å…¨çš„ã€‚</p><p>ç„¶åæˆ‘ä»¬ä¼šåœ¨ä¸‹é¢ç»§ç»­è®²è§£å‡ ä¸ªå…¸å‹çš„æ ¼å¯†ç </p><h2 id="8-GGHå…¬é’¥å¯†ç ç³»ç»Ÿ"><a href="#8-GGHå…¬é’¥å¯†ç ç³»ç»Ÿ" class="headerlink" title="8.GGHå…¬é’¥å¯†ç ç³»ç»Ÿ"></a>8.GGHå…¬é’¥å¯†ç ç³»ç»Ÿ</h2><h3 id="8x01-åŠ å¯†è¿‡ç¨‹"><a href="#8x01-åŠ å¯†è¿‡ç¨‹" class="headerlink" title="8x01 åŠ å¯†è¿‡ç¨‹"></a>8x01 åŠ å¯†è¿‡ç¨‹</h3><p>Aliceé¦–å…ˆé€‰å–ä¸€ç»„çº¿æ€§æ— å…³çš„å‘é‡ç»„$\vec v_1,\vec v_2,â€¦,\vec v_n$ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯ç›¸å½“æ­£äº¤çš„ã€‚è¿™æ ·åšçš„ä¸€ä¸ªæ–¹æ³•æ˜¯ç¡®å®šä¸€ä¸ªå‚æ•°$d&gt;0$ï¼Œç„¶ååœ¨$-d$ä¸$d$ä¹‹é—´éšæœºé€‰æ‹©åŸºåº•å‘é‡$\vec v$çš„åæ ‡ã€‚ä¹Ÿå¯ä»¥è®¡ç®—å®ƒçš„Hadamardæ¯”ç‡ æ¥çœ‹çœ‹å®ƒä»¬æ˜¯å¦ç›¸å½“æ­£äº¤ã€‚ç¡®å®šå¥½å‘é‡ä¹‹åï¼Œå°±æ„å»ºä¸€ä¸ªä»¥$\vec v_1$åˆ°$\vec v_n$ä¸ºåŸºåº•çš„æ ¼$L$å’Œç”±è¿™äº›ï¼ˆè¡Œï¼‰å‘é‡æ„å»ºçš„ä¸€ä¸ªçŸ©é˜µ$V$ã€‚è¿™äº›å‘é‡ä¹Ÿå°†æˆä¸ºAliceçš„ç§é’¥ã€‚</p><p>Aliceç„¶åé€‰æ‹©ä¸€ä¸ª$nÃ—n$çš„çŸ©é˜µ$U$ï¼Œæ»¡è¶³$U$ä¸­æ‰€æœ‰å…ƒç´ å‡ä¸ºæ•´æ•°ä¸”$\det ^2 U&#x3D;1$ã€‚ç„¶åè®¡ç®—$W&#x3D;UV$ï¼Œå¹¶å°†$W$ä¸­æ‰€æœ‰çš„è¡Œå‘é‡ä½œä¸ºå…¬é’¥ã€‚</p><p>å½“Bobæƒ³è¦ä¼ é€’ä¿¡æ¯ç»™Aliceæ—¶ï¼Œä»–ä¼šé€‰æ‹©ä¸€ä¸ªå°å‘é‡ï¼ˆæ¯”å¦‚äºŒè¿›åˆ¶å‘é‡ï¼‰ä½œä¸ºä»–çš„æ˜æ–‡$\vec m$ã€‚ç„¶åå†é€‰æ‹©ä¸€ä¸ªå°çš„éšæœºæ‰°åŠ¨å‘é‡$\vec r$ã€‚ç„¶åä»–è®¡ç®—$\vec c&#x3D;\vec mW+\vec r$ã€‚$\vec c$å¹¶ä¸æ˜¯æ ¼ä¸Šçš„ç‚¹ï¼Œä½†ç”±äº$\vec m$æ˜¯ä¸€ä¸ªå°å‘é‡ï¼Œå› æ­¤$\vec r$æ˜¯ä¸€ä¸ªå°å‘é‡ã€‚</p><p>Aliceè§£å¯†æ—¶ä¹Ÿå¾ˆç›´æ¥ï¼Œå¥¹å¯ä»¥ä½¿ç”¨Babaiç®—æ³•è®¡ç®—ä¸$\vec c$æœ€æ¥è¿‘çš„æ ¼å‘é‡$\vec d $ï¼Œç„¶åè®¡ç®—$\vec dW^{-1}$å°±å¯ä»¥æ¢å¤æ˜æ–‡$\vec m$</p><p>ä¸‹é¢æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹ï¼š</p><p>é¦–å…ˆï¼ŒAliceé€‰æ‹©å‘é‡$\vec v_1&#x3D;(-97,19,19),\vec v_2&#x3D;(-36,30,86),\vec v_3&#x3D;(-184,-64,78)$ä½œä¸ºåŸºåº•$B$ã€‚ç»è®¡ç®—ï¼Œ$H(B)&#x3D;0.7462$ï¼Œç¬¦åˆæ¡ä»¶ã€‚</p><p>Aliceæ„å»ºå¦‚ä¸‹çŸ©é˜µ$U$ï¼ˆå…¶è¡Œåˆ—å¼ä¸º$-1$ï¼‰,ç„¶åè®¡ç®—$W&#x3D;UV$å¦‚ä¸‹å›¾</p><img src="/2021/02/04/LatticeNotes3/1.png" alt="1" style="zoom:130%;"><p>ç„¶åï¼ŒBobè®¾å®šæ˜æ–‡ä¸º$\vec m&#x3D;(86,-35,-32)$ï¼Œæ‰°åŠ¨å‘é‡ä¸º$\vec r&#x3D;(-4,-3,2)$</p><p>éšåè®¡ç®—$\vec c&#x3D;\vec mW+\vec r&#x3D;(-79081427,-35617462,11035473)$ï¼Œå¹¶å°†ç»“æœå‘é€ç»™Alice</p><p>æ”¶åˆ°æ¶ˆæ¯åï¼ŒAliceé€šè¿‡çº¿æ€§ä»£æ•°è®¡ç®—ï¼Œåˆ†è§£$\vec c$å¾—$\vec c &#x3D; 81878.97\vec v_1 âˆ’ 292300.00 \vec v_2 + 443815.04 \vec v_3$.</p><p>ç„¶åå¥¹é€‰å–å‘é‡$\vec d&#x3D;81879\vec v_1 âˆ’ 292300 \vec v_2 + 443815 \vec v_3&#x3D; (âˆ’79081423, âˆ’35617459, 11035471)$ã€‚å®¹æ˜“çœ‹å‡º$\vec d$ä¸$\vec e$è¿‘ä¼¼ã€‚ç„¶åAliceå°±å¯ä»¥è®¡ç®—å‡ºæ˜æ–‡$\vec m&#x3D;\vec d W^{-1}&#x3D;(86,-35,-32)$</p><p>ç„¶è€Œï¼Œå½“æ”»å‡»è€…æƒ³è¦é€šè¿‡å…¬é’¥è®¡ç®—å¯†æ–‡å¾—è¯ï¼Œè®¡ç®—$\vec c&#x3D;75.76\vec w_1-34.52\vec w_2-24.18 \vec w_3$ã€‚å› æ­¤å¾—åˆ°äº†é”™è¯¯çš„æ˜æ–‡$(75,-35,-24)$ã€‚åŸå› ä¹Ÿå¾ˆç®€å•ã€‚å› ä¸º$H(V)&#x3D;0.7462$ï¼Œæ¯”è¾ƒå¤§ï¼Œè€Œ$H(W)&#x3D;0.00002$å¾ˆå°ã€‚å› æ­¤å¯¼è‡´äº†è¯¯å·®çš„å‡ºç°ã€‚</p><p>å½“ç„¶ï¼Œåœ¨$3$ç»´çš„æ ¼ä¸­è¿›è¡ŒåŠ è§£å¯†æ˜¯ä¸å®‰å…¨çš„ã€‚åé¢çš„ç¬”è®°ä¸­ï¼Œæˆ‘ä»¬ä¼šè®²åˆ°LLLç®—æ³•ã€‚</p><h3 id="8x02-é™„æ³¨"><a href="#8x02-é™„æ³¨" class="headerlink" title="8x02 é™„æ³¨"></a>8x02 é™„æ³¨</h3><p>1.æˆ‘ä»¬è§‚å¯Ÿåˆ°GGHæ˜¯æ¦‚ç‡å¯†ç ç³»ç»Ÿçš„ä¸€ä¸ªä¾‹å­ï¼Œå› ä¸ºç”±äºéšæœºæ‰°åŠ¨rçš„é€‰æ‹©ï¼Œå•ä¸ªæ˜æ–‡å¯¼è‡´è®¸å¤šä¸åŒçš„å¯†æ–‡ã€‚å¦‚æœBobä½¿ç”¨ä¸åŒçš„éšæœºæ‰°åŠ¨ä¸¤æ¬¡å‘é€ç›¸åŒçš„æ¶ˆæ¯ï¼Œæˆ–è€…ä½¿ç”¨ç›¸åŒçš„éšæœºæ‰°åŠ¨å‘é€ä¸åŒçš„æ¶ˆæ¯ï¼Œè¿™å°†å¯¼è‡´æ½œåœ¨çš„å±é™©ã€‚ å› æ­¤ï¼Œåœ¨å®è·µä¸­ï¼Œéšæœºæ‰°åŠ¨ræ˜¯é€šè¿‡å°†å“ˆå¸Œå‡½æ•°åº”ç”¨äºæ˜æ–‡$m$æ¥ç¡®å®šçš„ã€‚</p><p>2.å¦ä¸€ä¸ªç‰ˆæœ¬çš„GGHé€†è½¬äº†$m$å’Œ$r$çš„è§’è‰²ï¼Œå› æ­¤å¯†æ–‡å…·æœ‰å½¢å¼$c&#x3D;\vec rW+\vec m$ã€‚Aliceé€šè¿‡è®¡ç®—æœ€æ¥è¿‘$c$çš„æ ¼å‘é‡æ‰¾åˆ°$\vec rW$ï¼Œç„¶åå¥¹å°†æ˜æ–‡æ¢å¤ä¸º$\vec m&#x3D;\vec câˆ’\vec rW$ã€‚</p><h2 id="9-å·ç§¯å¤šé¡¹å¼ç¯"><a href="#9-å·ç§¯å¤šé¡¹å¼ç¯" class="headerlink" title="9.å·ç§¯å¤šé¡¹å¼ç¯"></a>9.å·ç§¯å¤šé¡¹å¼ç¯</h2><h3 id="9x01-ç®€ä»‹"><a href="#9x01-ç®€ä»‹" class="headerlink" title="9x01 ç®€ä»‹"></a>9x01 ç®€ä»‹</h3><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬æè¿°äº†NTRUå…¬é’¥å¯†ç ç³»ç»Ÿä½¿ç”¨çš„ç‰¹æ®Šå¤šé¡¹å¼å•†ç¯ï¼Œè¿™ä¹Ÿæ˜¯åœ¨åé¢çš„ç¬”è®°ä¸­æˆ‘ä»¬ä¼šç”¨åˆ°çš„ã€‚</p><p>å›ºå®šä¸€ä¸ªæ•´æ•°$N$ï¼Œä½¿å¾—å·ç§¯å¤šé¡¹å¼çš„ç¯æ˜¯å•†ç¯$R&#x3D;\dfrac{Z[x]}{x^N-1}$ã€‚åŒç†ï¼Œå·ç§¯å¤šé¡¹å¼ç¯æ¨¡$q$åï¼Œå‰©ä¸‹çš„ç¯ä¹Ÿæ˜¯å•†ç¯$R_q&#x3D;\dfrac{\frac{Z}{qZ}[x]}{x^N-1}$ã€‚</p><p>å½“ç„¶ï¼Œ$R$å’Œ$R_q$ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ä¸ªå½¢å¼ä¸º$\sum _{i&#x3D;0}^{n-1}a_ix^i$ã€‚æ‰€æœ‰çš„$a$ä½œä¸ºç³»æ•°ï¼Œå–å€¼èŒƒå›´ä¸º$Z$æˆ–è€…$Z_q$ã€‚è€Œæˆ‘ä»¬å¯¹$x^N-1$å–æ¨¡çš„åŸå› ä¹Ÿéå¸¸çš„ç®€å•ï¼Œå› ä¸ºä¸€æ—¦å‡ºç°äº†$x^N$ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶æ›¿æ¢æˆ$1$ï¼ŒåŒç†ï¼Œå‡ºç°$x^{N+1}$æˆ‘ä»¬å¯ä»¥å°†å…¶æ›¿æ¢æˆ$x$ï¼Œ</p><h3 id="9x02-æ— æ¨¡æ•°æƒ…å†µä¸‹çš„è®¡ç®—æ³•åˆ™"><a href="#9x02-æ— æ¨¡æ•°æƒ…å†µä¸‹çš„è®¡ç®—æ³•åˆ™" class="headerlink" title="9x02 æ— æ¨¡æ•°æƒ…å†µä¸‹çš„è®¡ç®—æ³•åˆ™"></a>9x02 æ— æ¨¡æ•°æƒ…å†µä¸‹çš„è®¡ç®—æ³•åˆ™</h3><p>ä¸¤ä¸ªå¤šé¡¹å¼çš„åŠ æ³•ï¼Œç›´æ¥å°±æ˜¯å°†$x$ç›¸åŒæ¬¡æ•°ç›¸åŠ ã€‚è®¾$f(x)&#x3D;\sum_{i&#x3D;0}^{n-1}a_ix^i,g(x)&#x3D;\sum_{i&#x3D;0}^{n-1}b_ix^i$ã€‚åˆ™<br>$$<br>f(x)+g(x)&#x3D;\sum_{i&#x3D;0}^{n-1}(a_i+b_i)x^i<br>$$<br>è€Œå¯¹äº$2$ä¸ªå¤šé¡¹å¼ç›¸ä¹˜$f(x)g(x)$ï¼Œæˆ‘ä»¬æœ‰è¿™æ ·çš„è®¡ç®—æ–¹æ³•ï¼š<br>$$<br>f(x)g(x)&#x3D;\sum_{i&#x3D;0}^{n-1} \sum_{j+k\equiv i \pmod n} a_jb_k<br>$$<br>ä¾‹å¦‚ï¼Œå‡å¦‚$f(x)&#x3D;x^4+3x^3+x^2-2x+1,g(x)&#x3D;4x^4+x^3-2x^2+3x+3$ã€‚é‚£ä¹ˆ$f(x)+g(x)$ä¸­ï¼Œ$x^3$å‰é¢çš„ç³»æ•°å°±æ˜¯$3+1&#x3D;4$ã€‚è€Œ$f(x)g(x)$ä¸­ï¼Œ$x^3$å‰é¢çš„ç³»æ•°åˆ™ä¸º$a_0b_3+a_1b_2+a_2b_1+a_3b_0+a_4b_4&#x3D;1Ã—1+(-2)Ã—(-2)+1Ã—3+3Ã—3+1Ã—4&#x3D;21$ã€‚æ³¨æ„åˆ°è¿™é‡Œçš„$n&#x3D;5$,é™¤äº†$0+3,1+2,2+1,3+0 \equiv 3 \pmod 5$ä¹‹å¤–ï¼Œ$4+4\equiv 3 \pmod 5$ä¹Ÿæ˜¯æˆç«‹çš„ï¼Œå› æ­¤ä¸èƒ½æŠŠ$a_4b_4$è¿™ä¸€é¡¹æ¼æ‰ã€‚</p><h3 id="9x03-æœ‰æ¨¡æ•°æƒ…å†µä¸‹çš„è®¡ç®—æ³•åˆ™"><a href="#9x03-æœ‰æ¨¡æ•°æƒ…å†µä¸‹çš„è®¡ç®—æ³•åˆ™" class="headerlink" title="9x03 æœ‰æ¨¡æ•°æƒ…å†µä¸‹çš„è®¡ç®—æ³•åˆ™"></a>9x03 æœ‰æ¨¡æ•°æƒ…å†µä¸‹çš„è®¡ç®—æ³•åˆ™</h3><p>å‡å¦‚$n&#x3D;5$æ—¶ä¸¤ä¸ªå¤šé¡¹å¼$f(x),g(x)$ç»è¿‡è®¡ç®—ï¼Œå¾—åˆ°äº†ç»“æœä¸º$h(x)&#x3D;4x^4+23x^3-7x^2+9x-10$ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å¯¹å®ƒæ¨¡$15$çš„æ“ä½œï¼Œæˆ‘ä»¬åˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>å¾ˆå®¹æ˜“æƒ³åˆ°çš„å°±æ˜¯æŠŠ$23$æ¢æˆ$8$ï¼ŒåŒ–$h(x)$è¡¨è¾¾å¼ä¸ºï¼Œ$h(x)&#x3D;4x^4+8x^3-7x^2+9x-10$</p><p>ä¸è¿‡åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œç”±äºæ•°å­—è¶Šå°è¶Šå®¹æ˜“è®¡ç®—ï¼Œå› æ­¤æˆ‘ä»¬ä¸€èˆ¬é€‰æ‹©å°†æ‰€æœ‰çš„ç³»æ•°å‹ç¼©åœ¨åŒºé—´$(\dfrac {-q} 2,\dfrac q 2]$è¿™ä¸ªåŒºé—´é‡Œï¼Œå› æ­¤æˆ‘ä»¬æœ€å¥½æŠŠ$8$åŒ–æˆ$-7$ï¼Œ$9$åŒ–æˆ$-6$ï¼Œ$-10$åŒ–æˆ$5$ï¼Œå› æ­¤æœ€åæˆ‘ä»¬åŒ–ç®€åçš„è¡¨è¾¾å¼å°±æ˜¯<br>$$<br>h(x)&#x3D;4x^4-7x^3-7x^2-6x+5<br>$$<br>ç‰¹æ®Šåœ°ï¼Œå¦‚æœ$q&#x3D;2$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰€å¾—åˆ°çš„ä¸€ä¸ªå¤šé¡¹å¼å°±æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å¤šé¡¹å¼ã€‚å¹¶ä¸”å¹³æ—¶ä¸ºäº†ç®€åŒ–è®¡ç®—ï¼Œæœ€å¥½æå‰å°†$f(x)$ä¸$g(x)$ä¸­çš„æ‰€æœ‰ç³»æ•°è¿›è¡ŒåŒ–ç®€ï¼Œç„¶åå†è¿›è¡Œä¹˜ç§¯ã€‚</p><h3 id="9x04-ç´ æ•°åŸŸä¸­çš„ä¹˜æ³•è¿ç®—"><a href="#9x04-ç´ æ•°åŸŸä¸­çš„ä¹˜æ³•è¿ç®—" class="headerlink" title="9x04 ç´ æ•°åŸŸä¸­çš„ä¹˜æ³•è¿ç®—"></a>9x04 ç´ æ•°åŸŸä¸­çš„ä¹˜æ³•è¿ç®—</h3><p>åˆšæ‰æˆ‘ä»¬è®²åˆ°çš„é‚£ä¸ªä¾‹å­ä¸­ï¼Œæ¨¡æ•°$15$ä¸æ˜¯ç´ æ•°ï¼Œè€Œå¦‚æœå½“æ¨¡æ•°æ˜¯ç´ æ•°æ—¶ï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ªå¤šé¡¹å¼ç¯ä¸­çš„ä»»æ„ä¸€ä¸ªå¤šé¡¹å¼$f(x)$ï¼Œæ€»å­˜åœ¨å”¯ä¸€çš„ä¸€ä¸ª$g(x)$ï¼Œä½¿å¾—$f(x)g(x)\equiv 1 \pmod q$ ã€‚æ­¤æ—¶æˆ‘ä»¬ç§°$g(x)$æ˜¯$f(x)$çš„é€†å…ƒã€‚è€Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—è®¡ç®—ä¸¤ä¸ªå¤šé¡¹å¼çš„æœ€å¤§å…¬çº¦å¼$&#x3D;1$å’Œå®ƒä»¬çš„æ¨¡é€†ã€‚è¿™ä¸€æ­¥å¾ˆå®¹æ˜“åœ¨Sagemathä¸­å®ç°ã€‚</p><p>ä¸‹é¢è¿™å¼ å›¾å…·ä½“åœ°å®ç°äº†$f(x)g(x)$ç»“æœå’Œæ±‚$h(x),p(x)$çš„æœ€å¤§å…¬å› æ•°ï¼Œå®šä¹‰åŸŸä¸º$GF(13)$ï¼Œå¤šé¡¹å¼æœ€é«˜æ¬¡ä¸º$x^7$ï¼Œå–æ¨¡$x^8-1$</p><p>æ³¨æ„åˆ°æˆ‘ä»¬å¦‚æœç”¨æ¬§å‡ é‡Œå¾—è¾—è½¬ç›¸é™¤æ³•ï¼Œè®¡ç®—å‡ºæ¥çš„$\gcd (h(x),p(x))&#x3D;9x+4$ã€‚ä¸è¿‡æœ€åæ­£ç¡®çš„ç­”æ¡ˆå´æ˜¯$x+12$ã€‚å› ä¸ºæœ€é«˜æ¬¡é¡¹ç³»æ•°ä¸º$1$çš„å¤šé¡¹å¼è®¡ç®—æ€»æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œå¤šé¡¹å¼ä¸¤è¾¹é™¤ä»¥$9$ï¼ˆä¹Ÿå°±æ˜¯ä¹˜ä¸Š$9$æ¨¡$13$çš„é€†å…ƒ$3$ï¼Œå°±å¯ä»¥å¾—åˆ°$x+12$çš„ç»“æœäº†ï¼‰</p><p><img src="/2021/02/04/LatticeNotes3/2.png" alt="2"></p><p>æ¨¡æ•°ä¸æ˜¯ç´ æ•°çš„æ—¶å€™ï¼Œæœ‰äº›æ­¥éª¤ä¹Ÿæ˜¯å¯ä»¥è®¡ç®—çš„ï¼ŒæŠŠ$13$æ¢æˆ$15$ï¼Œå¾ˆå¤šä¹Ÿæ˜¯å¯è¡Œçš„ã€‚ä¸è¿‡è¿™é‡Œè¦ç”¨Zmodï¼Œå› ä¸º$GF(15)$æ— æ„ä¹‰ã€‚</p><p>å›é¡¾ä¸€ä¸‹ï¼šåªæœ‰æŸä¸ªæ•°å¼ç´ æ•°æˆ–è€…ç´ æ•°å¹‚çš„æ—¶å€™ï¼Œ$GF$åŸŸæ‰æœ‰æ„ä¹‰ï¼Œä¾‹å¦‚$GF(2),GF(3),GF(7),GF(11)$æˆ–$GF(9),GF(256),GF(343),GF(14641)$</p><p><img src="/2021/02/04/LatticeNotes3/3.png" alt="3"></p><p>ä½†ç¯è·Ÿ$GF$åŸŸä¸ä¸€æ ·ï¼Œæ— è®ºç¯é•¿åº¦æˆ–è€…æ¨¡æ•°æ˜¯ä¸æ˜¯ç´ æ•°ï¼Œ ç¯éƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå¹¶ä¸”åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½¿ç”¨åˆæ•°$q$äº§ç”Ÿçš„æ•ˆæœåè€Œæ¯”ä½¿ç”¨ç´ æ•°æ¥çš„æ›´å¥½ï¼ˆæ¯”å¦‚$q&#x3D;2^k$ï¼‰</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœ$q$æ˜¯ç´ æ•°$p$çš„å¹‚ï¼Œé‚£ä¹ˆä¸ºäº†è®¡ç®—$R_q$ä¸­$ f(x)$çš„é€†ï¼Œé¦–å…ˆè®¡ç®—$R_p$ä¸­çš„é€†ï¼Œç„¶åâ€œæå‡â€è¿™ä¸ªå€¼åˆ°$R_{p^2}$ä¸­çš„é€†ï¼Œç„¶ååœ¨$R_{p^4}$ä¸­æå‡åˆ°é€†ï¼Œä»¥æ­¤ç±»æ¨ã€‚ åŒæ ·ï¼Œå¦‚æœ$q$æ˜¯å¤šä¸ªç´ æ•°ï¼ˆå¹‚ï¼‰$q_i$çš„ä¹˜ç§¯ï¼Œåˆ™é¦–å…ˆè®¡ç®—$R_{q_i}$ä¸­çš„é€†ï¼Œç„¶åä½¿ç”¨ä¸­å›½ä½™æ•°å®šç†ç»„åˆé€†ã€‚</p><p><strong>Update 7.29 å¢åŠ äº†å…·ä½“å®ç°æ–¹æ³•ï¼š</strong></p><p>ä¸‹é¢æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹å…·ä½“åœ¨$R_q$ä¸­æ±‚å‡ºæŸä¸ªå¤šé¡¹å¼$f(x)$çš„é€†ï¼Œå…¶ä¸­$q&#x3D;p^{e}$:</p><p>å‡è®¾æˆ‘ä»¬å·²çŸ¥:<br>$$<br>f(x)F(x)\equiv 1 \pmod {x^n}<br>$$<br>é‚£ä¹ˆæˆ‘ä»¬æœ‰<br>$$<br>G(x)&#x3D;(2-f(x)F(x))F(x)<br>$$<br>ä½¿å¾—$f(x)G(x)\equiv 1 \pmod {x^{2n}}$</p><p>ä»¥ä¸Šæ‰€æœ‰çš„å¤šé¡¹å¼è®¡ç®—éƒ½åœ¨ $R_q$ ä¸­å®ç° </p><p><strong>Update 2023.12.11</strong> è¿™å°±æ˜¯å¤šé¡¹å¼æ±‚é€†çš„å…¬å¼ï¼</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LatticeNotes2</title>
    <link href="/2021/02/03/LatticeNotes2/"/>
    <url>/2021/02/03/LatticeNotes2/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°2"><a href="#huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°2" class="headerlink" title="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°2"></a>huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°2</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0. About"></a>0. About</h2><p>è¿™ä¸ªç¬”è®°æ¥ç€ä¹‹å‰å‘å¸ƒçš„ç¬”è®°1ï¼Œç»§ç»­å¾€åé¢æ‰©å±•æ–°çš„å†…å®¹ã€‚</p><h2 id="3-é¢„å¤‡çŸ¥è¯†2ï¼šå‘é‡ç©ºé—´"><a href="#3-é¢„å¤‡çŸ¥è¯†2ï¼šå‘é‡ç©ºé—´" class="headerlink" title="3. é¢„å¤‡çŸ¥è¯†2ï¼šå‘é‡ç©ºé—´"></a>3. é¢„å¤‡çŸ¥è¯†2ï¼šå‘é‡ç©ºé—´</h2><p>1.å®šä¹‰ï¼šå‘é‡ç©ºé—´æ˜¯ä¸€ç»„å‘é‡çš„é›†åˆï¼Œè¿™äº›å‘é‡æ»¡è¶³åŠ æ³•ä¸æ•°ä¹˜çš„å°é—­æ€§ã€‚ä¹Ÿå°±æ˜¯å¯¹äºä»»æ„çš„å‘é‡$\vec a ,\vec b \in V$ï¼Œéƒ½æœ‰$\vec a+\vec b \in V$ï¼Œ$\lambda\vec a \in V(\lambda \in R)$ã€‚</p><p>2.çº¿æ€§æ— å…³ï¼šæœ‰$n$ä¸ªå‘é‡ï¼Œæ»¡è¶³$a_1\vec v_1+a_2 \vec v_2+â€¦+ a_n \vec v_n&#x3D; \vec 0$ã€‚è‹¥å¯ä»¥æ‰¾åˆ°ä¸€ç»„ä¸å…¨ä¸º$0$çš„å®æ•°ä½¿è¿™ä¸ªç­‰å¼æˆç«‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯´$v_1,v_2,â€¦,v_n$çº¿æ€§ç›¸å…³ã€‚å¦åˆ™$v_1,v_2,â€¦,v_n$çº¿æ€§æ— å…³ã€‚</p><p>3.åŸºåº•è‹¥$V$ä¸­æœ‰ä¸€ç»„çº¿æ€§æ— å…³çš„å‘é‡$v_1,v_2,â€¦,v_r$ï¼Œé‚£ä¹ˆå½“è¿™$r$ä¸ªå‘é‡æ˜¯$V$ä¸­çš„ä¸€ç»„åŸºåº•æ—¶ï¼Œä»»ä½•ä¸€ä¸ªå‘é‡$w \in V$éƒ½å¯ä»¥ç”¨$v_1$åˆ°$v_r$çº¿æ€§è¡¨ç¤ºä¸”è¡¨ç¤ºæ–¹æ³•å”¯ä¸€ã€‚è€ŒåŸºåº•ä¹Ÿä¸€èˆ¬å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæå¤§çº¿æ€§æ— å…³ç»„ã€‚</p><p>è‹¥$V$ä¸­æœ‰ä¸€ç»„åŸºåº•$v_1,v_2,â€¦,v_n$ï¼Œå¦‚æœè¿˜æœ‰ä¸€ç»„å‘é‡$w_1,w_2,â€¦,w_n$ä¹Ÿå¯ä»¥ä½œä¸º$V$çš„åŸºåº•ã€‚é‚£ä¹ˆå¯ä»¥æ¨å‡ºï¼Œæ¯ä¸ªå‘é‡$w$éƒ½å¯ä»¥ç”¨$v_1$åˆ°$v_n$è¡¨ç¤ºï¼Œä¸”å°†è¡¨ç¤ºç³»æ•°å†™æˆçŸ©é˜µï¼Œè¯¥çŸ©é˜µçš„è¡Œåˆ—å¼ä¸ä¸º$0$ã€‚</p><p><del>4.å‘é‡çš„é•¿åº¦ã€ä¸¤å‘é‡å¤¹è§’ã€å‘é‡çš„æ•°é‡çº§å†…å®¹ç•¥å»ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œé«˜ä¸­çš„çŸ¥è¯†ç›´æ¥ç±»æ¯”è¿‡æ¥å°±å¯ä»¥äº†ï¼Œå½“ç„¶å¤§å­¦çš„çº¿æ€§ä»£æ•°ä¹Ÿæ˜¯æœ‰çš„ã€‚</del></p><p>5.å‘é‡çš„æ ‡å‡†æ­£äº¤åŸºï¼šå¦‚æœæœ‰ä¸€ç»„å‘é‡$e_1,e_2,â€¦,e_n$æ˜¯å‘é‡ç©ºé—´$V$çš„ä¸€ç»„æ ‡å‡†æ­£äº¤åŸºï¼Œé‚£ä¹ˆæœ‰$e_iÂ·e_j&#x3D;0(i \not &#x3D;j)$å’Œ$|e_i|&#x3D;1$</p><p>6.æ–½å¯†ç‰¹æ­£äº¤åŒ–æ–¹æ³•</p><p><del>ä¸çŸ¥é“çš„è‡ªè¡Œç™¾åº¦å»ï¼Œæˆ‘ç›´æ¥ä¸Šä¸ªC++ä»£ç èµ°äººï¼Œè®²èµ·æ¥+è¯æ˜è€—è´¹çš„ç¯‡ç« å¤ªå¤§äº†ã€‚</del></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m;<br><span class="hljs-type">double</span> a[<span class="hljs-number">70</span>][<span class="hljs-number">70</span>],b[<span class="hljs-number">70</span>][<span class="hljs-number">70</span>];<br><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">len</span><span class="hljs-params">(<span class="hljs-type">double</span> v[],<span class="hljs-type">int</span> dim)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-type">double</span> A=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=dim;i++)<br>A+=v[i]*v[i];<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">sqrt</span>(A);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">mul</span><span class="hljs-params">(<span class="hljs-type">double</span> v[],<span class="hljs-type">double</span> w[],<span class="hljs-type">int</span> dim)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-type">double</span> A=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=dim;i++)<br>A+=v[i]*w[i];<br><span class="hljs-keyword">return</span> A;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j,k;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br><span class="hljs-keyword">for</span>(j=<span class="hljs-number">1</span>;j&lt;=m;j++)<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lf&quot;</span>,&amp;a[i][j]);<br><span class="hljs-built_in">memcpy</span>(b[<span class="hljs-number">1</span>],a[<span class="hljs-number">1</span>],<span class="hljs-built_in">sizeof</span>(a[<span class="hljs-number">1</span>]));<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">2</span>;i&lt;=n;i++)<br><span class="hljs-keyword">for</span>(j=<span class="hljs-number">1</span>;j&lt;i;j++)<br>&#123;<br><span class="hljs-built_in">memcpy</span>(b[i],a[i],<span class="hljs-built_in">sizeof</span>(a[i]));<br><span class="hljs-type">double</span> tmp=<span class="hljs-built_in">mul</span>(a[i],b[j],m)/<span class="hljs-built_in">mul</span>(b[j],b[j],m);<br><span class="hljs-keyword">for</span>(k=<span class="hljs-number">1</span>;k&lt;=m;k++)<br>b[i][k]-=tmp*b[j][k];<br>&#125;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br>&#123;<br><span class="hljs-type">double</span> l=<span class="hljs-built_in">len</span>(b[i],m);<br><span class="hljs-keyword">for</span>(j=<span class="hljs-number">1</span>;j&lt;=m;j++)<br>b[i][j]/=l;<br>&#125;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br>&#123;<br><span class="hljs-keyword">for</span>(j=<span class="hljs-number">1</span>;j&lt;=m;j++)<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%7.4lf &quot;</span>,b[i][j]);<br><span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">3 4</span><br><span class="hljs-comment">1 6 2 4</span><br><span class="hljs-comment">5 3 3 -5</span><br><span class="hljs-comment">6 3 2 -4</span><br><span class="hljs-comment"> 0.1325  0.7947  0.2649  0.5298</span><br><span class="hljs-comment"> 0.5934  0.2516  0.3290 -0.6902</span><br><span class="hljs-comment"> 0.6193  0.4630 -0.2389  0.5874</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><h2 id="4-æ ¼çš„åŸºæœ¬å®šä¹‰ä¸æ€§è´¨"><a href="#4-æ ¼çš„åŸºæœ¬å®šä¹‰ä¸æ€§è´¨" class="headerlink" title="4.æ ¼çš„åŸºæœ¬å®šä¹‰ä¸æ€§è´¨"></a>4.æ ¼çš„åŸºæœ¬å®šä¹‰ä¸æ€§è´¨</h2><p><strong>æ ¼çš„å®šä¹‰ï¼šè®¾å‘é‡$v_1,v_2,â€¦,v_n$æ˜¯ä¸€ç»„çº¿æ€§æ— å…³çš„å‘é‡ï¼Œé‚£ä¹ˆæ ¼å°±æ˜¯ç”±è¿™$n$ä¸ªå‘é‡çš„çº¿æ€§ç»„åˆé›†ï¼Œå†™æˆé€šè§£çš„å½¢å¼å°±æ˜¯</strong><br>$$<br>\vec w&#x3D;a_1\vec v_1+a_2\vec v_2+â€¦+a_n\vec v_n| a_i \in Z<br>$$<br>å…¶ä¸­ï¼Œ$v_1$åˆ°$v_n$ç§°ä½œæ ¼çš„åŸºåº•ï¼ŒåŸºåº•æ‰€åŒ…å«çš„å‘é‡æ•°æˆä¸ºæ ¼çš„ç»´åº¦ã€‚</p><p>å½“ç„¶ï¼Œä¸€ä¸ªæ ¼ä¸­çš„å‘é‡å¯ä»¥äº’ç›¸è½¬åŒ–ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°è½¬åŒ–çŸ©é˜µï¼Œå¯ä»¥æŠŠä¸€ä¸ªæ ¼ä¸­çš„åŸºåº•$V$è½¬åŒ–æˆå¦ä¸€ç»„åŸºåº•$W$ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è®¾ç½®çŸ©é˜µ$T$ï¼Œä½¿å¾—$W&#x3D;TV$ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰$V&#x3D;T^{-1}W$ã€‚</p><p>ä¸è¿‡è¿™é‡Œå°±æœ‰ä¸ªé—®é¢˜å‡ºç°äº†ï¼šç”±äºæˆ‘ä»¬è¦æ±‚æ‰€æœ‰çš„$a$å‡ä¸ºæ•´æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦ä¿è¯$T,T^{-1}$ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æ•´æ•°ã€‚è€Œæ»¡è¶³è¿™ç§æ¡ä»¶ä¸‹çš„$T$ï¼Œå¿…é¡»æ»¡è¶³$\det T&#x3D;Â±1$ã€‚</p><p>æ¯”å¦‚ï¼Œå‡è®¾æŸä¸ªä¸‰ç»´æ ¼çš„å‘é‡çš„åŸºåº•æ˜¯$\vec v_1&#x3D;(5,4,-1),\vec v_2&#x3D;(2,1,2),\vec v_3(3,4,-4)$ã€‚æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸€ä¸ª$\det T&#x3D;1$çš„çŸ©é˜µ$T$å°†å…¶åˆ‡æ¢æˆå¦ä¸€åŸºåº•,è¿ç”¨$W&#x3D;TV$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åŸºåº•å‘é‡ç»„$W$,ä¸$V$ç­‰ä»·ã€‚å…¶ä¸­$\vec w_1&#x3D;(-2,17,11),\vec w_2&#x3D;(7,11,14),\vec w_3&#x3D;(-13,5,-7)$ã€‚å…¶ä¸­ç³»æ•°çŸ©é˜µ$T$å‡ä¸ºæ•´æ•°ã€‚åŒç†ï¼Œ$V&#x3D;T^{-1}W$ä¸­ï¼Œç”±äº$\det T&#x3D;1$ï¼Œå› æ­¤$T,T^{-1}$ä¸­çš„æ¯ä¸ªæ•°å­—ä¹Ÿéƒ½æ˜¯æ•´æ•°ï¼Œç¬¦åˆæ ¼ä¸­å‘é‡çš„è¿ç®—æ ‡å‡†ã€‚</p><img src="/2021/02/03/LatticeNotes2/1.png" alt="1" style="zoom:80%;"><p>æ‰€ä»¥ï¼Œæ ¼ä¸­çš„ä¸€ç»„åŸºåº•åªéœ€è¦å†™æˆçŸ©é˜µçš„å½¢å¼ï¼Œå¹¶åœ¨å…¶å·¦è¾¹ä¹˜ä¸Šä¸€ä¸ªè¡Œåˆ—å¼ä¸º$Â±1$çš„çŸ©é˜µï¼Œå°±å¯ä»¥è·å¾—è¿™ä¸ªæ ¼çš„å¦ä¸€ç»„åŸºåº•ã€‚è€Œè¿™ç§çŸ©é˜µçš„é›†åˆåˆç§°ä¸ºçº¿æ€§ç¾¤ï¼Œç”¨$\text{GL}_n(Z)$è¡¨ç¤ºã€‚è¿™äº›çŸ©é˜µæ¯ä¸ªå…ƒç´ éƒ½æ˜¯æ•´æ•°ï¼Œå¹¶ä¸”å…¶é€†çŸ©é˜µçš„æ¯ä¸ªå…ƒç´ ä¹Ÿéƒ½æ˜¯æ•´æ•°ã€‚</p><p><strong>å¯¹æ ¼çš„å®šä¹‰2ï¼šå¦‚æœ$R^m$çš„å­é›†$L$åœ¨åŠ å‡æ³•ä¸‹æ˜¯å°é—­çš„ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä¸€ä¸ªåŠ æ€§çš„å­ç¾¤ã€‚å¦‚æœå­˜åœ¨ä¸€ä¸ªæ­£å¸¸æ•°$r$ï¼Œä½¿å¾—$L$ä¸­çš„ä»»æ„ä¸€ä¸ªå‘é‡$\vec v$å’Œ$R^m$ä¸­çš„ä»»æ„ä¸€ä¸ªå‘é‡$\vec w$ï¼Œéƒ½æœ‰$|\vec v - \vec w|&lt;r$æ’æˆç«‹ã€‚</strong></p><p>è¯´çš„é€šä¿—æ˜“æ‡‚ä¸€äº›ï¼Œå°±æ˜¯æˆ‘åœ¨$L$ä¸­å–ä»»æ„å‘é‡$\vec v$ï¼Œç„¶ååœ¨$\vec v$å‘¨å›´ç”»ä¸€ä¸ªåŠå¾„ä¸º$r$çš„å®å¿ƒçƒï¼ˆ$2D$å¹³é¢ä¸Šåˆ™æ˜¯ä¸€ä¸ªåœ†ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªçƒé‡Œé¢æ²¡æœ‰$L$çš„å…¶ä»–ç‚¹ã€‚</p><p>æ‰€ä»¥æ ¹æ®æˆ‘ä»¬åˆšæ‰çš„ç†è®ºï¼šæ ¼ä¸å‘é‡ç©ºé—´ç›¸ä¼¼ï¼Œåªä¸è¿‡å®ƒé‡Œé¢çš„æ‰€æœ‰çš„å‘é‡éƒ½æ˜¯ç”±å„ä¸ªåŸºåº•ä¸æ•´æ•°ç›¸ä¹˜å¾—æ¥çš„ï¼Œæ‰€ä»¥æ ¼ä¸€èˆ¬ç”¨ç‚¹é˜µè¡¨ç¤ºã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªæœ€ç®€å•çš„æ ¼å°±æ˜¯<br>$$<br>L:\text{ } \vec v&#x3D;(x,y)|x,y \in Z \text {}<br>$$<br>æ­¤æ—¶è¿™ä¸ªæ ¼å°±æœ‰ä¸€ç»„åŸºåº•ä¸º$\vec i &#x3D;(1,0)$å’Œ$\vec j&#x3D;(0,1)$ï¼Œå¯¹åº”çš„å°±æ˜¯äºŒç»´åæ ‡çº¸ä¸Šçš„æ‰€æœ‰çš„æ•´æ•°ç‚¹ã€‚</p><p><strong>åŸºæœ¬åŸŸFï¼š</strong>æŒ‡æ‰€æœ‰åŸºåº•å›´æˆçš„ç©ºé—´ï¼Œå†™æˆè¡¨è¾¾å¼å°±æ˜¯$F(\vec v_1,\vec v_2,â€¦,\vec v_n)&#x3D;a_1\vec v_1+a_2 \vec v_2 +â€¦+a_n \vec v_n$ã€‚å…¶ä¸­$\vec v$æ˜¯æ ¼ä¸­çš„åŸºåº•å‘é‡ï¼Œ$a \in [0,1)$</p><p>ä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬åˆšæ‰æåˆ°çš„æœ€ç®€å•çš„é‚£ä¸ªæ ¼ä¸­ï¼Œä»¥$(0,0),(1,0),(0,1),(1,1)$å››ä¸ªç‚¹å›´æˆçš„æ­£æ–¹å½¢å†…éƒ¨å°±æ˜¯ä¸€ä¸ªåŸºæœ¬åŸŸï¼Œå¦‚ä¸‹å›¾ä¸­çš„ç°è‰²éƒ¨åˆ†ã€‚</p><p>å¦‚æœæˆ‘ä»¬ä»ç„¶æ˜¯äºŒç»´çš„æ ¼$P$ï¼Œè‹¥è¯¥æ ¼$P$ä»¥$(1,2),(2,1)$ä¸ºåŸºåº•ï¼Œé‚£ä¹ˆåŸºæœ¬åŸŸæ˜¯ç”±$(0,0),(1,2),(2,1),(3,3)$å››ç‚¹æ‰€å›´æˆçš„å¹³è¡Œå››è¾¹å½¢ã€‚</p><p>å‡å¦‚$\vec t \in F,\vec v $æ˜¯æ ¼$L$çš„ä¸€ä¸ªåŸºåº•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å…¶ä»–çš„åŸŸ$F+\vec v$ï¼Œå…¶ä¸­$\vec t$åœ¨åŸŸ$F+\vec v$å¯¹åº”çš„å‘é‡æ˜¯$\vec t + \vec v$</p><p>å› æ­¤ï¼Œè¿™ä¸ªå¯ä»¥è¦†ç›–æ•´ä¸ª$R^n$ï¼Œå½“$n&#x3D;2$æ—¶ï¼Œæˆ‘ä»¬è¿˜ä»¥ä¸Šé¢é‚£ä¸ªæœ€ç®€å•çš„äºŒç»´æ ¼ä¸ºä¾‹ï¼Œå°±å¯ä»¥å¾—åˆ°åæ ‡çº¸ä¸Šå…¶ä»–çš„åŸŸã€‚æ¯”å¦‚$F+\vec i,F-\vec j,F+2\vec i +2 \vec j$</p><p>åœ¨åæ ‡çº¸ä¸Šï¼Œæˆ‘ä»¬æ ¹æ®æˆ‘ä»¬çš„å‘ç°ï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸ªå°æ­£æ–¹å½¢çš„é¢ç§¯éƒ½æ˜¯$1$ï¼Œæ‰©å±•åˆ°$n$ç»´ç©ºé—´ï¼Œæˆ‘ä»¬å¯ä»¥ç±»æ¯”ï¼šæ‰€æœ‰çš„åŸºæœ¬åŸŸçš„ä½“ç§¯éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œå› æ­¤ï¼ŒåŸºæœ¬åŸŸä½“ç§¯ä¸å˜æ˜¯æ ¼ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ€§è´¨ã€‚å¹¶ä¸”$F$çš„$n$ç»´ä½“ç§¯åˆè¢«æˆä¸º$L$çš„è¡Œåˆ—å¼ï¼Œè®°ä¸º$\det L$ã€‚ç»§ç»­ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œ$\det L &#x3D; 1,\det P &#x3D; 3$ã€‚å¹¶ä¸”è¿™é‡Œçš„$\det $å€¼ï¼Œ<strong>åˆšå¥½æ˜¯å¯¹åº”çš„å‘é‡å†™æˆçŸ©é˜µå½¢å¼åï¼ŒçŸ©é˜µè¡Œåˆ—å¼çš„å€¼çš„ç»å¯¹å€¼ã€‚</strong></p><img src="/2021/02/03/LatticeNotes2/2.png" alt="2" style="zoom:130%;"><p>å½“ç„¶ï¼Œè¿™è¾¹è¿˜æœ‰ä¸€ä¸ª<strong>æ¨è®ºï¼š</strong> $\det L &#x3D; \text{Vol } Fâ‰¤|\vec v_1||\vec v_2|â€¦|\vec v_n|$ï¼Œä¹Ÿå°±æ˜¯åŸºæœ¬åŸŸ$F$çš„é¢ç§¯å°äºç­‰äºæ‰€æœ‰åŸºåº•çš„é•¿åº¦ã€‚å¹¶ä¸”åŸºåº•è¶Šè¶‹è¿‘äºæ­£äº¤ï¼Œé‚£ä¹ˆä¸ç­‰å·ä¸¤è¾¹è¶Šé è¿‘ã€‚</p><h2 id="5-æ ¼ä¸­çš„çŸ­å‘é‡"><a href="#5-æ ¼ä¸­çš„çŸ­å‘é‡" class="headerlink" title="5.æ ¼ä¸­çš„çŸ­å‘é‡"></a>5.æ ¼ä¸­çš„çŸ­å‘é‡</h2><h3 id="5x01-ä¸¤ä¸ªé—®é¢˜ï¼š"><a href="#5x01-ä¸¤ä¸ªé—®é¢˜ï¼š" class="headerlink" title="5x01 ä¸¤ä¸ªé—®é¢˜ï¼š"></a>5x01 ä¸¤ä¸ªé—®é¢˜ï¼š</h3><p><strong>æœ€çŸ­å‘é‡é—®é¢˜SVP</strong>ï¼šåœ¨æ ¼$L$ä¸­å¯»æ‰¾ä¸€ä¸ªå‘é‡ï¼Œä½¿å®ƒçš„é•¿åº¦æœ€å°ã€‚</p><p><strong>æœ€æ¥è¿‘å‘é‡é—®é¢˜CVP</strong>ï¼šç»™å®šä¸€ä¸ª$R^m$ä¸­çš„å‘é‡$\vec w$ï¼Œè¦æ±‚åœ¨æ ¼ä¸­å¯»æ‰¾ä¸€ä¸ªå‘é‡$\vec v$ï¼Œä½¿å¾—$\vec w-\vec v$çš„é•¿åº¦æœ€å°ã€‚</p><p>å½“ç„¶ï¼ŒSVPé—®é¢˜å’ŒCVPé—®é¢˜éƒ½å¯èƒ½æœ‰å¤šä¸ªè§£ï¼Œç»§ç»­æ‹¿æˆ‘ä»¬åœ¨ç¬¬<strong>4</strong>èŠ‚ä¸­æ‰€è®²åˆ°çš„é‚£ä¸ªæœ€ç®€å•çš„æ ¼çš„ä¾‹å­ï¼Œæ ¼ä¸­çš„æœ€çŸ­å‘é‡æœ‰$4$ä¸ªï¼Œåˆ†åˆ«æ˜¯$(0,1),(1,0),(0,-1),(-1,0)$ã€‚ä¸$(0.5,0.5)$æœ€æ¥è¿‘çš„å‘é‡æœ‰$3$ä¸ªï¼Œåˆ†åˆ«æ˜¯$(0,1),(1,0),(1,1)$ã€‚è€Œåœ¨<strong>ç¬”è®°1</strong>ä¸­çš„2x04ï¼Œ2x05èŠ‚ï¼Œæˆ‘ä»¬å·²ç»æ¶‰åŠåˆ°äº†ç›¸å…³çš„é—®é¢˜ã€‚<del>åªä¸è¿‡æœªèƒ½è¯¦ç»†åœ°è®²è§£</del></p><p>è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œä¹Ÿå°†éšç€æ ¼ç»´åº¦çš„æå‡ï¼Œè®¡ç®—ä¹Ÿä¼šå˜å¾—è¶Šæ¥è¶Šå›°éš¾ã€‚ä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒCVPé—®é¢˜éš¾åº¦ç•¥é«˜äºSVPéš¾åº¦ï¼Œæ‰€ä»¥åœ¨ç»´åº¦æ›´é«˜çš„æƒ…å†µä¸‹ï¼ŒCVPé—®é¢˜å¯ä»¥è½¬åŒ–æˆSVPé—®é¢˜æ¥ç¼©çŸ­è§£å†³é—®é¢˜çš„æ—¶é—´ã€‚ä½†å®é™…ä¸Šï¼Œè¿™ä¸¤ä¸ªé—®é¢˜ä¹ŸåŸºæœ¬ä¸Šå¯ä»¥è¯´æ˜¯åœ¨æ—  Trapdoor Infomationçš„æƒ…å†µä¸‹æ˜¯æ— è§£çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å¯»æ‰¾ä¸€äº›å…·æœ‰ç‰¹æ®Šæ€§è´¨çš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨<strong>ç¬”è®°1</strong>ä¸­æåˆ°è¿‡çš„èƒŒåŒ…å¯†ç é—®é¢˜ã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¸¤ä¸ªé—®é¢˜è¿˜æœ‰å¾ˆå¤šå˜ä½“ï¼Œæ¯”å¦‚</p><p><strong>æœ€çŸ­åŸºåº•é—®é¢˜SBPï¼š</strong>åœ¨æ ¼$L$ä¸­å¯»æ‰¾$n$ä¸ªçº¿æ€§æ— å…³çš„å‘é‡ä½œä¸ºåŸºåº•ï¼Œä½¿å¾—è¿™äº›å‘é‡ä¸­æœ€é•¿çš„é‚£ä¸ªå‘é‡æˆ–è€…æ‰€æœ‰å‘é‡é•¿åº¦çš„å¹³æ–¹å’Œæœ€å°ï¼ˆè¿™ä¸ªé—®é¢˜æœ‰$2$ä¸ªç‰ˆæœ¬ï¼Œå› ä¸ºä¸åŒæƒ…å†µä¸‹çš„è¦æ±‚æ˜¯ä¸åŒçš„ï¼‰ã€‚</p><p><strong>è¿‘ä¼¼æœ€çŸ­å‘é‡é—®é¢˜apprSVPï¼š</strong>å‡è®¾$f(n)$æ˜¯$n$çš„å‡½æ•°ï¼Œé‚£ä¹ˆè¦æ±‚åœ¨ç»´æ•°ä¸º$n$çš„æ ¼å†…ï¼Œæ‰¾åˆ°ä¸€ä¸ªéé›¶å‘é‡ï¼Œä½¿å…¶é•¿åº¦ä¸è¶…è¿‡$f(n)$å€çš„æ•´ä¸ªæ ¼ä¸­çš„æœ€çŸ­éé›¶å‘é‡ã€‚</p><p>å½“ç„¶ï¼Œä¸åŒçš„$f(n)$ä¼šå¯¼è‡´é—®é¢˜çš„ä¸åŒï¼Œä¾‹å¦‚$f(n)&#x3D;3n$æˆ–è€…$f(n)&#x3D;5\ln^4 n$éƒ½ä¼šå¯¼è‡´é—®é¢˜çš„ä¸åŒã€‚ä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè‹¥$f(n)$æ˜¯å¤šé¡¹å¼ï¼Œæˆ–</p><p>è€…æ ¼çš„ä½æ•°è¾ƒä½ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®é¢˜æˆ–è®¸ä¼šæ›´å¥½è§£ä¸€ç‚¹ã€‚</p><p><strong>è¿‘ä¼¼æœ€æ¥è¿‘å‘é‡é—®é¢˜apprCVP</strong>ï¼šç±»æ¯”äºapprSVPé—®é¢˜ã€‚</p><h3 id="5x02-Hermiteâ€™s-theorem-and-Minkowskiâ€™s-theorem"><a href="#5x02-Hermiteâ€™s-theorem-and-Minkowskiâ€™s-theorem" class="headerlink" title="5x02  Hermiteâ€™s theorem and Minkowskiâ€™s theorem"></a>5x02  Hermiteâ€™s theorem and Minkowskiâ€™s theorem</h3><h4 id="52o01-Hermiteå®šç†"><a href="#52o01-Hermiteå®šç†" class="headerlink" title="52o01 Hermiteå®šç†"></a>52o01 Hermiteå®šç†</h4><p>æˆ‘ä»¬åœ¨<strong>5x01</strong>ä¸­æåˆ°çš„é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾—æƒ³ä¸€æƒ³äº†ï¼šæœ€çŸ­çš„ç©¶ç«Ÿæœ‰å¤šé•¿å‘¢ï¼Ÿä¸‹é¢è¯´ä¸€ä¸‹ç»“è®ºï¼šæ ¼ä¸­æœ€çŸ­å‘é‡çš„é•¿åº¦å–å†³äºæ ¼$L$çš„ç»´æ•°å’Œè¡Œåˆ—å¼$\det L$çš„å€¼ã€‚</p><p> <strong>(Hermiteå®šç†)</strong> ç»´æ•°$n$çš„æ¯ä¸€ä¸ªæ ¼$L$éƒ½åŒ…å«ä¸€ä¸ªé•¿åº¦ä¸è¶…è¿‡$\sqrt nÂ· \sqrt[n]{\det L}$çš„å‘é‡$\vec v$</p><p> <strong>(Hermiteå¸¸æ•°)</strong> åœ¨ç»™å®šç»´æ•°ä¸‹ï¼Œæ¯ä¸€ä¸ªæ ¼$L$çš„æœ€çŸ­éé›¶å‘é‡$\vec v$çš„é•¿åº¦çš„å¹³æ–¹éƒ½ä¸è¶…è¿‡$ y_n\sqrt[n]{\det^2 L} $ã€‚å…¶ä¸­$y_2$åˆ°$y_8$å’Œ$y_{24}$çš„å€¼æ˜¯ç›®å‰å·²çŸ¥çš„ã€‚è¿™äº›æ•°å­—åˆ†åˆ«æ˜¯$ \dfrac 4 3,2,4,8,\dfrac {64} 3,64,256,4 $ã€‚ä¸è¿‡$y_n \in [\dfrac {n}{2 \pi e},\dfrac{n}{\pi e}]$</p><p>æŠŠè¿™ä¸ªå®šç†æ‰©å±•ä¸€ä¸‹ï¼Œæœ‰è¿™æ ·çš„ç»“è®ºï¼šåœ¨ç»´æ•°ä¸º$n$çš„æ ¼$L$ä¸­ï¼Œå­˜åœ¨ä¸€ç»„åŸºåº•ï¼Œä½¿å¾—è¿™äº›åŸºåº•ä¸­æ¯ä¸ªå‘é‡çš„é•¿åº¦çš„ä¹˜ç§¯ä¸è¶…è¿‡$\sqrt{n^n}Â·\det L$ã€‚è¿™ä¸€æ˜¯å¯¹æˆ‘ä»¬ä¹‹å‰ç»“è®ºâ€$\det L$ä¸è¶…è¿‡æ‰€æœ‰å‘é‡é•¿åº¦çš„ä¹˜ç§¯â€è¿™ä¸€å®šç†çš„è¡¥å……ã€‚</p><p><strong>Hadamardæ¯”ç‡</strong>ï¼šå‡è®¾$\vec v_1,\vec v_2,â€¦,\vec v_n$æ˜¯æ ¼$L$çš„ä¸€åŸºåº•$B$ï¼Œé‚£ä¹ˆHadamardæ¯”ç‡$H(B)$è®¡ç®—å…¬å¼æ»¡è¶³$H(B)&#x3D;(\dfrac{\det L}{\prod_{i&#x3D;1}^n |\vec v_i|})^{1&#x2F;n}$ã€‚$H(B)$çš„å€¼æ€»æ˜¯åœ¨$(0,1]$ä¹‹é—´ï¼Œå¹¶ä¸”è¿™ä¸ªå€¼è¶Šæ¥è¿‘$1$ï¼Œå°±è¡¨ç¤ºè¿™ä¸€ç»„åŸºåº•ä¸­çš„å‘é‡è¶Šæ­£äº¤ã€‚</p><p><strong>å°é—­çƒï¼š</strong>åœ¨å‘é‡ç©ºé—´$R^n$ä¸­ï¼Œä»»ä½•ä¸å‘é‡$\vec a$è·ç¦»ä¸è¶…è¿‡$r$çš„ç©ºé—´çš„é›†åˆï¼Œç§°ä½œå‘é‡$\vec a$çš„å°é—­çƒï¼Œè®°ä¸º$B_r(\vec a)$ï¼Œè¡¨è¾¾å¼ä¸º$(x_1-a_1)^2+(x_2-a_2)^2+â€¦+(x_n-a_n)^2 â‰¤ r^2$ã€‚å…¶ä¸­$x_1$åˆ°$x_n$æ˜¯åæ ‡åˆ†é‡ï¼Œ$a_1$åˆ°$a_n$æ—¶å‘é‡$\vec a$çš„åˆ†é‡ã€‚</p><p> <strong>4ä¸ªå®šä¹‰</strong>ï¼šå½“$S$æ˜¯å‘é‡ç©ºé—´$R^n$çš„ä¸€ä¸ªå­é›†æ—¶ï¼Œæˆ‘ä»¬æœ‰å¦‚ä¸‹å®šä¹‰ï¼š</p><p><strong>Update 7.29 ä¿®æ”¹äº†2æœˆä»½çš„é€»è¾‘é”™è¯¯è¡¨è¿°</strong></p><p>å¦‚æœå­˜åœ¨ä¸€ä¸ªå®æ•°$r$ ä½¿å¾—$S$ä¸­æ‰€æœ‰çš„å‘é‡éƒ½åŒ…å«åœ¨å°é—­çƒ$B_r(\vec 0)$ä¸­ã€‚åœ¨äºŒç»´å¹³é¢ä¸Šå°±æ˜¯åŒ…å«åœ¨åœ†$x^2+y^2&#x3D;r^2$å†…ã€‚é‚£ä¹ˆç§°$S$ä¸­å‘é‡çš„é•¿åº¦æ˜¯<strong>æœ‰ç•Œçš„</strong>ï¼Œ</p><p>è‹¥$\vec a$åœ¨$S$ä¸­ï¼Œ$-\vec a$ä¹Ÿåœ¨$S$ä¸­ï¼Œå¹¶ä¸”$\vec a +(- \vec a)&#x3D; \vec 0$ï¼Œé‚£ä¹ˆç§°$S$ä¸­å‘é‡æ—¶<strong>å¯¹ç§°çš„</strong>ï¼Œ</p><p>å¦‚æœ$S$ä¸­æœ‰ä»»æ„ä¸¤ç‚¹$A,B$åˆ™çº¿æ®µ$AB$ä¸Šçš„æ¯ä¸€ä¸ªç‚¹éƒ½åœ¨$S$ä¸­ï¼Œé‚£ä¹ˆç§°$S$æ˜¯<strong>å‡¸æ€§çš„</strong>ï¼Œ</p><p>å¦‚æœå¯¹äº$S$ä¸­çš„ä¸€ç‚¹$A$ï¼Œä»»æ„å–å€¼$r&gt;0$ï¼Œ$B_r(\vec {OA})$ä¸­éƒ½æœ‰å±äº$S$çš„ç‚¹ï¼Œåˆ™ç‚¹$A$ä¹Ÿåœ¨$S$ä¸­ï¼Œé‚£ä¹ˆç§°æ˜¯<strong>å°é—­çš„</strong>ï¼Œ</p><h4 id="52o02-Minkowskiå®šç†"><a href="#52o02-Minkowskiå®šç†" class="headerlink" title="52o02   Minkowskiå®šç†"></a>52o02   Minkowskiå®šç†</h4><p><strong>ï¼ˆMinkowskiå®šç†ï¼‰</strong>ï¼šè®¾$L$æ˜¯$R^n$ä¸­çš„ä¸€ä¸ªæ ¼ï¼Œ$S$æ˜¯$R^n$ä¸­çš„ä¸€ä¸ªå¯¹ç§°å‡¸é›†ï¼Œé‚£ä¹ˆ$S$çš„ä½“ç§¯$\text{Vol }S&gt; 2^n \det L$æ—¶ï¼Œ$S$ä¸­å°±åŒ…å«ä¸€ä¸ªéé›¶æ ¼å‘é‡ã€‚å¦‚æœ$S$æ˜¯å°é—­çš„ï¼Œé‚£ä¹ˆä¸Šé¢çš„ä¸ç­‰å¼ä¹Ÿå¯ä»¥å–ç­‰å·ã€‚</p><h3 id="5x03-é«˜æ–¯å¯å‘å¼"><a href="#5x03-é«˜æ–¯å¯å‘å¼" class="headerlink" title="5x03 é«˜æ–¯å¯å‘å¼"></a>5x03 é«˜æ–¯å¯å‘å¼</h3><h4 id="53o01-ä¼½é©¬å‡½æ•°"><a href="#53o01-ä¼½é©¬å‡½æ•°" class="headerlink" title="53o01 ä¼½é©¬å‡½æ•°"></a>53o01 ä¼½é©¬å‡½æ•°</h4><p> ä¼½é©¬å‡½æ•°çš„å®šä¹‰åŸŸæ˜¯$s&gt;0$ï¼Œè¡¨è¾¾å¼å¦‚ä¸‹</p><p><img src="/2021/02/03/LatticeNotes2/3.png" alt="3"></p><p>è¿™ä¸ªå‡½æ•°å…·æœ‰ä¸€äº›å¾ˆé‡è¦çš„æ€§è´¨ï¼š</p><p>$\Gamma (1)&#x3D;1,\Gamma(s+1)&#x3D;s\Gamma(s)$ã€‚å› æ­¤ï¼Œå½“$s \in N_+$æ—¶ï¼Œ$\Gamma(s)&#x3D;s!$</p><p>$\Gamma(\frac 1 2) &#x3D; \sqrt \pi$</p><p>æ–¯ç‰¹æ—å…¬å¼ï¼š$\lim _{s \to âˆ} \Gamma(1+s)^{\frac1 s} &#x3D;\dfrac s e$ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œåº”è¯¥æ˜¯<br>$$<br> \lim _{s\toâˆ}\ln \Gamma (1+s)&#x3D; \ln^s (\dfrac s e)+\dfrac 1 2 \ln (2 \pi s)+O(1)<br>$$</p><p>è€Œè¿™ä¸ªä¼½é©¬å…¬å¼ï¼Œåœ¨è®¡ç®—$n$ç»´çƒä½“çš„ä½“ç§¯ä¸­ä¹Ÿå°±ç”¨åˆ°äº†ï¼š<br>$$<br>\text{Vol}(B_r(\vec a))&#x3D;\dfrac{\pi^{\frac n 2}r^n}{\Gamma(1+\frac n 2)}<br>$$<br>å½“$n$è¾ƒå¤§çš„æ—¶å€™ï¼Œè¿™ä¸ª$n$ç»´çƒä½“çš„ä½“ç§¯ä½“ç§¯ä¹Ÿè¿‘ä¼¼äº<br>$$<br>\text{Vol}(B_r(\vec a))^{\frac 1 n} â‰ˆr\sqrt{\dfrac{2\pi e}{n}}<br>$$<br>åˆå› ä¸º$\text{Vol}(B_r(\vec 0))â‰¥2^n \det L$æ—¶ï¼Œ$B_r(0)$é‡Œé¢æœ‰é$0$æ ¼ç‚¹ã€‚å› æ­¤ï¼Œå½“$n$è¾ƒå¤§çš„æ—¶å€™ï¼Œçƒçš„åŠå¾„çš„é€‰å–åº”è¯¥æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š<br>$$<br>r\sqrt{\dfrac{2\pi e}n}-2(\det L)^{\frac1n}&#x3D; 0^+<br>$$<br>å› æ­¤ï¼Œå½“$n$å¾ˆå¤§çš„æ—¶å€™ï¼Œ$L$ä¸­ä¹Ÿå­˜åœ¨ä¸€ä¸ªéé›¶å‘é‡$\vec v$ï¼Œæ»¡è¶³<br>$$<br>|\vec v|-\sqrt{\dfrac{2n}{\pi e}}&#x3D;0^-<br>$$<br>å…¶ä¸­ï¼Œæœ‰$\sqrt{\dfrac{2}{\pi e}}&#x3D;0.484$</p><p>è™½ç„¶åœ¨ç»´æ•°å¾ˆå¤§çš„æ—¶å€™ï¼Œæœ€æ®µå‘é‡çš„é•¿åº¦æ˜¯æœªçŸ¥çš„ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ä½¿ç”¨æ¦‚ç‡å‚æ•°æ¥ä¼°è®¡å®ƒçš„å¤§å°ï¼š</p><p>åœ¨$r$å¾ˆå¤§çš„æ—¶å€™ï¼Œ$\text{Vol }{B_r(\vec 0)}$é™¤ä»¥åŸºæœ¬åŸŸ$F$çš„ä½“ç§¯$\text{Vol }F$ è¿‘ä¼¼ç­‰äº$B_r(\vec 0)$ä¸­çš„æ ¼ç‚¹æ•°ã€‚</p><p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œ$x^2+y^2&#x3D;r^2$ä¸­çš„æ•´ç‚¹æ•°é‡çº¦ç­‰äº$\pi r^2$ï¼Œä¹Ÿå°±æ˜¯å…ƒçš„é¢ç§¯é™¤ä»¥å°æ­£æ–¹å½¢çš„é¢ç§¯$1$ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¾ˆå¤šæƒ…å†µä¸‹ï¼Œéƒ½æ˜¯æƒ³æ‰¾åˆ°ä¸€ä¸ªå°½å¯èƒ½å°çš„$r$å€¼ï¼Œä½¿å¾—çƒ$B_r(\vec 0)$ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ ¼ç‚¹ã€‚ï¼Œè¿™å°±æœ‰äº†æˆ‘ä»¬ä¸Šé¢çš„ä¼°è®¡è¡¨è¾¾å¼ï¼Œç§»é¡¹ï¼Œå°±æœ‰äº†<br>$$<br>râ‰ˆ\sqrt{\dfrac{n}{2\pi e}}Â·\sqrt[n]{\det L}&#x3D;\sigma (L)<br>$$<br>è¿™å°±æ˜¯æˆ‘ä»¬å¾—åˆ°çš„å¯å‘å¼ï¼Œç”¨$\sigma(L)$è¡¨ç¤ºã€‚</p><p>æ›´å‡†ç¡®åœ°è¯´ï¼Œå¯¹äºä¸€ä¸ª$c&#x3D;0^+$çš„å›ºå®šå¸¸æ•°ï¼Œé‚£ä¹ˆå¯¹äºä¸€åˆ‡ç»´æ•°ä¸º$n$çš„æ ¼$L$,éƒ½æœ‰<br>$$<br>|\vec v_{\text{shortest}}| \in[ \text{  }(1-c)\sigma(L),(1+c)\sigma(L) \text{  }]<br>$$<br>å½“$n$çš„æ•°å­—è¾ƒå°æ—¶ï¼Œå¯¹äº$B_r(\vec 0)$çš„ä½“ç§¯ï¼Œä¼°è®¡å¼ä¸º<br>$$<br>\sigma(L)&#x3D;\dfrac{(Î“((1+\frac{n}{2})Â·\det L))^\frac1n}{\sqrt \pi}<br>$$<br>é€šè¿‡SVPé—®é¢˜æ¥ç±»æ¯”CVPé—®é¢˜ï¼Œå¯ä»¥æ¨å‡ºï¼š$\sigma (L)$çš„å€¼ä¹Ÿæ˜¯$|\vec w - \vec v|$æœ€å°å€¼çš„æœŸæœ›å€¼ã€‚</p><p>å°±åƒSVPä¸€æ ·ï¼Œå¦‚æœ$L$åŒ…å«ä¸€ä¸ªæ¯”$Ïƒ(L)$æ›´æ¥è¿‘$\vec w$çš„ç‚¹ï¼Œé‚£ä¹ˆæ™¶æ ¼çº¦ç®€ç®—æ³•å°±æ›´å®¹æ˜“æ±‚è§£CVPã€‚</p><h2 id="99-æ³¨"><a href="#99-æ³¨" class="headerlink" title="99.æ³¨"></a>99.æ³¨</h2><p>ç”±äºå‘é‡å¯ä»¥ç”¨åæ ‡è¡¨ç¤ºï¼Œå› æ­¤æ­¤åšå®¢ä¸­ï¼Œå‘é‡è¡¨ç¤ºçš„ä¹Ÿå¯ä»¥è§†ä¸ºæŸä¸ªåæ ‡ï¼Œæ¯”å¦‚åšå®¢ä¸­æœ€åä¸€å¥è¯ä¸­çš„$\vec w$å°±æ˜¯ç”¨å‘é‡çš„æ–¹æ³•æ¥è¡¨ç¤ºæŸä¸ªç‚¹çš„åæ ‡ã€‚ </p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LatticeNotes1</title>
    <link href="/2021/02/01/LatticeNotes1/"/>
    <url>/2021/02/01/LatticeNotes1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°1"><a href="#huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°1" class="headerlink" title="huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°1"></a>huangx607087å­¦ä¹ æ ¼å¯†ç çš„ç¬”è®°1</h1><h2 id="0-About"><a href="#0-About" class="headerlink" title="0.About"></a>0.About</h2><p>æ ¡å†…åŒçº§æŸäººæ—©å°±å¯¹è¿™ä¸€æ–¹æ³•æœ‰è¿‡è¾ƒä¸ºæ·±å…¥çš„äº†è§£ï¼Œè€Œè¿›å…¥äº†2æœˆæ‰åˆšåˆšå¼€å§‹å­¦ä¹ ï¼Œä¸€ä¸‹å­å°±æ¯”åˆ«äººæ…¢äº†åŠä¸ªæœˆï¼Œæˆ–è®¸è‡ªå·±å°±ç®—4æœˆè¿›äº†æ ¡é˜Ÿï¼Œä¹Ÿæ— æ³•è·Ÿé‚£å®¶ä¼™æ‹¼å§ï¼ˆï¼Œ<del>ç®—äº†ï¼Œè¿˜æ˜¯å…ˆä¿ä½è‡ªå·±ç›®å‰4.24çš„GPAå§ã€‚</del></p><h2 id="1-å¼•å…¥å†…å®¹ï¼ˆKnown-Unknownï¼‰"><a href="#1-å¼•å…¥å†…å®¹ï¼ˆKnown-Unknownï¼‰" class="headerlink" title="1.å¼•å…¥å†…å®¹ï¼ˆKnown -&gt; Unknownï¼‰"></a>1.å¼•å…¥å†…å®¹ï¼ˆKnown -&gt; Unknownï¼‰</h2><h3 id="1x01-ç®€ä»‹"><a href="#1x01-ç®€ä»‹" class="headerlink" title="1x01 ç®€ä»‹"></a>1x01 ç®€ä»‹</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå…¬é’¥å¯†ç å­¦çš„å®‰å…¨æ€§ï¼Œå¾€å¾€å»ºç«‹åœ¨æ•°å­¦é—®é¢˜çš„å›°éš¾æ€§ä¸Šã€‚å¦‚ RSA åŸºäºå¤§æ•°åˆ†è§£çš„å›°éš¾æ€§ï¼ŒDH å’Œ Elgamal ä»¥åŠ ECCï¼Œæ˜¯åŸºäºæœ‰é™åŸŸä¸Šæ±‚ç¦»æ•£å¯¹æ•°çš„å›°éš¾æ€§ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥è¦è€ƒè™‘ä¸€ç±»æ–°çš„éš¾é¢˜ï¼Œå®ƒä»¬æ”¯æ’‘äº†æ ¼ï¼ˆlatticeï¼‰å¯†ç å­¦ã€‚</p><p>å¯¹æ¯”èµ·ä¹‹å‰çš„å…¬é’¥å¯†ç å­¦ä½“ç³»ï¼Œæ ¼å¯†ç æä¾›äº†è®¸å¤šä¼˜åŠ¿ï¼šé¦–å…ˆï¼Œ<strong>åŠ å¯†ã€è§£å¯†é€Ÿåº¦å¯ä»¥æ›´å¿«</strong>ï¼ˆRSA æ…¢å¾—éš¾ä»¥å¿å—ï¼‰ï¼›<strong>å¯ä»¥æŠµæŠ—é‡å­æ”»å‡»</strong>ã€‚ç›®å‰æ¥çœ‹ï¼Œæš‚ä¸”æ²¡æœ‰é‡å­ç®—æ³•å¯ä»¥é«˜æ•ˆè§£å†³ lattice éš¾é¢˜ã€‚</p><p>åœ¨è°ˆåˆ°æ ¼ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¿›è¡Œä¸€äº›å¼•å…¥å·¥ä½œï¼š</p><p>çº¿æ€§ä»£æ•°ä¸­è®²è¿‡ï¼Œåœ¨å®æ•°é›†$R$ä¸Šæœ‰å‘é‡ç©ºé—´$V$,å…¶ä¸­å‘é‡ç©ºé—´$V$æ˜¯ä¸€éƒ¨åˆ†å‘é‡çš„é›†åˆï¼Œå¹¶ä¸”ä»»æ„ä¸¤ä¸ªå‘é‡ç›¸åŠ ï¼Œæˆ–è€…æ˜¯æŸä¸ªå‘é‡çš„æ•°ä¹˜ï¼Œåœ¨$V$ä¸­ä»ç„¶æœ‰æ„ä¹‰ã€‚æ¯”å¦‚ï¼Œå‡å®š$\vec{a},\vec{b} \in V$ï¼Œåˆ™$\vec{a}+\vec{b},2\vec{a}$ä»ç„¶åœ¨å‘é‡ç©ºé—´$V$å†…ã€‚</p><p>è€Œæ ¼å®é™…ä¸Šå°±ä¸å‘é‡ç©ºé—´ç›¸ä¼¼ï¼Œä¸è¿‡å¯¹äºæ ¼ä¸­çš„å‘é‡çš„æ•°ä¹˜ï¼Œæˆ‘ä»¬ä»…é™äºä¹˜ä¸Šæ•´æ•°ã€‚</p><h3 id="1x02-å¼•ä¾‹â€”â€”ä¸€ä¸ªæ–°çš„å¯†ç ç³»ç»Ÿ"><a href="#1x02-å¼•ä¾‹â€”â€”ä¸€ä¸ªæ–°çš„å¯†ç ç³»ç»Ÿ" class="headerlink" title="1x02 å¼•ä¾‹â€”â€”ä¸€ä¸ªæ–°çš„å¯†ç ç³»ç»Ÿ"></a>1x02 å¼•ä¾‹â€”â€”ä¸€ä¸ªæ–°çš„å¯†ç ç³»ç»Ÿ</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªå¾ˆç®€å•çš„é—®é¢˜ï¼Œè€Œè¿™ä¸ªé—®é¢˜ä¹Ÿå¼€å§‹ä¸ä¸€ä¸ªç»´åº¦ä¸º$2$çš„æ ¼æœ‰æ‰€è”ç³»äº†ã€‚ä¸è¿‡ç”±äºç»´åº¦å¾ˆä½ï¼Œå®ƒçš„å®‰å…¨æ€§å¾ˆå¼±ï¼Œä½†å®ƒå¯ä»¥ä½œä¸ºä¸€ä¸ªå¾ˆæ°å½“çš„å¼•ä¾‹ï¼Œå› ä¸ºå®ƒå¯ä»¥è¯´æ˜å¦‚ä½•åœ¨å¯†ç åˆ†æä¸­å‡ºç°æ™¶æ ¼ï¼Œå³ä½¿æ½œåœ¨çš„ç¡¬é—®é¢˜ä¼¼ä¹ä¸æ™¶æ ¼æ— å…³ã€‚ æ­¤å¤–ï¼Œå®ƒè¿˜æä¾›äº†NTRUå…¬é’¥å¯†ç ç³»ç»Ÿçš„æœ€ä½ç»´ä»‹ç»ã€‚</p><p>åŠ å¯†å¼€å§‹ï¼ŒAliceå…ˆé€‰æ‹©ä¸€ä¸ªå¤§çš„æ­£æ•´æ•°$q$ï¼ˆä¸ä¸€å®šæ˜¯ç´ æ•°ï¼‰ä¸ºä¸€ä¸ªå…¬å…±å‚æ•°ä½œä¸ºå…¬é’¥ï¼Œå¹¶é€‰æ‹©ä¸¤ä¸ªç§˜å¯†çš„æ­£æ•´æ•°$f,g$ä½œä¸ºç§é’¥ï¼Œå…¶ä¸­$f&lt;\sqrt{\dfrac{q}{2}},\sqrt{\dfrac{q}{4}}&lt;g&lt;\sqrt{\dfrac{q}{2}}$ä¸”$\gcd(f,q)&#x3D;1$ã€‚</p><p>â€‹ç„¶åï¼ŒAliceå¯ä»¥è®¡ç®—$h\equiv f^{-1}g\pmod q$ã€‚æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°$f,g$éƒ½å°äº$\sqrt q$ï¼Œä¹Ÿå°±æ˜¯è¯´$f,g$çš„æ•°é‡çº§æ˜¯$O(\sqrt q)$çš„çº§åˆ«ã€‚è€Œ$h$çš„èŒƒå›´åˆ™æ˜¯$O(q)$ï¼Œåœ¨$q$å¾ˆå¤§çš„æ—¶å€™ï¼ˆæ¯”å¦‚$q&gt;2^{256}$ï¼‰æ—¶ï¼Œ$h$å¯ä»¥è¯´æ˜¯è¿œå¤§äº$f,g$çš„ã€‚è¿™ä¸ª$h$ä¹Ÿå°†ä½œä¸ºå…¬é’¥ã€‚éšåï¼ŒAliceå°†å…¬é’¥$q,h$å…¬å¼€ã€‚</p><p>ä½œä¸ºä¿¡æ¯å‘é€æ–¹ï¼ŒBobå¯¹ä¿¡æ¯åŠ å¯†çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°$2$ä¸ªå‚æ•°ï¼šæ˜æ–‡$m$å’Œä¸€ä¸ªéšæœºæ•°$r$ï¼Œå…¶ä¸­$m&lt;\sqrt{\dfrac{q}{4}},r&lt;\sqrt{\dfrac{q}{2}}$ã€‚ç„¶åä»–å°±å¯ä»¥è®¡ç®—å¯†æ–‡$c\equiv rh+m \pmod q$ã€‚</p><p>è€Œæ”¶åˆ°å¯†æ–‡åï¼ŒAliceçš„è§£å¯†è¿‡ç¨‹å¦‚ä¸‹ï¼šé¦–å…ˆï¼Œä»–è®¡ç®—$a\equiv fc \pmod q$å’Œ$b\equiv ad \pmod g$ï¼Œå…¶ä¸­$d$æ˜¯$f$åœ¨æ¨¡$g$æ„ä¹‰ä¸‹çš„é€†å…ƒã€‚è€Œç¥å¥‡çš„æ˜¯ï¼Œå¯¹äº$a&#x3D; fc&#x3D;frh+fm&#x3D;frf^{-1}g+fm&#x3D;rg+fm$ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$b&#x3D;ad&#x3D;drg+dfm\equiv dfm \pmod g$ã€‚åˆå› ä¸º$df\equiv 1 \pmod g$ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€åç®—å‡ºæ¥çš„$b&#x3D;m$å°±æˆç«‹äº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨Pythonçš„ä»£ç å°è¯•ä¸€ä¸‹æ•´ä¸ªåŠ å¯†å’Œè§£å¯†çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬ä»¥  $q&#x3D;1000170007,f&#x3D;19653,g&#x3D;18557$ä¸ºä¸€ç»„æµ‹è¯•æ•°æ®è¯•è¯•çœ‹</p><p>é¦–å…ˆï¼Œå‡†å¤‡é˜¶æ®µè®¡ç®—$h\equiv f^{-1}g\pmod q&#x3D;999304853$,è¿™ä¸ªæ•°å­—è¾¾åˆ°äº†$O(q)$çš„çº§åˆ«,å¯¹å¤–å…¬å¸ƒ$q,h$</p><p>åŠ å¯†æ–¹è®¾ç½®æ˜æ–‡ä¸º$m&#x3D;12345$ï¼Œé€‰å–éšæœºæ•°ä¸º$r&#x3D;20932$ï¼Œè®¡ç®—$c\equiv rh+m&#x3D;893838950$ã€‚</p><p>è§£å¯†æ–¹æ”¶åˆ°$c$ä¹‹åï¼Œè®¡ç®—$a\equiv fc \pmod q&#x3D;631051409$ã€‚ç„¶åè®¡ç®—$d\equiv f^{-1}\pmod g&#x3D;10887$ã€‚</p><p>æœ€åè®¡ç®—$b&#x3D;da&#x3D;10887Ã—631051409&#x3D;6870256689783\equiv 12345 \pmod g$ï¼Œæœ€ç»ˆè·å¾—äº†æ˜æ–‡ä¸º$12345$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-comment">#PREPARE</span><br>q=<span class="hljs-number">1000170007</span> <span class="hljs-comment">#sqrt(q/4),sqrt(q/2)=15812,22362</span><br>f,g=<span class="hljs-number">19653</span>,<span class="hljs-number">18557</span><br><span class="hljs-keyword">assert</span> GCD(q,f)==<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> GCD(f,g)==<span class="hljs-number">1</span><br>h=g*inverse(f,q)%q<br><span class="hljs-built_in">print</span>(q,h)<br><span class="hljs-comment">#ENCRYPT</span><br>m,r=<span class="hljs-number">12345</span>,bytes_to_long(urandom(<span class="hljs-number">80</span>))%(iroot(q//<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]-<span class="hljs-number">10</span>)<br>c=(r*h+m)%q<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-comment">#DECRYPT</span><br>a=f*c%q<br>d=inverse(f,g)<br>b=a*d%g<br><span class="hljs-built_in">print</span>(b)<br><span class="hljs-comment">#1000170007 999304853</span><br><span class="hljs-comment">#893838950</span><br><span class="hljs-comment">#12345</span><br></code></pre></td></tr></table></figure><h3 id="1x03-å¯¹1x02ä¸­å¯†ç ç³»ç»Ÿçš„æ”»å‡»"><a href="#1x03-å¯¹1x02ä¸­å¯†ç ç³»ç»Ÿçš„æ”»å‡»" class="headerlink" title="1x03 å¯¹1x02ä¸­å¯†ç ç³»ç»Ÿçš„æ”»å‡»"></a>1x03 å¯¹1x02ä¸­å¯†ç ç³»ç»Ÿçš„æ”»å‡»</h3><p>å¾ˆæ˜¾ç„¶ï¼Œç”±äº$f,g$çš„æ•°é‡çº§å‡ä¸º$O(\sqrt q)$ï¼Œå› æ­¤æš´åŠ›æšä¸¾çš„çš„å¤æ‚åº¦æ˜¯$O(q)$ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥æ¢ä¸€ç§æ€è·¯æ¥åˆ†æè¿™ä¸ªé—®é¢˜ï¼šæ”»å‡»è€…çš„ä»»åŠ¡å°±æ˜¯æ‰¾åˆ°ä¸€ç»„æ•°é‡çº§$O(\sqrt q)$çš„æ•°å­—$F,G$æ»¡è¶³$Fh\equiv G\pmod q$ã€‚è¿™ä¸ªæ—¶å€™$(F,G)$å°±å¾ˆå¯èƒ½ä¼šå……å½“è§£å¯†å¯†é’¥ã€‚å°†åˆšæ‰çš„åŒä½™å¼å†™æˆæ–¹ç¨‹çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯$Fh&#x3D;G+Kq$ã€‚ä¹Ÿå°±æ˜¯$Fh-Kq&#x3D;G$ã€‚æ ¹æ®çº¿æ€§ä»£æ•°çš„ç›¸å…³çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºè¿™æ ·çš„å¼å­ï¼š$F(1,h)-K(0,q)&#x3D;(F,G)$ã€‚ä¹Ÿå°±æ˜¯å†™æˆäº†å‘é‡åŠ å‡çš„å½¢å¼ã€‚å…¶ä¸­$\vec a&#x3D;(1,h),\vec b&#x3D;(0,q),\vec d&#x3D;(F,G)$ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„å»ºä¸€ä¸ªäºŒç»´çš„æ ¼$L&#x3D;{ A\vec a+B \vec b| A,B\in Z}$ã€‚ç„¶ååœ¨$L$ä¸­å¯»æ‰¾å‘é‡å³å¯ã€‚è€Œè¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯éå¸¸ç®€å•çš„ï¼Œæ•…ä¸Šé¢è¿™ä¸ªå¯†ç ä½“ç³»å¾ˆå®¹æ˜“å°±èƒ½è¢«æ”»ç ´äº†ã€‚</p><h2 id="2-å­é›†é—®é¢˜å’ŒèƒŒåŒ…å¯†ç ç³»ç»Ÿ"><a href="#2-å­é›†é—®é¢˜å’ŒèƒŒåŒ…å¯†ç ç³»ç»Ÿ" class="headerlink" title="2.å­é›†é—®é¢˜å’ŒèƒŒåŒ…å¯†ç ç³»ç»Ÿ"></a>2.å­é›†é—®é¢˜å’ŒèƒŒåŒ…å¯†ç ç³»ç»Ÿ</h2><h3 id="2x01-å¼•å…¥"><a href="#2x01-å¼•å…¥" class="headerlink" title="2x01 å¼•å…¥"></a>2x01 å¼•å…¥</h3><p>ä½œä¸ºä¸€ä¸ªæ—©å·²é€€å½¹OIer$\text{(NOIP 2018 245pts)}$ï¼Œå¯¹äº$0,1$èƒŒåŒ…é—®é¢˜æ˜¯éå¸¸ç†Ÿæ‚‰çš„ã€‚ä¸è¿‡è¿™é‡Œçš„ä¸€ä¸ªèƒŒåŒ…å¯†ç ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥ç±»æ¯”æˆ‘ä»¥å‰çš„ç›¸å…³çŸ¥è¯†ï¼š</p><p>ç»™ä½ ä¸€ä¸ªæ•°é›†$M&#x3D;{a_1,a_2,a_3,\dots,a_n}$å’Œä¸€ä¸ªæ•´æ•°$b$ï¼Œåœ¨é›†åˆä¸­$M$é€‰å–ä¸€ä¸ªéç©ºå­é›†$M_0$ï¼Œä½¿å¾—$(\sum _{i \in M_0} i)&#x3D;b$ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚$M&#x3D;{4,5,12,15,17},b&#x3D;24$ã€‚å¾ˆæ˜¾ç„¶æˆ‘ä»¬å¯ä»¥é€‰å–$M$çš„å­é›†$M_0&#x3D;{4,5,15}$ï¼Œè¿™æ ·$M_0$ä¸­æ‰€æœ‰å…ƒç´ ä¹‹å’Œå°±ç­‰äº$24$äº†ã€‚å¹¶ä¸”è¿™æ˜¯ä¸€ä¸ªå”¯ä¸€çš„é€‰æ³•ã€‚å½“ç„¶ï¼Œå¦‚æœå½“æˆ‘ä»¬æŠŠéœ€æ±‚ä»$24$æ”¹æˆäº†$32$é‚£ä¹ˆ$M_0&#x3D;{5,12,15}$ï¼Œä¹Ÿå¯ä»¥é€‰å–$M_0&#x3D;{15,17}$ã€‚è¿™æ ·å°±æœ‰ä¸¤ç§é€‰æ³•äº†ã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¸ªå­é›†é—®é¢˜ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨çº¿æ€§ä»£æ•°çš„æ–¹æ³•æ¥è§£å†³ã€‚æˆ‘ä»¬åªéœ€è¦æ„é€ ä¸€ä¸ªæ–¹ç¨‹$\sum _{i&#x3D;1}^n a_ix_i&#x3D;b$å³å¯ï¼Œå…¶ä¸­$x_i\in{0,1}$ã€‚å¦‚æœåœ¨å·²çŸ¥$M$å’Œ$b$çš„æƒ…å†µï¼Œè¿™ä¸ªç®—æ³•çš„å¤æ‚åº¦æ˜¯$O(2^n)$ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥è®¾å‘é‡$\vec X&#x3D;(x_1,x_2,\dots,x_n)$ï¼Œ$\vec X$æ˜¯ä¸€ä¸ª$n$ç»´å‘é‡ï¼Œæ¯ä¸ªåˆ†é‡å–å€¼ä¸º$0$æˆ–è€…$1$ã€‚å½“ç„¶ï¼Œæœ‰ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥å°†æŒ‡æ•°å‡åŠï¼Œè¿™æ ·ç®—æ³•å¤æ‚åº¦å°±å˜æˆäº†$1.4143^n$</p><p>å…·ä½“åšæ³•å¦‚ä¸‹ï¼š</p><p>é¦–å…ˆï¼Œå‡è®¾$M$é›†åˆä¸­çš„æ•°æ˜¯ä¸€ä¸ªé€’å¢åºåˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªé›†åˆåˆ‡æˆä¸¤åŠï¼Œç„¶åæšä¸¾æ‰€æœ‰çš„é›†åˆ$I$ä¸ºé›†åˆ${a_1,a_2,â€¦,a_{n&#x2F;2}}$çš„å­é›†ï¼Œå’Œæšä¸¾æ‰€æœ‰çš„$J$ä¸ºé›†åˆ${a_{n&#x2F;2+1},a_{n&#x2F;2+2},â€¦,a_n}$çš„å­é›†ã€‚å¹¶åˆ†åˆ«åˆ—å‡ºåˆ—è¡¨$A,B$åˆ†åˆ«å¯¹åº”æ‰€æœ‰$I$çš„å…ƒç´ ä¹‹å’Œå’Œæ‰€æœ‰$J$çš„å…ƒç´ ä¹‹å’Œã€‚å¦‚æœå­˜åœ¨æŸä¸ª$I$å’ŒæŸä¸ª$J$ä½¿ä½¿å¾—è¿™ä¸¤ä¸ªé›†åˆä¸­æ‰€æœ‰å…ƒç´ ä¹‹å’Œç­‰äº$b$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è§£å†³äº†è¿™æ ·çš„ä¸€ä¸ªé—®é¢˜ã€‚è€Œè¿™ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå…¸å‹çš„ä¸­é—´äººæ”»å‡»çš„ä¾‹å­ã€‚</p><p>è¿™ä¸ªå·¥ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º$O(2^{n&#x2F;2})&#x3D;O(1.4143^n)$ï¼Œæ˜æ˜¾æ˜¯å¿«äºåŸæ–¹æ³•$O(2^n)$çš„ã€‚</p><p>ç„¶è€Œï¼Œè¿™é‡Œå¯¹äºä»»ä½•äººæ¥è¯´ï¼Œè§£å¯†çš„å¤æ‚åº¦éƒ½ä¸€æ ·ï¼Œå‡ä¸º$O(1.4143^n)$ã€‚å³ä½¿æ˜¯çœŸæ­£çš„è§£å¯†è€…ï¼Œä¹Ÿä¸ä¼šæœ‰æ‰€è°“çš„$\text{Trapdoor Infomation}$èƒ½å¤Ÿå¿«é€Ÿå‡ºè§£ï¼Œé‚£ä¹ˆèƒ½ä¸èƒ½æ„é€ ä¸€ä¸ªæ‰€è°“çš„$\text{Trapdoor Infomation}$ä½¿å¾—æŒæœ‰ç§é’¥çš„äººå¿«é€Ÿè§£å¯†å‘¢ï¼Ÿ</p><h3 id="2x02-è¶…çº§é€’å¢åºåˆ—"><a href="#2x02-è¶…çº§é€’å¢åºåˆ—" class="headerlink" title="2x02 è¶…çº§é€’å¢åºåˆ—"></a>2x02 è¶…çº§é€’å¢åºåˆ—</h3><p>ä¸‹é¢æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªè¶…çº§é€’å¢åºåˆ—çš„æ¦‚å¿µï¼šå°±æ˜¯å¯¹äºè¿™ä¸ªé›†åˆä¸­çš„æ¯ä¸€ä¸ªæ•°ï¼Œå‰ä¸€ä¸ªæ•°éƒ½å¤§äºç­‰äºä¸Šä¸€ä¸ªæ•°çš„$2$å€ï¼Œé‚£ä¹ˆè¿™ä¸ªåºåˆ—å°±å¯ä»¥è¢«ç§°ä½œè¶…çº§é€’å¢åºåˆ—ã€‚æ¯”å¦‚ï¼š$(1,3,9,27,81,243,729)$å’Œ$(1,5,13,44,118,395,806)$éƒ½æ»¡è¶³æ¡ä»¶ï¼Œå› æ­¤è¿™ä¸¤ä¸ªåºåˆ—å‡ä¸ºè¶…çº§é€’å¢åºåˆ—ã€‚</p><p>è¶…çº§é€’å¢åºåˆ—æœ‰ä¸ªæ€§è´¨ï¼Œå°±æ˜¯ç¬¬$i$ä¸ªæ•°å¤§äºä»–å‰é¢æ‰€æœ‰æ•°å­—ä¹‹å’Œã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è´ªå¿ƒç®—æ³•ï¼Œåœ¨$O(n)$çš„çº¿æ€§å¤æ‚åº¦é‡Œç®—å‡ºå¯†é’¥ï¼Œå…·ä½“åšæ³•å¦‚ä¸‹ã€‚</p><p>å‡å®šæˆ‘ä»¬é€‰å®šçš„åºåˆ—ä¸º$M&#x3D;(1,3,9,27,81,243)$ï¼Œ$b&#x3D;91$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™æ ·çš„æ–¹æ³•è®¡ç®—ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬å‘ç°$81&lt;91&lt;243$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»åºåˆ—ç¬¬$5$ä½å¼€å§‹ï¼Œè®¡ç®—$b-a_5&#x3D;91-81&#x3D;10$ï¼Œæ‰€ä»¥è§£å¯†å¯†é’¥$x_5&#x3D;1$ã€‚ç„¶åï¼Œæˆ‘ä»¬å‘ç°$9&lt;10&lt;27$ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ç›´æ¥è®¡ç®—$10-9&#x3D;1$ï¼Œè§£å¯†å¯†é’¥$x_3&#x3D;1$ï¼Œæœ€åçš„$1-1&#x3D;0$ï¼Œæ‰€ä»¥è§£å¯†å¯†é’¥$x_1&#x3D;0$ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è§£å¯†å¯†é’¥ä¸º$\vec X&#x3D;(1,0,1,0,1,0)$ã€‚</p><p>ä½†æ˜¯è¿™æ ·ï¼Œæ”»å‡»è€…ä¹Ÿå¯ä»¥é€šè¿‡ç›¸åŒçš„æ–¹æ³•ï¼Œå¿«é€Ÿç ´è§£è¿™ä¸ªå¯†é’¥ã€‚</p><h3 id="2x03-ä¸€ä¸ªæ–°çš„å…¬é’¥å¯†ç ä½“ç³»Merkle-Hellman-Algorithm"><a href="#2x03-ä¸€ä¸ªæ–°çš„å…¬é’¥å¯†ç ä½“ç³»Merkle-Hellman-Algorithm" class="headerlink" title="2x03 ä¸€ä¸ªæ–°çš„å…¬é’¥å¯†ç ä½“ç³»Merkle -Hellman  Algorithm"></a>2x03 ä¸€ä¸ªæ–°çš„å…¬é’¥å¯†ç ä½“ç³»Merkle -Hellman  Algorithm</h3><p>MH-Aç®—æ³•æ˜¯åŸºäºè¶…çº§é€’å¢åºåˆ—å­é›†é—®é¢˜çš„ä¸€ä¸ªå…¬é’¥å¯†ç å­¦ä½“ç³»ï¼Œå®ƒä½¿ç”¨åŒä½™è¿›è¡Œä¼ªè£…ï¼Œç„¶åé€šè¿‡åˆ›å»ºå…¬é’¥å¯¹å’Œç§é’¥å¯¹å®ŒæˆåŠ å¯†å’Œè§£å¯†çš„ä¸€ç³»åˆ—æ“ä½œã€‚</p><p>é¦–å…ˆï¼ŒAliceåˆ›é€ ä¸€ä¸ªè¶…çº§é€’å¢åºåˆ—$\vec R&#x3D;(r_1,r_2,â€¦,r_n)$å’Œ$2$ä¸ªå¤§æ•´æ•°$A,B$æ»¡è¶³$B&gt;2r_n,\gcd(A,B)&#x3D;1$ã€‚ç„¶åAliceåˆ›é€ ä¸€ä¸ªæ–°çš„åºåˆ—$\vec M&#x3D;(m_1,m_2,â€¦,m_n)$ï¼Œä½¿å¾—$m_i \equiv Ar_i \pmod B$ï¼Œå¹¶å…¬å¼€$M$ï¼Œä½œä¸ºå…¬é’¥ã€‚</p><p>Bobæ”¶åˆ°å¯†é’¥ä¹‹åï¼Œè®¾æ˜æ–‡ä¸º$\vec X$ï¼Œå…¶ä¸­$\vec X$æ˜¯ä¸€ä¸ª$n$ç»´å‘é‡ï¼Œæ¯ä¸ªåˆ†é‡å–å€¼ä¸º$0$æˆ–$1$ã€‚ç„¶åBobè®¡ç®—$C&#x3D;\vec X Â·\vec M$å®ŒæˆåŠ å¯†ã€‚</p><p>Aliceæ”¶åˆ°å¯†æ–‡åï¼Œåªéœ€è¦è®¡ç®—å‡º$D&#x3D;A^{-1}C \pmod B$ï¼Œç„¶åæ±‚$D$åœ¨é›†åˆ$\vec R$ ä¸­çš„ä¸€ä¸ªè¡¨ç¤ºæ–¹æ³•$\vec Q$å³å¯è§£å¯†ã€‚</p><p>ç®€å•è¯æ˜ä¸€ä¸‹$\vec Q&#x3D;\vec X$</p><p>ç”±äº$D\equiv A^{-1}\sum_{i&#x3D;1}^{n} x_im_i \equiv A^{-1}\sum_{i&#x3D;1}^{n} Ax_ir_i \equiv \sum_{i&#x3D;1}^{n} x_ir_i\pmod B$ã€‚è€Œåˆæœ‰$B&gt;2r_n$ï¼Œå› æ­¤$D$å°±æ˜¯$\vec X Â·\vec R$çš„çœŸå®å€¼</p><p>ä¸‹é¢ä¸Šä¸€ä¸‹ä»£ç ï¼šä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬ä»¥$5$ç»´å‘é‡ä¸ºä¾‹ï¼šå‡è®¾$\vec R&#x3D;(2,5,13,34,87),A&#x3D;100,B&#x3D;227$ï¼Œé‚£ä¹ˆæ ¹æ®Aliceçš„è®¡ç®—ï¼Œå¯å¾—$\vec M&#x3D;(200,46,165,222,24)$ã€‚</p><p>ç„¶åBobè®¾å®šçš„å¯†æ–‡$\vec X&#x3D;(1,1,0,1,0)$ï¼Œè®¡ç®—$C&#x3D;\vec XÂ·\vec M&#x3D;468$ä½œä¸ºå¯†æ–‡ã€‚</p><p>Aliceæ ¹æ®Bobçš„å¯†æ–‡$C&#x3D;468$ï¼Œè®¡ç®—$D\equiv A^{-1}C\equiv 84Ã—468 \equiv 41 \pmod {227}$ã€‚</p><p>ç„¶åå°†$D$ç”¨$\vec R$ä¸­çš„å…ƒç´ è¿›è¡Œ$0,1$è¡¨ç¤ºï¼Œå³å¯è¿˜åŸæ˜æ–‡$\vec X$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-comment">#PREPARE</span><br>R,A,B=[<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">13</span>,<span class="hljs-number">34</span>,<span class="hljs-number">87</span>],<span class="hljs-number">100</span>,<span class="hljs-number">227</span><br><span class="hljs-keyword">assert</span> GCD(A,B)==<span class="hljs-number">1</span><br><span class="hljs-keyword">assert</span> B&gt;R[<span class="hljs-built_in">len</span>(R)-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(R)):<br>    <span class="hljs-keyword">assert</span> R[i]&gt;=<span class="hljs-number">2</span>*R[i-<span class="hljs-number">1</span>]<br>M=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> R:<br>    M.append(A*i%B)<br><span class="hljs-built_in">print</span>(M)<br><span class="hljs-comment">#ENCRYPT</span><br>X=[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>]<br>C=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(R)):<br>    C+=X[i]*M[i]<br><span class="hljs-built_in">print</span>(C)<br><span class="hljs-comment">#DECRYPT</span><br>D,t=C*inverse(A,B)%B,<span class="hljs-built_in">len</span>(R)-<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(D)<br>Q=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(R))]<br><span class="hljs-keyword">while</span> D <span class="hljs-keyword">and</span> t+<span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">if</span>(D&gt;=R[t]):<br>        Q[t]=<span class="hljs-number">1</span><br>        D-=R[t]<br>    t-=<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(Q,Q==X)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">[200, 46, 165, 222, 74]</span><br><span class="hljs-string">468</span><br><span class="hljs-string">41</span><br><span class="hljs-string">[1, 1, 0, 1, 0] True</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="2x04-å¯¹2x03ä¸­åŠ å¯†ç³»ç»Ÿçš„æ”»å‡»"><a href="#2x04-å¯¹2x03ä¸­åŠ å¯†ç³»ç»Ÿçš„æ”»å‡»" class="headerlink" title="2x04 å¯¹2x03ä¸­åŠ å¯†ç³»ç»Ÿçš„æ”»å‡»"></a>2x04 å¯¹2x03ä¸­åŠ å¯†ç³»ç»Ÿçš„æ”»å‡»</h3><p>2x03ä¸­æˆ‘ä»¬æåˆ°çš„å¯†ç ä½“ç³»åˆç§°ä½œå­é›†å…¬é’¥å¯†ç å­¦ç³»ç»Ÿæˆ–è€…èƒŒåŒ…å¯†ç å­¦ç³»ç»Ÿã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ç”Ÿæˆä¸€ä¸ªè¶…çº§é€’å¢åºåˆ—ï¼Œç„¶åç”¨æ¨¡çº¿æ€§è¿ç®—è¿›è¡Œæ··æ·†ï¼Œå°†æ··æ·†ä¹‹åçš„åºåˆ—ä½œä¸ºå…¬é’¥ã€‚</p><p>ç„¶è€Œï¼Œè¿™ä¸€å¯†ç ç³»ç»Ÿä¹Ÿæœ‰æ¯”è¾ƒå¤§çš„ç¼ºç‚¹ã€‚ç”±äº$M$æ˜¯ä¸€ä¸ª$n$ä¸ªæ•´æ•°çš„åˆ—è¡¨ï¼Œæ¯ä¸ªæ•´æ•°æœ‰$2^n$æ¯”ç‰¹é•¿ã€‚æ˜æ–‡çš„é•¿åº¦æ˜¯$n$ï¼Œå¯†æ–‡çš„é•¿åº¦æ˜¯$2n$ã€‚å› æ­¤è¿™ç®—æ˜¯ä¸€ä¸ª$2-\text{to}- 1$çš„å¯†ç ä½“ç³»ã€‚å½“$n&#x3D;160$æ—¶ï¼Œæ•´ä¸ªå…¬é’¥çš„å¤§å°å¤§çº¦æ˜¯$51200$ä½ä»¥ä¸Šï¼Œè¿œè¿œè¶…è¿‡äº†RSA,ECCç­‰ä½¿ç”¨å¹¿æ³›çš„å…¬é’¥å¯†ç ç³»ç»Ÿï¼Œä¸è¿‡è¿™ä¸ªç®—æ³•ç”±äºä¹˜å¹‚å’Œå–æ¨¡è¾ƒå°‘ï¼Œå› æ­¤åŠ å¯†é€Ÿåº¦ä¹Ÿè¿œå¿«äºRSAå’ŒECCï¼Œå› æ­¤è¿™ä¸€æ€§è´¨ä¹Ÿæˆä¸ºäº†ä¸€ä¸ªæ¯”è¾ƒå¸å¼•äººçš„ç ”ç©¶ç‚¹ã€‚</p><p>ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è·å¾—ä¸€ä¸ª$300$ä½ï¼Œæ¯”è¾ƒå®‰å…¨çš„èƒŒåŒ…å¯†ç å­¦ç³»ç»Ÿï¼Œé‚£ä¹ˆæ•´ä¸ªç§é’¥ç©ºé—´å°†è¶…è¿‡$180\text{KB}$ã€‚å› æ­¤ï¼Œç†è®ºä¸Šå®‰å…¨çš„èƒŒåŒ…å¯†ç åŸºæœ¬ä¸å­˜åœ¨ã€‚</p><p>è€Œæ”»å‡»è€…æƒ³è¦ç”¨å‘é‡é‡æ–°è®¡ç®—å­é›†çš„é—®é¢˜ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±è¦ä»$M$ä¸­å†™å‡º$S$çš„å­é›†å’Œï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥å½¢æˆä¸€ä¸ªè¿™æ ·çš„çŸ©é˜µï¼Œå…¶ä¸­$b&#x3D;C$ï¼Œ$\text{ones}&#x3D;(1,1,1,â€¦,1)$ï¼Œ$E$ä¸º$n$é˜¶å•ä½çŸ©é˜µï¼Œ$M$æ”¹å†™æˆåˆ—å‘é‡çš„å½¢å¼</p><img src="/2021/02/01/LatticeNotes1/1.png" alt="1" style="zoom:80%;"><p>åœ¨ä¸Šé¢çš„ä¾‹å­é‡Œï¼Œæˆ‘ä»¬çš„çŸ©é˜µå°±æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p><img src="/2021/02/01/LatticeNotes1/2.png" alt="2" style="zoom:67%;"><p>æŠŠçŸ©é˜µåˆ†ç¦»å‡ºè¡Œå‘é‡ï¼Œé‚£ä¹ˆå°±æœ‰$\vec v_1&#x3D;(2,0,0,0,0,200),\vec v_2&#x3D;(0,2,0,0,0,46),\vec v_3&#x3D;(0,0,2,0,0,165),\vec v_4&#x3D;(0,0,0,2,0,222),\vec v_5&#x3D;(2,0,0,0,2,74)$</p><p>ç„¶åè¿˜æœ‰ä¸€ä¸ªé™„åŠ å‘é‡$\vec w&#x3D;(1,1,1,1,1,468)$</p><p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„å»ºè¿™æ ·ä¸€ä¸ªæ ¼$L$ï¼Œä»¥${v_1,v_2,v_3,v_4,v_5,w}$ä¸ºåŸºåº•ã€‚é‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œ$\vec{t}&#x3D;\sum_{i&#x3D;1}^5(2v_i-w)&#x3D;(2x_1-1,2x_2-1,2x_3-1,2x_4-1,2x_5-1,0) \in L$ã€‚ç”±äºæ‰€æœ‰çš„$x$çš„å–å€¼åªæœ‰$0$å’Œ$1$ã€‚é‚£ä¹ˆå‘é‡$\vec t$çš„å‡ºæœ€åä¸€ä¸ªåˆ†é‡ä¸º$0$å¤–å‡ä¸º$Â±1$.ã€‚æˆ‘ä»¬å¯ä»¥å¾—åˆ°$||\vec t||&#x3D;O(\sqrt n)$ã€‚è€Œè¿™ä¸ªæ ¼ä¸­çš„å‘é‡ï¼Œé•¿åº¦éƒ½è¾¾åˆ°äº†$O(4^n)$ï¼Œæ‰€ä»¥å‘é‡$ \vec t$å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçŸ­å‘é‡ã€‚</p><p>æ‰€ä»¥ï¼Œæ”»å‡»è€…åªéœ€è¦æ‰¾åˆ°æ ¼ä¸­çš„ä¸€ä¸ªæœ€çŸ­çš„é$0$å‘é‡ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ¢å¤æ˜æ–‡ã€‚</p><p>åœ¨æ ¼ä¸­æ‰¾åˆ°çŸ­å‘é‡çš„ç®—æ³•ç§°ä¸ºæ ¼å‡ç®—æ³•ã€‚ å…¶ä¸­æœ€è‘—åçš„æ˜¯LLLç®—æ³•</p><h3 id="2x05-LLLç®—æ³•çš„åˆæ­¥å®ç°-in-Sagemath"><a href="#2x05-LLLç®—æ³•çš„åˆæ­¥å®ç°-in-Sagemath" class="headerlink" title="2x05 LLLç®—æ³•çš„åˆæ­¥å®ç° in Sagemath"></a>2x05 LLLç®—æ³•çš„åˆæ­¥å®ç° in Sagemath</h3><p><img src="/2021/02/01/LatticeNotes1/3.png" alt="3"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€è¡Œå‘é‡æ˜¯$(-1,-1,1,-1,1|0)$ï¼Œå–ç›¸åå‘é‡å¾—$(1,1,-1,1,-1|0)$ï¼ŒåŠ ä¸Š$1$ç„¶åé™¤ä»¥$2$ï¼Œå¾—$(1,1,0,1,0|0)$ï¼Œæ‰€ä»¥é€šè¿‡LLLç®—æ³•ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±å¾—åˆ°äº†ç­”æ¡ˆä¸º$(1,1,0,1,0)$ã€‚</p><p><strong>Update 8.30</strong></p><p>å®é™…ä¸Šï¼Œè¿™è¾¹è¿˜æœ‰æ›´å¥½çš„ä¸€ä¸ªçŸ©é˜µæ„é€ æ–¹æ³•å¦‚å›¾ï¼š</p><p>ä¹Ÿå°±æ˜¯ä¸Šé¢çš„åˆ†å—çŸ©é˜µä¸­ï¼š$2E$æ”¹æˆ$E$ï¼Œ$\mathrm{ones}$æ”¹æˆ$\vec 0$ï¼Œ$b$æ”¹æˆ$-b$åï¼Œç»“æœæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚</p><p><img src="/2021/02/01/LatticeNotes1/4.png" alt="4"></p><p>ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°ç­”æ¡ˆä¸º$(1,1,0,1,0)$ï¼Œä¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œç¬¬äºŒæ­¥çš„å¤„ç†ã€‚</p><p>åé¢å¯¹äºLLLç®—æ³•è¿˜ä¼šæœ‰æ›´å¤šç¬”è®°ï¼Œæ­¤å¤„ä»…ä»…æ˜¯æåŠä¸€ä¸‹ï¼Œåé¢çš„ç¬”è®°ä¼šè¯¦ç»†è®²è§£ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>21Jan4</title>
    <link href="/2021/01/29/21Jan4/"/>
    <url>/2021/01/29/21Jan4/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å¯’å‡çš„åˆ‡é¢˜4"><a href="#huangx607087å¯’å‡çš„åˆ‡é¢˜4" class="headerlink" title="huangx607087å¯’å‡çš„åˆ‡é¢˜4"></a>huangx607087å¯’å‡çš„åˆ‡é¢˜4</h1><h2 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0.ç®€ä»‹"></a>0.ç®€ä»‹</h2><p>ä»Šå¤©BUUCTFä¸Šåˆ°äº†2000åˆ†ï¼Œåé¢å‰©ä¸‹çš„é¢˜ç›®å°±éƒ½æ˜¯é‚£äº›90+åˆ†ï¼Œåšå‡ºæ¥çš„äººå¾ˆå°‘çš„é‚£ç§äº†ï¼Œéš¾åº¦ä¹Ÿæ˜¯éå¸¸å¤§çš„ã€‚å› æ­¤æ‰“ç®—åé¢å‡ å¤©æŠŠç†è®ºçœ‹çœ‹ï¼Œ<del>å¹¶ä¸”è¿˜è¦æ‰“æ­ç”µæŒç»­ä¸€ä¸ªæœˆçš„CTFï¼Œè‡ªå·±çš„äººå·¥æ™ºèƒ½é¡¹ç›®ä¹Ÿæ‘¸äº†3å¤©äº†ï¼Œå“</del></p><h2 id="1-GUET-CTF2019-Uncle-Sam"><a href="#1-GUET-CTF2019-Uncle-Sam" class="headerlink" title="1.[GUET-CTF2019]Uncle Sam"></a>1.[GUET-CTF2019]Uncle Sam</h2><p>æˆ‘ä»¬è¿˜æ˜¯å…ˆçœ‹ä¸€ä¸‹åŠ å¯†ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generkey</span>(<span class="hljs-params">k</span>):<br>p, q = getPrime(k), getPrime(k)<br>pubkey = p**<span class="hljs-number">2</span> * q<br>n = pubkey<br>l = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>) / gcd(p-<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>)<br>privkey = inverse(n, l)<br><span class="hljs-keyword">return</span> pubkey, privkey<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m, pubkey</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(bytes_to_long(m), pubkey, pubkey)<br><span class="hljs-comment"># n =  *</span><br><span class="hljs-comment"># d = *</span><br><span class="hljs-comment"># c = * ç»™å‡ºéƒ¨åˆ†ç•¥å»</span><br><br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸RSAä¸ä¸€æ ·ï¼Œå› ä¸ºè¿™é“é¢˜å…¬é’¥$n&#x3D;p^2q$ï¼Œè™½ç„¶è²Œä¼¼ä¹Ÿå‡ºç°è¿‡æ‰€è°“çš„$p^2q$ä¹‹ç±»çš„åˆ†è§£å› å¼æ³•ï¼Œä¸è¿‡è¿™è²Œä¼¼ä¹Ÿå¹¶ä¸å¯åˆ†è§£ã€‚</p><p>æ³¨æ„åˆ°$l&#x3D;\text{lcm}(p-1,q-1)$ï¼Œå¹¶ä¸”è¿˜ç»™å‡ºäº†ç§é’¥$d$å€¼ä½$n$æ¨¡$l$ä¸‹çš„é€†å…ƒã€‚æŸ¥é˜…äº†ç›¸å…³èµ„æ–™ï¼Œå¯ä»¥å¾—çŸ¥è¿™æ˜¯Schmidt-Samoa å…¬é’¥å¯†ç ä½“ç³»ã€‚</p><p>è¿™ä¸€åŠ å¯†ä½“ç³»ä¸­ï¼ŒåŠ å¯†è¿‡ç¨‹æ˜¯$c\equiv m^n \pmod n $ï¼Œè€Œè§£å¯†å‡½æ•°åˆ™æ˜¯$m\equiv c^d\pmod{pq} $</p><p>ä¸‹é¢ç®€å•åœ°è¯æ˜ä¸€ä¸‹ï¼š</p><p>å·²çŸ¥<br>$$<br>\phi(n)&#x3D;\phi(p^2q)&#x3D;p(p-1)(q-1)<br>$$<br>ç”±è´¹é©¬å°å®šç†ï¼Œå¯ä»¥æ¨å‡º<br>$$<br>a^{p(p-1)(q-1)} \equiv 1 \pmod n<br>$$<br>åˆå› ä¸º<br>$$<br>dn\equiv 1 \pmod {(p-1)(q-1)}<br>$$<br>æ‰€ä»¥<br>$$<br>a^{nd}\equiv a^{nd \mod ((p-1)(q-1))} \equiv a<br>$$<br>æ‰€ä»¥<br>$$<br>a^{nd}-a\equiv 0 \pmod{pq}<br>$$<br>å› æ­¤<br>$$<br>pq&#x3D;\gcd(a^{nd}-a,n)<br>$$<br>ç”±äº$a$æ˜¯ä»»æ„çš„æ•°å­—ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å–$a&#x3D;2,3,4â€¦$å‡å¯ï¼Œä¸ºæ–¹ä¾¿èµ·è§è¿™é‡Œå–$2$</p><p>è§£å¯†ä»£ç éå¸¸çŸ­ï¼Œä¸è¿‡æ¨å‡ºè¿™ä¸ªå¼å­è¿˜æ˜¯éå¸¸ä¸å®¹æ˜“çš„ï¼ˆï¼Œä½•å†µè¿™ä¸ªåŠ å¯†æ–¹æ³•ä¸€å¼€å§‹è‡ªå·±ä¹Ÿæ²¡æ€ä¹ˆæ¥è§¦è¿‡ï¼Œçœ‹åˆ°$pq$æ€»æ˜¯ä¼šæƒ³åˆ°RSAä¸Šå»ã€‚æ ¹æœ¬åŸå› è¿˜æ˜¯è‡ªå·±<del>å¤ªèœäº†</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> n,c,d<br>x=GCD(n,<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,n*d,n)-<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,x)))<br></code></pre></td></tr></table></figure><h2 id="2-XNUCA2018-baby-crypto"><a href="#2-XNUCA2018-baby-crypto" class="headerlink" title="2.[XNUCA2018]baby_crypto"></a>2.[XNUCA2018]baby_crypto</h2><p>é¢˜ç›®ç»™å‡ºçš„å†…å®¹éå¸¸ç®€å•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">The <span class="hljs-number">26</span> letters a, b, c, ..., y, z correspond to the integers <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, ..., <span class="hljs-number">25</span><br><span class="hljs-built_in">len</span>(key_a) = m<br><span class="hljs-built_in">len</span>(key_k) = n<br>c[i] = (p[i] * key_a[i % m] + key_k[i % n]) % <span class="hljs-number">26</span><br>p <span class="hljs-keyword">is</span> plain text, only lowercase letters are refered to.<br>c <span class="hljs-keyword">is</span> encrypted text<br>I have appended the flag at the end of plain text, the <span class="hljs-built_in">format</span> of which <span class="hljs-keyword">is</span> like <span class="hljs-string">&#x27;flagis......&#x27;</span><br>Now you have the encrypted text, Good luck!<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªçº¿æ€§çš„åŠ å¯†ï¼Œåº”è¯¥è·ŸVigenaå¯†ç ç›¸ä¼¼ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¸€æ ·ï¼Œæ¯$3$ä¸ªå­—æ¯ä¸€ç»„ï¼Œæ±‚å‡ºå‘¨æœŸã€‚</p><h3 id="PART-1-æ±‚å‘¨æœŸéƒ¨åˆ†"><a href="#PART-1-æ±‚å‘¨æœŸéƒ¨åˆ†" class="headerlink" title="PART 1 æ±‚å‘¨æœŸéƒ¨åˆ†"></a>PART 1 æ±‚å‘¨æœŸéƒ¨åˆ†</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>string s;<br>map&lt;string,<span class="hljs-type">int</span>&gt;lst,mil;<br><span class="hljs-function">string <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>string c=<span class="hljs-string">&quot;&quot;</span>;<br>c+=(x/(<span class="hljs-number">26</span>*<span class="hljs-number">26</span>))<span class="hljs-number">+97</span>;<br>c+=(x%(<span class="hljs-number">26</span>*<span class="hljs-number">26</span>)/<span class="hljs-number">26</span>)<span class="hljs-number">+97</span>;<br>c+=x%<span class="hljs-number">26</span><span class="hljs-number">+97</span>;<br><span class="hljs-keyword">return</span> c;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;enc.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;detPro.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>,stdout);<br><span class="hljs-type">int</span> i,j;<br>cin&gt;&gt;s;<br>s=<span class="hljs-string">&quot; &quot;</span>+s;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;s.<span class="hljs-built_in">length</span>()<span class="hljs-number">-1</span>;i++)<br>&#123;<br><span class="hljs-keyword">if</span>(lst[s.<span class="hljs-built_in">substr</span>(i,<span class="hljs-number">3</span>)]==<span class="hljs-number">0</span>)<br>lst[s.<span class="hljs-built_in">substr</span>(i,<span class="hljs-number">3</span>)]=i;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-type">int</span> det=i-lst[s.<span class="hljs-built_in">substr</span>(i,<span class="hljs-number">3</span>)];<br><span class="hljs-keyword">if</span>(mil[s.<span class="hljs-built_in">substr</span>(i,<span class="hljs-number">3</span>)]==<span class="hljs-number">0</span>)<br>mil[s.<span class="hljs-built_in">substr</span>(i,<span class="hljs-number">3</span>)]=det;<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">if</span>(det&gt;<span class="hljs-number">10</span>)<br>mil[s.<span class="hljs-built_in">substr</span>(i,<span class="hljs-number">3</span>)]=<span class="hljs-built_in">min</span>(det,mil[s.<span class="hljs-built_in">substr</span>(i,<span class="hljs-number">3</span>)]);<br>lst[s.<span class="hljs-built_in">substr</span>(i,<span class="hljs-number">3</span>)]=i;<br>&#125;<br>&#125; <br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;=<span class="hljs-number">26</span>*<span class="hljs-number">26</span>*<span class="hljs-number">26</span>;i++)<br>&#123;<br><span class="hljs-keyword">if</span>(mil[<span class="hljs-built_in">f</span>(i)]!=<span class="hljs-number">0</span>)<br>cout&lt;&lt;<span class="hljs-built_in">f</span>(i)&lt;&lt;<span class="hljs-string">&quot;   &quot;</span>&lt;&lt;mil[<span class="hljs-built_in">f</span>(i)]&lt;&lt;endl; <br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure><p>æ‰“å¼€æœ€åçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ€åå¾ˆå¤šçš„é—´éš”éƒ½æ˜¯$6$çš„å€æ•°ï¼Œæ¯”å¦‚$6,12,18,24,30,â€¦$ä¹‹ç±»çš„æ•°å­—ï¼Œå› æ­¤å¯ä»¥çŒœæµ‹ï¼Œå‘¨æœŸåº”è¯¥æ˜¯$6$ã€‚</p><h3 id="PART-2-åˆ†å‰²-æ±‚è¡¨è¾¾å¼"><a href="#PART-2-åˆ†å‰²-æ±‚è¡¨è¾¾å¼" class="headerlink" title="PART 2 åˆ†å‰²&amp;æ±‚è¡¨è¾¾å¼"></a>PART 2 åˆ†å‰²&amp;æ±‚è¡¨è¾¾å¼</h3><p>å¾—åˆ°å‘¨æœŸæ˜¯$6$ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸæ¥çš„å¯†æ–‡æ‹†åˆ†æˆ$6$ä¸ªæ–‡ä»¶ï¼Œé—´éš”$6$ä¸ªå­—æ¯ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¾“å‡ºï¼Œç„¶ååˆ†åˆ«æ±‚è¡¨è¾¾å¼ã€‚</p><p>æ±‚è¡¨è¾¾å¼çš„æ—¶å€™ï¼Œç”±äºåŠ å¯†æ˜¯ä¸€æ¬¡å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘åŠ å¯†å‡½æ•°ï¼Œç›´æ¥æšä¸¾è§£å¯†å‡½æ•°ï¼ˆä¹Ÿæ˜¯ä¸€æ¬¡å‡½æ•°ï¼Œä¸€å…±æœ‰$12Ã—26$ä¸ªï¼‰ï¼Œç„¶åæ ¹æ®å­—æ¯é¢‘ç‡åˆ†æï¼Œè®¡ç®—æ–¹å·®å³å¯ï¼Œæœ€åå°†æ–¹å·®æ’ä¸ªåºï¼Œæ¯æ¬¡é€‰å‡ºæœ€å°çš„é‚£ä¸ªå³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">double</span> pos[<span class="hljs-number">26</span>],cul[<span class="hljs-number">26</span>];<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">asdf</span>&#123;<span class="hljs-type">int</span> K,B;<span class="hljs-type">double</span> loss;<br>&#125;data[<span class="hljs-number">500</span>];<br><span class="hljs-type">int</span> n,k[<span class="hljs-number">12</span>],str[<span class="hljs-number">40000</span>];<br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(asdf a,asdf b)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">return</span> a.loss&lt;b.loss;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br>pos[<span class="hljs-number">0</span>]=<span class="hljs-number">8.15</span>,pos[<span class="hljs-number">1</span>]=<span class="hljs-number">1.44</span>,pos[<span class="hljs-number">2</span>]=<span class="hljs-number">2.76</span>,pos[<span class="hljs-number">3</span>]=<span class="hljs-number">3.79</span>;<br>pos[<span class="hljs-number">4</span>]=<span class="hljs-number">13.11</span>,pos[<span class="hljs-number">5</span>]=<span class="hljs-number">2.92</span>,pos[<span class="hljs-number">6</span>]=<span class="hljs-number">1.99</span>,pos[<span class="hljs-number">7</span>]=<span class="hljs-number">5.26</span>;<br>pos[<span class="hljs-number">8</span>]=<span class="hljs-number">6.35</span>,pos[<span class="hljs-number">9</span>]=<span class="hljs-number">0.13</span>,pos[<span class="hljs-number">10</span>]=<span class="hljs-number">0.42</span>,pos[<span class="hljs-number">11</span>]=<span class="hljs-number">3.39</span>;<br>pos[<span class="hljs-number">12</span>]=<span class="hljs-number">2.54</span>,pos[<span class="hljs-number">13</span>]=<span class="hljs-number">7.1</span>,pos[<span class="hljs-number">14</span>]=<span class="hljs-number">8</span>,pos[<span class="hljs-number">15</span>]=<span class="hljs-number">1.98</span>;<br>pos[<span class="hljs-number">16</span>]=<span class="hljs-number">0.12</span>,pos[<span class="hljs-number">17</span>]=<span class="hljs-number">6.83</span>,pos[<span class="hljs-number">18</span>]=<span class="hljs-number">6.1</span>,pos[<span class="hljs-number">19</span>]=<span class="hljs-number">10.47</span>;<br>pos[<span class="hljs-number">20</span>]=<span class="hljs-number">2.46</span>,pos[<span class="hljs-number">21</span>]=<span class="hljs-number">0.92</span>,pos[<span class="hljs-number">22</span>]=<span class="hljs-number">1.54</span>,pos[<span class="hljs-number">23</span>]=<span class="hljs-number">0.17</span>;<br>pos[<span class="hljs-number">24</span>]=<span class="hljs-number">1.98</span>,pos[<span class="hljs-number">25</span>]=<span class="hljs-number">0.08</span>; <br>FILE *fp;<br>fp=<span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;enc6.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>);<br><span class="hljs-type">char</span> c;<br>str[<span class="hljs-number">0</span>]=<span class="hljs-number">-1</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">4771</span>;i++)<br>&#123;<br><span class="hljs-built_in">fscanf</span>(fp,<span class="hljs-string">&quot;%c&quot;</span>,&amp;c);<br>str[i]=c<span class="hljs-number">-97</span>;<br>&#125;<br><span class="hljs-built_in">fclose</span>(fp);<br>k[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>,k[<span class="hljs-number">1</span>]=<span class="hljs-number">3</span>,k[<span class="hljs-number">2</span>]=<span class="hljs-number">5</span>,k[<span class="hljs-number">3</span>]=<span class="hljs-number">7</span>,k[<span class="hljs-number">4</span>]=<span class="hljs-number">9</span>,k[<span class="hljs-number">5</span>]=<span class="hljs-number">11</span>;<br>k[<span class="hljs-number">6</span>]=<span class="hljs-number">15</span>,k[<span class="hljs-number">7</span>]=<span class="hljs-number">17</span>,k[<span class="hljs-number">8</span>]=<span class="hljs-number">19</span>,k[<span class="hljs-number">9</span>]=<span class="hljs-number">21</span>,k[<span class="hljs-number">10</span>]=<span class="hljs-number">23</span>,k[<span class="hljs-number">11</span>]=<span class="hljs-number">25</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">culcvarp</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-type">double</span> P=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">26</span>;i++)<br>P+=(cul[i]-pos[i])*(cul[i]-pos[i]);<br><span class="hljs-keyword">return</span> P;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">transform</span><span class="hljs-params">(<span class="hljs-type">int</span> K,<span class="hljs-type">int</span> B)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">26</span>;i++) cul[i]=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">4771</span>;i++)<br>cul[(K*str[i]+B)%<span class="hljs-number">26</span>]++;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">26</span>;i++)<br>cul[i]/=<span class="hljs-number">47.71</span>;<br>data[++n].K=K,data[n].B=B,data[n].loss=<span class="hljs-built_in">culcvarp</span>();<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-built_in">init</span>();<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">12</span>;i++)<br><span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">26</span>;j++)<br><span class="hljs-built_in">transform</span>(k[i],j);<br><span class="hljs-built_in">sort</span>(data<span class="hljs-number">+1</span>,data+n<span class="hljs-number">+1</span>,cmp);s<br>FILE *fp;<br>fp=<span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;fnc&amp;pso6.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br><span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">&quot;D(x)=%dx+%d:loss=%.9lf\n&quot;</span>,data[i].K,data[i].B,data[i].loss);<br><span class="hljs-built_in">fclose</span>(fp);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure><p>æ¯æ¬¡æ±‚å‡ºæ¥åï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¾“å‡ºçš„ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼çš„lossåªæœ‰$12$å·¦å³ï¼Œè€Œç¬¬äºŒä¸ªè¡¨è¾¾å¼çš„losså·²ç»è¾¾åˆ°äº†$200+$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ–­å®šï¼Œç¬¬ä¸€ä¸ªè¡¨è¾¾å¼å°±æ˜¯æˆ‘ä»¬æƒ³æ±‚çš„é‚£ä¸ªè¡¨è¾¾å¼ã€‚</p><p>æ±‚å‡ºæ‰€æœ‰è§£å¯†è¡¨è¾¾å¼ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ±‚å‡ºæœ€åçš„flagäº†,åˆ°æ—¶å€™åªéœ€è¦ç›´æ¥åœ¨è¾“å‡ºæ–‡ä»¶ä¸­æ‰¾åˆ°<code>flag is...</code>çš„å­—æ ·å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m;<br><span class="hljs-type">char</span> str[<span class="hljs-number">40000</span>],ans[<span class="hljs-number">40000</span>];<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br>FILE *fp=<span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;enc.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>);<br><span class="hljs-built_in">fscanf</span>(fp,<span class="hljs-string">&quot;%s&quot;</span>,str);<br>n=<span class="hljs-built_in">strlen</span>(str);<br><span class="hljs-built_in">fclose</span>(fp);<br>fp=<span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;dec.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;n;i+=<span class="hljs-number">6</span>)<br>ans[i]=(<span class="hljs-number">11</span>*(str[i]<span class="hljs-number">-97</span>)<span class="hljs-number">+20</span>)%<span class="hljs-number">26</span><span class="hljs-number">+97</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;n;i+=<span class="hljs-number">6</span>)<br>ans[i]=(<span class="hljs-number">15</span>*(str[i]<span class="hljs-number">-97</span>)<span class="hljs-number">+21</span>)%<span class="hljs-number">26</span><span class="hljs-number">+97</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">2</span>;i&lt;n;i+=<span class="hljs-number">6</span>)<br>ans[i]=(<span class="hljs-number">17</span>*(str[i]<span class="hljs-number">-97</span>)<span class="hljs-number">+1</span>)%<span class="hljs-number">26</span><span class="hljs-number">+97</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">3</span>;i&lt;n;i+=<span class="hljs-number">6</span>)<br>ans[i]=(<span class="hljs-number">11</span>*(str[i]<span class="hljs-number">-97</span>)<span class="hljs-number">+22</span>)%<span class="hljs-number">26</span><span class="hljs-number">+97</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">4</span>;i&lt;n;i+=<span class="hljs-number">6</span>)<br>ans[i]=(<span class="hljs-number">15</span>*(str[i]<span class="hljs-number">-97</span>)<span class="hljs-number">+24</span>)%<span class="hljs-number">26</span><span class="hljs-number">+97</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">5</span>;i&lt;n;i+=<span class="hljs-number">6</span>)<br>ans[i]=(<span class="hljs-number">17</span>*(str[i]<span class="hljs-number">-97</span>)<span class="hljs-number">+5</span>)%<span class="hljs-number">26</span><span class="hljs-number">+97</span>;<br><span class="hljs-built_in">fprintf</span>(fp,<span class="hljs-string">&quot;%s&quot;</span>,ans);<br><span class="hljs-built_in">fclose</span>(fp);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="3-AFCTF2018-MagicNum"><a href="#3-AFCTF2018-MagicNum" class="headerlink" title="3.[AFCTF2018]MagicNum"></a>3.[AFCTF2018]MagicNum</h2><p>é¢˜ç›®ç»™å‡ºäº†$6$ä¸ªæµ®ç‚¹æ•°ï¼Œä¼šæƒ³åˆ°ä»¥å‰è®²è¿‡ï¼ŒC++çš„<code>float</code>å’Œ<code>int</code>éƒ½æ˜¯$4$ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯$8$ä½åå…­è¿›åˆ¶æ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯è¦æŠŠfloatè½¬åŒ–æˆä¸ä¹‹å¯¹åº”çš„åœ¨å†…å­˜ä¸­å­˜å‚¨æ–¹å¼å®Œå…¨ä¸€è‡´çš„intå€¼ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘å¼ºåˆ¶è½¬æ¢æŒ‡é’ˆç±»å‹ï¼Œå°†<code>float</code>æŒ‡é’ˆç±»å‹è¾“å‡ºæ—¶å¼ºåˆ¶è½¬æ¢æˆ<code>int</code>æŒ‡é’ˆç±»å‹ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-type">float</span> f;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">6</span>;i++)<br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%f&quot;</span>,&amp;f);<br><span class="hljs-type">float</span> *p=&amp;f;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%x\n&quot;</span>,*(<span class="hljs-type">int</span>*) p);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//72065910510177138000000000000000.000000</span><br><span class="hljs-comment">//74636661</span><br></code></pre></td></tr></table></figure><p>æœ€ååªéœ€è¦æŠŠæˆ‘ä»¬æ¯æ¬¡å¾—åˆ°çš„å…«ä½åå…­è¿›åˆ¶æ•°ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚åœ°å€’è¿‡æ¥é‡æ–°ç»„è£…ï¼Œå°±å˜æˆäº†flag</p><h2 id="4-LeftOrRight"><a href="#4-LeftOrRight" class="headerlink" title="4.LeftOrRight"></a>4.LeftOrRight</h2><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªæ— æ³•æ‰“å¼€çš„å›¾ç‰‡ï¼Œè½¬æ¢æˆtxtï¼Œå¯ä»¥çœ‹åˆ°å¼€å§‹å’Œè§£ä¸ºéƒ½æœ‰$32$ä¸ªåå…­è¿›åˆ¶æ•°ï¼Œè½¬æ¢æˆå­—ç¬¦ï¼Œè²Œä¼¼è¿™ä¸¤ä¸ªå­—ç¬¦éƒ½ä»…ä»…æ˜¯æ‰“ä¹±äº†é¡ºåºè€Œå·²ï¼Œæ ¹æ®é¢˜ç›®æç¤ºï¼Œè¿™ç§é¢˜ç›®åº”è¯¥æ˜¯ç»™å‡ºäº†ä¸€æ£µäºŒå‰æ ‘çš„å…ˆåºéå†å’Œä¸­åºéå†ï¼Œè®©ä½ æ±‚ååºéå†ã€‚</p><p>éš¾åº¦ä¸å¤§ï¼Œéšä¾¿åœ¨ç½‘ä¸Šæ‰¾ä¸€ä¸ªè„šæœ¬æŠ„ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°æœ€åçš„ç­”æ¡ˆäº†ï¼ˆ<del>æˆ‘åªæ˜¯ä¸€ä¸ªå½“å¹´ç”¨6ä¸ªæœˆé€ŸæˆNOIPç„¶åæ‹¿äº†245çš„fwè€Œå·²</del></p><h2 id="5-XNUCA2018-Warmup"><a href="#5-XNUCA2018-Warmup" class="headerlink" title="5.[XNUCA2018]Warmup"></a>5.[XNUCA2018]Warmup</h2><p>è¿™é“é¢˜ç»™å‡ºäº†$6$ä¸ªäººçš„RSAåŠ å¯†åçš„$e,n,c$ï¼Œä»”ç»†è§‚å¯Ÿçš„è¯å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬å››ä¸ªçš„$n$æ˜¯ç›¸ç­‰çš„ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä¸Šå…±æ¨¡æ”»å‡»çš„è„šæœ¬è§£å†³æœ€åçš„flag</p><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6.æ€»ç»“"></a>6.æ€»ç»“</h2><p>æ€»ä¹‹ï¼Œå¯’å‡4ç¯‡åˆ·é¢˜ç¬”è®°ï¼Œçš„ç¡®è®©è‡ªå·±å­¦åˆ°äº†ä¸å°‘ä¸œè¥¿ã€‚æ˜å¤©åˆæ­ç”µçš„CTFï¼Œè¿˜æ˜¯è¦çœ‹çœ‹é¢˜ç›®çš„ï¼Œç»§ç»­å­¦ä¹ ä¸€ç‚¹CTFçŸ¥è¯†ï¼Œäº‰å–4æœˆè¿›æ ¡é˜Ÿå§ï¼ˆ<del>è¶è‡ªå·±å¤§ä¸€ä¸ŠåŠå¹´GPA 4.24ï¼Œå¯’å‡è¿˜æ²¡ä»€ä¹ˆäº‹æƒ…ï¼Œå¤šå­¦ç‚¹è‚¯å®šæ˜¯å¾ˆå¥½çš„</del></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Lfsr Notes</title>
    <link href="/2021/01/27/Lfsr-Notes/"/>
    <url>/2021/01/27/Lfsr-Notes/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ lfsrçš„ä¸€äº›ç¬”è®°"><a href="#huangx607087å­¦ä¹ lfsrçš„ä¸€äº›ç¬”è®°" class="headerlink" title="huangx607087å­¦ä¹ lfsrçš„ä¸€äº›ç¬”è®°"></a>huangx607087å­¦ä¹ lfsrçš„ä¸€äº›ç¬”è®°</h1><h2 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0.ç®€ä»‹"></a>0.ç®€ä»‹</h2><p>æœ¬ç¯‡blogç”¨åœ¨BUUä¸Šé¢åˆ·çš„ä¸¤é“é¢˜æ¥è®²è§£lfsr.</p><h2 id="1-åŸºæœ¬æ¦‚å¿µ"><a href="#1-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="1. åŸºæœ¬æ¦‚å¿µ"></a>1. åŸºæœ¬æ¦‚å¿µ</h2><p>LFSRï¼Œä¸­æ–‡åç§°å«åšçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼Œç”±å¤šä¸ªæ—¶é’Ÿå­˜å‚¨å…ƒä»¶å’Œä¸€ä¸ªåé¦ˆè·¯å¾„ç»„æˆã€‚å…¶ä¸­è§¦å‘å™¨çš„æ•°é‡åˆç§°ä¸º<strong>åº¦</strong>ã€‚</p><p>ä½œç”¨å°±æ˜¯å½“ç»™å®šå‰ä¸€ä¸ªçŠ¶æ€çš„è¾“å‡ºçš„æ—¶å€™ï¼Œè¿™ä¸ªè¾“å‡ºçŠ¶æ€ä¼šç»§ç»­å­˜å…¥ç§»ä½å¯„å­˜å™¨ï¼ˆåŒæ—¶æœ€æ—©çš„æ•°æ®ä¼šè¢«åˆ é™¤ï¼‰ã€‚</p><p><img src="/2021/01/27/Lfsr-Notes/S1.png" alt="S1"></p><p>lfsrçš„åŸºæœ¬Pythonå®ç°ä»£ç å¦‚ä¸‹ï¼ˆä»¥ä¸‹å°±æ˜¯ä¸€ä¸ª$24$ä½çš„lfsrï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr</span>(<span class="hljs-params">R,mask</span>):<br>    output = (R &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffff</span><br>    i=(R&amp;mask)&amp;<span class="hljs-number">0xffffff</span><br>    lastbit=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i!=<span class="hljs-number">0</span>:<br>        lastbit^=(i&amp;<span class="hljs-number">1</span>)<br>        i=i&gt;&gt;<span class="hljs-number">1</span><br>    output^=lastbit<br>    <span class="hljs-keyword">return</span> (output,lastbit)<br></code></pre></td></tr></table></figure><h2 id="2-è§£å†³LFSRé—®é¢˜çš„æ–¹æ³•"><a href="#2-è§£å†³LFSRé—®é¢˜çš„æ–¹æ³•" class="headerlink" title="2.è§£å†³LFSRé—®é¢˜çš„æ–¹æ³•"></a>2.è§£å†³LFSRé—®é¢˜çš„æ–¹æ³•</h2><h3 id="PART-1-24digs"><a href="#PART-1-24digs" class="headerlink" title="PART 1[24digs]"></a>PART 1[24digs]</h3><p>å½“lfsrçš„ä½æ•°ä¸è¶…è¿‡$30$ä½æ—¶ä¸”çŸ¥é“maskçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥é‡‡ç”¨æš´åŠ›æšä¸¾æ³•çˆ†ç ´seedï¼ˆåˆç§°keyï¼‰æ¯”å¦‚2018å¼ºç½‘æ¯streamgame1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">&quot;flag&#123;&quot;</span>)<br><span class="hljs-keyword">assert</span> flag.endswith(<span class="hljs-string">&quot;&#125;&quot;</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)==<span class="hljs-number">25</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr</span>(<span class="hljs-params">R,mask</span>):<br>    output = (R &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffff</span><br>    i=(R&amp;mask)&amp;<span class="hljs-number">0xffffff</span><br>    lastbit=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i!=<span class="hljs-number">0</span>:<br>        lastbit^=(i&amp;<span class="hljs-number">1</span>)<br>        i=i&gt;&gt;<span class="hljs-number">1</span><br>    output^=lastbit<br>    <span class="hljs-keyword">return</span> (output,lastbit)<br>R=<span class="hljs-built_in">int</span>(flag[<span class="hljs-number">5</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">2</span>)<br>mask=<span class="hljs-number">0x5311c</span><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;key&quot;</span>,<span class="hljs-string">&quot;ab&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>):<br>    tmp=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        (R,out)=lfsr(R,mask)<br>        tmp=(tmp &lt;&lt; <span class="hljs-number">1</span>)^out<br>    f.write(<span class="hljs-built_in">chr</span>(tmp))<br>f.close()<br></code></pre></td></tr></table></figure><h3 id="PART-2-32-digs"><a href="#PART-2-32-digs" class="headerlink" title="PART 2[32 digs]"></a>PART 2[32 digs]</h3><p>åœ¨çŸ¥é“maskä½†ä¸çŸ¥é“ç§å­çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æˆ‘ä»¬ä¸Šé¢æåˆ°çš„å¼å­è¿›è¡Œç§»é¡¹ï¼Œå°±å¯ä»¥æ±‚å‡ºä¹‹å‰è¢«ä¸¢å¼ƒçš„ä¸€ä¸ªæ¯”ç‰¹ä½ï¼Œè¿›è€Œä¸æ–­è¿­ä»£å°±å¯ä»¥å¾—åˆ°åé¢çš„æ¯”ç‰¹ä½ï¼Œå…¸å‹ä¾‹é¢˜ä¸º<strong>2018 CISCN åˆèµ› oldstreamgame</strong></p><p>çœ‹ä¸€ä¸‹é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = <span class="hljs-string">&quot;flag&#123;xxxxxxxxxxxxxxxx&#125;&quot;</span><br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">&quot;flag&#123;&quot;</span>)<br><span class="hljs-keyword">assert</span> flag.endswith(<span class="hljs-string">&quot;&#125;&quot;</span>)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag)==<span class="hljs-number">14</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr</span>(<span class="hljs-params">R,mask</span>):<br>    output = (R &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffffff</span><br>    i=(R&amp;mask)&amp;<span class="hljs-number">0xffffffff</span><br>    lastbit=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i!=<span class="hljs-number">0</span>:<br>        lastbit^=(i&amp;<span class="hljs-number">1</span>)<br>        i=i&gt;&gt;<span class="hljs-number">1</span><br>    output^=lastbit<br>    <span class="hljs-keyword">return</span> (output,lastbit)<br>R=<span class="hljs-built_in">int</span>(flag[<span class="hljs-number">5</span>:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>mask = <span class="hljs-number">0b10100100000010000000100010010100</span><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;key&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    tmp=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        (R,out)=lfsr(R,mask)<br>        tmp=(tmp &lt;&lt; <span class="hljs-number">1</span>)^out<br>    f.write(<span class="hljs-built_in">chr</span>(tmp))<br>f.close()<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬çŸ¥é“äº†maskçš„å€¼ï¼Œè€Œflagåˆ™ä¸ºlfsrçš„ç§å­ï¼Œé•¿åº¦ä¸º$32$ä½ã€‚è™½ç„¶çˆ†ç ´ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œä½†æ­¤å¤„ä¸ä½¿ç”¨çˆ†ç ´åšæ³•ï¼ŒäºŒæ˜¯é€’æ¨æ±‚å‡ºlfsrçš„ç§å­ã€‚</p><p>$32$ä½çš„lfsrï¼Œå‘Šè¯‰äº†æˆ‘ä»¬åªéœ€è¦çŸ¥é“è¾“å‡ºçš„æœ€å¼€å§‹çš„$32$ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€’æ¨æ±‚å‡ºseedï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>mask = <span class="hljs-number">0b10100100000010000000100010010100</span><br>b = <span class="hljs-string">&#x27;&#x27;</span><br>N = <span class="hljs-number">32</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;key.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    b = f.read()<br>key = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bin</span>(bytes_to_long(b)))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N // <span class="hljs-number">8</span>):<br>    t = b[i]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        key += <span class="hljs-built_in">str</span>(t &gt;&gt; j &amp; <span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(key)<br>idx = <span class="hljs-number">0</span><br>ans = <span class="hljs-string">&quot;&quot;</span><br>key = key[<span class="hljs-number">31</span>] + key[:<span class="hljs-number">32</span>]<br><span class="hljs-keyword">while</span> idx &lt; <span class="hljs-number">32</span>:<br>    tmp = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        <span class="hljs-keyword">if</span> mask &gt;&gt; i &amp; <span class="hljs-number">1</span>:<br>            tmp ^= <span class="hljs-built_in">int</span>(key[<span class="hljs-number">31</span> - i])<br>    ans = <span class="hljs-built_in">str</span>(tmp) + ans<br>    idx += <span class="hljs-number">1</span><br>    key = key[<span class="hljs-number">31</span>] + <span class="hljs-built_in">str</span>(tmp) + key[<span class="hljs-number">1</span>:<span class="hljs-number">31</span>]<br>num = <span class="hljs-built_in">int</span>(ans, <span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span> (<span class="hljs-built_in">hex</span>(num))<br></code></pre></td></tr></table></figure><p><strong>Update 2021.7.29 å¢åŠ ä¸€ä¸ªæ›´ç®€å•æ˜“æ‡‚çš„è„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padbin</span>(<span class="hljs-params">x,l=<span class="hljs-number">32</span></span>):<br>    s=<span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(s)&lt;l):<br>        s=(l-<span class="hljs-built_in">len</span>(s))*<span class="hljs-string">&#x27;0&#x27;</span>+s<br>    <span class="hljs-keyword">return</span> s<br>mask=padbin(<span class="hljs-number">0x80000057</span>)<br>state=padbin(<span class="hljs-number">0x155a796b</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    s=<span class="hljs-built_in">int</span>(state[<span class="hljs-number">0</span>])<br>    <span class="hljs-comment">#print(len(state),len(mask))</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>):<br>        s^=<span class="hljs-built_in">int</span>(mask[j])&amp;<span class="hljs-built_in">int</span>(state[j+<span class="hljs-number">1</span>])<br>    state=state+<span class="hljs-built_in">str</span>(s&amp;<span class="hljs-number">1</span>) <br>    state=state[<span class="hljs-number">1</span>:]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(state,<span class="hljs-number">2</span>))[<span class="hljs-number">2</span>:])<br></code></pre></td></tr></table></figure><h3 id="PART-3-64-digs"><a href="#PART-3-64-digs" class="headerlink" title="PART 3[64 digs]"></a>PART 3[64 digs]</h3><p>å¯ä»¥æ±‚å‡ºmaskçš„ï¼Œä¾‹é¢˜ä¸º**[AFCTF2018]Tiny LFSR**ï¼Œ64ä½æ˜¯æ— æ³•çˆ†ç ´çš„</p><p>è¯¦ç»†å†…å®¹è¯·è§æ–‡ç« <strong>21Jan2</strong>ï¼Œå‘å¸ƒæ—¶é—´ä¸º2021.1.21</p><h3 id="PART-4-256-digs"><a href="#PART-4-256-digs" class="headerlink" title="PART 4[256 digs]"></a>PART 4[256 digs]</h3><p>æˆ‘ä»¬æ¥çœ‹è¿™æ ·ä¸€é“é¢˜ç›®**[De1CTF2019]Babylfsr**</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> KEY,FLAG,MASK<br><span class="hljs-keyword">assert</span>(FLAG==<span class="hljs-string">&quot;de1ctf&#123;&quot;</span>+hashlib.sha256(<span class="hljs-built_in">hex</span>(KEY)[<span class="hljs-number">2</span>:].rstrip(<span class="hljs-string">&#x27;L&#x27;</span>)).hexdigest()+<span class="hljs-string">&quot;&#125;&quot;</span>)<br><span class="hljs-keyword">assert</span>(FLAG[<span class="hljs-number">7</span>:<span class="hljs-number">11</span>]==<span class="hljs-string">&#x27;1224&#x27;</span>)<br>LENGTH = <span class="hljs-number">256</span><br><span class="hljs-keyword">assert</span>(KEY.bit_length()==LENGTH)<br><span class="hljs-keyword">assert</span>(MASK.bit_length()==LENGTH)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">m</span>):<br>    pad_length = <span class="hljs-number">8</span> - <span class="hljs-built_in">len</span>(m)<br>    <span class="hljs-keyword">return</span> pad_length*<span class="hljs-string">&#x27;0&#x27;</span>+m<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">lfsr</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, init, mask, length</span>):<br>        <span class="hljs-variable language_">self</span>.init = init<br>        <span class="hljs-variable language_">self</span>.mask = mask<br>        <span class="hljs-variable language_">self</span>.lengthmask = <span class="hljs-number">2</span>**(length+<span class="hljs-number">1</span>)-<span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        nextdata = (<span class="hljs-variable language_">self</span>.init &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-variable language_">self</span>.lengthmask <br>        i = <span class="hljs-variable language_">self</span>.init &amp; <span class="hljs-variable language_">self</span>.mask &amp; <span class="hljs-variable language_">self</span>.lengthmask <br>        output = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> i != <span class="hljs-number">0</span>:<br>            output ^= (i &amp; <span class="hljs-number">1</span>)<br>            i = i &gt;&gt; <span class="hljs-number">1</span><br>        nextdata ^= output<br>        <span class="hljs-variable language_">self</span>.init = nextdata<br>        <span class="hljs-keyword">return</span> output<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    l = lfsr(KEY,MASK,LENGTH)<br>    r = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">63</span>):<br>        b = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            b = (b&lt;&lt;<span class="hljs-number">1</span>)+l.<span class="hljs-built_in">next</span>()<br>        r += pad(<span class="hljs-built_in">bin</span>(b)[<span class="hljs-number">2</span>:])<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(r)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªé•¿åº¦ä¸º$256$ä½çš„lfsrå’Œé•¿åº¦ä¸º$504$ä½çš„è¾“å‡ºç»“æœï¼Œå¹¶å‘Šè¯‰ä½ KEYä»¥åŠFLAGçš„ä¸€äº›ç‰¹å¾ï¼ˆsha256åçš„å€¼å‰$4$ä½æ˜¯$1224_h$ï¼‰ã€‚</p><p>CTF WIKIæåˆ°ï¼šå¦‚æœæˆ‘ä»¬çŸ¥é“äº†$2n$ä½è¾“å‡ºç»“æœï¼Œå°±å¯ä»¥æŠŠmaskæ±‚å‡ºæ¥ï¼Œè¿›è€Œæ±‚å‡ºkeyï¼Œè¿™ä¸ªç®—æ³•å°±æ˜¯BMç®—æ³•ï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º$O(n)$ï¼Œ$n$ä¸ºlfsrçš„æ¯”ç‰¹ä½æ•°ï¼Œè¿™é“é¢˜æ˜¯$256$ã€‚</p><p><img src="/2021/01/27/Lfsr-Notes/S2.png" alt="S2"></p><p><img src="/2021/01/27/Lfsr-Notes/1.png" alt="1"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°maskçš„å€¼ï¼Œå¦‚ä¸‹çš„çŸ©é˜µè¿ç®—</p><p><img src="/2021/01/27/Lfsr-Notes/2.png" alt="2"></p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æ±‚å‡ºäº†maskå€¼ï¼Œç´§æ¥ç€å°±æ˜¯æ±‚keyå€¼äº†ã€‚</p><p>ç„¶åæˆ‘ä»¬å›åˆ°é¢˜ç›®ä¸­ï¼š$256$ä½çš„lfsrï¼Œæˆ‘ä»¬è¦çŸ¥é“$512$ä½æ‰å¯ä»¥æ±‚å‡ºæœ€åçš„ç»“æœï¼Œä½†ç›®å‰æˆ‘ä»¬åªçŸ¥é“äº†$504$ä½ï¼Œç¼ºå¤±$8$ä½ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥çˆ†ç ´æœ€å$8$ä½ï¼Œå¾—åˆ°$256$ä¸ªå¯èƒ½çš„maskå€¼ï¼Œç„¶åæˆ‘ä»¬å†ç”¨è¿™$256$ä¸ªmaskå€¼æ¢å¤å¾—åˆ°$256$ä¸ªkeyå€¼ï¼Œæ ¹æ®é¢˜ç›®ç»™å‡ºçš„çº¦æŸæ¡ä»¶å°±å¯ä»¥ç¡®å®šæœ€åçš„keyå€¼äº†ã€‚</p><p>ä¸Šé¢è®²çš„åº”è¯¥éƒ½ç®—æ˜¯æ¯”è¾ƒè¯¦ç»†çš„äº†ï¼Œç›´æ¥ä¸Šä¸€ä¸‹sageçš„è„šæœ¬ï¼Œæ³¨æ„$\det&#x3D;0$æ±‚é€†çŸ©é˜µä¼šæŠ¥é”™ï¼Œå› æ­¤è¦è¿›è¡Œä¸€æ¬¡$\det!&#x3D;0$çš„åˆ¤æ–­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad8</span>(<span class="hljs-params">L,K</span>):<br>    C=[]<br>    <span class="hljs-keyword">while</span> K&gt;<span class="hljs-number">0</span>:<br>        C=[K&amp;<span class="hljs-number">1</span>]+C<br>        K&gt;&gt;=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(C)&lt;<span class="hljs-number">8</span>):<br>        C=[<span class="hljs-number">0</span>]*(<span class="hljs-number">8</span>-<span class="hljs-built_in">len</span>(C))+C<br>    <span class="hljs-keyword">return</span> L+C<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>    num=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        num=num*<span class="hljs-number">2</span>+x[i]<br>    <span class="hljs-keyword">return</span> num<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">mask,key</span>):<br>    idx,ans=<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;&#x27;</span><br>    key=[key[<span class="hljs-number">255</span>]]+key[:<span class="hljs-number">256</span>]<br>    <span class="hljs-keyword">while</span> idx&lt;<span class="hljs-number">256</span>:<br>        tmp=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            <span class="hljs-keyword">if</span> mask&gt;&gt;i&amp;<span class="hljs-number">1</span>:<br>                tmp=(tmp+key[<span class="hljs-number">255</span>-i])%<span class="hljs-number">2</span><br>        ans=<span class="hljs-built_in">str</span>(tmp)+ans<br>        idx+=<span class="hljs-number">1</span><br>        key=[key[<span class="hljs-number">255</span>]]+[tmp]+key[<span class="hljs-number">1</span>:<span class="hljs-number">255</span>]<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(ans,<span class="hljs-number">2</span>)<br>                <br><span class="hljs-comment">#---------MAIN BELOW---------#</span><br>S=[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    Scnt=pad8(S,i)<br>    T=[]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">257</span>):<br>        T.append(Scnt[j:j+<span class="hljs-number">256</span>])<br>    X=matrix(GF(<span class="hljs-number">2</span>),T[<span class="hljs-number">0</span>:<span class="hljs-number">256</span>])<br>    B=matrix(GF(<span class="hljs-number">2</span>),T[<span class="hljs-number">256</span>])<br>    <span class="hljs-keyword">if</span>(det(X)!=<span class="hljs-number">0</span>):<br>        C=B*(X^-<span class="hljs-number">1</span>)<br>        D=matrix(ZZ,C)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(solve(f(D[<span class="hljs-number">0</span>]),S[:<span class="hljs-number">256</span>])))<br></code></pre></td></tr></table></figure><p>åªç»™å‡ºäº†æ‰€æœ‰å¯èƒ½çš„keyå€¼ï¼Œæœ€åç­›é€‰å¾ˆç®€å•çš„ï¼Œè„šæœ¬å°±ä¸æ”¾äº†</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>21Jan3</title>
    <link href="/2021/01/26/21Jan3/"/>
    <url>/2021/01/26/21Jan3/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å¯’å‡çš„åˆ‡é¢˜3"><a href="#huangx607087å¯’å‡çš„åˆ‡é¢˜3" class="headerlink" title="huangx607087å¯’å‡çš„åˆ‡é¢˜3"></a>huangx607087å¯’å‡çš„åˆ‡é¢˜3</h1><h2 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0.ç®€ä»‹"></a>0.ç®€ä»‹</h2><p>è¿‘æœŸBUUå·²ç»ä¸Šäº†1500åˆ†ï¼Œè€Œszxåœ¨yydsfmyyçš„æŒ‡å¯¼ä¸‹ï¼Œè¿›æ­¥éå¸¸å¿«ï¼Œå·²ç»æˆä¸ºäº†pwnç¥ã€‚è€Œjiangjiangä½œä¸ºä¸€ä¸ªG1DALAOä¹Ÿåœ¨REæœ‰äº†å¾ˆå¤šè¿›å±•ã€‚ã€‚ã€‚ã€‚</p><h2 id="1-NCTF2020-RDH"><a href="#1-NCTF2020-RDH" class="headerlink" title="1.[NCTF2020] RDH"></a>1.[NCTF2020] RDH</h2><p>ä¸€ä¸ªé¢˜ç›®ï¼Œåˆ«äººåšäº†ä¸¤å¤©ï¼Œæˆ‘åšäº†ä¸¤ä¸ªæœˆã€‚</p><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹é¢˜ç›®è„šæœ¬ä»£ç ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œè¿™è²Œä¼¼æ˜¯ä¸ªPaillieråŠ å¯†ç®—æ³•ï¼ŒåŠ å¯†çš„éƒ¨åˆ†æ–¹æ³•ä¸RSAç±»ä¼¼ï¼š</p><p>åŠ å¯†æ–¹æ³•å¾ˆç®€å•ï¼Œé¦–å…ˆä¸RSAä¸€æ ·ï¼Œé€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•°$p,q$ï¼Œè®¡ç®—$n&#x3D;pq$ï¼Œå…¶ä¸­$\gcd(n,(p-1)(q-1))&#x3D;1$ã€‚ç„¶åè®¡ç®—$\lambda&#x3D;\text{lcm}(p-1,q-1)$ã€‚</p><p>ç„¶åé€‰æ‹©éšæœºæ•´æ•°$g$ã€‚è®¡ç®—å¯†æ–‡$E(m,r)c\equiv g^mr^n\pmod {n^2}$ï¼Œå…¶ä¸­$r$æ˜¯éšæœºæ•´æ•°</p><p>è§£å¯†æ–¹æ³•ä¸º$D(c,\lambda)&#x3D;m\equiv \dfrac{L(c^\lambda \mod n^2)}{L(g^\lambda \mod n^2)}\pmod n$ï¼Œå…¶ä¸­$L(x)&#x3D;\dfrac{x-1}{n}$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> lcm<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getMyPrime</span>(<span class="hljs-params">nbits</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">genProduct</span>(<span class="hljs-params">nbits</span>):<br>        p = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> p.bit_length() &lt; nbits:<br>            p *= random.choice(sieve_base)<br>        <span class="hljs-keyword">return</span> p<br>    P = genProduct(nbits)<br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> isPrime(P-<span class="hljs-number">1</span>):<br>        P = genProduct(nbits)<br>    <span class="hljs-keyword">return</span> (P-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Homo</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        p, q = getMyPrime(<span class="hljs-number">512</span>), getMyPrime(<span class="hljs-number">512</span>)<br>        n = p*q<br>        g = random.randint(<span class="hljs-number">1</span>, n*n)<br>        <span class="hljs-keyword">while</span> GCD(<span class="hljs-variable language_">self</span>.L(<span class="hljs-built_in">pow</span>(g, lcm(p-<span class="hljs-number">1</span>, q-<span class="hljs-number">1</span>), n*n), n), n) != <span class="hljs-number">1</span>:<br>            g = random.randint(<span class="hljs-number">1</span>, n*n)<br>        <span class="hljs-variable language_">self</span>.g, <span class="hljs-variable language_">self</span>.n = g, n<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>, n)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;g =&quot;</span>, g)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">enc</span>(<span class="hljs-params">self, m</span>):<br>        n = <span class="hljs-variable language_">self</span>.n<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">pow</span>(<span class="hljs-variable language_">self</span>.g, <span class="hljs-built_in">int</span>(m), n*n)*<span class="hljs-built_in">pow</span>(random.randint(<span class="hljs-number">1</span>, n), n, n*n)) % (n*n)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">L</span>(<span class="hljs-params">self, u, n</span>): <span class="hljs-keyword">return</span> (u-<span class="hljs-number">1</span>)//n<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_img</span>(<span class="hljs-params">homo, img_array</span>):<br>    cip_list = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(img_array)):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(img_array[i])):<br>            cip_list.append(homo.enc(img_array[i][j]))<br>    <span class="hljs-keyword">return</span> cip_list<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_flag</span>(<span class="hljs-params">homo, flag</span>):<br>    flag_bin = <span class="hljs-built_in">bin</span>(flag)[<span class="hljs-number">2</span>:]<br>    cip_list = [homo.enc(<span class="hljs-built_in">int</span>(i) &lt;&lt; <span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag_bin]<br>    <span class="hljs-keyword">return</span> cip_list<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    homo = Homo()<br>    img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./img.png&quot;</span>).convert(<span class="hljs-string">&quot;L&quot;</span>) <span class="hljs-comment"># 56x56</span><br>    img_array = np.array(img)<br>    img_enc = encrypt_img(homo, img_array)<br>    flag = bytes_to_long(flag.encode())<br>    flag_enc = encrypt_flag(homo, flag)<br>    <br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(img_enc) &gt; <span class="hljs-built_in">len</span>(flag_enc)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(img_enc)):<br>            <span class="hljs-keyword">if</span> i &lt; <span class="hljs-built_in">len</span>(flag_enc):<br>                enc = (flag_enc[i]*img_enc[i]) % (homo.n**<span class="hljs-number">2</span>)<br>                f.write(<span class="hljs-built_in">hex</span>(enc)[<span class="hljs-number">2</span>:]+<span class="hljs-string">&quot;\n&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                f.write(<span class="hljs-built_in">hex</span>(img_enc[i])[<span class="hljs-number">2</span>:]+<span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-comment"># n = 18434491463536053807355381425234564739214857081161321309756933006496704225386021314592003940717664842835425875706674652882353813796736161102105318696602774157554627232038142092845118667433422811370679163251506433284182749390704212211677891535882993540750379419384629735499044085104591893176847835387567644762636961</span><br><span class="hljs-comment"># g = 99894228586367782940715460732971967417359410558715186789679488951080212107512884192976002563404881263875114900183845944243751294600634946131559701908524899495387780188074842981190381617301097312646907480816373003121403029154865843313001145153263200356271270964096284006748227606839491672635131818273934109984977288621523498782962389115299664149676881349445940131040928322172748228670542470966453917916224551852329336572423059849239115479150176538160893340622774682474615303826972971312087884483400100816655408278649954266707268236152380355955111697822333005733513834283677509165970313043388621472231706074701389916165894223877</span><br></code></pre></td></tr></table></figure><p>ä»åŠ å¯†ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼šè¿™ä¸ªç”Ÿæˆçš„ç´ æ•°$p,q$æ»¡è¶³$p+1,q+1$ä¸ºå…‰æ»‘çš„æ•°å­—ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨PrimeFacæ’ä»¶åœ¨linuxç¯å¢ƒä¸‹åˆ†è§£å› æ•°ï¼Œåœ¨è‡ªå·±çš„ç”µè„‘<code>Lenovo Legion Y7000(512G,16G)</code>ä¸Šè·‘å¤§æ¦‚$9$åˆ†é’Ÿå·¦å³</p><p><img src="/2021/01/26/21Jan3/1.jpg" alt="1"></p><p>åˆ†è§£å› æ•°åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸‹é¢çš„è„šæœ¬è¿›è¡Œè§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> n,p,q,g<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">L</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> (x-<span class="hljs-number">1</span>)//(n)<br><span class="hljs-comment">#-----MAIN BELOW-----#</span><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)<br>b=f.read()<br>f.close()<br>C,M=[],[]<br>s=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(b)):<br>    <span class="hljs-keyword">if</span> b[i]==<span class="hljs-string">&#x27;\n&#x27;</span>:<br>        C.append(<span class="hljs-built_in">int</span>(s,<span class="hljs-number">16</span>))<br>        s=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        s=s+b[i]<br>lm=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)//GCD(p-<span class="hljs-number">1</span>,q-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(C)):<br>    <span class="hljs-keyword">if</span>(i%<span class="hljs-number">100</span>==<span class="hljs-number">0</span>):<br>        <span class="hljs-built_in">print</span>(i)<br>    m=L(<span class="hljs-built_in">pow</span>(C[i],lm,n*n))*inverse(L(<span class="hljs-built_in">pow</span>(g,lm,n*n)),n)%n<br>    M.append(m)<br>    <span class="hljs-built_in">print</span>(M)<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¾ˆå¤šçš„æ•°æ®ï¼Œåœ¨è®°äº‹æœ¬ç”¨$16$è¿›åˆ¶æ‰“å¼€æ—¶è¿™æ ·çš„</p><p><img src="/2021/01/26/21Jan3/2.png" alt="2"></p><p>å¾ˆæ˜¾ç„¶ï¼Œæœ‰äº›æ•°å­—å¤§äºç­‰äº$100_h$ï¼Œä¸€å¼ å›¾ç‰‡æ­£å¸¸çš„ç°åº¦å€¼åº”è¯¥æ˜¯åœ¨$[00_h,\text{FF}_h]$ä¹‹é—´ï¼Œæ ¹æ®è¿™ä¸ªåŠ å¯†ç®—æ³•çš„åŠ æ³•åŒæ€æ€§ä¸åŠ å¯†ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºé‚£äº›å¤§äº$\text{FF}_h$çš„æ•°å­—åº”è¯¥å¯¹åº”çš„æ˜¯flagå­—èŠ‚ä¸­çš„$1$</p><p>å‘ç°æœ€åflagæ¯”ç‰¹æ•°é™¤ä»¥$8$çš„ä½™æ•°æ˜¯$1$ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨æœ€å‰é¢è¡¥ä¸€ä¸ª$0$ï¼Œå¾—åˆ°flagä¸º<code>NCTF&#123;R3v3r5ibLe_D4t4_H1d1ng_1N_P4illi3r_Crypt0sy5t3m&#125;</code></p><h2 id="2-b01lers2020-safety-in-numbers"><a href="#2-b01lers2020-safety-in-numbers" class="headerlink" title="2.[b01lers2020]safety_in_numbers"></a>2.[b01lers2020]safety_in_numbers</h2><p>PublicKeyè¯»å–åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°$n$æœ‰ä¸€åƒå¤šä¸‡ä½ï¼Œ$e&#x3D;65537$ï¼Œ$c$æœ‰$900$å¤šä¸‡ä½ï¼Œ$\ln n-\ln c &gt; 400000$ï¼Œæ­¤æ—¶ç›´æ¥ç”¨gmpy2ä¸­çš„irootå‡½æ•°å¯¹$c$è¿›è¡Œå¼€æ ¹å³å¯ã€‚</p><p>ä¸è¿‡æ³¨æ„åˆ°è¿™é‡Œæœ‰ä¸ª<code>byteorder=&#39;little&#39;</code>ï¼Œä¹Ÿå°±æ„å‘³ç€å†™åœ¨æœ€åçš„é‚£ä¸ªå­—èŠ‚ä»£è¡¨ç€æœ€é«˜ä½ï¼Œè¿™æ ·æ‰èƒ½å¾—åˆ°æ­£ç¡®ç­”æ¡ˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> E <span class="hljs-keyword">import</span> e<br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.enc&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    cipher = f.read()<br>c = <span class="hljs-built_in">int</span>.from_bytes(cipher, byteorder=<span class="hljs-string">&#x27;little&#x27;</span>)<br><span class="hljs-built_in">print</span>(iroot(c,e)[<span class="hljs-number">0</span>])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    <span class="hljs-built_in">input</span>()<br></code></pre></td></tr></table></figure><h2 id="3-INSHack2019-Yet-Another-RSA-Challenge-Part-1"><a href="#3-INSHack2019-Yet-Another-RSA-Challenge-Part-1" class="headerlink" title="3.[INSHack2019]Yet Another RSA Challenge - Part 1"></a>3.[INSHack2019]Yet Another RSA Challenge - Part 1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> subprocess<br>p = subprocess.check_output(<span class="hljs-string">&#x27;openssl prime -generate -bits 2048 -hex&#x27;</span>)<br>q = subprocess.check_output(<span class="hljs-string">&#x27;openssl prime -generate -bits 2048 -hex&#x27;</span>)<br>flag = <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;INSA&#123;REDACTED&#125;&#x27;</span>.encode(<span class="hljs-string">&#x27;hex&#x27;</span>), <span class="hljs-number">16</span>)<br>N = <span class="hljs-built_in">int</span>(p,<span class="hljs-number">16</span>) * <span class="hljs-built_in">int</span>(q,<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span> N<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;0x&#x27;</span>+p.replace(<span class="hljs-string">&#x27;9F&#x27;</span>,<span class="hljs-string">&#x27;FC&#x27;</span>)<br><span class="hljs-built_in">print</span> <span class="hljs-built_in">pow</span>(flag,<span class="hljs-number">65537</span>,N)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®éš¾åº¦è¾ƒä¸ºç®€å•ï¼Œç»™å‡ºäº†ä¸€ä¸ªå°†$p$ä¸­æ‰€æœ‰$\text{9F}_h$å­—èŠ‚æ›¿æ¢æˆäº†$\text{FC}_h$å­—èŠ‚ï¼ŒæŸ¥äº†ä¸€ä¸‹ç»™å‡ºçš„æ•°å­—ä¸­ä¸€å…±æœ‰$4$ä¸ª$\text{FC}_h$å­—èŠ‚ï¼Œå› æ­¤ä¸€å…±æœ‰$16$ä¸ªå¯èƒ½çš„çš„æ•°å­—ï¼Œç›´æ¥æšä¸¾ä¸€ä¸‹çœ‹çœ‹å“ªä¸ªæ•´é™¤$n$å°±å¯ä»¥æŠŠ$n$åˆ†è§£äº†ï¼Œéš¾åº¦å¾ˆä½ã€‚</p><h2 id="4-AFCTF2018-ä¸€é“æœ‰è¶£çš„é¢˜ç›®"><a href="#4-AFCTF2018-ä¸€é“æœ‰è¶£çš„é¢˜ç›®" class="headerlink" title="4.[AFCTF2018]ä¸€é“æœ‰è¶£çš„é¢˜ç›®"></a>4.[AFCTF2018]ä¸€é“æœ‰è¶£çš„é¢˜ç›®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#åŠ å¯†ä»£ç </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">plainText</span>):<br>    space = <span class="hljs-number">10</span><br>    cipherText = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plainText)):<br>        <span class="hljs-keyword">if</span> i + space &lt; <span class="hljs-built_in">len</span>(plainText) - <span class="hljs-number">1</span>:<br>            cipherText += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(plainText[i]) ^ <span class="hljs-built_in">ord</span>(plainText[i + space]))<br>        <span class="hljs-keyword">else</span>:<br>            cipherText += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(plainText[i]) ^ <span class="hljs-built_in">ord</span>(plainText[space]))<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(plainText[i]) % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>            space += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            space -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> cipherText<br><span class="hljs-comment"># å¯†ç </span><br><span class="hljs-comment">#00| 15 12 0d 1a 0a</span><br><span class="hljs-comment">#05| 08 10 01 0a 03</span><br><span class="hljs-comment">#10| 1d 3e 31 00 0d</span><br><span class="hljs-comment">#15| 1d 17 0d 17 3b</span><br><span class="hljs-comment">#20| 0d 17 3b 0c 07</span><br><span class="hljs-comment">#25| 06 02 06</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æ ¹æ®æœ€åè¾“å‡ºçš„å†…å®¹å¾—åˆ°flagé•¿åº¦æ˜¯$28$ä½ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥ç›²çŒœ<code>flag[:6]=&#39;afctf&#123;&#39;,flag[-1]=&#39;&#125;&#39;</code></p><p>ç„¶åæˆ‘ä»¬å…‰<code>afctf&#123;</code>è¿™ä¸ªå­—æ®µè·‘ä¸€è¾¹ï¼Œå¾—åˆ°äº†è¿™æ ·çš„å†…å®¹ï¼š<code>afctf&#123;cr??t?n?l?sis_isih??_&#125;</code>ï¼ˆé—®å·å¤„è¡¨ç¤ºæœªçŸ¥å­—ç¬¦ï¼‰ã€‚</p><p>ç„¶åæˆ‘ä»¬ç”¨ä¸‹é¢çš„C++ç¨‹åºæŠŠè¿™ä¸ªå­—ç¬¦å¸¦è¿›å»ï¼Œè€ƒè™‘åˆ°æœ€åä¸€ä¸ªä¸‹åˆ’çº¿å¯èƒ½æ˜¯é”™çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠæœ€åä¸€ä¸ªä¸‹åˆ’çº¿ä¹Ÿæ”¹æˆé—®å·</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">char</span> c[<span class="hljs-number">35</span>]=&#123;<span class="hljs-number">0x15</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x1a</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x1d</span>,<span class="hljs-number">0x3e</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x1d</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x3b</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x3b</span>,<span class="hljs-number">0xc</span> ,<span class="hljs-number">07</span> ,<span class="hljs-number">06</span> ,<span class="hljs-number">02</span>,<span class="hljs-number">06</span>&#125;;<br><span class="hljs-type">char</span> m[<span class="hljs-number">35</span>]=<span class="hljs-string">&quot;afctf&#123;cr??t?n?l?sis_isih???&#125;&quot;</span>;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,s=<span class="hljs-number">10</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;=<span class="hljs-number">27</span>;i++)<br>&#123;<br><span class="hljs-keyword">if</span>(m[i+s]==<span class="hljs-string">&#x27;?&#x27;</span>&amp;&amp;m[i]!=<span class="hljs-string">&#x27;?&#x27;</span>)<br>m[i+s]=m[i]^c[i];<br><span class="hljs-keyword">if</span>(m[i+s]!=<span class="hljs-string">&#x27;?&#x27;</span>&amp;&amp;m[i]==<span class="hljs-string">&#x27;?&#x27;</span>)<br>m[i]=m[i+s]^c[i];<br><span class="hljs-keyword">if</span>(m[i]!=<span class="hljs-string">&#x27;?&#x27;</span>)<br>&#123;<br><span class="hljs-keyword">if</span>(m[i]%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>)<br>++s;<br><span class="hljs-keyword">else</span> <br>--s;<br>&#125;<br>&#125;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;=<span class="hljs-number">27</span>;i++)<br>cout&lt;&lt;m[i];<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure><p>ç„¶åè·‘å‡ºæ¥äº†è¿™ä¸ªç©æ„ï¼šafctf{cryptWn?l&#96;sis_isiha}</p><p>ç›²çŒœæœ€åä¸€ä¸ªå•è¯æ˜¯hardï¼Œå¸¦è¿›å»ï¼Œå¾—<code>afctf&#123;cryptWnalysis_isihard&#125;</code>ã€‚</p><p>è°ƒæ•´ä¸€ä¸‹ï¼Œå¾—<code>afctf&#123;cryptanalysis_is_hard&#125;</code>å³å¯å¾—å‡ºç­”æ¡ˆ</p><h2 id="5-V-N2020-å…¬å¼€èµ›-Backtrace"><a href="#5-V-N2020-å…¬å¼€èµ›-Backtrace" class="headerlink" title="5.[V&amp;N2020 å…¬å¼€èµ›]Backtrace"></a>5.[V&amp;N2020 å…¬å¼€èµ›]Backtrace</h2><p>é¢˜ç›®ç»™å‡ºçš„ä»£ç <del>éå¸¸ç®€å•</del>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br>flag = <span class="hljs-string">&quot;flag&#123;&quot;</span> + <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">32</span>)) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)) + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>):<br>        f.write(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">32</span>)) + <span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p> ä¸€å¼€å§‹æˆ‘ä¹Ÿä¸çŸ¥é“è¿™é“é¢˜åº”è¯¥æ€ä¹ˆè§£ï¼Œç›´åˆ°çœ‹åˆ°äº†è¿™ä¸ªï¼š</p><img src="/2021/01/26/21Jan3/4.jpg" alt="3" style="zoom:50%;"><p>æ‰çŸ¥é“è¿™æ˜¯ä¸€ä¸ªæ¢…æ£®æ—‹è½¬ç®—æ³•ï¼Œç»™å‡ºäº†$1000$ä¸ªçŠ¶æ€ï¼Œä½†å‰$4$ä¸ªçŠ¶æ€è¢«åšæˆäº†flagï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ— æ³•å¾—çŸ¥ä¸€ä¸ªå®Œæ•´çš„$624$ä¸ªçŠ¶æ€</p><p>ä¸è¿‡æˆ‘ä»¬æ—¢ç„¶çŸ¥é“äº†ç¼–å·ä¸º$624,625,626,627$çš„å››ä¸ªçŠ¶æ€ï¼Œå°±å¾ˆå®¹æ˜“ä¼šæ¨åˆ°$0,1,2,3$è¿™å››ä¸ªçŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„flagï¼Œè„šæœ¬ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><span class="hljs-comment"># right shift inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right</span>(<span class="hljs-params">res,shift,mask=<span class="hljs-number">0xffffffff</span>,bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//shift):<br>        tmp = res ^ tmp&gt;&gt;shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-comment"># left shift inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left</span>(<span class="hljs-params">res,shift,mask=<span class="hljs-number">0xffffffff</span>,bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//shift):<br>        tmp = res ^ tmp &lt;&lt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">backtrace</span>(<span class="hljs-params">cur</span>):<br>    high = <span class="hljs-number">0x80000000</span><br>    low = <span class="hljs-number">0x7fffffff</span><br>    mask = <span class="hljs-number">0x9908b0df</span><br>    state = cur<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        tmp = state[i+<span class="hljs-number">624</span>]^state[i+<span class="hljs-number">397</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        <span class="hljs-comment"># recover highest bit</span><br>        res = tmp&amp;high<br>        <span class="hljs-comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span><br>        tmp = state[i-<span class="hljs-number">1</span>+<span class="hljs-number">624</span>]^state[i+<span class="hljs-number">396</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        res |= (tmp)&amp;low<br>        state[i] = res<br>    <span class="hljs-keyword">return</span> state<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover_state</span>(<span class="hljs-params">out</span>):<br>    state = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> out:<br>        i = inverse_right(i,<span class="hljs-number">18</span>)<br>        i = inverse_left(i,<span class="hljs-number">15</span>,<span class="hljs-number">0xefc60000</span>)<br>        i = inverse_left(i,<span class="hljs-number">7</span>,<span class="hljs-number">0x9d2c5680</span>)<br>        i = inverse_right(i,<span class="hljs-number">11</span>)<br>        state.append(i)<br>    <span class="hljs-keyword">return</span> state<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>).readlines()<br>c = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>):<br>    c.append(<span class="hljs-built_in">int</span>(f[i].strip()))<br>partS = recover_state(c)<br>state = backtrace([<span class="hljs-number">0</span>]*<span class="hljs-number">4</span>+partS)[:<span class="hljs-number">624</span>]<br><span class="hljs-comment"># print(state)</span><br>prng = Random()<br>prng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">0</span>]),<span class="hljs-literal">None</span>))<br>flag = <span class="hljs-string">&quot;flag&#123;&quot;</span> + <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">str</span>(prng.getrandbits(<span class="hljs-number">32</span>)) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)) + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6.æ€»ç»“"></a>6.æ€»ç»“</h2><p>å¯’å‡ç¬¬ä¸‰æ³¢é¢˜ç›®ï¼Œåé¢è¿˜è¦ç»§ç»­åŠ æ²¹ï¼ˆ</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DLP Notes 1</title>
    <link href="/2021/01/24/DLP-Notes-1/"/>
    <url>/2021/01/24/DLP-Notes-1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ ç¦»æ•£å¯¹æ•°çš„ç¬”è®°-1"><a href="#huangx607087å­¦ä¹ ç¦»æ•£å¯¹æ•°çš„ç¬”è®°-1" class="headerlink" title="huangx607087å­¦ä¹ ç¦»æ•£å¯¹æ•°çš„ç¬”è®° 1"></a>huangx607087å­¦ä¹ ç¦»æ•£å¯¹æ•°çš„ç¬”è®° 1</h1><h2 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0.ç®€ä»‹"></a>0.ç®€ä»‹</h2><p>è¿™ä¸¤å¤©å­¦å®Œäº† $\text{An Introduction to Mathematical Cryptography}$é‚£æœ¬ä¹¦çš„ç¬¬$2$ç« ç¦»æ•£å¯¹æ•°å†…å®¹ï¼Œåšä¸€ç‚¹ç‚¹ç¬”è®°ï¼Œ<del>é¡ºä¾¿æ°´ä¸€ç¯‡åšå®¢</del>ã€‚</p><h2 id="1-ç¦»æ•£å¯¹æ•°å¼•å…¥"><a href="#1-ç¦»æ•£å¯¹æ•°å¼•å…¥" class="headerlink" title="1.ç¦»æ•£å¯¹æ•°å¼•å…¥"></a>1.ç¦»æ•£å¯¹æ•°å¼•å…¥</h2><p>æ¦‚å¿µ1ï¼šç¦»æ•£å¯¹æ•°å°±æ˜¯è§£å†³å½¢å¦‚$g^x\equiv h \pmod p$çš„ä¸€ç±»æŒ‡æ•°åŒä½™æ–¹ç¨‹ï¼Œæœ€åçš„ç»“æœå¯ä»¥è®°ä½œ$\dfrac{\ln(h)}{\ln g}$,ä¾‹å¦‚ï¼Œ$3^2 \equiv 2 \pmod 7$,æ‰€ä»¥æœ‰$\dfrac{\ln(2)}{\ln3}\equiv 2 \pmod 7$ã€‚ç¦»æ•£å¯¹æ•°è™½ç„¶æ˜¯åœ¨æœ‰é™åŸŸä¸­è¿›è¡Œçš„ï¼Œä½†æ˜¯å®ƒåœ¨æœ‰é™åŸŸä¸­çš„è¿ç®—æ€§è´¨ä¸æ­£å¸¸å®æ•°èŒƒå›´å†…çš„è¿ç®—æ€§è´¨ä¸€æ ·ï¼Œæ¯”å¦‚$\dfrac{\ln(a)}{\ln g}+\dfrac{\ln(b)}{\ln g}&#x3D;\dfrac{\ln(ab)}{\ln g}$</p><p>æ¦‚å¿µ2ï¼šæœ¬åŸå…ƒï¼šæœ¬åŸå…ƒæ˜¯æŒ‡ä½¿å¾—$g^x\equiv 1 \pmod p$çš„æœ€å°éé›¶$x$å€¼ç­‰äº$p-1$çš„æ•°å­—ã€‚å…·ä½“å†…å®¹å¯è§åšå®¢ä¸­<strong>NumberTheory 4</strong>[2021.1.22] ä¸­çš„éƒ¨åˆ†å†…å®¹</p><h2 id="2-ç¦»æ•£å¯¹æ•°åœ¨å¯†ç å­¦ä¸­çš„åº”ç”¨"><a href="#2-ç¦»æ•£å¯¹æ•°åœ¨å¯†ç å­¦ä¸­çš„åº”ç”¨" class="headerlink" title="2.ç¦»æ•£å¯¹æ•°åœ¨å¯†ç å­¦ä¸­çš„åº”ç”¨"></a>2.ç¦»æ•£å¯¹æ•°åœ¨å¯†ç å­¦ä¸­çš„åº”ç”¨</h2><h3 id="EXP-1-Diffie-Hellmanå¯†é’¥äº¤æ¢"><a href="#EXP-1-Diffie-Hellmanå¯†é’¥äº¤æ¢" class="headerlink" title="EXP 1. Diffie-Hellmanå¯†é’¥äº¤æ¢"></a>EXP 1. Diffie-Hellmanå¯†é’¥äº¤æ¢</h3><p>Step 1ï¼šåŒæ–¹é€‰å®šä¸€ä¸ªæœ¬åŸå…ƒ$g$å’Œä¸€ä¸ªå¤§ç´ æ•°$p$</p><p>Step 2ï¼šAliceè®¡ç®—$A\equiv g^a \pmod p$ï¼ŒBobè®¡ç®—$B\equiv g^b \pmod p$ï¼Œå…¶ä¸­$a,b$åˆ†åˆ«ä¸ºAliceå’ŒBobç§˜å¯†éšæœºé€‰å–çš„æ•°å­—</p><p>Step 3ï¼šAliceæŠŠ$A$å‘é€ç»™Bobï¼ŒåŒæ—¶BobæŠŠ$B$å‘é€ç»™Alice</p><p>Step 4ï¼š Aliceï¼ŒBobåˆ†åˆ«è®¡ç®—$B^a$å’Œ$A^b$ï¼Œç”±äº$A^b&#x3D;B^a&#x3D;g^{ab}$ï¼Œå› æ­¤å¯ä»¥å®Œæˆå¯†é’¥äº¤æ¢</p><p>è¯¥å¯†é’¥äº¤æ¢è¿‡ç¨‹ä¸­ï¼Œå…¬é’¥ä¸º$g,p,A,B$ï¼Œç§é’¥ä¸º$a,b$ã€‚</p><p>åœ¨è¿™ä¸ªåº”ç”¨ä¸­ï¼Œç¦»æ•£å¯¹æ•°ä»…ä»…ç”¨äºäº¤æ¢å¯†é’¥ï¼Œå› æ­¤è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„åŠ å¯†ç®—æ³•</p><h3 id="EXP-2-Elgamal-åŠ å¯†ç®—æ³•"><a href="#EXP-2-Elgamal-åŠ å¯†ç®—æ³•" class="headerlink" title="EXP 2.Elgamal åŠ å¯†ç®—æ³•"></a>EXP 2.Elgamal åŠ å¯†ç®—æ³•</h3><p><strong>ç”Ÿæˆå¯†é’¥ï¼š</strong></p><p>Step 1ï¼šé€‰å–ä¸€ä¸ªæœ¬åŸå…ƒ$g$å’Œä¸€ä¸ªå¤§ç´ æ•°$p$</p><p>Step 2ï¼šé€‰å–$a\in[1,p-1]$ï¼Œè®¡ç®—$A\equiv g^a \pmod p$ï¼Œå…¬å¸ƒ$A$</p><p><strong>åŠ å¯†ï¼š</strong></p><p>Step 3ï¼šé€‰æ‹©æ˜æ–‡$m$å’Œç§é’¥$k$ï¼Œè®¡ç®—$c_1&#x3D;g^k,c_2&#x3D;mA^k$</p><p><strong>è§£å¯†ï¼š</strong></p><p>Step 4ï¼šè®¡ç®—$c^{-a}_1c_2$</p><p>ElgamalåŠ å¯†ï¼Œç”±$2$ä¸ªå¯†æ–‡ç¡®å®š$1$ä¸ªæ˜æ–‡</p><h2 id="3-è®¡ç®—ç¦»æ•£å¯¹æ•°çš„æ–¹æ³•"><a href="#3-è®¡ç®—ç¦»æ•£å¯¹æ•°çš„æ–¹æ³•" class="headerlink" title="3.è®¡ç®—ç¦»æ•£å¯¹æ•°çš„æ–¹æ³•"></a>3.è®¡ç®—ç¦»æ•£å¯¹æ•°çš„æ–¹æ³•</h2><h3 id="PART-1-æš´åŠ›æšä¸¾ï¼Œæ—¶é—´-O-N"><a href="#PART-1-æš´åŠ›æšä¸¾ï¼Œæ—¶é—´-O-N" class="headerlink" title="PART 1  æš´åŠ›æšä¸¾ï¼Œæ—¶é—´$O(N)$"></a>PART 1  æš´åŠ›æšä¸¾ï¼Œæ—¶é—´$O(N)$</h3><p><del>å¾ˆlowçš„æ–¹æ³•</del></p><h3 id="PART-2-Baby-Step-Giant-Step"><a href="#PART-2-Baby-Step-Giant-Step" class="headerlink" title="PART 2 Baby Step Giant Step"></a>PART 2 Baby Step Giant Step</h3><p>è¦å…ˆæ±‚å‡º$\mathrm{ord}(g)&#x3D;N$ï¼Œå¤æ‚åº¦ä¸º$O(\sqrt N \ln N)$</p><p>Step 1ï¼šè®¾$n&#x3D;1+\sqrt N$ï¼Œç„¶åæ„é€ ä¸¤ä¸ªåºåˆ—$L_1&#x3D;1,g,g^2,g^3,â€¦,g^n$å’Œ$L_2&#x3D;h,hg^{-n},hg^{-2n},hg^{-3n},â€¦,hg^{-n^2}$</p><p>Step2ï¼šå¯»æ‰¾$g^a&#x3D;hg^{-bn}$ï¼Œåˆ™$x&#x3D;a+bn$</p><p>ä¸Šä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">BSGS</span>(<span class="hljs-params">G,H,P,N</span>):<br>    L1,L2=[],[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N+<span class="hljs-number">1</span>):<br>        L1.append(<span class="hljs-built_in">pow</span>(G,i,P))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N+<span class="hljs-number">1</span>):<br>        tmp=H*inverse(<span class="hljs-built_in">pow</span>(G,i*N,P),P)%P<br>        L2.append(tmp)<br>        <span class="hljs-keyword">if</span> tmp <span class="hljs-keyword">in</span> L1:<br>            a=L1.index(tmp)<br>            b=i<br>            <span class="hljs-keyword">return</span> b*N+a<br>p=<span class="hljs-number">17389</span><br>g=<span class="hljs-number">9704</span><br>h=<span class="hljs-number">13896</span><br>n=<span class="hljs-number">1242</span><br><span class="hljs-built_in">print</span>(BSGS(g,h,p,iroot(n,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]+<span class="hljs-number">1</span>))<br><span class="hljs-comment"># 1159</span><br></code></pre></td></tr></table></figure><h3 id="PART-3-Pohilg-Hellmanç®—æ³•"><a href="#PART-3-Pohilg-Hellmanç®—æ³•" class="headerlink" title="PART 3 Pohilg Hellmanç®—æ³•"></a>PART 3 Pohilg Hellmanç®—æ³•</h3><p>è¯¥ç®—æ³•åˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†è§£å†³ï¼Œå¦‚æœ$p-1$éå¸¸å…‰æ»‘ï¼ˆæ¯”å¦‚åªæœ‰å‡ åå…‰æ»‘ï¼Œä¹Ÿå°±æ˜¯$p-1$çš„æœ€å¤§ç´ å› æ•°åªæœ‰å‡ åç”šè‡³åå‡ ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªç®—æ³•å¯ä»¥åœ¨æçŸ­æ—¶é—´å†…æ±‚å‡ºç¦»æ•£å¯¹æ•°çš„å€¼ã€‚ä¸è¿‡è¯¥ç®—æ³•çš„å¤æ‚åº¦ä¹Ÿæ¥è¿‘äº$O(\sqrt N \ln N)$ï¼Œ$O(\sqrt N \ln N)$ä¹Ÿæ˜¯ç›®å‰ä»¥æ¥æ±‚è§£ç¦»æ•£å¯¹æ•°çš„æœ€å¿«çš„æ—¶é—´å¤æ‚åº¦</p><p>é¦–å…ˆå…ˆåˆ†è§£$p-1&#x3D;\Pi (q^e)$ï¼Œå…¶ä¸­$q$ä¸ºç´ æ•°ï¼Œ$e$ä¸ºæŒ‡æ•°ï¼Œç„¶åé€šè¿‡æšä¸¾æ³•ï¼ˆ$\ln N$çº§åˆ«çš„æšä¸¾ï¼‰ï¼Œæ±‚è§£æ¯ä¸ªç´ æ•°åŠå…¶å¯¹åº”çš„æŒ‡æ•°çš„$(g^{\frac{p-1}{q^e}})^x&#x3D;(h^{\frac{p-1}{q^e}})^x$ï¼Œå¾—åˆ°æœ€ç»ˆç­”æ¡ˆ$X \equiv x \pmod {q^e}$ï¼Œæœ€åä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†å³å¯ã€‚</p><p>ä¸Šä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">p,oriex,cntex,product,rnd,g,h,mod</span>):<br>    <span class="hljs-keyword">if</span>(rnd==oriex+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> product<br>    tmpg=<span class="hljs-built_in">pow</span>(g,<span class="hljs-built_in">pow</span>(p,oriex),mod)<br>    tmph=<span class="hljs-built_in">pow</span>(h*inverse(<span class="hljs-built_in">pow</span>(g,product,mod),mod),<span class="hljs-built_in">pow</span>(p,cntex),mod)<br>    tmpans=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(p):<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">pow</span>(tmpg,i,mod)==tmph):<br>            tmpans=i<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> solve(p,oriex,cntex-<span class="hljs-number">1</span>,product+tmpans*p**rnd,rnd+<span class="hljs-number">1</span>,g,h,mod)<br><span class="hljs-built_in">print</span>(solve(<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5448</span>,<span class="hljs-number">6909</span>,<span class="hljs-number">11251</span>))<br><span class="hljs-comment">#511</span><br></code></pre></td></tr></table></figure><p>è¯´æ˜ï¼šè°ƒç”¨å¡«å†™å‚æ•°çš„æ—¶å€™ï¼Œä»£ç ä¸­çš„<code>p</code>æ˜¯æ¨¡æ•°å‡å»$1$åçš„å› æ•°ï¼Œ<code>oriex,cntex</code>ä¸¤ä¸ªéƒ½å¡«$q^e$ä¸­çš„$e$å‡å»$1$çš„å€¼ï¼Œ<code>product</code>å’Œ<code>rnd</code>éƒ½å¡«$0$ï¼Œ<code>g,h,mod</code>åˆ†åˆ«å¡«åŸæ¥çš„$g,h$å’Œæ¨¡æ•°ï¼Œä¾‹å¦‚ï¼Œä¸Šé¢æ˜¯è®¡ç®—$5448^x\equiv6909\pmod {11251}$çš„ç»“æœï¼Œæ³¨æ„åˆ°$\text{ord}(5448)&#x3D;5^4$ï¼Œä½†æ˜¯å¡«å…¥çš„ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°å‡ä¸º$4-1&#x3D;3$ã€‚è§‚å¯Ÿä»£ç ä¹Ÿä¸éš¾å‘ç°ï¼Œæšä¸¾ç¡®å®æ˜¯$\ln$çº§åˆ«çš„ï¼Œå¹¶ä¸”$p-1$è¶Šå…‰æ»‘ï¼Œè€—æ—¶è¶ŠçŸ­ï¼</p><h2 id="4-å…¶ä»–"><a href="#4-å…¶ä»–" class="headerlink" title="4.å…¶ä»–"></a>4.å…¶ä»–</h2><p>å…¶ä»–çš„ä¸€äº›è¯¸å¦‚ç¯ã€ç¾¤ä¹‹ç±»çš„æ¦‚å¿µçœ‹ä¹¦æœ¬åˆ°ç¬¬$2.10$èŠ‚ï¼Œä¸å†æŠ•æ”¾</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RSA Notes 4</title>
    <link href="/2021/01/22/RSA-Notes4/"/>
    <url>/2021/01/22/RSA-Notes4/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ RSAçš„ç¬”è®°4"><a href="#huangx607087å­¦ä¹ RSAçš„ç¬”è®°4" class="headerlink" title="huangx607087å­¦ä¹ RSAçš„ç¬”è®°4"></a>huangx607087å­¦ä¹ RSAçš„ç¬”è®°4</h1><h2 id="0-ç®€ä»‹ï¼š"><a href="#0-ç®€ä»‹ï¼š" class="headerlink" title="0.ç®€ä»‹ï¼š"></a>0.ç®€ä»‹ï¼š</h2><p><strong>An Overview of some special kinds of RSA and their solutions.</strong></p><p>ä¸€ä¸ªå¯¹è¿‡å»RSAå­¦ä¹ çš„å›é¡¾åŠå…¶å®æˆ˜ä¸­é¢˜ç›®çš„åº”å¯¹æ–¹æ³•ï¼Œå¾ˆå¤šæ–¹æ³•åœ¨ä»¥å‰çš„ç¬”è®°ï¼ˆ<strong>RSA Notes 1 &amp; RSA in GF</strong>ï¼‰ä¸­æåŠè¿‡ï¼Œä¸è¿‡è¿™æ¬¡æ˜¯ç»“åˆäº†ä¾‹é¢˜æ¥è®²è§£çš„ï¼Œå¾ˆå¤šåœ°æ–¹è¿˜æ˜¯ç›´æ¥ç”¨çš„è„šæœ¬ã€‚</p><h2 id="1-Overview-of-RSA-in-GF"><a href="#1-Overview-of-RSA-in-GF" class="headerlink" title="1. Overview of RSA in GF"></a>1. Overview of RSA in GF</h2><p>RSAåœ¨GFåŸŸä¸Šçš„å¤šé¡¹å¼çš„è¡¨ç°å½¢å¼ï¼Œæ ¹æ®ä¹‹å‰ç¬”è®°ä¸­çš„å†…å®¹ï¼Œè¿™ç§é¢˜ç›®å°±æ˜¯åˆ©ç”¨SagemathæŠŠRSAä¸­çš„æ¨¡å¤šé¡¹å¼åˆ†è§£æˆä¸¤ä¸ªæœ¬åŸå¤šé¡¹å¼ï¼Œç„¶åæ³¨æ„åˆ°è¿™ä¸¤ä¸ªæœ¬æºå¤šé¡¹å¼$P,Q$çš„$\phi$å€¼ä¸º$p^e-1$ï¼Œå…¶ä¸­$p$æ˜¯GFåŸŸä¸­çš„ç´ å› æ•°ï¼Œ$e$ä¸ºæŒ‡æ•°ï¼Œåˆ†åˆ«å–å†³äº$P$çš„æ¬¡æ•°å’Œ$Q$çš„æ¬¡æ•°ï¼Œå› ä¸ºæ‰€æœ‰çš„$p^e-1$ä¸ªå¤šé¡¹å¼éƒ½æ— æ³•ä¸æœ¬æºå¤šé¡¹å¼$P$äº’çº¦ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆæ¥çœ‹çœ‹è¿™æ ·ä¸€é“é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">Prime: <span class="hljs-number">43753</span><br>Modulus: <span class="hljs-number">34036</span>*y^<span class="hljs-number">177</span> + <span class="hljs-number">23068</span>*y^<span class="hljs-number">176</span> + <span class="hljs-number">13147</span>*y^<span class="hljs-number">175</span> + <span class="hljs-number">36344</span>*y^<span class="hljs-number">174</span> + <span class="hljs-number">10045</span>*y^<span class="hljs-number">173</span> + <span class="hljs-number">41049</span>*y^<span class="hljs-number">172</span> + <span class="hljs-number">17786</span>*y^<span class="hljs-number">171</span> + <span class="hljs-number">16601</span>*y^<span class="hljs-number">170</span> + <span class="hljs-number">7929</span>*y^<span class="hljs-number">169</span> + <span class="hljs-number">37570</span>*y^<span class="hljs-number">168</span> + <span class="hljs-number">990</span>*y^<span class="hljs-number">167</span> + <span class="hljs-number">9622</span>*y^<span class="hljs-number">166</span> + <span class="hljs-number">39273</span>*y^<span class="hljs-number">165</span> + <span class="hljs-number">35284</span>*y^<span class="hljs-number">164</span> + <span class="hljs-number">15632</span>*y^<span class="hljs-number">163</span> + <span class="hljs-number">18850</span>*y^<span class="hljs-number">162</span> + <span class="hljs-number">8800</span>*y^<span class="hljs-number">161</span> + <span class="hljs-number">33148</span>*y^<span class="hljs-number">160</span> + <span class="hljs-number">12147</span>*y^<span class="hljs-number">159</span> + <span class="hljs-number">40487</span>*y^<span class="hljs-number">158</span> + <span class="hljs-number">6407</span>*y^<span class="hljs-number">157</span> + <span class="hljs-number">34111</span>*y^<span class="hljs-number">156</span> + <span class="hljs-number">8446</span>*y^<span class="hljs-number">155</span> + <span class="hljs-number">21908</span>*y^<span class="hljs-number">154</span> + <span class="hljs-number">16812</span>*y^<span class="hljs-number">153</span> + <span class="hljs-number">40624</span>*y^<span class="hljs-number">152</span> + <span class="hljs-number">43506</span>*y^<span class="hljs-number">151</span> + <span class="hljs-number">39116</span>*y^<span class="hljs-number">150</span> + <span class="hljs-number">33011</span>*y^<span class="hljs-number">149</span> + <span class="hljs-number">23914</span>*y^<span class="hljs-number">148</span> + <span class="hljs-number">2210</span>*y^<span class="hljs-number">147</span> + <span class="hljs-number">23196</span>*y^<span class="hljs-number">146</span> + <span class="hljs-number">43359</span>*y^<span class="hljs-number">145</span> + <span class="hljs-number">34455</span>*y^<span class="hljs-number">144</span> + <span class="hljs-number">17684</span>*y^<span class="hljs-number">143</span> + <span class="hljs-number">25262</span>*y^<span class="hljs-number">142</span> + <span class="hljs-number">982</span>*y^<span class="hljs-number">141</span> + <span class="hljs-number">24015</span>*y^<span class="hljs-number">140</span> + <span class="hljs-number">27968</span>*y^<span class="hljs-number">139</span> + <span class="hljs-number">37463</span>*y^<span class="hljs-number">138</span> + <span class="hljs-number">10667</span>*y^<span class="hljs-number">137</span> + <span class="hljs-number">39519</span>*y^<span class="hljs-number">136</span> + <span class="hljs-number">31176</span>*y^<span class="hljs-number">135</span> + <span class="hljs-number">27520</span>*y^<span class="hljs-number">134</span> + <span class="hljs-number">32118</span>*y^<span class="hljs-number">133</span> + <span class="hljs-number">8333</span>*y^<span class="hljs-number">132</span> + <span class="hljs-number">38945</span>*y^<span class="hljs-number">131</span> + <span class="hljs-number">34713</span>*y^<span class="hljs-number">130</span> + <span class="hljs-number">1107</span>*y^<span class="hljs-number">129</span> + <span class="hljs-number">43604</span>*y^<span class="hljs-number">128</span> + <span class="hljs-number">4433</span>*y^<span class="hljs-number">127</span> + <span class="hljs-number">18110</span>*y^<span class="hljs-number">126</span> + <span class="hljs-number">17658</span>*y^<span class="hljs-number">125</span> + <span class="hljs-number">32354</span>*y^<span class="hljs-number">124</span> + <span class="hljs-number">3219</span>*y^<span class="hljs-number">123</span> + <span class="hljs-number">40238</span>*y^<span class="hljs-number">122</span> + <span class="hljs-number">10439</span>*y^<span class="hljs-number">121</span> + <span class="hljs-number">3669</span>*y^<span class="hljs-number">120</span> + <span class="hljs-number">8713</span>*y^<span class="hljs-number">119</span> + <span class="hljs-number">21027</span>*y^<span class="hljs-number">118</span> + <span class="hljs-number">29480</span>*y^<span class="hljs-number">117</span> + <span class="hljs-number">5477</span>*y^<span class="hljs-number">116</span> + <span class="hljs-number">24332</span>*y^<span class="hljs-number">115</span> + <span class="hljs-number">43480</span>*y^<span class="hljs-number">114</span> + <span class="hljs-number">33406</span>*y^<span class="hljs-number">113</span> + <span class="hljs-number">43121</span>*y^<span class="hljs-number">112</span> + <span class="hljs-number">1114</span>*y^<span class="hljs-number">111</span> + <span class="hljs-number">17198</span>*y^<span class="hljs-number">110</span> + <span class="hljs-number">22829</span>*y^<span class="hljs-number">109</span> + <span class="hljs-number">24424</span>*y^<span class="hljs-number">108</span> + <span class="hljs-number">16523</span>*y^<span class="hljs-number">107</span> + <span class="hljs-number">20424</span>*y^<span class="hljs-number">106</span> + <span class="hljs-number">36206</span>*y^<span class="hljs-number">105</span> + <span class="hljs-number">41849</span>*y^<span class="hljs-number">104</span> + <span class="hljs-number">3584</span>*y^<span class="hljs-number">103</span> + <span class="hljs-number">26500</span>*y^<span class="hljs-number">102</span> + <span class="hljs-number">31897</span>*y^<span class="hljs-number">101</span> + <span class="hljs-number">34640</span>*y^<span class="hljs-number">100</span> + <span class="hljs-number">27449</span>*y^<span class="hljs-number">99</span> + <span class="hljs-number">30962</span>*y^<span class="hljs-number">98</span> + <span class="hljs-number">41434</span>*y^<span class="hljs-number">97</span> + <span class="hljs-number">22125</span>*y^<span class="hljs-number">96</span> + <span class="hljs-number">24314</span>*y^<span class="hljs-number">95</span> + <span class="hljs-number">3944</span>*y^<span class="hljs-number">94</span> + <span class="hljs-number">18400</span>*y^<span class="hljs-number">93</span> + <span class="hljs-number">38476</span>*y^<span class="hljs-number">92</span> + <span class="hljs-number">28904</span>*y^<span class="hljs-number">91</span> + <span class="hljs-number">27936</span>*y^<span class="hljs-number">90</span> + <span class="hljs-number">41867</span>*y^<span class="hljs-number">89</span> + <span class="hljs-number">25573</span>*y^<span class="hljs-number">88</span> + <span class="hljs-number">25659</span>*y^<span class="hljs-number">87</span> + <span class="hljs-number">33443</span>*y^<span class="hljs-number">86</span> + <span class="hljs-number">18435</span>*y^<span class="hljs-number">85</span> + <span class="hljs-number">5934</span>*y^<span class="hljs-number">84</span> + <span class="hljs-number">38030</span>*y^<span class="hljs-number">83</span> + <span class="hljs-number">17563</span>*y^<span class="hljs-number">82</span> + <span class="hljs-number">24086</span>*y^<span class="hljs-number">81</span> + <span class="hljs-number">36782</span>*y^<span class="hljs-number">80</span> + <span class="hljs-number">20922</span>*y^<span class="hljs-number">79</span> + <span class="hljs-number">38933</span>*y^<span class="hljs-number">78</span> + <span class="hljs-number">23448</span>*y^<span class="hljs-number">77</span> + <span class="hljs-number">10599</span>*y^<span class="hljs-number">76</span> + <span class="hljs-number">7156</span>*y^<span class="hljs-number">75</span> + <span class="hljs-number">29044</span>*y^<span class="hljs-number">74</span> + <span class="hljs-number">23605</span>*y^<span class="hljs-number">73</span> + <span class="hljs-number">7657</span>*y^<span class="hljs-number">72</span> + <span class="hljs-number">28200</span>*y^<span class="hljs-number">71</span> + <span class="hljs-number">2431</span>*y^<span class="hljs-number">70</span> + <span class="hljs-number">3860</span>*y^<span class="hljs-number">69</span> + <span class="hljs-number">23259</span>*y^<span class="hljs-number">68</span> + <span class="hljs-number">14590</span>*y^<span class="hljs-number">67</span> + <span class="hljs-number">33631</span>*y^<span class="hljs-number">66</span> + <span class="hljs-number">15673</span>*y^<span class="hljs-number">65</span> + <span class="hljs-number">36049</span>*y^<span class="hljs-number">64</span> + <span class="hljs-number">29728</span>*y^<span class="hljs-number">63</span> + <span class="hljs-number">22413</span>*y^<span class="hljs-number">62</span> + <span class="hljs-number">18602</span>*y^<span class="hljs-number">61</span> + <span class="hljs-number">18557</span>*y^<span class="hljs-number">60</span> + <span class="hljs-number">23505</span>*y^<span class="hljs-number">59</span> + <span class="hljs-number">17642</span>*y^<span class="hljs-number">58</span> + <span class="hljs-number">12595</span>*y^<span class="hljs-number">57</span> + <span class="hljs-number">17255</span>*y^<span class="hljs-number">56</span> + <span class="hljs-number">15316</span>*y^<span class="hljs-number">55</span> + <span class="hljs-number">8948</span>*y^<span class="hljs-number">54</span> + <span class="hljs-number">38</span>*y^<span class="hljs-number">53</span> + <span class="hljs-number">40329</span>*y^<span class="hljs-number">52</span> + <span class="hljs-number">9823</span>*y^<span class="hljs-number">51</span> + <span class="hljs-number">5798</span>*y^<span class="hljs-number">50</span> + <span class="hljs-number">6379</span>*y^<span class="hljs-number">49</span> + <span class="hljs-number">8662</span>*y^<span class="hljs-number">48</span> + <span class="hljs-number">34640</span>*y^<span class="hljs-number">47</span> + <span class="hljs-number">38321</span>*y^<span class="hljs-number">46</span> + <span class="hljs-number">18760</span>*y^<span class="hljs-number">45</span> + <span class="hljs-number">13135</span>*y^<span class="hljs-number">44</span> + <span class="hljs-number">15926</span>*y^<span class="hljs-number">43</span> + <span class="hljs-number">34952</span>*y^<span class="hljs-number">42</span> + <span class="hljs-number">28940</span>*y^<span class="hljs-number">41</span> + <span class="hljs-number">13558</span>*y^<span class="hljs-number">40</span> + <span class="hljs-number">42579</span>*y^<span class="hljs-number">39</span> + <span class="hljs-number">38015</span>*y^<span class="hljs-number">38</span> + <span class="hljs-number">33788</span>*y^<span class="hljs-number">37</span> + <span class="hljs-number">12381</span>*y^<span class="hljs-number">36</span> + <span class="hljs-number">195</span>*y^<span class="hljs-number">35</span> + <span class="hljs-number">13709</span>*y^<span class="hljs-number">34</span> + <span class="hljs-number">31500</span>*y^<span class="hljs-number">33</span> + <span class="hljs-number">32994</span>*y^<span class="hljs-number">32</span> + <span class="hljs-number">30486</span>*y^<span class="hljs-number">31</span> + <span class="hljs-number">40414</span>*y^<span class="hljs-number">30</span> + <span class="hljs-number">2578</span>*y^<span class="hljs-number">29</span> + <span class="hljs-number">30525</span>*y^<span class="hljs-number">28</span> + <span class="hljs-number">43067</span>*y^<span class="hljs-number">27</span> + <span class="hljs-number">6195</span>*y^<span class="hljs-number">26</span> + <span class="hljs-number">36288</span>*y^<span class="hljs-number">25</span> + <span class="hljs-number">23236</span>*y^<span class="hljs-number">24</span> + <span class="hljs-number">21493</span>*y^<span class="hljs-number">23</span> + <span class="hljs-number">15808</span>*y^<span class="hljs-number">22</span> + <span class="hljs-number">34500</span>*y^<span class="hljs-number">21</span> + <span class="hljs-number">6390</span>*y^<span class="hljs-number">20</span> + <span class="hljs-number">42994</span>*y^<span class="hljs-number">19</span> + <span class="hljs-number">42151</span>*y^<span class="hljs-number">18</span> + <span class="hljs-number">19248</span>*y^<span class="hljs-number">17</span> + <span class="hljs-number">19291</span>*y^<span class="hljs-number">16</span> + <span class="hljs-number">8124</span>*y^<span class="hljs-number">15</span> + <span class="hljs-number">40161</span>*y^<span class="hljs-number">14</span> + <span class="hljs-number">24726</span>*y^<span class="hljs-number">13</span> + <span class="hljs-number">31874</span>*y^<span class="hljs-number">12</span> + <span class="hljs-number">30272</span>*y^<span class="hljs-number">11</span> + <span class="hljs-number">30761</span>*y^<span class="hljs-number">10</span> + <span class="hljs-number">2296</span>*y^<span class="hljs-number">9</span> + <span class="hljs-number">11017</span>*y^<span class="hljs-number">8</span> + <span class="hljs-number">16559</span>*y^<span class="hljs-number">7</span> + <span class="hljs-number">28949</span>*y^<span class="hljs-number">6</span> + <span class="hljs-number">40499</span>*y^<span class="hljs-number">5</span> + <span class="hljs-number">22377</span>*y^<span class="hljs-number">4</span> + <span class="hljs-number">33628</span>*y^<span class="hljs-number">3</span> + <span class="hljs-number">30598</span>*y^<span class="hljs-number">2</span> + <span class="hljs-number">4386</span>*y + <span class="hljs-number">23814</span><br>Ciphertext: <span class="hljs-number">5209</span>*x^<span class="hljs-number">176</span> + <span class="hljs-number">10881</span>*x^<span class="hljs-number">175</span> + <span class="hljs-number">31096</span>*x^<span class="hljs-number">174</span> + <span class="hljs-number">23354</span>*x^<span class="hljs-number">173</span> + <span class="hljs-number">28337</span>*x^<span class="hljs-number">172</span> + <span class="hljs-number">15982</span>*x^<span class="hljs-number">171</span> + <span class="hljs-number">13515</span>*x^<span class="hljs-number">170</span> + <span class="hljs-number">21641</span>*x^<span class="hljs-number">169</span> + <span class="hljs-number">10254</span>*x^<span class="hljs-number">168</span> + <span class="hljs-number">34588</span>*x^<span class="hljs-number">167</span> + <span class="hljs-number">27434</span>*x^<span class="hljs-number">166</span> + <span class="hljs-number">29552</span>*x^<span class="hljs-number">165</span> + <span class="hljs-number">7105</span>*x^<span class="hljs-number">164</span> + <span class="hljs-number">22604</span>*x^<span class="hljs-number">163</span> + <span class="hljs-number">41253</span>*x^<span class="hljs-number">162</span> + <span class="hljs-number">42675</span>*x^<span class="hljs-number">161</span> + <span class="hljs-number">21153</span>*x^<span class="hljs-number">160</span> + <span class="hljs-number">32838</span>*x^<span class="hljs-number">159</span> + <span class="hljs-number">34391</span>*x^<span class="hljs-number">158</span> + <span class="hljs-number">832</span>*x^<span class="hljs-number">157</span> + <span class="hljs-number">720</span>*x^<span class="hljs-number">156</span> + <span class="hljs-number">22883</span>*x^<span class="hljs-number">155</span> + <span class="hljs-number">19236</span>*x^<span class="hljs-number">154</span> + <span class="hljs-number">33772</span>*x^<span class="hljs-number">153</span> + <span class="hljs-number">5020</span>*x^<span class="hljs-number">152</span> + <span class="hljs-number">17943</span>*x^<span class="hljs-number">151</span> + <span class="hljs-number">26967</span>*x^<span class="hljs-number">150</span> + <span class="hljs-number">30847</span>*x^<span class="hljs-number">149</span> + <span class="hljs-number">10306</span>*x^<span class="hljs-number">148</span> + <span class="hljs-number">33966</span>*x^<span class="hljs-number">147</span> + <span class="hljs-number">43255</span>*x^<span class="hljs-number">146</span> + <span class="hljs-number">20342</span>*x^<span class="hljs-number">145</span> + <span class="hljs-number">4474</span>*x^<span class="hljs-number">144</span> + <span class="hljs-number">3490</span>*x^<span class="hljs-number">143</span> + <span class="hljs-number">38033</span>*x^<span class="hljs-number">142</span> + <span class="hljs-number">11224</span>*x^<span class="hljs-number">141</span> + <span class="hljs-number">30565</span>*x^<span class="hljs-number">140</span> + <span class="hljs-number">31967</span>*x^<span class="hljs-number">139</span> + <span class="hljs-number">32382</span>*x^<span class="hljs-number">138</span> + <span class="hljs-number">9759</span>*x^<span class="hljs-number">137</span> + <span class="hljs-number">1030</span>*x^<span class="hljs-number">136</span> + <span class="hljs-number">32122</span>*x^<span class="hljs-number">135</span> + <span class="hljs-number">42614</span>*x^<span class="hljs-number">134</span> + <span class="hljs-number">14280</span>*x^<span class="hljs-number">133</span> + <span class="hljs-number">16533</span>*x^<span class="hljs-number">132</span> + <span class="hljs-number">32676</span>*x^<span class="hljs-number">131</span> + <span class="hljs-number">43070</span>*x^<span class="hljs-number">130</span> + <span class="hljs-number">36009</span>*x^<span class="hljs-number">129</span> + <span class="hljs-number">28497</span>*x^<span class="hljs-number">128</span> + <span class="hljs-number">2940</span>*x^<span class="hljs-number">127</span> + <span class="hljs-number">9747</span>*x^<span class="hljs-number">126</span> + <span class="hljs-number">22758</span>*x^<span class="hljs-number">125</span> + <span class="hljs-number">16615</span>*x^<span class="hljs-number">124</span> + <span class="hljs-number">14086</span>*x^<span class="hljs-number">123</span> + <span class="hljs-number">13038</span>*x^<span class="hljs-number">122</span> + <span class="hljs-number">39603</span>*x^<span class="hljs-number">121</span> + <span class="hljs-number">36260</span>*x^<span class="hljs-number">120</span> + <span class="hljs-number">32502</span>*x^<span class="hljs-number">119</span> + <span class="hljs-number">17619</span>*x^<span class="hljs-number">118</span> + <span class="hljs-number">17700</span>*x^<span class="hljs-number">117</span> + <span class="hljs-number">15083</span>*x^<span class="hljs-number">116</span> + <span class="hljs-number">11311</span>*x^<span class="hljs-number">115</span> + <span class="hljs-number">36496</span>*x^<span class="hljs-number">114</span> + <span class="hljs-number">1300</span>*x^<span class="hljs-number">113</span> + <span class="hljs-number">13601</span>*x^<span class="hljs-number">112</span> + <span class="hljs-number">43425</span>*x^<span class="hljs-number">111</span> + <span class="hljs-number">10376</span>*x^<span class="hljs-number">110</span> + <span class="hljs-number">11551</span>*x^<span class="hljs-number">109</span> + <span class="hljs-number">13684</span>*x^<span class="hljs-number">108</span> + <span class="hljs-number">14955</span>*x^<span class="hljs-number">107</span> + <span class="hljs-number">6661</span>*x^<span class="hljs-number">106</span> + <span class="hljs-number">12674</span>*x^<span class="hljs-number">105</span> + <span class="hljs-number">21534</span>*x^<span class="hljs-number">104</span> + <span class="hljs-number">32132</span>*x^<span class="hljs-number">103</span> + <span class="hljs-number">34135</span>*x^<span class="hljs-number">102</span> + <span class="hljs-number">43684</span>*x^<span class="hljs-number">101</span> + <span class="hljs-number">837</span>*x^<span class="hljs-number">100</span> + <span class="hljs-number">29311</span>*x^<span class="hljs-number">99</span> + <span class="hljs-number">4849</span>*x^<span class="hljs-number">98</span> + <span class="hljs-number">26632</span>*x^<span class="hljs-number">97</span> + <span class="hljs-number">26662</span>*x^<span class="hljs-number">96</span> + <span class="hljs-number">10159</span>*x^<span class="hljs-number">95</span> + <span class="hljs-number">32657</span>*x^<span class="hljs-number">94</span> + <span class="hljs-number">12149</span>*x^<span class="hljs-number">93</span> + <span class="hljs-number">17858</span>*x^<span class="hljs-number">92</span> + <span class="hljs-number">35805</span>*x^<span class="hljs-number">91</span> + <span class="hljs-number">19391</span>*x^<span class="hljs-number">90</span> + <span class="hljs-number">30884</span>*x^<span class="hljs-number">89</span> + <span class="hljs-number">42039</span>*x^<span class="hljs-number">88</span> + <span class="hljs-number">17292</span>*x^<span class="hljs-number">87</span> + <span class="hljs-number">4694</span>*x^<span class="hljs-number">86</span> + <span class="hljs-number">1497</span>*x^<span class="hljs-number">85</span> + <span class="hljs-number">1744</span>*x^<span class="hljs-number">84</span> + <span class="hljs-number">31071</span>*x^<span class="hljs-number">83</span> + <span class="hljs-number">26246</span>*x^<span class="hljs-number">82</span> + <span class="hljs-number">24402</span>*x^<span class="hljs-number">81</span> + <span class="hljs-number">22068</span>*x^<span class="hljs-number">80</span> + <span class="hljs-number">39263</span>*x^<span class="hljs-number">79</span> + <span class="hljs-number">23703</span>*x^<span class="hljs-number">78</span> + <span class="hljs-number">21484</span>*x^<span class="hljs-number">77</span> + <span class="hljs-number">12241</span>*x^<span class="hljs-number">76</span> + <span class="hljs-number">28821</span>*x^<span class="hljs-number">75</span> + <span class="hljs-number">32886</span>*x^<span class="hljs-number">74</span> + <span class="hljs-number">43075</span>*x^<span class="hljs-number">73</span> + <span class="hljs-number">35741</span>*x^<span class="hljs-number">72</span> + <span class="hljs-number">19936</span>*x^<span class="hljs-number">71</span> + <span class="hljs-number">37219</span>*x^<span class="hljs-number">70</span> + <span class="hljs-number">33411</span>*x^<span class="hljs-number">69</span> + <span class="hljs-number">8301</span>*x^<span class="hljs-number">68</span> + <span class="hljs-number">12949</span>*x^<span class="hljs-number">67</span> + <span class="hljs-number">28611</span>*x^<span class="hljs-number">66</span> + <span class="hljs-number">42654</span>*x^<span class="hljs-number">65</span> + <span class="hljs-number">6910</span>*x^<span class="hljs-number">64</span> + <span class="hljs-number">18523</span>*x^<span class="hljs-number">63</span> + <span class="hljs-number">31144</span>*x^<span class="hljs-number">62</span> + <span class="hljs-number">21398</span>*x^<span class="hljs-number">61</span> + <span class="hljs-number">36298</span>*x^<span class="hljs-number">60</span> + <span class="hljs-number">27158</span>*x^<span class="hljs-number">59</span> + <span class="hljs-number">918</span>*x^<span class="hljs-number">58</span> + <span class="hljs-number">38601</span>*x^<span class="hljs-number">57</span> + <span class="hljs-number">4269</span>*x^<span class="hljs-number">56</span> + <span class="hljs-number">5699</span>*x^<span class="hljs-number">55</span> + <span class="hljs-number">36444</span>*x^<span class="hljs-number">54</span> + <span class="hljs-number">34791</span>*x^<span class="hljs-number">53</span> + <span class="hljs-number">37978</span>*x^<span class="hljs-number">52</span> + <span class="hljs-number">32481</span>*x^<span class="hljs-number">51</span> + <span class="hljs-number">8039</span>*x^<span class="hljs-number">50</span> + <span class="hljs-number">11012</span>*x^<span class="hljs-number">49</span> + <span class="hljs-number">11454</span>*x^<span class="hljs-number">48</span> + <span class="hljs-number">30450</span>*x^<span class="hljs-number">47</span> + <span class="hljs-number">1381</span>*x^<span class="hljs-number">46</span> + <span class="hljs-number">32403</span>*x^<span class="hljs-number">45</span> + <span class="hljs-number">8202</span>*x^<span class="hljs-number">44</span> + <span class="hljs-number">8404</span>*x^<span class="hljs-number">43</span> + <span class="hljs-number">37648</span>*x^<span class="hljs-number">42</span> + <span class="hljs-number">43696</span>*x^<span class="hljs-number">41</span> + <span class="hljs-number">34237</span>*x^<span class="hljs-number">40</span> + <span class="hljs-number">36490</span>*x^<span class="hljs-number">39</span> + <span class="hljs-number">41423</span>*x^<span class="hljs-number">38</span> + <span class="hljs-number">35792</span>*x^<span class="hljs-number">37</span> + <span class="hljs-number">36950</span>*x^<span class="hljs-number">36</span> + <span class="hljs-number">31086</span>*x^<span class="hljs-number">35</span> + <span class="hljs-number">38970</span>*x^<span class="hljs-number">34</span> + <span class="hljs-number">12439</span>*x^<span class="hljs-number">33</span> + <span class="hljs-number">7963</span>*x^<span class="hljs-number">32</span> + <span class="hljs-number">16150</span>*x^<span class="hljs-number">31</span> + <span class="hljs-number">11382</span>*x^<span class="hljs-number">30</span> + <span class="hljs-number">3038</span>*x^<span class="hljs-number">29</span> + <span class="hljs-number">20157</span>*x^<span class="hljs-number">28</span> + <span class="hljs-number">23531</span>*x^<span class="hljs-number">27</span> + <span class="hljs-number">32866</span>*x^<span class="hljs-number">26</span> + <span class="hljs-number">5428</span>*x^<span class="hljs-number">25</span> + <span class="hljs-number">21132</span>*x^<span class="hljs-number">24</span> + <span class="hljs-number">13443</span>*x^<span class="hljs-number">23</span> + <span class="hljs-number">28909</span>*x^<span class="hljs-number">22</span> + <span class="hljs-number">42716</span>*x^<span class="hljs-number">21</span> + <span class="hljs-number">6567</span>*x^<span class="hljs-number">20</span> + <span class="hljs-number">24744</span>*x^<span class="hljs-number">19</span> + <span class="hljs-number">8727</span>*x^<span class="hljs-number">18</span> + <span class="hljs-number">14895</span>*x^<span class="hljs-number">17</span> + <span class="hljs-number">28172</span>*x^<span class="hljs-number">16</span> + <span class="hljs-number">30903</span>*x^<span class="hljs-number">15</span> + <span class="hljs-number">26608</span>*x^<span class="hljs-number">14</span> + <span class="hljs-number">27314</span>*x^<span class="hljs-number">13</span> + <span class="hljs-number">42224</span>*x^<span class="hljs-number">12</span> + <span class="hljs-number">42551</span>*x^<span class="hljs-number">11</span> + <span class="hljs-number">37726</span>*x^<span class="hljs-number">10</span> + <span class="hljs-number">11203</span>*x^<span class="hljs-number">9</span> + <span class="hljs-number">36816</span>*x^<span class="hljs-number">8</span> + <span class="hljs-number">5537</span>*x^<span class="hljs-number">7</span> + <span class="hljs-number">20301</span>*x^<span class="hljs-number">6</span> + <span class="hljs-number">17591</span>*x^<span class="hljs-number">5</span> + <span class="hljs-number">41279</span>*x^<span class="hljs-number">4</span> + <span class="hljs-number">7999</span>*x^<span class="hljs-number">3</span> + <span class="hljs-number">33753</span>*x^<span class="hljs-number">2</span> + <span class="hljs-number">34551</span>*x + <span class="hljs-number">9659</span><br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ç»™å‡ºäº†ä¸€ä¸ª$p&#x3D;43753$ï¼Œå’Œä¸¤ä¸ªå¤šé¡¹å¼$n,c$ï¼Œå¾ˆæ˜¾ç„¶ï¼Œæ ¹æ®ä»¥å¾€çš„ä¼ ç»Ÿï¼Œæˆ‘ä»¬æŠŠ$n$æ”¾åˆ°sagemathä¸­è¿›è¡Œåˆ†è§£ã€‚</p><p><img src="/2021/01/22/RSA-Notes4/11.png" alt="1-1"></p><p>ä¸è¿‡æˆ‘ä»¬å‘ç°ä»–æœ€åç«Ÿç„¶å¸¦äº†ä¸ªç³»æ•°$34036$ï¼Œè®¡ç®—äº†ä¸€ä¸‹$\phi(34036)&#x3D;16632$ï¼Œæ‰€ä»¥æœ€åçš„$\phi(n)&#x3D;16632(43753^{65})(43753^{112})$ï¼Œç„¶åå°±æ˜¯æ±‚é€†å…ƒã€‚ä¸è¿‡æœ€åå‘ç°è¿™ä¸ª$16632$ä¹˜ä¸ä¹˜æœ€åçš„ç»“æœéƒ½ä¸€æ ·ï¼Œä¸çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆã€‚</p><p>ç„¶åå°±æ˜¯å¸¸è§„æ“ä½œäº†ï¼Œæˆ‘ä»¬æ ¹æ®RSAçš„å¸¸è§„è§£å¯†ï¼Œå°±å¯ä»¥è§£å‡º$m$ã€‚è¿™é‡Œåˆ°æœ€ååº”è¯¥æ˜¯æŠŠ$m$å¤šé¡¹å¼çš„æ¬¡æ•°ä»ä½åˆ°é«˜çš„ç³»æ•°æ‹¿å‡ºæ¥è½¬æ¢æˆå­—ç¬¦ï¼ˆè€Œä¸æ˜¯è§†ä¸º$43753$è¿›åˆ¶æœ€åè½¬æ¢æˆ$10$è¿›åˆ¶å<code>long_to_bytes</code>ï¼‰,æœ€åçš„ç­”æ¡ˆå°±å¾ˆç®€å•äº†</p><p><img src="/2021/01/22/RSA-Notes4/12.png" alt="1-2"></p><h2 id="2-Overview-of-Coppersmith"><a href="#2-Overview-of-Coppersmith" class="headerlink" title="2.Overview of Coppersmith"></a>2.Overview of Coppersmith</h2><p>ä»¥ä¸‹éƒ¨åˆ†ä½Coppersmithç›¸å…³ä¾‹é¢˜è®²è§£</p><h3 id="PART-1"><a href="#PART-1" class="headerlink" title="PART 1"></a>PART 1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">0x67de16e8ceaece4a123ad278b249a9acde81174d4287889d68dbb7939fdfa28f3a927c4e1c71f9b7b036c7ce287806105954fb9086bfe3dbe5f82d156f4151c9fe74e32f6ce8bb239c2d55cb6628e53941628ccbd294aa101687160b578decf716f348ea42922358946e7706daf044be08a9bcd8ea248b597eeb3a1e16781247dec66a0976046de5b2603315ab5dc17120a558db56213e66989c0895492151fb5a0784fa346dfeebf2b1f71b3c7dbf135abfd4499d4f83b6d0b4c68fe5b1fe14e383d4c7cc78065cfed1831bd2e19c06b270e4ebfb9d09f3431d613301106c7762dace771e730c3268ad549e20202ac1f77d47eb18f82693e6e974f783a88793</span><br>e=<span class="hljs-number">3</span><br>c=<span class="hljs-number">0x54d055d31d0186b4914292a281ce71ecd9e5f2a441e68180ab0d6bb3e08412254d3465b44d1aa49d5c1926f3d72507bb7f89c5614a190957c4c22da4e966ecf632c914c5cce942bd4ee916c3d28ab27863e1ec9a1058fbc10b3bf672765e51428cd8022a7985d01570a72091694d0c91a205319316dd5c1eaa8f6486673512940e19a65</span><br>(m&gt;&gt;<span class="hljs-number">72</span>)&lt;&lt;<span class="hljs-number">72</span>=<span class="hljs-number">0x464c41477b325e38727361373538393639336663363839633737633566353236326436000000000000000000</span><br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ç»™å‡ºäº†$n,e,c$ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ª$512$ä½é•¿çš„$m$ï¼Œä¸è¿‡æœ€ä½çš„$72$ä½è¢«çœç•¥äº†ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬å°±ä½¿ç”¨æˆ‘åœ¨<strong>RSA Notes 1</strong>ä¸­ç¬¬<strong>0x08</strong>éƒ¨åˆ†å‘å¸ƒçš„è„šæœ¬ï¼Œè¡¥å……å®Œæ•´å‚æ•°ï¼Œæ”¾å…¥sagemath-notebookä¸­è¿è¡Œå³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-comment">#ä½ å·²çŸ¥çš„nå€¼</span><br>e = <span class="hljs-number">3</span><br>m = randrange(n)<span class="hljs-comment">#ä¸è¦æ”¹</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<span class="hljs-comment">#ä¸è¦æ”¹</span><br>beta = <span class="hljs-number">1</span><br>epsilon = beta^<span class="hljs-number">2</span>/<span class="hljs-number">7</span><span class="hljs-comment">#ä¸è¦æ”¹</span><br>nbits = n.nbits()<span class="hljs-comment">#ä¸è¦æ”¹</span><br>kbits=<span class="hljs-comment">#mè¢«æ©ç›–çš„å­—ä½æ•°</span><br><span class="hljs-built_in">print</span>(nbits,kbits)<br>mbar = <span class="hljs-comment">#ä½ å¾—åˆ°çš„ä¸å®Œæ•´çš„må€¼</span><br>c = <span class="hljs-comment">#ä½ å¾—åˆ°çš„cå€¼</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;upper %d bits (of %d bits) is given&quot;</span> % (nbits-kbits, nbits))<br>PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = (mbar + x)^e - c<br><span class="hljs-built_in">print</span> (m)<br>x0 = f.small_roots(X=<span class="hljs-number">2</span>^kbits, beta=<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]  <span class="hljs-comment"># find root &lt; 2^kbits with factor = n1</span><br><span class="hljs-built_in">print</span>( mbar + x0)<br></code></pre></td></tr></table></figure><h3 id="PART-2"><a href="#PART-2" class="headerlink" title="PART 2"></a>PART 2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">0x6546140f6d20fb1af8755ba3925274f8df3f175ea783e3f23748429fe6602477239b51e5c20b201b82e210402ebbfc159cb548117a4c2e1b73bbee26bbc04f5388ed3710beb66db0e1b6253030944c791529bc6cf4959851fde47602dcc116468038f852b766d418a7b2d4b83edef71e82b6465a3726d2f9d228dc0a99c01f277e28176c93d7059b3ad0b20f33b6b26785a22a3e867c11a9dc564311cc4cd6b7a3f605c9e7c7e44896181713269faf5600e98cb12450316bad55cda3e1ed24bbdac22cf4c8d23f1f4767336aebea9c638d6258f80c858e5b01be39edf7eb245c3c4639ef6de9edaf904808e09e141030ec503260418b23a0347bf224e65766f3</span><br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-number">0x4f92bcf8674e17ac7901a68b125bea2b7c2e5e5b7da9d23b90db42fb8e7ae60580b6055310d1a71daa8787c3a386914212e55e89f26155228e243efb444791469f8decc7cb6663d84a8ad404ae3b0bf07e3777a90db767c1ea433cbb8cc276a01025e1ffa8f1ba92b9f90f9b2822a1789b6953ba3a1f9c948a8fc834b9873a8a0ad1c58c34ddc53a2551d85f54166b205ce53c2f883ba59fe4bd181b1bc9a9b7d9d3d9204c0310d20c14804dc7d7d8a241d360216eff12b55c87f9dbddcab23855f75c6105e0de4f44944317b04dbb89cb9bb2f381c375b0e166cf5f547967e07ab1a86287dae6e555905b8069846474169cef605af66be22ec884d3718997a</span><br>(p&gt;&gt;<span class="hljs-number">128</span>)&lt;&lt;<span class="hljs-number">128</span>=<span class="hljs-number">0x8ae08a8ccda172cc5768c98c935b06a185a5f86f1020ce864929dd61d0d6511141e94f589b4c10754fe4b278207414caedc5a0c47ca091ef3dad80c15b05776d4c574759b50106585973e7f7cda6d01db4bcfbb671151069287f276bb6c18d04cab2dfccf70a72a5edbc23fd636da98900000000000000000000000000000000</span><br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ç»™å‡ºäº†$p$çš„å€¼ï¼Œä¸è¿‡$p$ç¼ºå¤±äº†æœ€åçš„$128$ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¡¥å…¨ä»¥ä¸‹è„šæœ¬ï¼Œç„¶åæ”¾å…¥sagemathä¸­è¿è¡Œå³å¯è·å¾—å®Œæ•´çš„$p$å€¼ï¼Œè¿›è€Œåˆ†è§£$n$ï¼Œå¸¸è§„è§£å¯†å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-comment">#å¡«å†™nå€¼</span><br>p_fake = <span class="hljs-comment">#å¡«å†™på€¼</span><br>pbits = p_fake.nbits()<br>kbits = <span class="hljs-comment">#å¡«å†™på¤±å»çš„ä½ä½ä½æ•°</span><br>pbar = p_fake &amp; (<span class="hljs-number">2</span>^pbits-<span class="hljs-number">2</span>^kbits)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;upper %d bits (of %d bits) is given&quot;</span> % (pbits-kbits, pbits))<br>PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = x + pbar<br>x0 = f.small_roots(X=<span class="hljs-number">2</span>^kbits, beta=<span class="hljs-number">0.4</span>)[<span class="hljs-number">0</span>]  <span class="hljs-comment"># find root &lt; 2^kbits with factor &gt;= n^0.3</span><br>p= x0 + pbar<br><span class="hljs-built_in">print</span> (<span class="hljs-built_in">hex</span>(p))<br></code></pre></td></tr></table></figure><h3 id="PART-3"><a href="#PART-3" class="headerlink" title="PART 3"></a>PART 3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">0x8449fe9c8f1ddf7b08b53af7e3f55f9199fdc07b05ae7bda1737159ee985c8ea7d46dd1ac82cf23fef91b119822667d4fe7d98a2a46d1fc38f9dc05e9fb8e6ea07087f77d8dbda45877eb5babb7bc58af8caccdcbe89cf0cb994ce51fa5d45565fbc1b1797984663bb912ce2c9391ba6b76c92c4ac2e6b5d9c1242fdc75f36f7</span><br>e=<span class="hljs-number">3</span><br>c=<span class="hljs-number">0x4ffb1114e37dd59103dae4c48581bb592e1bc0a2ec94f10f9f391084267aad0715a09776e074464d9581e00ad0af4f4e7ec2adc0d4455c7c23b52f76d1ea3801ced06c6db167614aae99a2ad44e1c00ac3eb043405e2f80c7c2c99e72fea9bfe708972f8eb1e419cb60b724bac9b2139283d6a1c34c137c312e20c12433978d2</span><br>d%(<span class="hljs-number">2</span>**<span class="hljs-number">512</span>)=<span class="hljs-number">0xf0a11feccbadcce7330f2d3b65bac041514c5b4cec2c7260923df431b60806de728822d256becee44d84d8ff4c4f3b95b5c2a4707ced42e0184e46cc043971b</span><br></code></pre></td></tr></table></figure><p>è¿™æ¬¡ï¼Œæˆ‘ä»¬å·²çŸ¥çš„æ˜¯$n,e,c$åŒæ—¶è¿˜ç»™å‡ºäº†$d$çš„æœ€ä½$512$ä½ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥è¡¥å…¨ä»¥ä¸‹è„šæœ¬ï¼Œç„¶åæ”¾å…¥sagemathä¸­å³å¯è·å¾—å®Œæ•´çš„$d$å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">partial_p</span>(<span class="hljs-params">p0, kbits, n</span>):<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    nbits = n.nbits()<br>    f = <span class="hljs-number">2</span>^kbits*x + p0<br>    f = f.monic()<br>    roots = f.small_roots(X=<span class="hljs-number">2</span>^(nbits//<span class="hljs-number">2</span>-kbits), beta=<span class="hljs-number">0.3</span>)  <span class="hljs-comment"># find root &lt; 2^(nbits//2-kbits) with factor &gt;= n^0.3</span><br>    <span class="hljs-keyword">if</span> roots:<br>        x0 = roots[<span class="hljs-number">0</span>]<br>        p = gcd(<span class="hljs-number">2</span>^kbits*x0 + p0, n)<br>        <span class="hljs-keyword">return</span> ZZ(p)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_p</span>(<span class="hljs-params">d0, kbits, e, n</span>):<br>    X = var(<span class="hljs-string">&#x27;X&#x27;</span>)<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, e+<span class="hljs-number">1</span>):<br>        results = solve_mod([e*d0*X - k*X*(n-X+<span class="hljs-number">1</span>) + k*n == X], <span class="hljs-number">2</span>^kbits)<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> results:<br>            p0 = ZZ(x[<span class="hljs-number">0</span>])<br>            p = partial_p(p0, kbits, n)<br>            <span class="hljs-keyword">if</span> p:<br>                <span class="hljs-keyword">return</span> p<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    n = <span class="hljs-comment">#å¡«å†™nå€¼</span><br>    e = <span class="hljs-number">3</span><br>    d = <span class="hljs-comment">#å¡«å†™ä¸å®Œæ•´çš„då€¼</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(d))<br>    beta = <span class="hljs-number">0.5</span><br>    epsilon = beta^<span class="hljs-number">2</span>/<span class="hljs-number">7</span><br>    nbits = n.nbits()<br>    <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;nbits:%d:&quot;</span>%(nbits))<br>    kbits = <span class="hljs-comment">#å¡«å†™å·²çŸ¥dçš„ä½ä½çš„äºŒè¿›åˆ¶ä½æ•°</span><br>    <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;kbits:%d&quot;</span>%(kbits))<br>    d0 = d &amp; (<span class="hljs-number">2</span>^kbits-<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;lower %d bits (of %d bits) is given&quot;</span> % (kbits, nbits))<br>    p = find_p(d0, kbits, e, n)<br>    <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;found p: %d&quot;</span> % p)<br>    q = n//p<br>    <span class="hljs-built_in">print</span> (<span class="hljs-built_in">hex</span>(d))<br>    dtrue=inverse_mod(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(dtrue))<br></code></pre></td></tr></table></figure><h3 id="PART-4"><a href="#PART-4" class="headerlink" title="PART 4"></a>PART 4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">e=<span class="hljs-number">3</span><br>n1=<span class="hljs-number">78642188663937191491235684351005990853149481644703243255021321296087539054265733392095095639539412823093600710316645130404423641473150336492175402885270861906530337207734106926328737198871118125840680572148601743121884788919989184318198417654263598170932154428514561079675550090698019678767738203477097731989</span><br>c1=<span class="hljs-number">23419685303892339080979695469481275906709035609088426118328601771163101123641599051556995351678670765521269546319724616458499631461037359417701720430452076029312714313804716888119910334476982840024696320503747736428099717113471541651211596481005191146454458591558743268791485623924245960696651150688621664860</span><br>n2=<span class="hljs-number">98174485544103863705821086588292917749386955237408645745685476234349659452606822650329076955303471252833860010724515777826660887118742978051231030080666542833950748806944312437614585352818344599399156268450521239843157288915059003487783576003027303399985723834248634230998110618288843582573006048070816520647</span><br>c2=<span class="hljs-number">72080679612442543693944655041130370753964497034378634203383617624269927191363529233872659451561571441107920350406295389613006330637565645758727103723546610079332161151567096389071050158035757745766399510575237344950873632114050632573903701015749830874081198250578516967517980592506626547273178363503100507676</span><br>n3=<span class="hljs-number">91638855323231795590642755267985988356764327384001022396221901964430032527111968159623063760057482761918901490239790230176524505469897183382928646349163030620342744192731246392941227433195249399795012672172947919435254998997253131826888070173526892674308708289629739522194864912899817994807268945141349669311</span><br>c3=<span class="hljs-number">22149989692509889061584875630258740744292355239822482581889060656197919681655781672277545701325284646570773490123892626601106871432216449814891757715588851851459306683123591338089745675044763551335899599807235257516935037356212345033087798267959242561085752109746935300735969972249665700075907145744305255616</span><br></code></pre></td></tr></table></figure><p>ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»å°±æ˜¯å·²çŸ¥åŒä¸€ä¸ªæ˜æ–‡$m$è¢«å¤šä¸ªä¸åŒçš„å¯†é’¥åŠ å¯†åçš„ç»“æœï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†è§£å†³ï¼Œæœ€åå¯¹ç»“æœå¼€ä¸‰æ¬¡æ ¹å·å³ä½æ˜æ–‡çš„å€¼ã€‚</p><p>CRTçš„è„šæœ¬æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚è¯´æˆ‘åšå®¢ä¸­çš„<strong>0xGame Div 2</strong>ä¸­å°±æœ‰ç°æˆçš„è„šæœ¬å¯ä»¥ç›´æ¥æ‹¿è¿‡æ¥ç”¨ï¼Œæ­¤å¤„èŠ‚çœç‰ˆé¢ï¼Œä¸ä¸Šè„šæœ¬ï¼Œ<del>å› ä¸ºæ›´é‡è¦çš„å†…å®¹åœ¨åé¢</del></p><h3 id="PART-5"><a href="#PART-5" class="headerlink" title="PART 5"></a>PART 5</h3><h4 id="ORG-2021-1-22"><a href="#ORG-2021-1-22" class="headerlink" title="ORG 2021.1.22"></a>ORG 2021.1.22</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">0xa1c7556e895f8268b7a81c5cae3d1377f245ceb84b86878982c9869ed9a00fd1ec11a462831b812d7f973a385a1cdae9465c78085ef1d28fa52d8b151609c737e788c3ae9848c39cc2d62c8c73b7659d19e49301171e5df0d9eb6bd0ea0c0f2d64235372c04f88e6402f202783432d2a3cca4d7290e59e41afbe1c206495134d</span><br>e=<span class="hljs-number">7</span><br>c=<span class="hljs-number">0xa0e8306ed676f8f362c78feb0f3adfbaa068f28863941777bd07a7f41f4288220efe34227d1cba72597582f5c1d372394edfd3bd1c29686f30ab9c84ab6bcbbb08920cfca210ecdf3bfac94f844b877a2b74bfeeafd47784978723e6ac78796c24022aa142f4a5715efde7be7e34a75665e6d984fea74e77d063d7e75d0b888c</span><br>x=<span class="hljs-number">0xa0e8306ed676f8f362c78feb0f3adfbaa068f28863941777bd07a7f41f4288220efe34227d1cba72935ee2338135a8152e68165e0f7adf45a898d6b32ea2fc8789f783a7af0ade6acd505e1c791058bb872d589f848e6bb5aa4eeceed04e62ff98b75d6cecd57f0b510486f3f18e9e2f3b7ec14a5ba6621d76161c54f9a5561f</span><br></code></pre></td></tr></table></figure><p>å…¶ä¸­$x$æ˜¯å¯¹$m+1$åŠ å¯†çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯$(m+1)^7 \mod n$</p><p>è¿™é‡Œå°±æ¶‰åŠåˆ°äº†ç›¸å…³æ˜æ–‡æ”»å‡»ï¼š</p><h4 id="UPD-2021-2-18"><a href="#UPD-2021-2-18" class="headerlink" title="UPD 2021.2.18"></a>UPD 2021.2.18</h4><p><strong>UPDå†…å®¹ï¼šåˆ é™¤äº†åŸç‰ˆä¸­é”™è¯¯çš„è„šæœ¬ä»£ç ï¼Œä¸Šäº†ä¸€ä¸ªå‡†ç¡®çš„ä»£ç </strong></p><p>æ‰€è°“RSAç›¸å…³æ˜æ–‡æ”»å‡»ï¼Œå°±æ˜¯åœ¨å·²çŸ¥$c\equiv m^e \pmod p$çš„æƒ…å†µä¸‹ï¼ŒåŒæ—¶è¿˜çŸ¥é“äº†$x\equiv (m+1)^e \pmod p$çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™å¯åŠ¨ç›¸å…³æ˜æ–‡æ”»å‡»ï¼Œå…·ä½“å†…å®¹å°†åœ¨åé¢ä¸€ç¯‡RSAç¬”è®°ä¸­æåˆ°ã€‚</p><p>ä¸‹é¢å…ˆä¸Šä¸€ä¸‹è§£å¯†è„šæœ¬ï¼Œè¿™é‡Œæ˜¯çŸ¥é“äº†$x$å’Œ$x+b$çš„æƒ…å½¢ã€‚å½“ç„¶ï¼Œå¦‚æœä¸€æ¬¡é¡¹ä¸åŒï¼Œä¸¾ä¸ªä¾‹å­ã€‚æ¯”å¦‚æˆ‘ä»¬çŸ¥é“çš„æ˜¯$c&#x3D;E(2m+3)$å’Œ$x&#x3D;E(5m+8)$ã€‚å¯ä»¥å¾—åˆ°$C&#x3D;5^ec,X&#x3D;2^ex$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è·å¾—äº†$C&#x3D;E(10m+15),X&#x3D;E(10m+16)$çš„æƒ…å½¢ï¼Œå¡«å†™$b&#x3D;1,c&#x3D;C,x&#x3D;X$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è·å¾—$10m \mod n$çš„è®¡ç®—ç»“æœï¼Œç®€å•å¤„ç†ä¸€ä¸‹å°±å¯ä»¥è·å¾—$m$äº†ã€‚<del>ï¼ˆCTFä¸æ˜¯ACMï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦æŠŠæ‰€æœ‰çš„æ­¥éª¤å…¨æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œè‡ªå·±å¤šæ•°éƒ½æ˜¯åˆ†éƒ¨è®¡ç®—çš„ï¼Œæ•…å…³äºå¦‚ä½•å‡‘må‰é¢çš„ç³»æ•°ï¼Œè¯·è‡ªå·±æ ¹æ®æç¤ºæ„é€ ï¼‰</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sagemath code</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>(<span class="hljs-params">c1, c2, b, e, n</span>):<br>    PR.&lt;x&gt;=PolynomialRing(Zmod(n))<br>    g1 = x^e - c1<br>    g2 = (x+b)^e - c2<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">gcd</span>(<span class="hljs-params">g1, g2</span>):<br>        <span class="hljs-keyword">while</span> g2:<br>            g1, g2 = g2, g1 % g2<br>        <span class="hljs-keyword">return</span> g1.monic()<br>    <span class="hljs-keyword">return</span> -gcd(g1, g2)[<span class="hljs-number">0</span>]<br>n=<span class="hljs-comment">#å¡«å†™nå€¼</span><br>c=<span class="hljs-comment">#å¡«å†™æ˜æ–‡åŠ å¯†å†…å®¹</span><br>x=<span class="hljs-comment">#å¡«å†™ç›¸å…³æ˜æ–‡åŠ å¯†å†…å®¹</span><br>e=<span class="hljs-comment">#å¡«å†™åŠ å¯†æŒ‡æ•°ï¼Œä¸å®œå¤ªå¤§ï¼Œä¸€èˆ¬ä¸è¶…è¿‡100</span><br>b=<span class="hljs-comment">#å¡«å†™ä¸€æ¬¡å‡½æ•°ç›¸å·®çš„å¸¸æ•°é¡¹</span><br>m = attack(c,x,b,e,n)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-comment">#è¿™æ˜¯å·²çŸ¥må’Œm+bçš„æƒ…å½¢ã€‚å¦‚æœçŸ¥é“äº†Am+B,Cm+Dï¼Œå¯ä»¥å°†må‰é¢çš„ç³»æ•°ç»Ÿä¸€æˆGCD(A,C)åå†æ±‚è§£ã€‚</span><br></code></pre></td></tr></table></figure><h3 id="PART-6"><a href="#PART-6" class="headerlink" title="PART 6"></a>PART 6</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27</span><br>d=random.getrandbits(<span class="hljs-number">1024</span>*<span class="hljs-number">0.270</span>)<br>e=invmod(d,phin)<br><span class="hljs-built_in">hex</span>(e)=<span class="hljs-number">0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bb</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)=<span class="hljs-number">0xe3505f41ec936cf6bd8ae344bfec85746dc7d87a5943b3a7136482dd7b980f68f52c887585d1c7ca099310c4da2f70d4d5345d3641428797030177da6cc0d41e7b28d0abce694157c611697df8d0add3d900c00f778ac3428f341f47ecc4d868c6c5de0724b0c3403296d84f26736aa66f7905d498fa1862ca59e97f8f866c</span> <br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œçœ‹åˆ°$e$è¿™ä¹ˆå¤§ï¼Œå¹¶ä¸”$\ln d &#x3D;0.27 \ln n&lt; 0.292 \ln n$,å¾ˆå®¹æ˜“æƒ³åˆ°WinerAttack</p><p>ä¸è¿‡è¯•äº†å¥½å‡ ä¸ªweinerattackçš„è„šæœ¬éƒ½çˆ†ç ´å¤±è´¥ï¼ŒåŸå› å¯èƒ½æ˜¯å› ä¸ºæ­¤å¤„çš„$\dfrac{\ln d}{\ln n}&#x3D;0.27$ï¼Œè¿‡äºæ¥è¿‘$0.292$äº†ï¼Œå¯¼è‡´äº†çˆ†ç ´çš„å¤±è´¥ã€‚</p><p>ç½‘ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªä¸Winerattackç›¸ç±»ä¼¼ä½†ä¸æ˜¯Winerattackçš„è„šæœ¬ï¼Œå¡«å‚åæ”¾å…¥sagemathé‡Œç”¨å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br>debug = <span class="hljs-literal">True</span><br>strict = <span class="hljs-literal">False</span><br>helpful_only = <span class="hljs-literal">True</span><br>dimension_min = <span class="hljs-number">7</span> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">helpful_vectors</span>(<span class="hljs-params">BB, modulus</span>):<br>    nothelpful = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        <span class="hljs-keyword">if</span> BB[ii,ii] &gt;= modulus:<br>            nothelpful += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>( nothelpful, <span class="hljs-string">&quot;/&quot;</span>, BB.dimensions()[<span class="hljs-number">0</span>], <span class="hljs-string">&quot; vectors are not helpful&quot;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_overview</span>(<span class="hljs-params">BB, bound</span>):<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        a = (<span class="hljs-string">&#x27;%02d &#x27;</span> % ii)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">1</span>]):<br>            a += <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">if</span> BB[ii,jj] == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;X&#x27;</span><br>            <span class="hljs-keyword">if</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">60</span>:<br>                a += <span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= bound:<br>            a += <span class="hljs-string">&#x27;~&#x27;</span><br>        <span class="hljs-built_in">print</span>( a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">remove_unhelpful</span>(<span class="hljs-params">BB, monomials, bound, current</span>):<br>    <span class="hljs-keyword">if</span> current == -<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt;= dimension_min:<br>        <span class="hljs-keyword">return</span> BB<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(current, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># if it is unhelpful:</span><br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= bound:<br>            affected_vectors = <span class="hljs-number">0</span><br>            affected_vector_index = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ii + <span class="hljs-number">1</span>, BB.dimensions()[<span class="hljs-number">0</span>]):<br>                <span class="hljs-keyword">if</span> BB[jj, ii] != <span class="hljs-number">0</span>:<br>                    affected_vectors += <span class="hljs-number">1</span><br>                    affected_vector_index = jj<br>            <span class="hljs-keyword">if</span> affected_vectors == <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;* removing unhelpful vector&quot;</span>, ii)<br>                BB = BB.delete_columns([ii])<br>                BB = BB.delete_rows([ii])<br>                monomials.pop(ii)<br>                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="hljs-number">1</span>)<br>                <span class="hljs-keyword">return</span> BB<br>            <span class="hljs-keyword">elif</span> affected_vectors == <span class="hljs-number">1</span>:<br>                affected_deeper = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(affected_vector_index + <span class="hljs-number">1</span>, BB.dimensions()[<span class="hljs-number">0</span>]):<br>                    <span class="hljs-keyword">if</span> BB[kk, affected_vector_index] != <span class="hljs-number">0</span>:<br>                        affected_deeper = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">if</span> affected_deeper <span class="hljs-keyword">and</span> <span class="hljs-built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="hljs-built_in">abs</span>(bound - BB[ii, ii]):<br>                    <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;* removing unhelpful vectors&quot;</span>, ii, <span class="hljs-string">&quot;and&quot;</span>, affected_vector_index)<br>                    BB = BB.delete_columns([affected_vector_index, ii])<br>                    BB = BB.delete_rows([affected_vector_index, ii])<br>                    monomials.pop(affected_vector_index)<br>                    monomials.pop(ii)<br>                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="hljs-number">1</span>)<br>                    <span class="hljs-keyword">return</span> BB<br>    <span class="hljs-keyword">return</span> BB<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">boneh_durfee</span>(<span class="hljs-params">pol, modulus, mm, tt, XX, YY</span>):<br>    <span class="hljs-comment"># substitution (Herrman and May)</span><br>    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)<br>    Q = PR.quotient(x*y + <span class="hljs-number">1</span> - u) <span class="hljs-comment"># u = xy + 1</span><br>    polZ = Q(pol).lift()<br><br>    UU = XX*YY + <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># x-shifts</span><br>    gg = []<br>    <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm - kk + <span class="hljs-number">1</span>):<br>            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk<br>            gg.append(xshift)<br>    gg.sort()<br><br>    <span class="hljs-comment"># x-shifts list of monomials</span><br>    monomials = []<br>    <span class="hljs-keyword">for</span> polynomial <span class="hljs-keyword">in</span> gg:<br>        <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> polynomial.monomials():<br>            <span class="hljs-keyword">if</span> monomial <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> monomials:<br>                monomials.append(monomial)<br>    monomials.sort()<br>    <br>    <span class="hljs-comment"># y-shifts (selected by Herrman and May)</span><br>    <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, tt + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(floor(mm/tt) * jj, mm + <span class="hljs-number">1</span>):<br>            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)<br>            yshift = Q(yshift).lift()<br>            gg.append(yshift) <span class="hljs-comment"># substitution</span><br>    <br>    <span class="hljs-comment"># y-shifts list of monomials</span><br>    <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, tt + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(floor(mm/tt) * jj, mm + <span class="hljs-number">1</span>):<br>            monomials.append(u^kk * y^jj)<br><br>    <span class="hljs-comment"># construct lattice B</span><br>    nn = <span class="hljs-built_in">len</span>(monomials)<br>    BB = Matrix(ZZ, nn)<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>        BB[ii, <span class="hljs-number">0</span>] = gg[ii](<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, ii + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> monomials[jj] <span class="hljs-keyword">in</span> gg[ii].monomials():<br>                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)<br>    <span class="hljs-keyword">if</span> helpful_only:<br>        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="hljs-number">1</span>)<br>        nn = BB.dimensions()[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> nn == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;failure&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> debug:<br>        helpful_vectors(BB, modulus^mm)<br>    det = BB.det()<br>    bound = modulus^(mm*nn)<br>    <span class="hljs-keyword">if</span> det &gt;= bound:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;Try with highers m and t.&quot;</span>)<br>        <span class="hljs-keyword">if</span> debug:<br>            diff = (log(det) - log(bound)) / log(<span class="hljs-number">2</span>)<br>            <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))<br>        <span class="hljs-keyword">if</span> strict:<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)<br>    <span class="hljs-keyword">if</span> debug:<br>        matrix_overview(BB, modulus^mm)<br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)<br>    BB = BB.LLL()<br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;LLL is done!&quot;</span>)<br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;looking for independent vectors in the lattice&quot;</span>)<br>    found_polynomials = <span class="hljs-literal">False</span><br>    <br>    <span class="hljs-keyword">for</span> pol1_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn - <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> pol2_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(pol1_idx + <span class="hljs-number">1</span>, nn):<br>            PR.&lt;w,z&gt; = PolynomialRing(ZZ)<br>            pol1 = pol2 = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>                pol1 += monomials[jj](w*z+<span class="hljs-number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)<br>                pol2 += monomials[jj](w*z+<span class="hljs-number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)<br>            PR.&lt;q&gt; = PolynomialRing(ZZ)<br>            rr = pol1.resultant(pol2)<br>            <span class="hljs-keyword">if</span> rr.is_zero() <span class="hljs-keyword">or</span> rr.monomials() == [<span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="hljs-string">&quot;and&quot;</span>, pol2_idx)<br>                found_polynomials = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> found_polynomials:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found_polynomials:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    rr = rr(q, q)<br>    soly = rr.roots()<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(soly) == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;Your prediction (delta) is too small&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    soly = soly[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    ss = pol1(q, soly)<br>    solx = ss.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">return</span> solx, soly<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">example</span>():<br>    N = <br>    e = <br>    c = <br>    delta = <span class="hljs-number">.291</span> <span class="hljs-comment"># this means that d &lt; N^delta</span><br>    m = <span class="hljs-number">4</span> <span class="hljs-comment"># size of the lattice (bigger the better/slower)</span><br><br>    t = <span class="hljs-built_in">int</span>((<span class="hljs-number">1</span>-<span class="hljs-number">2</span>*delta) * m)  <span class="hljs-comment"># optimization from Herrmann and May</span><br>    X = <span class="hljs-number">2</span>*floor(N^delta)  <span class="hljs-comment"># this _might_ be too much</span><br>    Y = floor(N^(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>))    <span class="hljs-comment"># correct if p, q are ~ same size</span><br>    P.&lt;x,y&gt; = PolynomialRing(ZZ)<br>    A = <span class="hljs-built_in">int</span>((N+<span class="hljs-number">1</span>)/<span class="hljs-number">2</span>)<br>    pol = <span class="hljs-number">1</span> + x * (A + y)<br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;=== checking values ===&quot;</span>)<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;* delta:&quot;</span>, delta)<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;* delta &lt; 0.292&quot;</span>, delta &lt; <span class="hljs-number">0.292</span>)<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;* size of e:&quot;</span>, <span class="hljs-built_in">int</span>(log(e)/log(<span class="hljs-number">2</span>)))<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;* size of N:&quot;</span>, <span class="hljs-built_in">int</span>(log(N)/log(<span class="hljs-number">2</span>)))<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;* m:&quot;</span>, m, <span class="hljs-string">&quot;, t:&quot;</span>, t)<br><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;=== running algorithm ===&quot;</span>)<br>        start_time = time.time()<br>    solx, soly = boneh_durfee(pol, e, m, t, X, Y)<br>    <span class="hljs-keyword">if</span> solx &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;=== solution found ===&quot;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-literal">False</span>:<br>            <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;x:&quot;</span>, solx)<br>            <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;y:&quot;</span>, soly)<br><br>        d = <span class="hljs-built_in">int</span>(pol(solx, soly) / e)<br>        m = <span class="hljs-built_in">pow</span>(c,d,N)<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&#x27;[-]d is &#x27;</span> + <span class="hljs-built_in">str</span>(d))<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&#x27;[-]m is: &#x27;</span> + <span class="hljs-built_in">str</span>(m))<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&#x27;[-]hex(m) is: &#x27;</span> + <span class="hljs-string">&#x27;&#123;:x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">int</span>(m)))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;[!]no solution was found!&quot;</span>)<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&#x27;[!]All Done!&#x27;</span>)<br><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>((<span class="hljs-string">&quot;[!]Timer: %s s&quot;</span> % (time.time() - start_time)))<br>        <span class="hljs-built_in">print</span>( <span class="hljs-string">&#x27;[!]All Done!&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    example()<br></code></pre></td></tr></table></figure><h2 id="3-End"><a href="#3-End" class="headerlink" title="3.End"></a>3.End</h2><p>è¿™äº›RSAçš„ç ´è§£éƒ½æ˜¯éš¾åº¦è¾ƒé«˜çš„ï¼ŒåæœŸè¿˜æ˜¯éœ€è¦å¤šç†è§£ä¸€ä¸‹çš„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>21Jan2</title>
    <link href="/2021/01/21/21Jan2/"/>
    <url>/2021/01/21/21Jan2/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å¯’å‡çš„åˆ‡é¢˜2"><a href="#huangx607087å¯’å‡çš„åˆ‡é¢˜2" class="headerlink" title="huangx607087å¯’å‡çš„åˆ‡é¢˜2"></a>huangx607087å¯’å‡çš„åˆ‡é¢˜2</h1><h2 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0.ç®€ä»‹"></a>0.ç®€ä»‹</h2><p>åœ¨åŒæ ¡Soreat,Am473ur,Hermeså’ŒTo1inå››ä½å¯†ç å­¦å¤§ä½¬çš„å¸¦é¢†ä¸‹ï¼ŒBUUç»ˆäºä¸Šäº†1000åˆ†</p><h2 id="1-NPUCTF2020-è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒ"><a href="#1-NPUCTF2020-è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒ" class="headerlink" title="1.[NPUCTF2020]è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒ"></a>1.[NPUCTF2020]è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒ</h2><p>å¸¸è§„æ“ä½œï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹å‡ºé¢˜çš„ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>p = getPrime(<span class="hljs-number">25</span>)<br>e = <span class="hljs-comment"># Hidden</span><br>q = getPrime(<span class="hljs-number">25</span>)<br>n = p * q<br>m = bytes_to_long(flag.strip(<span class="hljs-string">b&quot;npuctf&#123;&quot;</span>).strip(<span class="hljs-string">b&quot;&#125;&quot;</span>))<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, e, n))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">4</span>, e, n))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">8</span>, e, n))<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">169169912654178</span><br><span class="hljs-string">128509160179202</span><br><span class="hljs-string">518818742414340</span><br><span class="hljs-string">358553002064450</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>å¯èƒ½ä½œä¸ºNPUCTF2020çš„å¯†ç å­¦ç­¾åˆ°é¢˜ï¼Œè¿™é“é¢˜éš¾åº¦å¹¶ä¸æ˜¯å¾ˆå¤§ï¼šé¢˜ç›®ç»™å‡ºäº†$2^e,4^e,8^e$å¯¹$n$å–æ¨¡çš„å€¼ã€‚ä¸è¿‡å¯¹äº$n,e$é¢˜ç›®å¹¶æ²¡æœ‰ç»™å‡ºã€‚</p><p>æ ¹æ®åŸºæœ¬çš„ç®—æ•°åŸç†ï¼š$2^eÃ—2^e&#x3D;4^e,2^eÃ—4^e&#x3D;8^e$ã€‚æˆ‘ä»¬å‡è®¾$2^e,4^e,8^e$å¯¹$n$å–æ¨¡çš„å€¼åˆ†åˆ«æ˜¯$a,b,c$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·ä¸¤ä¸ªç­‰å¼ï¼š<br>$$<br>a^2-b&#x3D;k_1n<br>$$<br>$$<br>ab-c&#x3D;k_2n<br>$$</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆå¿«å¾—åˆ°$a^2-b,ab-c$çš„å€¼ï¼Œç„¶åç›´æ¥æ”¾Sagemathä¸­å¯¹è¿™ä¸¤ä¸ªæ•°è¿›è¡Œå› å¼åˆ†è§£å³å¯ã€‚</p><p><img src="/2021/01/21/21Jan2/101.png" alt="1-1"></p><p>æ ¹æ®å›¾ç‰‡å‘ç°å…±åŒçš„å› æ•°æ˜¯$18195301,28977097$ï¼Œé‚£ä¹ˆ$p,q$å¾—è§£ã€‚</p><p>åé¢ç›´æ¥ç”¨C++çˆ†ç ´$e$çš„å€¼å³å¯ï¼Œå¾—åˆ°$e&#x3D;808723997$ï¼Œç”¨æ—¶ä¸åˆ°$10$ç§’ï¼Œç„¶åè¿™é“é¢˜å°±æ˜¯æ­£å¸¸çš„RSAè§£å¯†äº†ã€‚</p><h2 id="2-AFCTF2018-MyOwnCBC"><a href="#2-AFCTF2018-MyOwnCBC" class="headerlink" title="2.[AFCTF2018]MyOwnCBC"></a>2.[AFCTF2018]MyOwnCBC</h2><p>åˆæ˜¯ä¸€é“AESè§£å¯†é¢˜ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥å…ˆæ¥äº†è§£ä¸€ä¸‹CBCæ¨¡å¼ï¼šCBCåŠ å¯†æ¨¡å¼çš„ç‰¹ç‚¹å°±æ˜¯æ‰€æœ‰çš„åŠ å¯†è¿æ¥éƒ½åœ¨ä¸€èµ·ï¼Œå¹¶ä¸”æ¯æ¬¡åŠ å¯†çš„å†…å®¹éƒ½ä¾èµ–äºä¸Šä¸€ä¸ªåŠ å¯†åçš„çŠ¶æ€ã€‚ç¬¬ä¸€ä¸ªçŠ¶æ€ç”±åˆå§‹å‘é‡ivï¼ˆå¯ä»¥ç†è§£ä¸ºç¬¬$0$ä¸ªçŠ¶æ€ï¼‰å†³å®šã€‚</p><p>ç»§ç»­ä¸Šä¸€ä¸‹é¢˜ç›®çš„å‡ºé¢˜ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Random <span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">MyOwnCBC</span>(<span class="hljs-params">key, plain</span>):<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(key)!=<span class="hljs-number">32</span>:<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;error!&quot;</span><br>cipher_txt = <span class="hljs-string">b&quot;&quot;</span><br>cipher_arr = []<br>cipher = AES.new(key, AES.MODE_ECB, <span class="hljs-string">&quot;&quot;</span>)<br>plain = [plain[i:i+<span class="hljs-number">32</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(plain), <span class="hljs-number">32</span>)]<br><span class="hljs-built_in">print</span> plain<br>cipher_arr.append(cipher.encrypt(plain[<span class="hljs-number">0</span>]))<br>cipher_txt += cipher_arr[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(plain)):<br>cipher = AES.new(cipher_arr[i-<span class="hljs-number">1</span>], AES.MODE_ECB, <span class="hljs-string">&quot;&quot;</span>)<br>cipher_arr.append(cipher.encrypt(plain[i]))<br>cipher_txt += cipher_arr[i]<br><span class="hljs-keyword">return</span> cipher_txt<br>key = random.getrandbits(<span class="hljs-number">256</span>)<br>key = long_to_bytes(key)<br>s = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>s = f.read()<br>f.close()<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag_cipher&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>f.write(MyOwnCBC(key, s))<br>f.close()<br></code></pre></td></tr></table></figure><p>é¢˜ç›®å…ˆæŠŠæ˜æ–‡åˆ†æˆäº†$32$ä½ä¸€ç»„ç„¶åç”¨AESçš„ECBæ¨¡å¼è¿›è¡ŒåŠ å¯†çš„ï¼Œå¯†é’¥å°±ä¾èµ–äºä¸Šä¸€ä¸ªæ˜æ–‡çš„åŠ å¯†ç»“æœã€‚æ‰€ä»¥æœ€åçš„å¯†æ–‡é•¿åº¦ä¸æ˜æ–‡é•¿åº¦ä¸€è‡´ã€‚å¯†æ–‡ä¸€å…±$1696$ä½ï¼Œå¯ä»¥æ¨æ–­ä¸€å…±åˆ†äº†$53$ç»„ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦é€ä¸ªè¯»å–å¯†æ–‡ï¼Œç„¶åå°†å¯†æ–‡åˆ†æˆ$53$ç»„å­˜åœ¨æ•°ç»„é‡Œï¼Œæ¨¡ä»¿ä»–çš„åŠ å¯†ä»£ç è¿›è¡Œè§£å¯†å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>fp=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag_cipher.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<br>b=fp.read()<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(b))<br>C=[]<br>M=[]<br>S=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(b),<span class="hljs-number">32</span>):<br>    C.append(b[i:i+<span class="hljs-number">32</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(C))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">52</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>    Enc=AES.new(C[i-<span class="hljs-number">1</span>],AES.MODE_ECB)<br>    M=[Enc.decrypt(C[i])]+M<br>    S+=M[<span class="hljs-number">0</span>].decode()<br><span class="hljs-built_in">print</span>(S)<br></code></pre></td></tr></table></figure><p>æœ€åæˆ‘ä»¬ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯è¿™æ ·çš„<del>ä½†æˆ‘æœ€åå¹¶æ²¡æœ‰æ±‚å‡ºivï¼Œæˆ–è®¸è¿™ä¸ªivä¹Ÿæ˜¯æ±‚ä¸å‡ºæ¥çš„å§</del></p><p><img src="/2021/01/21/21Jan2/201.png" alt="2-1"></p><p>æ ¹æ®æˆ‘è¿™ä¸ª<del>fw</del>çš„åˆ†æï¼Œç­”æ¡ˆåº”è¯¥æ˜¯<code>afctf&#123;Don&#39;t_be_fooled_by_yourself&#125;</code> ï¼Œæœ€åç­”æ¡ˆä¹ŸéªŒè¯äº†è¿™ä¸ªçŒœæƒ³</p><h2 id="3-QCTF2018-Xman-RSA"><a href="#3-QCTF2018-Xman-RSA" class="headerlink" title="3.[QCTF2018]Xman-RSA"></a>3.[QCTF2018]Xman-RSA</h2><p>æ‰“å¼€è§£å¯†è„šæœ¬ï¼šå¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªä»£ç è¢«ä½¿ç”¨äº†æ›¿æ¢å¯†ç åŠ å¯†è¿‡äº†ã€‚æ ¹æ®è‡ªå·±å¯¹Pythoné‚£ä¸€ç‚¹ç‚¹çš„ç†Ÿæ‚‰ç¨‹åº¦çš„åˆ†æï¼Œå¾ˆå¿«åœ°è¿˜åŸäº†åŠ å¯†æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> is_prime<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bytes_to_num</span>(<span class="hljs-params">b</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(b.encode(<span class="hljs-string">&#x27;hex&#x27;</span>), <span class="hljs-number">16</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">num_to_bytes</span>(<span class="hljs-params">n</span>):<br>b = <span class="hljs-built_in">hex</span>(n)[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>]<br>b = <span class="hljs-string">&#x27;0&#x27;</span> + b <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(b)%<span class="hljs-number">2</span> == <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> b<br><span class="hljs-keyword">return</span> b.decode(<span class="hljs-string">&#x27;hex&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_a_prime</span>(<span class="hljs-params">l</span>):<br>random_seed = urandom(l)<br><br>num = bytes_to_num(random_seed)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br><span class="hljs-keyword">if</span> is_prime(num):<br><span class="hljs-keyword">break</span><br>num+=<span class="hljs-number">1</span><br><span class="hljs-keyword">return</span> num<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">s, e, n</span>):<br>p = bytes_to_num(s)<br>p = <span class="hljs-built_in">pow</span>(p, e, n)<br><span class="hljs-keyword">return</span> num_to_bytes(p).encode(<span class="hljs-string">&#x27;hex&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">separate</span>(<span class="hljs-params">n</span>):<br>p = n % <span class="hljs-number">4</span><br>t = (p*p) % <span class="hljs-number">4</span><br><span class="hljs-keyword">return</span> t == <span class="hljs-number">1</span><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>flag = f.read()<br>msg1 = <span class="hljs-string">&quot;&quot;</span><br>msg2 = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br><span class="hljs-keyword">if</span> separate(i):<br>msg2 += flag[i]<br><span class="hljs-keyword">else</span>:<br>msg1 += flag[i]<br>p1 = get_a_prime(<span class="hljs-number">128</span>)<br>p2 = get_a_prime(<span class="hljs-number">128</span>)<br>p3 = get_a_prime(<span class="hljs-number">128</span>)<br>n1 = p1*p2<br>n2 = p1*p3<br>e = <span class="hljs-number">0x1001</span><br>c1 = encrypt(msg1, e, n1)<br>c2 = encrypt(msg2, e, n2)<br><span class="hljs-built_in">print</span>(c1)<br><span class="hljs-built_in">print</span>(c2)<br>e1 = <span class="hljs-number">0x1001</span><br>e2 = <span class="hljs-number">0x101</span><br>p4 = get_a_prime(<span class="hljs-number">128</span>)<br>p5 = get_a_prime(<span class="hljs-number">128</span>)<br>n3 = p4*p5<br>c1 = num_to_bytes(<span class="hljs-built_in">pow</span>(n1, e1, n3)).encode(<span class="hljs-string">&#x27;hex&#x27;</span>)<br>c2 = num_to_bytes(<span class="hljs-built_in">pow</span>(n1, e2, n3)).encode(<span class="hljs-string">&#x27;hex&#x27;</span>)<br><span class="hljs-built_in">print</span>(c1)<br><span class="hljs-built_in">print</span>(c2)<br><span class="hljs-built_in">print</span>(base64.b64encode(num_to_bytes(n2)))<br><span class="hljs-built_in">print</span>(base64.b64encode(num_to_bytes(n3)))<br></code></pre></td></tr></table></figure><p>é¦–å…ˆæˆ‘ä»¬å…ˆå¯¹$n_2,n_3$è¿›è¡ŒBase64è§£ç ï¼Œç„¶åè½¬åŒ–æˆæ•°å­—ã€‚ä½¿ç”¨æˆ‘åšå®¢ä¸­çš„<strong>RSA Notes 1</strong>ä¸­çš„ç›¸å…³è„šæœ¬ï¼Œé€šè¿‡å…±æ¨¡æ”»å‡»æ±‚å¾—$n_1$ã€‚æ±‚å¾—$n_1$åï¼Œæ ¹æ®æ¨¡ä¸äº’ç´ ï¼Œç›´æ¥æ±‚$\gcd(n_1,n_2)$ï¼Œå¾ˆå¿«åœ°åˆ†è§£äº†$n_1,n_2$ï¼Œæœ€åä¸¤æ¬¡è§£å¯†ï¼Œæ ¹æ®ä»–çš„separateå‡½æ•°ç›´æ¥æ‹¼æ¥æ˜æ–‡å³å¯ï¼Œéš¾åº¦ä¸é«˜ã€‚</p><p>ä¸ºä¿é™©èµ·è§è¿˜æ˜¯ä¸Šä¸€ä¸‹æœ€åçš„è„šæœ¬ï¼Œå…±æ¨¡æ”»å‡»è§<strong>RSA Notes 1</strong>æä¾›çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">separate</span>(<span class="hljs-params">n</span>):<br>p = n % <span class="hljs-number">4</span><br>t = (p*p) % <span class="hljs-number">4</span><br><span class="hljs-keyword">return</span> t == <span class="hljs-number">1</span><br>n2=<span class="hljs-string">&#x27;PVNHb2BfGAnmxLrbKhgsYXRwWIL9eOj6K0s3I0slKHCTXTAUtZh3T0r+RoSlhpO3+77AY8P7WETYz2Jzuv5FV/mMODoFrM5fMyQsNt90VynR6J3Jv+fnPJPsm2hJ1Fqt7EKaVRwCbt6a4BdcRoHJsYN/+eh7k/X+FL5XM7viyvQxyFawQrhSV79FIoX6xfjtGW+uAeVF7DScRcl49dlwODhFD7SeLqzoYDJPIQS+VSb3YtvrDgdV+EhuS1bfWvkkXRijlJEpLrgWYmMdfsYX8u/+Ylf5xcBGn3hv1YhQrBCg77AHuUF2w/gJ/ADHFiMcH3ux3nqOsuwnbGSr7jA6Cw==&#x27;</span><br>n3=<span class="hljs-string">&#x27;TmNVbWUhCXR1od3gBpM+HGMKK/4ErfIKITxomQ/QmNCZlzmmsNyPXQBiMEeUB8udO7lWjQTYGjD6k21xjThHTNDG4z6C2cNNPz73VIaNTGz0hrh6CmqDowFbyrk+rv53QSkVKPa8EZnFKwGz9B3zXimm1D+01cov7V/ZDfrHrEjsDkgK4ZlrQxPpZAPl+yqGlRK8soBKhY/PF3/GjbquRYeYKbagpUmWOhLnF4/+DP33ve/EpaSAPirZXzf8hyatL4/5tAZ0uNq9W6T4GoMG+N7aS2GeyUA2sLJMHymW4cFK5l5kUvjslRdXOHTmz5eHxqIV6TmSBQRgovUijlNamQ==&#x27;</span><br>n2=bytes_to_long(b64decode(n2))<br>n3=bytes_to_long(b64decode(n3))<br>n1=<span class="hljs-number">2499586809914462821807624371088011200618603528498132509598946284572455726453497171635086810524607288333625665025664872216634366700044105279185519761587818169021167370991396691510275499486673922916370294043072503635630922980240462022218565365191228535222150496387990987123639567257124081274667568443678527637259644488779394704508217357758791670308548246801142468699716221789070607334747835552167450340441488756779323653879402176647890584656379628685893686585469918686253137796663587854943386347039389769790329948165162483370187914412810153613198247569427480466488647563900948387020677830797976534568626241686906738179</span><br>p=GCD(n1,n2)<br>q1,q2=n1//p,n2//p<br>phi1,phi2=(p-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>),(p-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>)<br>d1,d2=inverse(<span class="hljs-number">0x1001</span>,phi1),inverse(<span class="hljs-number">0x1001</span>,phi2)<br>c1=<span class="hljs-number">0x1240198b148089290e375b999569f0d53c32d356b2e95f5acee070f016b3bef243d0b5e46d9ad7aa7dfe2f21bda920d0ac7ce7b1e48f22b2de410c6f391ce7c4347c65ffc9704ecb3068005e9f35cbbb7b27e0f7a18f4f42ae572d77aaa3ee189418d6a07bab7d93beaa365c98349d8599eb68d21313795f380f05f5b3dfdc6272635ede1f83d308c0fdb2baf444b9ee138132d0d532c3c7e60efb25b9bf9cb62dba9833aa3706344229bd6045f0877661a073b6deef2763452d0ad7ab3404ba494b93fd6dfdf4c28e4fe83a72884a99ddf15ca030ace978f2da87b79b4f504f1d15b5b96c654f6cd5179b72ed5f84d3a16a8f0d5bf6774e7fd98d27bf3c9839</span><br>c2=<span class="hljs-number">0x129d5d4ab3f9e8017d4e6761702467bbeb1b884b6c4f8ff397d078a8c41186a3d52977fa2307d5b6a0ad01fedfc3ba7b70f776ba3790a43444fb954e5afd64b1a3abeb6507cf70a5eb44678a886adf81cb4848a35afb4db7cd7818f566c7e6e2911f5ababdbdd2d4ff9825827e58d48d5466e021a64599b3e867840c07e29582961f81643df07f678a61a9f9027ebd34094e272dfbdc4619fa0ac60f0189af785df77e7ec784e086cf692a7bf7113a7fb8446a65efa8b431c6f72c14bcfa49c9b491fb1d87f2570059e0f13166a85bb555b40549f45f04bc5dbd09d8b858a5382be6497d88197ffb86381085756365bd757ec3cdfa8a77ba1728ec2de596c5ab</span><br>m1,m2=<span class="hljs-built_in">pow</span>(c1,d1,n1),<span class="hljs-built_in">pow</span>(c2,d2,n2)<br>m1,m2=long_to_bytes(m1),long_to_bytes(m2)<br>m1,m2=m1.decode(),m2.decode()<br>s,n=<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-built_in">len</span>(m1)+<span class="hljs-built_in">len</span>(m2)<br>po1,po2=<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    <span class="hljs-keyword">if</span>(separate(i)):<br>        s=s+m2[po2]<br>        po2+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        s=s+m1[po1]<br>        po1+=<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(s)<br></code></pre></td></tr></table></figure><h2 id="4-NPUCTF2020-å…±-æ¨¡-æ”»-å‡»"><a href="#4-NPUCTF2020-å…±-æ¨¡-æ”»-å‡»" class="headerlink" title="4.[NPUCTF2020]å…± æ¨¡ æ”» å‡»"></a>4.[NPUCTF2020]å…± æ¨¡ æ”» å‡»</h2><h3 id="PART-1"><a href="#PART-1" class="headerlink" title="PART 1"></a>PART 1</h3><p>åšé¢˜ç›®æ—¶ï¼Œå‘ç°é¢˜ç›®ç»™äº†ä¸€ä¸ªhintï¼Œæˆ‘ä»¬å…ˆæ‰“å¼€çœ‹ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> hint<br>m = bytes_to_long(hint)<br>p = getPrime(<span class="hljs-number">256</span>)<br>c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">256</span>, p)<br><span class="hljs-built_in">print</span>(p)<br>p, q = getPrime(<span class="hljs-number">256</span>), getPrime(<span class="hljs-number">256</span>)<br>n = p * q<br>e1, e2 = getPrime(<span class="hljs-number">32</span>), getPrime(<span class="hljs-number">32</span>)<br>c1, c2 = <span class="hljs-built_in">pow</span>(c, e1, n), <span class="hljs-built_in">pow</span>(c, e2, n)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(e1, c1)<br><span class="hljs-built_in">print</span>(e2, c2)<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¦‚æœæƒ³è§£å¯†è¿™ä¸ªhint,é¦–å…ˆæ¥çš„å°±æ˜¯ä¸€æ¬¡å…±æ¨¡æ”»å‡»ï¼Œè§£å‡ºè¿™ä¸ªhintåŠ å¯†åçš„$c$å€¼ï¼Œç„¶åæˆ‘ä»¬å°±æ˜¯è¦è§£åŒä½™æ–¹ç¨‹$x^{256}\equiv c \pmod p$ã€‚å‘ç°$p$æ˜¯ç´ æ•°ï¼Œå¹¶ä¸”$\gcd(p-1,256)&#x3D;4$ï¼Œè¯´æ˜æ–¹ç¨‹ä¸€å…±æœ‰$4$ä¸ªæ ¹ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨Sagemathè§£$\text{GF}$åŸŸä¸Šçš„æ–¹ç¨‹ï¼Œå¾—åˆ°$4$ä¸ªè§£å¦‚ä¸‹å›¾ï¼Œç„¶åä¸€ä¸ª ä¸€ä¸ªé€šè¿‡<code>long_to_bytes</code>è½¬æ¢æˆå­—ç¬¦ï¼Œå¯ä»¥å¾—åˆ°hintï¼š<code>m.bit_length()&lt;400</code></p><p><img src="/2021/01/21/21Jan2/401.png" alt="4-1"></p><h3 id="PART-2"><a href="#PART-2" class="headerlink" title="PART 2"></a>PART 2</h3><p>å¾—åˆ°äº†hintä¹‹åï¼Œæˆ‘ä»¬å†è¿›å…¥æ­£è§„çš„è§£é¢˜é¢˜ç›®ä¸­æ¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>flag = flag.strip(<span class="hljs-string">b&quot;npuctf&#123;&quot;</span>).strip(<span class="hljs-string">b&quot;&#125;&quot;</span>)<br>m = bytes_to_long(flag)<br>p, q = getPrime(<span class="hljs-number">512</span>), getPrime(<span class="hljs-number">512</span>)<br>n = p * q<br>e1, e2 = p, q<br>c1, c2 = <span class="hljs-built_in">pow</span>(m, e1, n), <span class="hljs-built_in">pow</span>(m, e2, n)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(c1)<br><span class="hljs-built_in">print</span>(c2)<br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜è™½ç„¶ä¹Ÿæ˜¯å…±æ¨¡æ”»å‡»ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæŒ‡æ•°å¾ˆç‰¹æ®Šï¼Œæ°å¥½å°±æ˜¯$n$çš„ä¸¤ä¸ªç´ å› å­$p,q$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çŸ¥é“äº†$m^p,m^q$çš„å€¼ï¼Œä¸‹é¢å°±æ˜¯è¦è€ƒè™‘ä¸€ä¸‹æ„é€ å¼å­çš„é—®é¢˜ã€‚</p><p>æ ¹æ®ä¹‹å‰åœ¨ç¦»æ•£å¯¹æ•°ä¸­æ¢è®¨è¿‡çš„ä¸€ä¸ªå†…å®¹ï¼šåœ¨æ¨¡$M$ï¼ˆ$M$ä¸ä¸€å®šæ˜¯ç´ æ•°ï¼‰çš„æ„ä¹‰ä¸‹æ‰€æœ‰çš„$\mathrm{ord}(x)$å‡ä¸º$\phi(M)$çš„å› æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š<br>$$<br>m^p\equiv m \pmod p \Rightarrow m^p\equiv ap+m\pmod n<br>$$<br>$$<br>m^q\equiv m \pmod q \Rightarrow m^q\equiv bq+m\pmod n<br>$$</p><p>ä¸‹é¢å°±æ˜¯è¦æƒ³åŠæ³•æ„é€ ä¸€ä¸‹ä¸¤ä¸ªå¼å­ï¼Œå¾ˆæ˜¾ç„¶æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸¤ä¸ªå¼å­ç›¸ä¹˜å’Œç›¸åŠ ï¼Œé‚£ä¹ˆå°±æœ‰ä¸‹é¢ä¸¤ä¸ªç®—å¼<br>$$<br>F&#x3D;m^p+m^q\equiv ap+bq+2m \pmod m<br>$$<br>$$<br>G&#x3D;m^pm^q&#x3D;m^{p+q}\equiv m^2+m(ap+bq)+abpq \pmod n<br>$$</p><p>ç”±äº$n&#x3D;pq$ï¼Œæ‰€ä»¥$G$å¼çš„æœ€åä¸€é¡¹æœ‰$abpq\equiv 0 \pmod n$ï¼Œæ‰€ä»¥åŒ–ç®€$G$å¼ï¼Œæœ‰<br>$$<br>G \equiv m^2+m(ap+bq) \pmod n<br>$$<br>$F$å¼å­ä¹˜ä¸Š$m$ï¼Œå¾—ï¼š<br>$$<br>mF\equiv m(ap+bq)+2m^2 \pmod n<br>$$<br>å†è¿›è¡Œä¸¤æ­¥æ¨å¯¼<br>$$<br>mF-G\equiv m^2\pmod n<br>$$<br>$$<br>m^2-mF+G\equiv 0 \pmod n<br>$$</p><p>å› ä¸º$F&#x3D;c_1+c_2,G&#x3D;c_1c_2$ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„å»ºæ–¹ç¨‹$m^2-(c_1+c_2)m+c_1c_2\equiv 0 \pmod n$ï¼Œç”±äº$n$å¹¶ä¸æ˜¯ç´ æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ¢ä¸€ç§æ±‚æ ¹çš„æ–¹å¼ï¼Œè¦ç”¨ä¸Šhintä¸­ç»™å‡ºçš„å†…å®¹ï¼Œé™å®šä¸€ä¸‹æ ¹çš„å¤§å°ä¸è¶…è¿‡$2^{400}$ï¼Œå³å¯å¾—è§£</p><p><img src="/2021/01/21/21Jan2/402.png" alt="4-2"></p><h2 id="5-AFCTF2018-Tiny-LFSR"><a href="#5-AFCTF2018-Tiny-LFSR" class="headerlink" title="5[AFCTF2018]Tiny LFSR"></a>5[AFCTF2018]Tiny LFSR</h2><p>ä¸€é“lfsré¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> unhexlify<br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(sys.argv)&lt;<span class="hljs-number">4</span>):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Usage: python Encrypt.py keyfile plaintext ciphername&quot;</span>)<br>exit(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr</span>(<span class="hljs-params">R, mask</span>):<br>output = (R &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffffffffffffff</span><br>i=(R&amp;mask)&amp;<span class="hljs-number">0xffffffffffffffff</span><br>lastbit=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> i!=<span class="hljs-number">0</span>:<br>lastbit^=(i&amp;<span class="hljs-number">1</span>)<br>i=i&gt;&gt;<span class="hljs-number">1</span><br>output^=lastbit<br><span class="hljs-keyword">return</span> (output,lastbit)<br>R = <span class="hljs-number">0</span><br>key = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(sys.argv[<span class="hljs-number">1</span>],<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>key = f.read()<br>R = <span class="hljs-built_in">int</span>(key,<span class="hljs-number">16</span>)<br>f.close<br>mask = <span class="hljs-number">0xd800000000000000</span><br>a = <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(b, <span class="hljs-number">16</span>)) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> [key[i:i+<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(key), <span class="hljs-number">2</span>)]])<br>f=<span class="hljs-built_in">open</span>(sys.argv[<span class="hljs-number">2</span>],<span class="hljs-string">&quot;r&quot;</span>)<br>ff = <span class="hljs-built_in">open</span>(sys.argv[<span class="hljs-number">3</span>],<span class="hljs-string">&quot;wb&quot;</span>)<br>s = f.read()<br>f.close()<br>lent = <span class="hljs-built_in">len</span>(s)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(a)):<br>ff.write((<span class="hljs-built_in">ord</span>(s[i])^<span class="hljs-built_in">ord</span>(a[i])).to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a), lent):<br>    tmp=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        (R,out)=lfsr(R,mask)<br>        tmp=(tmp &lt;&lt; <span class="hljs-number">1</span>)^out<br>    ff.write((tmp^<span class="hljs-built_in">ord</span>(s[i])).to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>))<br>ff.close()<br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªæ˜æ–‡PlainåŠå…¶åŠ å¯†åçš„æ ·å­ï¼ŒåŒæ—¶ä¹Ÿç»™å‡ºäº†flagçš„å¯†æ–‡ï¼Œå¾ˆæ˜¾ç„¶æ˜¯è¦æ±‚flagæ˜æ–‡ã€‚</p><p>æ ¹æ®å‡ºé¢˜ä»£ç å¯ä»¥å‘ç°ï¼šmaskçš„å€¼æ˜¯$16$ä½$16$è¿›åˆ¶æ•°ï¼Œæ‰€ä»¥å¯†é’¥çš„é•¿åº¦ä¹Ÿåº”è¯¥æ˜¯$16$ä½$16$è¿›åˆ¶æ•°ï¼ˆä¹Ÿå°±æ˜¯$8$å­—èŠ‚ï¼‰ï¼Œå¹¶ä¸”æœ€åæœ€å…ˆç»™å‡ºçš„åº”è¯¥æ˜¯æ˜æ–‡ä¸å¯†é’¥çš„åŠ å¯†ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å…ˆå°†æ˜æ–‡ä¸å¯†é’¥å¼‚æˆ–ä¸€ä¸‹ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>fp,gp=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;[2]Plain.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>),<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;[3]cipher.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<br>pl,cp=fp.read().encode(),gp.read()<br>pl,cp=bytes_to_long(pl),bytes_to_long(cp)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(pl^cp))<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">0x123456789abcdef184bb2ec4d1ee7b86e3a6e926e3a6e8d203b2e03203b2f2c6226e22e6226fad1953215e7953374e745e7cf6d45f97467bf6adc09be5779eecc4444ccd535dba9f2aaa7fe85ad0b2aa800a81ff94ff680380e39205550c78208801067007b0cb6</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„åˆ°æœ€åçš„$16$è¿›åˆ¶ä½æ•°çš„é•¿åº¦æ˜¯å¥‡æ•°ï¼ˆä¸€å¼€å§‹æˆ‘æ²¡å‘ç°ï¼Œè€½è¯¯äº†å¥½é•¿çš„æ—¶é—´ï¼‰ï¼Œè¯´æ˜äº†åº”è¯¥åœ¨å‰é¢è¡¥$0$ï¼Œé‚£ä¹ˆå¯†é’¥å°±åº”è¯¥æ˜¯$0123456789\text {ABCDEF}_h$ï¼Œè¿™ä¹ˆå¥½çš„æ•°å­—ï¼Œ<del>è¯´æ˜æˆ‘ä»¬çš„å¯†é’¥å‘ç°æ˜¯å¯¹çš„</del></p><p>æ‹¿åˆ°äº†å¯†é’¥ï¼Œä¹Ÿå°±è¯´æ˜æˆ‘ä»¬å°±æ‹¿åˆ°äº†lfsrçš„ç§å­,è¿›è€Œå°±å¯ä»¥è·å¾—æœ€åçš„flagäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr</span>(<span class="hljs-params">R, mask</span>):<br>        output = (R &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffffffffffffff</span><br>        i=(R&amp;mask)&amp;<span class="hljs-number">0xffffffffffffffff</span><br>        lastbit=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> i!=<span class="hljs-number">0</span>:<br>                lastbit^=(i&amp;<span class="hljs-number">1</span>)<br>                i=i&gt;&gt;<span class="hljs-number">1</span><br>        output^=lastbit<br>        <span class="hljs-keyword">return</span> (output,lastbit)<br>R=<span class="hljs-number">0x0123456789abcdef</span><br>mask=<span class="hljs-number">0xd800000000000000</span><br>a=<span class="hljs-string">b&#x27;\x01\x23\x45\x67\x89\xab\xcd\xef&#x27;</span><br>fp=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag_encode.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)<br>c=fp.read()<br>ans=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        ans+=<span class="hljs-built_in">chr</span>(a[i]^c[i])<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>,<span class="hljs-number">1213</span>):<br>        tmp=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>                (R,out)=lfsr(R,mask)<br>                tmp=(tmp &lt;&lt; <span class="hljs-number">1</span>)^out<br>        ans+=<span class="hljs-built_in">chr</span>(tmp^c[i])<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>21Jan1</title>
    <link href="/2021/01/18/21Jan1/"/>
    <url>/2021/01/18/21Jan1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å¯’å‡çš„åˆ‡é¢˜1"><a href="#huangx607087å¯’å‡çš„åˆ‡é¢˜1" class="headerlink" title="huangx607087å¯’å‡çš„åˆ‡é¢˜1"></a>huangx607087å¯’å‡çš„åˆ‡é¢˜1</h1><h2 id="0x00-ç®€ä»‹"><a href="#0x00-ç®€ä»‹" class="headerlink" title="0x00 ç®€ä»‹"></a>0x00 ç®€ä»‹</h2><p>è¿‘æœŸBUUCTFçš„åˆ†æ•°ä¸Šåˆ°äº†500åˆ†ï¼Œä¸è¿‡<del>ç›®å‰çš„å½¢å¼ä¾ç„¶å¾ˆä¸¥å³»ï¼Œä¸æˆ‘åŒçº§çš„ä¸€ä¸ªäººæ¯”æˆ‘å¼ºå¾ˆå¤šï¼Œè€Œæˆ‘å´åœ¨è¿™é‡Œè¡¥åŸºç¡€ï¼Œæ„Ÿè§‰æ ¡é˜Ÿé‡ŒåŒä¸€çº§é™¤webæ–¹å‘çš„äººä¸å¯åŒæ—¶å­˜åœ¨2ä¸ªåŠä»¥ä¸Šï¼Œå‹åŠ›è¿˜æ˜¯éå¸¸å¤§çš„</del></p><h2 id="0x01-ECC-RSA"><a href="#0x01-ECC-RSA" class="headerlink" title="0x01 ECC &amp; RSA"></a>0x01 ECC &amp; RSA</h2><p>è¿™æ˜¯ä¸€é“ç»“åˆäº†ç¦»æ•£å¯¹æ•°å’Œæ¤­åœ†æ›²çº¿çš„å¯†ç ä½“ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹åŠ å¯†ä»£ç å’Œé¢˜ç›®æ‰€ç»™å‡ºçš„çš„å„ç§æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> fastecdsa.curve <span class="hljs-keyword">import</span> P521 <span class="hljs-keyword">as</span> Curve<br><span class="hljs-keyword">from</span> fastecdsa.point <span class="hljs-keyword">import</span> Point<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, isPrime<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> getrandbits<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_rsa_primes</span>(<span class="hljs-params">G</span>):<br>urand = bytes_to_long(urandom(<span class="hljs-number">521</span>//<span class="hljs-number">8</span>))<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>s = getrandbits(<span class="hljs-number">521</span>) ^ urand<br>Q = s*G<br><span class="hljs-keyword">if</span> isPrime(Q.x) <span class="hljs-keyword">and</span> isPrime(Q.y):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ECC Private key:&quot;</span>, <span class="hljs-built_in">hex</span>(s))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;RSA primes:&quot;</span>, <span class="hljs-built_in">hex</span>(Q.x), <span class="hljs-built_in">hex</span>(Q.y))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Modulo:&quot;</span>, <span class="hljs-built_in">hex</span>(Q.x * Q.y))<br><span class="hljs-keyword">return</span> (Q.x, Q.y)<br>flag = <span class="hljs-built_in">int</span>.from_bytes(<span class="hljs-built_in">input</span>(), byteorder=<span class="hljs-string">&quot;big&quot;</span>)<br>ecc_p = Curve.p<br>a = Curve.a<br>b = Curve.b<br>Gx = Curve.gx<br>Gy = Curve.gy<br>G = Point(Gx, Gy, curve=Curve)<br>e = <span class="hljs-number">0x10001</span><br>p, q = gen_rsa_primes(G)<br>n = p*q<br>file_out = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;downloads/ecc-rsa.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>file_out.write(<span class="hljs-string">&quot;ECC Curve Prime: &quot;</span> + <span class="hljs-built_in">hex</span>(ecc_p) + <span class="hljs-string">&quot;\n&quot;</span>)<br>file_out.write(<span class="hljs-string">&quot;Curve a: &quot;</span> + <span class="hljs-built_in">hex</span>(a) + <span class="hljs-string">&quot;\n&quot;</span>)<br>file_out.write(<span class="hljs-string">&quot;Curve b: &quot;</span> + <span class="hljs-built_in">hex</span>(b) + <span class="hljs-string">&quot;\n&quot;</span>)<br>file_out.write(<span class="hljs-string">&quot;Gx: &quot;</span> + <span class="hljs-built_in">hex</span>(Gx) + <span class="hljs-string">&quot;\n&quot;</span>)<br>file_out.write(<span class="hljs-string">&quot;Gy: &quot;</span> + <span class="hljs-built_in">hex</span>(Gy) + <span class="hljs-string">&quot;\n&quot;</span>)<br>file_out.write(<span class="hljs-string">&quot;e: &quot;</span> + <span class="hljs-built_in">hex</span>(e) + <span class="hljs-string">&quot;\n&quot;</span>)<br>file_out.write(<span class="hljs-string">&quot;p * q: &quot;</span> + <span class="hljs-built_in">hex</span>(n) + <span class="hljs-string">&quot;\n&quot;</span>)<br>c = <span class="hljs-built_in">pow</span>(flag, e, n)<br>file_out.write(<span class="hljs-string">&quot;ciphertext: &quot;</span> + <span class="hljs-built_in">hex</span>(c) + <span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">ECC Curve Prime: 0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff</span><br><span class="hljs-string">Curve a: -0x3</span><br><span class="hljs-string">Curve b: 0x51953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00</span><br><span class="hljs-string">Gx: 0xc6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66</span><br><span class="hljs-string">Gy: 0x11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650</span><br><span class="hljs-string">e: 0x10001</span><br><span class="hljs-string">p * q: 0x118aaa1add80bdd0a1788b375e6b04426c50bb3f9cae0b173b382e3723fc858ce7932fb499cd92f5f675d4a2b05d2c575fc685f6cf08a490d6c6a8a6741e8be4572adfcba233da791ccc0aee033677b72788d57004a776909f6d699a0164af514728431b5aed704b289719f09d591f5c1f9d2ed36a58448a9d57567bd232702e9b28f</span><br><span class="hljs-string">ciphertext: 0x3862c872480bdd067c0c68cfee4527a063166620c97cca4c99baff6eb0cf5d42421b8f8d8300df5f8c7663adb5d21b47c8cb4ca5aab892006d7d44a1c5b5f5242d88c6e325064adf9b969c7dfc52a034495fe67b5424e1678ca4332d59225855b7a9cb42db2b1db95a90ab6834395397e305078c5baff78c4b7252d7966365afed9e</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„åŠ å¯†è¿‡ç¨‹å¯ä»¥å‘ç°ï¼š$(p,q)$å®é™…ä¸Šæ˜¯æ¤­åœ†æ›²çº¿$y^2&#x3D;x^3+ax+b$ä¸Šé¢çš„ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æœ‰ä¸€ä¸ªç­‰å¼ä¸º$q^2&#x3D;p^3+ap+b$ï¼ŒåŠ ä¸ŠRSAä¸­çš„ç­‰å¼$n&#x3D;pq$ï¼Œä¸¤è¾¹å¹³æ–¹åå¸¦å…¥$q^2$è¡¨è¾¾å¼ä¸º$n^2&#x3D;p^5+ap^3+bp^2$ï¼Œç„¶åç”¨ä»¥ä¸‹çš„sagemathä»£ç å³å¯ï¼Œæ³¨æ„æ±‚è§£å¤šé¡¹å¼çš„æ ¹åº”è¯¥æ˜¯$f&#x3D;0$çš„æ ¹ï¼Œæ‰€ä»¥æœ€åè¦å‡å»ä¸€ä¸ª$n^2$ï¼ŒæŠŠæ–¹ç¨‹åŒ–æˆ$p^5+ap^3+bp^2-n^2&#x3D;0$</p><p><img src="/2021/01/18/21Jan1/1-1.png" alt="1-1"></p><p>æœ€åæ±‚å‡ºæ¥$3$ä¸ªè§£ï¼Œå¾ˆæ˜¾ç„¶ï¼Œç”±äºRSAä¸­$p$æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆåªæœ‰ç¬¬äºŒä¸ªè§£ç¬¦åˆé¢˜æ„ã€‚æ­¤æ—¶$n$å°±è¢«åˆ†è§£æˆåŠŸï¼Œè¿›è€Œæˆ‘ä»¬å°±å¾ˆå¿«åœ°èƒ½å¤Ÿè§£å¯†äº†ã€‚</p><p>ä¸‹é¢é™„ä¸Šä¸€äº›Sagemathä¸­å¯¹å¯†ç å­¦æœ‰å…³çš„å‡½æ•°ä¾›ä»¥åæŸ¥é˜…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#æ•´æ•°åŸŸ,æœ‰ç†æ•°åŸŸå’Œå®æ•°åŸŸ</span><br>ZZ(<span class="hljs-number">3</span>)<br>QQ(<span class="hljs-number">0.25</span>)<br>RR(<span class="hljs-number">2</span>^<span class="hljs-number">0.5</span>)<br><span class="hljs-comment">#å¤æ•°åŸŸ</span><br>CC(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)<br><span class="hljs-comment">#ç”Ÿæˆè™šæ•°å•ä½i</span><br>i=ComplexField().gen();(<span class="hljs-number">2</span>+i)*(<span class="hljs-number">4</span>+<span class="hljs-number">3</span>*i)<br><span class="hljs-comment">#æ„é€ å¤šé¡¹å¼ç¯,è¿”å›å…·æœ‰ç»™å®šå±æ€§å’Œå˜é‡åçš„å…¨å±€å”¯ä¸€çš„å•å˜é‡æˆ–å¤šå…ƒå¤šé¡¹å¼ç¯</span><br><span class="hljs-comment">#å®šä¹‰åœ¨æ•´æ•°åŸŸä¸Šçš„å¤šé¡¹å¼ç¯Rï¼Œå˜é‡ä¸ºw;ZZä¹Ÿå¯æ¢æˆå…¶ä»–æ•°åŸŸ</span><br>R.&lt;w&gt;=PolynomialRing(ZZ);R<br>(<span class="hljs-number">1</span> + w)^<span class="hljs-number">3</span><br><span class="hljs-comment">#æœ‰é™ç¯</span><br>RN=IntegerModRing(<span class="hljs-number">63</span>)<br>FR=Integers(<span class="hljs-number">17</span>);FR<br><span class="hljs-comment">#è‡ªèº«çš„ä»£æ•°æ‰©å±•;exR=FR[w]/(w^2+3)</span><br>exR=FR.extension(w^<span class="hljs-number">2</span>+<span class="hljs-number">3</span>)ï¼›exR<br><span class="hljs-comment">#ä»¥pythonæ•´æ•°çš„å½¢å¼è¿”å›æ‰€æœ‰å¯é€†å…ƒç´ çš„åˆ—è¡¨</span><br>FR.list_of_elements_of_multiplicative_group()<br><span class="hljs-comment">#å‡è®¾ç¯çš„ä¹˜æ³•ç¾¤æ˜¯å¾ªç¯çš„ï¼Œè¿”å›è¿™ä¸ªç¯çš„ä¹˜æ³•ç¾¤çš„ç”Ÿæˆå…ƒ</span><br>FR.multiplicative_generator()<br><span class="hljs-comment">#è¿”å›è¿™ä¸ªç¯çš„ä¸€ä¸ªéšæœºå…ƒç´ </span><br>FR.random_element()<br><span class="hljs-comment">#ä¸Šè¿°å‡ ç§æ–¹æ³•å¯¹å¦‚ä¸‹çš„åŸŸåŒæ ·æ”¯æŒ</span><br><span class="hljs-comment">#æœ‰é™åŸŸ</span><br><span class="hljs-comment">#ç´ æ•°åŸŸ</span><br>G1=GF(<span class="hljs-number">37</span>);G1<br><span class="hljs-comment">#ä¼½ç½—ç“¦åŸŸ</span><br>G2=GF(<span class="hljs-number">3</span>^<span class="hljs-number">5</span>);G2<br><span class="hljs-comment">#åŒæ—¶æ±‚å•†ä¸ä½™æ•°</span><br>q,r=<span class="hljs-built_in">divmod</span>(<span class="hljs-number">12</span>,<span class="hljs-number">5</span>)<br><span class="hljs-comment">#æ±‚å…¬çº¦æ•°</span><br>d=gcd(<span class="hljs-number">12</span>,<span class="hljs-number">5</span>)<br><span class="hljs-comment">#æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•</span><br>d,u,v=xgcd(<span class="hljs-number">12</span>,<span class="hljs-number">5</span>)<br><span class="hljs-comment">#12åœ¨æ¨¡5ä¸‹çš„é€†</span><br>u=inverse_mod(<span class="hljs-number">12</span>,<span class="hljs-number">5</span>)<br><span class="hljs-comment">#ç”Ÿæˆ[lb,ub)ä¹‹é—´çš„éšæœºç´ æ•°,æ³¨æ„ubåœ¨å‰,lbåœ¨å,lbå¯ç¼ºçœä¸º0</span><br><span class="hljs-comment">#å¯é€šè¿‡è¿™ç§æ–¹å¼ç”Ÿæˆ128ä½çš„éšæœºç´ æ•°</span><br>p=random_prime(<span class="hljs-number">2L</span>**<span class="hljs-number">128</span>,<span class="hljs-number">2L</span>**<span class="hljs-number">127</span>)<br><span class="hljs-comment">#åˆ¤æ–­æ˜¯å¦ä¸ºç´ æ•°</span><br>is_prime(<span class="hljs-number">65537</span>)<br><span class="hljs-comment">#ç¬¬20ä¸ªç´ æ•°</span><br>nth_prime(<span class="hljs-number">20</span>)<br><span class="hljs-comment">#è®¡ç®—x^y mod n</span><br>z=power_mod(<span class="hljs-number">12</span>,<span class="hljs-number">5</span>,<span class="hljs-number">17</span>)<br><span class="hljs-comment">#æ¬§æ‹‰å‡½æ•°</span><br>euler_phi(<span class="hljs-number">111</span>)<br><span class="hljs-comment">#ä¸­å›½å‰©ä½™å®šç†,A=[a1,...,an],M=[m1,...,mn]</span><br><span class="hljs-comment">#ai=x mod mi,i=1,...,n</span><br>crt([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">7</span>,<span class="hljs-number">5</span>,<span class="hljs-number">12</span>,<span class="hljs-number">23</span>])<br><span class="hljs-comment">#æ±‚è‡ªèº«çš„næ¬¡æ ¹</span><br>FR(<span class="hljs-number">12</span>).nth_root(<span class="hljs-number">7</span>,<span class="hljs-built_in">all</span>=<span class="hljs-string">&#x27;True&#x27;</span>)<br><span class="hljs-comment">#æ±‚å¤šé¡¹å¼çš„æ ¹ï¼Œrootsæ–¹æ³•å¿…é¡»ä½œç”¨åœ¨åŸŸä¸Š</span><br>R.&lt;x&gt;=PolynomialRing(G1)<br>xt=G1(<span class="hljs-number">12</span>)<br>yt=xt^<span class="hljs-number">6</span><br>f=x^<span class="hljs-number">6</span>-yt<br>f.roots()<br><span class="hljs-comment">#å®šä¹‰çŸ©é˜µï¼Œé»˜è®¤å®šä¹‰åœ¨å®æ•°åŸŸ</span><br>A = matrix([[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]])<br>A^-<span class="hljs-number">1</span><br><span class="hljs-comment">#å®šä¹‰åœ¨å…¶ä»–åŸŸä¸Šçš„çŸ©é˜µï¼Œå¦‚æœ‰é™åŸŸ</span><br>A = matrix(GF(<span class="hljs-number">13</span>),[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]])<br>A^-<span class="hljs-number">1</span><br><span class="hljs-comment">#å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªé€†çŸ©é˜µä¸ä¸€æ ·</span><br><span class="hljs-comment">#å®šä¹‰å‘é‡ï¼Œå®šä¹‰åœ¨æœ‰é™åŸŸï¼Œé»˜è®¤å®šä¹‰åœ¨å®æ•°åŸŸ</span><br>w = vector(GF(<span class="hljs-number">13</span>),[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>])<br>Y=A*w;Y<br>Z=w*A;Z<br><span class="hljs-comment">#è§£çº¿æ€§æ–¹ç¨‹ç»„AX=Y</span><br>X = A.solve_right(Y);X<br><span class="hljs-comment">#ä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¦å·\</span><br>A\Y<br><span class="hljs-comment">#è§£çº¿æ€§æ–¹ç¨‹ç»„XA=Y</span><br>X = A.solve_left(Z);X<br><span class="hljs-comment">#æ ¼åŸºçº¦å‡</span><br>A = matrix([[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]])<br><span class="hljs-comment">#LLLç®—æ³•</span><br>A.LLL()<br><span class="hljs-comment">#BKZç®—æ³•</span><br>A.BKZ()<br>p=ZZ(<span class="hljs-string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF&#x27;</span>,<span class="hljs-number">16</span>)<br>a=ZZ(<span class="hljs-string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC&#x27;</span>,<span class="hljs-number">16</span>)<br>b=ZZ(<span class="hljs-string">&#x27;28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93&#x27;</span>,<span class="hljs-number">16</span>)<br><span class="hljs-comment">#æœ‰é™åŸŸGF(p)ä¸Šçš„æ¤­åœ†æ›²çº¿y^2 = x^3 + a*x + b mod p</span><br>E=EllipticCurve(GF(p),[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a,b])<br><span class="hljs-comment">#åŸºç‚¹</span><br>g=E([ZZ(<span class="hljs-string">&#x27;32c4ae2c1f1981195f9904466a39c9948fe30bbff2660be1715a4589334c74c7&#x27;</span>,<span class="hljs-number">16</span>),ZZ(<span class="hljs-string">&#x27;bc3736a2f4f6779c59bdcee36b692153d0a9877cc62a474002df32e52139f0a0&#x27;</span>,<span class="hljs-number">16</span>)])<br><span class="hljs-comment">#åŸºç‚¹çš„é˜¶</span><br>n=ZZ(<span class="hljs-string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123&#x27;</span>,<span class="hljs-number">16</span>)<br><span class="hljs-comment">#ç”Ÿæˆå¯†é’¥</span><br>sk=random_prime(<span class="hljs-number">2</span>*n//<span class="hljs-number">3</span>,n//<span class="hljs-number">3</span>)<br><span class="hljs-comment">#ç”Ÿæˆå…¬é’¥</span><br>G=sk*g<br><span class="hljs-comment">#é€šç”¨çš„æ±‚ç¦»æ•£å¯¹æ•°çš„æ–¹æ³•</span><br>x=discrete_log(a,base,<span class="hljs-built_in">ord</span>,operation)<br><span class="hljs-comment">#æ±‚ç¦»æ•£å¯¹æ•°çš„Pollard-Rhoç®—æ³•</span><br>x=discrete_log_rho(a,base,<span class="hljs-built_in">ord</span>,operation)<br><span class="hljs-comment">#æ±‚ç¦»æ•£å¯¹æ•°çš„Pollard-kangarooç®—æ³•(ä¹Ÿç§°ä¸ºlambdaç®—æ³•)</span><br>x=discrete_log_lambda(a,base,bounds,operation)<br><span class="hljs-comment">#å°æ­¥å¤§æ­¥æ³•</span><br>x=bsgs(base,a,bounds,operation)<br></code></pre></td></tr></table></figure><h2 id="2-ctf-little-case-NCTF2019-easyRSA"><a href="#2-ctf-little-case-NCTF2019-easyRSA" class="headerlink" title="2.[*ctf]little case&amp;[NCTF2019]easyRSA"></a>2.[*ctf]little case&amp;[NCTF2019]easyRSA</h2><p>è¿™ä¸¤é“é¢˜éƒ½æ˜¯æ¶‰åŠåˆ°äº†RSAä¸­$\gcd(p-1,q-1,e)&#x3D;e$çš„æƒ…å†µï¼Œç›´æ¥æŸ¥é˜…<strong>RSA Notes 3</strong>ä¸­çš„ç›¸å…³å†…å®¹å³å¯ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p><h2 id="3-NPUCTF2020-Mersenne-twister"><a href="#3-NPUCTF2020-Mersenne-twister" class="headerlink" title="3.[NPUCTF2020]Mersenne twister"></a>3.[NPUCTF2020]Mersenne twister</h2><p>ä¸€é“æ¢…æ£®æ—‹è½¬é¢˜ï¼Œè¿˜æ˜¯å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> hexlify , unhexlify<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag ,seed<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">26</span><br><span class="hljs-keyword">assert</span> flag[:<span class="hljs-number">7</span>] == <span class="hljs-string">&#x27;npuctf&#123;&#x27;</span><br><span class="hljs-keyword">assert</span> flag[-<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;&#125;&#x27;</span><br>XOR = <span class="hljs-keyword">lambda</span> s1 ,s2 : <span class="hljs-built_in">bytes</span>([x1 ^ x2 <span class="hljs-keyword">for</span> x1 ,x2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(s1 , s2)])<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">mt73991</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self , seed</span>):<br>        <span class="hljs-variable language_">self</span>.state = [seed] + [<span class="hljs-number">0</span>] * <span class="hljs-number">232</span><br>        <span class="hljs-variable language_">self</span>.flag = <span class="hljs-number">0</span><br>        <span class="hljs-variable language_">self</span>.srand()<br>        <span class="hljs-variable language_">self</span>.generate()<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">srand</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">232</span>):<br>            <span class="hljs-variable language_">self</span>.state[i+<span class="hljs-number">1</span>] = <span class="hljs-number">1812433253</span> * (<span class="hljs-variable language_">self</span>.state[i] ^ (<span class="hljs-variable language_">self</span>.state[i] &gt;&gt; <span class="hljs-number">27</span>)) - i<br>            <span class="hljs-variable language_">self</span>.state[i+<span class="hljs-number">1</span>] &amp;= <span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">233</span>):<br>            y = (<span class="hljs-variable language_">self</span>.state[i] &amp; <span class="hljs-number">0x80000000</span>) | (<span class="hljs-variable language_">self</span>.state[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">233</span>] &amp; <span class="hljs-number">0x7fffffff</span>)<br>            temp = y &gt;&gt; <span class="hljs-number">1</span><br>            temp ^= <span class="hljs-variable language_">self</span>.state[(i + <span class="hljs-number">130</span>) % <span class="hljs-number">233</span>]<br>            <span class="hljs-keyword">if</span> y &amp; <span class="hljs-number">1</span>:<br>                temp ^= <span class="hljs-number">0x9908f23f</span><br>            <span class="hljs-variable language_">self</span>.state[i] = temp<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getramdanbits</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.flag == <span class="hljs-number">233</span>:<br>            <span class="hljs-variable language_">self</span>.generate()<br>            <span class="hljs-variable language_">self</span>.flag = <span class="hljs-number">0</span><br>        bits = <span class="hljs-variable language_">self</span>.Next(<span class="hljs-variable language_">self</span>.state[<span class="hljs-variable language_">self</span>.flag]).to_bytes(<span class="hljs-number">4</span> , <span class="hljs-string">&#x27;big&#x27;</span>)<br>        <span class="hljs-variable language_">self</span>.flag += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> bits    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Next</span>(<span class="hljs-params">self , tmp</span>):<br>        tmp ^= (tmp &gt;&gt; <span class="hljs-number">11</span>)<br>        tmp ^= (tmp &lt;&lt; <span class="hljs-number">7</span>) &amp; <span class="hljs-number">0x9ddf4680</span><br>        tmp ^= (tmp &lt;&lt; <span class="hljs-number">15</span>) &amp; <span class="hljs-number">0xefc65400</span><br>        tmp ^= (tmp &gt;&gt; <span class="hljs-number">18</span>) &amp; <span class="hljs-number">0x34adf670</span><br>        <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">key , plain</span>):<br>    tmp = md5(plain).digest()<br>    <span class="hljs-keyword">return</span> hexlify(XOR(tmp , key))<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    flag = flag.encode()<br>    random = mt73991(seed)<br>    f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./cipher.txt&#x27;</span> , <span class="hljs-string">&#x27;wb&#x27;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>        key = <span class="hljs-string">b&#x27;&#x27;</span>.join([random.getramdanbits() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)])<br>        cipher = encrypt(key , <span class="hljs-built_in">chr</span>(i).encode())<br>        f.write(cipher)<br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ç›®ä¸ä¹‹å‰æˆ‘åšå®¢é‡Œçš„**PRNG MT Notes[2020.10.26]**æ‰€æ¶‰åŠåˆ°çš„é¢˜ç›®åŸºæœ¬ä¸€è‡´ï¼Œåªä¸è¿‡æ˜¯å°†å¯†æ–‡ä¸­çš„æ¯ä¸€ä½çš„md5å€¼ä¸ç”Ÿæˆçš„éšæœºå€¼è¿›è¡Œå¼‚æˆ–ã€‚æˆ‘ä»¬è¿˜æ˜¯åªéœ€è¦æ±‚å‡ºNextå‡½æ•°çš„é€†å³å¯ï¼ˆé‚£ç¯‡åšå®¢ä¹Ÿæä¾›äº†å¯¹åº”æ–¹æ³•ï¼Œç®€å•è°ƒå‚å³å¯ä½¿ç”¨ï¼‰ã€‚</p><p>ä¸è¿‡é—®é¢˜æ˜¯æˆ‘ä»¬æ— æ³•çŸ¥é“å®Œå…¨çš„$233$ä¸ªçŠ¶æ€ï¼Œåªèƒ½å¾—çŸ¥æˆ‘ä»¬ä»…æœ‰çš„$104$ä¸ªçŠ¶æ€ã€‚å…¶ä¸­ä¸€ä¸ªåŠæ³•å°±æ˜¯æšä¸¾seedï¼Œæšä¸¾è§„æ¨¡çº¦ä¸º$43$äº¿ï¼Œå®é™…ä¸Šè·‘äº†$16$äº¿å¤šä¸€äº›ã€‚<del>ï¼ˆä¸è¿‡å¥½åƒå¯ä»¥ä¸ç”¨æšä¸¾seedï¼Œå…·ä½“æ–¹æ³•å¾…æ›´æ–°ï¼‰</del></p><h3 id="Update-2021-7-20"><a href="#Update-2021-7-20" class="headerlink" title="Update 2021.7.20"></a>Update 2021.7.20</h3><p>å¦‚æœæˆ‘ä»¬é‡æ–°è§‚å¯Ÿä¸€ä¸‹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å¦‚ä¸‹å†…å®¹ï¼š</p><p>ç”±äºå¯„å­˜å™¨è§„æ¨¡æ˜¯$233$ï¼Œè€Œå®é™…ä¸Šåªäº§ç”Ÿäº†$104$ä¸ªéšæœºæ•°ï¼Œå› æ­¤å†…éƒ¨çš„stateæ‰€æœ‰å†…å®¹æ˜¯ä¸å˜çš„ã€‚å¹¶ä¸”æ ¹æ®é¢˜ç›®äº§ç”Ÿéšæœºæ•°çš„æ–¹å¼å¯çŸ¥ï¼šåœ¨äº§ç”Ÿæ–°çš„stateçš„æ—¶å€™ï¼Œä¸æ—§çš„stateæœ‰å¦‚ä¸‹å…³ç³»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">srand</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">232</span>):<br>        <span class="hljs-variable language_">self</span>.state[i+<span class="hljs-number">1</span>] = <span class="hljs-number">1812433253</span> * (<span class="hljs-variable language_">self</span>.state[i] ^ (<span class="hljs-variable language_">self</span>.state[i] &gt;&gt; <span class="hljs-number">27</span>)) - i<br>        <span class="hljs-variable language_">self</span>.state[i+<span class="hljs-number">1</span>] &amp;= <span class="hljs-number">0xffffffff</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">233</span>):<br>        y = (<span class="hljs-variable language_">self</span>.state[i] &amp; <span class="hljs-number">0x80000000</span>) | (<span class="hljs-variable language_">self</span>.state[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">233</span>] &amp; <span class="hljs-number">0x7fffffff</span>)<br>        temp = y &gt;&gt; <span class="hljs-number">1</span><br>        temp ^= <span class="hljs-variable language_">self</span>.state[(i + <span class="hljs-number">130</span>) % <span class="hljs-number">233</span>]<br>        <span class="hljs-keyword">if</span> y &amp; <span class="hljs-number">1</span>:<br>            temp ^= <span class="hljs-number">0x9908f23f</span><br></code></pre></td></tr></table></figure><p>å› æ­¤æ–°çš„<code>state[i]</code>ä¸æ—§çš„<code>state[i],state[i+1],state[i+130]</code>æœ‰å…³ç³»ã€‚è€Œé¢˜ç›®ä¸­å·²ç»å‘Šè¯‰äº†æˆ‘ä»¬flagçš„ç¬¬ä¸€ä½å’Œæœ€åä¸€ä½ã€‚å› æ­¤<code>state[0],state[103]</code>éƒ½å¯ä»¥æ±‚å‡ºæ¥ã€‚æœ‰<code>Newstate[103]=Oldstate[103]^Newstate[0]</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å¾—<code>Oldstate[103]</code>çš„æœ€é«˜$31$ä½äº†ã€‚</p><p>è¿™éƒ¨åˆ†ç»“æœæˆ‘å°±ç•¥å»äº†ï¼Œç®—å‡ºæ¥çš„<code>Oldstate[103]</code>å¯èƒ½çš„$32$ä½ç»“æœï¼š $\text{D7FC4AA6H or D7FC4AA7H}$</p><p>ç„¶åæˆ‘ä»¬åˆ†åˆ«ç”¨ä»¥ä¸‹ä»£ç éªŒè¯ä¸€ä¸‹å°±è¡Œäº†ï¼šæ³¨ï¼šç”±äº<code>newstate[103]&gt;&gt;31==0</code>ï¼Œå› æ­¤ä¸éœ€è¦è€ƒè™‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right</span>(<span class="hljs-params">res, shift, mask=<span class="hljs-number">0xffffffff</span>, bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>        tmp = res ^ tmp &gt;&gt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getseedbyns104</span>(<span class="hljs-params">os104</span>):<br>    a=os104<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">103</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        a=((a+i)*<span class="hljs-number">2520285293</span>)&amp;<span class="hljs-number">0xffffffff</span><br>        a=inverse_right(a,<span class="hljs-number">27</span>)<br>    <span class="hljs-keyword">return</span> a<br>ns103,ns0=<span class="hljs-number">1167644902</span>,<span class="hljs-number">778501557</span><br>os104=(ns103^ns0)*<span class="hljs-number">2</span><br>y=os104<br><span class="hljs-comment">#os104+=2**31</span><br>a=(os104+<span class="hljs-number">103</span>)*inverse(<span class="hljs-number">1812433253</span>,<span class="hljs-number">2</span>**<span class="hljs-number">32</span>)&amp;<span class="hljs-number">0xffffffff</span><br>a=inverse_right(a,<span class="hljs-number">27</span>)<br><span class="hljs-built_in">print</span>(a,a&amp;<span class="hljs-number">0x80000000</span>==y&amp;<span class="hljs-number">0x80000000</span>)<br><span class="hljs-built_in">print</span>(getseedbyns104(os104))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">ç¬¬15è¡Œæ³¨é‡Šæ‰:</span><br><span class="hljs-string">617247885 False</span><br><span class="hljs-string">2899787883</span><br><span class="hljs-string">ç¬¬15è¡Œä¸æ³¨é‡Š:</span><br><span class="hljs-string">2764731549 True</span><br><span class="hljs-string">1668245885</span><br><span class="hljs-string">å› æ­¤æœ€ç»ˆç§å­æ˜¯1668245885ï¼Œä¸ä¹‹å‰çˆ†ç ´çš„æƒ…å½¢ä¸€è‡´ã€‚</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="4-ACTFæ–°ç”Ÿèµ›2020-crypto-aes"><a href="#4-ACTFæ–°ç”Ÿèµ›2020-crypto-aes" class="headerlink" title="4.[ACTFæ–°ç”Ÿèµ›2020]crypto-aes"></a>4.[ACTFæ–°ç”Ÿèµ›2020]crypto-aes</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Cryptodome.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> FLAG<br><span class="hljs-keyword">from</span> Cryptodome.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    key=os.urandom(<span class="hljs-number">2</span>)*<span class="hljs-number">16</span><br>    iv=os.urandom(<span class="hljs-number">16</span>)<br>    <span class="hljs-built_in">print</span>(bytes_to_long(key)^bytes_to_long(iv))<br>    aes=AES.new(key,AES.MODE_CBC,iv)<br>    enc_flag = aes.encrypt(FLAG)<br>    <span class="hljs-built_in">print</span>(enc_flag)<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>ä¸€é“AESé¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºkeyæ˜¯$8$ç»„$4$ä½$16$è¿›åˆ¶æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠä»–ç»™å‡ºæ¥çš„ç¬¬ä¸€ä¸ªå¼‚æˆ–ç»“æœæ‹¿å‡ºæ¥å¹¶è¾“å‡º$16$è¿›åˆ¶ï¼Œå‘ç°å‰é¢æ˜¯$4$ç»„$\text{C981}_h$ï¼Œè€Œåé¢æ˜¯ä¸è§„åˆ™å†…å®¹ã€‚æˆ‘ä»¬åªéœ€è¦æŠŠä¸è§„åˆ™å†…å®¹ç”¨$4$ç»„$\text{C981}_h$è¿›è¡Œå¼‚æˆ–å³å¯ã€‚è¿™æ ·æˆ‘ä»¬çš„keyå’Œivå°±éƒ½æ‹¿åˆ°äº†</p><p>æœ€åæˆ‘ä»¬åªéœ€è¦æ¨¡ä»¿ä»–çš„æ¨¡å¼ï¼Œå³å¯è§£å‡ºflagäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>iv=<span class="hljs-string">b&#x27;\x87lQbI0\xfc\xe6\xaa\x05P\xb1\x01\xd1pL&#x27;</span><br>cip=<span class="hljs-string">b&#x27;\x8c-\xcd\xde\xa7\xe9\x7f.b\x8aKs\xf1\xba\xc75\xc4d\x13\x07\xac\xa4&amp;\xd6\x91\xfe\xf3\x14\x10|\xf8p&#x27;</span><br>key=long_to_bytes(<span class="hljs-number">0xc981c981c981c981c981c981c981c981c981c981c981c981c981c981c981c981</span>)<br>aes=AES.new(key,AES.MODE_CBC,iv)<br>dec_flag = aes.decrypt(cip)<br><span class="hljs-built_in">print</span>(dec_flag)<br></code></pre></td></tr></table></figure><h2 id="5-ctf-GuessFlag-1-2"><a href="#5-ctf-GuessFlag-1-2" class="headerlink" title="5.[*ctf]GuessFlag(1)(2)"></a>5.[*ctf]GuessFlag(1)(2)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br>N=<span class="hljs-number">64</span><br>key=randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**N)<br><span class="hljs-comment"># print key</span><br>key=<span class="hljs-built_in">bin</span>(key)[<span class="hljs-number">2</span>:].rjust(N,<span class="hljs-string">&#x27;0&#x27;</span>)<br>count=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>p=<span class="hljs-number">0</span><br>q=<span class="hljs-number">0</span><br>new_key=<span class="hljs-string">&#x27;&#x27;</span><br>zeros=[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)):<br><span class="hljs-keyword">if</span> key[j]==<span class="hljs-string">&#x27;0&#x27;</span>:<br>zeros.append(j)<br>p=zeros[randint(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(zeros))-<span class="hljs-number">1</span>]<br>q=zeros[randint(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(zeros))-<span class="hljs-number">1</span>]<br><span class="hljs-keyword">try</span>:<br>mask=<span class="hljs-built_in">int</span>(raw_input(<span class="hljs-string">&quot;mask:&quot;</span>))<br><span class="hljs-keyword">except</span>:<br>exit(<span class="hljs-number">0</span>)<br>mask=<span class="hljs-built_in">bin</span>(mask)[<span class="hljs-number">2</span>:]<br><span class="hljs-keyword">if</span> p&gt;q:<br>tmp=q<br>q=p<br>p=tmp<br>cnt=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,N):<br><span class="hljs-keyword">if</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(p,q+<span class="hljs-number">1</span>):<br>new_key+=<span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(mask[cnt])^<span class="hljs-built_in">int</span>(key[j]))<br><span class="hljs-keyword">else</span>:<br>new_key+=key[j]<br>cnt+=<span class="hljs-number">1</span><br>cnt%=<span class="hljs-built_in">len</span>(mask)<br>key=new_key<br><span class="hljs-keyword">try</span>:<br>guess=<span class="hljs-built_in">int</span>(raw_input(<span class="hljs-string">&quot;guess:&quot;</span>))<br><span class="hljs-keyword">except</span>:<br>exit(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">if</span> guess==<span class="hljs-built_in">int</span>(key,<span class="hljs-number">2</span>):<br>count+=<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Nice.&#x27;</span><br><span class="hljs-keyword">else</span>:<br>count=<span class="hljs-number">0</span><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Oops.&#x27;</span><br><span class="hljs-keyword">if</span> count&gt;<span class="hljs-number">2</span>:<br><span class="hljs-built_in">print</span> flag<br></code></pre></td></tr></table></figure><p>é¢˜ç›®çš„æ„æ€å¾ˆç®€å•ï¼ŒæœåŠ¡å™¨ä¼šä¿ç•™ä¸€ä¸ªéšæœºçš„$64$ä½æ•´æ•°ï¼Œå¹¶è®°å½•ä¸‹æ‰€æœ‰çš„$0$ä½ã€‚ä½ æ¯æ¬¡å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ•°å­—ï¼Œç„¶åæœåŠ¡å™¨ä¼šä»»æ„é€‰å–å·²æœ‰å¯†é’¥ä¸­$2$ä¸ª$0$æ¯”ç‰¹ä½ï¼Œå¹¶å°†è¿™$2$ä¸ª$0$æ¯”ç‰¹ä½ä¹‹é—´çš„æ‰€æœ‰æ¯”ç‰¹ä½ä¾æ¬¡å¾ªç¯å¼‚æˆ–ä½ æ‰€å‘é€æ•°å­—çš„å„ä¸ªæ¯”ç‰¹ä½ã€‚è¿ç»­$3$æ¬¡çŒœä¸­å¯†é’¥å³å¯è·å¾—ç­”æ¡ˆ</p><p>ä¸€å¼€å§‹<code>print(flag)</code>æ˜¯ç»™å‡ºçš„ï¼Œè¿™æ¬¡åªéœ€è¦å‘é€ä¸‰æ¬¡$0$ï¼Œè¿™æ ·å¯†é’¥å°±ä¿æŒä¸å˜ï¼Œç„¶åæ¯æ¬¡çŒœå°±çŒœä»–ç»™å‡ºæ¥çš„é‚£ä¸ªæ•°ï¼Œç„¶åå°±å¯ä»¥è·å–flag</p><p>ä¸è¿‡åé¢å‡çº§äº†,<code>print(flag)</code>è¿™å¥è¯è¢«åˆ é™¤äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦æƒ³åŠæ³•äº†ï¼ˆæ¯”å¦‚æˆ‘é—®äº†ä¸€ä¸‹å­¦é•¿ï¼Œå‘ƒï¼‰ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦æ¯æ¬¡å‘é€$1$ï¼Œè¿™æ ·ä»»æ„ä¸¤ä¸ª$0$ä¹‹é—´çš„æ‰€æœ‰æ¯”ç‰¹ä½éƒ½æœ‰å¯èƒ½è¢«å¼‚æˆ–ã€‚ä¸è¿‡æˆ‘ä»¬å¤šæ¬¡æœ¬åœ°å®éªŒåä¼šå‘ç°ï¼šéšç€å‘é€$1$çš„æ¬¡æ•°ä¸æ–­å¢å¤šï¼Œå¯†é’¥æœ«å°¾çš„å›ºå®š$1$æ¯”ç‰¹ä½çš„é•¿åº¦è¶Šæ¥è¶Šé•¿ï¼Œæ‰€ä»¥åªéœ€è¦ä¸åˆ°$200$æ¬¡çš„å‘é€$1$ï¼Œæœ€å$64$ä¸ªæ¯”ç‰¹ä½å°±ä¼šå…¨æ˜¯$1$ã€‚æ‰€ä»¥æˆ‘ä»¬æ¯æ¬¡çŒœå¯†é’¥éƒ½çŒœ$18446744073709551615$ï¼Œä¹Ÿå°±æ˜¯$2^{64}-1$ï¼Œåˆ°æœ€åå°±ä¼šè¿ç»­$3$æ¬¡çŒœä¸­ï¼Œæœ€ç»ˆæˆ‘ä»¬å°±èƒ½æ‹¿åˆ°flag</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ExpLog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RSA Notes 3</title>
    <link href="/2021/01/13/RSA-Notes3/"/>
    <url>/2021/01/13/RSA-Notes3/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ RSAçš„ç¬”è®°-3"><a href="#huangx607087å­¦ä¹ RSAçš„ç¬”è®°-3" class="headerlink" title="huangx607087å­¦ä¹ RSAçš„ç¬”è®°(3)"></a>huangx607087å­¦ä¹ RSAçš„ç¬”è®°(3)</h1><h2 id="O-About"><a href="#O-About" class="headerlink" title="O-About"></a>O-About</h2><p>ä¸ºäº†æœŸæœ«è€ƒè¯•ï¼Œ30å¤©çš„CTFå­¦ä¹ éƒ½æ‘¸äº†ï¼Œç°åœ¨é£ä¿¡å­é‡Œé¢çš„å¤§ä½¬è¶Šæ¥è¶Šå¤šäº†ï¼Œæˆ‘ä¹Ÿå˜å¾—è¶Šæ¥è¶Šèœã€‚ä¸è¿‡è¿˜å¥½ï¼Œè‡ªå·±çš„é«˜æ•°è¿‡äº†ï¼Œå¯’å‡æ²¡äº‹å°±å¯ä»¥å¤šææCTFäº†<del>ï¼ˆå“¦å¯¹ï¼Œè¿˜æœ‰è‹±è¯­6çº§ï¼Œäº‰å–å¤§ä¸€ä¸‹åŠå¹´è¿‡æ‰ï¼‰</del></p><p><strong>çº¦å®šï¼šæ­¤åšå®¢ä¸­å¦‚æœå‡ºç°é™¤æ³•ï¼Œæœªç‰¹æ®Šè¯´æ˜çš„ï¼Œå‡ä¸ºå‘ä¸‹å–æ•´çš„æ•´é™¤ï¼</strong></p><h2 id="I-RSAä¸­-gcd-phi-e-not-1-çš„æƒ…å†µ"><a href="#I-RSAä¸­-gcd-phi-e-not-1-çš„æƒ…å†µ" class="headerlink" title="I-RSAä¸­$\gcd(\phi,e)\not &#x3D; 1$çš„æƒ…å†µ"></a>I-RSAä¸­$\gcd(\phi,e)\not &#x3D; 1$çš„æƒ…å†µ</h2><h3 id="0x01-é¢˜ç›®èƒŒæ™¯-å¼•ä¾‹"><a href="#0x01-é¢˜ç›®èƒŒæ™¯-å¼•ä¾‹" class="headerlink" title="0x01 é¢˜ç›®èƒŒæ™¯&amp;å¼•ä¾‹"></a>0x01 é¢˜ç›®èƒŒæ™¯&amp;å¼•ä¾‹</h3><p>NCTFä¸­æœ‰ä¸€é“RSAé¢˜ç›®ç»™å‡ºäº†$e,\phi$ä¸äº’ç´ çš„æƒ…å†µï¼Œè¿™å°±æ„å‘³ç€$e,\phi$çš„é€†å…ƒ$d$ä¸å­˜åœ¨ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå°±æ— æ³•ä½¿ç”¨å¸¸è§„çš„æ–¹æ³•æ¥åˆ†è§£å› å¼ã€‚</p><p>ä¸ºäº†æ¢è®¨å¤§æ•°å­—çš„ä¸€èˆ¬æ€§ç»“è®ºï¼Œæˆ‘ä»¬å…ˆä»å°çš„æ•°å­—å¼€å§‹ï¼Œçœ‹ä¸€ä¸ªå¼•ä¾‹ï¼š</p><p>åœ¨æ•°å­—æå°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å‡è®¾$e&#x3D;7,p&#x3D;43,q&#x3D;29,c&#x3D;394$æ˜¯å·²çŸ¥çš„ï¼ˆè¿™ç§æƒ…å†µä¸‹éƒ½æ˜¯ç»™å‡º$p,q$çš„ï¼Œå¹¶ä¸”æ³¨æ„åˆ°$p-1,q-1$éƒ½æ˜¯$e$çš„å€æ•°ï¼‰ã€‚ç„¶åæˆ‘ä»¬æœŸæœ›çš„$m$å€¼æ˜¯$26$ï¼ˆå®é™…ä¸Šåº”è¯¥æ˜¯æ˜¯æœªçŸ¥çš„ï¼‰ã€‚ç„¶åæˆ‘ä»¬ç”¨ä¸‹é¢çš„ä»£ç åšä¸€ä¸ªå…ˆåŠ å¯†å†è§£å¯†çš„å®éªŒï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e,m,p,q=<span class="hljs-number">7</span>,<span class="hljs-number">26</span>,<span class="hljs-number">43</span>,<span class="hljs-number">29</span><br>n,phi=p*q,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">print(pow(m,e,n))</span><br><span class="hljs-string">print(phi)</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>c=<span class="hljs-number">394</span><br>phi=<span class="hljs-number">1176</span><br>anses=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">pow</span>(i,e,n)==c):<br>        anses.append(i)<br><span class="hljs-built_in">print</span>(anses)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">[18, 26, 73, 114, 155, 157, 163, 200, 201, 244, 276, 287, 288, 308, 327, 329, 331, 374, 416, 421, 491, 501, 503, 534, 566, 577, 588, 636, 675, 679, 706, 714, 722, 781, 824, 851, 867, 878, 888, 972, 975, 996, 1023, 1062, 1146, 1168, 1187, 1230, 1233]</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥å‘ç°ï¼šå½“æˆ‘ä»¬å°è¯•ç”¨æšä¸¾æ³•<del>ï¼ˆåæ­£æ•°å­—å°ï¼‰</del>å°è¯•æšä¸¾ç¬¦åˆæ¡ä»¶çš„ç­”æ¡ˆæ—¶ï¼Œå‘ç°ä¸€å…±æœ‰å¤šè§£ï¼ˆå¹¶ä¸”è§£çš„ä¸ªæ•°æ°å¥½æ˜¯$7^2&#x3D;49$ï¼‰ï¼šæˆ‘ä»¬æœŸæœ›çš„$26$åªæ˜¯å…¶ä¸­çš„ä¸€ä¸ªè§£ã€‚ç„¶è€Œè¿™é‡Œä¹Ÿä»…ä»…æ—¶åœ¨æ•°å­—è¾ƒå°çš„æ—¶å€™é‡‡ç”¨æšä¸¾æ³•ï¼Œæˆ‘ä»¬å¿…é¡»è¦æ‰¾åˆ°ä¸€ç§åŠæ³•æ¥çœŸæ­£åœ°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="0x02-æœ‰é™åŸŸå†…å¼€æ ¹"><a href="#0x02-æœ‰é™åŸŸå†…å¼€æ ¹" class="headerlink" title="0x02  æœ‰é™åŸŸå†…å¼€æ ¹"></a>0x02  æœ‰é™åŸŸå†…å¼€æ ¹</h3><h4 id="2o01-Introduction"><a href="#2o01-Introduction" class="headerlink" title="2o01 Introduction"></a>2o01 Introduction</h4><p>åŸºç¡€çš„æ•°å­¦æ—©å·²å‘Šè¯‰æˆ‘ä»¬ï¼Œ$n$æ¬¡æ–¹ç¨‹æœ‰$n$ä¸ªæ ¹ã€‚æ‰€ä»¥å½“$p-1$å’Œ$e$ä¸äº’ç´ æ—¶ï¼Œ$x^e\equiv a \pmod p$è¦ä¹ˆæœ‰$e$ä¸ªæ ¹ï¼Œè¦ä¹ˆæ²¡æœ‰æ ¹ï¼ˆè¿™ä¸ªå¾ˆå®¹æ˜“ç†è§£ï¼Œ$e&#x3D;2$æ—¶ï¼Œæ–¹ç¨‹$x^2\equiv a\pmod p$å¦‚æœ$a$æ˜¯æ¨¡$p$äºŒæ¬¡å‰©ä½™å°±æœ‰ä¸¤ä¸ªæ ¹ï¼Œ$a$ä¸æ˜¯æ¨¡$p$çš„äºŒæ¬¡å‰©ä½™å°±æ²¡æ ¹ã€‚ï¼‰</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±éœ€è¦æ±‚å‡ºåœ¨æœ‰é™åŸŸå†…å¼€$e$æ¬¡æ ¹å·ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æ— éœ€è€ƒè™‘æ— è§£çš„æƒ…å†µï¼ˆå› ä¸ºåœ¨RSAä¸­ï¼Œæ˜¾ç„¶æœ‰ä¸€ä¸ªè§£æ˜¯$m$ï¼‰</p><p>å‘ç°$p-1,q-1$éƒ½æ˜¯$e$çš„ å€æ•°åï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨sagemathï¼Œæ±‚å‡ºè¿™$e(&#x3D;7)$ä¸ªæ ¹ä¸­çš„å…¶ä¸­ä¸€ä¸ªæ ¹ï¼Œå¦‚ä¸‹å›¾</p><p><img src="/2021/01/13/RSA-Notes3/culc1.png" alt="Picture2o01"></p><p>è‡³äºå‰©ä¸‹çš„$6$ä¸ªæ ¹ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰è¿™æ ·çš„æ¨å¯¼ï¼ˆä»ç„¶æ˜¯ä»¥$e&#x3D;7$ä¸ºä¾‹ï¼‰ï¼š$x&#x3D;(\sqrt[7]{1Ã—x})^7&#x3D;(\sqrt[7]1)^7Ã—(\sqrt[7]{x})^7$ã€‚å¯èƒ½æŸäº›æ— ç†æ•°åœ¨æ¨¡æ„ä¹‰ä¸‹ä¸å­˜åœ¨ï¼Œä½†æ˜¯è¿™æ²¡æœ‰å…³ç³»ï¼Œå› ä¸º$x^7\equiv 1 \pmod {43}$ç»å¯¹ä¸æ­¢$1$ä¸€ä¸ªæ ¹ï¼Œæ¯”å¦‚$41^7\equiv 1 \pmod {43}$ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„è„šæœ¬æ±‚å‡ºæ¥ï¼ŒåŸç†è§Am4dalaoåšå®¢ä¸­çš„ç½‘é¡µé“¾æ¥</p><h4 id="Upd-2021-1-17"><a href="#Upd-2021-1-17" class="headerlink" title="Upd 2021.1.17"></a>Upd 2021.1.17</h4><p>ç”¨ä»¥ä¸‹sagemathä»£ç æ±‚ç‰¹è§£æ›´å¿«ï¼ˆ$e&gt;4200$çš„æƒ…å†µä¸‹ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">AMM</span>(<span class="hljs-params">o, r, q</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n----------------------------------------------------------------------------------&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Start to run Adleman-Manders-Miller Root Extraction Method&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Try to find one &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(r, o, q))<br>    g = GF(q)<br>    o = g(o)<br>    p = g(random.randint(<span class="hljs-number">1</span>, q))<br>    <span class="hljs-keyword">while</span> p ^ ((q-<span class="hljs-number">1</span>) // r) == <span class="hljs-number">1</span>:<br>        p = g(random.randint(<span class="hljs-number">1</span>, q))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Find p:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(p))<br>    t = <span class="hljs-number">0</span><br>    s = q - <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> s % r == <span class="hljs-number">0</span>:<br>        t += <span class="hljs-number">1</span><br>        s = s // r<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Find s:&#123;&#125;, t:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(s, t))<br>    k = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> (k * s + <span class="hljs-number">1</span>) % r != <span class="hljs-number">0</span>:<br>        k += <span class="hljs-number">1</span><br>    alp = (k * s + <span class="hljs-number">1</span>) // r<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Find alp:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(alp))<br>    a = p ^ (r**(t-<span class="hljs-number">1</span>) * s)<br>    b = o ^ (r*alp - <span class="hljs-number">1</span>)<br>    c = p ^ s<br>    h = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, t):<br>        d = b ^ (r^(t-<span class="hljs-number">1</span>-i))<br>        <span class="hljs-keyword">if</span> d == <span class="hljs-number">1</span>:<br>            j = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Calculating DLP...&#x27;</span>)<br>            j = - dicreat_log(a, d)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Finish DLP...&#x27;</span>)<br>        b = b * (c^r)^j<br>        h = h * c^j<br>        c = c ^ r<br>    result = o^alp * h<br>    <span class="hljs-keyword">return</span> result<br><span class="hljs-built_in">print</span>(<span class="hljs-number">1</span>)<br>p=<br>q=<br>n=p*q<br>c=<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>cMp=c%p<br>cMq=c%q<br><span class="hljs-built_in">print</span>(AMM(cMp,<span class="hljs-number">4919</span>,p))<br><span class="hljs-built_in">print</span>(AMM(cMq,<span class="hljs-number">4919</span>,q))<br><br></code></pre></td></tr></table></figure><h4 id="2o77Code"><a href="#2o77Code" class="headerlink" title="2o77Code"></a>2o77Code</h4><p>ä»£ç è¿˜æ˜¯è¦ä¸Šä¸€ä¸‹çš„ï¼Œ<del>å¸®åŠ©ç†è§£ï¼Œä¸‡ä¸€çœŸæœ‰äººçœ‹ä¸æ‡‚åŸç†å‘¢ï¼Ÿï¼ˆæˆ‘ç›¸ä¿¡æ˜¯ä¸å­˜åœ¨çš„ï¼‰</del></p><p>ä½¿ç”¨urandomçš„åŸå› æ˜¯å› ä¸ºè™½ç„¶è¿™é“é¢˜çš„æ•°å­—å°ï¼Œä½†ä»¥åçš„æ•°å­—å¯èƒ½ä¼šå¾ˆå¤§ï¼Œå¹¶ä¸”$\mathrm{get}(x,B)$ä¸­çš„$B$åœ¨$x$è¾ƒå¤§çš„æ—¶å€™ä¹Ÿå¯ä»¥$40$æ¢æˆæ›´å¤§çš„æ•°å­—ï¼ˆä¾‹å¦‚$400$ï¼‰ï¼Œå¦‚æœæ•°å­—å¤ªå¤§å¯ä»¥ä½¿ç”¨æ–‡ä»¶è¾“å‡ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getx</span>(<span class="hljs-params">p,B</span>):<br>    x=bytes_to_long(urandom(B))%p<br>    <span class="hljs-keyword">while</span>(x==<span class="hljs-number">0</span>):<br>        x=bytes_to_long(urandom(B))%p<br>    <span class="hljs-keyword">return</span> x<br><span class="hljs-comment">#------MAIN BELOW------#</span><br>n,p=<span class="hljs-number">7</span>,<span class="hljs-number">29</span><br><span class="hljs-keyword">assert</span> (p-<span class="hljs-number">1</span>)%n==<span class="hljs-number">0</span><br>rem=n<br>anses=[]<br><span class="hljs-keyword">while</span> rem:<br>    x=getx(p,<span class="hljs-number">40</span>)<br>    g=<span class="hljs-built_in">pow</span>(x,(p-<span class="hljs-number">1</span>)//n,p)<br>    <span class="hljs-comment">#print(g,pow(g,2*n,p))</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">pow</span>(g,n*<span class="hljs-number">4</span>,p)==<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> g <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> anses):<br>        anses.append(g)<br>        rem=rem-<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(anses)     <br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">7th_root_of_1_under_condition_of_n,p=7,43:[35, 4, 41, 16, 21, 11, 1]</span><br><span class="hljs-string">7th_root_of_1_under_condition_of_n,p=7,29:[1, 7, 25, 24, 16, 23, 20]</span><br><span class="hljs-string">A_7th_root_of_394_under_condition_of_n,p=7,43:7</span><br><span class="hljs-string">A_7th_root_of_394_under_condition_of_n,p=7,29:12</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä»¥$n,p&#x3D;7,43$çš„ä¸€ç»„è§£ä¸ºä¾‹ï¼š$[35,4,41,16,21,11,1]$ä¸€å…±æœ‰ä¸ƒä¸ªæ•°å­—ï¼Œè¿™ä¸ƒä¸ªæ•°å­—éƒ½æ»¡è¶³$x^7\equiv 1 \pmod {43}$ã€‚ç„¶åæˆ‘ä»¬æ³¨æ„ä¸€ä¸‹æˆ‘ä»¬åˆšæ‰å¾—åˆ°çš„ä¸€ä¸ªæ•°å­—å€¼$7$ã€‚åªè¦æˆ‘ä»¬å¯¹è¿™é‡Œé¢çš„æ•°å­—æ¯ä¸€ä¸ªéƒ½ä¹˜ä¸Š$7$ï¼Œå¾—åˆ°çš„æ•°åˆ—ä¸º$[30, 28, 29, 26, 18, 34, 7]$,é‚£ä¹ˆå°±æœ‰äº†$x^7\equiv394\pmod {43}$ï¼Œæ³¨æ„åˆ°$7^7\equiv 394 \pmod{43}$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å§‘ä¸”åœ°è¯´$\sqrt[7]{394}\equiv 7 \pmod {43}$ã€‚$n&#x3D;7,p&#x3D;29$çš„æƒ…å†µä¹ŸåŒç†ã€‚</p><h3 id="0x03ï¼šæ±‚æ ¹åä¸¤ä¸¤ç»„åˆï¼Œä½¿ç”¨CRT"><a href="#0x03ï¼šæ±‚æ ¹åä¸¤ä¸¤ç»„åˆï¼Œä½¿ç”¨CRT" class="headerlink" title="0x03ï¼šæ±‚æ ¹åä¸¤ä¸¤ç»„åˆï¼Œä½¿ç”¨CRT"></a>0x03ï¼šæ±‚æ ¹åä¸¤ä¸¤ç»„åˆï¼Œä½¿ç”¨CRT</h3><p>ç„¶åï¼Œæˆ‘ä»¬å›é¡¾åˆšæ‰çš„è¿‡ç¨‹ï¼Œ$m\equiv \sqrt[e]{c} \pmod p,m\equiv \sqrt[e]{c} \pmod q$ï¼Œä¸€å®šè¦æ³¨æ„åˆ°ç”±äºæ¨¡æ•°çš„ä¸åŒï¼Œä¸¤ä¸ª$\sqrt[e]{c}$çš„å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå‰è€…æˆ‘ä»¬æ±‚å‡ºæ¥çš„$\sqrt[7]{394}$æ˜¯$[30,28,29,26,18,34,7]$ï¼Œå› ä¸ºè¿™æ˜¯æ¨¡$43$çš„æ„ä¹‰ä¸‹çš„æ•°ç»„ã€‚åè€…æ˜¯æ¨¡$29$æ„ä¹‰ä¸‹çš„æ•°ç»„ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç»“æœä¸¤ä¸¤ç»„åˆï¼ˆç»„åˆå®šå¾‹å‘Šè¯‰æˆ‘ä»¬ä¸€å…±æœ‰$e^2$ç§æ–¹æ¡ˆï¼‰ï¼Œä¸‹é¢åˆ†åˆ«ä½¿ç”¨sagemathå’Œpythonåšçš„æƒ…å†µã€‚</p><h4 id="3o01ï¼šSagemathæˆªå›¾"><a href="#3o01ï¼šSagemathæˆªå›¾" class="headerlink" title="3o01ï¼šSagemathæˆªå›¾"></a>3o01ï¼šSagemathæˆªå›¾</h4><p><img src="/2021/01/13/RSA-Notes3/culc2.png" alt="3o01p1"></p><h4 id="3o02-pythonä»£ç "><a href="#3o02-pythonä»£ç " class="headerlink" title="3o02 pythonä»£ç "></a>3o02 pythonä»£ç </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crt2</span>(<span class="hljs-params">m1,m2,r1,r2</span>):<br>    M=m1*m2<br>    t1,t2=inverse(m2,m1),inverse(m1,m2)<br>    <span class="hljs-keyword">return</span> (r1*t1*m2+r2*t2*m1)%M<br><span class="hljs-comment">#------MAIN BELOW-----#</span><br>s43=[<span class="hljs-number">35</span>, <span class="hljs-number">4</span>, <span class="hljs-number">41</span>, <span class="hljs-number">16</span>, <span class="hljs-number">21</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1</span>]<br>s29=[<span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">25</span>, <span class="hljs-number">24</span>, <span class="hljs-number">16</span>, <span class="hljs-number">23</span>, <span class="hljs-number">20</span>]<br>ans=[]<br>p43=<span class="hljs-number">7</span><br>p29=<span class="hljs-number">12</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    s43[i]=s43[i]*p43%<span class="hljs-number">43</span><br>    s29[i]=s29[i]*p29%<span class="hljs-number">29</span><br><span class="hljs-built_in">print</span>(s43)<br><span class="hljs-built_in">print</span>(s29)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s43:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> s29:<br>        ans.append(crt2(<span class="hljs-number">43</span>,<span class="hljs-number">29</span>,i,j))<br>ans.sort()<br><span class="hljs-built_in">print</span>(ans)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">s43=[30, 28, 29, 26, 18, 34, 7]</span><br><span class="hljs-string">s29=[12, 26, 10, 27, 18, 15, 8]</span><br><span class="hljs-string">ans=[18, 26, 73, 114, 155, 157, 163, 200, 201, 244, 276, 287, 288, 308, 327, 329, 331, 374, 416, 421, 491, 501, 503, 534, 566, 577, 588, 636, 675, 679, 706, 714, 722, 781, 824, 851, 867, 878, 888, 972, 975, 996, 1023, 1062, 1146, 1168, 1187, 1230, 1233]</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿè§‚å¯Ÿï¼Œæ˜¯ä¸æ˜¯æœ€åçš„ç»“æœä¸æˆ‘ä»¬ä¸€å¼€å§‹æšä¸¾æ±‚è§£çš„ç»“æœä¸€æ¨¡ä¸€æ ·ï¼Ÿ<del>ï¼ˆä¸ºäº†è§‚å¯Ÿæ–¹ä¾¿ï¼Œç‰¹æ­¤å¯¹ansæ•°ç»„æ’äº†ä¸ªåºï¼‰</del></p><h3 id="0x04ï¼š-æœ€åå¾®è°ƒï¼Œå¾—å‡ºç­”æ¡ˆ"><a href="#0x04ï¼š-æœ€åå¾®è°ƒï¼Œå¾—å‡ºç­”æ¡ˆ" class="headerlink" title="0x04ï¼š æœ€åå¾®è°ƒï¼Œå¾—å‡ºç­”æ¡ˆ"></a>0x04ï¼š æœ€åå¾®è°ƒï¼Œå¾—å‡ºç­”æ¡ˆ</h3><p>å½“æˆ‘ä»¬å¾—åˆ°$49$ä¸ªè§£ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®é¢˜ç›®çš„éœ€è¦ï¼Œå°†è§£ç­›é€‰å‡ºæ¥ï¼Œå› ä¸ºåœ¨çœŸæ­£çš„CTFæ¯”èµ›ä¸­ï¼Œflagéƒ½æ˜¯æœ‰ä¸€å®šæ ¼å¼çš„ï¼Œæœ¬é¢˜ä¸­ç”±äºä»…ä»…æ˜¯ä»æ•°è®ºçš„æ–¹æ³•æ¥è®²è§£ï¼Œå¹¶ä¸”æ•°å­—è¾ƒå°ï¼Œ<del>æ‰€ä»¥å°±è®²äº†ä¸ªæ–¹æ³•ï¼Œç­›é€‰æ˜¯å¾ˆå®¹æ˜“çš„ï¼ŒYS9Xï¼</del></p><h3 id="0x05ï¼š-æ€»ç»“ä¸€ä¸‹çŸ¥è¯†ç‚¹"><a href="#0x05ï¼š-æ€»ç»“ä¸€ä¸‹çŸ¥è¯†ç‚¹" class="headerlink" title="0x05ï¼š æ€»ç»“ä¸€ä¸‹çŸ¥è¯†ç‚¹"></a>0x05ï¼š æ€»ç»“ä¸€ä¸‹çŸ¥è¯†ç‚¹</h3><p><strong>1</strong>ï¼šè§£æ–¹ç¨‹$x^e\equiv a \pmod p$ï¼Œå…¶ä¸­$p$ä¸ºç´ æ•°ï¼Œé‚£ä¹ˆå½“$\gcd(e,p-1)&#x3D;1$æ—¶ï¼Œè¯¥æ–¹ç¨‹æœ‰å”¯ä¸€è§£ï¼Œä¸º$a^d$ï¼Œå…¶ä¸­$de\equiv 1 \pmod p$ã€‚å¦‚æœ$\gcd(e,p-1)\not &#x3D; 1$ï¼Œé‚£ä¹ˆæ–¹ç¨‹æœ€å¤šå¯ä»¥æœ‰$\gcd(e,p-1)$ä¸ªè§£ã€‚</p><p><strong>2</strong>ï¼šå½“$\gcd(e,p-1)\not &#x3D;1$æ—¶ã€‚å®šä¹‰æ–¹ç¨‹$x^e\equiv a \pmod p$ä¸­ï¼Œå½“$a&#x3D;1$æ—¶ä¸ºé½æ¬¡æœ‰é™åŸŸæŒ‡æ•°æ–¹ç¨‹<del>ï¼ˆæˆ‘è‡ªå·±å®šä¹‰çš„ï¼‰</del>ï¼Œå½“$a\not &#x3D; 1$æ—¶ä¸ºéé½æ¬¡æœ‰é™åŸŸæŒ‡æ•°æ–¹ç¨‹ã€‚é½æ¬¡æœ‰é™åŸŸæŒ‡æ•°æ–¹ç¨‹çš„é€šè§£<del>ï¼ˆåº”è¯¥è¯´æ˜¯æ‰€æœ‰è§£ï¼‰</del>å¯ä»¥ç”¨ä¸Šé¢çš„pythonä»£ç ç›´æ¥æ±‚å‡ºï¼Œéé½æ¬¡æœ‰é™åŸŸæŒ‡æ•°æ–¹ç¨‹å¯ä»¥åˆ©ç”¨sagemathæ±‚å‡ºæ–¹ç¨‹çš„ä¸€ä¸ªç‰¹è§£$x_0$ã€‚ç„¶åç”¨$x_0$ä¹˜ä¸Šå¯¹åº”é½æ¬¡æ–¹ç¨‹çš„é€šè§£ï¼Œé‚£ä¹ˆå°±å¾—åˆ°äº†éé½æ¬¡æ–¹ç¨‹çš„é€šè§£<del>ï¼ˆå®é™…ä¸Šæˆ‘åˆšæ‰è¯´çš„æ˜¯ä¸€ç§å¾ˆä¸è§„èŒƒçš„è¯´æ³•ï¼Œåªä¸è¿‡æ˜¯ä¸ºäº†ç±»æ¯”çº¿ä»£å’Œé«˜æ•°æ‰è¿™æ ·å§‘ä¸”åœ°å®šä¹‰çš„ï¼‰</del>ã€‚</p><h2 id="II-å·²çŸ¥-dp-dq-p-q-c-æ—¶æ±‚è§£-m"><a href="#II-å·²çŸ¥-dp-dq-p-q-c-æ—¶æ±‚è§£-m" class="headerlink" title="II- å·²çŸ¥$dp,dq,p,q,c$æ—¶æ±‚è§£$m$"></a>II- å·²çŸ¥$dp,dq,p,q,c$æ—¶æ±‚è§£$m$</h2><h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>ä¸€äº›<del>è¿‡äºåŸºç¡€çš„ç®—å¼æˆ‘å°±ä¸ç»™äº†ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·çš„ä¸¤ä¸ªå¼å­</del>ï¼š$dp\equiv d \pmod {p-1},dq\equiv d \pmod {q-1}$</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥è®¡ç®—$m_1\equiv c^d \pmod p,m_2\equiv c^d \pmod q$</p><p>ç­‰å¼ç»è¿‡å˜å½¢ï¼Œå¯ä»¥å¾—åˆ°$m_2\equiv (kp+m_1)\pmod p$</p><p>ç„¶åä¸¤è¾¹åŒæ—¶å‡å»$m_1$ï¼Œåˆæœ‰$(m_2-m_1)\equiv kp\pmod p$ï¼Œå³$k\equiv p^{-1}(m_2-m_1) \pmod q$</p><p>åˆå› ä¸º$m&#x3D;c^d&#x3D; kp+m_1$ï¼Œæ‰€ä»¥$c^d&#x3D;(p^{-1}(m_2-m_1)\mod q)Ã—p+m_1$</p><p>åˆ©ç”¨$m_1\equiv c^{dq\mod (q-1)} \pmod q,m_2\equiv c^{dp\mod (p-1)}\pmod p$</p><p>å°±å¯ä»¥ç›´æ¥æ±‚å‡ºç­”æ¡ˆäº†ï¼Œç›´æ¥ä¸Šä»£ç ï¼Œä¸å¤šè¯´äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> libnum<br>p = <br>q = <br>dp = <br>dq = <br>c = <br>invq=inverse(p,q)<br>mp=<span class="hljs-built_in">pow</span>(c,dp,p)<br>mq=<span class="hljs-built_in">pow</span>(c,dq,q)<br>m=((mp-mq)*invq%p)*q+mq<br><span class="hljs-built_in">print</span>(m)<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NumberTheory4</title>
    <link href="/2021/01/11/NumberTheory4/"/>
    <url>/2021/01/11/NumberTheory4/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ æ•°è®ºçš„ç¬”è®°4"><a href="#huangx607087å­¦ä¹ æ•°è®ºçš„ç¬”è®°4" class="headerlink" title="huangx607087å­¦ä¹ æ•°è®ºçš„ç¬”è®°4"></a>huangx607087å­¦ä¹ æ•°è®ºçš„ç¬”è®°4</h1><h2 id="1-æ¬§æ‹‰-phi-å‡½æ•°çš„æ€§è´¨"><a href="#1-æ¬§æ‹‰-phi-å‡½æ•°çš„æ€§è´¨" class="headerlink" title="1.æ¬§æ‹‰$\phi()$å‡½æ•°çš„æ€§è´¨"></a>1.æ¬§æ‹‰$\phi()$å‡½æ•°çš„æ€§è´¨</h2><p>ä»»ä½•æ•°$n$çš„å„ä¸ªå› æ•°ï¼ˆåŒ…æ‹¬$1$å’Œè‡ªèº«ï¼‰çš„$\phi$å€¼ä¹‹å’Œç­‰äº$n$æœ¬èº«</p><p>ä¾‹å¦‚ï¼š$15$çš„å› æ•°æ˜¯$1,3,5,15$ï¼Œ$\phi(1)+\phi(3)+\phi(5)+\phi(15)&#x3D;1+2+4+8&#x3D;15$</p><p><del>(åªä¸Šç»“è®ºï¼Œä¸è®²è¯æ˜)</del></p><h2 id="2-æœ¬åŸå…ƒï¼ˆåŸæ ¹ï¼‰"><a href="#2-æœ¬åŸå…ƒï¼ˆåŸæ ¹ï¼‰" class="headerlink" title="2.æœ¬åŸå…ƒï¼ˆåŸæ ¹ï¼‰"></a>2.æœ¬åŸå…ƒï¼ˆåŸæ ¹ï¼‰</h2><p><strong>æ¦‚å¿µï¼š</strong>ä½¿å¾—$a^e\equiv 1 \pmod p$çš„æœ€å°$e$å€¼ä¸º$p-1$çš„$a$å€¼æˆä¸ºæ¨¡$p$çš„æœ¬åŸå…ƒã€‚</p><p>ä¾‹å¦‚ï¼š$2^e\equiv 1 \pmod {11}$æˆç«‹çš„æœ€å°$e$å€¼ä¸º$10$ï¼Œæ‰€ä»¥$2$æ˜¯æ¨¡$11$çš„æœ¬åŸå…ƒã€‚è€Œ$3^e\equiv 1 \pmod {11}$æˆç«‹çš„æœ€å°$e$å€¼ä¸º$5$ï¼Œæ‰€ä»¥$3$ä¸æ˜¯æ¨¡$11$æ„ä¹‰ä¸‹çš„æœ¬åŸå…ƒã€‚</p><p>åœ¨æ¨¡$11$çš„æ„ä¹‰ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è®¾$\mathrm{ord}(x)$å‡½æ•°ï¼Œæ­¤å¤„æœ‰$\mathrm{ord}(2)&#x3D;10,\mathrm{ord}(3)&#x3D;5$ã€‚å½“ç„¶ï¼Œå¦‚æœæ”¾åœ¨æ¨¡$7$çš„æ„ä¹‰ä¸‹ï¼Œ$\mathrm{ord}(2),\mathrm{ord}(3)$çš„å€¼å°±åˆ†åˆ«å˜æˆäº†$3,6$ã€‚é‚£ä¹ˆæ¨¡$7$æ„ä¹‰ä¸‹ï¼Œ$3$å°±æ˜¯æœ¬åŸå…ƒï¼Œ$2$ä¸æ˜¯äº†ã€‚</p><p>æˆ‘ä»¬çœ‹çœ‹åœ¨æ¨¡$11$å’Œæ¨¡$7$çš„æ„ä¹‰ä¸‹å„ä¸ªæ•°çš„$\mathrm{ord}$å€¼</p><table><thead><tr><th>$x$</th><th>$\texttt{1}$</th><th>$\texttt{2}$</th><th>$\texttt{3}$</th><th>$\texttt{4}$</th><th>$\texttt{5}$</th><th>$\texttt{6}$</th><th align="left">$\texttt{7}$</th><th>$\texttt{8}$</th><th>$\texttt{9}$</th><th>$\texttt{10}$</th></tr></thead><tbody><tr><td>$\mathrm {ord}_7(x)$</td><td>$\texttt{1}$</td><td>$\texttt{3}$</td><td>$\texttt{6}$</td><td>$\texttt{3}$</td><td>$\texttt{6}$</td><td>$\texttt{2}$</td><td align="left">$\texttt{undef}$</td><td>$\texttt{undef}$</td><td>$\texttt{undef}$</td><td>$\texttt{undef}$</td></tr><tr><td>$\mathrm {ord}_{11}(x)$</td><td>$\texttt{1}$</td><td>$\texttt{10}$</td><td>$\texttt{5}$</td><td>$\texttt{5}$</td><td>$\texttt{5}$</td><td><strong>$\texttt{10}$</strong></td><td align="left">$\texttt{10}$</td><td>$\texttt{10}$</td><td>$\texttt{5}$</td><td>$\texttt{2}$</td></tr></tbody></table><p>å¯¹äºä»»æ„ç´ æ•°$p$æ¥è¯´ï¼Œæ€»æœ‰$\phi(p-1)$ä¸ªæœ¬åŸå…ƒã€‚ä¾‹å¦‚ï¼šç”±äº$\phi(10)&#x3D;4$ï¼Œæ‰€ä»¥æ¨¡$11$çš„æ„ä¹‰ä¸‹ï¼Œä¸€å…±æœ‰$4$ä¸ªæœ¬åŸå…ƒï¼Œåˆ†åˆ«æ˜¯$2,6,7,8$ã€‚ç°åœ¨è¿˜æ²¡æœ‰æ±‚æœ¬åŸå…ƒçš„æœ‰æ•ˆæ–¹æ³•ã€‚ä¸è¿‡æ ¹æ®è¡¨æ ¼ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è§‚å¯Ÿåˆ°ä»¥ä¸‹$3$ä¸ªè§„å¾‹ï¼š<br><strong>1.</strong> ä»»ä½•å°äº$p$çš„$\mathrm{ord}$å€¼å‡ä¸º$p-1$çš„å› æ•°<br><strong>2.</strong> äºŒæ¬¡å‰©ä½™ä¸€å®šä¸æ˜¯æœ¬åŸå…ƒï¼Œå¹¶ä¸”äºŒæ¬¡å‰©ä½™çš„$\mathrm{ord}$å€¼æ°å¥½ä¸º$\dfrac{p-1}{2}$<br><strong>3.</strong> $\mathrm{ord}(p-1)&#x3D;2$</p><p> <strong>COSTASé˜µåˆ—</strong></p><p>COSTASé˜µåˆ—çš„æ€§è´¨ï¼šæ„å»ºä¸€ä¸ª$p-1$é˜¶çš„æ–¹é˜µï¼Œç„¶åè¦æ±‚æ¯è¡Œã€æ¯åˆ—éƒ½æœ‰ä¸€ä¸ª$1$ï¼Œå…¶ä»–å…ƒç´ å‡ä¸º$0$ã€‚å¹¶ä¸”ä»»ä½•ä¸¤ä¸ª$1$çš„è¿çº¿çš„é•¿åº¦æˆ–æ–œç‡éƒ½ä¸ç›¸åŒã€‚</p><p>ä¸€èˆ¬é€‰æ‹©ä¸€ä¸ªæœ¬æºå…ƒå³å¯æ„é€ ä¸€ä¸ªCOSTASé˜µåˆ—ã€‚æ¯”å¦‚ï¼š$5$æ˜¯æ¨¡$7$æ„ä¹‰ä¸‹çš„ä¸€ä¸ªæœ¬æºå…ƒï¼Œäºæ˜¯æœ‰äº†åºåˆ—$5,4,6,2,3,1$ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ª$6Ã—6$çš„çŸ©é˜µ$A$</p><p><img src="/2021/01/11/NumberTheory4/1.png" alt="1"></p><p>å­˜åœ¨$k$ä½¿å¾—$A^k&#x3D;E&#x3D;\mathrm{diag}(1,1,1,1,1,1)$</p><h2 id="3-æŒ‡æ ‡ï¼ˆå³ç¦»æ•£å¯¹æ•°ï¼‰"><a href="#3-æŒ‡æ ‡ï¼ˆå³ç¦»æ•£å¯¹æ•°ï¼‰" class="headerlink" title="3.æŒ‡æ ‡ï¼ˆå³ç¦»æ•£å¯¹æ•°ï¼‰"></a>3.æŒ‡æ ‡ï¼ˆå³ç¦»æ•£å¯¹æ•°ï¼‰</h2><p>ç”±$2^9\equiv 5 \pmod {13}$ï¼Œå¯ä»¥è®°ä¸º$I(5)&#x3D;9\equiv \dfrac{\ln5}{\ln2} \pmod {13}$</p><p>å½“æˆ‘ä»¬è§„å®šåº•æ•°$a$æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¾$I(x)&#x3D;\dfrac{\ln x}{\ln a}$çš„å¯¹æ•°å½¢å¼ï¼Œè¯¥å¯¹æ•°çš„è¿ç®—ä¸æ•°å­¦ä¸Šå·²çŸ¥çš„å¯¹æ•°å½¢å¼ä¸€æ¨¡ä¸€æ ·ã€‚è¿™ä¹Ÿæ˜¯æˆ‘åé¢åšå®¢é‡Œè°ˆåˆ°ç¦»æ•£å¯¹æ•°é—®é¢˜æ‰€è¦è€ƒè™‘åˆ°çš„ä¸œè¥¿ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åšä¸ªè¡¨ï¼Œè®¾$p&#x3D;7,a&#x3D;5$ï¼Œé‚£ä¹ˆ$I(1)$åˆ°$I(6)$åˆ†åˆ«ä¸º$6,4,5,2,1,3$ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦è®¡ç®—$3Ã—5$ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥è¡¨å¾—$I(3)&#x3D;5,I(5)&#x3D;3,5+3\equiv 1\pmod 7$æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°$3Ã—5\equiv1\pmod7$</p><p>ä¸è¿‡ç¦»æ•£å¯¹æ•°ä¸­å¾—å¯†ç å­¦ä¹Ÿæ˜¯ä¸ªæå…¶éš¾è§£çš„é—®é¢˜ï¼Œåé¢å¦‚æœå¯ä»¥ï¼Œä¼šå¢åŠ ç›¸å…³æ¨æ–‡ã€‚</p><h2 id="4-äºŒé¡¹å¼å®šç†æ¨¡-p-æ‰©å……"><a href="#4-äºŒé¡¹å¼å®šç†æ¨¡-p-æ‰©å……" class="headerlink" title="4.äºŒé¡¹å¼å®šç†æ¨¡$p$æ‰©å……"></a>4.äºŒé¡¹å¼å®šç†æ¨¡$p$æ‰©å……</h2><p>ä¸¤ä¸ªç»“è®ºï¼š<br>1.$\mathrm{C}_p^k \equiv 0 \pmod p,k \not &#x3D; 0,p$<br>2.è‹¥$p$ä¸ºç´ æ•°ï¼Œæœ‰$(A+B)^p\equiv A^p+B^p \pmod p$</p><h2 id="5-Fibonacciæ•°åˆ—"><a href="#5-Fibonacciæ•°åˆ—" class="headerlink" title="5.Fibonacciæ•°åˆ—"></a>5.Fibonacciæ•°åˆ—</h2><p>ä¸€èˆ¬çš„Fibonacciæ•°åˆ—ï¼š$1,1,2,3,5,8,â€¦â€¦$ï¼Œæœ‰$F_1&#x3D;F_2&#x3D;1,F_{n}&#x3D;F_{n-1}+F_{n-2}$</p><p><strong>1.ç±»Fibonacciæ•°åˆ—çš„æ±‚é€šé¡¹å…¬å¼çš„æ–¹æ³•</strong></p><p>å¯ä»¥ä½¿ç”¨çŸ©é˜µè¿ç®—ï¼š</p><p><img src="/2021/01/11/NumberTheory4/2.png" alt="2"></p><p>å¹¶ä¸”è¿™ä¸ªæ–¹æ³•è¿˜å¯ä»¥æ¨å¹¿åˆ°çŸ©é˜µå¿«é€Ÿå¹‚çš„è®¡ç®—ä¸Šå»ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æ‰©å±•ä»¥ä¸‹ï¼šå‡å¦‚æœ‰ä¸€ä¸ªæ•°åˆ—$G_n&#x3D;aG_{n-1}+bG_{n-2}$ï¼Œå¹¶ç»™å‡ºåˆå€¼$G_1,G_2$ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸‹é¢çš„çŸ©é˜µã€‚</p><p><img src="/2021/01/11/NumberTheory4/3.png" alt="3"></p><p>å¦‚æœæƒ³æ±‚é€šé¡¹å…¬å¼ï¼Œåªéœ€è¦æ±‚å‡ºæœ€å·¦è¾¹çŸ©é˜µçš„$2$ä¸ªç‰¹å¾å€¼$E_1,E_2$ï¼Œé‚£ä¹ˆé€šé¡¹å…¬å¼å°±æ˜¯$G_n&#x3D;C_1E_1^n+C_2E_2^n$ï¼Œå¸¦å…¥åˆå€¼å³å¯æ±‚å¾—å¾…å®šç³»æ•°ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç»§ç»­æ‰©å±•åˆ°ä¸‰é˜¶çŸ©é˜µï¼š$H_n&#x3D;aH_{n-1}+bH_{n-2}+cH_{n-3}$</p><p><img src="/2021/01/11/NumberTheory4/4.png" alt="4"></p><p>ç„¶ååŒæ ·æ˜¯æ±‚ç‰¹å¾å€¼ä¹‹åç”¨å¾…å®šç³»æ•°æ³•åˆ©ç”¨åˆå€¼åˆ—æ–¹ç¨‹æ±‚è§£ã€‚</p><p><strong>Fibonacciæ•°åˆ—çš„æ¨¡$p$å‘¨æœŸ</strong></p><p>å¯¹äºä»»æ„ç´ æ•°ï¼Œæœ‰$T(p^k)&#x3D;p^{k-1}T(p)$ã€‚</p><p>$T(2)&#x3D;3,T(5)&#x3D;20$æ˜¯ä¸¤ä¸ªç‰¹æ®Šå€¼</p><p>å¦‚æœ$p\equiv 1 \text8{ or }4 \pmod 5$ï¼Œé‚£ä¹ˆ$T(p)&#x3D;p$ã€‚å¦‚æœ$p\equiv2 \text{ or } 3 \pmod 5$ï¼Œé‚£ä¹ˆ$T(p)&#x3D;2p+2$</p><p>å½“$a$æ˜¯åˆæ•°ï¼Œ$p$æ˜¯ä¸åŒçš„ç´ æ•°æ—¶ï¼Œ$a&#x3D;p_1^{e_1}p_2^{e_2}â€¦p_n^{e_n}$æ—¶ï¼Œ$T(a)&#x3D;T(p_1)T(p_2)â€¦T(p_n)$ã€‚</p><p>ä¾‹å¦‚ï¼š$72&#x3D;2^3Ã—3^2$ï¼Œé‚£ä¹ˆæœ‰$T(72)&#x3D;T(2)T(3)&#x3D;3Ã—8&#x3D;24$</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NumberTheory3</title>
    <link href="/2021/01/10/NumberTheory3/"/>
    <url>/2021/01/10/NumberTheory3/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-å­¦ä¹ æ•°è®ºçš„ç¬”è®°3"><a href="#huangx607087-å­¦ä¹ æ•°è®ºçš„ç¬”è®°3" class="headerlink" title="huangx607087 å­¦ä¹ æ•°è®ºçš„ç¬”è®°3"></a>huangx607087 å­¦ä¹ æ•°è®ºçš„ç¬”è®°3</h1><h2 id="1-ç´ æ€§æµ‹è¯•-å¡ç±³æ­‡å°”æ•°"><a href="#1-ç´ æ€§æµ‹è¯•-å¡ç±³æ­‡å°”æ•°" class="headerlink" title="1.ç´ æ€§æµ‹è¯•&amp;å¡ç±³æ­‡å°”æ•°"></a>1.ç´ æ€§æµ‹è¯•&amp;å¡ç±³æ­‡å°”æ•°</h2><p>ç”±è´¹é©¬å°å®šç†å¯çŸ¥ï¼š $\text{isPrime}(p)&#x3D;1 \Rightarrow a^{p-1}\equiv 1 \pmod p$</p><p>ç„¶è€Œï¼š$a^{p-1}\equiv 1 \pmod p \not\Rightarrow \text{isPrime}(p)&#x3D;1$</p><p>å¡ç±³æ­‡å°”æ•°å°±æ˜¯ç¬¦åˆ$a^{p-1}\equiv 1 \pmod p $å¹¶ä¸”$ \text{isPrime}(p)&#x3D;0$çš„ä¸€ç±»æ•°å­—ï¼Œæœ€å°çš„æ•°æ˜¯$561$ï¼Œ$10000$ä»¥å†…çš„å¡ç±³æ­‡å°”æ•°ä¸€å…±æœ‰$7$ä¸ªï¼Œåˆ†åˆ«æ˜¯$561,1105,1729,2465,2821,6601,8911$</p><p><strong>å¡ç±³æ­‡å°”æ•°çš„æ€§è´¨</strong> è®¾$C$ä¸ºå¡ç±³æ­‡å°”æ•°ï¼Œ$p$æ˜¯$C$çš„è´¨å› æ•°ï¼Œåˆ™$p^2$ä¸æ•´é™¤$C$ï¼Œå¹¶ä¸”$p-1$å¯ä»¥æ•´é™¤$C-1$</p><p><strong>æ ¹æ®ä»¥ä¸Šçš„ç»“è®ºï¼Œæˆ‘ä»¬ä¸å¯ä»¥ç”¨è´¹é©¬å°å®šç†åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºç´ æ•°(è™½ç„¶å‡†ç¡®ç‡å¾ˆé«˜ï¼Œä½†è¿˜æ˜¯æœ‰é”™è¯¯ç‡çš„)ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹é¢çš„ç´ æ•°æ€§è´¨</strong></p><table><thead><tr><th>ç´ æ•°çš„çš„æ€§è´¨ 2</th></tr></thead><tbody><tr><td>å¦‚æœ$p$æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆ$p$æ»¡è¶³ä»¥ä¸‹$2$ä¸ªæ¡ä»¶ä¹‹ä¸€ï¼ˆè®¾$p-1&#x3D;2^kq$ï¼Œå…¶ä¸­$q$ä¸ºå¥‡æ•°ï¼‰<br>1.$a^q\equiv 1 \pmod p$<br>2.$a^q,a^{2q},a^{4q},â€¦,a^{2^{k-1}q}$ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ¨¡$p$ç»“æœä¸º$-1\pmod p$</td></tr></tbody></table><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä»¥ä¸‹åˆ¤æ–­ç´ æ•°çš„ä»£ç ï¼Œä¸€æ¬¡è¯¯åˆ¤ç‡ä½äº$0.25$ï¼ŒåŸºæœ¬ä¸Š$30$æ¬¡çš„åˆ¤æ–­å‡†ç¡®ç‡å°±è¶…è¿‡äº†è´¹é©¬å°å®šç†äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">izprime</span>(<span class="hljs-params">p</span>):<br>    q=p-<span class="hljs-number">1</span><br>    B=p.bit_length()<br>    K=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span>(q&amp;<span class="hljs-number">1</span>==<span class="hljs-number">0</span>):<br>        q&gt;&gt;=<span class="hljs-number">1</span><br>        K=K+<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(q,K)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>        a=bytes_to_long(urandom(B%<span class="hljs-number">700</span>))%p<br>        <span class="hljs-keyword">if</span>( <span class="hljs-built_in">pow</span>(a,q,p)==<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">pow</span>(a,q,p)==p-<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>        E=q<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(K):<br>            E=(E*<span class="hljs-number">2</span>)%p<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">pow</span>(a,E,p)==p-<span class="hljs-number">1</span>):<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(izprime(<span class="hljs-number">7878787629</span>))<br></code></pre></td></tr></table></figure><h2 id="2-äºŒæ¬¡äº’åå¾‹å’Œæœ‰é™åŸŸå¼€å¹³æ–¹"><a href="#2-äºŒæ¬¡äº’åå¾‹å’Œæœ‰é™åŸŸå¼€å¹³æ–¹" class="headerlink" title="2.äºŒæ¬¡äº’åå¾‹å’Œæœ‰é™åŸŸå¼€å¹³æ–¹"></a>2.äºŒæ¬¡äº’åå¾‹å’Œæœ‰é™åŸŸå¼€å¹³æ–¹</h2><h3 id="PART-1ï¼šäºŒæ¬¡äº’åå¾‹"><a href="#PART-1ï¼šäºŒæ¬¡äº’åå¾‹" class="headerlink" title="PART 1ï¼šäºŒæ¬¡äº’åå¾‹"></a>PART 1ï¼šäºŒæ¬¡äº’åå¾‹</h3><p>äºŒæ¬¡äº’åå¾‹åœ¨ 0xGame Div 4 é‡Œé¢æœ‰å¾ˆè¯¦ç»†çš„è®²è§£ï¼Œè¿™é‡Œç›´æ¥æ”¾ä¸€ä¸‹ç»“è®ºã€‚</p><p><img src="/2021/01/10/NumberTheory3/1.png" alt="1"></p><p>ç¨‹åºä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">isqr</span>(<span class="hljs-params">x,p</span>):<br>    <span class="hljs-keyword">if</span> p==<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    sgn=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> x%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>:<br>        x=x//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> p%<span class="hljs-number">8</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">or</span> p%<span class="hljs-number">8</span>==<span class="hljs-number">5</span>:<br>            sgn=-sgn<br>    <span class="hljs-keyword">if</span> x&lt;p:<br>        _tmp=p<br>        p=x<br>        x=_tmp<br>        <span class="hljs-keyword">if</span> x%<span class="hljs-number">4</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">and</span> p%<span class="hljs-number">4</span>==<span class="hljs-number">3</span> :<br>            sgn=-sgn<br>    <span class="hljs-keyword">return</span> sgn*isqr(x%p,p)<br></code></pre></td></tr></table></figure><h3 id="PART-2ï¼šæœ‰é™åŸŸå¼€å¹³æ–¹å…¬å¼-UPD-2021-2-10-2021-8-5"><a href="#PART-2ï¼šæœ‰é™åŸŸå¼€å¹³æ–¹å…¬å¼-UPD-2021-2-10-2021-8-5" class="headerlink" title="PART 2ï¼šæœ‰é™åŸŸå¼€å¹³æ–¹å…¬å¼[UPD 2021 .2.10,2021.8.5]"></a>PART 2ï¼šæœ‰é™åŸŸå¼€å¹³æ–¹å…¬å¼[UPD 2021 .2.10,2021.8.5]</h3><p>è§£æ–¹ç¨‹$x^2\equiv a \pmod p$ï¼Œå…¶ä¸­$p$æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆå¼€å¹³æ–¹æœ‰å¦‚ä¸‹å…¬å¼ï¼š</p><p>å½“$p\equiv 3 \pmod 4$æ—¶ï¼Œ$x^2\equiv a \pmod p$çš„ä¸€ä¸ªè§£ä¸º<br>$$<br>x&#x3D;a^{(p+1)&#x2F;4}<br>$$<br>å½“$p\equiv 5 \pmod 8$æ—¶ï¼Œ$x^2\equiv a \pmod p$çš„ä¸€ä¸ªè§£ä¸º<br>$$<br>x&#x3D;2^{(p-1)&#x2F;4}a^{(p+3)&#x2F;8}<br>$$<br>è¿™ä¸€ç§æƒ…å†µï¼Œä¹Ÿæœ‰ç‰ˆæœ¬è¯´æ˜¯$a^{(p+3)&#x2F;8}$å’Œ$2a(4a)^{(p-5)&#x2F;8}$ä¸¤ä¸ªæ•°ä¸­çš„ä¸€ä¸ªã€‚</p><p>æœ€å›°éš¾çš„å°±æ˜¯$p\equiv 1 \pmod 8$çš„æƒ…å†µäº†ï¼Œè¿™ä¸ªæ–¹æ³•æ²¡æœ‰å…¬å¼å¯ç”¨ã€‚</p><p>ä»¥ä¸‹å°±æ˜¯å®Œæ•´çš„æœ‰é™åŸŸå¼€å¹³æ–¹çš„ä»£ç äº†ï¼ˆå®é™…ä¸Š<code>solve_M8R1</code>è¿™ä¸ªå‡½æ•°é€‚ç”¨äºä»»ä½•ç´ æ•°ï¼Œä½†ç”±äºå…¶ä»–ä¸¤ç±»ç´ æ•°å·²ç»æœ‰å…¬å¼å¯ç”¨ï¼Œæ•…è¿™é‡Œåªç”¨äº$p\equiv 1 \pmod8$çš„æƒ…å†µé‡Œï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Complex</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,x=<span class="hljs-number">0</span>,y=<span class="hljs-number">0</span></span>):<br>        <span class="hljs-variable language_">self</span>.real=x<br>        <span class="hljs-variable language_">self</span>.imag=y<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">isqr</span>(<span class="hljs-params">x,p</span>):<br>    <span class="hljs-keyword">if</span> p==<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    sgn=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> x&amp;<span class="hljs-number">1</span>==<span class="hljs-number">0</span>:<br>        x&gt;&gt;=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> p&amp;<span class="hljs-number">7</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">or</span> p&amp;<span class="hljs-number">7</span>==<span class="hljs-number">5</span>:<br>            sgn=-sgn<br>    <span class="hljs-keyword">if</span> x&lt;p:<br>        x,p=p,x<br>        <span class="hljs-keyword">if</span> x&amp;<span class="hljs-number">3</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">and</span> p&amp;<span class="hljs-number">3</span>==<span class="hljs-number">3</span> :<br>            sgn=-sgn<br>    <span class="hljs-keyword">return</span> sgn*isqr(x%p,p)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Rand</span>(<span class="hljs-params">p</span>):<br>    <span class="hljs-keyword">return</span> bytes_to_long(urandom(<span class="hljs-number">80</span>))%p<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Cmul</span>(<span class="hljs-params">a,b,nr,p</span>):<br>    Real=a.real*b.real+a.imag*b.imag*nr<br>    Imag=a.real*b.imag+b.real*a.imag<br>    Res=Complex(Real%p,Imag%p)<br>    <span class="hljs-keyword">return</span> Res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Cpow</span>(<span class="hljs-params">a,e,nr,p</span>):<br>    Res=Complex(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> e:<br>        <span class="hljs-keyword">if</span> e&amp;<span class="hljs-number">1</span>:<br>            Res=Cmul(a,Res,nr,p)<br>        a=Cmul(a,a,nr,p)<br>        e&gt;&gt;=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> Res<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_M8R1</span>(<span class="hljs-params">n,p</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        a=Rand(p)<br>        nr=(a*a-n)%p<br>        <span class="hljs-keyword">if</span> isqr(nr,p)==-<span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">break</span><br>    Res=Complex(a,<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> Cpow(Res,(p+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>,nr,p)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">n,p</span>):<br>    <span class="hljs-keyword">assert</span> isPrime(p)<br>    A=<span class="hljs-literal">None</span><br>    <span class="hljs-keyword">if</span> n==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">if</span> isqr(n,p)==-<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Solution!&quot;</span><br>    <span class="hljs-keyword">if</span> p&amp;<span class="hljs-number">3</span>==<span class="hljs-number">3</span>:<br>        A=<span class="hljs-built_in">pow</span>(n,(p+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,p)<br>    <span class="hljs-keyword">elif</span> p&amp;<span class="hljs-number">7</span>==<span class="hljs-number">5</span>:<br>        A=<span class="hljs-built_in">pow</span>(n,(p+<span class="hljs-number">3</span>)//<span class="hljs-number">8</span>,p)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(A,<span class="hljs-number">2</span>,p)!=n:<br>            A=<span class="hljs-number">2</span>*n*<span class="hljs-built_in">pow</span>(<span class="hljs-number">4</span>*n,(p-<span class="hljs-number">5</span>)//<span class="hljs-number">8</span>,p)%p<br>    <span class="hljs-keyword">elif</span> p&amp;<span class="hljs-number">7</span>==<span class="hljs-number">1</span>:<br>        A=solve_M8R1(n,p).real<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">min</span>(A,p-A)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getQR</span>(<span class="hljs-params">p</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        qr=Rand(p)<br>        <span class="hljs-keyword">if</span> isqr(qr,p)==<span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> qr<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getNR</span>(<span class="hljs-params">p</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        nr=Rand(p)<br>        <span class="hljs-keyword">if</span> isqr(nr,p)==-<span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> nr<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getmod8prime</span>(<span class="hljs-params">Rem,nbits=<span class="hljs-number">100</span></span>):<br>    <span class="hljs-keyword">assert</span> Rem <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>]<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        p=getPrime(nbits)<br>        <span class="hljs-keyword">if</span>(p%<span class="hljs-number">8</span>==Rem):<br>            <span class="hljs-keyword">return</span> p<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">example</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>]:<br>        p=getmod8prime(i)<br>        qr=getQR(p)<br>        <span class="hljs-built_in">print</span>(i,qr,p)<br>        <span class="hljs-built_in">print</span>(solve(qr,p))<br>example()<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">1 564173686680696855894901625202 778582575909658190525427416257</span><br><span class="hljs-string">140078267336201622222046402618</span><br><span class="hljs-string">3 20669060859351317353915889852 727816416573858078097661465723</span><br><span class="hljs-string">130587125639883746397277540316</span><br><span class="hljs-string">5 791308279743632016519220848802 1167144785223888272103478393117</span><br><span class="hljs-string">544427040026345522165219328929</span><br><span class="hljs-string">7 40133816673762059960442044861 635211803801872717209601629487</span><br><span class="hljs-string">129389297469578896835881311090</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="3-p-a-2-b-2"><a href="#3-p-a-2-b-2" class="headerlink" title="3.$p&#x3D;a^2+b^2?$"></a>3.$p&#x3D;a^2+b^2?$</h2><p><strong>ç»“è®º1ï¼š</strong>å¦‚æœæŸç´ æ•°$p$å¯ä»¥è¡¨ç¤ºæˆä¸¤ä¸ªæ­£æ•´æ•°çš„å¹³æ–¹å’Œï¼Œ é‚£ä¹ˆ$p\equiv 1 \pmod 4$ï¼Œåè¿‡æ¥ä¹ŸåŒæ ·æˆç«‹ã€‚</p><p>ä¸‹é¢ç”¨é€’é™æ³•æ±‚$a,b$ï¼š<br>é¦–å…ˆï¼Œå†™$A^2+B^2&#x3D;Mp,M&lt;p$<br>ç„¶åï¼Œé€‰å–$u,v$ï¼Œä½¿å¾—$u\equiv A \pmod p,v\equiv B \pmod p,u,v,\in [\dfrac{-M}{2},\dfrac{M}{2}]$<br>æˆ‘ä»¬å¯ä»¥å¾—åˆ°$u^2+v^2&#x3D;A^2+B^2\equiv 0 \pmod M$ã€‚ä»è€Œè®¾$u^2+v^2&#x3D;Mr,A^2+B^2&#x3D;Mp$<br>å°†ä¸Šé¢ä¸¤ä¸ªå¼å­ç›¸ä¹˜ï¼Œå¾—$(u^2+v^2)(A^2+B^2)&#x3D;M^2rp$<br>è¿™ä¸ªå¼å­ç»è¿‡æ’ç­‰å˜å½¢ï¼Œå¯ä»¥åŒ–ä¸º$(uA+vB)^2+(vA-uB)^2&#x3D;M^2rp$<br>ä¸¤ç«¯åŒæ—¶é™¤ä»¥$M^2$ï¼Œå°±æœ‰$\dfrac{(uA+vB)^2+(vA-uB)^2}{M^2}&#x3D;rp$<br>å¯ä»¥è¯æ˜ï¼Œ$râ‰¤\dfrac{M}{2}$ï¼Œç„¶åç»§ç»­é€’é™å³å¯ã€‚</p><p><strong>å…³äºé€‰å–$A,B$æ—¶éœ€è¦çš„æ³¨æ„ç‚¹ï¼š</strong> æˆ‘ä»¬å¯ä»¥å–$x^2\equiv -1 \pmod p$ï¼Œé‚£ä¹ˆæœ‰$A&#x3D;x,B&#x3D;1,M&#x3D;\dfrac{A^2+B^2}{p}$<br>è§£æ–¹ç¨‹$x^2\equiv -1 \pmod p$æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥éšæœºé€‰å–ä¸€ä¸ªæ•°$t$ï¼Œç„¶åè®¡ç®—$b\equiv t^{\frac{(p-1)}{4}}\pmod p$ã€‚åˆå› ä¸º$b^2\equiv(\frac{t}{p})\pmod p$ã€‚æ‰€ä»¥$t$æ€»æ˜¯æœ‰$\dfrac{1}{2}$çš„æˆåŠŸæ¦‚ç‡ã€‚</p><p>ä¸‹é¢ä¸Šä¸€ä¸‹ä»£ç ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯$O(\ln p)$çº§åˆ«çš„ï¼Œ$2048$ä½çš„è´¨æ•°ç”¨æ—¶ä¸º$2$ç§’ï¼Œè¿è¡Œèµ·æ¥è¿˜æ˜¯å¾ˆå¿«çš„ã€‚</p><p><strong>Update 2021.8.8 å°†<code>M==1</code>çš„åˆ¤æ–­ä¸­ <code>return(A,B)</code>ä¸­çš„<code>A,B</code>åŠ ä¸Šäº†ç»å¯¹å€¼ï¼Œå› ä¸ºæˆ‘ä»¬åªè®¨è®ºæ­£æ•°</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getA</span>(<span class="hljs-params">p</span>):<br>    <span class="hljs-keyword">assert</span>(p%<span class="hljs-number">4</span>==<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        t=bytes_to_long(urandom(<span class="hljs-number">195</span>))%p<br>        s=<span class="hljs-built_in">pow</span>(t,(p-<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,p)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">pow</span>(s,<span class="hljs-number">2</span>,p)==p-<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> s<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getAns</span>(<span class="hljs-params">A,B,M,p</span>):<br>    <span class="hljs-keyword">if</span>(M==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">abs</span>(A),<span class="hljs-built_in">abs</span>(B))<br>    u,v=A%M,B%M<br>    <span class="hljs-keyword">if</span>(u&gt;M//<span class="hljs-number">2</span>):<br>        u-=M<br>    <span class="hljs-keyword">if</span>(v&gt;M//<span class="hljs-number">2</span>):<br>        v-=M<br>    <span class="hljs-keyword">assert</span>((u**<span class="hljs-number">2</span>+v**<span class="hljs-number">2</span>)%M==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> (A**<span class="hljs-number">2</span>+B**<span class="hljs-number">2</span>)%M==<span class="hljs-number">0</span> )<br>    r=(u**<span class="hljs-number">2</span>+v**<span class="hljs-number">2</span>)//M<br>    A2=(u*A+v*B)//M<br>    B2=(-u*B+v*A)//M<br>    <span class="hljs-keyword">return</span> getAns(A2,B2,r,p)<br><span class="hljs-comment">#------MAIN BELOW------#</span><br>p=getPrime(<span class="hljs-number">256</span>)<br><span class="hljs-keyword">while</span>(p%<span class="hljs-number">4</span>==<span class="hljs-number">3</span>):<br>    p=getPrime(<span class="hljs-number">256</span>)<br>A=getA(p)<br>B=<span class="hljs-number">1</span><br><span class="hljs-keyword">assert</span>(A**<span class="hljs-number">2</span>+B**<span class="hljs-number">2</span>)%p==<span class="hljs-number">0</span><br>M=(A**<span class="hljs-number">2</span>+B**<span class="hljs-number">2</span>)//p<br>Ans,Bns=getAns(A,B,M,p)<br>Ans,Bns=Ans%p,Bns%p<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p=&#x27;</span>,<span class="hljs-built_in">hex</span>(p)[<span class="hljs-number">2</span>:])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Ans=&#x27;</span>,<span class="hljs-built_in">hex</span>(Ans)[<span class="hljs-number">2</span>:])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Bns=&#x27;</span>,<span class="hljs-built_in">hex</span>(Bns)[<span class="hljs-number">2</span>:])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;The answer is:&#x27;</span>,(Ans*Ans+Bns*Bns)%p==<span class="hljs-number">0</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p= d01bb38ba2700cdbd299f1182d0219cc43a9fd03bcdb9c53b69ea2a38dd3cec1</span><br><span class="hljs-string">Ans= e0940478adf7d82d6c27327dbfce631f</span><br><span class="hljs-string">Bns= 354b787c45b1c0cf60b30879b3caab70</span><br><span class="hljs-string">The answer is: True</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RSA Notes 2</title>
    <link href="/2020/11/28/RSA-Notes2/"/>
    <url>/2020/11/28/RSA-Notes2/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ RSAçš„ç¬”è®°-2"><a href="#huangx607087å­¦ä¹ RSAçš„ç¬”è®°-2" class="headerlink" title="huangx607087å­¦ä¹ RSAçš„ç¬”è®°(2)"></a>huangx607087å­¦ä¹ RSAçš„ç¬”è®°(2)</h1><h2 id="O-æƒ…å†µè¯´æ˜"><a href="#O-æƒ…å†µè¯´æ˜" class="headerlink" title="O-æƒ…å†µè¯´æ˜"></a>O-æƒ…å†µè¯´æ˜</h2><p><strong>çº¦å®šï¼šæ­¤åšå®¢ä¸­å¦‚æœå‡ºç°é™¤æ³•ï¼Œæœªç‰¹æ®Šè¯´æ˜çš„ï¼Œå‡ä¸ºå‘ä¸‹å–æ•´çš„æ•´é™¤ï¼</strong></p><h2 id="I-RSAçš„ä¹˜æ³•çš„åŒæ€æ€§"><a href="#I-RSAçš„ä¹˜æ³•çš„åŒæ€æ€§" class="headerlink" title="I-RSAçš„ä¹˜æ³•çš„åŒæ€æ€§"></a>I-RSAçš„ä¹˜æ³•çš„åŒæ€æ€§</h2><h3 id="0x01-ç®€ä»‹å’Œ-å¾—åˆ°-m-çš„äºŒè¿›åˆ¶ä½æ•°"><a href="#0x01-ç®€ä»‹å’Œ-å¾—åˆ°-m-çš„äºŒè¿›åˆ¶ä½æ•°" class="headerlink" title="0x01 ç®€ä»‹å’Œ å¾—åˆ°$m$çš„äºŒè¿›åˆ¶ä½æ•°"></a>0x01 ç®€ä»‹å’Œ å¾—åˆ°$m$çš„äºŒè¿›åˆ¶ä½æ•°</h3><p>â€‹CTFä¸­æœ‰äº›é¢˜ç›®ä¼šåœ¨ç»™å‡º$e,n,c$çš„æƒ…å†µä¸‹ï¼Œå…è®¸ä½ å’ŒæœåŠ¡å™¨äº¤äº’ï¼Œå‘é€ä½ è‡ªå·±çš„å¯†æ–‡$câ€™$ï¼Œç„¶åå‘Šè¯‰ä½ æœ‰å…³$câ€™$è§£å¯†åçš„æ˜æ–‡çš„ä¸€äº›é«˜ä½æ¯”ç‰¹ä¿¡æ¯ã€‚åœ¨è¿™ç§æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°RSAä¹˜æ³•å…·æœ‰åŒæ€æ€§çš„è¿™ä¸€ç‰¹æ®Šæ€§è´¨ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯RSAçš„åŒæ€æ€§å‘¢ï¼Ÿ</p><p>â€‹æˆ‘ä»¬å·²ç»çŸ¥é“ï¼ŒRSAåŠ å¯†å‡½æ•°$c&#x3D;E(m) \equiv m^e \mod n$ã€‚å…¶ä¸­$(e,n,c)$ä½œä¸ºå…¬é’¥ï¼Œéƒ½æ˜¯å·²çŸ¥çš„ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥æ¨å¯¼ä¸€ä¸‹è¿™æ ·çš„å…¬å¼ï¼š$E(2m)\equiv 2^em^e\equiv 2^e c\mod n$ã€‚æ‰€ä»¥å¦‚æœåœ¨è·å¾—å¯¹ä¸ªäººå¯†æ–‡çš„è§£å¯†æƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å‘æœåŠ¡å™¨å‘é€$2^e c$ï¼Œè¿™ä¸€å°±å¯ä»¥è·å¾—$2m$çš„å€¼ã€‚åŒç†ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€$2^{ke}c$ï¼Œå¾—åˆ°çš„è§£å¯†ç»“æœå°±æ˜¯$2^{k}m$ã€‚æ‰€ä»¥è¿è¡Œä»¥ä¸‹ä»£ç ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯$(12,24,48,96)$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>m=<span class="hljs-number">12</span><br>p=getPrime(<span class="hljs-number">512</span>)<br>q=getPrime(<span class="hljs-number">512</span>)<br>n=p*q<br>e=<span class="hljs-number">65537</span><br>d=inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(c)<br>c2,c3,c4=c*<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,e,n)%n,c*<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>*e,n)%n,c*<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>*e,n)%n<br><span class="hljs-built_in">print</span>(c2)<br>m1,m2,m3,m4=<span class="hljs-built_in">pow</span>(c,d,n),<span class="hljs-built_in">pow</span>(c2,d,n),<span class="hljs-built_in">pow</span>(c3,d,n),<span class="hljs-built_in">pow</span>(c4,d,n)<br><span class="hljs-built_in">print</span>(m1,m2,m3,m4)<br></code></pre></td></tr></table></figure><p>â€‹è¿™ç§æ–¹æ³•æˆ‘ä»¬å¯ä»¥ç¡®å®šæ˜æ–‡çš„é•¿åº¦ï¼šå‡å¦‚$n$æ˜¯$2048$ä½ï¼Œæ¯æ¬¡ç»™ä½ æœ€é«˜$8$ä½ï¼Œé‚£ä¹ˆè¢«éšè—äº†$2040$ä½ã€‚å‡å¦‚æˆ‘ä»¬ä¸€å…±ç§»åŠ¨äº†$740$ä½å‘ç°é«˜ä½ä¸å†ä¸º$0$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç¡®å®šæ˜æ–‡é•¿åº¦ä¸º$2040-740&#x3D;1300$ä½äºŒè¿›åˆ¶æ•°ã€‚</p><h3 id="0x02-RSAç¡®å®š-m-ä½æ•°åç¡®å®šæ˜æ–‡-m-çš„å€¼"><a href="#0x02-RSAç¡®å®š-m-ä½æ•°åç¡®å®šæ˜æ–‡-m-çš„å€¼" class="headerlink" title="0x02 RSAç¡®å®š$m$ä½æ•°åç¡®å®šæ˜æ–‡$m$çš„å€¼"></a>0x02 RSAç¡®å®š$m$ä½æ•°åç¡®å®šæ˜æ–‡$m$çš„å€¼</h3><p>â€‹å‡å¦‚æˆ‘ä»¬ä»¥ä¸Šé¢é‚£ä¸ªä¸ºä¾‹å­ï¼Œæˆ‘ä»¬ç¡®å®šäº†æ˜æ–‡æ˜¯$1300$ä½äºŒè¿›åˆ¶æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å°±å¯ä»¥äºŒåˆ†äº†ï¼šæˆ‘ä»¬å¯ä»¥è®¾ç½®$L&#x3D;2^{739},R&#x3D;2^{740}$è¿›è¡ŒäºŒåˆ†æ“ä½œã€‚</p><p>â€‹æ³¨æ„åœ¨RSAä¸­ï¼Œæœ‰ä¸€ä¸ªå¾ˆç¥å¥‡çš„å¼å­ï¼š<br>$$<br>(pm)^e \equiv cp^e \mod n<br>$$</p><p>â€‹ç„¶åæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·çš„æ–¹ç¨‹ï¼š$I&#x3D;\dfrac {2^{2040}}{m}âˆˆ[2^{739},2^{740}]$ï¼Œä¹Ÿå°±æ˜¯$I \in [2Ã—2^{738},4Ã—2^{738}]$ã€‚å¯¹æœåŠ¡å™¨å‘é€åŒºé—´<strong>ä¸­å€¼$M&#x3D;3Ã—2^{738}$çš„åŠ å¯†ç»“æœä¹˜ä¸Š$c$çš„å€¼</strong>ï¼Œå¦‚æœæœåŠ¡å™¨å‘Šè¯‰ä½ æœ€é«˜çš„$8$ä½äºŒè¿›åˆ¶æ•°å€¼ä¸ä¸º$0$ï¼Œåˆ™è¯´æ˜æˆ‘ä»¬å‘é€çš„æ•°å­—åå¤§ï¼Œéšåæˆ‘ä»¬å°±å¯ä»¥æ¢åŒºé—´å³è¾¹ç•Œ$R$ä¸ºè¿™ä¸€æ¬¡çš„ä¸­å€¼$M$,åŒºé—´å˜æˆ$[4Ã—2^{737},6Ã—2^{737}]$ã€‚è‹¥æœ€åå‘Šè¯‰ä½ ç»“æœä¸º$0$ï¼Œé‚£ä¹ˆè¯´æ˜æˆ‘ä»¬å‘é€çš„å€¼åå°ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥æŠŠå·¦è¾¹ç•Œæ¢æˆ$M$ï¼Œç„¶åæŠŠåŒºé—´æ¢æˆ$[6Ã—2^{737},8Ã—2^{737}]$ã€‚åé¢ä»¥æ­¤ç±»æ¨ã€‚</p><p>â€‹ç„¶è€Œï¼Œæˆ‘å‘ç°ï¼šè‡ªå·±çš„å–å€¼å‡ºäº†ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œä¸‹é¢æ˜¯ä¸€æ¬¡äºŒåˆ†è¿‡åçš„è¿è¡Œç»“æœï¼š</p><img src="/2020/11/28/RSA-Notes2/1-01.png" alt="2" style="zoom:77%;"><p>â€‹åˆ†æäº†ä¸€ä¸‹ï¼ŒåŸå› å¾ˆç®€å•ï¼šå› ä¸ºè¿™ä¸ªæ—¶å€™é™¤æ•°æ˜¯$2^{739}$åˆ°$2^{740}$å·¦å³çš„æ•°é‡çº§ï¼Œè¢«é™¤æ•°æ˜¯$2^{2040}$æ•°é‡çº§ï¼Œç›¸å·®è¿‡å¤§ï¼Œäºæ˜¯æˆ‘é‡æ–°é€ æ•°æ®ï¼šæŠŠflagçš„æ•°é‡çº§é™ä½åˆ°$2^{400}$,äºŒåˆ†çš„$L,R$æ•°é‡çº§æå‡åˆ°$2^{1640}$</p><p>â€‹è¿™ä¸€æ¬¡çš„çš„è¿è¡Œç»“æœï¼Œå¾ˆå‡†ç¡®ï¼š</p><img src="/2020/11/28/RSA-Notes2/1-02.png" alt="2" style="zoom:77%;"><p>â€‹åšäº†å‡ æ¬¡å®éªŒï¼Œå‘ç°flagè§„æ¨¡åœ¨$2^{1000}$ä»¥ä¸‹çš„æ—¶å€™æ— è¯¯å·®ï¼Œ$2^{1050}$è§„æ¨¡çš„flagæœ‰ä¸è¶…è¿‡$10$çš„è¯¯å·®ï¼Œ$2^{1100}$è§„æ¨¡çš„flagæœ‰å‡ ç™¾çš„è¯¯å·®ï¼Œ$2^{1200}$çš„flagæœ‰å‡ åä¸‡çš„è¯¯å·®ï¼Œ$2^{1300}$çš„flagçš„è¯¯å·®æ¯”ç‰¹å·²ç»æ¥è¿‘æ€»æ¯”ç‰¹æ•°çš„ä¸€åŠã€‚ç›®æµ‹å¦‚æœflagåœ¨$\sqrt{n}$å†…çš„è¯ï¼Œå°±ä¸ä¼šå‡ºç°è¯¯å·®å€¼ã€‚</p><p>æœ€åè´´ä¸€ä¸‹æµ‹è¯•ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">GetNumberBitz</span>(<span class="hljs-params">x</span>):<br>    s=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        tmp=random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">255</span>)<br>        s=s*<span class="hljs-number">256</span>+tmp<br>        <span class="hljs-keyword">if</span>(s&gt;(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">5000</span>)):<br>           <span class="hljs-keyword">break</span><br>    s=s%(<span class="hljs-number">1</span>&lt;&lt;(x+<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">while</span>(s.bit_length()!=x):<br>        s=GetNumberBitz(x)<br>    <span class="hljs-keyword">return</span> s<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateKey</span>(<span class="hljs-params">B</span>):<br>    e,p,q=getPrime(random.randrange(<span class="hljs-number">16</span>,<span class="hljs-number">20</span>)),getPrime(B//<span class="hljs-number">2</span>),getPrime(B//<span class="hljs-number">2</span>)<br>    n,phi=p*q,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>    d=inverse(e,phi)<br>    <span class="hljs-keyword">return</span> e,n,d<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">judg</span>(<span class="hljs-params">CC,D,N</span>):<br>    x=<span class="hljs-built_in">pow</span>(CC,D,N)<br>    st=long_to_bytes(x,<span class="hljs-number">2048</span>//<span class="hljs-number">8</span>)<br>    <span class="hljs-keyword">if</span>(st.startswith(<span class="hljs-string">b&quot;\x00&quot;</span>)):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Attack</span>(<span class="hljs-params">E,N,C,D,B,T</span>):<br>    L,R=<span class="hljs-number">2</span>**(B),<span class="hljs-number">2</span>**(B+<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> R-L&gt;<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">if</span>(R-L).bit_length()%<span class="hljs-number">50</span>==<span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(L),<span class="hljs-built_in">hex</span>(R))<br>        M=(L+R)//<span class="hljs-number">2</span><br>        CC=(<span class="hljs-built_in">pow</span>(M,E,N)*C)%N<br>        check=judg(CC,D,N)<br>        <span class="hljs-keyword">if</span>(check==<span class="hljs-number">1</span>):<br>            L=M<br>        <span class="hljs-keyword">else</span>:<br>            R=M<br>    <span class="hljs-keyword">return</span> L<br><span class="hljs-comment">#----main below----#</span><br>flag=GetNumberBitz(<span class="hljs-number">400</span>)<br><span class="hljs-keyword">assert</span> flag.bit_length()==<span class="hljs-number">400</span><br>e,n,d=GenerateKey(<span class="hljs-number">2048</span>)<br><span class="hljs-keyword">while</span> n.bit_length()!=<span class="hljs-number">2048</span>:<br>      e,n,d=GenerateKey(<span class="hljs-number">2048</span>)<br>c=<span class="hljs-built_in">pow</span>(flag,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;e=&#x27;</span>,e)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n=&#x27;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c=&#x27;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;2**2040//flag=&#x27;</span>,<span class="hljs-built_in">hex</span>(<span class="hljs-number">2</span>**<span class="hljs-number">2040</span>//flag))<br>F=Attack(e,n,c,d,<span class="hljs-number">2040</span>-<span class="hljs-number">400</span>,<span class="hljs-number">2040</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-number">2</span>**<span class="hljs-number">2040</span>//F))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-number">2</span>**<span class="hljs-number">2040</span>//(F+<span class="hljs-number">1</span>)))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(flag))<br></code></pre></td></tr></table></figure><h3 id="0x03-æœ€åä¸€ä¸ªæ¯”ç‰¹ä½æ³„éœ²ç ´è§£çš„åŸç†-æ‘˜è‡ªCTFWIKIï¼Œæœ¬åºŸç‰©è¿˜ä¸æ‡‚"><a href="#0x03-æœ€åä¸€ä¸ªæ¯”ç‰¹ä½æ³„éœ²ç ´è§£çš„åŸç†-æ‘˜è‡ªCTFWIKIï¼Œæœ¬åºŸç‰©è¿˜ä¸æ‡‚" class="headerlink" title="0x03 æœ€åä¸€ä¸ªæ¯”ç‰¹ä½æ³„éœ²ç ´è§£çš„åŸç†(æ‘˜è‡ªCTFWIKIï¼Œæœ¬åºŸç‰©è¿˜ä¸æ‡‚)"></a>0x03 æœ€åä¸€ä¸ªæ¯”ç‰¹ä½æ³„éœ²ç ´è§£çš„åŸç†(æ‘˜è‡ªCTFWIKIï¼Œ<del>æœ¬åºŸç‰©è¿˜ä¸æ‡‚</del>)</h3><p>â€‹å‡è®¾ç›®å‰å­˜åœ¨ä¸€ä¸ª Oracleï¼Œå®ƒä¼šå¯¹ä¸€ä¸ªç»™å®šçš„å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œå¹¶ä¸”ä¼šç»™å‡ºæ˜æ–‡çš„æœ€åä¸€ä¸ªå­—èŠ‚ã€‚é‚£ä¹ˆç»™å®šä¸€ä¸ªåŠ å¯†åçš„å¯†æ–‡ï¼Œæˆ‘ä»¬åªéœ€è¦ $\log_{256}n$ æ¬¡å°±å¯ä»¥çŸ¥é“è¿™ä¸ªå¯†æ–‡å¯¹åº”çš„æ˜æ–‡æ¶ˆæ¯ã€‚</p><p>è¿™ä¸ªå…¶å®ç®—ä½œ RSA parity Oracle çš„æ‰©å±•ï¼Œæ—¢ç„¶å¯ä»¥æ³„éœ²å‡ºæœ€åä¸€ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆæŒ‰é“ç†æˆ‘ä»¬è·å–å¯†æ–‡å¯¹åº”æ˜æ–‡çš„æ¬¡æ•°åº”è¯¥å¯ä»¥å‡å°‘ã€‚</p><p>å‡è®¾$C&#x3D;P^e \bmod N$</p><p>ç¬¬ä¸€æ¬¡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æœåŠ¡å™¨å‘é€$C*256^e&#x3D;(256P)^e \bmod N$</p><p>æœåŠ¡å™¨ä¼šè®¡ç®—å¾—åˆ°$256P \bmod N$</p><p>è¿™é‡Œ</p><ul><li>$256P$ æ˜¯å¶æ•°ã€‚</li><li>$N$ æ˜¯å¥‡æ•°ï¼Œå› ä¸ºå®ƒæ˜¯ç”±ä¸¤ä¸ªå¤§ç´ æ•°ç›¸ä¹˜å¾—åˆ°ã€‚</li></ul><p>ç”±äº $P$ ä¸€èˆ¬æ˜¯å°äº$ N$ çš„ï¼Œé‚£ä¹ˆ$256P \bmod N&#x3D;256P-kn, k&lt;256$ã€‚è€Œä¸”å¯¹äºä¸¤ä¸ªä¸åŒçš„ $k_1,k_2$ï¼Œæˆ‘ä»¬æœ‰</p><p>$256P-k_1n \not\equiv 256P-k_2n \bmod 256$</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨åè¯æ³•æ¥è¯æ˜ä¸Šè¿°ä¸ç­‰å¼ã€‚åŒæ—¶ $256P-kn$ çš„æœ€åä¸€ä¸ªå­—èŠ‚å…¶å®å°±æ˜¯ $-kn$ åœ¨æ¨¡ $256$ çš„æƒ…å†µä¸‹è·å–çš„ã€‚é‚£ä¹ˆï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥é¦–å…ˆæšä¸¾å‡º $0$~$255 $æƒ…å†µä¸‹çš„æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œæ„é€ ä¸€ä¸ª k å’Œæœ€åä¸€ä¸ªå­—èŠ‚çš„æ˜ å°„è¡¨ map</p><p>å½“æœåŠ¡å™¨è¿”å›æœ€åä¸€ä¸ªå­—èŠ‚ bï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸Šè¿°æ„é€ çš„æ˜ å°„è¡¨å¾—çŸ¥ $k$ï¼Œå³å‡å»äº† $k$ ä¸ª$N$ï¼Œ å³ $kN \leq 256 P \leq (k+1)N$ã€‚</p><p>æ­¤åï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°å­¦å½’çº³æ³•æ¥è·å– P çš„èŒƒå›´ï¼Œå³å‡è®¾åœ¨ç¬¬ i æ¬¡æ—¶ï¼Œ$\dfrac{xN}{256^{i}} \leq P &lt; \dfrac{xN+N}{256^{i}}$</p><p>è¿›ä¸€æ­¥ï¼Œåœ¨ç¬¬ i+1 æ¬¡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€</p><p>$C*256^{(i+1)e}$</p><p>æœåŠ¡å™¨ä¼šè®¡ç®—å¾—åˆ°</p><p>$256^{i+1}P \bmod N&#x3D;256^{i+1}P-kN$</p><p>$0 \leq 256^{i+1}P-kN&lt;N$</p><p>$\dfrac{kN}{256^{i+1}} \leq P &lt; \dfrac{kN+N}{256^{i+1}}$</p><p>æ ¹æ®ç¬¬ $i$ æ¬¡çš„ç»“æœ</p><p>$\dfrac{256xN}{256^{i+1}} \leq P &lt; \dfrac{256xN+256N}{256^{i+1}}$</p><p>æˆ‘ä»¬è¿™é‡Œå¯ä»¥å‡è®¾ k&#x3D;256y+tï¼Œ è€Œè¿™é‡Œçš„ t å°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ˜ å°„è¡¨è·å–çš„ã€‚</p><p>$\dfrac{256yN+tN}{256^{i+1}} \leq P &lt; \dfrac{256yN+(t+1)N}{256^{i+1}}$</p><p>ä¸æ­¤åŒæ—¶ï¼Œç”±äº P å¿…ç„¶å­˜åœ¨ï¼Œæ‰€ä»¥ç¬¬ i+1 å¾—åˆ°çš„è¿™ä¸ªèŒƒå›´å’Œç¬¬ i æ¬¡å¾—åˆ°çš„èŒƒå›´å¿…ç„¶å­˜åœ¨äº¤é›†ã€‚</p><p>æ‰€ä»¥ y å¿…ç„¶ä¸ x ç›¸ç­‰ã€‚</p><p>è¿›ä¸€æ­¥æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå½’çº³ï¼Œåˆå§‹æƒ…å†µä¸‹</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">lb</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br><span class="hljs-attribute">ub</span> <span class="hljs-operator">=</span> N<br></code></pre></td></tr></table></figure><p>å‡è®¾æœåŠ¡å™¨è¿”å›äº† bï¼Œé‚£ä¹ˆ</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">k</span> = mab[b]<br><span class="hljs-attr">interval</span> = (ub-lb)//<span class="hljs-number">256</span><br><span class="hljs-attr">lb</span> = lb + interval * k<br><span class="hljs-attr">ub</span> = lb + interval<br></code></pre></td></tr></table></figure><h2 id="II-å…³äºä¸€äº›ç‰¹æ®Šæ€§è´¨çš„-n-çš„å› æ•°åˆ†è§£"><a href="#II-å…³äºä¸€äº›ç‰¹æ®Šæ€§è´¨çš„-n-çš„å› æ•°åˆ†è§£" class="headerlink" title="II-å…³äºä¸€äº›ç‰¹æ®Šæ€§è´¨çš„$n$çš„å› æ•°åˆ†è§£"></a>II-å…³äºä¸€äº›ç‰¹æ®Šæ€§è´¨çš„$n$çš„å› æ•°åˆ†è§£</h2><h3 id="0x01-n-çš„å€¼å°äº-512-ä½äºŒè¿›åˆ¶æ•°"><a href="#0x01-n-çš„å€¼å°äº-512-ä½äºŒè¿›åˆ¶æ•°" class="headerlink" title="0x01 $n$çš„å€¼å°äº$512$ä½äºŒè¿›åˆ¶æ•°"></a>0x01 $n$çš„å€¼å°äº$512$ä½äºŒè¿›åˆ¶æ•°</h3><p>â€‹å¯ä»¥ç”¨yafuæˆ–è€…sagemathç›´æ¥åˆ†è§£ï¼Œä¸€èˆ¬$30$åˆ†é’Ÿå†…å°±å¯ä»¥åˆ†è§£æˆåŠŸ</p><h3 id="0x02-p-q-æ˜¯ä¸¤ä¸ªç›¸é‚»çš„ç´ æ•°"><a href="#0x02-p-q-æ˜¯ä¸¤ä¸ªç›¸é‚»çš„ç´ æ•°" class="headerlink" title="0x02 $p,q$ æ˜¯ä¸¤ä¸ªç›¸é‚»çš„ç´ æ•°"></a>0x02 $p,q$ æ˜¯ä¸¤ä¸ªç›¸é‚»çš„ç´ æ•°</h3><p>â€‹è¿™ç§æ–¹æ³•æ˜¯éå¸¸ç®€å•çš„ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨gmpy2ä¸­çš„irootå‡½æ•°ç›´æ¥å–æ•´å¼€æ ¹ã€‚ç„¶åè®¾$q$æ˜¯$\sqrt n$çš„ä¸‹ä¸€ä¸ªç´ æ•°ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°$p$çš„å€¼äº†ï¼Œè¿›è€ŒæˆåŠŸåˆ†è§£$n$</p><h3 id="0x03-p-q-è¿‡å¤§æˆ–è€…è¿‡å°çš„åˆ†è§£"><a href="#0x03-p-q-è¿‡å¤§æˆ–è€…è¿‡å°çš„åˆ†è§£" class="headerlink" title="0x03 $|p-q|$è¿‡å¤§æˆ–è€…è¿‡å°çš„åˆ†è§£"></a>0x03 $|p-q|$è¿‡å¤§æˆ–è€…è¿‡å°çš„åˆ†è§£</h3><p>â€‹$|p-q|$è¿‡å¤§çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æšä¸¾æ³•ç¡®å®šå…¶ä¸­ä¸€ä¸ªå› æ•°</p><p>â€‹$|p-q|$è¿‡å°çš„æ—¶å€™ï¼šç”±åŸºæœ¬çš„å¹³æ–¹å·®å…¬å¼ï¼Œæœ‰:<br>$$<br>\dfrac{(p+q)^2}{4}-n&#x3D;\dfrac{(p+q)^2}{4}-pq&#x3D;\dfrac{(p-q)^2}{4}<br>$$<br>â€‹æ—¢ç„¶ $|p-q|$è¾ƒå°ï¼Œé‚£ä¹ˆ $\dfrac{(p-q)^2}{4}$ è‡ªç„¶ä¹Ÿæ¯”è¾ƒå°ï¼Œè¿›è€Œ $\dfrac{(p+q)^2}{4}$ åªæ˜¯æ¯” N ç¨å¾®å¤§ä¸€ç‚¹ï¼Œæ‰€ä»¥ $\dfrac{p+q}{2}$ ä¸ $\sqrt{n}$ ç›¸è¿‘ã€‚</p><p>â€‹æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ£€æŸ¥$\sqrt n$çš„æ¯ä¸€ä¸ªæ•´æ•°$x$ï¼ŒçŸ¥é“æ‰¾åˆ°ä¸€ä¸ª$x$ä½¿å¾—$x^2-n$æ˜¯å¹³æ–¹æ•°ï¼Œè®°ä½œ$y^2$ã€‚ç„¶åæ ¹æ®å¹³æ–¹å·®å…¬å¼å¯ä»¥åˆ†è§£$n$</p><h3 id="0x04-p-1-å…‰æ»‘-æ‘˜è‡ªyuligeçš„åšå®¢â€“NCTF2019é¢˜è§£"><a href="#0x04-p-1-å…‰æ»‘-æ‘˜è‡ªyuligeçš„åšå®¢â€“NCTF2019é¢˜è§£" class="headerlink" title="0x04 $p-1$å…‰æ»‘(æ‘˜è‡ªyuligeçš„åšå®¢â€“NCTF2019é¢˜è§£)"></a>0x04 $p-1$å…‰æ»‘(æ‘˜è‡ªyuligeçš„åšå®¢â€“NCTF2019é¢˜è§£)</h3><h4 id="0o401-ä»€ä¹ˆæ˜¯å…‰æ»‘æ•°"><a href="#0o401-ä»€ä¹ˆæ˜¯å…‰æ»‘æ•°" class="headerlink" title="0o401 ä»€ä¹ˆæ˜¯å…‰æ»‘æ•°"></a>0o401 ä»€ä¹ˆæ˜¯å…‰æ»‘æ•°</h4><p>â€‹é¦–å…ˆå¼•å…¥å…‰æ»‘æ•°çš„å®šä¹‰ï¼šè‹¥ä¸€ä¸ªæ•°çš„æ‰€æœ‰ç´ å› å­éƒ½ä¸è¶…è¿‡$B$ï¼Œé‚£ä¹ˆç§°è¿™ä¸ªæ•°ä¸º$B$å…‰æ»‘æ•°ï¼Œä¾‹å¦‚ï¼šç”±äº$72&#x3D;3^2Ã—2^3$ï¼Œæ‰€æœ‰çš„ç´ å› å­éƒ½ä¸è¶…è¿‡$3$ï¼Œæ‰€ä»¥$72$æ˜¯$3$å…‰æ»‘æ•°ï¼Œå½“ç„¶ä¹Ÿæ˜¯$5,7,11,â€¦$å…‰æ»‘æ•°ã€‚</p><h4 id="0o402-Pollards-p-1-ç®—æ³•"><a href="#0o402-Pollards-p-1-ç®—æ³•" class="headerlink" title="0o402 Pollards $p-1$ ç®—æ³•"></a>0o402 Pollards $p-1$ ç®—æ³•</h4><p>â€‹è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Pollardâ€™s $p âˆ’ 1$ ç®—æ³•æ¥åˆ†è§£ $n$ï¼Œå…·ä½“åŸç†å¦‚ä¸‹ï¼š</p><p>â€‹ç”±è´¹é©¬å°å®šç†$a^{p-1} â€“ 1 \equiv 0  \mod \ p$å¯çŸ¥ï¼Œ$a^{p-1} â€“ 1$ æ˜¯ $p$ çš„å€æ•°ï¼Œä¹Ÿå°±å¯ä»¥è®¤ä¸ºæ˜¯$a^{t(p-1)} â€“ 1 &#x3D;k p$ï¼Œå…¶ä¸­$t,p\in N_+$ã€‚å› æ­¤ï¼Œç®€å•åœ°è§‚å¯Ÿå°±å¯ä»¥çŸ¥é“ï¼Œå¦‚æœæŒ‡æ•°$\text{exp}$æ˜¯ $p-1$ çš„å€æ•°ï¼Œé‚£ä¹ˆ$a^\text{exp} â€“ 1 $å°±ä¼šæ˜¯ $p$ çš„å€æ•°ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸€ä¸ª$\text{exp}$ä½¿å¾—$a^\text{exp}$æ˜¯$p$çš„å€æ•°çš„æ—¶å€™ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¡ç®—$\gcd(a^{\text{exp}},n)$ï¼Œå°±å¯ä»¥å¾—åˆ°ç»“æœï¼Œè€Œè¿™ä¸ªç»“æœå°±æ˜¯$p$ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œçš„å…³é”®å°±æ˜¯å¯»æ‰¾è¿™ä¸ªåˆé€‚çš„$\text{exp}$å€¼ã€‚</p><p>â€‹<code>Pollard</code>çš„å‰å®³ä¹‹å¤„å°±åœ¨äºæ­¤ï¼Œä»–å‘ç°ï¼Œå¦‚æœ<code>p-1</code>æ­£å¥½æ˜¯ä¸€äº›å¾ˆå°çš„è´¨æ•°çš„ä¹˜ç§¯ï¼Œé‚£ä¹ˆ<code>p-1</code>å°±èƒ½æ•´é™¤$n!$ï¼Œå…¶ä¸­$n$æ˜¯ä¸€ä¸ªä¸å¤ªå¤§çš„æ•°ã€‚å‡è®¾<code>p-1</code>æ˜¯<code>p1, p2, ..., pk</code>è¿™äº›è´¨æ•°çš„ä¹˜ç§¯ï¼Œå…¶ä¸­æœ€å¤§çš„è´¨æ•°æ˜¯<code>pk</code>ã€‚é‚£ä¹ˆï¼Œå¾ˆæ˜¾ç„¶<code>pk!=1Â·2Â·...Â·pk</code>è‚¯å®šåŒ…æ‹¬äº†<code>p1, p2, ..., pk</code>è¿™äº›è´¨æ•°çš„ä¹˜ç§¯ï¼Œ<code>pk!</code>è‚¯å®šæ˜¯<code>p-1</code>çš„å€æ•°ã€‚</p><p>â€‹ä¹Ÿå°±æ˜¯è¯´ï¼Œ$n &gt; pk$ çš„æ—¶å€™ï¼Œ$n!$å¾ˆå¤§æ¦‚ç‡ä¸Šå°±èƒ½è¢«<code>p-1</code>æ•´é™¤ã€‚ï¼ˆè€ƒè™‘åˆ°<code>p1, p2, ..., pk</code>ä¸­å¯èƒ½æœ‰é‡å¤çš„æƒ…å†µï¼‰</p><p>â€‹è¿™å¯¼è‡´äº†<code>Pollard&#39; p-1 method</code>ï¼š</p><p>â€‹å¯¹äºæ¯ä¸€ä¸ª$n &#x3D; 2, 3, 4, â€¦$ï¼Œæˆ‘ä»¬ä»»æ„é€‰æ‹©ä¸€ä¸ªåº•æ•°$a$ï¼ˆäº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°é€‰æ‹©ä¸º$2$ï¼‰ï¼Œå¹¶è®¡ç®—<br>$$<br>gcd(a^{n!-1}, N)<br>$$<br>â€‹å¦‚æœç»“æœè½åœ¨1å’Œ$n$ä¸­é—´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æˆåŠŸäº†ã€‚</p><p>â€‹å½“ç„¶ï¼Œè¿™é‡Œçš„æ‰€æœ‰æ“ä½œéƒ½å¯ä»¥åœ¨æ¨¡$N$çš„æ“ä½œä¸‹è¿›è¡Œï¼Œä¹Ÿå°±æ˜¯è®¡ç®—$a^{n!-1}\ \text{mod}\ N$ã€‚å¹¶ä¸”ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¿…è®¡ç®—æ¯ä¸€ä¸ªæ•°å­—ï¼Œé€‰æ‹©ä¸€ä¸ªæ°å½“çš„é—´éš”ï¼ˆæ¯”å¦‚$15$ï¼‰è®¡ç®—å¯ä»¥å‡å°‘è€—æ—¶</p><h4 id="0o477-ä»£ç å®ç°"><a href="#0o477-ä»£ç å®ç°" class="headerlink" title="0o477 ä»£ç å®ç°"></a>0o477 ä»£ç å®ç°</h4><p>â€‹æˆ‘ä»¬å¯ä»¥ä¸Šä¸€ä¸‹ä»£ç ï¼šè¿™é‡Œçš„çš„$N$æ˜¯$104729$å…‰æ»‘çš„ï¼ˆå› ä¸º$104729$åˆšå¥½æ˜¯ç¬¬$10000$ä¸ªç´ æ•°ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Pollard_p_1</span>(<span class="hljs-params">N</span>):<br>    a = <span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        f = a<br>        <span class="hljs-comment"># precompute</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">80000</span>):<br>            f = <span class="hljs-built_in">pow</span>(f, i, N)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">80000</span>, <span class="hljs-number">104729</span>+<span class="hljs-number">1</span>):<br>            f = <span class="hljs-built_in">pow</span>(f, i, N)<br>            <span class="hljs-keyword">if</span> i % <span class="hljs-number">15</span> == <span class="hljs-number">0</span>:<br>                d = GCD(f-<span class="hljs-number">1</span>, N)<br>                <span class="hljs-keyword">if</span> <span class="hljs-number">1</span> &lt; d &lt; N:<br>                    <span class="hljs-keyword">return</span> d<br>        <span class="hljs-built_in">print</span>(a)<br>        a += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="0x05-p-1-å…‰æ»‘-å³-p-1-db-2-d"><a href="#0x05-p-1-å…‰æ»‘-å³-p-1-db-2-d" class="headerlink" title="0x05 $p+1$å…‰æ»‘(å³$p+1&#x3D;db^2|_{d&lt;256,\text{isPrime}(d)&#x3D;\text{True}}$)"></a>0x05 $p+1$å…‰æ»‘(å³$p+1&#x3D;db^2|_{d&lt;256,\text{isPrime}(d)&#x3D;\text{True}}$)</h3><p>â€‹è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨William $p+1$ç®—æ³•</p><h4 id="0o501-ç†è®ºåŸºç¡€"><a href="#0o501-ç†è®ºåŸºç¡€" class="headerlink" title="0o501 ç†è®ºåŸºç¡€"></a>0o501 ç†è®ºåŸºç¡€</h4><p>â€‹ä»æ ‡é¢˜ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šå¦‚æœ$p+1&#x3D;db^2$çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘åˆ†è§£$n$çš„å€¼ã€‚è€Œè¿™å®é™…ä¸ŠåŸºäºè¿™æ ·ä¸€ä¸ªç†è®ºåŸºç¡€ï¼šå¦‚æœ$n&#x3D;pm$ï¼Œå¹¶ä¸”$p$æ˜¯ç´ æ•°ï¼Œå¹¶ä¸”å¦‚æœ$4p$å¯ä»¥å†™æˆé›†åˆ{$ 3b^2+1,11b^2+1,19b^2+1,43b^2+1,67b^2+1,163b^2+1$} ï¼Œå…¶ä¸­${b\in N_+}$ ä¸­çš„ä»»æ„ä¸€ä¸ªå½¢å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨$\ln n$çš„å¤æ‚åº¦é‡Œæ‰¾åˆ°$p$çš„çœŸå®å€¼ã€‚</p><p>â€‹ç®—æ³•çš„åŸç†å¤ªå¤æ‚ï¼Œè¿™é‡Œå°±ä¸å¤šè®²äº†ï¼Œç›´æ¥çœ‹ä»£ç å§ï¼ˆ</p><h4 id="0o577-ç®—æ³•ä»£ç "><a href="#0o577-ç®—æ³•ä»£ç " class="headerlink" title="0o577 ç®—æ³•ä»£ç "></a>0o577 ç®—æ³•ä»£ç </h4><p>â€‹æœ€åè´´ä¸€ä¸‹ä»£ç ï¼Œ$\text{Sagemath 9.1 Notebook}$ä¸­çš„ä»£ç ï¼Œæ‘˜è‡ª$\text{NCTF 2020 WP}$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">qicheng</span>(<span class="hljs-params">n: <span class="hljs-built_in">int</span></span>):<br>    R = Integers(n)<br>    js = [<span class="hljs-number">0</span>, (-<span class="hljs-number">2</span> ^ <span class="hljs-number">5</span>) ^ <span class="hljs-number">3</span>, (-<span class="hljs-number">2</span> ^ <span class="hljs-number">5</span>*<span class="hljs-number">3</span>) ^ <span class="hljs-number">3</span>, (-<span class="hljs-number">2</span> ^ <span class="hljs-number">5</span>*<span class="hljs-number">3</span>*<span class="hljs-number">5</span>*<span class="hljs-number">11</span>) ^ <span class="hljs-number">3</span>, (-<span class="hljs-number">2</span> ^ <span class="hljs-number">6</span>*<span class="hljs-number">3</span>*<span class="hljs-number">5</span>*<span class="hljs-number">23</span>*<span class="hljs-number">29</span>) ^ <span class="hljs-number">3</span>]<br>    p, q = <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> js:<br>            <span class="hljs-keyword">if</span> j == <span class="hljs-number">0</span>:<br>                a = R.random_element()<br>                E = EllipticCurve([<span class="hljs-number">0</span>, a])<br>            <span class="hljs-keyword">else</span>:<br>                a = R(j)/(R(<span class="hljs-number">1728</span>)-R(j))<br>                c = R.random_element()<br>                E = EllipticCurve([<span class="hljs-number">3</span>*a*c ^ <span class="hljs-number">2</span>, <span class="hljs-number">2</span>*a*c ^ <span class="hljs-number">3</span>])<br>            x = R.random_element()<br>            z = E.division_polynomial(n, x)<br>            g = gcd(z, n)<br>            <span class="hljs-keyword">if</span> g &gt; <span class="hljs-number">1</span>:<br>                p = Integer(g)<br>                q = Integer(n)//p<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> p:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> (p, q)<br><span class="hljs-built_in">print</span>(qicheng(<span class="hljs-number">1444329727510154393553799612747635457542181563961160832013134005088873165794135221</span>))<br><span class="hljs-comment">#(74611921979343086722526424506387128972933, 19357894679486057806987068960980789709937)</span><br></code></pre></td></tr></table></figure><h3 id="0x06-Pollord-Rhoç®—æ³•-æ—¶é—´å¤æ‚åº¦-O-sqrt-4-n"><a href="#0x06-Pollord-Rhoç®—æ³•-æ—¶é—´å¤æ‚åº¦-O-sqrt-4-n" class="headerlink" title="0x06 Pollord Rhoç®—æ³•(æ—¶é—´å¤æ‚åº¦$O(\sqrt[4]{n})$)"></a>0x06 Pollord Rhoç®—æ³•(æ—¶é—´å¤æ‚åº¦$O(\sqrt[4]{n})$)</h3><h4 id="0o601-ç®—æ³•ä»‹ç»"><a href="#0o601-ç®—æ³•ä»‹ç»" class="headerlink" title="0o601 ç®—æ³•ä»‹ç»"></a>0o601 ç®—æ³•ä»‹ç»</h4><p>â€‹è¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯çŒœä¸€ä¸ªæ•°ï¼Œçœ‹çœ‹æ˜¯å¦ä¸º$x$çš„å› æ•°ã€‚</p><p>â€‹æˆ‘ä»¬å¯ä»¥éšæœºåœ°é€‰å–ä¸¤$v,t$ä¸ªæ•°ï¼Œç„¶åæ ¹æ®$v&#x3D;v_{i-1}^2+t \mod x$ ,è¿™æ ·å°±ä¼šæ„æˆä¸€ä¸ªç¯ã€‚ç„¶ååœ¨å¾ªç¯å†…éƒ¨çŒœæµ‹ã€‚å³å¯ã€‚</p><p>â€‹ä»£ç å®ç°åŸç†ä¹Ÿæ¯”è¾ƒå¤æ‚<del>ï¼ˆå®é™…ä¸Šæ˜¯å› ä¸ºæ‡’ï¼Œåšå®¢å†™åˆ°åé¢ä¹Ÿå¾ˆç´¯çš„ï¼‰</del>ï¼Œè‡ªå·±ç™¾åº¦å§ã€‚ä¸Šä¸€ä¸ªæ˜¯ç™¾åº¦ä¸åˆ°çš„ã€‚<del>23333</del></p><h4 id="0o677-ä»£ç å®ç°ï¼ˆè‡ªå·±æ‰“çš„ä»£ç ï¼ŒPythonå¸¸æ•°è¾ƒå¤§ï¼Œèƒ½è¿‡æ´›è°·æ¨¡æ¿é¢˜93åˆ†ï¼‰"><a href="#0o677-ä»£ç å®ç°ï¼ˆè‡ªå·±æ‰“çš„ä»£ç ï¼ŒPythonå¸¸æ•°è¾ƒå¤§ï¼Œèƒ½è¿‡æ´›è°·æ¨¡æ¿é¢˜93åˆ†ï¼‰" class="headerlink" title="0o677 ä»£ç å®ç°ï¼ˆè‡ªå·±æ‰“çš„ä»£ç ï¼ŒPythonå¸¸æ•°è¾ƒå¤§ï¼Œèƒ½è¿‡æ´›è°·æ¨¡æ¿é¢˜93åˆ†ï¼‰"></a>0o677 ä»£ç å®ç°ï¼ˆè‡ªå·±æ‰“çš„ä»£ç ï¼ŒPythonå¸¸æ•°è¾ƒå¤§ï¼Œèƒ½è¿‡æ´›è°·æ¨¡æ¿é¢˜93åˆ†ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>A=<span class="hljs-number">0</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">culc</span>(<span class="hljs-params">x,c,n</span>):<br>    <span class="hljs-keyword">return</span> (x*x+c)%n<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">PollardRho</span>(<span class="hljs-params">x</span>):<br>    s,t,goal,val=<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span><br>    c=getrandbits(<span class="hljs-number">15</span>)%(x-<span class="hljs-number">1</span>)+<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">for</span> det <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,goal+<span class="hljs-number">1</span>):<br>            t=culc(t,c,x)<br>            val=val*<span class="hljs-built_in">abs</span>(t-s)%x<br>            <span class="hljs-keyword">if</span>(det%<span class="hljs-number">127</span>==<span class="hljs-number">0</span>):<br>                d=GCD(val,x)<br>                <span class="hljs-keyword">if</span>(d&gt;<span class="hljs-number">1</span>):<br>                    <span class="hljs-keyword">return</span> d<br>        d=GCD(val,x)<br>        <span class="hljs-keyword">if</span>(d&gt;<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> d<br>        goal*=<span class="hljs-number">2</span><br>        s=t<br>        val=<span class="hljs-number">1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">factor</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">global</span> A<br>    <span class="hljs-keyword">if</span>(x&lt;=A <span class="hljs-keyword">or</span> x&lt;<span class="hljs-number">2</span>):<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span>(isPrime(x)):<br>        A=<span class="hljs-built_in">max</span>(A,x)<br>        <span class="hljs-keyword">return</span><br>    p=x<br>    <span class="hljs-keyword">while</span>(p&gt;=x):<br>        p=PollardRho(x)<br>    <span class="hljs-keyword">while</span>((x%p)==<span class="hljs-number">0</span>):<br>        x//=p<br>    factor(x)<br>    factor(p)<br>T=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br><span class="hljs-keyword">while</span> T&gt;<span class="hljs-number">0</span>:<br>    T-=<span class="hljs-number">1</span><br>    A=<span class="hljs-number">0</span><br>    a=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br>    <span class="hljs-keyword">if</span>(isPrime(a)):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Prime&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        factor(a)<br>        <span class="hljs-built_in">print</span>(A)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>UNCTFwp</title>
    <link href="/2020/11/13/UNCTFwp/"/>
    <url>/2020/11/13/UNCTFwp/</url>
    
    <content type="html"><![CDATA[<h1 id="UNCTF-WP"><a href="#UNCTF-WP" class="headerlink" title="UNCTF WP"></a>UNCTF WP</h1><h2 id="1-RSA1"><a href="#1-RSA1" class="headerlink" title="1.RSA1"></a>1.RSA1</h2><p>é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ä»£ç ï¼šï¼ˆæœ€åç»™å‡ºéƒ¨åˆ†ç•¥ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util <span class="hljs-keyword">import</span> number<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long<br><br>p = number.getPrime(<span class="hljs-number">1024</span>)<br>q = number.getPrime(<span class="hljs-number">1024</span>)<br><span class="hljs-keyword">if</span> p &gt; q:<br>    a = p + q<br>    b = p - q<br>    <span class="hljs-built_in">print</span>(a,b)<br><br>n = p * q<br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e,phi)<br>m = bytes_to_long(<span class="hljs-string">b&#x27;msg&#x27;</span>)<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(c)<br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†$a,b$çš„å€¼ï¼Œè¿˜æœ‰åŠ å¯†åå¯†æ–‡$c$çš„å€¼ï¼Œå¾ˆå®¹æ˜“åœ°æˆ‘ä»¬å¯ä»¥æ±‚å‡ºæ¥$p&#x3D;(a+b)&#x2F;2,q&#x3D;(a-b)&#x2F;2$.ç„¶åç›´æ¥ç”¨RSAçš„æœ€åŸºæœ¬çš„æ–¹æ³•è§£å†³å³å¯ï¼Œå¾ˆæ°´çš„ä¸€é“é¢˜ã€‚</p><h2 id="2-å¤§æ³•å®˜ä¹‹å¤±å»çš„è¥å…»æ€ä¹ˆè¡¥"><a href="#2-å¤§æ³•å®˜ä¹‹å¤±å»çš„è¥å…»æ€ä¹ˆè¡¥" class="headerlink" title="2.(å¤§æ³•å®˜ä¹‹å¤±å»çš„è¥å…»æ€ä¹ˆè¡¥)"></a>2.(å¤§æ³•å®˜ä¹‹å¤±å»çš„è¥å…»æ€ä¹ˆè¡¥)</h2><p>è¿™é“é¢˜ä¸€å¼€å§‹ç»™å‡ºäº†ä¸€ä¸ªé•¿ä¸º$100$çš„å­—ç¬¦ä¸²å¦‚ä¸‹ï¼š<code>ottttootoootooooottoootooottotootttootooottotttooootttototoottooootoooottotoottottooooooooottotootto</code>ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²é‡Œé¢åªæœ‰<code>o</code>å’Œ<code>t</code>ä¸¤ä¸ªå­—ç¬¦ï¼Œç›²çŒœ<code>o</code>æ˜¯oneï¼Œ<code>t</code>æ˜¯twoã€‚</p><p>ç„¶åè§‚å¯Ÿåˆ°å¯†æ–‡é•¿åº¦åˆšå¥½æ˜¯$100$ï¼Œç¬¦åˆæ¡ä»¶é•¿åº¦æ˜¯$5$çš„å€æ•°ï¼Œå¯ä»¥è€ƒè™‘åŸ¹æ ¹å¯†ç ã€‚æŠŠ<code>o</code>æ›¿æ¢æˆ<code>A</code>ï¼Œ<code>t</code>æ›¿æ¢æˆ<code>B</code>ã€‚ç„¶åéšä¾¿æ‰¾ä¸ªç½‘ç«™å°±å¯ä»¥è§£å‡ºé¢˜ç›®äº†ã€‚</p><h2 id="3-EZRSA"><a href="#3-EZRSA" class="headerlink" title="3. EZRSA"></a>3. EZRSA</h2><p>åˆæ˜¯ä¸€é“RSAçš„é¢˜ç›®ï¼Œé¢˜ç›®ç»™å‡ºäº†$e,n,c$æ•°å€¼ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°$\ln e â‰ˆ \ln n $ã€‚è‡ªç„¶ä¼šæƒ³åˆ°winnerattackçš„æ–¹æ³•ã€‚ï¼ˆä¹‹å‰Am473urå¸ˆå‚…å‡ºçš„é‚£é“é¢˜æ˜¯ç›´æ¥çˆ†ç ´$d$ï¼Œå¯èƒ½æ˜¯å› ä¸º$d$çš„å€¼å¤ªå°äº†å¯¼è‡´æˆ‘ä¸€é‡$for$å¾ªç¯ç›´æ¥æšä¸¾å‡ºæ¥ï¼Œæ²¡æœ‰å¯¹å…¶è¿›è¡Œæ·±åˆ»ç ”ç©¶233333ï¼‰ã€‚</p><p>ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šè§£é¢˜ä»£ç ï¼Œä¹Ÿå°±æ˜¯winnerattackçš„è„šæœ¬ã€‚åˆ°æ—¶å€™æˆ‘ä¼šæ›´æ–°ä¸€ä¸‹è‡ªå·±çš„RSAç¬”è®°ã€‚</p><p><del>è¿™ä¸ªè„šæœ¬æ˜¯åœ¨ç½‘ä¸Šæ‰¾åˆ°çš„ï¼Œä¸æ˜¯è‡ªå·±æ‰“çš„&#x3D; &#x3D;æ‰€ä»¥å¯ä»¥è¯æ˜æˆ‘çš„fwå±æ€§æˆç«‹</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">continued_fractions_expansion</span>(<span class="hljs-params">numerator,denominator</span>):<span class="hljs-comment">#(e,N)</span><br>result=[]<br> <br>divident = numerator % denominator<br>quotient = numerator // denominator<br>result.append(quotient)<br> <br><span class="hljs-keyword">while</span> divident != <span class="hljs-number">0</span>:<br>numerator = numerator - quotient * denominator<br> <br>tmp = denominator<br>denominator = numerator<br>numerator = tmp<br> <br>divident = numerator % denominator<br>quotient = numerator // denominator<br>result.append(quotient)<br> <br><span class="hljs-keyword">return</span> result<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convergents</span>(<span class="hljs-params">expansion</span>):<br>convergents=[(expansion[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(expansion)):<br>numerator = <span class="hljs-number">1</span><br>denominator = expansion[i]<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i - <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>numerator += expansion[j] * denominator<br><span class="hljs-keyword">if</span> j==<span class="hljs-number">0</span>:<br><span class="hljs-keyword">break</span><br>tmp = denominator<br>denominator = numerator<br>numerator = tmp<br>convergents.append((numerator, denominator)) <span class="hljs-comment">#(k,d)</span><br><span class="hljs-keyword">return</span> convergents<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">newtonSqrt</span>(<span class="hljs-params">n</span>):<br>approx = n // <span class="hljs-number">2</span><br>better = (approx + n // approx) // <span class="hljs-number">2</span><br><span class="hljs-keyword">while</span> better != approx:<br>    approx = better<br>    better = (approx + n // approx) // <span class="hljs-number">2</span><br><span class="hljs-keyword">return</span> approx<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wiener_attack</span>(<span class="hljs-params">cons, e, N</span>):<br><span class="hljs-keyword">for</span> cs <span class="hljs-keyword">in</span> cons:<br>k,d = cs<br><span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>:<br><span class="hljs-keyword">continue</span><br>phi_N = (e * d - <span class="hljs-number">1</span>) // k<br><span class="hljs-comment">#x**2 - ((N - phi_N) + 1) * x + N = 0</span><br>a = <span class="hljs-number">1</span><br>b = -((N - phi_N) + <span class="hljs-number">1</span>)<br>c = N<br>delta = b * b - <span class="hljs-number">4</span> * a * c<br><span class="hljs-keyword">if</span> delta &lt;= <span class="hljs-number">0</span>:<br><span class="hljs-keyword">continue</span><br>x1 = (newtonSqrt(delta) - b)//(<span class="hljs-number">2</span> * a)<br>x2 = -(newtonSqrt(delta) + b)//(<span class="hljs-number">2</span> * a)<br><span class="hljs-keyword">if</span> x1 * x2 == N:<br><span class="hljs-keyword">return</span> [x1, x2, k, d]<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    n = <span class="hljs-number">147282573611984580384965727976839351356009465616053475428039851794553880833177877211323318130843267847303264730088424552657129314295117614222630326581943132950689147833674506592824134135054877394753008169629583742916853056999371985307138775298080986801742942833212727949277517691311315098722536282119888605701</span><br>    e = <span class="hljs-number">18437613570247445737704630776150775735509244525633303532921813122997549954741828855898842356900537746647414676272022397989161180996467240795661928117273837666615415153571959258847829528131519423486261757569454011940318849589730152031528323576997801788206457548531802663834418381061551227544937412734776581781</span><br>    <br>    c = <span class="hljs-number">140896698267670480175739817539898638657099087197096836734243016824204113452987617610944986742919793506024892638851339015015706164412994514598564989374037762836439262224649359411190187875207060663509777017529293145434535056275850555331099130633232844054767057175076598741233988533181035871238444008366306956934</span><br>   <br>    expansion = continued_fractions_expansion(e, n)<br>    cons = convergents(expansion)<br>    p, q, k, d = wiener_attack(cons, e, n)<br>    m = <span class="hljs-built_in">pow</span>(c, d, n)<br>    <span class="hljs-built_in">print</span>(libnum.n2s(m))<br><br></code></pre></td></tr></table></figure><h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p>ä¸€é“æ²¡æœ‰ä»»ä½•æŠ€æœ¯å«é‡çš„é¢˜ç›®ï¼Œåªéœ€è¦æ‰“å¼€Wordæ–‡æ¡£ï¼ŒæŠŠå­—ä½“è°ƒæˆWingdings 2ã€‚ç„¶åçœ‹ç€å›¾ç‰‡ä¸€ä¸ªä¸€ä¸ªå¯¹ç…§å°±å¯ä»¥äº†ï¼ˆæœ€åè½¬æˆæ­£å¸¸çš„å­—ä½“ï¼ˆæ¯”å¦‚å®‹ä½“ï¼‰</p><h2 id="5-SignIn"><a href="#5-SignIn" class="headerlink" title="5 SignIn"></a>5 SignIn</h2><p>å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br><span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> hexlify<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>random.seed(urandom(<span class="hljs-number">32</span>))<br><br>key1 = <span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">13</span> + <span class="hljs-string">&#x27;&#x27;</span>.join([random.choice(printable) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)])<br>key2 = <span class="hljs-string">&#x27;&#x27;</span>.join([random.choice(printable) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]) + <span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">13</span><br><br>cipher1 = AES.new(key=key1.encode(), mode=AES.MODE_ECB)<br>cipher2 = AES.new(key=key2.encode(), mode=AES.MODE_ECB)<br><br>pt = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;You have a chance to get something: &quot;</span>)<br>pt = pt.encode()<br><br>val = <span class="hljs-built_in">len</span>(pt) % <span class="hljs-number">16</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> val == <span class="hljs-number">0</span>:<br>    pt += <span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span> - val)<br><br>c1 = cipher1.encrypt(pt)<br>c2 = cipher2.encrypt(c1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Your cipher:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(hexlify(c2)))<br><br><span class="hljs-keyword">assert</span>(<span class="hljs-built_in">len</span>(flag) % <span class="hljs-number">16</span> == <span class="hljs-number">0</span>)<br>c3 = cipher1.encrypt(flag)<br>c4 = cipher2.encrypt(c3)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Your flag:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(hexlify(c4)))<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">You have a chance to get something: UNCTF2020_Enjoy_Crypto~</span><br><span class="hljs-string">Your cipher:b&#x27;01a4e429e76db218fa0eb18f03ec69c9200a2362d8b4d7ea46170ce698389bbd&#x27;</span><br><span class="hljs-string">Your flag:b&#x27;196cc94c2d685beb54beeaa14c1dc0a6f3794d65fca0d1a1274515166e4255ab367383092e42d774992f74bc138faaad&#x27;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†ä¸€æ¬¡åŠ å¯†çš„ç»“æœã€‚ä»ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š$key1$çš„å‰$13$ä½å¯†é’¥å…¨æ˜¯$0$ï¼Œå$3$ä½æ˜¯æœªçŸ¥çš„ã€‚è€Œ$key2$çš„å‰$3$ä½æ˜¯æœªçŸ¥çš„,åé¢$13$ä½å…¨æ˜¯$0$ã€‚</p><p>ç¬¬ä¸€æ¬¡å¯¹ç»™å‡ºçš„å†…å®¹åŠ å¯†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬ä¸€æ¬¡åŠ å¯†çš„ç»“æœæ˜¯$c1$ï¼Œç¬¬äºŒæ¬¡åŠ å¯†çš„ç»“æœæ˜¯$c2$ã€‚å¹¶ä¸”$c2$æ˜¯å·²çŸ¥çš„ã€‚è€ƒè™‘åˆ°å­—ç¬¦åº“æ˜¯æœ‰é™çš„(åªæœ‰$100$ä¸ªå¯ç”¨å­—ç¬¦ï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æš´åŠ›æšä¸¾æ‰€æœ‰$100^3&#x3D;1000000$ç§$pt$çš„åŠ å¯†å¯èƒ½ï¼Œç„¶åæš´åŠ›æšä¸¾$1000000$ç§å¯¹$p2$è§£å¯†çš„å¯èƒ½æ€§,æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å°±é€šè¿‡ä¸¤é¢å¤¹å‡»çš„æ–¹å¼ï¼Œæšä¸¾åˆ°äº†ä¸¤ç§ä¸åŒé€”å¾„$c1$çš„å¯èƒ½ç»“æœã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¯»æ‰¾åˆ°ç›¸åŒçš„éƒ¨åˆ†ï¼Œå°±èƒ½å¾—åˆ°$c1$å­—ç¬¦ä¸²äº†ã€‚</p><p>æš´åŠ›æšä¸¾ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>pt=<span class="hljs-string">b&quot;UNCTF2020_Enjoy_Crypto~&quot;</span><br>val = <span class="hljs-built_in">len</span>(pt) % <span class="hljs-number">16</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> val == <span class="hljs-number">0</span>:<br>    pt += <span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span> - val)<br><span class="hljs-built_in">print</span>(pt)<br>s=printable<br>GivenChiper=<span class="hljs-string">&#x27;01a4e429e76db218fa0eb18f03ec69c9200a2362d8b4d7ea46170ce698389bbd&#x27;</span><br>GivenChiper=long_to_bytes(<span class="hljs-built_in">int</span>(GivenChiper,<span class="hljs-number">16</span>))<br>Key1=<span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">13</span><br>boxi=[]<br><span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> s:<br>    <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> s:<br>            Keyi=Key1+i1+i2+i3<br>            cipher1 = AES.new(key=Keyi.encode(), mode=AES.MODE_ECB)<br>            f=cipher1.encrypt(pt)<br>            boxi+=[f]<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;data1.out&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-comment">#for i in range(10):</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)**<span class="hljs-number">3</span>):<br>        <span class="hljs-keyword">if</span>(i%<span class="hljs-number">25000</span>==<span class="hljs-number">0</span>):<br>            <span class="hljs-built_in">print</span>(i)<br>        f.write(<span class="hljs-built_in">hex</span>(bytes_to_long(boxi[i]))[<span class="hljs-number">2</span>:]+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>Key2=<span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">13</span><br>boxi=[]<br><span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> s:<br>    <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> s:<br>            Keyii=i1+i2+i3+Key2<br>            cipher2 = AES.new(key=Keyii.encode(), mode=AES.MODE_ECB)<br>            f=cipher2.decrypt(GivenChiper)<br>            boxi+=[f]<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;data2.out&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)**<span class="hljs-number">3</span>):<br>        <span class="hljs-keyword">if</span>(i%<span class="hljs-number">25000</span>==<span class="hljs-number">0</span>):<br>            <span class="hljs-built_in">print</span>(i)<br>        f.write(<span class="hljs-built_in">hex</span>(bytes_to_long(boxi[i]))[<span class="hljs-number">2</span>:]+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±å‡ºæ¥äº†data1å’Œdata2ä¸¤ä¸ªæ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬ç”¨ä»¥ä¸‹çš„C++è„šæœ¬ï¼Œå¯ä»¥æ‰¾åˆ°å”¯ä¸€çš„å…±åŒè¾“å‡ºï¼ˆè¿™æ ·æˆ‘ä»¬å¯ä»¥ç”¨$O(2n)$çš„å¤æ‚åº¦ï¼Œè€Œä¸æ˜¯é­”é¬¼èˆ¬çš„$O(n^2)$ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>map&lt;string,<span class="hljs-type">bool</span>&gt;p;<br>string s;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;data2.out&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">1000000</span>;i++)<br>&#123;<br>cin&gt;&gt;s;<br>p[s]=<span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;data1.out&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">1000000</span>;i++)<br>&#123;<br>cin&gt;&gt;s;<br><span class="hljs-keyword">if</span>(p[s]==<span class="hljs-number">1</span>)<br>cout&lt;&lt;s&lt;&lt;endl;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å†ä¸€æ¬¡æš´åŠ›æšä¸¾ï¼Œæ‰¾å‡ºå…±åŒç‚¹æ—¶çš„å¯†é’¥$k1$å’Œ$k2$è¢«çœç•¥çš„$3$ä½æ•°ã€‚</p><p>æ‰¾åˆ°ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ä»¥ä¸‹è„šæœ¬ï¼Œè§£å‡ºflagäº†ï¼ˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br><span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> hexlify<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>key1 = <span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">13</span> +<span class="hljs-string">&#x27;W&lt;&amp;&#x27;</span><br>key2 = <span class="hljs-string">&#x27;0/i&#x27;</span> + <span class="hljs-string">&#x27;0&#x27;</span>*<span class="hljs-number">13</span><br>C=<span class="hljs-string">b&#x27;196cc94c2d685beb54beeaa14c1dc0a6f3794d65fca0d1a1274515166e4255ab367383092e42d774992f74bc138faaad&#x27;</span><br>C=long_to_bytes(<span class="hljs-built_in">int</span>(C,<span class="hljs-number">16</span>))<br><span class="hljs-built_in">print</span>(C)<br>cipher1 = AES.new(key=key1.encode(), mode=AES.MODE_ECB)<br>cipher2 = AES.new(key=key2.encode(), mode=AES.MODE_ECB)<br>D=cipher2.decrypt(C)<br>D=cipher1.decrypt(D)<br><span class="hljs-built_in">print</span>(D)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RSAinGF</title>
    <link href="/2020/11/08/RSAinGF/"/>
    <url>/2020/11/08/RSAinGF/</url>
    
    <content type="html"><![CDATA[<h1 id="GFåŸŸä¸Šçš„RSAå­¦ä¹ ç¬”è®°"><a href="#GFåŸŸä¸Šçš„RSAå­¦ä¹ ç¬”è®°" class="headerlink" title="GFåŸŸä¸Šçš„RSAå­¦ä¹ ç¬”è®°"></a>GFåŸŸä¸Šçš„RSAå­¦ä¹ ç¬”è®°</h1><h2 id="0x01-å­¦ä¹ èƒŒæ™¯"><a href="#0x01-å­¦ä¹ èƒŒæ™¯" class="headerlink" title="0x01 å­¦ä¹ èƒŒæ™¯"></a>0x01 å­¦ä¹ èƒŒæ™¯</h2><p>ä¹‹å‰æˆ‘ä»¬æåˆ°äº†RSAåœ¨æ•´æ•°è¿ç®—ä¸­çš„åŠ å¯†å’Œ è§£å¯†æ–¹å¼ï¼Œä»Šå¤©æˆ‘ä»¬æ¥è®¨è®ºè®¨è®ºRSAåœ¨$GF(2^m)$åŸŸä¸­çš„è®¡ç®—æ–¹æ³•å’Œè§£é¢˜æ¨¡å¼ã€‚ä¸ä»¥å‰çš„$RSA$ç•¥æœ‰ä¸åŒ</p><h2 id="0x02-GFåŸŸä¸­å¤šé¡¹å¼çš„è¿ç®—"><a href="#0x02-GFåŸŸä¸­å¤šé¡¹å¼çš„è¿ç®—" class="headerlink" title="0x02 GFåŸŸä¸­å¤šé¡¹å¼çš„è¿ç®—"></a>0x02 GFåŸŸä¸­å¤šé¡¹å¼çš„è¿ç®—</h2><h3 id="0o01GFåŸŸçš„æ¦‚å¿µ-ä¸ªäººæ€»ç»“çš„"><a href="#0o01GFåŸŸçš„æ¦‚å¿µ-ä¸ªäººæ€»ç»“çš„" class="headerlink" title="0o01GFåŸŸçš„æ¦‚å¿µ(ä¸ªäººæ€»ç»“çš„)"></a>0o01GFåŸŸçš„æ¦‚å¿µ(ä¸ªäººæ€»ç»“çš„)</h3><p>è®¾$p$ä¸ºè´¨æ•°ï¼Œé‚£ä¹ˆå½“ä¸”ä»…å½“$m&#x3D;p^k$æ—¶ï¼Œ$GF(m)$æ‰æœ‰æ„ä¹‰ã€‚ä¾‹å¦‚ï¼š$GF(11),GF(81),GF(256),GF(7^{20011230})$å‡ä¸ºæœ‰æ„ä¹‰çš„GFåŸŸã€‚ç„¶è€Œï¼Œ$GF(12)$ä¸æ˜¯æœ‰æ„ä¹‰çš„$GF$åŸŸï¼Œå› ä¸º$12&#x3D;2^2Ã—3$ï¼Œä¸èƒ½å†™æˆ$p^k$çš„å½¢å¼ ã€‚</p><h3 id="0o02-å¤šé¡¹å¼åœ¨-GF-p-k-åŸŸä¸­çš„å½¢å¼"><a href="#0o02-å¤šé¡¹å¼åœ¨-GF-p-k-åŸŸä¸­çš„å½¢å¼" class="headerlink" title="0o02 å¤šé¡¹å¼åœ¨$GF(p^k)$åŸŸä¸­çš„å½¢å¼"></a>0o02 å¤šé¡¹å¼åœ¨$GF(p^k)$åŸŸä¸­çš„å½¢å¼</h3><p>è®¾$f(x)$æ˜¯å…³äº$x$çš„ä¸€ä¸ªå¤šé¡¹å¼ã€‚é‚£ä¹ˆåœ¨$GF(P^k)$ä¸­ï¼Œ$f(x)$çš„æ¬¡æ•°ä¸º$k$ï¼Œå¹¶ä¸”$f(x)$çš„æ¯ä¸€é¡¹ç³»æ•°å‡å°äº$p$ï¼Œå› ä¸º$f(x)$éƒ½æ˜¯è¦å¯¹$p$å–æ¨¡çš„ã€‚</p><p>å¯¹å¤šé¡¹å¼å–æ•´æ•°æ¨¡çš„æ–¹æ³•å¾ˆç®€å•ï¼šæ¯ä¸€é¡¹ç³»æ•°å¯¹å–é‚£ä¸ªæ•´æ•°å–æ¨¡ï¼Œä¾‹å¦‚ï¼š$x^5+5x^4+10x^3+10x^2+5x+1 \equiv x^5+5x^4+x^3+x^2+5x+1 \mod 9$ï¼Œ$12x^3+15x^2-x+8\equiv 4x^3+7x^2+7x \mod 8$</p><p>ä¾‹å¦‚ï¼šåœ¨$GF(2^k)$åŸŸä¸­ã€‚è®¾$f(x)&#x3D;x+1$ï¼Œé‚£ä¹ˆ$f^2(x)&#x3D;x^2+2x+1\equiv x^2+1 \mod 2$ã€‚ </p><p>å½“ç„¶ï¼Œåœ¨$GF(p^k)$åŸŸä¸­ï¼Œ$Z_{p^k}$ä¸­çš„æ¯ä¸€ä¸ªæ•´æ•°éƒ½ä¸å¯¹åº”çš„å¤šé¡¹å¼ä¸€ä¸€å¯¹åº”ã€‚ä¾‹å¦‚ï¼šåœ¨$GF(2^8)$ä¸­ï¼Œ$1$åŒ–ä¸ºå¤šé¡¹å¼ä¸º$1$ï¼Œ$2$åŒ–ä¸ºå¤šé¡¹å¼ä¸º$x$ï¼Œ$3$åŒ–ä¸ºå¤šé¡¹å¼ä¸º$x+1$ï¼Œ$13$åŒ–ä¸ºå¤šé¡¹å¼ä¸º$x^3+x^2+1$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æŠŠå¯¹åº”çš„æ•°åŒ–ä¸º$2$è¿›åˆ¶ï¼Œç„¶åä»æœ€ä½ä½ä¸º$0$æ¬¡é¡¹ä¸€é¡¹ä¸€é¡¹åœ°ç¡®å®šé‚£ä¸€æ¬¡çš„ç³»æ•°ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨$GF(2^k)$åŸŸä¸­ï¼Œæœ‰$3^2&#x3D;5$ä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ï¼Œè¿™ä¹Ÿå°±è¯´æ˜ï¼šè™½ç„¶å¤šé¡¹å¼å¯ä»¥è¡¨ç¤ºä¸ºæ•´æ•°ï¼Œä½†æ˜¯å¤šé¡¹å¼çš„è¿ç®—ä¸æ•´æ•°è¿ç®—æ˜¯ä¸ä¸€æ ·çš„ï¼</p><h3 id="0o03-ä»€ä¹ˆå«åšä¸å¯çº¦å¤šé¡¹å¼"><a href="#0o03-ä»€ä¹ˆå«åšä¸å¯çº¦å¤šé¡¹å¼" class="headerlink" title="0o03 ä»€ä¹ˆå«åšä¸å¯çº¦å¤šé¡¹å¼"></a>0o03 ä»€ä¹ˆå«åšä¸å¯çº¦å¤šé¡¹å¼</h3><p>ä¸å¯çº¦å¤šé¡¹å¼å¯ä»¥ç†è§£ä¸ºè´¨æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šé™¤äº†$1$å’Œå®ƒæœ¬èº«ï¼Œä¸å¯ä»¥è¢«åˆ†è§£æˆå‡ ä¸ªå› æ•°ä¹‹ç§¯çš„å½¢å¼ã€‚ä¾‹å¦‚ï¼šåœ¨$GF(2^8)$ä¸­ï¼Œ$x^8+x^4+x^3+x+1$å°±æ˜¯ä¸€ä¸ªä¸å¯çº¦å¤šé¡¹å¼ï¼ˆæ³¨æ„ï¼šæœ€é«˜é¡¹ç³»æ•°ä¸€å®šé$0$å¹¶ä¸”æ¬¡æ•°æ°å¥½ä¸º$p^k$ä¸­$k$çš„å€¼ã€‚</p><p>å½“ç„¶ï¼Œåœ¨$GF(2^8)$ä¸­ï¼Œ$x^3+x^2+x+1$å°±ä¸æ˜¯ä¸€ä¸ªä¸å¯çº¦å¤šé¡¹å¼ï¼Œå› ä¸ºå®ƒå¯ä»¥åˆ†è§£å› å¼ä¸º$(x+1)^3$</p><h2 id="0x03-è§£é¢˜æ­¥éª¤"><a href="#0x03-è§£é¢˜æ­¥éª¤" class="headerlink" title="0x03 è§£é¢˜æ­¥éª¤"></a>0x03 è§£é¢˜æ­¥éª¤</h2><p>1.æ­¤ç±»é¢˜ç›®ä¸€èˆ¬ç»™å‡ºäº†$n(x),e$å’Œ$c$ã€‚ä¸è¿‡æˆ‘ä»¬å¾—åˆ°$c$çš„å€¼ä¹‹åè¦å°†å…¶åŒ–ä¸º$c(x)$çš„è¡¨è¾¾å¼ã€‚</p><p>2.ç„¶åï¼Œæˆ‘ä»¬å°è¯•åˆ†è§£$n(x)$ï¼Œè¿™ä¸€æ­¥åœ¨<strong>Sagemathçš„Notebook</strong>ä¸‹é¢å¾ˆå®¹æ˜“åšåˆ°ã€‚</p><p><img src="/2020/11/08/RSAinGF/2.png" alt="2"></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è¿™é‡Œåˆ†è§£åˆ°çš„æ˜¯ä¸¤ä¸ªä¸å¯çº¦å¤šé¡¹å¼$p(x)$å’Œ$q(x)$ï¼Œæ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸¤ä¸ªå¤šé¡¹å¼è€Œä¸æ˜¯æ•°å­—ã€‚æˆ‘ä»¬è¯¥å¦‚ä½•è®¡ç®—$\phi$å€¼å‘¢ï¼Ÿ</p><p>ä»¥å‰å½“$p,q$å‡ä¸ºè´¨æ•°çš„æ—¶å€™ï¼Œ$\phi(p)&#x3D;(p-1),\phi(q)&#x3D;(q-1) $ã€‚æˆ‘ä»¬å›å½’ä¸€ä¸‹$\phi(A)$çš„å®šä¹‰ï¼šåœ¨$Z_A$ä¸$A$äº’è´¨çš„æ•°å­—ä¸ªæ•°ã€‚æ‰€ä»¥ï¼Œåœ¨$GF(2^k)$ä¸­ï¼Œç”±äºé™¤äº†è¿™ä¸ªå¤šé¡¹å¼è‡ªå·±ä¹‹å¤–ï¼Œå…¶ä»–ä¸€å…±$2^{k}-1$ä¸ªå¤šé¡¹å¼éƒ½ä¸è¿™ä¸ªä¸qå¯çº¦å¤šé¡¹å¼äº’è´¨ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼Œç”±äº$p(x)$çš„æœ€é«˜æ¬¡é¡¹ä¸º$821$ï¼Œé‚£ä¹ˆ$\phi[p(x)]&#x3D;2^{821}-1$ã€‚åŒç†ï¼Œ$\phi[q(x)]&#x3D;2^{1227}-1$ï¼Œæ•…è¿™é‡Œçš„$\phi[n(x)]&#x3D;\phi[p(x)]\phi[q(x)]$</p><p>ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—$d$çš„å€¼ï¼Œè¿™é‡Œè´´ä¸€ä¸‹Sagemathä¸­çš„ä»£ç </p><p><img src="/2020/11/08/RSAinGF/3.png" alt="3"></p><p>åœ¨æ±‚å‡º$d$çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—$c^d(x) \mod n(x)$çš„å¤šé¡¹å¼$m(x)$</p><p><img src="/2020/11/08/RSAinGF/4.png" alt="4"></p><p>æŠŠè¿è¡Œç»“æœå¤åˆ¶åˆ°ä¸€ä¸ªTXTæ–‡æ¡£ä¸­(ä¾‹å¦‚1.txtæˆ–è€…1.in)ï¼Œç„¶ååŒ–æˆäºŒè¿›åˆ¶æ•°ï¼ˆC++è„šæœ¬å¾ˆå¥½æ‰“çš„ï¼Œä¸è¿‡æœ¬<del>fw</del>æ€•å¿˜æ‰æ€ä¹ˆæ‰“è¿™ä¸ªC++è„šæœ¬è¿˜æ˜¯æŠŠè„šæœ¬è´´äº†ä¸Šæ¥ï¼‰</p><p><strong>å¤šé¡¹å¼è½¬äºŒè¿›åˆ¶æ•°çš„è„šæœ¬(å¤šé¡¹å¼ä¸­åŠ å·ä¸æ¯ä¸€é¡¹ä¹‹é—´å­˜åœ¨ç©ºæ ¼ï¼Œæ‰€ä»¥ç›´æ¥åˆ¤æ–­é•¿åº¦æ˜¯å¦â‰¥$3$å³å¯)</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">bool</span> b[<span class="hljs-number">2048</span>]=&#123;<span class="hljs-number">1</span>&#125;;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">Trans</span><span class="hljs-params">(string s)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> A=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">2</span>;i&lt;s.<span class="hljs-built_in">length</span>();i++)<br>&#123;<br>A=A*<span class="hljs-number">10</span>+s[i]<span class="hljs-number">-48</span>; <br>&#125; <br><span class="hljs-keyword">return</span> A;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;2.in&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;2.out&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>,stdout);<br><span class="hljs-type">int</span> i,j;<br>string s;<br><span class="hljs-keyword">while</span>(cin&gt;&gt;s)<br>&#123;<br><span class="hljs-keyword">if</span>(s.<span class="hljs-built_in">length</span>()&gt;=<span class="hljs-number">3</span>)<br>b[<span class="hljs-built_in">Trans</span>(s)]=<span class="hljs-number">1</span>;<br>&#125; <br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">2047</span>;i&gt;=<span class="hljs-number">0</span>;i--)<br>&#123;<br>cout&lt;&lt;b[i];<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure><p><strong>äºŒè¿›åˆ¶æ•°è½¬å¤šé¡¹å¼çš„è„šæœ¬ï¼ˆæ³¨æ„åˆ å»æœ€åçš„åŠ å·ï¼‰</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>string s;<br><span class="hljs-type">bool</span> b[<span class="hljs-number">2090</span>]=&#123;<span class="hljs-number">1</span>&#125;;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;1.in&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;1.out&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>,stdout);<br><span class="hljs-type">char</span> c;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">2047</span>;i&gt;=<span class="hljs-number">0</span>;i--)<br>&#123;<br>cin&gt;&gt;c;<br><span class="hljs-keyword">if</span>(c==<span class="hljs-string">&#x27;1&#x27;</span>)<br>&#123;<br>cout&lt;&lt;<span class="hljs-string">&quot;x^&quot;</span>&lt;&lt;i&lt;&lt;<span class="hljs-string">&quot;+&quot;</span>;<br>&#125;<br>&#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>æœ€åï¼Œæˆ‘ä»¬æŠŠ$m(x)$åŒ–ä¸ºå®ƒæ‰€å¯¹åº”çš„æ•°å€¼ï¼Œç„¶åå°†å…¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆäº†</p><p><img src="/2020/11/08/RSAinGF/5.png" alt="5"></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NumberTheory2</title>
    <link href="/2020/11/04/NumberTheory2/"/>
    <url>/2020/11/04/NumberTheory2/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-å­¦ä¹ æ•°è®ºçš„ç¬”è®°2"><a href="#huangx607087-å­¦ä¹ æ•°è®ºçš„ç¬”è®°2" class="headerlink" title="huangx607087 å­¦ä¹ æ•°è®ºçš„ç¬”è®°2"></a>huangx607087 å­¦ä¹ æ•°è®ºçš„ç¬”è®°2</h1><h2 id="1-ç´ æ•°åŠå…¶è®¡æ•°-æ•°è®ºæ¦‚è®º-12-13-ç« "><a href="#1-ç´ æ•°åŠå…¶è®¡æ•°-æ•°è®ºæ¦‚è®º-12-13-ç« " class="headerlink" title="1.ç´ æ•°åŠå…¶è®¡æ•°(æ•°è®ºæ¦‚è®º$12,13$ç« )"></a>1.ç´ æ•°åŠå…¶è®¡æ•°(æ•°è®ºæ¦‚è®º$12,13$ç« )</h2><p><strong>å®šç†1.$2$æ˜¯å”¯ä¸€çš„å¶ç´ æ•°</strong></p><p><strong>å®šç†2.ç´ æ•°æœ‰æ— ç©·å¤šä¸ªï¼Œè‹¥$a,m$ä¸ºä»»æ„æ•´æ•°ï¼Œæ»¡è¶³$\gcd(a,m)&#x3D;1$,é‚£ä¹ˆæœ‰æ— ç©·å¤šä¸ªç´ æ•°$p$æ»¡è¶³$p\equiv a \mod m$.</strong></p><p><strong>å®šç†3.åŒºé—´$[x,2x]$å†…å¿…æœ‰ä¸€ä¸ªç´ æ•°</strong></p><p><strong>å®šç†4.è®¾$\pi(x)$ä¸ºä¸è¶…è¿‡$x$çš„ç´ æ•°ä¸ªæ•°ï¼Œé‚£ä¹ˆ$\pi(x)$æ¥è¿‘äº$\frac{x}{\ln x}$ï¼Œä¹Ÿå°±æ˜¯$\lim_{x \to +\infty} \frac{\pi(x) \ln(x)}{x}&#x3D;1$</strong></p><p>å“¥å¾·å·´èµ«çŒœæƒ³ï¼šæ¯ä¸€ä¸ªå¤§äºç­‰äº$4$çš„å¶æ•°éƒ½å¯ä»¥è¡¨ç¤ºä¸º$2$ä¸ªç´ æ•°ä¹‹å’Œã€‚</p><p>å­ªç”Ÿç´ æ•°ï¼š$p,p+2$å‡ä¸ºç´ æ•°ï¼Œé‚£ä¹ˆ$(p,p+2)$æ„æˆä¸€å¯¹å­ªç”Ÿç´ æ•°ï¼ŒçŒœæƒ³æœ‰æ— é™å¤šä¸ªè¿™æ ·çš„ç´ æ•°ç»„ã€‚</p><p>ç´ æ•°çŒœæƒ³3ï¼šå¯èƒ½å­˜åœ¨æ— ç©·å¤šä¸ª$n^2+1$ç±»å‹çš„ç´ æ•°</p><h2 id="2-æ¢…æ£®ç´ æ•°-å½¢å¦‚-2-p-1-çš„ç´ æ•°-æ•°è®ºæ¦‚è®º-14-15-ç« "><a href="#2-æ¢…æ£®ç´ æ•°-å½¢å¦‚-2-p-1-çš„ç´ æ•°-æ•°è®ºæ¦‚è®º-14-15-ç« " class="headerlink" title="2.æ¢…æ£®ç´ æ•°(å½¢å¦‚$2^p-1$çš„ç´ æ•°)(æ•°è®ºæ¦‚è®º$14,15$ç« )"></a>2.æ¢…æ£®ç´ æ•°(å½¢å¦‚$2^p-1$çš„ç´ æ•°)(æ•°è®ºæ¦‚è®º$14,15$ç« )</h2><p>è‹¥$a^n-1$æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆ$a&#x3D;2$</p><p><strong>æ€§è´¨1ï¼šè‹¥$n$è¢«$m$æ•´é™¤ï¼Œé‚£ä¹ˆ$2^n-1$è¢«$2^m-1$æ•´é™¤ã€‚</strong>æ‰€ä»¥æˆ‘ä»¬æœ‰æ¨è®ºï¼šè‹¥$2^p-1$æ˜¯ä¸ªç´ æ•°ï¼Œåˆ™$p$ä¸€å®šæ˜¯ä¸ªç´ æ•°ã€‚</p><p><strong>æ€§è´¨2ï¼šå¦‚æœ$2^p-1$æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆ$2^{p-1}(2^p-1)$æ˜¯ä¸ªå®Œå…¨æ•°ï¼ˆå®Œå…¨æ•°æ˜¯æŒ‡é™¤äº†å®ƒçš„æœ¬èº«ä¹‹å¤–ï¼Œè¿™ä¸ªæ•°çš„æ‰€æœ‰å› å­ä¹‹å’Œç­‰äºå®ƒæœ¬èº«ï¼Œæ¯”å¦‚$6,28$ï¼‰</strong></p><p><strong>æ€§è´¨3ï¼šæ‰€æœ‰å¤§äº$6$çš„å®Œå…¨æ•°åœ¨$6$è¿›åˆ¶ä¸­å‡ä»¥$44$ç»“å°¾</strong></p><p>è®¾$\sigma(x)$ä¸º$x$çš„æ‰€æœ‰å› å­ä¹‹å’Œï¼ˆåŒ…æ‹¬$1,x$ä¸¤ä¸ªæ•°ï¼‰ï¼Œä¾‹å¦‚ï¼š$\sigma(3)&#x3D;4,\sigma(15)&#x3D;24$</p><p><strong>æ€§è´¨4:è‹¥$\gcd(m,n)&#x3D;1$,åˆ™$\sigma(m)\sigma(n)&#x3D;\sigma(mn)$ã€‚</strong></p><p><strong>æ€§è´¨5:è‹¥$p$ä¸ºç´ æ•°ï¼Œåˆ™$\sigma(p^n)&#x3D;\sum_{i&#x3D;0}^{n}p^i$ã€‚ä¹Ÿå°±æ˜¯å¯¹äºä»»ä½•ç´ æ•°$p$ï¼Œå‡æœ‰$\sigma(p)&#x3D;p+1$ã€‚</strong></p><p>ä»¥ä¸‹ä¸ºæ±‚$\sigma(a^b)$ç»“æœçš„å8ä½åè¿›åˆ¶æ•°çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯$\sigma(a^b)$å¯¹ä¸€äº¿å–æ¨¡çš„å€¼ï¼Œå…¶ä¸­ç”¨åˆ°äº†äºŒåˆ†å¿«é€ŸåŠ ï¼Œå¯ä»¥æ¨å¯¼ä¸€ä¸‹ï¼ˆç­‰æ¯”æ•°åˆ—é‡Œåƒä¸‡ä¸ä¸è¦ç”¨é™¤æ³•ï¼ï¼ï¼ï¼ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,T,mod=<span class="hljs-number">100000000</span>;<br><span class="hljs-type">int</span> p[<span class="hljs-number">4000</span>],c[<span class="hljs-number">4000</span>],num;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dividing</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">2</span>;i*i&lt;=x;i++)<br>&#123;<br><span class="hljs-keyword">if</span>(x%i==<span class="hljs-number">0</span>)<br>&#123;<br>p[++num]=i;<br>c[num]=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span>(!(x%i)) x/=i,++c[num];<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span>(x&gt;<span class="hljs-number">1</span>) p[++num]=x,c[num]=<span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">pw</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(y==<span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">if</span>(y==<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> x;<br><span class="hljs-keyword">if</span>(x==<span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> S=<span class="hljs-built_in">pw</span>(x,y/<span class="hljs-number">2</span>)%mod;<br><span class="hljs-keyword">if</span>(y%<span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> S*S*x%mod;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> S*S%mod;<br>&#125; <br><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">ad</span><span class="hljs-params">(<span class="hljs-type">int</span> q,<span class="hljs-type">int</span> k)</span><span class="hljs-comment">//æ±‚ä»¥1ä¸ºé¦–é¡¹ï¼Œå…¬æ¯”ä¸ºqï¼Œæœ€é«˜é¡¹æ¬¡æ•°ä¸ºkçš„ç­‰æ¯”æ•°åˆ— ä¹‹å’Œ </span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(k==<span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">if</span>(k==<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> q<span class="hljs-number">+1</span>;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> S=<span class="hljs-built_in">ad</span>(q,(k<span class="hljs-number">-1</span>)/<span class="hljs-number">2</span>);<br><span class="hljs-keyword">if</span>(k%<span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> S+<span class="hljs-built_in">pw</span>(q,(k<span class="hljs-number">+1</span>)/<span class="hljs-number">2</span>)*S%mod;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> S+<span class="hljs-built_in">pw</span>(q,k/<span class="hljs-number">2</span>)*S+<span class="hljs-built_in">pw</span>(q,k)%mod;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;T);<br><span class="hljs-keyword">while</span>(T--)<br>&#123;<br><span class="hljs-type">int</span> a,b;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);<br><span class="hljs-built_in">dividing</span>(a);<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> S=<span class="hljs-number">1</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=num;i++)<br>&#123;<br>S*=<span class="hljs-built_in">ad</span>(p[i],c[i]);<br>S%=mod;<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>,S);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-äºŒåˆ†å¿«é€Ÿå¹‚-æ•°è®ºæ¦‚è®ºç¬¬-16-ç« "><a href="#3-äºŒåˆ†å¿«é€Ÿå¹‚-æ•°è®ºæ¦‚è®ºç¬¬-16-ç« " class="headerlink" title="3.äºŒåˆ†å¿«é€Ÿå¹‚ (æ•°è®ºæ¦‚è®ºç¬¬$16$ç« )"></a>3.äºŒåˆ†å¿«é€Ÿå¹‚ (æ•°è®ºæ¦‚è®ºç¬¬$16$ç« )</h2><p>äºŒåˆ†å¿«é€Ÿå¹‚çš„C++ä»£ç  (Pythonä¸­ç›´æ¥ç”¨<code>pow(x,y,z)</code>å‡½æ•°ï¼Œå¾ˆæ–¹ä¾¿)ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">pw</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(y==<span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">if</span>(y==<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> x;<br><span class="hljs-keyword">if</span>(x==<span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> S=<span class="hljs-built_in">pw</span>(x,y/<span class="hljs-number">2</span>)%mod;<br><span class="hljs-keyword">if</span>(y%<span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> S*S*x%mod;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> S*S%mod;<br>&#125; <br></code></pre></td></tr></table></figure><h2 id="4-è§£æ–¹ç¨‹-x-e-equiv-c-mod-n-æ•°è®ºæ¦‚è®ºç¬¬-17-ç« "><a href="#4-è§£æ–¹ç¨‹-x-e-equiv-c-mod-n-æ•°è®ºæ¦‚è®ºç¬¬-17-ç« " class="headerlink" title="4.è§£æ–¹ç¨‹$x^e \equiv c \mod n$ (æ•°è®ºæ¦‚è®ºç¬¬$17$ç« )"></a>4.è§£æ–¹ç¨‹$x^e \equiv c \mod n$ (æ•°è®ºæ¦‚è®ºç¬¬$17$ç« )</h2><p><strong>å‰ææ¡ä»¶ï¼š$\gcd(c,n)&#x3D;1$ä¸”$\gcd(e,\phi(m))&#x3D;1$ã€‚</strong></p><p>æ­¥éª¤ï¼š<br>1.è®¡ç®—$\phi(n)$<br>2.æ±‚$e$çš„é€†å…ƒ$d$<br>3.è®¡ç®—$x&#x3D;c^d \mod n$</p><p>ä¸¾ä¸ªä¾‹å­ï¼šæ±‚$x^7 \equiv 5 \mod 39$<br>1.è®¡ç®—$\phi(39)&#x3D;24$<br>2.$e&#x3D;7$åœ¨æ¨¡$24$çš„æ„ä¹‰ä¸‹ä¹˜æ³•é€†å…ƒä¸º$d&#x3D;7$<br>3.$x&#x3D;c^d&#x3D;5^7&#x3D;78125 \equiv 8 \mod 39$</p><p>è¿™æ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿ <strong>RSAè§£å¯† RSAè§£å¯† RSAè§£å¯†</strong>ï¼ï¼ å¯†ç å­¦çš„çŸ¥è¯†æˆåŠŸåœ°è·Ÿæ•°è®ºè”ç³»èµ·æ¥äº†<del>ï¼ˆå¥‡æ€ªçš„çŸ¥è¯†å¢åŠ äº†ï¼‰23333333</del></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NumberTheory1</title>
    <link href="/2020/11/02/NumberTheory1/"/>
    <url>/2020/11/02/NumberTheory1/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087-å­¦ä¹ æ•°è®ºçš„ç¬”è®°1"><a href="#huangx607087-å­¦ä¹ æ•°è®ºçš„ç¬”è®°1" class="headerlink" title="huangx607087 å­¦ä¹ æ•°è®ºçš„ç¬”è®°1"></a>huangx607087 å­¦ä¹ æ•°è®ºçš„ç¬”è®°1</h1><h2 id="1-å‹¾è‚¡å®šç†åŠè´¹é©¬å¤§å®šç†ï¼ˆæ•°è®ºæ¦‚è®º-2-3-4-ç« ï¼‰"><a href="#1-å‹¾è‚¡å®šç†åŠè´¹é©¬å¤§å®šç†ï¼ˆæ•°è®ºæ¦‚è®º-2-3-4-ç« ï¼‰" class="headerlink" title="1.å‹¾è‚¡å®šç†åŠè´¹é©¬å¤§å®šç†ï¼ˆæ•°è®ºæ¦‚è®º$2,3,4$ç« ï¼‰"></a>1.å‹¾è‚¡å®šç†åŠè´¹é©¬å¤§å®šç†ï¼ˆæ•°è®ºæ¦‚è®º$2,3,4$ç« ï¼‰</h2><p><strong>è¡¨è¾¾å¼ï¼š</strong>$a^2+b^2&#x3D;c^2$</p><p><strong>æœ¬æºå‹¾è‚¡æ•°ç»„ï¼š</strong>æ»¡è¶³$\gcd(a,b,c)&#x3D;1$</p><p><strong>ç”Ÿæˆæœ¬æºå‹¾è‚¡æ•°ç»„ï¼š</strong> $a&#x3D;st,b&#x3D;\frac{s^2-t^2}{2},c&#x3D;\frac{s^2+t^2}{2}$ã€‚å…¶ä¸­$s&gt;tâ‰¥1$ä¸”$s,t$å‡ä¸ºå¥‡æ•°ä¸”$\gcd(s,t)&#x3D;1$</p><p><strong>æœ¬æºå‹¾è‚¡æ•°ç»„çš„æ€§è´¨ï¼š</strong> $a,b$ä¸€å®šæ˜¯ä¸€ä¸ªå¥‡æ•°ä¸€ä¸ªå¶æ•°ï¼Œ$a,b$ä¸­ä¸€å®šæœ‰ä¸€ä¸ªæ˜¯$3$çš„å€æ•°ï¼Œ$a,b,c$ä¸­ä¸€å®šæœ‰ä¸€ä¸ªæ˜¯$5$çš„å€æ•°</p><p><strong>è´¹é©¬å¤§å®šç†</strong>ï¼š**$nâ‰¥3$æ—¶ï¼Œæ–¹ç¨‹$a^n+b^n&#x3D;c^n$æ— æ­£æ•´æ•°è§£ã€‚**</p><h2 id="2-æœ€å¤§å…¬çº¦æ•°-gcd-çš„ç›¸å…³æ€§è´¨-æ•°è®ºæ¦‚è®º-5-6-ç« "><a href="#2-æœ€å¤§å…¬çº¦æ•°-gcd-çš„ç›¸å…³æ€§è´¨-æ•°è®ºæ¦‚è®º-5-6-ç« " class="headerlink" title="2.æœ€å¤§å…¬çº¦æ•°$\gcd$çš„ç›¸å…³æ€§è´¨(æ•°è®ºæ¦‚è®º$5,6$ç« )"></a>2.æœ€å¤§å…¬çº¦æ•°$\gcd$çš„ç›¸å…³æ€§è´¨(æ•°è®ºæ¦‚è®º$5,6$ç« )</h2><p><strong>äº’è´¨:</strong>$\gcd(a,b)&#x3D;1$</p><p><strong>æ±‚ $\gcd$ çš„æ–¹æ³•ï¼šæ¬§å‡ é‡Œå¾—è¾—è½¬ç›¸é™¤</strong>ï¼Œæ—¶é—´å¤æ‚åº¦ï¼š$O(\ln b)$</p><p><strong>C++ä»£ç </strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">gcd</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(y==<span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> x;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-built_in">gcd</span>(y,x%y);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>çº¿æ€§æ–¹ç¨‹ï¼š</strong> $ax+by&#x3D;\gcd(a,b)$</p><p>æ±‚è§£$x,y$çš„C++ä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">exgcd</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> a,<span class="hljs-type">long</span> <span class="hljs-type">long</span> b,<span class="hljs-type">long</span> <span class="hljs-type">long</span> &amp;x,<span class="hljs-type">long</span> <span class="hljs-type">long</span> &amp;y)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(!b)<br>&#123;<br>x=<span class="hljs-number">1</span>;<br>y=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">return</span> a;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> R=<span class="hljs-built_in">exgcd</span>(b,a%b,y,x);<br>y-=x*(a/b);<br><span class="hljs-keyword">return</span> R;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>é€†å…ƒä»£ç ï¼š</strong>(Pythonç›´æ¥ç”¨å‘½ä»¤<code>inverse(a,p)</code>)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">modinverse</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> a,<span class="hljs-type">long</span> <span class="hljs-type">long</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> x0,y0;<br><span class="hljs-built_in">exgcd</span>(a,p,x0,y0);<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> A=(x0<span class="hljs-number">+750</span>*p)%p;<br><span class="hljs-keyword">return</span> A;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-ä½™æ•°ä¸æ•´é™¤-æ•°è®ºæ¦‚è®º-7-8-9-10-11-ç« "><a href="#3-ä½™æ•°ä¸æ•´é™¤-æ•°è®ºæ¦‚è®º-7-8-9-10-11-ç« " class="headerlink" title="3.ä½™æ•°ä¸æ•´é™¤(æ•°è®ºæ¦‚è®º$7,8,9,10,11$ç« )"></a>3.ä½™æ•°ä¸æ•´é™¤(æ•°è®ºæ¦‚è®º$7,8,9,10,11$ç« )</h2><p>1.è¡¨ç¤ºæ–¹æ³•ï¼šå¦‚æœ$m$ æ•´é™¤$a-b$ï¼Œå¯ä»¥è®°ä½œï¼š$a \equiv b \mod m$ã€‚ä¾‹å¦‚ï¼š$7+6 \equiv 3 \mod 10$ </p><p><strong>æ€§è´¨1.è‹¥$a\equiv A \mod m,b\equiv B\mod  m$ï¼šæœ‰ï¼š$a+b \equiv A+B \mod m,ab \equiv AB \mod m$.</strong></p><p>è®¾å…³äº$x$çš„åŒä½™æ–¹ç¨‹ï¼š$ax \equiv c \mod m$ï¼Œæ±‚$x$?</p><p><strong>æ€§è´¨2.è®¾$g&#x3D;\gcd(a,m)$,è‹¥$c\equiv 0 \mod g$ é‚£ä¹ˆè¿™ä¸ªæ–¹ç¨‹æœ‰$g$ä¸ªè§£ã€‚æˆ‘ä»¬å¯ä»¥æ±‚$au+mv&#x3D;g$è¿™ä¸ªæ–¹ç¨‹çš„è§£ã€‚ç„¶åè®¡ç®—$x_0&#x3D;\frac {cu}{g}$è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ±‚å‡º$x_0$ã€‚ç„¶åæˆ‘ä»¬è®¾$\delta &#x3D;\frac{m}{g}$ï¼ˆæ˜¾ç„¶$\delta$æ˜¯æ•´æ•°ï¼‰é‚£ä¹ˆ$x_1&#x3D;x+\delta,x_n&#x3D;x_{n-1}+\delta$,$n&#x3D;1,2,3,..,g-1$.</strong></p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p>å‡å¦‚æˆ‘ä»¬è¦æ±‚æ–¹ç¨‹$4x \equiv 6 \mod 18$çš„å€¼ï¼Œæˆ‘ä»¬è®¡ç®—ï¼š$g&#x3D;\gcd(4,18)&#x3D;2$ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹ç¨‹æœ‰$2$ä¸ªè§£ã€‚$\delta&#x3D;\frac{18}{2}&#x3D;9$ã€‚æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºï¼š$u&#x3D;-4\equiv 14 \mod 18$ã€‚é‚£ä¹ˆ$x_0&#x3D;\frac {6Ã—14}{2} \equiv 6 \mod 18$ã€‚é‚£ä¹ˆ$x_1&#x3D;x_0+\delta&#x3D;6+9&#x3D;15$ã€‚æ‰€ä»¥è¿™ä¸ªæ–¹ç¨‹æœ‰ä¸¤è§£$6$å’Œ$15$</p><p>è‹¥æ¨å¹¿åˆ°é«˜æ¬¡æ–¹ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$f(x)&#x3D;\sum_{i&#x3D;0}^{n} a_ix^i \equiv 0 \mod p$ è‡³å¤šæœ‰$n$ä¸ªåœ¨$Z_p$å†…çš„è§£ã€‚</p><p><strong>æ€§è´¨3.è´¹é©¬å°å®šç†ï¼š$a^{p-1} \equiv 1 \mod p $ å…¶ä¸­$a \not\equiv 0 \mod p$.</strong></p><p>åˆ©ç”¨è¿™ä¸ªå®šç†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨$\ln p$çº§åˆ«çš„æ—¶é—´å¤æ‚åº¦å†…åˆ¤æ–­$p$æ˜¯ä¸æ˜¯ç´ æ•°ã€‚ä¾‹å¦‚ï¼šç”±äº$2^{1234566} \equiv 899557 \mod 1234567$ã€‚æ‰€ä»¥$1234567$ä¸æ˜¯ç´ æ•°ã€‚è€Œ$535776^{998244352}\equiv 1 \mod 998244353$ æ‰€ä»¥$998244353$æ˜¯ç´ æ•°ã€‚</p><p>æ³¨æ„ï¼šè¿™ä¸ªæ–¹æ³•å®é™…ä¸Šæ˜¯æœ‰åä¾‹çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ$a^{p-1} \equiv 1 \mod p $ æ˜¯â€œ$p$æ˜¯ç´ æ•°â€çš„ <strong>å¿…è¦ä¸å……åˆ†æ¡ä»¶ã€‚</strong>æœ€å°çš„ä¸€ä¸ªåä¾‹æ˜¯$561$ .è¿™ä¸ªç»“è®ºå°†åœ¨ç¬”è®°$3$ä¸­æåˆ°ã€‚</p><p><strong>æ€§è´¨4.æ¨å¹¿è´¹é©¬å°å®šç†: $a^{\phi(m)} \equiv 1 \mod m$å…¶ä¸­$m \not\equiv 0 \mod a$.</strong></p><p>$\phi(x)$è¡¨ç¤ºåœ¨å°äº$x$çš„æ•°ä¸­ä¸$x$äº’è´¨çš„æ•°ä¸ªæ•°ã€‚å…¶ä¸­ï¼šå¯¹äºè´¨æ•°$p$æœ‰$\phi(p)&#x3D;p-1$,$\phi(p^k) &#x3D; p^k-p^{k-1}$ã€‚å¯¹äºä»»ä½•æ•°å­—æœ‰$\phi(ab)&#x3D;\phi(a)\phi(b)$</p><p><strong>æ€§è´¨5.ä¸­å›½å‰©ä½™å®šç†ã€‚è§<a href="https://huangx607087.github.io/2020/10/16/0xGameDiv2/">0xGame  Div 2 çš„ç¬¬ä¸€é¢˜wp</a>.</strong></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ACM Code 1</title>
    <link href="/2020/10/30/ACMCode1/"/>
    <url>/2020/10/30/ACMCode1/</url>
    
    <content type="html"><![CDATA[<h1 id="ACM-Code-1"><a href="#ACM-Code-1" class="headerlink" title="ACM Code 1"></a>ACM Code 1</h1><h3 id="1-SPFA"><a href="#1-SPFA" class="headerlink" title="1.SPFA"></a>1.SPFA</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,s;<br><span class="hljs-type">int</span> e[<span class="hljs-number">900000</span>],w[<span class="hljs-number">900000</span>],head[<span class="hljs-number">900000</span>],next[<span class="hljs-number">900000</span>],k=<span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> q[<span class="hljs-number">3350000</span>],d[<span class="hljs-number">900000</span>];<br><span class="hljs-type">bool</span> v[<span class="hljs-number">900000</span>];<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-built_in">memset</span>(d,<span class="hljs-number">19</span>,<span class="hljs-built_in">sizeof</span>(d));<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;s);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=m;i++)<br>&#123;<br><span class="hljs-type">int</span> x,y,z;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;x,&amp;y,&amp;z);<br>e[++k]=y;w[k]=z;next[k]=head[x];head[x]=k;<br>e[++k]=x;w[k]=z;next[k]=head[y];head[y]=k;<br>&#125;<br>d[s]=<span class="hljs-number">0</span>;<br>q[<span class="hljs-number">1</span>]=s;<br><span class="hljs-type">int</span> f=<span class="hljs-number">1</span>,r=<span class="hljs-number">1</span>;<br><span class="hljs-keyword">while</span>(f&lt;=r)<br>&#123;<br><span class="hljs-type">int</span> x=q[f++];<br>k=head[x];<br><span class="hljs-keyword">while</span>(k!=<span class="hljs-number">0</span>)<br>&#123;<br><span class="hljs-keyword">if</span>(d[x]+w[k]&lt;d[e[k]])<br>&#123;<br>d[e[k]]=d[x]+w[k];<br><span class="hljs-keyword">if</span>(!v[e[k]])<br>&#123;<br>q[++r]=e[k];<br>v[e[k]]=<span class="hljs-literal">true</span>;<br>&#125;<br>&#125;<br>k=next[k];<br>&#125;<br>v[x]=<span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,d[i]);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-Dijkstra-Heap"><a href="#2-Dijkstra-Heap" class="headerlink" title="2.Dijkstra+Heap"></a>2.Dijkstra+Heap</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,s;<br><span class="hljs-type">int</span> e[<span class="hljs-number">1750000</span>],w[<span class="hljs-number">1750000</span>],head[<span class="hljs-number">950000</span>],next[<span class="hljs-number">1750000</span>];<br><span class="hljs-type">int</span> d[<span class="hljs-number">950000</span>];<br><span class="hljs-type">bool</span> v[<span class="hljs-number">950000</span>];<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">zxcv</span>&#123;<span class="hljs-type">int</span> first, second;<br>&#125;;<br><span class="hljs-type">bool</span> <span class="hljs-keyword">operator</span> &lt; ( <span class="hljs-type">const</span> zxcv &amp;a, <span class="hljs-type">const</span> zxcv &amp;b)<br>&#123;<br>    <span class="hljs-keyword">return</span> a.first&gt;b.first;<br>&#125;<br>priority_queue&lt;zxcv&gt; h;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">D</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">while</span>(h.<span class="hljs-built_in">empty</span>()==<span class="hljs-number">0</span>)<br>    &#123;<br>        zxcv now=h.<span class="hljs-built_in">top</span>();<br>        h.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-type">int</span> dii=now.first,x=now.second;<br>        <span class="hljs-keyword">if</span>(!v[x])<br>        &#123;<br>            v[x]=<span class="hljs-number">1</span>;<br>            <span class="hljs-type">int</span> k=head[x];<br>            <span class="hljs-keyword">while</span>(k)<br>            &#123;<br>                <span class="hljs-keyword">if</span>(w[k]+d[x]&lt;d[e[k]])<br>                &#123;<br>                    d[e[k]]=d[x]+w[k];<br>                    <span class="hljs-keyword">if</span>(!v[e[k]])<br>                    &#123;<br>                        zxcv midd;<br>                        midd.first=d[e[k]];<br>                        midd.second=e[k];<br>                        h.<span class="hljs-built_in">push</span>(midd);<br>                    &#125;<br>                &#125;<br>                k=next[k];<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i,j,k=<span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">memset</span>(d,<span class="hljs-number">40</span>,<span class="hljs-built_in">sizeof</span>(d));<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;s);<br>    d[s]=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=m;i++)<br>    &#123;<br>        <span class="hljs-type">int</span> x,y,z;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;x,&amp;y,&amp;z);<br>        e[++k]=y; w[k]=z; next[k]=head[x]; head[x]=k;<br>    &#125;<br>    zxcv tmp;<br>    tmp.first=<span class="hljs-number">0</span>;<br>    tmp.second=s;<br>    h.<span class="hljs-built_in">push</span>(tmp);<br>    <span class="hljs-built_in">D</span>();<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,d[i]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-æ ‘çŠ¶æ•°ç»„"><a href="#3-æ ‘çŠ¶æ•°ç»„" class="headerlink" title="3.æ ‘çŠ¶æ•°ç»„"></a>3.æ ‘çŠ¶æ•°ç»„</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,T;<br><span class="hljs-type">int</span> tri[<span class="hljs-number">607087</span>];<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">lowbit</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> x&amp;(-x);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addedge</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">while</span>(x&lt;=n)<br>    &#123;<br>        tri[x]+=y;<br>        x+=<span class="hljs-built_in">lowbit</span>(x);<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">S</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> A=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(x)<br>    &#123;<br>        A+=tri[x];<br>        x-=<span class="hljs-built_in">lowbit</span>(x);<br>    &#125;<br>    <span class="hljs-keyword">return</span> A;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">work</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y,<span class="hljs-type">bool</span> h)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(h) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-built_in">S</span>(y)-<span class="hljs-built_in">S</span>(x<span class="hljs-number">-1</span>));<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">addedge</span>(x,y);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i,j;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;T);<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br>    &#123;<br>        <span class="hljs-type">int</span> a=i,b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;b);<br>        <span class="hljs-built_in">addedge</span>(a,b);<br>    &#125;<br>    <span class="hljs-keyword">while</span>(T--)<br>    &#123;<br>        <span class="hljs-type">int</span> t,a,b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;t,&amp;a,&amp;b);<br>        <span class="hljs-built_in">work</span>(a,b,t<span class="hljs-number">-1</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4-çº¿æ®µæ ‘"><a href="#4-çº¿æ®µæ ‘" class="headerlink" title="4.çº¿æ®µæ ‘"></a>4.çº¿æ®µæ ‘</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> lc(x) x*2</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> rc(x) x*2+1</span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,T;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> tri[<span class="hljs-number">607087</span>],lazy[<span class="hljs-number">607087</span>];<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addedge</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b,<span class="hljs-type">int</span> l,<span class="hljs-type">int</span> r,<span class="hljs-type">int</span> k)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> mid=(a+b)/<span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">if</span>(a==l&amp;&amp;b==r)<br>    &#123;<br>        tri[x]+=(b-a)*k;<br>        lazy[x]+=k;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    tri[<span class="hljs-built_in">lc</span>(x)]+=(mid-a)*lazy[x];<br>    lazy[<span class="hljs-built_in">lc</span>(x)]+=lazy[x];<br>    tri[<span class="hljs-built_in">rc</span>(x)]+=(b-mid)*lazy[x];<br>    lazy[<span class="hljs-built_in">rc</span>(x)]+=lazy[x];<br>    lazy[x]=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span>(mid&lt;=l)<br>        <span class="hljs-built_in">addedge</span>(<span class="hljs-built_in">rc</span>(x),mid,b,l,r,k);<br>    <span class="hljs-keyword">if</span>(mid&gt;=r)<br>        <span class="hljs-built_in">addedge</span>(<span class="hljs-built_in">lc</span>(x),a,mid,l,r,k);<br>    <span class="hljs-keyword">if</span>(mid&lt;r&amp;&amp;mid&gt;l)<br>    &#123;<br>        <span class="hljs-built_in">addedge</span>(<span class="hljs-built_in">lc</span>(x),a,mid,l,mid,k);<br>        <span class="hljs-built_in">addedge</span>(<span class="hljs-built_in">rc</span>(x),mid,b,mid,r,k);<br>    &#125;<br>    tri[x]=tri[<span class="hljs-built_in">lc</span>(x)]+tri[<span class="hljs-built_in">rc</span>(x)];<br>&#125;<br><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">S</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b,<span class="hljs-type">int</span> l,<span class="hljs-type">int</span> r)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> now,mid=(a+b)/<span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">if</span>(a==l&amp;&amp;b==r) <span class="hljs-keyword">return</span> tri[x];<br>    tri[<span class="hljs-built_in">lc</span>(x)]+=(mid-a)*lazy[x];<br>    lazy[<span class="hljs-built_in">lc</span>(x)]+=lazy[x];<br>    tri[<span class="hljs-built_in">rc</span>(x)]+=(b-mid)*lazy[x];<br>    lazy[<span class="hljs-built_in">rc</span>(x)]+=lazy[x];<br>    lazy[x]=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span>(mid&lt;=l)<br>        now=<span class="hljs-built_in">S</span>(<span class="hljs-built_in">rc</span>(x),mid,b,l,r);<br>    <span class="hljs-keyword">if</span>(mid&gt;=r)<br>        now=<span class="hljs-built_in">S</span>(<span class="hljs-built_in">lc</span>(x),a,mid,l,r);<br>    <span class="hljs-keyword">if</span>(mid&gt;l&amp;&amp;mid&lt;r)<br>        now=<span class="hljs-built_in">S</span>(<span class="hljs-built_in">lc</span>(x),a,mid,l,mid)+<span class="hljs-built_in">S</span>(<span class="hljs-built_in">rc</span>(x),mid,b,mid,r);<br>    tri[x]=tri[<span class="hljs-built_in">lc</span>(x)]+tri[<span class="hljs-built_in">rc</span>(x)];<br>    <span class="hljs-keyword">return</span> now;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i,j;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;T);<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br>    &#123;<br>        <span class="hljs-type">int</span> tmp;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;tmp);<br>        <span class="hljs-built_in">addedge</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n<span class="hljs-number">+1</span>,i,i<span class="hljs-number">+1</span>,tmp);<br>    &#125;<br>    <span class="hljs-keyword">while</span>(T--)<br>    &#123;<br>        <span class="hljs-type">int</span> tipic;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;tipic);<br>        <span class="hljs-keyword">if</span>(tipic==<span class="hljs-number">1</span>)<br>        &#123;<br>            <span class="hljs-type">int</span> x,y,k;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;x,&amp;y,&amp;k);<br>            <span class="hljs-built_in">addedge</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n<span class="hljs-number">+1</span>,x,y<span class="hljs-number">+1</span>,k);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(tipic==<span class="hljs-number">2</span>)<br>        &#123;<br>            <span class="hljs-type">int</span> x,y;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>,<span class="hljs-built_in">S</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n<span class="hljs-number">+1</span>,x,y<span class="hljs-number">+1</span>));<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5-CRT"><a href="#5-CRT" class="headerlink" title="5.CRT"></a>5.CRT</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> n,a[<span class="hljs-number">5000</span>],m[<span class="hljs-number">5000</span>],S=<span class="hljs-number">0</span>;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> Pim=<span class="hljs-number">1</span>,M[<span class="hljs-number">5000</span>],t[<span class="hljs-number">5000</span>];<br><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">exgcd</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> a,<span class="hljs-type">long</span> <span class="hljs-type">long</span> b,<span class="hljs-type">long</span> <span class="hljs-type">long</span> &amp;x,<span class="hljs-type">long</span> <span class="hljs-type">long</span> &amp;y)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(!b)<br>&#123;<br>x=<span class="hljs-number">1</span>;<br>y=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">return</span> a;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> R=<span class="hljs-built_in">exgcd</span>(b,a%b,y,x);<br>y-=x*(a/b);<br><span class="hljs-keyword">return</span> R;<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">modinverse</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> x,<span class="hljs-type">long</span> <span class="hljs-type">long</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> x0,y0;<br><span class="hljs-built_in">exgcd</span>(x,y,x0,y0);<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> A=(x0<span class="hljs-number">+750</span>*y)%y;<br><span class="hljs-keyword">return</span> A;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br>cin&gt;&gt;n;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++) cin&gt;&gt;m[i]&gt;&gt;a[i];<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++) Pim*=m[i];<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++) M[i]=Pim/m[i];<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++) t[i]=<span class="hljs-built_in">modinverse</span>(M[i],m[i]);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++) S+=a[i]*t[i]*M[i];<br>cout&lt;&lt;S%Pim;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6-ST-è¡¨"><a href="#6-ST-è¡¨" class="headerlink" title="6.ST è¡¨"></a>6.ST è¡¨</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,pw[<span class="hljs-number">30</span>]=&#123;<span class="hljs-number">1</span>&#125;;<br><span class="hljs-type">int</span> f[<span class="hljs-number">3500000</span>][<span class="hljs-number">30</span>];<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> s,<span class="hljs-type">int</span> t)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> p=s,q=t;<br>s=<span class="hljs-built_in">min</span>(p,q),t=<span class="hljs-built_in">max</span>(p,q);<br><span class="hljs-type">int</span> mid=<span class="hljs-built_in">log</span>(t-s<span class="hljs-number">+1</span>)/<span class="hljs-built_in">log</span>(<span class="hljs-number">2</span>);<span class="hljs-comment">//å¯¹æ•°æ¢åº•å…¬å¼ </span><br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-built_in">max</span>(f[s][mid],f[t-pw[mid]<span class="hljs-number">+1</span>][mid]));<br>&#125; <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j,k,T;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">29</span>;i++) pw[i]=pw[i<span class="hljs-number">-1</span>]*<span class="hljs-number">2</span>;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;T);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;f[i][<span class="hljs-number">0</span>]);<br><span class="hljs-keyword">for</span>(k=<span class="hljs-number">1</span>;k&lt;=<span class="hljs-built_in">log</span>(n)/<span class="hljs-built_in">log</span>(<span class="hljs-number">2</span>)<span class="hljs-number">+1</span>;k++)<br>&#123;<br>i=<span class="hljs-number">1</span>;<br><span class="hljs-keyword">while</span>(i+pw[k]&lt;=n<span class="hljs-number">+1</span>)<br>&#123;<br>f[i][k]=<span class="hljs-built_in">max</span>(f[i][k<span class="hljs-number">-1</span>],f[i+pw[k<span class="hljs-number">-1</span>]][k<span class="hljs-number">-1</span>]);<br><span class="hljs-comment">//çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œéå¸¸é‡è¦ </span><br>++i;<br>&#125;<br>&#125;<br><span class="hljs-keyword">while</span>(T--)<br>&#123;<br><span class="hljs-type">int</span> L,R;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;L,&amp;R);<br><span class="hljs-built_in">find</span>(L,R);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="7-æ ‘â€”â€”-é“¾"><a href="#7-æ ‘â€”â€”-é“¾" class="headerlink" title="7.æ ‘â€”â€”&gt;é“¾"></a>7.æ ‘â€”â€”&gt;é“¾</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,r,p,cnt=<span class="hljs-number">0</span>,A=<span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> e[<span class="hljs-number">423500</span>],hd[<span class="hljs-number">423500</span>],nxt[<span class="hljs-number">423500</span>];<br><span class="hljs-type">int</span> tri[<span class="hljs-number">423500</span>],lazy[<span class="hljs-number">423500</span>];<br><span class="hljs-type">int</span> wold[<span class="hljs-number">423500</span>],wnew[<span class="hljs-number">423500</span>];<br><span class="hljs-type">int</span> f[<span class="hljs-number">423500</span>],d[<span class="hljs-number">423500</span>],sz[<span class="hljs-number">423500</span>];<br><span class="hljs-type">int</span> hson[<span class="hljs-number">423500</span>],rk[<span class="hljs-number">423500</span>],top[<span class="hljs-number">423500</span>],id[<span class="hljs-number">423500</span>];<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">åç§°è§£é‡Š </span><br><span class="hljs-comment">f[u]ä¿å­˜ç»“ç‚¹uçš„çˆ¶äº²èŠ‚ç‚¹</span><br><span class="hljs-comment">d[u]ä¿å­˜ç»“ç‚¹uçš„æ·±åº¦å€¼</span><br><span class="hljs-comment">sz[u]ä¿å­˜ä»¥uä¸ºæ ¹çš„å­æ ‘èŠ‚ç‚¹ä¸ªæ•°</span><br><span class="hljs-comment">hson[u]ä¿å­˜é‡å„¿å­</span><br><span class="hljs-comment">rk[u]ä¿å­˜å½“å‰dfsæ ‡å·åœ¨æ ‘ä¸­æ‰€å¯¹åº”çš„èŠ‚ç‚¹</span><br><span class="hljs-comment">top[u]ä¿å­˜å½“å‰èŠ‚ç‚¹æ‰€åœ¨é“¾çš„é¡¶ç«¯èŠ‚ç‚¹</span><br><span class="hljs-comment">id[u]ä¿å­˜æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹å‰–åˆ†ä»¥åçš„æ–°ç¼–å·ï¼ˆDFSçš„æ‰§è¡Œé¡ºåº</span><br><span class="hljs-comment">å‡½æ•°ä¸´æ—¶å˜é‡å‡ä¸ºå¯¹åº”å¤§å†™é¦–å­—æ¯:F,D,S,H,R,T,I </span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">buildtree</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> l,<span class="hljs-type">int</span> r)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> mid=(l+r)/<span class="hljs-number">2</span>;<br><span class="hljs-keyword">if</span>(l==r)<br>&#123;<br>tri[x]=wnew[l]%p;<br><span class="hljs-keyword">return</span> ;<br>&#125;<br><span class="hljs-built_in">buildtree</span>(<span class="hljs-number">2</span>*x,l,mid);<br><span class="hljs-built_in">buildtree</span>(<span class="hljs-number">2</span>*x<span class="hljs-number">+1</span>,mid<span class="hljs-number">+1</span>,r);<br>tri[x]=(tri[<span class="hljs-number">2</span>*x]+tri[<span class="hljs-number">2</span>*x<span class="hljs-number">+1</span>])%p;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> l,<span class="hljs-type">int</span> r)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> mid=(l+r)/<span class="hljs-number">2</span>;<br><span class="hljs-keyword">if</span>(lazy[x])<br>&#123;<br>lazy[<span class="hljs-number">2</span>*x]+=lazy[x];<br>lazy[<span class="hljs-number">2</span>*x<span class="hljs-number">+1</span>]+=lazy[x];<br>tri[<span class="hljs-number">2</span>*x]+=(mid-l<span class="hljs-number">+1</span>)*lazy[x];<br>tri[<span class="hljs-number">2</span>*x<span class="hljs-number">+1</span>]+=(r-mid)*lazy[x];<br>tri[<span class="hljs-number">2</span>*x]%=p;<br>tri[<span class="hljs-number">2</span>*x<span class="hljs-number">+1</span>]%=p;<br>lazy[x]=<span class="hljs-number">0</span>;<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> l,<span class="hljs-type">int</span> r,<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b,<span class="hljs-type">int</span> k)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> mid=(l+r)/<span class="hljs-number">2</span>;<br><span class="hljs-keyword">if</span>(a&lt;=l&amp;&amp;r&lt;=b)<br>&#123;<br>lazy[x]+=k;<br>tri[x]+=k*(r-l<span class="hljs-number">+1</span>);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-built_in">pushdown</span>(x,l,r);<br><span class="hljs-keyword">if</span>(a&lt;=mid) <span class="hljs-built_in">update</span>(<span class="hljs-number">2</span>*x,l,mid,a,b,k);<br><span class="hljs-keyword">if</span>(b&gt;mid) <span class="hljs-built_in">update</span>(<span class="hljs-number">2</span>*x<span class="hljs-number">+1</span>,mid<span class="hljs-number">+1</span>,r,a,b,k);<br>tri[x]=tri[x*<span class="hljs-number">2</span>]+tri[x*<span class="hljs-number">2</span><span class="hljs-number">+1</span>];<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> l,<span class="hljs-type">int</span> r,<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> mid=(l+r)/<span class="hljs-number">2</span>;<br><span class="hljs-keyword">if</span>(a&lt;=l&amp;&amp;r&lt;=b)<br>&#123;<br>A+=tri[x];<br>A%=p;<br><span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-built_in">pushdown</span>(x,l,r);<br><span class="hljs-keyword">if</span>(a&lt;=mid) <span class="hljs-built_in">visit</span>(<span class="hljs-number">2</span>*x,l,mid,a,b);<br><span class="hljs-keyword">if</span>(b&gt;mid) <span class="hljs-built_in">visit</span>(<span class="hljs-number">2</span>*x<span class="hljs-number">+1</span>,mid<span class="hljs-number">+1</span>,r,a,b);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs1</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> F,<span class="hljs-type">int</span> D)</span></span><br><span class="hljs-function"></span>&#123;<br>d[x]=D,f[x]=F,sz[x]=<span class="hljs-number">1</span>;<br><span class="hljs-type">int</span> maxx=<span class="hljs-number">-1</span>,k=hd[x];<br><span class="hljs-keyword">while</span>(k)<br>&#123;<br><span class="hljs-keyword">if</span>(e[k]-F)<br>&#123;<br><span class="hljs-built_in">dfs1</span>(e[k],x,D<span class="hljs-number">+1</span>);<br>sz[x]+=sz[e[k]];<br><span class="hljs-keyword">if</span>(sz[e[k]]&gt;maxx)<br>&#123;<br>maxx=sz[wold[k]];<br>hson[x]=e[k];<br>&#125;<br>&#125;<br>k=nxt[k];<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dfs2</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> T)</span></span><br><span class="hljs-function"></span>&#123;<br>top[x]=T,id[x]=++cnt,rk[cnt]=x;<br>wnew[cnt]=wold[x];<br><span class="hljs-keyword">if</span>(!hson[x]) <span class="hljs-keyword">return</span>;<br><span class="hljs-built_in">dfs2</span>(hson[x],T);<br><span class="hljs-type">int</span> k=hd[x];<br><span class="hljs-keyword">while</span>(k)<br>&#123;<br><span class="hljs-keyword">if</span>(e[k]-hson[x]&amp;&amp;e[k]-f[x]) <span class="hljs-built_in">dfs2</span>(e[k],e[k]);<br>k=nxt[k];<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">updrange</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y,<span class="hljs-type">int</span> k)</span></span><br><span class="hljs-function"></span>&#123;<br>k%=p;<br><span class="hljs-keyword">while</span>(top[x]-top[y])<br>&#123;<br><span class="hljs-keyword">if</span>(d[top[x]]&lt;d[top[y]]) <span class="hljs-built_in">swap</span>(x,y);<br><span class="hljs-built_in">update</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n,id[top[x]],id[x],k);<br>x=f[top[x]];<br>&#125;<br><span class="hljs-keyword">if</span>(d[x]&gt;d[y]) <span class="hljs-built_in">swap</span>(x,y);<br><span class="hljs-built_in">update</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n,id[x],id[y],k);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">qrange</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> rns=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span>(top[x]-top[y])<br>&#123;<br><span class="hljs-keyword">if</span>(d[top[x]]&lt;d[top[y]]) <span class="hljs-built_in">swap</span>(x,y);<br>A=<span class="hljs-number">0</span>;<br><span class="hljs-built_in">visit</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n,id[top[x]],id[x]);<br>rns+=A,rns%=p;<br>x=f[top[x]];<br>&#125;<br><span class="hljs-keyword">if</span>(d[x]&gt;d[y]) <span class="hljs-built_in">swap</span>(x,y);<br>A=<span class="hljs-number">0</span>;<br><span class="hljs-built_in">visit</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n,id[x],id[y]);<br>rns+=A;<br><span class="hljs-keyword">return</span> rns%p;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">qson</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>A=<span class="hljs-number">0</span>;<br><span class="hljs-built_in">visit</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n,id[x],id[x]+sz[x]<span class="hljs-number">-1</span>);<br><span class="hljs-keyword">return</span> A;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">updson</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> k)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">update</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n,id[x],id[x]+sz[x]<span class="hljs-number">-1</span>,k);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j,k=<span class="hljs-number">0</span>;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;r,&amp;p);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;wold[i]);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n<span class="hljs-number">-1</span>;i++)<br>&#123;<br><span class="hljs-type">int</span> x,y;<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);<br>e[++k]=y,nxt[k]=hd[x],hd[x]=k;<br>e[++k]=x,nxt[k]=hd[y],hd[y]=k;<br>&#125;<br><span class="hljs-built_in">dfs1</span>(r,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);<br><span class="hljs-built_in">dfs2</span>(r,r);<br><span class="hljs-built_in">buildtree</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,n);<br><span class="hljs-type">int</span> tipic,x,y,z;<br><span class="hljs-keyword">while</span>(m--)<br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;tipic);<br><span class="hljs-keyword">switch</span>(tipic)<br>&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;x,&amp;y,&amp;z);<br><span class="hljs-built_in">updrange</span>(x,y,z); <br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-built_in">qrange</span>(x,y)); <br><span class="hljs-keyword">break</span>;<br>&#125; <br><span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);<br><span class="hljs-built_in">updson</span>(x,y);<br><span class="hljs-keyword">break</span>;<br>&#125; <br><span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;x);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-built_in">qson</span>(x));<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-keyword">default</span>:<span class="hljs-keyword">break</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="8-åŸºæœ¬äºŒå‰æ ‘æ“ä½œ"><a href="#8-åŸºæœ¬äºŒå‰æ ‘æ“ä½œ" class="headerlink" title="8.åŸºæœ¬äºŒå‰æ ‘æ“ä½œ"></a>8.åŸºæœ¬äºŒå‰æ ‘æ“ä½œ</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,ask;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">asdf</span>&#123;<span class="hljs-type">int</span> val,lson,rson,taim,size;&#125;tri[<span class="hljs-number">2607087</span>];<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addedge</span><span class="hljs-params">(<span class="hljs-type">int</span> loc,<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(!n)<br>&#123;<br>n=<span class="hljs-number">1</span>,tri[<span class="hljs-number">1</span>].size=<span class="hljs-number">1</span>,tri[<span class="hljs-number">1</span>].val=x,tri[<span class="hljs-number">1</span>].taim=<span class="hljs-number">1</span>;<br><span class="hljs-keyword">return</span>;<br>&#125;<br>tri[loc].size++;<br><span class="hljs-keyword">if</span>(tri[loc].val==x) <br>&#123;<br>tri[loc].taim++;<br><span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-keyword">if</span>(tri[loc].val&gt;x)<br>&#123;<br><span class="hljs-keyword">if</span>(tri[loc].lson) <span class="hljs-built_in">addedge</span>(tri[loc].lson,x);<br><span class="hljs-keyword">else</span><br>&#123;<br>tri[++n].val=x;tri[n].taim=<span class="hljs-number">1</span>;<br>tri[n].size=<span class="hljs-number">1</span>;tri[loc].lson=n;<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span>(tri[loc].val&lt;x)<br>&#123;<br><span class="hljs-keyword">if</span>(tri[loc].rson)<span class="hljs-built_in">addedge</span>(tri[loc].rson,x);<br><span class="hljs-keyword">else</span><br>&#123;<br>tri[++n].val=x;tri[n].taim=<span class="hljs-number">1</span>;<br>tri[n].size=<span class="hljs-number">1</span>;tri[loc].rson=n;<br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">findlow</span><span class="hljs-params">(<span class="hljs-type">int</span> loc,<span class="hljs-type">int</span> subget)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(tri[loc].val&gt;=ask)<br>&#123;<br><span class="hljs-keyword">if</span>(!tri[loc].lson) <span class="hljs-keyword">return</span> subget;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-built_in">findlow</span>(tri[loc].lson,subget);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">if</span>(!tri[loc].rson)<br>&#123;<br><span class="hljs-keyword">if</span>(tri[loc].val&lt;ask) <span class="hljs-keyword">return</span> tri[loc].val;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> subget;<br>&#125;<br><span class="hljs-keyword">if</span>(tri[loc].taim) <span class="hljs-keyword">return</span> <span class="hljs-built_in">findlow</span>(tri[loc].rson,tri[loc].val);<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-built_in">findlow</span>(tri[loc].rson,subget);<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">findhigh</span><span class="hljs-params">(<span class="hljs-type">int</span> loc,<span class="hljs-type">int</span> subget)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(tri[loc].val&lt;=ask)<br>&#123;<br><span class="hljs-keyword">if</span>(!tri[loc].rson) <span class="hljs-keyword">return</span> subget;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-built_in">findhigh</span>(tri[loc].rson,subget);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">if</span>(!tri[loc].lson)<br>&#123;<br><span class="hljs-keyword">if</span>(tri[loc].val&gt;ask) <span class="hljs-keyword">return</span> tri[loc].val;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> subget;<br>&#125;<br><span class="hljs-keyword">if</span>(tri[loc].size) <span class="hljs-keyword">return</span> <span class="hljs-built_in">findhigh</span>(tri[loc].lson,tri[loc].val);<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-built_in">findhigh</span>(tri[loc].lson,subget);<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">findrank</span><span class="hljs-params">(<span class="hljs-type">int</span> loc)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(!loc) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span>(ask==tri[loc].val) <span class="hljs-keyword">return</span> tri[tri[loc].lson].size;<br><span class="hljs-keyword">if</span>(ask&gt;tri[loc].val) <span class="hljs-keyword">return</span> <span class="hljs-built_in">findrank</span>(tri[loc].rson)+tri[loc].taim+tri[tri[loc].lson].size;<br><span class="hljs-keyword">if</span>(ask&lt;tri[loc].val) <span class="hljs-keyword">return</span> <span class="hljs-built_in">findrank</span>(tri[loc].lson);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">findnum</span><span class="hljs-params">(<span class="hljs-type">int</span> loc)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(!loc) <span class="hljs-keyword">return</span> <span class="hljs-number">2147483647</span>;<br><span class="hljs-keyword">if</span>(tri[tri[loc].lson].size&gt;=ask)<span class="hljs-keyword">return</span> <span class="hljs-built_in">findnum</span>(tri[loc].lson);<br><span class="hljs-keyword">if</span>(tri[tri[loc].lson].size+tri[loc].taim&gt;=ask) <span class="hljs-keyword">return</span> tri[loc].val;<br>ask-=tri[tri[loc].lson].size+tri[loc].taim;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">findnum</span>(tri[loc].rson);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">//freopen(&quot;1.hx902in&quot;,&quot;r&quot;,stdin);</span><br><span class="hljs-type">int</span> i,j,T;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;T);<br><span class="hljs-keyword">while</span>(T--)<br>&#123;<br><span class="hljs-type">int</span> tipic; <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;tipic);<br><span class="hljs-keyword">switch</span>(tipic)<br>&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<span class="hljs-comment">//æ±‚xçš„æ’å</span><br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;ask);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-number">1</span>+<span class="hljs-built_in">findrank</span>(<span class="hljs-number">1</span>));<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<span class="hljs-comment">//æ±‚æ’åxçš„æ•°</span><br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;ask);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-built_in">findnum</span>(<span class="hljs-number">1</span>));<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<span class="hljs-comment">//æ±‚xçš„å‰é©±</span><br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;ask);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-built_in">findlow</span>(<span class="hljs-number">1</span>,<span class="hljs-number">-2147483647</span>));<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<span class="hljs-comment">//æ±‚xçš„åç»§</span><br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;ask);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-built_in">findhigh</span>(<span class="hljs-number">1</span>,<span class="hljs-number">+2147483647</span>));<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<span class="hljs-comment">//æ’å…¥x</span><br>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;ask); <span class="hljs-built_in">addedge</span>(<span class="hljs-number">1</span>,ask);<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-keyword">default</span>:<span class="hljs-keyword">break</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="9-Manacher"><a href="#9-Manacher" class="headerlink" title="9.Manacher"></a>9.Manacher</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,A,f[<span class="hljs-number">45000000</span>];<br><span class="hljs-type">char</span> c[<span class="hljs-number">45000000</span>];<br><span class="hljs-type">int</span> Maxnum,Maxlen;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">//freopen(&quot;testdata.in&quot;,&quot;r&quot;,stdin);</span><br><span class="hljs-type">int</span> i,j;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>,c);<br>n=<span class="hljs-built_in">strlen</span>(c)*<span class="hljs-number">2</span>;<br><span class="hljs-keyword">for</span>(i=n;i&gt;<span class="hljs-number">1</span>;i--)<br>&#123;<br><span class="hljs-keyword">if</span>(i%<span class="hljs-number">2</span>) c[i]=<span class="hljs-string">&#x27;*&#x27;</span>;<br><span class="hljs-keyword">else</span> c[i]=c[i/<span class="hljs-number">2</span><span class="hljs-number">-1</span>];<br>&#125;<br>c[<span class="hljs-number">0</span>]=<span class="hljs-string">&#x27;@&#x27;</span>,c[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;*&#x27;</span>,c[n<span class="hljs-number">+1</span>]=<span class="hljs-string">&#x27;*&#x27;</span>,c[n<span class="hljs-number">+2</span>]=<span class="hljs-string">&#x27;~&#x27;</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++)<br>&#123;<br><span class="hljs-keyword">if</span>(Maxlen+Maxnum&gt;i) f[i]=<span class="hljs-built_in">min</span>(Maxlen+Maxnum<span class="hljs-number">-1</span>,f[<span class="hljs-number">2</span>*Maxnum-i]);<br><span class="hljs-keyword">else</span> f[i]=<span class="hljs-number">1</span>;<br><span class="hljs-keyword">while</span>(c[i-f[i]]==c[i+f[i]]) ++f[i];<br><span class="hljs-keyword">if</span>(f[i]&gt;Maxlen) Maxlen=f[i],Maxnum=i;<br>A=<span class="hljs-built_in">max</span>(A,f[i]);<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld&quot;</span>,A<span class="hljs-number">-1</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="10-ç½‘ç»œæµ"><a href="#10-ç½‘ç»œæµ" class="headerlink" title="10. ç½‘ç»œæµ"></a>10. ç½‘ç»œæµ</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,s,t,A;<br><span class="hljs-type">int</span> e[<span class="hljs-number">900000</span>],w[<span class="hljs-number">900000</span>],nxt[<span class="hljs-number">900000</span>];<br><span class="hljs-type">int</span> hd[<span class="hljs-number">900000</span>],dep[<span class="hljs-number">900000</span>],q[<span class="hljs-number">3430000</span>];<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> f=<span class="hljs-number">1</span>,r=<span class="hljs-number">1</span>;<br><span class="hljs-built_in">memset</span>(dep,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(dep));<br>dep[s]=<span class="hljs-number">1</span>;q[<span class="hljs-number">1</span>]=s;<br><span class="hljs-keyword">while</span>(f&lt;=r)<br>&#123;<br><span class="hljs-type">int</span> x=q[f++],k=hd[x];<br><span class="hljs-keyword">while</span>(k)<br>&#123;<br><span class="hljs-keyword">if</span>((dep[e[k]]==<span class="hljs-number">0</span>)&amp;&amp;(w[k]&gt;<span class="hljs-number">0</span>))<br>&#123;<br>dep[e[k]]=dep[x]<span class="hljs-number">+1</span>;<br>q[++r]=e[k];<br>&#125;<br>k=nxt[k];<br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> dep[t];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> flow)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(x==t) <span class="hljs-keyword">return</span> flow;<br><span class="hljs-type">int</span> k=hd[x];<br><span class="hljs-keyword">while</span>(k)<br>&#123;<br><span class="hljs-keyword">if</span>((w[k])&amp;&amp;(dep[e[k]]==dep[x]<span class="hljs-number">+1</span>))<br>&#123;<br><span class="hljs-type">int</span> dis=<span class="hljs-built_in">dfs</span>(e[k],<span class="hljs-built_in">min</span>(flow,w[k]));<br><span class="hljs-keyword">if</span>(dis&gt;<span class="hljs-number">0</span>) <br>&#123;<br>w[k]-=dis;<br><span class="hljs-keyword">if</span>(k%<span class="hljs-number">2</span>) w[k<span class="hljs-number">+1</span>]+=dis;<br><span class="hljs-keyword">else</span> w[k<span class="hljs-number">-1</span>]+=dis;<br><span class="hljs-keyword">return</span> dis;<br>&#125;<br>&#125;<br>k=nxt[k];<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">dinic</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> B=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span>(<span class="hljs-built_in">bfs</span>())<br>&#123;<br><span class="hljs-keyword">while</span>(B=<span class="hljs-built_in">dfs</span>(s,<span class="hljs-number">20011230</span>)) A+=B;<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">//freopen(&quot;flow1.in&quot;,&quot;r&quot;,stdin);</span><br><span class="hljs-type">int</span> k=<span class="hljs-number">0</span>;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;s,&amp;t);<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)<br>&#123;<br><span class="hljs-type">int</span> x,y,z;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;x,&amp;y,&amp;z);<br>e[++k]=y,w[k]=z,nxt[k]=hd[x],hd[x]=k;<br>e[++k]=x,w[k]==<span class="hljs-number">0</span>,nxt[k]=hd[y],hd[y]=k;<br>&#125;<br><span class="hljs-built_in">dinic</span>();<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,A);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="11-LCA"><a href="#11-LCA" class="headerlink" title="11.LCA"></a>11.LCA</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// luogu-judger-enable-o2</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,m,s,h[<span class="hljs-number">1607087</span>];<br><span class="hljs-type">int</span> e[<span class="hljs-number">1607087</span>],hd[<span class="hljs-number">1607087</span>],nxt[<span class="hljs-number">1607087</span>];<br><span class="hljs-type">int</span> a[<span class="hljs-number">1607087</span>],b[<span class="hljs-number">1607087</span>],ans[<span class="hljs-number">1607087</span>];<br><span class="hljs-type">bool</span> v[<span class="hljs-number">1607087</span>];<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(x-h[x]) <span class="hljs-keyword">return</span> h[x]=<span class="hljs-built_in">find</span>(h[x]);<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> x;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">lca</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,now=hd[x];<br>v[x]=<span class="hljs-number">1</span>;<br><span class="hljs-keyword">while</span>(now)<br>&#123;<br><span class="hljs-keyword">if</span>(!v[e[now]])<br>&#123;<br><span class="hljs-built_in">lca</span>(e[now]);<br>h[e[now]]=x;<br>&#125;<br>now=nxt[now];<br>&#125;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=m;i++)<br>&#123;<br><span class="hljs-keyword">if</span>(a[i]==x&amp;&amp;v[b[i]]) ans[i]=<span class="hljs-built_in">find</span>(b[i]);<br><span class="hljs-keyword">if</span>(b[i]==x&amp;&amp;v[a[i]]) ans[i]=<span class="hljs-built_in">find</span>(a[i]);<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j,k=<span class="hljs-number">0</span>;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;s);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;n;i++)<br>&#123;<br><span class="hljs-type">int</span> x,y;<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);<br>e[++k]=y,nxt[k]=hd[x],hd[x]=k;<br>e[++k]=x,nxt[k]=hd[y],hd[y]=k;<br>&#125;<br><span class="hljs-built_in">memset</span>(v,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(v));<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;i++) h[i]=i;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=m;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;a[i],&amp;b[i]);<br><span class="hljs-built_in">lca</span>(s);<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=m;i++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,ans[i]);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>SelfSkills</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Skills</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0xGameDiv4</title>
    <link href="/2020/10/29/0xGameDiv4/"/>
    <url>/2020/10/29/0xGameDiv4/</url>
    
    <content type="html"><![CDATA[<h1 id="0xGame-Div-4-é¢˜è§£"><a href="#0xGame-Div-4-é¢˜è§£" class="headerlink" title="0xGame Div 4 é¢˜è§£"></a>0xGame Div 4 é¢˜è§£</h1><h2 id="About"><a href="#About" class="headerlink" title="About"></a>About</h2><p>4å‘¨è¿‡å»ï¼Œ7172åˆ†ï¼Œä¸è¿‡è‡ªå·±çš„CTFå­¦ä¹ è¿›å…¥äº†ç¬¬äºŒé˜¶æ®µï¼Œå¾ˆå¿«å°±è¦è¿›å…¥æ•°è®ºäº†ã€‚ ç„¶è€Œæœ€è¿‘åˆåœ¨å‚åŠ å­¦æ ¡ACMèœé¸Ÿèµ›ï¼ˆ<del>ï¼ˆä½œä¸ºä¸€ä¸ªå½“å¹´è·ç¦»1&#x3D;åªå·®15åˆ†çš„2&#x3D;è’Ÿè’»ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠï¼‰</del></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="1-littleTrick"><a href="#1-littleTrick" class="headerlink" title="1.  littleTrick"></a>1.  littleTrick</h3><p>ä¸€é“å¹¶ä¸ç®—å¾ˆéš¾å¾—é¢˜ç›®ï¼Œ<del>ä½†æˆ‘è¿™ä¸ªfwè¿˜æ˜¯ç”¨äº†4ä¸ªå°æ—¶æ‰åšå‡ºæ¥ï¼Œwtcl</del></p><p>é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹é¢˜ç›®çš„ä¸»è¦ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>       <span class="hljs-variable language_">self</span>.send(BANNER)<br>       <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-variable language_">self</span>.proof_of_work():<br>           <span class="hljs-keyword">return</span><br>       <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">44</span><br>       p, q = getPrime(<span class="hljs-number">1024</span>), getPrime(<span class="hljs-number">1024</span>)<br>       <span class="hljs-variable language_">self</span>.m = flag.encode()<br>       <span class="hljs-variable language_">self</span>.n = p*q<br>       <span class="hljs-variable language_">self</span>.e = <span class="hljs-number">65537</span><br>       <span class="hljs-variable language_">self</span>.d = inverse(<span class="hljs-variable language_">self</span>.e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br>       <span class="hljs-variable language_">self</span>.send(<span class="hljs-string">b&quot;n : &quot;</span> + <span class="hljs-built_in">hex</span>(<span class="hljs-variable language_">self</span>.n)[<span class="hljs-number">2</span>:].encode())<br>       <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>           <span class="hljs-variable language_">self</span>.send(MENU, newline=<span class="hljs-literal">False</span>)<br>           choice = <span class="hljs-variable language_">self</span>.recv()<br>           <span class="hljs-keyword">if</span> choice == <span class="hljs-string">b&quot;1&quot;</span>:<br>               mask = <span class="hljs-variable language_">self</span>.recvhex(prompt=<span class="hljs-string">b&quot;Your mask (in hex): &quot;</span>)<br>               mask = long_to_bytes(<span class="hljs-built_in">pow</span>(mask,<span class="hljs-variable language_">self</span>.d,<span class="hljs-variable language_">self</span>.n))<br>               <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(mask) &gt;= <span class="hljs-number">44</span>:<br>                   <span class="hljs-keyword">break</span><br>               gift = <span class="hljs-variable language_">self</span>.m[:-<span class="hljs-built_in">len</span>(mask)] + mask<br>               gift = <span class="hljs-built_in">pow</span>(bytes_to_long(gift),<span class="hljs-variable language_">self</span>.e,<span class="hljs-variable language_">self</span>.n)<br>               <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">hex</span>(gift)[<span class="hljs-number">2</span>:].encode())<br>               <span class="hljs-keyword">continue</span><br>           <span class="hljs-variable language_">self</span>.request.close()<br>           <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ä¸€å¼€å§‹ï¼Œä¼šç»™å‡º$n$çš„å€¼(æ­¤å¤„ç›¸å…³çš„é¢˜ç›®ä»£ç çœç•¥äº†)ï¼Œ$e&#x3D;65537$ä¸ºå›ºå®šå€¼</p><p>ä»ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šè¿™æ˜¯ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„RSAé¢˜ç›®ï¼Œflagçš„é•¿åº¦æ˜¯$44$ä½ï¼Œæ¯å½“æˆ‘ä»¬è¾“å…¥ä¸€ä¸ª$16$è¿›åˆ¶æ•°ï¼Œç³»ç»Ÿä¼šç”¨è§£å¯†å‡½æ•°å¯¹è¿™ä¸ªæ•°å­—è¿›è¡Œè§£å¯†ï¼Œå¦‚æœè¶…è¿‡flagçš„é•¿åº¦$44$ä½ç›´æ¥æ¨å‡ºäº¤äº’ã€‚å¦åˆ™å°†ç­”æ¡ˆçš„æœ€åæ›¿æ¢ä¸ºè§£å¯†ç»“æœä¹‹ååŠ å¯†è®¡ç®—$câ€™$</p><p>å¾ˆæ˜¾ç„¶ï¼Œå¯¹äºæ¯æ¬¡äº¤äº’çš„å†…å®¹ï¼Œæˆ‘ä»¬å¿…é¡»<del>æ…é‡è€ƒè™‘</del>ã€‚ æ ¹æ®é€šè¯†å¯çŸ¥ï¼šflagçš„æœ€åä¸€ä½ä¸€å®šæ˜¯<code>&#125;</code>,ï¼Œå…¶ASCIIç ä¸º$125$ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå¯¹æœåŠ¡å™¨å‘é€æ•°å€¼$125$é€šè¿‡åŠ å¯†åçš„æ•°å­—ï¼ˆä»¥$16$è¿›åˆ¶æ ¼å¼ï¼‰å‘é€ç»™æœåŠ¡å™¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†æ­£ç¡®çš„$c$å€¼äº†</p><p>å¾—åˆ°æ­£ç¡®çš„$c$å€¼ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ¯æ¬¡æšä¸¾å­—ç¬¦ä¸²çš„å‰ä¸€ä½ï¼ŒåŠ å¯†åå‘é€ç»™æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨è¿”å›çš„å€¼ä¸åˆšæ‰å¾—åˆ°çš„æ­£ç¡®çš„$c$å€¼å®Œå…¨ä¸€è‡´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸€ä½æ˜¯æ­£ç¡®çš„ï¼ˆå› ä¸ºè¿™æ ·ç›¸å½“äºåŸå¯†æ–‡æ²¡æœ‰è¢«æ›¿æ¢ï¼‰ã€‚æšä¸¾ç»“æŸæˆ‘ä»¬å°±å¾—åˆ°äº†flag</p><p>ä¸‹é¢é™„ä¸Š<del>ä½æ¸…æœ‰ç </del>çš„è„šæœ¬ä»£ç ï¼Œåˆ«çœ‹<del>å› ä¸ºæˆ‘å¯èœäº†</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyanzhengma</span>(<span class="hljs-params">s16len,s64len</span>):<br>LTSNMS=<span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOP\mathrm&#123;QR&#125;STUVWXYZ0123456789&quot;</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s16len)==<span class="hljs-number">16</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(s64len)==<span class="hljs-number">64</span><br><span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">for</span> i4 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">if</span> sha256((i1+i2+i3+i4+s16len).encode()).hexdigest()==s64len:<br><span class="hljs-keyword">return</span> i1+i2+i3+i4<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">incode</span>(<span class="hljs-params">m,p</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">pow</span>(m,<span class="hljs-number">65537</span>,p))[<span class="hljs-number">2</span>:]<br><span class="hljs-comment">##------main below------#</span><br>sh=remote(<span class="hljs-string">&quot;49.235.239.97&quot;</span>,<span class="hljs-number">10004</span>)<br><span class="hljs-keyword">while</span>(<span class="hljs-literal">True</span>):<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-keyword">if</span>(str1[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>]==<span class="hljs-string">&quot;sha256&quot;</span>):<br><span class="hljs-keyword">break</span><br>flag=<span class="hljs-string">&quot;&#125;&quot;</span><br>yanzhengma=(getyanzhengma(str1[<span class="hljs-number">12</span>:<span class="hljs-number">28</span>],str1[<span class="hljs-number">33</span>:<span class="hljs-number">97</span>]))<br>sh.send(yanzhengma)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[NOTE]SENT YANZHENGMA&quot;</span>)<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>n=<span class="hljs-built_in">int</span>(str1[<span class="hljs-number">18</span>:],<span class="hljs-number">16</span>) <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>str1=sh.recv(numb=<span class="hljs-number">4</span>,timeout=<span class="hljs-number">20000</span>)<br>sh.send(<span class="hljs-string">b&quot;1&quot;</span>)<br>str1=sh.recv(numb=<span class="hljs-number">40</span>,timeout=<span class="hljs-number">20000</span>)<br>sh.send(incode(<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;&#125;&#x27;</span>),n))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;sent numbers&quot;</span>)<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>C=<span class="hljs-built_in">int</span>(str1,<span class="hljs-number">16</span>)<br>cnt=<span class="hljs-number">42</span><br><span class="hljs-keyword">while</span> cnt!=-<span class="hljs-number">1</span>:<br><span class="hljs-comment">#print(cnt)</span><br>konst=<span class="hljs-string">b&quot;1234567890abcdefxGame&#123;-&#125;&quot;</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> konst:<br>tmp=<span class="hljs-built_in">str</span>(j)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>str1=sh.recv(numb=<span class="hljs-number">4</span>,timeout=<span class="hljs-number">20000</span>)<br>sh.send(<span class="hljs-string">b&quot;1&quot;</span>)<br>str1=sh.recv(numb=<span class="hljs-number">44</span>,timeout=<span class="hljs-number">20000</span>)<br>sh.send(incode(bytes_to_long(tmp+flag),n))<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>C1=<span class="hljs-built_in">int</span>(str1,<span class="hljs-number">16</span>)<br><span class="hljs-keyword">if</span> C1==C:<br>flag=tmp+flag<br><span class="hljs-built_in">print</span>(flag)<br>cnt=cnt-<span class="hljs-number">1</span><br><span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h3 id="2-ElGamal"><a href="#2-ElGamal" class="headerlink" title="2.ElGamal"></a>2.ElGamal</h3><p>å¯†ç å­¦å‹è½´é¢˜&#x3D; &#x3D;ï¼Œè™½ç„¶ä¸æ˜¯è¿œç¨‹é¢˜ç›®ä½†æ˜¯æœ€éš¾çš„ã€‚ä»£ç é‡ä¸å¤§ä½†æ€ç»´é‡å¾ˆå¤§ï¼Œå› ä¸ºè¿™é“é¢˜ä¸æ•°è®ºè”ç³»æå…¶ç´§å¯†ã€‚<del>è™½ç„¶æˆ‘ä»¥å‰æ‰“è¿‡OIï¼Œä½†å­¦å¾—ä¸æ·±ï¼Œæ›´åˆ«è°ˆæ—¢æœ‰OIåŸºç¡€åˆæœ‰æ•°å­¦ç«èµ›åŸºç¡€çš„Hermesdalaoç›¸æ¯”äº†ã€‚æ‰€ä»¥æˆ‘åœ¨å¾—åˆ°1..hintä¹‹åï¼Œæ‰åšäº†å‡ºæ¥</del>ã€‚ç”±äºè¿™é¢˜å¾ˆéš¾æ‰€ä»¥WP<del>(è‡ªå·±çš„å­¦ä¹ ç¬”è®°)</del>è¦è®¤çœŸåœ°å†™ä¸€ä¸‹ã€‚<br><strong>æˆ‘ä»¬çº¦å®šä¸€ä¸‹:ä»¥ä¸‹å‡¡æ— ç‰¹æ®Šè¯´æ˜ï¼Œæ‰€æœ‰çš„æ•°å­—å‡ä¸ºæ•´æ•°ï¼Œæ‰€æœ‰çš„é™¤æ³•å‡ä¸ºæ•´é™¤</strong></p><hr><h4 id="Note-1-ElGamalåŸºæœ¬åŠ å¯†æ–¹æ³•"><a href="#Note-1-ElGamalåŸºæœ¬åŠ å¯†æ–¹æ³•" class="headerlink" title="Note 1:ElGamalåŸºæœ¬åŠ å¯†æ–¹æ³•"></a>Note 1:ElGamalåŸºæœ¬åŠ å¯†æ–¹æ³•</h4><p>step1ï¼šé€‰æ‹©ä¸€ä¸ªå¤§è´¨æ•°$p$ï¼Œå’Œé›†åˆ$Z_p^*$ä¸Šçš„ä¸€ä¸ªç”Ÿæˆå…ƒ$g$</p><p>step2ï¼šé€‰æ‹©ä¸€ä¸ªæ•°å­—$k$åœ¨$[0,p-2]$å†…ï¼Œè®¡ç®—$y&#x3D;g^k \mod p$ï¼Œä¹Ÿå°±æ˜¯$g^k\equiv y \mod p$</p><p>step3ï¼šéšæœºé€‰å–$râˆˆZ_{p-1}$ï¼ŒåŠ å¯†å‡½æ•°ä¸º$E(k,x,r)&#x3D;(y_1,y_2)$ å…¶ä¸­$y_1\equiv g^r \mod p$ï¼Œ$y_2\equiv my^r \mod p$</p><p>å…¶ä¸­ï¼š$k$æ˜¯ç§é’¥ï¼Œ$p,g,y$æ˜¯å…¬é’¥</p><hr><h4 id="Note-2-ElGamalåŸºæœ¬è§£å¯†æ–¹æ³•"><a href="#Note-2-ElGamalåŸºæœ¬è§£å¯†æ–¹æ³•" class="headerlink" title="Note 2:ElGamalåŸºæœ¬è§£å¯†æ–¹æ³•"></a>Note 2:ElGamalåŸºæœ¬è§£å¯†æ–¹æ³•</h4><p>è§£å¯†å‡½æ•°ï¼š$D(y_1,y_2)&#x3D;y_2(y_1^k) \mod p \equiv m(g^k)^r(g^{kr})^{-1}\equiv m \mod p$</p><hr><p>å¾ˆæ˜¾ç„¶ï¼ŒElGamalæ˜¯ä¸€ä¸ªåŸºäºç¦»æ•£å¯¹æ•°çš„åŠ å¯†ç®—æ³•ï¼Œæƒ³æ±‚å‡ºç§é’¥$k$åŸºæœ¬ä¸Šæ˜¯ä¸å¯èƒ½çš„ï¼Œç›®å‰æœ€æœ‰æ•ˆçˆ†ç ´ç¦»æ•£å¯¹æ•°çš„ç®—æ³•çš„å¤æ‚åº¦ä¸º$O(\sqrt{p})$ï¼Œä½†å¯¹äºé«˜è¾¾$512$ä½äºŒè¿›åˆ¶æ•°çš„å¤§è´¨æ•°$p$ï¼Œè¿™ä¸ªç®—æ³•å¤æ‚åº¦æ˜¯éå¸¸é«˜çš„ã€‚</p><p><strong>æ ¹æ®è¥¿ç”µå¤§ä½¬shallowåœ¨MOECTFçš„ã€ŠCryptoå…¥é—¨æŒ‡åŒ—ã€‹ä¸­æ‰€è¯´ï¼šCTFä¸­æ‰€æœ‰çš„å¯†ç å­¦é¢˜ç›®éƒ½æ˜¯é€šè¿‡æœ‰æ¼æ´çš„åŠ å¯†æ–¹å¼å®ç°çš„ã€‚é‡ç‚¹å°±æ˜¯è¦ä»ä¸­æ‰¾å‡ºæ¼æ´ï¼Œå¹¶ä¸”åœ¨æ²¡æœ‰å¯†é’¥çš„æƒ…å†µä¸‹æ¢å¤æ˜æ–‡ã€‚</strong></p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å›å½’ä¸€ä¸‹é¢˜ç›®å®ç°ç®—æ³•çš„æºä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> ElGamal<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">notSquare</span>(<span class="hljs-params">p</span>):<br>    r = randint(<span class="hljs-number">2</span>, p-<span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">pow</span>(r, (p-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>, p) == <span class="hljs-number">1</span>:<br>        r = randint(<span class="hljs-number">2</span>, p-<span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">return</span> r<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Square</span>(<span class="hljs-params">p</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(randint(<span class="hljs-number">2</span>, p-<span class="hljs-number">2</span>), <span class="hljs-number">2</span>, p)<br>flag = <span class="hljs-built_in">bin</span>(bytes_to_long(flag.encode()))[<span class="hljs-number">2</span>:]<br>key = ElGamal.generate(<span class="hljs-number">512</span>, Random.new().read)<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    plaintexts = &#123;<span class="hljs-string">&quot;0&quot;</span>: Square(<span class="hljs-built_in">int</span>(key.p)), <span class="hljs-string">&quot;1&quot;</span>: notSquare(<span class="hljs-built_in">int</span>(key.p))&#125;<br>    c = key._encrypt(plaintexts[i], randint(<span class="hljs-number">1</span>, <span class="hljs-built_in">int</span>(key.p)-<span class="hljs-number">2</span>))<br>    f.writelines(<span class="hljs-built_in">hex</span>(c[<span class="hljs-number">0</span>])[<span class="hljs-number">2</span>:]+<span class="hljs-string">&quot;, &quot;</span>+<span class="hljs-built_in">hex</span>(c[<span class="hljs-number">1</span>])[<span class="hljs-number">2</span>:]+<span class="hljs-string">&quot;\n&quot;</span>)<br>f.close()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;y =&quot;</span>, key.y)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;g =&quot;</span>, key.g)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p =&quot;</span>, key.p)<br></code></pre></td></tr></table></figure><p>å¯†æ–‡å…ˆè¢«è½¬åŒ–æˆäº†äºŒè¿›åˆ¶ï¼Œç„¶åæ ¹æ®æ¯ä¸€ä½æ˜¯$0$è¿˜æ˜¯$1$ï¼Œç”¨ä¸€ä¸ªæ•°å­—åŠ å¯†äº†ï¼Œå…¶ä¸­å½“è¿™ä¸€ä½ä¸º$0$æ—¶é€‰å–çš„æ•°å­—æ˜¯ä¸ªå¹³æ–¹æ•°å¯¹$p$å–æ¨¡çš„å€¼ï¼Œè¿™ä¸€ä½æ˜¯$1$æ—¶é€‰å–çš„æ•°å­—ä¸æ˜¯ä¸€ä¸ªå¹³æ–¹æ•°å¯¹$p$å–æ¨¡çš„å€¼ã€‚ç„¶åå°†è¿™ä¸ªæ•°å­—è®°ä¸ºä¸­é—´å¯†æ–‡$x$ï¼Œå†äº§ç”Ÿä¸€ä¸ªéšæœºæ•°$r$ä½œä¸ºæŒ‡æ•°å°†å…¶åŠ å¯†ã€‚</p><p>æ—¢ç„¶è¿™é‡Œæ¶‰åŠåˆ°äº†å¹³æ–¹ï¼Œè€Œä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°å¯¹æŸä¸ªæ•°å–æ¨¡ä¸€å®šä¼šæœ‰æŸäº›ç‰¹æ®Šçš„æ€§è´¨ï¼Œ<del>åœ¨hintçš„æŒ‡å¼•ä¸‹</del>ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä»€ä¹ˆå«åšæ¨¡$p$å¹³æ–¹å‰©ä½™å’ŒäºŒæ¬¡äº’åå¾‹ï¼š<strong>æ³¨:æœ¬é¢˜è§£&#x2F;åšå®¢åªè®²è§£å½’çº³æ³•å¾—åˆ°çš„æ€§è´¨ï¼Œä¸è®²è§£è¯æ˜æ˜¯<del>å› ä¸ºæˆ‘ä¹Ÿä¸ä¼šï¼Œå®é™…ä¸Šæ˜¯å› ä¸ºæ‡’</del></strong></p><hr><h4 id="Note-3-æ¨¡-p-å¹³æ–¹å‰©ä½™"><a href="#Note-3-æ¨¡-p-å¹³æ–¹å‰©ä½™" class="headerlink" title="Note 3:æ¨¡$p$å¹³æ–¹å‰©ä½™"></a>Note 3:æ¨¡$p$å¹³æ–¹å‰©ä½™</h4><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼š$3^2 \equiv 2 \mod 7$ï¼Œæ‰€ä»¥$âˆƒ x\in Z_7^*$ï¼Œä½¿å¾—$x^2\equiv 2 \mod 7$æœ‰è§£ï¼Œæ­¤æ—¶æˆ‘ä»¬ç§°$2$æ˜¯æ¨¡$7$çš„äºŒæ¬¡å‰©ä½™</p><p><strong>æ€§è´¨1ï¼šå¾ˆæ˜¾ç„¶åœ¨æ™®é€šçš„ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ä¸­ï¼Œ$x^2&#x3D;a^2$æœ‰ä¸¤è§£$a$å’Œ$-a$ï¼Œæ‰€ä»¥è§£æ–¹ç¨‹$x^2\equiv 2 \mod 7$ä¹Ÿæœ‰ä¸¤è§£ä¸º$3$å’Œ$-3$ï¼ˆä¹Ÿå°±æ˜¯$4$ï¼Œå› ä¸º$-3 \equiv 4 \mod7$ï¼‰ã€‚ç”±æ­¤å¯è§$x^2\equiv (p-x)^2 \mod p$(ç›´æ¥å±•å¼€å³å¯è¯æ˜å…¶æ­£ç¡®æ€§)</strong></p><p>æˆ‘ä»¬å¯ä»¥ç»§ç»­çœ‹ï¼šåœ¨$Z_7^*$é‡Œé¢çš„$6$ä¸ªæ•°çš„å¹³æ–¹åˆ†åˆ«ä¸º$1,4,2,2,4,1$ã€‚æ‰€ä»¥$1,2,4$æ˜¯æ¨¡$7$æ„ä¹‰ä¸‹çš„äºŒæ¬¡å‰©ä½™ï¼Œ$3,5,6$ä¸æ˜¯æ¨¡$7$çš„äºŒæ¬¡å‰©ä½™</p><p><em><em>æ€§è´¨2ï¼šå¯ä»¥è¯æ˜ï¼Œå¯¹äºä»»ä½•è´¨æ•°$p$ï¼Œåœ¨$Z_p^</em>$ä¸­ï¼Œæ€»æ˜¯æœ‰ä¸€åŠçš„æ•°æ˜¯æ¨¡$p$çš„äºŒæ¬¡å‰©ä½™ï¼Œä¹Ÿæ€»æœ‰ä¸€åŠçš„æ•°ä¸ºæ¨¡$p$çš„äºŒæ¬¡éå‰©ä½™</em>*</p><p>æˆ‘ä»¬è®°$\mathrm{\mathrm{QR}}$ä¸ºäºŒæ¬¡å‰©ä½™ï¼Œ$\mathrm{\mathrm{NR}}$ä¸ºäºŒæ¬¡éå‰©ä½™ï¼Œåœ¨æ¨¡$7$æ„ä¹‰ä¸‹ï¼Œ$\mathrm{QR}&#x3D;{1,2,4},\mathrm{NR}&#x3D;{3,5,6}$ã€‚è§‚å¯Ÿä¸‹åˆ—ç­‰å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æ€§è´¨3</p><p>ï¼ˆ1ï¼‰$2Ã—4\equiv 1 \mod 7$   (2)$3Ã—4\equiv 5 \mod 7$   (3)$3Ã—5\equiv 1 \mod 7$</p><p><strong>æ€§è´¨3ï¼š$\mathrm{QR}Ã—\mathrm{QR}&#x3D;\mathrm{QR}$,$\mathrm{QR}Ã—\mathrm{NR}&#x3D;\mathrm{NR}$,$\mathrm{NR}Ã—\mathrm{NR}&#x3D;\mathrm{QR}$</strong></p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç±»æ¯”$1$å’Œ$-1$ä¸¤ä¸ªæ•°ï¼Œå°†$\mathrm{\mathrm{QR}}$ç†è§£æˆ$1$ï¼Œ$\mathrm{\mathrm{NR}}$ç†è§£æˆ$-1$ï¼Œ</p><p>æ‰€ä»¥æˆ‘ä»¬å¼•å…¥å‹’è®©å¾·ç¬¦å·$(\frac{a}{b})$ï¼Œæ„ä¹‰ä¸º$a$æ˜¯å¦ä¸ºæ¨¡$b$æ„ä¹‰ä¸‹çš„äºŒæ¬¡å‰©ä½™ï¼Œå¦‚æœæ˜¯ï¼Œè¯¥å€¼ä¸º$1$ï¼Œå¦‚æœä¸æ˜¯ï¼Œè¯¥å€¼ä¸º$-1$</p><p>ä¾‹å¦‚ï¼š$(\frac{4}{7})&#x3D;1,(\frac{3}{7})&#x3D;-1$</p><p><strong>æ€§è´¨4ï¼šæ ¹æ®æ€§è´¨2ï¼Œ3ä¸­çš„ç»“è®ºï¼Œæˆ‘ä»¬å¯ä»¥æ¨å‡ºä»¥ä¸‹å…¬å¼$(\frac{ab}{p})&#x3D;(\frac{a}{p})(\frac{b}{p})$</strong></p><p>ç”±äºä»»ä½•ä¸€ä¸ªæ•°éƒ½å¯ä»¥å†™æˆå‡ ä¸ªè´¨æ•°ä¹˜æ–¹çš„ä¹˜ç§¯ï¼Œè€Œå¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬åªç ”ç©¶$a,b$å‡ä¸ºå¥‡æ•°çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥ç ”ç©¶å‡ ä¸ªæ€§è´¨</p><hr><h4 id="Note-4-ä¸¤ä¸ªç‰¹æ®Šçš„æ•°ï¼š-1-å’Œ-2"><a href="#Note-4-ä¸¤ä¸ªç‰¹æ®Šçš„æ•°ï¼š-1-å’Œ-2" class="headerlink" title="Note 4:ä¸¤ä¸ªç‰¹æ®Šçš„æ•°ï¼š$-1$å’Œ$2$"></a>Note 4:ä¸¤ä¸ªç‰¹æ®Šçš„æ•°ï¼š$-1$å’Œ$2$</h4><p>è§‚å¯Ÿä»¥ä¸‹å¼å­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºæ€§è´¨5å’Œæ€§è´¨6</p><p>$(\frac{-1}{3})&#x3D;-1$ ï¼Œ$(\frac{-1}{5})&#x3D;1$ï¼Œ$(\frac{-1}{7})&#x3D;-1$ï¼Œ$(\frac{-1}{11})&#x3D;-1$ $(\frac{-1}{13})&#x3D;1$ $(\frac{-1}{17})&#x3D;1$ï¼Œ$(\frac{-1}{19})&#x3D;-1$</p><p>$(\frac{2}{3})&#x3D;-1$ï¼Œ$(\frac{2}{5})&#x3D;-1$ï¼Œ$(\frac{2}{7})&#x3D;1$ï¼Œ$(\frac{2}{11})&#x3D;-1$ï¼Œ$(\frac{2}{13})&#x3D;-1$ï¼Œ$(\frac{2}{17})&#x3D;1$ï¼Œ$(\frac{2}{19})&#x3D;-1$</p><p><strong>æ€§è´¨5ï¼šå¯¹äºè´¨æ•°$p$ï¼Œè‹¥$p\equiv 1 \mod 4$,åˆ™$(\frac{-1}{p})&#x3D;1$ã€‚è‹¥$p\equiv 3\mod 4$,åˆ™$(\frac{-1}{p})&#x3D;-1$ (åœ¨æ¨¡$4$æ„ä¹‰ä¸‹ï¼Œ$3$å¯ä»¥ç†è§£æˆ$-1$)</strong></p><p><strong>æ€§è´¨6ï¼šå¯¹äºè´¨æ•°$p$ï¼Œè‹¥$p\equiv 1 \mod 8$,æˆ–è€…$p\equiv 7 \mod 8$ï¼Œæœ‰$(\frac{-1}{p})&#x3D;1$ã€‚è‹¥$p\equiv 3\mod 8$æˆ–è€…$p\equiv 5 \mod 8$,åˆ™$(\frac{-1}{p})&#x3D;-1$</strong></p><hr><h4 id="Note-5ï¼šäºŒæ¬¡äº’åå¾‹"><a href="#Note-5ï¼šäºŒæ¬¡äº’åå¾‹" class="headerlink" title="Note 5ï¼šäºŒæ¬¡äº’åå¾‹"></a>Note 5ï¼šäºŒæ¬¡äº’åå¾‹</h4><p>æ€§è´¨4å¯ä»¥è¿›è¡Œæ¨å¹¿åˆ°å¤šä¸ªæ•´æ•°ç›¸ä¹˜ï¼Œå¯ä»¥éªŒè¯$(\frac{70}{41})&#x3D;(\frac{2}{41})(\frac{5}{41})(\frac{7}{41})$ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨é¢å¯¹è¾ƒå¤§æ•´æ•°çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨å› å¼åˆ†è§£ã€‚ç„¶è€Œé¢å¯¹ç‰¹åˆ«å¤§çš„æ•´æ•°çš„æ—¶å€™ï¼Œ<del>ä½ æƒ³æƒ³è¿™çœŸçš„å¯è¡Œ?RSAæ€ä¹ˆè§£é‡Šï¼Ÿ</del></p><p>ç±»æ¯”æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œç”±äº$\gcd(a,b)&#x3D;\gcd(b,a)$ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½ä¸èƒ½å°è¯•äº¤æ¢ä¸€ä¸‹ç¬¦å·ä¸­çš„åˆ†å­å’Œåˆ†æ¯<del>(å§‘ä¸”è¿™ä¹ˆè¯´å§ï¼Œå®é™…ä¸Šæ˜¯å¾ˆä¸è§„èŒƒçš„è¯´æ³•)</del>ï¼Œçœ‹çœ‹é‡Œé¢çš„æ€§è´¨å‘¢ï¼Ÿ</p><p><del>æ­¤å¤„ä¸å¤šä»‹ç»ï¼Œè‡ªå·±æ‰¾å‡ ä¸ªæ•°å­—å½’çº³å½’çº³å§ï¼Œç›´æ¥æ”¾ä¸Šç»“æœ</del>,$m,k\in Z$</p><p>**æ€§è´¨7ï¼š$(\frac{4k+1}{4m+1})&#x3D;(\frac{4m+1}{4k+1})$ ï¼Œ $(\frac{4k+3}{4m+1})&#x3D;(\frac{4m+1}{4k+3})$ ï¼Œ $(\frac{4k+3}{4m+3})&#x3D;-(\frac{4m+3}{4k+3})$ **</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸¤ä¸ªæ•°å­—å¦‚æœéƒ½æ¨¡$4$ç­‰äº$3$æ—¶ï¼Œäº¤æ¢åˆ†å­åˆ†æ¯è¦å˜å·ï¼Œå¦åˆ™å¯ä»¥ç›´æ¥äº¤æ¢,æ­¤å¤„è¿™é‡Œçš„ä¸¤ä¸ªå¥‡æ•°å¯ä»¥æ— æ‰€è°“æ˜¯è´¨æ•°è¿˜æ˜¯åˆæ•°ï¼Œåªè¦æ˜¯å¥‡æ•°å°±è¡Œäº†,å¦‚æœä¸ºå¶æ•°ï¼Œåˆ†è§£å‡ºæ‰€æœ‰çš„$2$å› å­</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚æˆ‘ä»¬è¦è®¡ç®—$(\frac{37603}{48611})$ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p><p>$(\frac{37603}{48611})&#x3D;-(\frac{48611}{37603})&#x3D;-(\frac{11008}{37603})&#x3D;-(\frac{2^8Ã—43}{37603})&#x3D;-(\frac{43}{37603})&#x3D;(\frac{37603}{43})&#x3D;(\frac{21}{43})&#x3D;(\frac{43}{21})&#x3D;(\frac{1}{21})&#x3D;1$</p><p>çº¦å®š$(\frac{1}{p})\equiv 1$</p><hr><p>è®²äº†è¿™ä¹ˆå¤šæ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™æ ·çš„åˆ¤æ–­ä»£ç ï¼š<strong>å¾ˆçŸ­ï¼Œä½†æ˜¯æŠ€æœ¯å«é‡éå¸¸é«˜</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">isqr</span>(<span class="hljs-params">x,p</span>):<br>    <span class="hljs-keyword">if</span> p==<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    sgn=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> x%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>:<br>        x=x//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> p%<span class="hljs-number">8</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">or</span> p%<span class="hljs-number">8</span>==<span class="hljs-number">5</span>:<br>            sgn=-sgn<br>    <span class="hljs-keyword">if</span> x&lt;p:<br>        _tmp=p<br>        p=x<br>        x=_tmp<br>        <span class="hljs-keyword">if</span> x%<span class="hljs-number">4</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">and</span> p%<span class="hljs-number">4</span>==<span class="hljs-number">3</span> :<br>            sgn=-sgn<br>    <span class="hljs-keyword">return</span> sgn*isqr(x%p,p)<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°ï¼šè¿™é“é¢˜çš„$y$å’Œ$g$éƒ½æ˜¯$p$çš„äºŒæ¬¡å‰©ä½™ï¼æ ¹æ®$y_1\equiv g^r \mod p$ï¼Œ$y_2\equiv my^r \mod p$ï¼Œ$D(y_1,y_2)&#x3D;y_2(y_1^k)$å’Œæ€§è´¨ 3 å¯çŸ¥ï¼šè¿™é‡Œçš„$m$å°±æ˜¯æ˜æ–‡ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦åˆ¤æ–­ä¸€ä¸‹<code>isqr(y1,p)*isqr(y2,p)</code>çš„å€¼æ˜¯$1$è¿˜æ˜¯$-1$ï¼Œå°±å¯ä»¥çŸ¥é“æ˜æ–‡æ˜¯å¦ä¸ºäºŒæ¬¡å‰©ä½™å€¼ï¼Œç„¶åå°±å¯ä»¥åˆ¤æ–­é‚£ä¸€ä½æ˜¯$0$è¿˜æ˜¯$1$äº†ã€‚</p><p>ä¸‹é¢æ”¾ä¸Šæ‰€æœ‰çš„ä»£ç ï¼Œæˆ‘ä»¬å‘ç°ç»™å‡ºæ¥äº†$350$ç»„æ•°å­—ï¼Œå¯ä»¥åˆ¤æ–­æœ€å‰é¢ç¼ºäº†$2$ä½$00$,flagä¸€å…±æ˜¯$44$ä½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> g,p,y<br><span class="hljs-keyword">from</span> c0s <span class="hljs-keyword">import</span> c0<br><span class="hljs-keyword">from</span> c1s <span class="hljs-keyword">import</span> c1<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">isqr</span>(<span class="hljs-params">x,p</span>):<br>    <span class="hljs-keyword">if</span> p==<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    sgn=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> x%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>:<br>        x=x//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">if</span> p%<span class="hljs-number">8</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">or</span> p%<span class="hljs-number">8</span>==<span class="hljs-number">5</span>:<br>            sgn=-sgn<br>    <span class="hljs-keyword">if</span> x&lt;p:<br>        _tmp=p<br>        p=x<br>        x=_tmp<br>        <span class="hljs-keyword">if</span> x%<span class="hljs-number">4</span>==<span class="hljs-number">3</span> <span class="hljs-keyword">and</span> p%<span class="hljs-number">4</span>==<span class="hljs-number">3</span> :<br>            sgn=-sgn<br>    <span class="hljs-keyword">return</span> sgn*isqr(x%p,p)<br>s=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">350</span>):<br>    a=isqr(c0[i],p)*isqr(c1[i],p)<br>    <span class="hljs-keyword">if</span> a==<span class="hljs-number">1</span>:<br>        s+=<span class="hljs-string">&quot;0&quot;</span><br>    <span class="hljs-keyword">elif</span> a==-<span class="hljs-number">1</span>:<br>        s+=<span class="hljs-string">&quot;1&quot;</span><br>s=<span class="hljs-string">&quot;00&quot;</span>+s<br>t=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>    t+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(s[<span class="hljs-number">8</span>*i:<span class="hljs-number">8</span>*i+<span class="hljs-number">8</span>],<span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(t)<br></code></pre></td></tr></table></figure><hr><h4 id="Note-6ï¼šè§£å‡ºé¢˜ç›®ä¹‹åçš„ä¸€äº›æ€è€ƒï¼š"><a href="#Note-6ï¼šè§£å‡ºé¢˜ç›®ä¹‹åçš„ä¸€äº›æ€è€ƒï¼š" class="headerlink" title="Note 6ï¼šè§£å‡ºé¢˜ç›®ä¹‹åçš„ä¸€äº›æ€è€ƒï¼š"></a>Note 6ï¼šè§£å‡ºé¢˜ç›®ä¹‹åçš„ä¸€äº›æ€è€ƒï¼š</h4><p>è¿™é“é¢˜$y$æ˜¯$p$äºŒæ¬¡å‰©ä½™,$g$ä¹Ÿæ˜¯äºŒæ¬¡å‰©ä½™ï¼Œæ‰€ä»¥è¿™é“é¢˜æœ‰å¾ˆå¤šæ€§è´¨å¯ä»¥åˆ©ç”¨ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå‡å¦‚$y$ä¸æ˜¯$p$çš„äºŒæ¬¡å‰©ä½™åˆä¼šæ˜¯æ€æ ·ä¸€ç§æƒ…å†µå‘¢ï¼Ÿ</p><p>åœ¨Am473urå¸ˆå‚…çš„å¯å‘ä¸‹ï¼Œæˆ‘å¾—å‡ºäº†è¿™æ ·çš„ç»“è®ºï¼š</p><p>å½“$y$ä¸æ˜¯$p$çš„äºŒæ¬¡å‰©ä½™æ—¶ï¼Œè¯´æ˜$g$å¿…å®šä¸æ˜¯$p$çš„äºŒæ¬¡å‰©ä½™ï¼Œæ ¹æ®$g^k\equiv y \mod p$å¯çŸ¥ï¼Œè¿™é‡Œçš„$k$å¿…å®šæ˜¯ä¸€ä¸ªå¥‡æ•°ã€‚</p><p>æ‰€ä»¥ï¼Œæ ¹æ®ä¹‹å‰çš„åŠ å¯†å‡½æ•°$D(y_1,y_2)&#x3D;y_2(y_1^k) \mod p \equiv m(g^k)^r(g^{kr})^{-1}\equiv m \mod p$ï¼Œç®€å•æ€è€ƒï¼Œæˆ‘å¯ä»¥å¾—åˆ°è¿™æ ·çš„ç»“æœï¼š</p><p>$y&#x3D;\mathrm{NR}$æ—¶ï¼š</p><p>è‹¥$y_1&#x3D;\mathrm{NR},y_2&#x3D;\mathrm{NR}\Rightarrow m&#x3D;\mathrm{QR}$</p><p>è‹¥$y_1&#x3D;\mathrm{NR},y_2&#x3D;\mathrm{QR}\Rightarrow m&#x3D;\mathrm{NR}$</p><p>è‹¥$y_1&#x3D;\mathrm{QR},y_2&#x3D;\mathrm{NR}\Rightarrow m&#x3D;\mathrm{NR}$</p><p>è‹¥$y_1&#x3D;\mathrm{QR},y_2&#x3D;\mathrm{QR}\Rightarrow m&#x3D;\mathrm{QR}$</p><p>æ‰€ä»¥ï¼Œæ— è®º$y$æ˜¯ä½•å€¼ï¼Œåªè¦æ±‚å‡º$(\frac{y_1}{p})(\frac{y_2}{p})$çš„å€¼ï¼Œè¿™å°±æ˜¯$(\frac m p)$çš„å‹’è®©å¾·ç¬¦å·äº†ã€‚</p><hr><p><strong>ç›®å‰ï¼Œè‡ªå·±çš„ã€Šæ·±å…¥æµ…å‡ºå¯†ç å­¦ã€‹è¿˜å‰©ä¸‹ç¬¬5ã€10ã€11ã€12ã€13äº”ç« æ²¡æ¥å¾—åŠçœ‹ï¼Œè¿™äº”ç« å¯ä»¥å¿«é€Ÿåœ°æµè§ˆä¸€éå„ç§æ–°çš„åŠ å¯†ç®—æ³•ï¼ŒCTFWIKIä¸Šä¹Ÿæœ‰å¾ˆå¤šæœ‰ç”¨çš„èµ„æºå€¼å¾—è¢«æˆ‘åˆ©ç”¨ï¼Œé¢„è®¡11æœˆ10æ—¥å¤§æ¦‚èƒ½å¤ŸæŠŠè¿™æœ¬ä¹¦ç»“æŸ<del>ï¼ˆ11æœˆçš„SET4å’ŒCET4å‹åŠ›è¿˜æ˜¯æœ‰ç‚¹å¤§çš„ï¼Œè™½ç„¶å­¦é•¿ä»¬å‘Šè¯‰æˆ‘SET4å’ŒCET4å¾ˆç®€å•ï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯å¸Œæœ›SET4èƒ½å¤Ÿæ‹¿åˆ°Bï¼ŒCET4è€ƒåˆ°470åˆ†ä»¥ä¸Šï¼‰ï¼Œå¹¶ä¸”åé¢è¿˜è¦å»ACMé‚£è¾¹ç©ç©ã€‚</del></strong></p><p><strong>å½“ã€Šæ·±å…¥æµ…å‡ºå¯†ç å­¦ã€‹çœ‹å®Œä¹‹åï¼Œå°±å¾—å¼€å§‹å­¦ä¹ æ•°å­¦çŸ¥è¯†äº†ï¼Œå‰è€…å‘Šè¯‰ä½ ä¸€äº›åŸºæœ¬åŠ å¯†ç®—æ³•ï¼Œåé¢å°±è¦æ‰¾å„ç±»ç®—æ³•ç»™å‡ºçš„æ€§è´¨ï¼Œè¿™æ ·æ‰èƒ½æ‰¾åˆ°æ¼æ´~è§£å†³é—®é¢˜</strong></p><p><strong>huangx607087å­¦ä¹ CTFç¬¬1é˜¶æ®µï¼Œç»“æŸã€‚ç¬¬2é˜¶æ®µï¼Œå¼€å§‹</strong></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PRNG MT Notes</title>
    <link href="/2020/10/26/MT/"/>
    <url>/2020/10/26/MT/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å…³äºPRNG-MT-çš„å­¦ä¹ ç¬”è®°"><a href="#huangx607087å…³äºPRNG-MT-çš„å­¦ä¹ ç¬”è®°" class="headerlink" title="huangx607087å…³äºPRNG MT çš„å­¦ä¹ ç¬”è®°"></a>huangx607087å…³äºPRNG MT çš„å­¦ä¹ ç¬”è®°</h1><h2 id="0x00-åšå®¢èƒŒæ™¯"><a href="#0x00-åšå®¢èƒŒæ™¯" class="headerlink" title="0x00 åšå®¢èƒŒæ™¯"></a>0x00 åšå®¢èƒŒæ™¯</h2><p> 9æœˆ25æ—¥åšå‡ºçš„0xCTFä¸Šçš„PRNG2ï¼Œä¸è¿‡é‚£é“é¢˜æºç ä¸å°å¿ƒè¢«æˆ‘åˆ æ‰äº†Orzï¼Œä¸€ä¸ªæœˆåä¼šå›é¡¾ä¸€ä¸‹ä¹‹å‰çš„ç¬”è®°ï¼Œè®°å½•è‡ªå·±å½“æ—¶çš„å­¦ä¹ è¿‡ç¨‹</p><h2 id="0x01-MTç®€ä»‹"><a href="#0x01-MTç®€ä»‹" class="headerlink" title="0x01 MTç®€ä»‹"></a>0x01 MTç®€ä»‹</h2><p>æ¢…æ£®æ—‹è½¬(Mersenne Twister)æ˜¯ä¸€ä¸ªPRNGä¼ªéšæœºæ•°å‘ç”Ÿç®—æ³•ï¼ŒåŸºäºæœ‰é™äºŒè¿›åˆ¶å­—æ®µä¸Šçš„çŸ©é˜µé€’å½’<del>ï¼ˆåæ­£æˆ‘ä¹Ÿä¸æ‡‚ï¼‰</del>ï¼Œå‘¨æœŸé«˜è¾¾$2^{17399}-1$</p><p>æ­¥éª¤ï¼š<br>1.è·å¾—åŸºç¡€çš„æ¢…æ£®æ—‹è½¬é“¾<br>2.å¯¹äºæ—‹è½¬é“¾è¿›è¡Œæ—‹è½¬ç®—æ³•<br>3.å¯¹äºæ—‹è½¬ç®—æ³•æ‰€å¾—ç»“æœè¿›è¡Œå¤„ç†<br>æ³¨:è¯¥ç®—æ³•çš„å®ç°è¿‡ç¨‹ä¸­å‚æ•°çš„é€‰å–ä¸»è¦å–å†³äºæ¢…æ£®ç´ æ•°</p><p>æ¶‰åŠå˜é‡ï¼š<br>$w$ ï¼šåŠ å¯†é•¿åº¦ï¼Œä»¥bitä¸ºå•ä½ï¼Œ$w$ä½æ•´æ•°ã€‚<br>$n$ ï¼šé€’å½’é•¿åº¦<br>$m$ï¼šå‘¨æœŸå‚æ•°ï¼Œç”¨äºç¬¬ä¸‰é˜¶æ®µçš„åç§»é‡<br>$a$ï¼šæ—‹è½¬çŸ©é˜µçš„å‚æ•°<br>$r$ï¼šä½ä½æ©ç ï¼Œå³ä½ä½è¦æå–çš„ä½æ•°<br>$f$ï¼šåˆå§‹åŒ–æ—‹è½¬é“¾æ‰€éœ€å‚æ•°<br>$b,c$ï¼šTGFSRçš„æ©ç <br>$s,t$ï¼šTGFSRçš„ä½ç§»é‡<br>$u,d,l$ é¢å¤–çš„æ¢…æ£®æ—‹è½¬æ‰€éœ€è¦çš„æ©ç å’Œä½ç§»é‡</p><h2 id="0x02-åŠ å¯†æ–¹æ³•"><a href="#0x02-åŠ å¯†æ–¹æ³•" class="headerlink" title="0x02 åŠ å¯†æ–¹æ³•"></a>0x02 åŠ å¯†æ–¹æ³•</h2><p>1.åˆå§‹åŒ–ï¼Œå°†ä¼ å…¥çš„seedå€¼èµ‹å€¼ç»™$ MT_0 $ä½œä¸ºåˆå€¼ï¼Œå¹¶é€’æ¨å¾—åˆ°æ—‹è½¬é“¾<br>é€’æ¨å¼ï¼š$MT_i&#x3D;fÃ—(MT_{i-1})$ xor $((MT_{i-1})&gt;&gt;(w-2))+i$</p><p>2.æ‰§è¡Œæ—‹è½¬ç®—æ³•<br>è¿æ¥$MT_{i}$çš„é«˜$w-r$ä½å’Œ$MT_{i+1}$çš„ä½$r$ä½ï¼Œè‹¥è¿™ä¸ªç»„åˆåçš„äºŒè¿›åˆ¶æ•°æœ«ä½ä¸º$0$ï¼Œå°†å…¶é™¤ä»¥$2$.ã€‚å¦åˆ™å°†è¿™ä¸ªæ•°é™¤ä»¥$2$åå†ä¸$a$è¿›è¡Œå¼‚æˆ–ã€‚å‡è®¾æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°çš„æ•°å­—ä¸º$P$<br>æ‰€ä»¥æˆ‘ä»¬çš„é€’æ¨å¼ä¸º$MT_i&#x3D;MT_{i+m}$ xor $P$</p><p>3.å¯¹äºæ—‹è½¬ç®—æ³•æ‰€å¾—ç»“æœè¿›è¡Œå¤„ç†ï¼š<br>è®¾$x$ä¸ºè¯¥åºåˆ—ä¸‹ä¸€ä¸ªå€¼ï¼Œ$y$æ˜¯ä¸€ä¸ªä¸´æ—¶çš„ä¸­é—´å˜é‡ï¼Œ$z$æ˜¯ç®—æ³•è¿”å›å€¼<br>ä»¥ä¸‹ä¸ºå¤„ç†è¿‡ç¨‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c++">y=x <span class="hljs-built_in">xor</span>((x&gt;&gt;u)&amp;d)<br>y=y <span class="hljs-built_in">xor</span>((y&lt;&lt;s)&amp;b)<br>y=y <span class="hljs-built_in">xor</span>((y&lt;&lt;t)&amp;c)<br>z=y <span class="hljs-built_in">xor</span>(y&gt;&gt;l)<br></code></pre></td></tr></table></figure><h2 id="0x03-è§£å¯†æ–¹æ³•"><a href="#0x03-è§£å¯†æ–¹æ³•" class="headerlink" title="0x03 è§£å¯†æ–¹æ³•"></a>0x03 è§£å¯†æ–¹æ³•</h2><p><strong>è§£å¯†å…³é”®ï¼šæ±‚å‡ºä¸€ä¸ªå‘¨æœŸå†…çš„å…¨éƒ¨å†…å®¹ï¼Œç„¶åå°±å¯ä»¥é¡ºæ¨å¾—å‡ºå‰é¢æ‰€æœ‰çš„æƒ…å†µäº†</strong></p><p>é€†å‘å¤„ç†ã€‚åŠ å¯†ä¸€å…±$4$æ­¥ï¼Œéƒ½æ˜¯å¼‚æˆ–è¿ç®—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™å‡ºé€†ç®—æ³•</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹åŠ å¯†çš„æœ€åä¸€æ­¥ï¼š<code>z=y xor (y&gt;&gt;l)</code>ï¼Œå¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸€æ“ä½œæ—¶ä¸å½±å“$y$çš„æœ€é«˜$l$ä½çš„ï¼Œæ‰€ä»¥$z$çš„æœ€é«˜$l$ä½å°±æ˜¯$y$çš„æœ€é«˜$l$ä½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡$y&gt;&gt;l$çš„é«˜$2l$ä½ï¼ˆæœ€é«˜$l$ä½å…¨æ˜¯$0$ï¼‰ï¼Œä»è€Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$y$çš„$2l$ä½ï¼Œè¿›è€Œå¾—åˆ°$y&gt;&gt;l$çš„é«˜$3l$ä½â€¦â€¦.</p><p>ä¸Šé¢çš„å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œåœ¨æ­¤ä¸¾ä¸ªä¾‹å­ï¼š</p><p>$y&#x3D;10110110_b,t&#x3D;10011011_b,l&#x3D;2,y&#x2F;4&#x3D;00101011_b$ï¼ˆå·²çŸ¥é‡åªæœ‰$t,l$ï¼‰</p><p>æ ¹æ®$t$çš„é«˜$2$ä½ï¼Œæˆ‘ä»¬çŸ¥é“$y$çš„é«˜$2$ä½ä¸º$10_b$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$y&#x2F;4$çš„é«˜$4$ä½ä¸º$0010_b$ï¼Œç”±äº$y$çš„é«˜$4$ä½å¼‚æˆ–$y&#x2F;4$çš„é«˜$4$ä½å¯ä»¥å¾—åˆ°$t$çš„é«˜$4$ä½ï¼Œæ‰€ä»¥$y$çš„é«˜$4$ä½å¯ä»¥ç®—å‡ºæ¥,è¿›è€Œæˆ‘ä»¬å°±å¯ä»¥ç®—æ³•å‡º$y$çš„é«˜$6$ä½äº†â€¦â€¦</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠç¬¬4æ­¥é€†å‡ºæ¥äº†ã€‚</p><p>å…³äºé€†å‡ºç¬¬3æ­¥ï¼Œ$y_1&#x3D;y$ xor$((y&lt;&lt;t)$&amp;$c)$ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼š$y_1$çš„ä½$t$ä½å°±æ˜¯$y$çš„ä½$t$ä½å¼‚æˆ–$c$çš„ä½$t$ä½æ±‚å‡ºæ¥çš„ç»“æœï¼Œæ‰€ä»¥$y_1$çš„ä½$t$ä½ä¸$c$çš„ä½$t$ä½å¼‚æˆ–ä»¥ä¸‹å³ä¸º$y$çš„ä½$t$ä½ï¼Œè¿›è€Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$(y&lt;&lt;t)$çš„ä½$2t$ä½ï¼Œæ¨¡ä»¿ä¸Šé¢çš„æ–¹æ³•å¾—åˆ°$y$çš„æ‰€æœ‰ä½</p><p>ç¬¬2æ­¥å’Œç¬¬1æ­¥åˆ†åˆ«äºç¬¬3æ­¥å’Œç¬¬4æ­¥åŒç†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ”¾ä¸Šè§£å¯†è„šæœ¬<del>ï¼ˆè¿™ä¹ˆå¥½çš„ä»£ç å½“ç„¶ä¸æ˜¯æˆ‘è¿™ä¸ªfwèƒ½å†™å‡ºæ¥çš„ï¼‰</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># right shift inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right</span>(<span class="hljs-params">res, shift, bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>        tmp = res ^ tmp &gt;&gt; shift<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-comment"># right shift with mask inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right_mask</span>(<span class="hljs-params">res, shift, mask, bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>        tmp = res ^ tmp &gt;&gt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-comment"># left shift inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left</span>(<span class="hljs-params">res, shift, bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>        tmp = res ^ tmp &lt;&lt; shift<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-comment"># left shift with mask inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left_mask</span>(<span class="hljs-params">res, shift, mask, bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits // shift):<br>        tmp = res ^ tmp &lt;&lt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_number</span>(<span class="hljs-params">y</span>):<br>    y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>    y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>    <span class="hljs-keyword">return</span> y&amp;<span class="hljs-number">0xffffffff</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover</span>(<span class="hljs-params">y</span>):<br>    y = inverse_right(y,<span class="hljs-number">18</span>)<br>    y = inverse_left_mask(y,<span class="hljs-number">15</span>,<span class="hljs-number">4022730752</span>)<br>    y = inverse_left_mask(y,<span class="hljs-number">7</span>,<span class="hljs-number">2636928640</span>)<br>    y = inverse_right(y,<span class="hljs-number">11</span>)<br>    <span class="hljs-keyword">return</span> y&amp;<span class="hljs-number">0xffffffff</span><br><span class="hljs-built_in">print</span>(recover(<span class="hljs-number">0xf1c680f8</span>))<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">for i in s:</span><br><span class="hljs-string">    print(recover(i))</span><br><span class="hljs-string"></span><br><span class="hljs-string">y = extract_number(o)</span><br><span class="hljs-string">print(&#x27;y=&#x27;,y,&#x27;o=&#x27;,o)</span><br><span class="hljs-string">print(recover(y) == o)</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>MT32çš„ä¸€äº›åŸºæœ¬å±æ€§ï¼š<br>$(w,n,m,r)&#x3D;(32,624,397,31)$<br>$(a,f)&#x3D;(9908B0DF_h,1812433253)$<br>$(u,d,s,b,t,c)&#x3D;(11,FFFFFFFF_h,7,9D2C5680_h,15,EFC60000_h)$<br>$l&#x3D;18$</p><h2 id="0x04-å…·ä½“é¢˜ç›®ä¸­åˆ†æ"><a href="#0x04-å…·ä½“é¢˜ç›®ä¸­åˆ†æ" class="headerlink" title="0x04 å…·ä½“é¢˜ç›®ä¸­åˆ†æ"></a>0x04 å…·ä½“é¢˜ç›®ä¸­åˆ†æ</h2><p><strong>0xCTF PRNG2è¯¦è§£</strong></p><p>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹æºä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">assert</span> flag[:<span class="hljs-number">6</span>] == <span class="hljs-string">&quot;0xCTF&#123;&quot;</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MT</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        <span class="hljs-variable language_">self</span>.state = [seed]+[<span class="hljs-number">0</span>]*<span class="hljs-number">23</span><br>        <span class="hljs-variable language_">self</span>.flag = <span class="hljs-number">0</span><br>        <span class="hljs-variable language_">self</span>.srand()<br>        <span class="hljs-variable language_">self</span>.generateNumbers()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">srand</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">23</span>):<br>            <span class="hljs-variable language_">self</span>.state[i+<span class="hljs-number">1</span>] = <span class="hljs-number">1812433253</span> *  (<span class="hljs-variable language_">self</span>.state[i] ^ (<span class="hljs-variable language_">self</span>.state[i] &gt;&gt; <span class="hljs-number">27</span>)) - i<br>            <span class="hljs-variable language_">self</span>.state[i+<span class="hljs-number">1</span>] &amp;= <span class="hljs-number">0xffffffff</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generateNumbers</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">24</span>):<br>            y = (<span class="hljs-variable language_">self</span>.state[i] &amp; <span class="hljs-number">0x80000000</span>) | (<br>                <span class="hljs-variable language_">self</span>.state[(i+<span class="hljs-number">1</span>) % <span class="hljs-number">24</span>] &amp; <span class="hljs-number">0x7fffffff</span>)<br>            temp = y &gt;&gt; <span class="hljs-number">1</span><br>            temp ^= <span class="hljs-variable language_">self</span>.state[(i + <span class="hljs-number">12</span>) % <span class="hljs-number">24</span>]<br>            <span class="hljs-keyword">if</span> y &amp; <span class="hljs-number">1</span>:<br>                temp ^= <span class="hljs-number">0x9908b0df</span><br>            <span class="hljs-variable language_">self</span>.state[i] = temp<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">getRandomBits</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.flag == <span class="hljs-number">24</span>:<br>            <span class="hljs-variable language_">self</span>.generateNumbers()<br>            <span class="hljs-variable language_">self</span>.flag = <span class="hljs-number">0</span><br>        bits = <span class="hljs-variable language_">self</span>.Next(<span class="hljs-variable language_">self</span>.state[<span class="hljs-variable language_">self</span>.flag])<br>        <span class="hljs-variable language_">self</span>.flag += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> long_to_bytes(bits)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Next</span>(<span class="hljs-params">self, tmp</span>):<br>        tmp ^= (tmp &gt;&gt; <span class="hljs-number">11</span>)<br>        tmp ^= (tmp &lt;&lt; <span class="hljs-number">7</span>) &amp; <span class="hljs-number">0x9d2c5680</span><br>        tmp ^= (tmp &lt;&lt; <span class="hljs-number">15</span>) &amp; <span class="hljs-number">0xefc60000</span><br>        tmp ^= (tmp &gt;&gt; <span class="hljs-number">18</span>)<br>        <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Encrypt</span>(<span class="hljs-params">key, char</span>):<br>    key = bytes_to_long(key)<br>    temp = <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-built_in">ord</span>(char), <span class="hljs-number">65537</span>, <span class="hljs-number">2</span>**<span class="hljs-number">8</span>-<span class="hljs-number">1</span>) ^ key)[<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">32</span>-<span class="hljs-built_in">len</span>(temp))+temp<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    mt = MT(getRandomNBitInteger(<span class="hljs-number">32</span>))<br>    c = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>        c += Encrypt(<span class="hljs-string">b&#x27;&#x27;</span>.join([mt.getRandomBits() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]), flag[i])<br>    <span class="hljs-built_in">print</span>(c)<br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜å¯¹æ ‡å‡†çš„MTè¿›è¡Œä¸€ä¸‹åˆ†æï¼šä¸æ ‡å‡†ç®—æ³•ç›¸æ¯”ï¼Œåªæœ‰$n$çš„å€¼ä»$624$å˜æˆäº†$24$ã€‚</p><p>ç„¶è€Œä¸€ä¸ªå¾ˆæ˜¾ç„¶çš„äº‹å®æ˜¯ï¼š<del>æˆ‘è¿™ä¸ªå¯†ç å­¦fwæ ¹æœ¬çœ‹ä¸æ‡‚è¿™ä¹ˆé•¿çš„ä»£ç ï¼Œæ€ä¹ˆåŠï¼Ÿ</del>ç­”æ¡ˆå½“ç„¶æ˜¯é è¾“å‡ºæ¥è°ƒè¯•è°ƒè¯•ç¨‹åºç©¶ç«Ÿæ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚é€šè¿‡åŠ è¿è¡Œå¯ä»¥çœ‹åˆ°ï¼šå¯¹äºæ¯ä¸€ä½å­—ç¬¦ï¼Œè¿™ä¸ªå¤„ç†å™¨ä¼šå¤„ç†$4$æ¬¡ï¼Œç„¶è€Œæ¯ä¸€æ¬¡ï¼Œä¼šå¯¹ç¬¬$4$æ¬¡æ±‚å‡ºçš„ç»“æœè¿›è¡Œå¼‚æˆ–ã€‚ã€‚</p><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªå¾ˆé•¿çš„$c$å­—ç¬¦$16$è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨C++ç­‰å·¥å…·ï¼ŒæŠŠå­—ç¬¦ä¸²$c$åˆ†ä¸º$8$ä½ä¸€å°ç»„(æ¯ç»„åˆšå¥½æ˜¯$32$ä½äºŒè¿›åˆ¶æ•°)ï¼Œ$4$å°ç»„ä»¥å¤§ç»„ã€‚æ ¹æ®ä»£ç è°ƒè¯•åˆ†æä¸€ä¸‹ï¼Œæ¯ä¸€å¤§ç»„çš„æœ€åä¸€ä¸ªæ•°å­—ä¸æ˜æ–‡å¯¹åº”çš„å­—ç¬¦è¿›è¡Œäº†å¼‚æˆ–æ“ä½œï¼Œæ‰€ä»¥å¯¹äºè¿™$6$ä¸ªæ•°å­—æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Win10è‡ªå¸¦çš„è®¡ç®—æœº(æˆ–è€…æ‰‹æ“)ï¼Œå¯ä»¥å¾—åˆ°å¼‚æˆ–å‰çš„æ•°å­—ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºæœ€åè¾“å‡ºçš„bytes</p><p>ä¾‹å¦‚ï¼šç¬¬ä¸€è¡Œæœ€åä¸€ä¸ªæ•°ä¸º$617d7a88_h$æˆ‘ä»¬å¯ä»¥æ ¹æ®ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸º<code>&#39;0&#39;</code>ï¼Œæ¨æ–­å‡ºç¬¬ä¸€æ¬¡å¼‚æˆ–çš„å†…å®¹ä¸º$30_h$ï¼Œè¿›è€Œå¾—åˆ°å¼‚æˆ–å‰çš„byteså€¼ä¸º$617d7aB8_h$</p><p>æ ¹æ®é¢˜ç›®assertå†…å®¹ï¼Œæˆ‘ä»¬çŸ¥é“äº†å­—ç¬¦ä¸²å‰$6$ä½ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸Šè„šæœ¬è€ƒè™‘æ¢å¤åŸæ¥çš„å¯„å­˜å™¨å†…éƒ¨çš„$24$ä½ã€‚</p><p>åœ¨è¿™é‡Œæœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼š$x^{65537} \equiv x\mod 255$.å› ä¸º$\phi(255)&#x3D;128$ï¼Œæ‰€ä»¥æ ¹æ®è´¹é©¬å°å®šç†æœ‰$x^{65536}\equiv 1\mod 255$ï¼Œè¿™ä¸ªç»“è®ºæˆ‘ä»¬å°±æ¨å‡ºæ¥äº†ã€‚</p><p>æŠŠæˆ‘ä»¬åˆ†å‰²å‡ºæ¥çš„å‰$24$ä¸ªå¹¶è¿›è¡Œç®€å•å¤„ç†è¿‡çš„åå…­è¿›åˆ¶æ•°ä»£å…¥ä¸Šé¢çš„æ±‚é€†è„šæœ¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ç¬¬ä¸€ç»„å¯„å­˜å™¨å†…çš„å†…å®¹äº†ã€‚</p><p>ç®€å•åœ°æ”¹ä¸€ä¸‹ä»£ç åˆå§‹åŒ–éƒ¨åˆ†ï¼Œåˆ å»<code>__init__</code>ä¸­çš„srandå’Œ<code>generateNumbers</code>ã€‚æŠŠåˆå§‹åŒ–çš„<code>seed</code>å‚æ•°å’Œä¸»å‡½æ•°ä¸­çš„<code>getRandomNBitInteger(32)</code>åˆ å»ã€‚ç„¶åæ¯æ¬¡è¾“å‡º<code>mt.getRandomBits()</code>ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸ªè§£ï¼ˆæ¨è$4$ä¸ªä¸€è¡Œï¼Œä»¥$16$è¿›åˆ¶è¾“å‡ºï¼‰</p><p>å¦‚æœä½ æ˜¯æŒ‰ç…§æ¨èçš„åšæ³•åšçš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€ä¸ªä¸€ä¸ªæ¯”å¯¹ä¸€ä¸‹(å·¦è¾¹ä¸ºç¨‹åºè¾“å‡ºç»“æœï¼Œå³è¾¹ä¸ºç»™å‡ºæ¥çš„æ•°å€¼)ï¼Œæ­¤å¤„ä¸ºç¨‹åºè¾“å‡ºä¸ç»™å‡ºæ•°å€¼ç¬¬$7$åˆ°ç¬¬$9$è¡Œçš„æ¯”è¾ƒã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a46e5465</span> <span class="hljs-number">533477</span>c6 <span class="hljs-number">3</span>f7f5649 cc96ec79 | a46e5465 <span class="hljs-number">533477</span>c6 <span class="hljs-number">3</span>f7f5649 cc96ec49<br><span class="hljs-attribute">8bebeb18</span> c6f90a3c <span class="hljs-number">38</span>ff0c8a <span class="hljs-number">0837182</span>e | <span class="hljs-number">8</span>bebeb18 c6f90a3c <span class="hljs-number">38</span>ff0c8a <span class="hljs-number">0837181</span>b<br><span class="hljs-attribute">31ba3fa7</span> efaee340 f9b70a82 a6fafa6f | <span class="hljs-number">31</span>ba3fa7 efaee340 f9b70a82 a6fafa57<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œæ­£å¦‚æˆ‘ä»¬é¢„æœŸï¼šæœ€åçš„ä¸€ä¸ªæ•°å­—ä¸ä¸€æ ·ï¼Œå¹¶ä¸”åˆšå¥½æœ‰ç‚¹ç•¥å¾®çš„å·®åˆ«ï¼Œè¿™å°±è¯´æ˜è¿™æ˜¯ä¸ªè·ŸæŸä¸ªæ•°å¼‚æˆ–è¿‡çš„ç»“æœï¼Œè€Œé‚£ä¸ªæ•°ï¼Œæ°å¥½å°±æ˜¯é‚£ä¸€ä½å­—ç¬¦çš„ASCIIç å€¼ã€‚æˆ‘ä»¬åªéœ€è¦ç”¨C++çš„<code>freopen</code>æå–å‡ºä¸¤å¤„çš„ç¬¬$4$ä½ï¼Œç„¶åå¼‚æˆ–ä¸€ä¸‹å°±å¾—å‡ºç»“æœäº†(å¦‚æœä½ ç”¨çš„C++åŠ¡å¿…æŠŠæ•°å€¼ç±»å‹è®¾ç½®æˆ<code>unsigned</code>è€Œä¸æ˜¯<code>int</code>ï¼Œä¸ç„¶åå…­è¿›åˆ¶ä¸­å¤§äºç­‰äº$80000000_h$ä¼šè¢«æ ‡è®°ä¸ºè´Ÿæ•°ï¼Œå¯¼è‡´å¼‚æˆ–ç»“æœå‡ºé”™)</p><p>æœ€åå¼‚æˆ–å®Œæˆçš„ç»“æœå°±æ˜¯flagã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0xGameDiv3</title>
    <link href="/2020/10/22/0xGameDiv3/"/>
    <url>/2020/10/22/0xGameDiv3/</url>
    
    <content type="html"><![CDATA[<h1 id="0xGame-Div-3-é¢˜è§£"><a href="#0xGame-Div-3-é¢˜è§£" class="headerlink" title="0xGame Div 3 é¢˜è§£"></a>0xGame Div 3 é¢˜è§£</h1><h2 id="About"><a href="#About" class="headerlink" title="About"></a>About</h2><p>ç¬¬ä¸‰å‘¨ï¼Œå¯†ç å­¦éš¾åº¦è¿˜å¯ä»¥ï¼Œå‰2é¢˜éš¾åº¦ä¸å¤§ï¼Œç¬¬3é¢˜éš¾åº¦æœ‰ç‚¹å¤§ï¼Œä¸è¿‡è¿˜æ˜¯èƒ½å¤Ÿç”¨ä¸€å¤©çš„æ—¶é—´åˆ‡å‡ºæ¥äº†ã€‚ä¸è¿‡ç¬¬ä¸‰å‘¨ç»“æŸè¿˜æ²¡æœ‰åˆ°è¾¾åˆ°7000åˆ†ï¼Œ<del>ç¬¬ä¸€å‘¨å°±æœ‰å¾ˆå¤šå…¨æ ˆå¤§ä½¬7000äº†ï¼Œæˆ‘è¿˜æ²¡ä»–ä»¬1&#x2F;3çš„æ•ˆç‡é«˜ã€‚</del>çœ‹æ¥å¥–åŠ±æ‹¿ä¸åˆ°äº†ã€‚ã€‚</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="1-signinRSA"><a href="#1-signinRSA" class="headerlink" title="1. signinRSA"></a>1. signinRSA</h3><p>è¿™é“é¢˜çœ‹åˆ°æ—¶ç­¾åˆ°é¢˜ï¼Œè¯»äº†ä¸€ä¸‹ä»£ç ï¼Œè¿™è·Ÿä¸Šä¸€å‘¨çš„<strong>parityOracle</strong>ç«Ÿç„¶æœ‰$99$%çš„ç›¸ä¼¼ã€‚</p><p>ä¸å¤šè¯´ï¼Œç›´æ¥å¤åˆ¶ä¸Šå‘¨å†™å¥½çš„è„šæœ¬ ,æ”¹ä¸€ä¸‹ncåœ°å€ï¼ŒæŠŠä¸Šå‘¨è„šæœ¬çš„å€’æ•°ç¬¬$8$è¡Œçš„<code>recnum=int(recnum[-1])</code>æ”¹ä¸º<code>recnum=int(recnum[-1],16)</code>ï¼Œç„¶åæŠŠå€’æ•°ç¬¬$7$è¡Œå’Œå€’æ•°ç¬¬$5$è¡Œçš„å¯¹recnumçš„åˆ¤æ–­åŠ ä¸Š%$4$æ“ä½œï¼ˆå¦‚ä¸‹ï¼‰ï¼Œç›´æ¥è¿è¡Œï¼Œå‡ åˆ†é’Ÿå°±å‡ºç»“æœäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> recnum%<span class="hljs-number">4</span>==<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> recnum%<span class="hljs-number">4</span>==<span class="hljs-number">3</span>:<br>L=M+<span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> recnum%<span class="hljs-number">4</span>==<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> recnum%<span class="hljs-number">4</span>==<span class="hljs-number">2</span>:<br>R=M-<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="2-easyRSA"><a href="#2-easyRSA" class="headerlink" title="2.easyRSA"></a>2.easyRSA</h3><p>å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>m = bytes_to_long(flag.encode())<br>e = <span class="hljs-number">65537</span><br>p, q = getPrime(<span class="hljs-number">1024</span>), getPrime(<span class="hljs-number">1024</span>)<br>d = inverse(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>x = <span class="hljs-number">11</span>*d+<span class="hljs-number">7</span>*(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>c = <span class="hljs-built_in">pow</span>(m, e, p*q)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>, p*q)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>, c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;x =&quot;</span>, x)<br><span class="hljs-comment">## ç»™å‡ºéƒ¨åˆ†ç•¥</span><br></code></pre></td></tr></table></figure><p>é¢˜ç›®ç»™å‡ºäº†$n,c,x$çš„å€¼ï¼ˆå½“ç„¶ä¹Ÿæœ‰$e&#x3D;65537$ï¼‰ï¼Œå…¶ä¸­$x&#x3D;11d+7\phi$ ï¼Œæ‰€ä»¥è¿™é“é¢˜ä¸åŒå¯»å¸¸ä¹‹å¤„å°±æ˜¯ç»™å‡ºäº†$x$,æ•…çªç ´å£åœ¨xå¤„ã€‚</p><p>é€šè¿‡ä¹‹å‰RSAä¸­ç›¸å…³çŸ¥è¯†å¯çŸ¥ï¼š$d$ æ˜¯$e$åœ¨æ¨¡$\phi$æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼Œä¹Ÿå°±æ˜¯$ed \equiv 1 \mod \phi$ ã€‚è€Œç”±äº$p,q$å‡ä¸ºè´¨æ•°ï¼Œæ‰€ä»¥$\phi&#x3D;(p-1)(q-1)$</p><p>æ—¢ç„¶é¢˜ç›®ç»™å‡º$x&#x3D;11d+7phi$ ï¼Œè€Œ$d,phi$å‡ä¸ºæœªçŸ¥é‡ã€‚æ‰€ä»¥æ ¹æ®æ–¹ç¨‹æ ¡å›­æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥ä¸¤è¾¹åŒä¹˜$d$ï¼Œå¾—åˆ°$ex&#x3D;11de+7e \phi$ ã€‚è¿™ä¸ªå¼å­å¯¹$\phi$å–æ¨¡ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$ex \equiv 11 \mod \phi$ï¼Œè¿™æ—¶å€™è¿™ä¸ªå¼å­ä»…å‰©ä¸‹ä¸€ä¸ªæœªçŸ¥æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æå‡º$\phi$ ï¼Œå¾—åˆ°$k\phi&#x3D;ex-11$</p><p>åœ¨$\phi&#x3D;(p-1)(q-1)&#x3D;pq-p-q+1&#x3D;n-p-q+1$ï¼Œç”±äº$p,q$å‡ä¸º$1024$ä½ï¼Œ$n$ä¸º$2047$ä½ï¼Œè¿œè¿œå¤§äº$p+q$ã€‚æ•…$\phi$çš„äºŒè¿›åˆ¶ä½æ•°è·Ÿ$n$åº”è¯¥åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œè®¡ç®—å¯çŸ¥ï¼Œ$phi$æ˜¯$2068$ä½ï¼Œæ‰€ä»¥$k$åº”å½“æ˜¯$21$ä½æˆ–è€…$22$ä½ï¼Œä¹Ÿå°±æ˜¯$kâˆˆ[2^{21},2^{22})$ã€‚</p><p>æˆ‘ä»¬ç”¨ä»¥ä¸‹è„šæœ¬æšä¸¾$k$ï¼Œç„¶åç›´æ¥è¿›è¡Œ<code>long_to_bytes</code> çš„æ“ä½œï¼Œè™½ç„¶æœ‰å¤§æ¦‚$50$å¤šç»„è§£ï¼Œç„¶è€Œæœ€åƒflagçš„åªæœ‰ä¸€ç»„ï¼Œæ•…æˆ‘ä»¬å°±å¾—åˆ°äº†flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> given <span class="hljs-keyword">import</span> n,x,e,c<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">T</span>):<br>    tot=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">20</span>,<span class="hljs-number">2</span>**<span class="hljs-number">22</span>):<br>        <span class="hljs-keyword">if</span> T%i==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> T//i%<span class="hljs-number">2</span>^<span class="hljs-number">1</span> :<br>            P=T//i<br>            d=inverse(e,P)<br>            <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br>T=e*x-<span class="hljs-number">11</span><br>solve(T)<br><br></code></pre></td></tr></table></figure><h3 id="3-paddingOracle"><a href="#3-paddingOracle" class="headerlink" title="3. paddingOracle"></a>3. paddingOracle</h3><p>åˆæ˜¯ä¸€é“Oracleï¼Œæƒ³åˆ°ä¸Šä¸€æ¡Oracleæˆ‘æäº†å¥½ä¹…&#x3D; &#x3D;ã€‚æœç„¶ï¼Œä¸Šé¢˜12å°æ—¶ï¼Œè¿˜æ²¡äººåšå‡ºæ¥ã€‚ä¸Šé¢˜18å°æ—¶åï¼Œæ‰æœ‰äººæ‹¿ä¸€è¡€ã€‚<del>æˆ‘å°±æ¯”è¾ƒé€Šäº†ã€‚ä¸Šé¢˜35å°æ—¶æ‰æŠŠ2è¡€æ‹¿åˆ°ã€‚æ„Ÿè§‰åé¢å¯†ç å­¦é¢˜ç›®ä¼šè¶Šæ¥è¶Šéš¾çš„æ ·å­ï¼Œawsl</del></p><p>ç®€å•åœ°çœ‹äº†ä¸€ä¸‹ç›¸å…³èµ„æ–™ï¼Œ<del>ç„¶è€Œæœ¬äººå¤ªèœï¼Œè¿ä¹¦éƒ½çœ‹ä¸æ‡‚</del>ï¼Œæœ€åæ‘¸ç´¢äº†12å°æ—¶æ‰ææ‡‚é¢˜ç›®æ„æ€ï¼Œå°±è®©æˆ‘ç”¨<del>ç®€æ´</del>çš„è¯­è¨€è®²ä¸€ä¸‹è¿™é“é¢˜çš„æ„æ€å§</p><p>é¦–å…ˆï¼ŒæœåŠ¡å™¨ä¼šç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º$32$ä½çš„$16$è¿›åˆ¶æ•°ä¸ºåˆå§‹å‘é‡ï¼Œç„¶åå†ç»™ä½ $32k$ä¸ª$16$è¿›åˆ¶æ•°ä¸ºå¯†æ–‡ï¼ˆæœ¬é¢˜ä¸­$k&#x3D;3$ï¼Œä¹Ÿå°±æ˜¯ä¸€å…±$96$ä½ï¼‰ã€‚æœ‰äº›é¢˜ç›®å®ƒç›´æ¥ç»™ä½ ä¸€ä¸ª$32(k+1)$ä½çš„$16$è¿›åˆ¶æ•°ï¼Œè¿™ä¸ªæ—¶å€™å°±é»˜è®¤æœ€å‰é¢$32$ä½ä¸ºåˆå§‹å‘é‡ï¼Œåé¢çš„$32k$ä½ä½œä¸ºå¯†æ–‡ã€‚</p><p>å¾—åˆ°åˆå§‹å‘é‡åï¼Œå°†å¯†æ–‡åˆ†ä¸º$k$ç»„ï¼Œæ¯ç»„$32$ä½ã€‚è®°åˆå§‹å‘é‡ä¸º$I_0$,åé¢çš„å¯†æ–‡ç»„ä¸º$I_1,I_2,I_3,â€¦,I_k$</p><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬è¿˜éœ€è¦$3$ä¸ª$16$ä½æ•°ç»„ï¼š$Clc$ã€$Tlc$å’Œ$Alc$ï¼Œåˆ†åˆ«ç”¨äºå­˜å‚¨æ¯ä¸€æ¬¡è§£å¯†çš„æšä¸¾å€¼ã€ä¸­é—´å€¼å’Œç ´è§£å‡ºæ¥çš„æ˜æ–‡</p><p>ç¬¬ä¸€è½®æšä¸¾ï¼Œæˆ‘ä»¬æšä¸¾$Clc$æœ€åä¸€ä¸ªæ•°å­—ä¹Ÿå°±æ˜¯$Clc_{15}$ï¼Œå½“æœåŠ¡å™¨è¿”å›successæ—¶ï¼Œè®¡ç®—$Tlc_{15}&#x3D;Clc_{15}$xor$1$çš„å€¼ï¼Œç„¶åè½®æ•°è¿›å…¥ç¬¬äºŒè½®ï¼Œç”¨$Tlc_{15}$æ›´æ–°$Clc_{15}$,ä¹Ÿå°±æ˜¯$Clc_{15}&#x3D;Tlc_{15}$ xor $2$ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šç¬¬$p$è½®æšä¸¾ï¼Œæˆ‘ä»¬æšä¸¾çš„å€¼æ˜¯$Clc_{16-p}$,ç”¨$Clc_{16-p}$æ›´æ–°$Tlc_{16-p}$ä¸º$Clc_{16-p}$ xor $p$ï¼Œç„¶åè½®æ•°è¿›å…¥$p+1$ï¼Œè¿™æ—¶<strong>æˆ‘ä»¬éœ€è¦ç”¨$Tlc_{16-p}$åŠå…¶ä»¥åæ‰€æœ‰è§£å‡ºæ¥çš„$Tlc$å»æ”¹å˜æ‰€æœ‰å·²çŸ¥çš„$Clc$å€¼ï¼Œä¹Ÿå°±æ˜¯æŠŠåé¢æ‰€æœ‰çš„$Clc$æ”¹ä¸º $Tlc$ xor $p+1$<strong>ã€‚æ¢å¥è¯è®²å°±æ˜¯è¯´</strong>$Tlc$è§£å‡ºæ¥ä¹‹åæ°¸è¿œä¸èƒ½å˜ï¼Œ$Clc$æ¯ä¸€æ¬¡è§£å‡ºæ¥ä»¥åä¼šè¢«ä¸æ–­æ›´æ–°ã€‚$Clc$æ›´æ–°$Tlc$,åªæ›´æ–°æœ€æ–°è§£å‡ºæ¥çš„ä¸€ä½ï¼Œ$Tlc$æ›´æ–°$Clc$ï¼Œéœ€è¦æ›´æ–°è§£å‡ºæ¥çš„æ‰€æœ‰$Clc$å†…å®¹</strong></p><p>ä¸Šé¢çš„è§£é‡Šå¯èƒ½æ¯”è¾ƒæŠ½è±¡ï¼Œé‚£æˆ‘å°±ç”¨ä¸‹é¢çš„ä¾‹å­æ¥è§£é‡Šä¸€ä¸‹å§(æ•°å­—ä¸‹æ ‡$h$è¡¨ç¤º$16$è¿›åˆ¶ï¼Œä¹Ÿå°±æ˜¯$14_h$çš„çœŸå®å€¼ä¸ºåè¿›åˆ¶çš„$20$ï¼š</p><p><strong>Round 0</strong></p><p>åˆå§‹çŠ¶æ€ï¼š</p><p>$Clc&#x3D;[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00]_h$</p><p>$Tlc&#x3D;[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00]_h$</p><p><strong>Round 1(æšä¸¾ $Clc_{15}$ )</strong></p><p>ç¬¬$1$è½®ï¼Œæˆ‘ä»¬æšä¸¾$Clc_{15}$çš„å€¼ï¼Œå‡è®¾æˆ‘ä»¬æšä¸¾åˆ°$Clc_{15}&#x3D;78_h$çš„æ—¶å€™æœåŠ¡å™¨å‘å›Success</p><p>é‚£ä¹ˆæ­¤æ—¶ï¼š$Clc&#x3D;[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,$<font color="red">$78$</font>]$_h$</p><p>ç”¨$Clc_{15}$æ›´æ–°$Tlc_{15}$ï¼Œ$Tlc_{15}&#x3D;Clc_{15}$ xor $1$ï¼ˆè½®æ•°ï¼‰$&#x3D;79_h$</p><p>$Tlc&#x3D;[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,$<font color="red">$79$</font>]$_h$</p><p><strong>Round 2(æšä¸¾$Clc_{14}$ )</strong></p><p>ç„¶åè¿›å…¥ç¬¬$2$è½®ï¼Œæˆ‘ä»¬é¦–å…ˆå¾—æ›´æ–°ä¸€ä¸‹$Clc_{15}$çš„å€¼ä¸º$Tlc_{15}$ xor $2&#x3D;7B_h$</p><p>æ­¤æ—¶$Clc$å‘ç”Ÿäº†å˜åŒ–ï¼š$Clc&#x3D;[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,$<font color="red">$7B$</font>]$_h$</p><p>ç„¶åæˆ‘ä»¬æšä¸¾$Clc_{14}$çš„å€¼ï¼Œå‡å¦‚æˆ‘ä»¬æšä¸¾åˆ°$Clc_{14}&#x3D;52_h$æ—¶æœåŠ¡å™¨è¿”å›Success</p><p>é‚£ä¹ˆæ­¤æ—¶ï¼š$Clc&#x3D;[00,00,00,00,00,00,00,00,00,00,00,00,00,00,$<font color="red">$52$</font>$,7B]_h$</p><p>ç”¨$Clc_{14}$æ›´æ–°$Tlc_{14}$ï¼Œ$Tlc_{14}&#x3D;Clc_{14}$ xor $2$ï¼ˆè½®æ•°ï¼‰$&#x3D;50_h$</p><p>æ­¤æ—¶çš„$Tlc$ï¼š$Tlc&#x3D;[00,00,00,00,00,00,00,00,00,00,00,00,00,00,$<font color="red">$50$</font>$,79]_h$</p><p><strong>Round 3(æšä¸¾$Clc_{13}$)</strong></p><p>è¿›å…¥ç¬¬$3$è½®ï¼Œæ­¤æ—¶ä¸€ä¸ªæ˜“é”™ç‚¹ï¼ˆæ•²é»‘æ¿ï¼‰å‡ºç°äº†ï¼š<strong>ç”±äºæ­¤æ—¶å·²ç»å‡ºæ¥äº†$Clc_{14}$å’Œ$Clc_{15}$ï¼Œç¬¬$3$è½®å¼‚æˆ–å€¼ä¸º$3$ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¯¹$Clc_{14}$å’Œ$Clc_{15}$éƒ½è¿›è¡Œå¼‚æˆ–$3$çš„æ“ä½œ</strong></p><p>æ­¤æ—¶ï¼š$Clc&#x3D;[00,00,00,00,00,00,00,00,00,00,00,00,00,00,$<font color="red">$53,78$</font>$]_h$,<strong>ä¸¤ä½éƒ½è¿›è¡Œäº†æ›´æ–°</strong></p><p>æ‰€ä»¥ä»¥ä¸Šæ“ä½œå°±æ˜¯æˆ‘ä»¬æ‰€è®²çš„ï¼š$Clc$æ›´æ–°$Tlc$ åªæ›´æ–°è¿™æ¬¡è§£å‡ºæ¥çš„<strong>ä¸€ä½</strong>ï¼Œè€Œ$Tlc$æ›´æ–°$Clc$ï¼Œéœ€è¦æ›´æ–°$Clc$ä¸­å·²ç»è§£å‡ºæ¥çš„<strong>æ‰€æœ‰</strong>$Clc$å€¼</p><p>$16$ä¸ª$Tlc$è§£å‡ºæ¥åï¼Œæœ¬è½®$Alc$å°±ç­‰äº$Tlc$ xor $I_{m-1}$($m$ä¸ºç¬¬$m$è§£å¯†)ã€‚ç„¶åé‡æ–°åˆå§‹åŒ–ï¼Œè¿›è¡Œä¸‹ä¸€å¤§è½®çš„è§£å¯†ã€‚$k$è½®è§£å¯†ç»“æŸï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†æ‰€æœ‰çš„æ˜æ–‡äº†ï¼ˆæ³¨æ„è¿‡æ»¤æ‰é‡Œé¢çš„æ— å…³å­—ç¬¦ï¼‰</p><p><del>è¿™ä¸ªè¯¥æ­»çš„è„šæœ¬å†™äº†æˆ‘98è¡Œï¼Œ7ä¸ªå­å‡½æ•°ã€‚è¿˜æ˜¯æ¯”è¾ƒçƒ¦äººçš„</del>ã€‚å› ä¸ºä¸€å¼€å§‹æ²¡è§„åˆ’å¥½å¯¼è‡´ä¸€ä¼šç”¨$16$ä½æ•°ç»„ï¼ˆæ¯ä¸ªæ­£æ•°ä¸è¶…è¿‡$255$ï¼‰ï¼Œä¸€ä¼šç”¨$32$ä½æ•°ç»„ï¼ˆæ¯ä¸ªæ­£æ•°ä¸è¶…è¿‡$15$ï¼‰ã€‚è™½ç„¶å†™èµ·æ¥ç®€å•ï¼Œä½†è¿˜æ˜¯<del>å‡å°‘äº†ä»£ç çš„å¯è¯»æ€§</del>ï¼Œç©¶å…¶åŸå› ï¼Œåªæœ‰ä¸€ä¸ªï¼š<del>ä½œä¸ºå¯†ç å­¦åºŸç‰©çš„æˆ‘å¤ªèœäº†</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyanzhengma</span>(<span class="hljs-params">s16len,s64len</span>):<br>LTSNMS=<span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s16len)==<span class="hljs-number">16</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(s64len)==<span class="hljs-number">64</span><br><span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">for</span> i4 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">if</span> sha256((i1+i2+i3+i4+s16len).encode()).hexdigest()==s64len:<br><span class="hljs-keyword">return</span> i1+i2+i3+i4<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Transnbs</span>(<span class="hljs-params">s</span>):<br>T=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>T[i]=<span class="hljs-built_in">int</span>(s[<span class="hljs-number">2</span>*i:<span class="hljs-number">2</span>*i+<span class="hljs-number">2</span>],<span class="hljs-number">16</span>)<br><span class="hljs-keyword">return</span> T<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Transstr</span>(<span class="hljs-params">x32</span>):<br>Cmb=<span class="hljs-string">b&quot;&quot;</span><br>Qld=<span class="hljs-string">b&quot;0123456789abcdef&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>Cmb+=Qld[x32[i]]<br><span class="hljs-keyword">return</span> Cmb<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">x32tox16</span>(<span class="hljs-params">x32</span>):<br>X16=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>X16[i]=x32[<span class="hljs-number">2</span>*i]*<span class="hljs-number">16</span>+x32[<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>]<br><span class="hljs-keyword">return</span> X16<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">x16tox32</span>(<span class="hljs-params">x16</span>):<br>X32=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>X32[<span class="hljs-number">2</span>*i]=x16[i]//<span class="hljs-number">16</span><br>X32[<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>]=x16[i]%<span class="hljs-number">16</span><br><span class="hljs-keyword">return</span> X32<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">findtwonum</span>(<span class="hljs-params">x32,loc,sender,Strcchp</span>):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You are entered&quot;</span>)<br>S32=x32<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>S32[<span class="hljs-number">2</span>*loc]=i//<span class="hljs-number">16</span><br>S32[<span class="hljs-number">2</span>*loc+<span class="hljs-number">1</span>]=i%<span class="hljs-number">16</span><br>Te=Transstr(x32)<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>Info1=sender.recvline(keepends=<span class="hljs-literal">False</span>)<br>Info1=sender.recv(numb=<span class="hljs-number">44</span>,timeout=<span class="hljs-number">20000</span>)<br>sender.send(<span class="hljs-string">b&quot;1&quot;</span>)<br>Info1=sender.recv(numb=<span class="hljs-number">44</span>,timeout=<span class="hljs-number">20000</span>)<br>sender.send(Te)<br>Info1=sender.recv(numb=<span class="hljs-number">44</span>,timeout=<span class="hljs-number">20000</span>)<br>sender.send(Strcchp)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(Te)==<span class="hljs-number">32</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(Strcchp)==<span class="hljs-number">32</span><br>R=sender.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-keyword">if</span>(R[:<span class="hljs-number">4</span>]==<span class="hljs-string">&quot;succ&quot;</span>):<br><span class="hljs-keyword">return</span> S32<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Decrypt1</span>(<span class="hljs-params">iiv,cchp,Strcchp,sender</span>):<br>Cel=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>)]<br>Tlc=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>Alc=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>cnt,Rnd=<span class="hljs-number">15</span>,<span class="hljs-number">1</span><br><span class="hljs-keyword">while</span>(cnt+<span class="hljs-number">1</span>):<br>Cel=findtwonum(Cel,cnt,sender,Strcchp)<br>Clc=x32tox16(Cel)<br>Tlc[<span class="hljs-number">16</span>-Rnd]=Rnd^Clc[<span class="hljs-number">16</span>-Rnd]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Tlc=&#x27;</span>,Tlc)<br>Rnd+=<span class="hljs-number">1</span><br>cnt-=<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Rnd-<span class="hljs-number">1</span>):<br>Clc[<span class="hljs-number">15</span>-i]=Tlc[<span class="hljs-number">15</span>-i]^Rnd<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Tlc xor&#x27;</span>,Rnd,<span class="hljs-string">&#x27;=&#x27;</span>, Clc)<br>Cel=x16tox32(Clc)<br><span class="hljs-built_in">print</span>(Transstr(Cel))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>Alc[i]=iiv[i]^Tlc[i]<br><span class="hljs-keyword">return</span> Alc<br><span class="hljs-comment">#--------MAIN BELOW---------#</span><br>sh=remote(<span class="hljs-string">&quot;49.235.239.97&quot;</span>,<span class="hljs-number">10003</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(str1)<br><span class="hljs-keyword">if</span>(str1[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>]==<span class="hljs-string">&quot;sha256&quot;</span>):<br><span class="hljs-keyword">break</span><br>yanzhengma=(getyanzhengma(str1[<span class="hljs-number">12</span>:<span class="hljs-number">28</span>],str1[<span class="hljs-number">33</span>:<span class="hljs-number">97</span>]))<br>sh.send(yanzhengma)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[NOTE]SENT YANZHENGMA&quot;</span>)<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>iv=str1[<span class="hljs-number">19</span>:]<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(str1)<br>y=str1[<span class="hljs-number">12</span>:]<br>BA,BB,BC=y[<span class="hljs-number">0</span>:<span class="hljs-number">32</span>],y[<span class="hljs-number">32</span>:<span class="hljs-number">64</span>],y[<span class="hljs-number">64</span>:<span class="hljs-number">96</span>]<br>I,A,B,C=Transnbs(iv),Transnbs(BA),Transnbs(BB),Transnbs(BC)<br>Ans=Decrypt1(I,A,BA,sh)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;Ans=&#x27;</span>,Ans)<br>Bns=Decrypt1(A,B,BB,sh)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;Bns=&#x27;</span>,Bns)<br>Cns=Decrypt1(B,C,BC,sh)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;Cns=&#x27;</span>,Cns)<br><span class="hljs-built_in">print</span>(Ans,Bns,Cns)<br><span class="hljs-comment">#[48, 120, 71, 97, 109, 101, 123, 55, 48, 54, 52, 97, 98, 52, 56, 45]</span><br><span class="hljs-comment">#[51, 99, 53, 102, 45, 52, 50, 99, 49, 45, 97, 100, 51, 51, 45, 54]</span><br><span class="hljs-comment">#[99, 101, 98, 101, 98, 98, 102, 101, 101, 57, 101, 125, 4, 4, 4, 4]</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RSA Notes 1</title>
    <link href="/2020/10/17/RSA-Notes/"/>
    <url>/2020/10/17/RSA-Notes/</url>
    
    <content type="html"><![CDATA[<h1 id="huangx607087å­¦ä¹ RSAçš„ç¬”è®°1"><a href="#huangx607087å­¦ä¹ RSAçš„ç¬”è®°1" class="headerlink" title="huangx607087å­¦ä¹ RSAçš„ç¬”è®°1"></a>huangx607087å­¦ä¹ RSAçš„ç¬”è®°1</h1><h2 id="I-What-is-RSA"><a href="#I-What-is-RSA" class="headerlink" title="I-What is RSA"></a>I-What is RSA</h2><p>ä½“åˆ¶ï¼š<br>1.é€‰æ‹©ä¸¤ä¸ªå¤§è´¨æ•°$p$,$q$ï¼Œè®¡ç®—$n&#x3D;pÃ—q$</p><p>2.è®¡ç®—$\phi&#x3D;(p-1)(q-1)$ï¼Œä¹Ÿå°±æ˜¯$n$çš„æ¬§æ‹‰å‡½æ•°ï¼ˆä¹Ÿå°±æ˜¯å°äº$n$çš„æ­£æ•´æ•°ä¸­ä¸$n$äº’è´¨æ•°é‡çš„ä¸ªæ•°ï¼‰</p><p>3.å–ä¸€ä¸ªæ•°å­—$e$ï¼Œä½¿$e,\phi$äº’è´¨</p><p>4.è®¡ç®—$d$ï¼Œä½¿$ed\equiv 1 \mod \phi$</p><p>5.åŠ å¯†å‡½æ•°ï¼š$c&#x3D;E(m)&#x3D;m^e \mod n $</p><p>6.è§£å¯†å‡½æ•°ï¼š$m&#x3D;D(c)&#x3D;c^d \mod n $</p><h2 id="II-11ç§RSAé¢˜å‹çš„æ€»ç»“"><a href="#II-11ç§RSAé¢˜å‹çš„æ€»ç»“" class="headerlink" title="II-11ç§RSAé¢˜å‹çš„æ€»ç»“"></a>II-11ç§RSAé¢˜å‹çš„æ€»ç»“</h2><h3 id="0x01-ç›´æ¥ç»™å‡º-p-q-c-e-æˆ–è€…-n-p-k-çš„é¢˜ç›®"><a href="#0x01-ç›´æ¥ç»™å‡º-p-q-c-e-æˆ–è€…-n-p-k-çš„é¢˜ç›®" class="headerlink" title="0x01 ç›´æ¥ç»™å‡º$p,q,c,e$æˆ–è€…$n&#x3D;p^k$çš„é¢˜ç›®"></a>0x01 ç›´æ¥ç»™å‡º$p,q,c,e$æˆ–è€…$n&#x3D;p^k$çš„é¢˜ç›®</h3><p>ç›´æ¥æ ¹æ®åŠ å¯†ä½“åˆ¶è®¡ç®—å³å¯ï¼Œæœ‰cryptoè¿™ä¸ªpythonåº“çš„å¯ä»¥ç›´æ¥ç”¨<code>inverse(e, (p-1)*(q-1))</code>æ±‚å‡º$d$</p><p>$n&#x3D;p^k$æ—¶ï¼Œ$\phi&#x3D;p^k-p^{k-1}$</p><h3 id="0x02-åªç»™å‡ºäº†-n-c-e"><a href="#0x02-åªç»™å‡ºäº†-n-c-e" class="headerlink" title="0x02 åªç»™å‡ºäº†$n,c,e$"></a>0x02 åªç»™å‡ºäº†$n,c,e$</h3><p>è¿™ç§æƒ…å†µä¸€èˆ¬$n$æ˜¯å¯ä»¥æš´åŠ›åˆ†è§£çš„ï¼Œä¸Šyafuå³å¯</p><h3 id="0x03-åªç»™å‡ºäº†-n-c-e-å¹¶ä¸”-e-3-çš„æƒ…å†µ"><a href="#0x03-åªç»™å‡ºäº†-n-c-e-å¹¶ä¸”-e-3-çš„æƒ…å†µ" class="headerlink" title="0x03 åªç»™å‡ºäº†$n,c,e$å¹¶ä¸”$e&#x3D;3$çš„æƒ…å†µ"></a>0x03 åªç»™å‡ºäº†$n,c,e$å¹¶ä¸”$e&#x3D;3$çš„æƒ…å†µ</h3><p>æ ¹æ®$c&#x3D;E(m)&#x3D;m^3 \mod n $,ä¹Ÿå°±æ˜¯$m^3&#x3D;c+kn,kâˆˆ${$0,1,2,3,â€¦$}ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥æšä¸¾$k$çš„å€¼ï¼Œé€šè¿‡äºŒåˆ†$m$ç¡®å®š$m$çš„å€¼ï¼Œä¸€èˆ¬$k$ä¸ä¼šå¤ªå¤§çš„</p><h3 id="0x04-åªç»™å‡ºäº†-n-c-e-å¹¶ä¸”-ln-eâ‰ˆ-ln-n-ï¼ˆä¹Ÿå°±æ˜¯-e-éå¸¸å¤§çš„æ—¶å€™"><a href="#0x04-åªç»™å‡ºäº†-n-c-e-å¹¶ä¸”-ln-eâ‰ˆ-ln-n-ï¼ˆä¹Ÿå°±æ˜¯-e-éå¸¸å¤§çš„æ—¶å€™" class="headerlink" title="0x04 åªç»™å‡ºäº†$n,c,e$å¹¶ä¸”$\ln eâ‰ˆ\ln n$ï¼ˆä¹Ÿå°±æ˜¯$e$éå¸¸å¤§çš„æ—¶å€™)"></a>0x04 åªç»™å‡ºäº†$n,c,e$å¹¶ä¸”$\ln eâ‰ˆ\ln n$ï¼ˆä¹Ÿå°±æ˜¯$e$éå¸¸å¤§çš„æ—¶å€™)</h3><p>ä½¿ç”¨winnerattackç®—æ³•ï¼Œå…·ä½“ä»£ç è§ä¸‹<del>ï¼ˆåˆ«çœ‹ï¼Œè¿™ä¸ªä»£ç ä¸æ˜¯æœ¬fwæ‰“çš„ï¼‰</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">continued_fractions_expansion</span>(<span class="hljs-params">numerator,denominator</span>):<span class="hljs-comment">#(e,N)</span><br>result=[]<br>divident = numerator % denominator<br>quotient = numerator // denominator<br>result.append(quotient)<br><span class="hljs-keyword">while</span> divident != <span class="hljs-number">0</span>:<br>numerator = numerator - quotient * denominator<br>tmp = denominator<br>denominator = numerator<br>numerator = tmp<br>divident = numerator % denominator<br>quotient = numerator // denominator<br>result.append(quotient)<br><span class="hljs-keyword">return</span> result<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convergents</span>(<span class="hljs-params">expansion</span>):<br>convergents=[(expansion[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(expansion)):<br>numerator = <span class="hljs-number">1</span><br>denominator = expansion[i]<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i - <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>numerator += expansion[j] * denominator<br><span class="hljs-keyword">if</span> j==<span class="hljs-number">0</span>:<br><span class="hljs-keyword">break</span><br>tmp = denominator<br>denominator = numerator<br>numerator = tmp<br>convergents.append((numerator, denominator)) <span class="hljs-comment">#(k,d)</span><br><span class="hljs-keyword">return</span> convergents<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">newtonSqrt</span>(<span class="hljs-params">n</span>):<br>approx = n // <span class="hljs-number">2</span><br>better = (approx + n // approx) // <span class="hljs-number">2</span><br><span class="hljs-keyword">while</span> better != approx:<br>    approx = better<br>    better = (approx + n // approx) // <span class="hljs-number">2</span><br><span class="hljs-keyword">return</span> approx<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wiener_attack</span>(<span class="hljs-params">cons, e, N</span>):<br><span class="hljs-keyword">for</span> cs <span class="hljs-keyword">in</span> cons:<br>k,d = cs<br><span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>:<br><span class="hljs-keyword">continue</span><br>phi_N = (e * d - <span class="hljs-number">1</span>) // k<br><span class="hljs-comment">#x**2 - ((N - phi_N) + 1) * x + N = 0</span><br>a = <span class="hljs-number">1</span><br>b = -((N - phi_N) + <span class="hljs-number">1</span>)<br>c = N<br>delta = b * b - <span class="hljs-number">4</span> * a * c<br><span class="hljs-keyword">if</span> delta &lt;= <span class="hljs-number">0</span>:<br><span class="hljs-keyword">continue</span><br>x1 = (newtonSqrt(delta) - b)//(<span class="hljs-number">2</span> * a)<br>x2 = -(newtonSqrt(delta) + b)//(<span class="hljs-number">2</span> * a)<br><span class="hljs-keyword">if</span> x1 * x2 == N:<br><span class="hljs-keyword">return</span> [x1, x2, k, d]<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    n = <span class="hljs-comment">#å¡«å†™nçš„å€¼</span><br>    e = <span class="hljs-comment">#å¡«å†™eçš„å€¼</span><br>    c = <span class="hljs-comment">#å¡«å†™cçš„å€¼</span><br>    expansion = continued_fractions_expansion(e, n)<br>    cons = convergents(expansion)<br>    p, q, k, d = wiener_attack(cons, e, n)<br>    m = <span class="hljs-built_in">pow</span>(c, d, n)<br>    <span class="hljs-built_in">print</span>(libnum.n2s(m))<br><br></code></pre></td></tr></table></figure><h3 id="0x05-ç»™å‡ºäº†-n-c-e-å¹¶ä¸”ç»™å‡º-f-d-phi-çš„ä¸€ä¸ªä¸€æ¬¡å¼"><a href="#0x05-ç»™å‡ºäº†-n-c-e-å¹¶ä¸”ç»™å‡º-f-d-phi-çš„ä¸€ä¸ªä¸€æ¬¡å¼" class="headerlink" title="0x05 ç»™å‡ºäº†$n,c,e$å¹¶ä¸”ç»™å‡º$f(d,\phi)$çš„ä¸€ä¸ªä¸€æ¬¡å¼"></a>0x05 ç»™å‡ºäº†$n,c,e$å¹¶ä¸”ç»™å‡º$f(d,\phi)$çš„ä¸€ä¸ªä¸€æ¬¡å¼</h3><p>ç›´æ¥æ±‚å‡º$ef(d,\phi)$çš„å€¼,ç„¶åç¡®å®šæ¨¡æ•°</p><h3 id="0x06-å·²çŸ¥-n-c-e-ï¼Œ-e-3-å¹¶ä¸”å¾—çŸ¥-m-m-mod-2-k-çš„å€¼"><a href="#0x06-å·²çŸ¥-n-c-e-ï¼Œ-e-3-å¹¶ä¸”å¾—çŸ¥-m-m-mod-2-k-çš„å€¼" class="headerlink" title="0x06 å·²çŸ¥$n,c,e$ï¼Œ$e&#x3D;3$,å¹¶ä¸”å¾—çŸ¥$m-(m \mod 2^k)$çš„å€¼"></a>0x06 å·²çŸ¥$n,c,e$ï¼Œ$e&#x3D;3$,å¹¶ä¸”å¾—çŸ¥$m-(m \mod 2^k)$çš„å€¼</h3><p>è¿™ç§æƒ…å†µä¸‹æ ¹æœ¬ä¸å¯èƒ½ç”¨0x03çš„æ–¹æ³•ï¼Œå› ä¸º$k$å€¼ä¹Ÿå¾ˆå¤§</p><p>åœ¨Sagemathä¸­çš„Notebookä¸Šæ‰“å¼€ç½‘é¡µï¼Œåˆ›å»ºä¸€ä¸ªSagemathç½‘é¡µæ–‡ä»¶ï¼ŒæŠŠä»¥ä¸‹ä»£ç è¡¥å®Œæ•´åè¿è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-comment">#ä½ å·²çŸ¥çš„nå€¼</span><br>e = <span class="hljs-number">3</span><br>m = randrange(n)<span class="hljs-comment">#ä¸è¦æ”¹</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<span class="hljs-comment">#ä¸è¦æ”¹</span><br>beta = <span class="hljs-number">1</span><br>epsilon = beta^<span class="hljs-number">2</span>/<span class="hljs-number">7</span><span class="hljs-comment">#ä¸è¦æ”¹</span><br>nbits = n.nbits()<span class="hljs-comment">#ä¸è¦æ”¹</span><br>kbits=<span class="hljs-comment">#mè¢«æ©ç›–çš„å­—ä½æ•°</span><br><span class="hljs-built_in">print</span>(nbits,kbits)<br>mbar = <span class="hljs-comment">#ä½ å¾—åˆ°çš„ä¸å®Œæ•´çš„må€¼</span><br>c = <span class="hljs-comment">#ä½ å¾—åˆ°çš„cå€¼</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;upper %d bits (of %d bits) is given&quot;</span> % (nbits-kbits, nbits))<br>PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = (mbar + x)^e - c<br><span class="hljs-built_in">print</span> (m)<br>x0 = f.small_roots(X=<span class="hljs-number">2</span>^kbits, beta=<span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]  <span class="hljs-comment"># find root &lt; 2^kbits with factor = n1</span><br><span class="hljs-built_in">print</span>( mbar + x0)<br></code></pre></td></tr></table></figure><h3 id="0x07-Parity-Oracle"><a href="#0x07-Parity-Oracle" class="headerlink" title="0x07 Parity Oracle"></a>0x07 Parity Oracle</h3><p>ç›´æ¥çœ‹0xGame Div 2çš„ç›¸å…³å†…å®¹</p><h3 id="0x08å·²çŸ¥-n-c-e-ï¼Œ-e-3-å’Œ-p-p-mod-2-k-çš„å€¼"><a href="#0x08å·²çŸ¥-n-c-e-ï¼Œ-e-3-å’Œ-p-p-mod-2-k-çš„å€¼" class="headerlink" title="0x08å·²çŸ¥$n,c,e$ï¼Œ$e&#x3D;3$å’Œ$p-(p \mod 2^k)$çš„å€¼"></a>0x08å·²çŸ¥$n,c,e$ï¼Œ$e&#x3D;3$å’Œ$p-(p \mod 2^k)$çš„å€¼</h3><p>åœ¨Sagemathä¸­çš„Notebookä¸Šæ‰“å¼€ç½‘é¡µï¼Œåˆ›å»ºä¸€ä¸ªSagemathç½‘é¡µæ–‡ä»¶ï¼ŒæŠŠä»¥ä¸‹ä»£ç è¡¥å®Œæ•´åè¿è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-comment">#ä½ å¾—åˆ°çš„nå€¼</span><br>p_fake = <span class="hljs-comment">#ä½ å¾—åˆ°çš„ä¸å®Œæ•´çš„på€¼</span><br>pbits = p_fake.nbits()<br>kbits = <span class="hljs-comment">#på¤±å»çš„ä½ä½</span><br>pbar = p_fake &amp; (<span class="hljs-number">2</span>^pbits-<span class="hljs-number">2</span>^kbits)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;upper %d bits (of %d bits) is given&quot;</span> % (pbits-kbits, pbits)<br>PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = x + pbar<br>x0 = f.small_roots(X=<span class="hljs-number">2</span>^kbits, beta=<span class="hljs-number">0.4</span>)[<span class="hljs-number">0</span>]  <span class="hljs-comment"># find root &lt; 2^kbits with factor &gt;= n^0.3</span><br>p= x0 + pbar<br><span class="hljs-built_in">print</span> p<br></code></pre></td></tr></table></figure><p>æœ‰$p$å°±å¯ä»¥å¾—åˆ°$q$ï¼Œè¿›è€Œå°±å¾ˆç®€å•äº†</p><h3 id="0x09-å·²çŸ¥-n-c-e-ï¼Œ-e-3-å’Œ-d-mod-2-k-å€¼"><a href="#0x09-å·²çŸ¥-n-c-e-ï¼Œ-e-3-å’Œ-d-mod-2-k-å€¼" class="headerlink" title="0x09 å·²çŸ¥$n,c,e$ï¼Œ$e&#x3D;3$å’Œ$d \mod 2^k$å€¼"></a>0x09 å·²çŸ¥$n,c,e$ï¼Œ$e&#x3D;3$å’Œ$d \mod 2^k$å€¼</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">partial_p</span>(<span class="hljs-params">p0, kbits, n</span>):<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    nbits = n.nbits()<br>    f = <span class="hljs-number">2</span>^kbits*x + p0<br>    f = f.monic()<br>    roots = f.small_roots(X=<span class="hljs-number">2</span>^(nbits//<span class="hljs-number">2</span>-kbits), beta=<span class="hljs-number">0.3</span>)  <span class="hljs-comment"># find root &lt; 2^(nbits//2-kbits) with factor &gt;= n^0.3</span><br>    <span class="hljs-keyword">if</span> roots:<br>        x0 = roots[<span class="hljs-number">0</span>]<br>        p = gcd(<span class="hljs-number">2</span>^kbits*x0 + p0, n)<br>        <span class="hljs-keyword">return</span> ZZ(p)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_p</span>(<span class="hljs-params">d0, kbits, e, n</span>):<br>    X = var(<span class="hljs-string">&#x27;X&#x27;</span>)<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">1</span>, e+<span class="hljs-number">1</span>):<br>        results = solve_mod([e*d0*X - k*X*(n-X+<span class="hljs-number">1</span>) + k*n == X], <span class="hljs-number">2</span>^kbits)<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> results:<br>            p0 = ZZ(x[<span class="hljs-number">0</span>])<br>            p = partial_p(p0, kbits, n)<br>            <span class="hljs-keyword">if</span> p:<br>                <span class="hljs-keyword">return</span> p<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    n = <span class="hljs-comment">#ä½ å¾—åˆ°çš„nå€¼</span><br>    e = <span class="hljs-number">3</span><br>    d = <span class="hljs-comment">#ä½ å¾—åˆ°çš„dçš„ä½ä½</span><br>    beta = <span class="hljs-number">0.5</span><br>    epsilon = beta^<span class="hljs-number">2</span>/<span class="hljs-number">7</span><br>    nbits = n.nbits()<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;nbits:%d:&quot;</span>%(nbits)<br>    <span class="hljs-comment">#kbits = floor(nbits*(beta^2+epsilon))</span><br>    kbits = nbits - d.nbits()-<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;kbits:%d&quot;</span>%(kbits)<br>    d0 = d &amp; (<span class="hljs-number">2</span>^kbits-<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;lower %d bits (of %d bits) is given&quot;</span> % (kbits, nbits)<br>    p = find_p(d0, kbits, e, n)<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;found p: %d&quot;</span> % p<br>    q = n//p<br>    <span class="hljs-built_in">print</span> d<br>    <span class="hljs-built_in">print</span> inverse_mod(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br></code></pre></td></tr></table></figure><h3 id="0x0A-ä¸¤ä¸ªæ¨¡æ•°-n-1-n-2-ä¸äº’ç´ ï¼ˆæ¨¡ä¸äº’ç´ ï¼‰"><a href="#0x0A-ä¸¤ä¸ªæ¨¡æ•°-n-1-n-2-ä¸äº’ç´ ï¼ˆæ¨¡ä¸äº’ç´ ï¼‰" class="headerlink" title="0x0A ä¸¤ä¸ªæ¨¡æ•°$n_1,n_2$ä¸äº’ç´ ï¼ˆæ¨¡ä¸äº’ç´ ï¼‰"></a>0x0A ä¸¤ä¸ªæ¨¡æ•°$n_1,n_2$ä¸äº’ç´ <strong>ï¼ˆæ¨¡ä¸äº’ç´ ï¼‰</strong></h3><p>è¿™ç§é¢˜ç›®ä¸€èˆ¬ç»™å‡º$2$ç»„$n,e,c$çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚ä¸€ä¸‹$\gcd (n_1,n_2)$ å¦‚æœä¸ç­‰äº$1$çš„è¯ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†$n$çš„ä¸€ä¸ªå› æ•°$p$,ä¸€é™¤å°±å¾—åˆ°äº†$q_1,q_2$ï¼Œåˆ†åˆ«æ±‚è§£å³å¯å¾—åˆ°æ˜æ–‡ã€‚</p><h3 id="0x0B-æ¨¡æ•°-n-ç›¸åŒ-æŒ‡æ•°-e-ä¸åŒï¼ˆå…±æ¨¡æ”»å‡»ï¼‰"><a href="#0x0B-æ¨¡æ•°-n-ç›¸åŒ-æŒ‡æ•°-e-ä¸åŒï¼ˆå…±æ¨¡æ”»å‡»ï¼‰" class="headerlink" title="0x0B æ¨¡æ•°$n$ç›¸åŒ,æŒ‡æ•°$e$ä¸åŒï¼ˆå…±æ¨¡æ”»å‡»ï¼‰"></a>0x0B æ¨¡æ•°$n$ç›¸åŒ,æŒ‡æ•°$e$ä¸åŒ<strong>ï¼ˆå…±æ¨¡æ”»å‡»ï¼‰</strong></h3><p>è¿™ç§é¢˜ç›®ä¸€èˆ¬ä¹Ÿæ˜¯ç»™å‡º$2$ç»„$n,e,c$çš„å€¼ã€‚ä¹Ÿå°±æ˜¯$5$ä¸ªæ•°å­—ï¼š$n,e_1,e_2,c_1,c_2$ã€‚æ­¤æ—¶å¯ä»¥ä¸æ±‚$d_1,d_2$ä¹Ÿå¯ä»¥ç›´æ¥è·å¾—æ˜æ–‡ã€‚</p><p>æ­¥éª¤ï¼š<br>æ˜¾ç„¶ï¼Œå¤šæ•°æƒ…å†µä¸‹$\gcd(e_1,e_2)&#x3D;1$ï¼Œæ‰€ä»¥æœ‰$e_1s_1+e_2s_2&#x3D;1$ï¼Œä¸€èˆ¬$s_1,s_2$ä¸ºä¸€æ­£ä¸€è´Ÿçš„ä¸¤ä¸ªæ•´æ•°ï¼Œç”¨EXGCDå¯ä»¥æ±‚å¾—è¯¥å¼å­çš„ä¸€ç»„è§£</p><p>æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç®—å¼ ï¼š$(c1^{s1}c2^{s2})\mod n &#x3D; ((m^{e1}\mod n)^{s1}(m^{e2}\mod n)^{s2})\mod n$ .<strong>(1)</strong></p><p>åŒ–ç®€ï¼Œæœ‰ï¼š$(c1^{s1}c2^{s2})\mod n &#x3D; (m^{(e1^{s1}+e2^{s2})})\mod n$  .<strong>(2)</strong></p><p>åˆ$e_1s_1+e_2s_2&#x3D;1$   . <strong>(3)</strong></p><p>æ‰€ä»¥ç”±**(2)(3)**å¯çŸ¥ï¼š$c1^{s1}*c2^{s2} \equiv  m \mod n $</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™å‡ºä»¥ä¸‹çš„è„šæœ¬ï¼š<del>åˆ«è†œï¼Œè¿™å¾ˆæ˜¾ç„¶ä¸æ˜¯æˆ‘è¿™ä¸ªfwèƒ½å¤Ÿå†™å‡ºæ¥çš„ï¼ï¼Œæˆ‘æœ‰è¿‡è¿™æ ·çš„ç é£ï¼Ÿ</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> n2s,s2n<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">egcd</span>(<span class="hljs-params">a, b</span>):<br>  <span class="hljs-keyword">if</span> a == <span class="hljs-number">0</span>:<br>    <span class="hljs-keyword">return</span> (b, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>  <span class="hljs-keyword">else</span>:<br>    g, y, x = egcd(b % a, a)<br>    <span class="hljs-keyword">return</span> (g, x - (b // a) * y, y)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>  n = <span class="hljs-comment">#å¡«å†™nå€¼</span><br>  c1 = <span class="hljs-comment">#å¡«å†™c1å€¼</span><br>  c2 = <span class="hljs-comment">#å¡«å†™c2å€¼</span><br>  e1 = <span class="hljs-comment">#å¡«å†™e1å€¼</span><br>  e2 = <span class="hljs-comment">#å¡«å†™e2å€¼</span><br>  s = egcd(e1, e2)<br>  s1 = s[<span class="hljs-number">1</span>]<br>  s2 = s[<span class="hljs-number">2</span>]<br>  <span class="hljs-keyword">if</span> s1&lt;<span class="hljs-number">0</span>:<br>    s1 = - s1<br>    c1 = invert(c1, n)<br>  <span class="hljs-keyword">elif</span> s2&lt;<span class="hljs-number">0</span>:<br>    s2 = - s2<br>    c2 = invert(c2, n)<br>  m = <span class="hljs-built_in">pow</span>(c1,s1,n)*<span class="hljs-built_in">pow</span>(c2,s2,n) % n<br>  <span class="hljs-built_in">print</span> n2s(m)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>  main()<br></code></pre></td></tr></table></figure><h3 id="0x0C-ç»™å‡ºpemå’Œbinæ–‡ä»¶çš„RSAé¢˜ç›®"><a href="#0x0C-ç»™å‡ºpemå’Œbinæ–‡ä»¶çš„RSAé¢˜ç›®" class="headerlink" title="0x0C ç»™å‡ºpemå’Œbinæ–‡ä»¶çš„RSAé¢˜ç›®"></a>0x0C ç»™å‡ºpemå’Œbinæ–‡ä»¶çš„RSAé¢˜ç›®</h3><p>åœ¨è„šæœ¬å‰åŠ ä¸Šè¿™äº›å†…å®¹ã€‚ç„¶åpub1å’Œpub2éƒ½æœ‰ä¸¤ä¸ªå€¼(nå’Œeï¼Œæ²¡æœ‰c)</p><p>è¿™ä¸ªè„šæœ¬çš„ååŠéƒ¨åˆ†ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªæ›´åŠ ç®€æ´çš„å…±æ¨¡æ”»å‡»è§‰å¾—è„šæœ¬ã€‚<del>æˆ‘å°±æ˜¯ä¸ªåªä¼šåˆ©ç”¨åˆ«äººè„šæœ¬çš„fw55555555555</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> libnum<br>c1=libnum.s2n(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;cipher1.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read())<br>c2=libnum.s2n(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;cipher2.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read())<br>pub1=RSA.importKey(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;publickey1.pem&#x27;</span>).read())<br>pub2=RSA.importKey(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;publickey2.pem&#x27;</span>).read())<br><span class="hljs-comment">#æ³¨ï¼šå¦‚æœæ–‡ä»¶æ˜¯binç±»å‹çš„è¯ï¼Œåº”è¯¥å†™æˆè¿™æ ·ï¼š</span><br><span class="hljs-comment">#c=bytes_to_long(open(&#x27;cipher.bin&#x27;,&#x27;rb&#x27;).read())</span><br>n=pub1.n<br>e1,e2=pub1.e,pub2.e<br>s = gmpy2.gcdext(pub1.e,pub2.e)<br>s1,s2=s[<span class="hljs-number">1</span>],s[<span class="hljs-number">2</span>]<br><span class="hljs-keyword">if</span> s1&lt;<span class="hljs-number">0</span>:<br>    s1 = -s1<br>    c1 = gmpy2.invert(c1, n)<br><span class="hljs-keyword">elif</span> s2&lt;<span class="hljs-number">0</span>:<br>    s2 = -s2<br>    c2 = gmpy2.invert(c2, n)<br>m=<span class="hljs-built_in">pow</span>(c1,s1,n)*<span class="hljs-built_in">pow</span>(c2,s2,n)%n<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0xGameDiv2</title>
    <link href="/2020/10/16/0xGameDiv2/"/>
    <url>/2020/10/16/0xGameDiv2/</url>
    
    <content type="html"><![CDATA[<h1 id="0xGame-Div-2-é¢˜è§£"><a href="#0xGame-Div-2-é¢˜è§£" class="headerlink" title="0xGame  Div 2 é¢˜è§£"></a>0xGame  Div 2 é¢˜è§£</h1><h2 id="About"><a href="#About" class="headerlink" title="About"></a>About</h2><p>ç¬¬äºŒå‘¨ï¼Œéš¾åº¦æ¯”ç¬¬ä¸€å‘¨å¤§å¥½å¤šï¼Œåªåˆ‡äº†ä¸¤é“å¯†ç é¢˜ï¼Œåˆ°æé™äº†ï¼Œ<del>ç„¶ååªæœ‰3800å¤šåˆ†ï¼ŒTop1ï¼Œ2ä¸¤ä¸ªå…¨æ ˆå¤§ä½¬éƒ½æœ‰9000+åˆ†ï¼Œæˆ‘æœç„¶å¥½èœå•Š</del></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="1-SmallModulus"><a href="#1-SmallModulus" class="headerlink" title="1.SmallModulus"></a>1.SmallModulus</h3><p>æç¤ºï¼šåšè¿™é“é¢˜çš„æ—¶å€™ï¼æ‰‹é€Ÿï¼ä¸€å®šè¦å¿«ï¼ä¸€å®šè¦å¿«ï¼ä¸€å®šè¦å¿«ï¼ï¼ï¼ï¼ï¼ï¼Œæ— è®ºæ˜¯è¾“4ä½éªŒè¯ç è¿˜æ˜¯è¾“å…¥æç¤ºä¸­çš„1ï¼ï¼ï¼<del>æˆ‘TMå› ä¸ºæ‰‹é€Ÿå¤ªæ…¢å¯¼è‡´è¿œç¨‹è¿æ¥è¶…æ—¶ï¼Œæ•´ä¸ªä¸‹åˆéƒ½è€—è´¹åœ¨ä¸Šé¢äº†ï¼Œå¿ä¸ä½åæ§½ä¸¤å¥ï¼Œå¤ªè‰äº†ï¼</del></p><p>è™½ç„¶æˆ‘ä¸çŸ¥é“sha256æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼ŒåŸç†æ˜¯ä»€ä¹ˆï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯ç”¨ä¸€ä¸ªpythonè„šæœ¬ï¼Œå››é‡å¾ªç¯æšä¸¾å‡ºäº†æ¯æ¬¡éœ€è¦è¾“å…¥çš„éªŒè¯ç å†…å®¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br>s=<span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span><br>t=<span class="hljs-string">&quot;5d755ec7addaff634907855979bc02d0c279ab60ce736754faa895a81938b3c9&quot;</span><br>R=<span class="hljs-string">&quot;EsHH8BQQsfIMp7gC&quot;</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(R)==<span class="hljs-number">16</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(t)==<span class="hljs-number">64</span><br><span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> s:<br>    <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> s:<br>            <span class="hljs-keyword">for</span> i4 <span class="hljs-keyword">in</span> s:<br>                XXXX=i1+i2+i3+i4<br>                <span class="hljs-keyword">if</span> sha256((XXXX+R).encode()).hexdigest()==t:<br>                    <span class="hljs-built_in">print</span> (XXXX)<br><br></code></pre></td></tr></table></figure><p>æœ€ç»ˆæˆ‘è¿˜æ˜¯æ‰‹é€ŸåŠ å¿«ï¼Œè¿…é€Ÿåœ°å¾—åˆ°äº†è®¸è®¸å¤šå¤šç»„æ•°æ®â€¦ â€¦ï¼Œå…¶ä¸­ä¸€ç»„è¾“å‡ºæç¤ºï¼š<code>flag mod 9c7f17669e90b219  (in hex) : 3316d33a70b0a941</code>ã€‚</p><p>åŠ ä¸Šç¨‹åºçš„æ ¸å¿ƒä»£ç å¯çŸ¥ï¼Œè¾“å‡ºæç¤ºmodåä¹°ä½ çš„é‚£ä¸ªæ•°å­—æ˜¯è´¨æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> choice == <span class="hljs-string">b&quot;1&quot;</span>:<br>                module = getPrime(<span class="hljs-number">64</span>)<br>                <span class="hljs-variable language_">self</span>.send((<span class="hljs-string">&quot;flag mod &#123;&#125; (in hex) : &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<br>                    <span class="hljs-built_in">hex</span>(module)[<span class="hljs-number">2</span>:], <span class="hljs-built_in">hex</span>(m % module)[<span class="hljs-number">2</span>:])).encode())<br>                <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><p>æ˜¾ç„¶ï¼Œè¿™é“é¢˜æƒ³å‘Šè¯‰ä½ çš„æ¶ˆæ¯æ— éæ˜¯è®¸å¤šç»„ç±»ä¼¼ï¼š$x \equiv a_i \mod m_i$ ï¼Œ(å…¶ä¸­$m$ä¸ºè´¨æ•°)ã€‚æ ¹æ®æˆ‘è¿™ä¸ª<del>å¯†ç å­¦åºŸç‰©å’ŒoiåºŸç‰©</del>çš„ç†è§£ï¼Œè¿™é“é¢˜åº”è¯¥æ˜¯è€ƒä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰ã€‚</p><p>æŸ¥äº†ä¸€ä¸‹ï¼Œç™¾åº¦ç™¾ç§‘ä¸Šæ˜¯è¿™æ ·è®²è§£CRTçš„ï¼š</p><p>è®¾$M&#x3D;\prod_{i&#x3D;1}^n m_i$ï¼Œ$M_i&#x3D;M&#x2F;m_i$ï¼Œ$t_i$ä¸º$M_i$æ¨¡$m_i$çš„é€†å…ƒï¼Œä¹Ÿå°±æ˜¯$M_it_i \equiv 1 \mod m_i$ã€‚åˆ™$x \equiv \sum_{i&#x3D;1}^{n} a_it_iM_i \mod M$ã€‚ä¹Ÿå°±æ˜¯$x &#x3D; \sum_{i&#x3D;1}^{n}a_it_iM_i  +k M$</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦å¤„ç†ä¸€ä¸‹å¾—åˆ°çš„æ•°æ®ï¼Œç„¶åå°†å…¶æ”¾å…¥æ•°ç»„$a$å’Œ$m$ä¸­ã€‚è¿˜è¦ç”¨åˆ°æ±‚é€†å…ƒçš„ä»£ç (ç›´æ¥ä»ä¸Šä¸€ä¸ªè„šæœ¬ç›´æ¥ç§»æ¤è¿‡æ¥çš„)ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> MsandAs <span class="hljs-keyword">import</span> m,a<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">EX_GCD</span>(<span class="hljs-params">a,b,arr</span>): <span class="hljs-comment">#æ‰©å±•æ¬§å‡ é‡Œå¾—</span><br>    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span>:<br>        arr[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span><br>        arr[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">return</span> a<br>    g = EX_GCD(b, a % b, arr)<br>    t = arr[<span class="hljs-number">0</span>]<br>    arr[<span class="hljs-number">0</span>] = arr[<span class="hljs-number">1</span>]<br>    arr[<span class="hljs-number">1</span>] = t - (a // b) * arr[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> g<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ModReverse</span>(<span class="hljs-params">a,n</span>): <span class="hljs-comment">#ax=1(mod n) æ±‚aæ¨¡nçš„ä¹˜æ³•é€†x</span><br>    arr = [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,]<br>    gcd = EX_GCD(a,n,arr)<br>    <span class="hljs-keyword">if</span> gcd == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> (arr[<span class="hljs-number">0</span>] % n + n) % n<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br>arr = [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,]<br><br><span class="hljs-comment"># FUNCTION MAIN#</span><br>piM=<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>):<br>    piM*=m[i]<br><span class="hljs-built_in">print</span>(piM)<br>t =[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>)]<br>M =[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>):<br>    M[i]=piM//m[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>):<br>    t[i]=ModReverse(M[i],m[i])<br>B=<span class="hljs-number">0</span> <span class="hljs-comment">#Bä¸ºæ‰€æœ‰atMä¹‹ç§¯çš„å’Œ</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>):<br>    B+=a[i]*t[i]*M[i]<br>B%=piM<br><span class="hljs-built_in">print</span>(B)<br><span class="hljs-built_in">print</span>(long_to_bytes(B))<br><br></code></pre></td></tr></table></figure><p>æœ€åçš„<code>long_to_bytes(B)</code>ç®—å‡ºæ¥çš„å°±æ˜¯ç­”æ¡ˆäº†ã€‚</p><p><strong>2021.3.9æ›´æ–°</strong></p><p>CRTåªèƒ½è§£å†³æ¨¡æ•°äº’ç´ çš„æƒ…å†µï¼Œè€Œæ¨¡æ•°ä¸äº’ç´ çš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨exCRTï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">LCM</span>(<span class="hljs-params">a,b</span>):<br>    <span class="hljs-keyword">return</span> a*b//GCD(a,b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exgcd</span>(<span class="hljs-params">a,b</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> b:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>,<span class="hljs-number">0</span><br>    x,y=exgcd(b,a%b)<br>    <span class="hljs-keyword">return</span> y,x-y*(a//b)<br><span class="hljs-comment">#Main Below</span><br>m=[<span class="hljs-number">11</span>,<span class="hljs-number">25</span>,<span class="hljs-number">33</span>]<br>a=[<span class="hljs-number">6</span>,<span class="hljs-number">9</span>,<span class="hljs-number">17</span>]<br>r1,m1=a[<span class="hljs-number">0</span>],m[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(m)):<br>    r2,m2=a[i],m[i]<br>    d=GCD(m1,m2)<br>    l1,l2=exgcd(m1//d,m2//d)<br>    r1,m1=(r1+(r2-r1)//d*l1*m1)%LCM(m1,m2),LCM(m1,m2)<br><span class="hljs-built_in">print</span>(r1)<br><span class="hljs-comment">#809</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">809%11==6</span><br><span class="hljs-string">809%25==9</span><br><span class="hljs-string">809%33==17</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="2-parityOracle"><a href="#2-parityOracle" class="headerlink" title="2.parityOracle"></a>2.parityOracle</h3><p>è¿™é“é¢˜éœ€è¦ç”¨åˆ°Pwntoolsï¼Œä¹Ÿå°±æ„å‘³ç€éœ€è¦å®‰è£…è™šæ‹Ÿæœºã€‚<del>æœ¬fwå®‰è£…ä¸€ä¸ªè™šæ‹Ÿæœºå®‰è£…äº†ä¸‰å¤©ï¼Œå¤ªåºŸäº†</del>ã€‚</p><p>æˆ‘ä»¬å…ˆäº†è§£ä»¥ä¸‹Pwntoolsåœ¨å¯†ç å­¦é¢˜ç›®é‡Œé¢æŠ“åŒ…æ—¶éœ€è¦ç”¨åˆ°çš„å‡ ä¸ªæŒ‡ä»¤ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">æœ¬åœ° ï¼šsh = porcess(<span class="hljs-string">&quot;./level0&quot;</span>)<br>è¿œç¨‹ï¼šsh = remote(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">10001</span>)<br>å…³é—­è¿æ¥ï¼šsh.close()  <br>sh.send(data)  <span class="hljs-comment">#å‘é€æ•°æ®</span><br>sh.sendline(data)  <span class="hljs-comment">#å‘é€ä¸€è¡Œæ•°æ®ï¼Œç›¸å½“äºåœ¨æ•°æ®åé¢åŠ \n</span><br>sh.recv(numb = <span class="hljs-number">2048</span>, timeout = dufault) <span class="hljs-comment"># æ¥å—æ•°æ®ï¼ŒnumbæŒ‡å®šæ¥æ”¶çš„å­—èŠ‚ï¼ŒtimeoutæŒ‡å®šè¶…æ—¶</span><br>sh.recvline(keepends=<span class="hljs-literal">True</span>)  <span class="hljs-comment">#æ¥å—ä¸€è¡Œæ•°æ®ï¼Œkeependsä¸ºæ˜¯å¦ä¿ç•™è¡Œå°¾çš„\n</span><br>sh.recvuntil(<span class="hljs-string">&quot;Hello,World\n&quot;</span>,drop=fasle)<span class="hljs-comment">#  æ¥å—æ•°æ®ç›´åˆ°æˆ‘ä»¬è®¾ç½®çš„æ ‡å¿—å‡ºç°</span><br>sh.recvall() <span class="hljs-comment"># ä¸€ç›´æ¥æ”¶ç›´åˆ°EOF</span><br>sh.recvrepeat(timeout = default) <span class="hljs-comment"># æŒç»­æ¥å—ç›´åˆ°EOFæˆ–timeout</span><br>sh.interactive() <span class="hljs-comment"># ç›´æ¥è¿›è¡Œäº¤äº’ï¼Œç›¸å½“äºå›åˆ°shellçš„æ¨¡å¼ï¼Œåœ¨å–å¾—shellä¹‹åä½¿ç”¨</span><br></code></pre></td></tr></table></figure><p>ç„¶åå†çœ‹ä¸€ä¸‹é¢˜ç›®ç¨‹åºä¸­çš„ç»™å‡ºçš„æœ€æ ¸å¿ƒçš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> choice == <span class="hljs-string">b&quot;1&quot;</span>:<br>                cip = <span class="hljs-variable language_">self</span>.recvhex(prompt=<span class="hljs-string">b&quot;Your cipher (in hex): &quot;</span>)<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cip:<br>                    <span class="hljs-keyword">break</span><br>                result = <span class="hljs-built_in">pow</span>(cip, <span class="hljs-variable language_">self</span>.d, <span class="hljs-variable language_">self</span>.n) % <span class="hljs-number">4</span><br>                <span class="hljs-variable language_">self</span>.send(<span class="hljs-built_in">hex</span>(result)[<span class="hljs-number">2</span>:].encode())<br></code></pre></td></tr></table></figure><p>æŸ¥é˜…CTFWIKIä¸Šçš„èµ„æ–™å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬ç¬¬$k$æ¬¡å‘é€åªéœ€è¦å‘æœåŠ¡å™¨å‘é€æ•°å€¼$CÃ—2^{pk} \mod N$å³å¯ã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯è¦æŠŠ$10$è¿›åˆ¶æ•°å­—è½¬åŒ–ä¸º$16$è¿›åˆ¶çš„å­—ç¬¦ä¸²å‘é€ï¼ˆä¸å«å‰ç¼€<code>0x</code>ï¼‰ï¼Œå¹¶ä¸”æ¯æ¬¡å‘æœåŠ¡å™¨å‘é€çš„æ‰€æœ‰å†…å®¹è¦è½¬æ¢æˆbytesç±»å‹(åŒ…æ‹¬æŒ‡ä»¤<code>1</code>)ã€‚</p><p>æ¯æ¬¡æˆªå–å­—ç¬¦ä¸²çš„æ—¶å€™å¯ä»¥é€šè¿‡è¾“å…¥çœ‹çœ‹æˆªå–åˆ°å­—ç¬¦ä¸²çš„æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œç„¶åæ ¹æ®å­—ç¬¦ä¸²çš„ä¸‹æ ‡å…³ç³»ï¼ˆè¿™ä¸ªè¦åœ¨è°ƒè¯•çš„æ—¶å€™è‡ªå·±æ•°ï¼‰é€‰æ‹©è‡ªå·±éœ€è¦çš„éƒ¨åˆ†å¹¶ä¿å­˜ã€‚æŸäº›åœ°æ–¹ä¹Ÿå¯ä»¥è‡ªå·±åŠ ä¸€ç‚¹è¾“å‡ºæç¤ºçœ‹çœ‹ç¨‹åºæ˜¯å¦åœ¨è¿è¡Œã€‚å½“ç„¶ï¼Œä¸ºäº†ç¡®ä¿è‡ªå·±æŠ“åˆ°çš„å†…å®¹æ­£ç¡®ï¼Œä¹Ÿå¯ä»¥åŠ å‡ ä¸ª<code>assert</code>è¯­å¥è¯•è¯•çœ‹çœ‹æ˜¯å¦å‡ºç°äº†æŠ¥é”™ã€‚</p><p>åˆå§‹åŒ–å·¥ä½œåšå¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è¿›è¡ŒäºŒåˆ†è¿‡ç¨‹äº†ã€‚æ ¹æ®CTFWIKIä¸Šçš„æç¤ºï¼šè®¾$L,R$ä¸ºäºŒåˆ†çš„ä¸¤ç«¯(åˆå§‹å€¼ä¸º$L&#x3D;0,R&#x3D;N$)ã€‚.ç„¶åæ¯æ¬¡å–$M$&#x3D;$(L+R)&#x2F;2$ã€‚å¦‚æœå¾—åˆ°çš„æ•°å­—æ˜¯å¥‡æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬æˆ‘ä»¬ä¸‹ä¸€æ¬¡æˆªå–$(M,R)$åŒºé—´ç»§ç»­äºŒåˆ†ã€‚å¦‚æœå¾—åˆ°çš„æ•°å­—æ˜¯å¶æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æˆªå–$(L,M)$åŒºé—´è¿›è¡ŒäºŒåˆ†ã€‚ç”±äºCTFWIKIä¸Šå¯¹è¿™ä¸€å—çš„åŸç†è¿›è¡Œäº†è¯¦ç»†è®²è¿°ï¼Œæ•…æ­¤å¤„ä¸å¤šèµ˜è¿°ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„è„šæœ¬æ¥è¿›è¡ŒäºŒåˆ†æ“ä½œã€‚ï¼ˆå‰é¢æŠ“å–éªŒè¯ç çš„ç¨‹åºä¸ä¸Šä¸€é¢˜çš„éªŒè¯ç ç¨‹åºä¸€æ¨¡ä¸€æ ·ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getyanzhengma</span>(<span class="hljs-params">s16len,s64len</span>):<br>LTSNMS=<span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(s16len)==<span class="hljs-number">16</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(s64len)==<span class="hljs-number">64</span><br><span class="hljs-keyword">for</span> i1 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">for</span> i3 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">for</span> i4 <span class="hljs-keyword">in</span> LTSNMS:<br><span class="hljs-keyword">if</span> sha256((i1+i2+i3+i4+s16len).encode()).hexdigest()==s64len:<br><span class="hljs-keyword">return</span> i1+i2+i3+i4<br>sh=remote(<span class="hljs-string">&quot;49.235.239.97&quot;</span>,<span class="hljs-number">10001</span>)<br><span class="hljs-keyword">while</span>(<span class="hljs-literal">True</span>):<br>str1=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br><span class="hljs-keyword">if</span>(str1[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>]==<span class="hljs-string">&quot;sha256&quot;</span>):<br><span class="hljs-keyword">break</span><br>yanzhengma=(getyanzhengma(str1[<span class="hljs-number">12</span>:<span class="hljs-number">28</span>],str1[<span class="hljs-number">33</span>:<span class="hljs-number">97</span>]))<br>sh.send(yanzhengma)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[NOTE]SENT YANZHENGMA&quot;</span>)<br>e,n,c=<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span><br>str2=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>e=str2[<span class="hljs-number">18</span>:]<br>str2=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>n=str2[<span class="hljs-number">4</span>:]<br>str2=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>c=str2[<span class="hljs-number">4</span>:]<br>e,n,c=<span class="hljs-built_in">int</span>(e),<span class="hljs-built_in">int</span>(n),<span class="hljs-built_in">int</span>(c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[NOTE]F=GOT enc&quot;</span>)<br>L,R,Clk=<span class="hljs-number">0</span>,n,<span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> L&lt;=R:<br><span class="hljs-keyword">if</span>(Clk%<span class="hljs-number">50</span>==<span class="hljs-number">0</span>):<br><span class="hljs-built_in">print</span>(L,R,Clk)<br>M=(L+R)//<span class="hljs-number">2</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>str3=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>sh.send(<span class="hljs-string">b&quot;1&quot;</span>)<br>a=(c*<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,e*Clk,n))%n<br>sh.send(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">hex</span>(a))[<span class="hljs-number">2</span>:].encode())<br>recnum=sh.recvline(keepends=<span class="hljs-literal">False</span>)<br>recnum=<span class="hljs-built_in">int</span>(recnum[-<span class="hljs-number">1</span>])<br><span class="hljs-keyword">if</span> recnum==<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> recnum==<span class="hljs-number">3</span>:<br>L=M+<span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> recnum==<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> recnum==<span class="hljs-number">2</span>:<br>R=M-<span class="hljs-number">1</span><br>Clk+=<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(L)<br><span class="hljs-built_in">print</span>(long_to_bytes(L))<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šæ¯æ¬¡ç¨‹åºè·‘çš„æ—¶å€™ä¼šå­˜åœ¨ä¸€å®šè¯¯å·®,ä¸è¿‡ä¸€èˆ¬ä¸è¶…è¿‡$100$ï¼Œè¿™å°±æ„å‘³ç€è§£å‡ºæ¥çš„å­—ç¬¦ä¸²çš„æœ€å$1$åˆ°$2$ä½å¯èƒ½ä¼šä¸å¯¹ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥æ ¹æ®æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯å¦æˆè¯ï¼Œæˆ–è€…æ ¹æ®é¢˜ç›®ä¸­çš„æç¤ºï¼Œä¹Ÿå¯ä»¥è§£å‡ºæ¥æœ€åçš„flag</strong></p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nfsr</title>
    <link href="/2020/10/08/Nfsr/"/>
    <url>/2020/10/08/Nfsr/</url>
    
    <content type="html"><![CDATA[<h1 id="å…³äºNFSRå­¦ä¹ çš„ä¸€äº›ç¬”è®°"><a href="#å…³äºNFSRå­¦ä¹ çš„ä¸€äº›ç¬”è®°" class="headerlink" title="å…³äºNFSRå­¦ä¹ çš„ä¸€äº›ç¬”è®°"></a>å…³äºNFSRå­¦ä¹ çš„ä¸€äº›ç¬”è®°</h1><h2 id="0x01è§£é¢˜èƒŒæ™¯"><a href="#0x01è§£é¢˜èƒŒæ™¯" class="headerlink" title="0x01è§£é¢˜èƒŒæ™¯"></a>0x01è§£é¢˜èƒŒæ™¯</h2><p>10æœˆ6æ—¥åˆšæŠŠ0xCTFä¸Šçš„æ‰€æœ‰å¯†ç å­¦é¢˜ç›®AKï¼Œè¿™é“é¢˜å¡äº†æˆ‘ä¸€å‘¨ï¼Œå¾—åˆ°äº†å­¦é•¿çš„å¸®åŠ©ï¼ŒæŸ¥äº†CTFWIKIå’Œå­¦é•¿çš„åšå®¢æ‰å‹‰å¼ºåšå‡ºæ¥ï¼Œå¤ªéš¾äº†</p><h2 id="0x02ç®€ä»‹"><a href="#0x02ç®€ä»‹" class="headerlink" title="0x02ç®€ä»‹"></a>0x02ç®€ä»‹</h2><p>NFSRï¼Œåˆç§°éçº¿æ€§ç§»ä½å¯„å­˜å™¨ï¼Œåœ¨æ¨¡$2$çš„æ„ä¹‰ä¸‹ï¼Œå¼‚æˆ–å¯ä»¥è§†ä½œåŠ æ³•ï¼ŒæŒ‰ä½ä¸å¯ä»¥è§†ä½œä¹˜æ³•ã€‚æ‰€ä»¥LFSRä¸€èˆ¬éƒ½æ˜¯åªæœ‰å¼‚æˆ–ï¼Œè€ŒNFSRæœ‰ä¸è¿ç®—ã€‚å¹¶ä¸”ä¸è¿ç®—çš„æ€§è´¨å¯ä»¥çŸ¥é“ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸å¯é€†çš„è¿ç®— ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒNFSRæ˜¯å¤šä¸ªLFSRé€šè¿‡ä¸€ä¸ªå‡½æ•°$F(r_1,r_2,â€¦,r_n)$ï¼Œå…¶ä¸­$F$å‡½æ•°ä¸­ä¸è¿ç®—å’Œå¼‚æˆ–è¿ç®—å‡å­˜åœ¨ï¼Œæ ¹æ®ä¸è¿ç®—çš„ä¸å¯é€†æ€§ï¼Œå¯çŸ¥$F$å‡½æ•°çš„ä¸å¯é€†æ€§ï¼Œæ‰€ä»¥æ˜¾ç„¶ï¼Œæˆ‘ä»¬å†™ä¸å‡º$F$å‡½æ•°çš„é€†å‡½æ•°$F^{-1}$ã€‚</p><h2 id="0x03-è§£é¢˜æ–¹æ³•"><a href="#0x03-è§£é¢˜æ–¹æ³•" class="headerlink" title="0x03 è§£é¢˜æ–¹æ³•"></a>0x03 è§£é¢˜æ–¹æ³•</h2><p>æˆ‘ä»¬å¯ä»¥ä¸€å¼€å§‹æšä¸¾æ¯ä¸€ä¸ªlfsråŠå…¶è¾“å‡ºç»“æœï¼Œçœ‹çœ‹$F(r_1,r_2,â€¦,r_n)&#x3D;r_i,iâˆˆ${$1,2,3,â€¦,n$}çš„æ¦‚ç‡$P_i$ã€‚æ‰¾å‡ºæ‰€æœ‰ä¸ä¸ºæ¦‚ç‡ä¸ä¸º$0.5$çš„$P_i$ï¼Œç„¶åç”¨ä»¥ä¸‹çš„C++è„šæœ¬æš´åŠ›æšä¸¾$r_i$çš„åˆå§‹å€¼ã€‚</p><p>ä¸€èˆ¬å…ˆå®šä¹‰$N&#x3D;30$ï¼ŒåŒºé—´ç­›é€‰é‚»åŸŸ$U(P,0.05)$åˆ¤æ–­å­˜åœ¨æ€§ï¼Œç„¶åä¸æ–­è°ƒå¤§$N$ä¸º$100,200,400,600,900,1200,2700$ï¼Œç›´åˆ°æœ€åè¿è¡Œåªå‰©ä¸‹ä¸€ä¸ªç»“æœå³å¯ï¼Œé€æ­¥è°ƒå¤§ä¸»è¦æ˜¯ä¸ºäº†åˆ¤æ–­ç»“æœçš„å­˜åœ¨æ€§å’Œæ£€éªŒå‚æ•°çš„æ­£ç¡®æ€§ã€‚</p><p>å¦‚æœ$N$è¶…è¿‡$600$ç®—å‡ºæ¥çš„æ•°å€¼ä»ç„¶æ¯”è¾ƒå¤šçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŒºé—´ç­›é€‰é‚»åŸŸç”±$U(P,0.05)$ä¸º$U(P,0.03)$æˆ–è€…$U(P,0.02)$å¢å¤§ç­›é€‰è¦æ±‚ã€‚</p><p>æœ¬ä»£ç ä»¥$18$ä½ï¼Œæ¦‚ç‡$0.625$ä¸ºä¾‹ï¼Œå®é™…åº”ç”¨åº”å½“è°ƒå‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> N 900 </span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> a[N<span class="hljs-number">+12</span>];<br><span class="hljs-type">double</span> G=<span class="hljs-number">0</span>; <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">culc</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> k=x,s=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span>(k)<br>&#123;<br>s+=k%<span class="hljs-number">2</span>;<br>k/=<span class="hljs-number">2</span>;<br>&#125;<br><span class="hljs-keyword">return</span> s;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">lfsr</span><span class="hljs-params">(<span class="hljs-type">int</span> r,<span class="hljs-type">int</span> m)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> t=(r&lt;&lt;<span class="hljs-number">1</span>)&amp;<span class="hljs-number">0xffffff</span>;<br><span class="hljs-type">int</span> s=<span class="hljs-built_in">culc</span>(r&amp;m)&amp;<span class="hljs-number">1</span>;<br><span class="hljs-keyword">return</span> (t^s);<br>&#125; <br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">solve</span><span class="hljs-params">(<span class="hljs-type">int</span> B,<span class="hljs-type">int</span> msk,<span class="hljs-type">double</span> pos1,<span class="hljs-type">double</span> pos2)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> r1,i,s1;<br><span class="hljs-keyword">for</span> (r1=(<span class="hljs-number">1</span>&lt;&lt;(B<span class="hljs-number">-1</span>));r1&lt;(<span class="hljs-number">1</span>&lt;&lt;(B));r1++)<br>&#123;<br>s1=r1;<br>G=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=N;i++)<br>&#123;<br>s1=<span class="hljs-built_in">lfsr</span>(s1,msk);<br><span class="hljs-keyword">if</span>(a[i]==(s1&amp;<span class="hljs-number">1</span>)) ++G;<br>&#125; <br><span class="hljs-keyword">if</span>((G/N&gt;pos1)&amp;&amp;(G/N&lt;pos2))<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d:pos=%.4lf%\n&quot;</span>,r1,G/N);<br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;data.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=N;i++)<br>&#123;<br><span class="hljs-type">char</span> c;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%c&quot;</span>,&amp;c);<br>a[i]=(c==<span class="hljs-string">&#x27;1&#x27;</span>); <br>&#125;<br><span class="hljs-built_in">solve</span>(<span class="hljs-number">18</span>,<span class="hljs-number">0x3da61</span>,<span class="hljs-number">0.595</span>,<span class="hljs-number">0.655</span>); <br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€åå‰©ä¸‹çš„$0.5$çš„æ¦‚ç‡æ•°é‡å¦‚æœåªæœ‰$1$ä¸ªæˆ–è€…$2$ä¸ªï¼Œå¯ä»¥å¼€æš´åŠ›æšä¸¾ï¼ˆ$2$ä¸ªçš„è¯è¯·ä¿è¯èƒ½å¤Ÿä¸¤é‡å¾ªç¯å¯è¡Œï¼‰</p><p>å¦‚æœæœ€åä»ç„¶å‰©ä¸‹å¾ˆéš¾æš´åŠ›æšä¸¾çš„$0.5$çš„æ¦‚ç‡ï¼Œå¯ä»¥æŠŠæœªçŸ¥çš„é‡è·Ÿå·²çŸ¥çš„æ„é€ å¼‚æˆ–å‡½æ•°ï¼Œä½¿æ¦‚ç‡è¾ƒå¤§åœ°åç¦»$0.5$ï¼ˆå–$&lt;0.4$æˆ–è€…$&gt;0.6$çš„å€¼ä¸ºå®œï¼‰ã€‚å°†å·²çŸ¥çš„å’ŒæœªçŸ¥çš„åŒæ­¥èµ·æ¥ï¼Œä¹Ÿå¯ä»¥è§£å‡ºæœ€åçš„ç­”æ¡ˆã€‚</p><p>æ‰€æœ‰çš„lfsréƒ½è§£å‡ºæ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„é¢˜ç›®ä¹Ÿå°±è§£å‡ºæ¥äº†ï¼Œå°±å¯ä»¥å¾—åˆ°flagäº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0xGameDiv1</title>
    <link href="/2020/10/07/0xGameDiv1/"/>
    <url>/2020/10/07/0xGameDiv1/</url>
    
    <content type="html"><![CDATA[<h1 id="0xGame-Div-1-é¢˜è§£"><a href="#0xGame-Div-1-é¢˜è§£" class="headerlink" title="0xGame Div 1 é¢˜è§£"></a>0xGame Div 1 é¢˜è§£</h1><h2 id="About"><a href="#About" class="headerlink" title="About"></a>About</h2><p>ç¬¬ä¸€å‘¨é¢˜ç›®è¿˜ç®—<del>æ¯”è¾ƒç®€å•</del>ï¼ŒæŠŠå¯†ç åˆ‡äº†ä¸¤é¢˜ï¼ŒMiscç®€å•çœ‹äº†çœ‹ã€‚æäº†<del>2000</del>å¤šåˆ†ï¼Œå¾ˆå¤šå¤§ä½¬7000å¤šåˆ†ï¼Œwtcl</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="1-Calendar"><a href="#1-Calendar" class="headerlink" title="1.Calendar"></a>1.Calendar</h3><p>æ ¹æ®ç»™çš„æ—¥å†å›¾ç‰‡ï¼ŒTHU1è¡¨ç¤º<strong>ç¬¬ä¸€è¡Œ</strong>çš„æ˜ŸæœŸå››å¯¹åº”çš„æ—¥æœŸï¼ŒåŒç†ï¼ŒTUE2è¡¨ç¤º<strong>ç¬¬äºŒè¡Œ</strong>çš„æ˜ŸæœŸäºŒå¯¹åº”çš„æ—¥æœŸï¼Œ<strong>ä¸æ˜¯è¿™ä¸ªæœˆç¬¬äºŒä¸ªæ˜ŸæœŸäºŒå¯¹åº”çš„æ—¥æœŸ</strong>ã€‚çº é”™æ–¹æ³•ï¼šæœ‰ä¸ªç æ˜¯<strong>TUE4</strong>ï¼Œå¦‚æœæŒ‰ç…§åè€…è¿›è¡Œç†è§£ï¼Œé‚£ä¹ˆå¾—åˆ°çš„å€¼æ˜¯$27$ã€‚åŒæ—¶é¢˜ç›®ç»™äº†æç¤ºä¸ºï¼šâ€œæ˜æ–‡<strong>å­—æ¯</strong>å…¨ä¸ºå°å†™ï¼Œè¯·å°†æ˜æ–‡åŒ…å«åœ¨0xGame{}å†…æäº¤â€ï¼Œè¯´æ˜æ¯ä¸ªæ•°å­—ä¸ä¼šè¶…è¿‡$26$ã€‚ï¼ˆå› ä¸ºæˆ‘ä¸€å¼€å§‹å°±æ˜¯é”™è¯¯çš„ç†è§£ï¼Œç„¶åå‘ç°äº†é—®é¢˜ï¼‰</p><p>è¿™ä¸ªå¯ä»¥ç›´æ¥æ‰‹æ‰“å‡ºæ‰€æœ‰çš„æ•°å­—ï¼Œä¿å­˜åœ¨ä¸€ä¸ªtxtæ–‡ä»¶ä¸­,ç„¶åç”¨ä¸‹é¢çš„è„šæœ¬å°±å¯ä»¥å¾—å‡ºflagäº†</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> x;<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;1.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br><span class="hljs-keyword">while</span>(~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;x))<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,x<span class="hljs-number">+96</span>);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-easyXor"><a href="#2-easyXor" class="headerlink" title="2.easyXor"></a>2.easyXor</h3><p><strong>å¿…å¤‡å¸¸è¯†ï¼šå·²çŸ¥$a$ xor $ b &#x3D; c$ ï¼Œå¯ä»¥å¾—åˆ°$c$ xor $b &#x3D; a$</strong></p><p>ä¸‹é¢æ˜¯é¢˜ç›®çš„Pythonä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>flag+=<span class="hljs-string">&quot;^&quot;</span><br>cipher=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)-<span class="hljs-number">1</span>):<br>    cipher.append(<span class="hljs-built_in">ord</span>(flag[i])^<span class="hljs-built_in">ord</span>(flag[i+<span class="hljs-number">1</span>]))<br><span class="hljs-built_in">print</span>(cipher)<br><span class="hljs-comment">#[72, 63, 38, 12, 8, 30, 30, 6, 82, 4, 84, 88, 92, 7, 79, 29, 8, 90, 85, 26, 25, 87, 80, 10, 20, 20, 9, 4, 80, 73, 31, 5, 82, 0, 1, 92, 0, 0, 94, 81, 4, 85, 27, 35]</span><br><br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œé¢˜ç›®ç»™å‡ºäº†æœ€ç»ˆçš„è¾“å‡ºï¼Œä¹ŸçŸ¥é“æœ€åå¢åŠ çš„ä¸€ä½å†…å®¹ã€‚ä»æœ€åä¸€ä½å‡ºå‘ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€ä¸ªä¸€ä¸ªå›æ¨ä»¥å‰çš„æ­¥éª¤ã€‚</p><p>å°†æœ€åçš„è¾“å‡ºç»“æœå¤åˆ¶åˆ°ä¸€ä¸ªtxtæ–‡ä»¶ä¸­ï¼Œç”¨æ›¿æ¢åŠŸèƒ½æŠŠæ‰€æœ‰çš„é€—å·æ¢æˆç©ºæ ¼ï¼Œåˆ é™¤æ— å…³ç¬¦å·ï¼Œç”¨ä»¥ä¸‹çš„C++è„šæœ¬ä»£ç è¿è¡Œå³å¯</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>stack&lt;<span class="hljs-type">int</span>&gt;s,r;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;1.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br><span class="hljs-type">int</span> x;<br><span class="hljs-keyword">while</span>(~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;x))<br>&#123;<br>s.<span class="hljs-built_in">push</span>(x);<br>&#125;<br><span class="hljs-type">int</span> t=<span class="hljs-string">&#x27;^&#x27;</span>;<br><span class="hljs-keyword">while</span>(!s.<span class="hljs-built_in">empty</span>())<br>&#123;<br>t=t^s.<span class="hljs-built_in">top</span>();<br>r.<span class="hljs-built_in">push</span>(t);<br>s.<span class="hljs-built_in">pop</span>();<br>&#125;<br><span class="hljs-keyword">while</span>(!r.<span class="hljs-built_in">empty</span>())<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,r.<span class="hljs-built_in">top</span>());<br>r.<span class="hljs-built_in">pop</span>();<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure><h3 id="3-Superaffine"><a href="#3-Superaffine" class="headerlink" title="3.Superaffine"></a>3.Superaffine</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ç¨‹åºä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> ascii_letters, digits<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">&quot;0xGame&#123;&quot;</span>) <span class="hljs-keyword">and</span> flag.endswith(<span class="hljs-string">&quot;&#125;&quot;</span>)<br>table = ascii_letters+digits<span class="hljs-comment"># å…ˆå°å†™ï¼Œå†å¤§å†™ï¼Œå†æ•°å­—</span><br>MOD = <span class="hljs-built_in">len</span>(table)<span class="hljs-comment">#mod = 62</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">affine</span>(<span class="hljs-params">x, a, b</span>): <span class="hljs-keyword">return</span> a*x+b<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genKey</span>():<br>    a = [randint(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>    b = [randint(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>    <span class="hljs-keyword">while</span> GCD(MOD, a[<span class="hljs-number">0</span>]*a[<span class="hljs-number">1</span>]*a[<span class="hljs-number">2</span>]) != <span class="hljs-number">1</span>:<br>        a = [randint(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>    <span class="hljs-keyword">return</span> a, b<br><br><br>cipher = <span class="hljs-string">&quot;&quot;</span><br>A, B = genKey()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> table:<br>        cipher += i<br>    <span class="hljs-keyword">else</span>:<br>        cipher += table[affine(affine(affine(table.find(i),A[<span class="hljs-number">0</span>], B[<span class="hljs-number">0</span>]), A[<span class="hljs-number">1</span>], B[<span class="hljs-number">1</span>]), A[<span class="hljs-number">2</span>], B[<span class="hljs-number">2</span>]) % MOD]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;cipher =&quot;</span>, cipher)<br><span class="hljs-comment"># cipher = t6b7Tn&#123;2GByBZBB-aan2-JRWn-GnZB-Jyf7a722ffnZ&#125;</span><br><br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªä»¿å°„å¯†ç ï¼Œå•å±‚åŠ å¯†è¿‡ç¨‹ä¸ºä¸€ä¸ªä¸€æ¬¡å‡½æ•°$y&#x3D;e(x)\equiv ax+b \mod m$ </p><p>Pythonä¸­ï¼Œascii_letterså¯¹åº”ä¸€ä¸ªå­—ç¬¦ä¸²ä¸ºâ€œabcâ€¦â€¦xyzABCâ€¦.XYZâ€,digitså¯¹åº”ä¸€ä¸ªå­—ç¬¦ä¸²ä¸ºâ€0123456789â€ï¼Œæ‰€ä»¥æ­¤å¤„æœ‰$MOD&#x3D;62$ã€‚</p><p>æ ¹æ®defgenkeyå¯çŸ¥ï¼šæ­¤å¤„çš„$a_0,a_1,a_2,b_0,b_1,b_2$å‡ä¸ºéšæœºç”Ÿæˆçš„$[1,63]$å†…çš„æ•´æ•°ï¼Œå¦‚æœæš´åŠ›æšä¸¾ï¼Œå¤æ‚åº¦ä¸º$O(63^6)â‰ˆ625.2äº¿$ã€‚æ‰€ä»¥æš´åŠ›æ˜¯ä¸å¯ä»¥çš„ã€‚</p><p>åŒ–ç®€åŠ å¯†å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è§£å¯†å…¬å¼$x&#x3D; d(y)\equiv a^{-1}(y-b)$ã€‚æ‰€ä»¥è¿™é‡Œæ¶‰åŠåˆ°æ±‚é€†å…ƒã€‚åˆç”±äº$62$ä¸ºåˆæ•°ï¼Œ$phi(62)&#x3D;30$ï¼Œä¹Ÿå°±æ˜¯åªæœ‰$30$ä¸ªå­—ç¬¦å¯ä»¥æ­£ç¡®åœ°åŠ å¯†å¹¶è§£å¯†ï¼Œè¯´æ˜æœ¬æ›¿æ¢å¯†ç çš„å¯†é’¥ç©ºé—´ä¸º$30Ã—62&#x3D;1860$ï¼Œå¹¶ä¸æ˜¯å¾ˆå¤§ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¢è®¨ä¸€ä¸‹ä¸¤é‡ä»¿å°„å¯†ç  $e_1(x)\equiv a_1x+b_1 \mod m$ å’Œ$e_2(x)\equiv a_2x+b_2 \mod m$ï¼Œæ‰€ä»¥$e_2(e_1(x))&#x3D;a_2a_1x+a_2b_1+b_2 \equiv m$ï¼Œä»ç„¶æ˜¯ä¸€ä¸ªä¸€æ¬¡å‡½æ•°ï¼Œè¿˜æ˜¯èƒ½å¤Ÿå†™æˆ$E&#x3D;Ax+B$çš„å½¢å¼ï¼Œå¯†é’¥ç©ºé—´ä¸å˜ï¼Œä»ç„¶æ˜¯$30Ã—62&#x3D;1860$ã€‚æ‰€ä»¥å¾—åˆ°ä¸€ä¸ªå¾ˆé‡è¦çš„ç»“è®ºï¼šæ— è®ºä»¿å°„åŠ å¯†æœ‰å‡ å±‚ï¼Œå¯†é’¥ç©ºé—´æ€»æ˜¯ä¸å˜ï¼å› ä¸ºå¯æ­£å¸¸è½¬æ¢çš„å­—ç¬¦æ•°é‡æœ¬æ¥å°±æ˜¯æœ‰é™çš„ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æ ¹æ®æ¨å‡ºçš„å…¬å¼ï¼š$E(x)&#x3D;a_2a_1a_0x+a_2a_1b_0+a_2b_1+b_2 \mod m$ï¼Œå†™æˆ$E(x)\equiv Ax+B \mod m$çš„å½¢å¼ï¼Œå¹¶ä¸”ç”±äºå¯†é’¥ç©ºé—´ä¸å˜ï¼Œ$A,B$ä»ç„¶æ˜¯$[1,63]$ä¸­çš„æ•´æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬æ ¹æ®ä»£ç assertçš„å†…å®¹ï¼Œå†™å‡ºå¦‚ä¸‹çš„C++è„šæœ¬</p><p>æ³¨ï¼šC++ä¸­ä¸ç­‰äºa!&#x3D;bå¯ä»¥å†™æˆa-bï¼ˆå¾ˆæ¯’ç˜¤çš„ä¸€ç§å†™æ³•ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>((a*<span class="hljs-number">52</span>+b<span class="hljs-number">+62</span>*<span class="hljs-number">8</span>)%<span class="hljs-number">62</span><span class="hljs-number">-19</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span>((a*<span class="hljs-number">23</span>+b<span class="hljs-number">+62</span>*<span class="hljs-number">8</span>)%<span class="hljs-number">62</span><span class="hljs-number">-58</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span>((a*<span class="hljs-number">32</span>+b<span class="hljs-number">+62</span>*<span class="hljs-number">8</span>)%<span class="hljs-number">62</span><span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span>((a*<span class="hljs-number">0</span>+b<span class="hljs-number">+62</span>*<span class="hljs-number">8</span>)%<span class="hljs-number">62</span><span class="hljs-number">-59</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span>((a*<span class="hljs-number">12</span>+b<span class="hljs-number">+62</span>*<span class="hljs-number">8</span>)%<span class="hljs-number">62</span><span class="hljs-number">-45</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span>((a*<span class="hljs-number">4</span>+b<span class="hljs-number">+62</span>*<span class="hljs-number">8</span>)%<span class="hljs-number">62</span><span class="hljs-number">-13</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span><br><span class="hljs-function"></span>&#123; <br><span class="hljs-type">int</span> i,j;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">63</span>;i++)<br><span class="hljs-keyword">for</span>(j=<span class="hljs-number">1</span>;j&lt;=<span class="hljs-number">63</span>;j++)<br>&#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">check</span>(i,j))  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;A=%d B=%d\n&quot;</span>,i,j);<br> &#125; <br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br><span class="hljs-comment">//è¿è¡Œç»“æœï¼šA=35ï¼ŒB=59</span><br></code></pre></td></tr></table></figure><p>$y&#x3D;E(x)\equiv 35x+59 \mod 62$</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥ç”¨Pythonçš„è„šæœ¬ï¼Œæ±‚å‡º$35$åœ¨æ¨¡$62$çš„æ„ä¹‰ä¸‹ä¹˜æ³•é€†å…ƒä¸º$39$,è„šæœ¬å¦‚ä¸‹ï¼ˆä¸‹ä¸€é¢˜ç”¨åˆ°çš„ä¹Ÿæ˜¯è¿™ä¸ªè„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬å¯ä»¥æ±‚æœ€å¤§å…¬çº¦æ•°å’Œé€†å…ƒï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">EX_GCD</span>(<span class="hljs-params">a,b,arr</span>): <span class="hljs-comment">#æ‰©å±•æ¬§å‡ é‡Œå¾—</span><br>    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span>:<br>        arr[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span><br>        arr[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">return</span> a<br>    g = EX_GCD(b, a % b, arr)<br>    t = arr[<span class="hljs-number">0</span>]<br>    arr[<span class="hljs-number">0</span>] = arr[<span class="hljs-number">1</span>]<br>    arr[<span class="hljs-number">1</span>] = t - (a // b) * arr[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> g<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ModReverse</span>(<span class="hljs-params">a,n</span>): <span class="hljs-comment">#ax=1(mod n) æ±‚aæ¨¡nçš„ä¹˜æ³•é€†x</span><br>    arr = [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,]<br>    gcd = EX_GCD(a,n,arr)<br>    <span class="hljs-keyword">if</span> gcd == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> (arr[<span class="hljs-number">0</span>] % n + n) % n<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br>arr = [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,]<br><br><br>a=<span class="hljs-number">35</span>,b=<span class="hljs-number">62</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;niyuan&quot;</span>,ModReverse(a,b))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;zuidagonyueshu&#x27;</span>,EX_GCD(a,b,arr))<br><br></code></pre></td></tr></table></figure><p>ç”±äº$62-59&#x3D;3$,æ‰€ä»¥$59$åœ¨æ¨¡$62$çš„æ„ä¹‰ä¸‹åŠ æ³•é€†å…ƒä¸º$3$,æ‰€ä»¥è§£å¯†å‡½æ•°ä¸º$x&#x3D;D(y)\equiv 39y+3 \mod 62$</p><p>åŒæ ·ï¼Œå°†å¯†æ–‡æ”¾å…¥ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œç”¨C++å†™ä¸€ä¸ªè„šæœ¬ï¼Œå³å¯æ±‚å‡ºæ˜æ–‡</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">const</span> string s=<span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">return</span> ((x<span class="hljs-number">+3</span>)*<span class="hljs-number">39</span>)%<span class="hljs-number">62</span>;<br>&#125; <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br><span class="hljs-type">char</span> c;<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;tst2002.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br><span class="hljs-keyword">while</span>(cin&gt;&gt;c)<br>&#123;<br><span class="hljs-keyword">if</span>((<span class="hljs-type">int</span>)(s.<span class="hljs-built_in">find</span>(c))==<span class="hljs-number">-1</span>) cout&lt;&lt;c;<br><span class="hljs-keyword">else</span> <br>&#123;<br>cout&lt;&lt;s[<span class="hljs-built_in">f</span>(s.<span class="hljs-built_in">find</span>(c))] ;<br>&#125; <br>&#125;<br>&#125; <br></code></pre></td></tr></table></figure><h3 id="4-equationSet"><a href="#4-equationSet" class="headerlink" title="4.equationSet"></a>4.equationSet</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>e = <span class="hljs-number">65537</span><br>m = bytes_to_long(flag.encode())<br>p, q, r = getPrime(<span class="hljs-number">512</span>), getPrime(<span class="hljs-number">512</span>), getPrime(<span class="hljs-number">512</span>)<br><br>n = p*q*r<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(p+q+r)<br><span class="hljs-built_in">print</span>(p*q+p*r)<br><span class="hljs-comment"># ç»™å‡ºéƒ¨åˆ†ç•¥</span><br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„RSAå˜å¼ï¼Œä¸‰ä¸ªè´¨æ•°ç›¸ä¹˜ï¼Œæ ¹æ®æˆ‘ä»¬å¾—åˆ°çš„çº¿ç´¢ï¼šæœ‰ä»¥ä¸‹3ä¸ªæ•°æ®å¯ç”¨ï¼š$S&#x3D;p+q+r$ï¼Œ$n&#x3D;pÃ—qÃ—r$ï¼Œ$T&#x3D;pÃ—(q+r)$ã€‚</p><p>ç”±äº$p,q,r$å‡ä¸ºè´¨æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚$T$å’Œ$n$çš„æœ€å¤§å…¬çº¦æ•°å³ä¸º$p$çš„å€¼ï¼Œç„¶åæˆ‘ä»¬å¾ˆå¿«å°±å¾—åˆ°ä»¥ä¸‹ä¸¤ä¸ªæ•°å­—ï¼š$M_2&#x3D;qÃ—r$å’Œ$T_2&#x3D;q+r$ã€‚</p><p>æ€ä¹ˆè§£$q,r$ï¼Ÿ æ¢å…ƒè§£äºŒæ¬¡æ–¹ç¨‹ï¼Ÿæ˜¾ç„¶å¾ˆéº»çƒ¦ï¼</p><p>å®é™…ä¸Šæˆ‘ä»¬ä¸éœ€è¦è§£å‡ºæ¥è¿™2ä¸ªå€¼ï¼Œå› ä¸ºRSAåŠ å¯†ä¸º$c&#x3D;m^e \mod n$ï¼Œè§£å¯†ä¸º$m&#x3D;c^d \mod n$ï¼Œå…¶ä¸­$d$æ˜¯$e$åœ¨æ¨¡$phi(n)$çš„é€†å…ƒï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ±‚$phi(n)$ï¼Œåˆå› ä¸º$p,q,r$å‡ä¸ºè´¨æ•°ï¼Œæ‰€ä»¥$phi(n)&#x3D;phi(p)Ã—phi(q)Ã—phi(r)&#x3D;(p-1)(q-1)(r-1)&#x3D;(p-1)(M_2-T_2+1)$</p><p>ç„¶åæˆ‘ä»¬å†ç”¨ä¸Šä¸€é¢˜çš„é‚£ä¸ªè„šæœ¬è§£å‡º$d$,è¿›è€Œå¾—åˆ°$m$</p><p>å¾—åˆ°$m$åï¼Œæ¥ä¸€æ³¢long_to_bytesæ“ä½œå°±å¾—åˆ°äº†flagã€‚</p><p>æ³¨ï¼šæœªé…ç½®ç›¸å…³ç¯å¢ƒçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨è¿›åˆ¶åˆ†è§£çš„æ‰‹æ®µï¼Œå°†$m$åˆ†è§£ä¸º$256$è¿›åˆ¶ï¼Œç„¶åä¸€ä½ä¸€ä½é€ä¸€è½¬æˆå­—ç¬¦</p><h3 id="5-Fibonacci"><a href="#5-Fibonacci" class="headerlink" title="5.Fibonacci"></a>5.Fibonacci</h3><p>å…ˆæ”¾ä¸€ä¸‹é¢˜ç›®ä¸­æœ€æ ¸å¿ƒçš„ä»£ç ï¼Œå¹¶ä¸”é¢˜ç›®ç»™å‡ºäº† $r,n,c,N$ è¿™ $4$ ä¸ªæ•°çš„å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">n = reduce(<span class="hljs-keyword">lambda</span> a, b: a*b, [getPrime(<span class="hljs-number">4</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)])<br>r = getRandomNBitInteger(<span class="hljs-number">67</span>)<br>S = <span class="hljs-built_in">sum</span>([F(i) % n <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r)])<br>p = next_prime(S**<span class="hljs-number">16</span>)<br>q = getPrime(p.bit_length())<br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">65537</span>, p*q)<br>N=p*q<br><span class="hljs-comment">#n=34969</span><br><span class="hljs-comment">#r,c,Næ•°å­—è¿‡å¤§ï¼Œæ­¤å¤„ç•¥å»</span><br></code></pre></td></tr></table></figure><p>è¿™ä»ç„¶æ˜¯ä¸ªRSAçš„å˜å¼é¢˜ã€‚é¦–å…ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ° $p$ è·Ÿ$S$çš„å€¼æ˜¯å¯†åˆ‡ç›¸å…³çš„ã€‚æ‰€ä»¥æˆ‘ä»¬åº”å½“å…ˆæ±‚å‡º$S &#x3D; \sum_{i&#x3D;1}^r (F_i \mod 34969) $çš„å€¼</p><p>æ ¹æ®æ–æ³¢é‚£å¥‘æ•°åˆ—çš„é€’æ¨å…¬å¼$F_i&#x3D;F_{i-1}+F_{i-2}$ï¼Œå…¶ä¸­$F_1&#x3D;F_2&#x3D;1$ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šå¦‚æœæ‰€æœ‰çš„$F_i$å¯¹åŒä¸€ä¸ªæ•°å–æ¨¡ï¼Œè¿™ä¸ªæ•°åˆ—åº”å½“æ˜¯æœ‰å‘¨æœŸæ€§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”å½“æ±‚è¿™ä¸ªæ•°åˆ—çš„å‘¨æœŸã€‚è€Œæ¨¡æ•°ä¸º$34969$ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼°è®¡å‘¨æœŸä¸è¶…è¿‡$500ä¸‡$ï¼Œç”¨ä»¥ä¸‹çš„C++è„šæœ¬ç¡®å®šå‘¨æœŸ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">int</span> n,f[<span class="hljs-number">9607087</span>];<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> i,j;<br>f[<span class="hljs-number">1</span>]=f[<span class="hljs-number">2</span>]=<span class="hljs-number">1</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">3</span>;i&lt;=<span class="hljs-number">5000000</span>;i++)<br>&#123;<br>f[i]=(f[i<span class="hljs-number">-1</span>]+f[i<span class="hljs-number">-2</span>])%<span class="hljs-number">34969</span>;<br><span class="hljs-keyword">if</span>(f[i]==f[i<span class="hljs-number">-1</span>]&amp;&amp;f[i]==<span class="hljs-number">1</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,i<span class="hljs-number">-1</span>); <br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±äºè¾“å‡ºçš„ç¬¬ä¸€ä¸ªæ•°å­—ä¸º$33661$ï¼Œè¯´æ˜$f_{33661}&#x3D;f_{33662}&#x3D;1$ï¼Œç¡®å®šå‘¨æœŸä¸º$33660$ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ±‚å‡ºä¸€ä¸ªå‘¨æœŸå†…çš„æ•°å­—ä¹‹å’Œ$S_T &#x3D; \sum_{i&#x3D;1}^{33660} (F_i \mod 34969)$ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬åœ¨pythonä¸­è®¡ç®—<code>r//33660</code>å’Œ<code>r%33660</code>çš„å€¼ï¼Œç„¶åå°±å¯ä»¥ç¡®å®šæ•°æ®çš„ç»„æ•°å’Œå¤šå‡ºæ¥çš„ç»„æ•°äº†ã€‚</p><p>æœ€ç»ˆï¼Œæˆ‘ä»¬å¾—åˆ°$S&#x3D;\lfloor r&#x2F;33660 \rfloor Ã— S_T +$ $ \sum_{i&#x3D;1}^{r \mod 33660} (F_i \mod 34969)$ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡º$p$çš„å€¼ï¼Œè¿›è€Œæ±‚å‡º$q$çš„å€¼ã€‚</p><p>æœ‰äº†$p,q$ä¸¤ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ±‚å‡º$N$çš„æ¬§æ‹‰å‡½æ•° ç„¶åç”¨è·Ÿä¸Šä¸€é¢˜ä¸€æ ·çš„è„šæœ¬(Superaffineä¸­æåˆ°çš„æ±‚æœ€å¤§å…¬çº¦æ•°å’Œé€†å…ƒçš„è„šæœ¬)ï¼Œç”¨RSAè§£å¯†æ–¹æ³•è¿…é€Ÿå¾—å‡º$d$å’Œ$m$ï¼Œæ¥ä¸€æ³¢<code>long_to_bytes</code>ï¼Œå¾—å‡ºflagã€‚</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="1-ç­¾åˆ°é¢˜"><a href="#1-ç­¾åˆ°é¢˜" class="headerlink" title="1.ç­¾åˆ°é¢˜"></a>1.ç­¾åˆ°é¢˜</h3><p>è¿™ä¸ªå°±ä¸å†™é¢˜è§£äº†å§~Rulesèƒ½æ‰¾åˆ°</p><h3 id="2-easeBase"><a href="#2-easeBase" class="headerlink" title="2.easeBase"></a>2.easeBase</h3><p>éšä¾¿åœ¨ç™¾åº¦ä¸Šæ‰¾ä¸ªBase64åŠ å¯†è§£å¯†ç½‘é¡µï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹å†…å®¹:<code>307847616D657B68407070794D4953435F4D4953435F4D4953437D</code></p><p>è§‚å¯Ÿå¯çŸ¥è¿™æ˜¯ä¸€ä¸ª$16$è¿›åˆ¶çš„æ•°å­—ï¼Œåº”è¯¥æ˜¯ASCIIç ã€‚å­˜å…¥ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ä¸­ï¼Œç„¶åä¸¤ä½ä¸€ç»„æŒ‰ä¸€ä¸ªå›è½¦ã€‚æœ€åç”¨ä»¥ä¸‹C++è„šæœ¬å³å¯å¾—åˆ°flag</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> x;<br><span class="hljs-built_in">freopen</span>(<span class="hljs-string">&quot;1.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>,stdin);<br><span class="hljs-keyword">while</span>(~<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%x&quot;</span>,&amp;x))<br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,x);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure><h3 id="3-lowerBase64"><a href="#3-lowerBase64" class="headerlink" title="3.lowerBase64"></a>3.lowerBase64</h3><p>æ ¹æ®<code>0xgame</code>çš„å¼€å¤´Base64åŠ å¯†å¯çŸ¥ï¼šè¿™è¾¹åº”è¯¥æ˜¯æŠŠæ­£ç¡®çš„å¯†æ–‡å…¨éƒ¨å°å†™åå¾—åˆ°ç»™å‡ºçš„å­—ç¬¦ä¸²</p><p>ä½¿ç”¨ä»¥ä¸‹çš„pythonè„šæœ¬ï¼Œæ¯æ¬¡åœ¨$k$åé¢åŠ $2$ä½å­—ç¬¦ï¼Œå¯ä»¥ç¡®å®šåé¢$1$åˆ°$2$ä¸ª$f$çš„å†…å®¹ï¼Œå°±è¿™æ ·æ‰‹åŠ¨åœ°ä¸€æ­¥ä¸€æ­¥åœ°æ‰©å……å­—ç¬¦ä¸²$k$å’Œ$f$çš„å†…å®¹ï¼Œå½“$f$å†…å®¹å®Œæ•´æ—¶ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64encode<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> *<br>f=<span class="hljs-string">&#x27;0xgame&#123;&#x27;</span><br>k=<span class="hljs-string">&#x27;mhhnyw1le&#x27;</span><br>s=<span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz0123456789-&#123;&#125;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span>((b64encode((f+i+j).encode()).decode().lower()).startswith(k)):<br>            <span class="hljs-built_in">print</span> (i+j)<br></code></pre></td></tr></table></figure><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>ç”±äºæœ¬äººæ²¡é€‰æ‹©webæ–¹å‘ï¼Œæ‰€ä»¥webç®€å•åˆ‡äº†2é¢˜ï¼Œè¿™ä¸¤é¢˜å¯¹äºä¸»ä¿®webçš„æ˜¯éå¸¸éå¸¸$H_2O$ä½†æˆ‘è¿˜æ˜¯ç”¨äº†å¾ˆä¹…æ‰åšå‡ºæ¥</p><h3 id="1-View-Source"><a href="#1-View-Source" class="headerlink" title="1.View Source"></a>1.View Source</h3><p>æŒ‰<code>F12</code>å°±å‡ºæ¥Flagäº†ï¼ŒPass</p><h3 id="2-robotsåè®®"><a href="#2-robotsåè®®" class="headerlink" title="2.robotsåè®®"></a>2.robotsåè®®</h3><p>ç½‘å€åé¢åŠ <code>/robots.txt</code>å¾—åˆ°ä¸€ä¸ªç•Œé¢ï¼Œçœ‹åˆ°äº†<code>Disallow</code>å†…å®¹ï¼Œæœ€åæŠŠ<code>/robots.txt</code>æ”¹ä¸º<code>/flaaaggg.php</code>å°±å¾—åˆ°flagäº†</p>]]></content>
    
    
    <categories>
      
      <category>CTFSeason1</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WriteUp</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
